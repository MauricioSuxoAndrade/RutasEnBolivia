var aP=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var $x=(t,e,n)=>(aP(t,e,"read from private field"),n?n.call(t):e.get(t)),lP=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},cP=(t,e,n,r)=>(aP(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function mM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var b4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Pc(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var gM={exports:{}},S_={},yM={exports:{}},Bn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lm=Symbol.for("react.element"),w4=Symbol.for("react.portal"),S4=Symbol.for("react.fragment"),T4=Symbol.for("react.strict_mode"),E4=Symbol.for("react.profiler"),P4=Symbol.for("react.provider"),C4=Symbol.for("react.context"),A4=Symbol.for("react.forward_ref"),I4=Symbol.for("react.suspense"),k4=Symbol.for("react.memo"),M4=Symbol.for("react.lazy"),uP=Symbol.iterator;function L4(t){return t===null||typeof t!="object"?null:(t=uP&&t[uP]||t["@@iterator"],typeof t=="function"?t:null)}var _M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vM=Object.assign,xM={};function $d(t,e,n){this.props=t,this.context=e,this.refs=xM,this.updater=n||_M}$d.prototype.isReactComponent={};$d.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$d.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bM(){}bM.prototype=$d.prototype;function aS(t,e,n){this.props=t,this.context=e,this.refs=xM,this.updater=n||_M}var lS=aS.prototype=new bM;lS.constructor=aS;vM(lS,$d.prototype);lS.isPureReactComponent=!0;var hP=Array.isArray,wM=Object.prototype.hasOwnProperty,cS={current:null},SM={key:!0,ref:!0,__self:!0,__source:!0};function TM(t,e,n){var r,i={},a=null,h=null;if(e!=null)for(r in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(a=""+e.key),e)wM.call(e,r)&&!SM.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var m=Array(l),_=0;_<l;_++)m[_]=arguments[_+2];i.children=m}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Lm,type:t,key:a,ref:h,props:i,_owner:cS.current}}function R4(t,e){return{$$typeof:Lm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uS(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lm}function O4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var dP=/\/+/g;function Gx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?O4(""+t.key):e.toString(36)}function n0(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var h=!1;if(t===null)h=!0;else switch(a){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case Lm:case w4:h=!0}}if(h)return h=t,i=i(h),t=r===""?"."+Gx(h,0):r,hP(i)?(n="",t!=null&&(n=t.replace(dP,"$&/")+"/"),n0(i,e,n,"",function(_){return _})):i!=null&&(uS(i)&&(i=R4(i,n+(!i.key||h&&h.key===i.key?"":(""+i.key).replace(dP,"$&/")+"/")+t)),e.push(i)),1;if(h=0,r=r===""?".":r+":",hP(t))for(var l=0;l<t.length;l++){a=t[l];var m=r+Gx(a,l);h+=n0(a,e,n,m,i)}else if(m=L4(t),typeof m=="function")for(t=m.call(t),l=0;!(a=t.next()).done;)a=a.value,m=r+Gx(a,l++),h+=n0(a,e,n,m,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function ay(t,e,n){if(t==null)return t;var r=[],i=0;return n0(t,r,"","",function(a){return e.call(n,a,i++)}),r}function z4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Es={current:null},r0={transition:null},D4={ReactCurrentDispatcher:Es,ReactCurrentBatchConfig:r0,ReactCurrentOwner:cS};function EM(){throw Error("act(...) is not supported in production builds of React.")}Bn.Children={map:ay,forEach:function(t,e,n){ay(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ay(t,function(){e++}),e},toArray:function(t){return ay(t,function(e){return e})||[]},only:function(t){if(!uS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Bn.Component=$d;Bn.Fragment=S4;Bn.Profiler=E4;Bn.PureComponent=aS;Bn.StrictMode=T4;Bn.Suspense=I4;Bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D4;Bn.act=EM;Bn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=vM({},t.props),i=t.key,a=t.ref,h=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,h=cS.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(m in e)wM.call(e,m)&&!SM.hasOwnProperty(m)&&(r[m]=e[m]===void 0&&l!==void 0?l[m]:e[m])}var m=arguments.length-2;if(m===1)r.children=n;else if(1<m){l=Array(m);for(var _=0;_<m;_++)l[_]=arguments[_+2];r.children=l}return{$$typeof:Lm,type:t.type,key:i,ref:a,props:r,_owner:h}};Bn.createContext=function(t){return t={$$typeof:C4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:P4,_context:t},t.Consumer=t};Bn.createElement=TM;Bn.createFactory=function(t){var e=TM.bind(null,t);return e.type=t,e};Bn.createRef=function(){return{current:null}};Bn.forwardRef=function(t){return{$$typeof:A4,render:t}};Bn.isValidElement=uS;Bn.lazy=function(t){return{$$typeof:M4,_payload:{_status:-1,_result:t},_init:z4}};Bn.memo=function(t,e){return{$$typeof:k4,type:t,compare:e===void 0?null:e}};Bn.startTransition=function(t){var e=r0.transition;r0.transition={};try{t()}finally{r0.transition=e}};Bn.unstable_act=EM;Bn.useCallback=function(t,e){return Es.current.useCallback(t,e)};Bn.useContext=function(t){return Es.current.useContext(t)};Bn.useDebugValue=function(){};Bn.useDeferredValue=function(t){return Es.current.useDeferredValue(t)};Bn.useEffect=function(t,e){return Es.current.useEffect(t,e)};Bn.useId=function(){return Es.current.useId()};Bn.useImperativeHandle=function(t,e,n){return Es.current.useImperativeHandle(t,e,n)};Bn.useInsertionEffect=function(t,e){return Es.current.useInsertionEffect(t,e)};Bn.useLayoutEffect=function(t,e){return Es.current.useLayoutEffect(t,e)};Bn.useMemo=function(t,e){return Es.current.useMemo(t,e)};Bn.useReducer=function(t,e,n){return Es.current.useReducer(t,e,n)};Bn.useRef=function(t){return Es.current.useRef(t)};Bn.useState=function(t){return Es.current.useState(t)};Bn.useSyncExternalStore=function(t,e,n){return Es.current.useSyncExternalStore(t,e,n)};Bn.useTransition=function(){return Es.current.useTransition()};Bn.version="18.3.1";yM.exports=Bn;var q=yM.exports;const cr=Mm(q),m1=mM({__proto__:null,default:cr},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F4=q,N4=Symbol.for("react.element"),B4=Symbol.for("react.fragment"),j4=Object.prototype.hasOwnProperty,V4=F4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,U4={key:!0,ref:!0,__self:!0,__source:!0};function PM(t,e,n){var r,i={},a=null,h=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(h=e.ref);for(r in e)j4.call(e,r)&&!U4.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:N4,type:t,key:a,ref:h,props:i,_owner:V4.current}}S_.Fragment=B4;S_.jsx=PM;S_.jsxs=PM;gM.exports=S_;var te=gM.exports,g1={},CM={exports:{}},co={},AM={exports:{}},IM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,Xe){var lt=Ce.length;Ce.push(Xe);e:for(;0<lt;){var Dt=lt-1>>>1,mt=Ce[Dt];if(0<i(mt,Xe))Ce[Dt]=Xe,Ce[lt]=mt,lt=Dt;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function r(Ce){if(Ce.length===0)return null;var Xe=Ce[0],lt=Ce.pop();if(lt!==Xe){Ce[0]=lt;e:for(var Dt=0,mt=Ce.length,ht=mt>>>1;Dt<ht;){var ot=2*(Dt+1)-1,xt=Ce[ot],bt=ot+1,Wt=Ce[bt];if(0>i(xt,lt))bt<mt&&0>i(Wt,xt)?(Ce[Dt]=Wt,Ce[bt]=lt,Dt=bt):(Ce[Dt]=xt,Ce[ot]=lt,Dt=ot);else if(bt<mt&&0>i(Wt,lt))Ce[Dt]=Wt,Ce[bt]=lt,Dt=bt;else break e}}return Xe}function i(Ce,Xe){var lt=Ce.sortIndex-Xe.sortIndex;return lt!==0?lt:Ce.id-Xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var h=Date,l=h.now();t.unstable_now=function(){return h.now()-l}}var m=[],_=[],S=1,P=null,C=3,L=!1,R=!1,D=!1,W=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(Ce){for(var Xe=n(_);Xe!==null;){if(Xe.callback===null)r(_);else if(Xe.startTime<=Ce)r(_),Xe.sortIndex=Xe.expirationTime,e(m,Xe);else break;Xe=n(_)}}function $(Ce){if(D=!1,F(Ce),!R)if(n(m)!==null)R=!0,Ze(K);else{var Xe=n(_);Xe!==null&&Ye($,Xe.startTime-Ce)}}function K(Ce,Xe){R=!1,D&&(D=!1,z(xe),xe=-1),L=!0;var lt=C;try{for(F(Xe),P=n(m);P!==null&&(!(P.expirationTime>Xe)||Ce&&!Re());){var Dt=P.callback;if(typeof Dt=="function"){P.callback=null,C=P.priorityLevel;var mt=Dt(P.expirationTime<=Xe);Xe=t.unstable_now(),typeof mt=="function"?P.callback=mt:P===n(m)&&r(m),F(Xe)}else r(m);P=n(m)}if(P!==null)var ht=!0;else{var ot=n(_);ot!==null&&Ye($,ot.startTime-Xe),ht=!1}return ht}finally{P=null,C=lt,L=!1}}var ne=!1,se=null,xe=-1,Se=5,_e=-1;function Re(){return!(t.unstable_now()-_e<Se)}function De(){if(se!==null){var Ce=t.unstable_now();_e=Ce;var Xe=!0;try{Xe=se(!0,Ce)}finally{Xe?Ve():(ne=!1,se=null)}}else ne=!1}var Ve;if(typeof N=="function")Ve=function(){N(De)};else if(typeof MessageChannel<"u"){var je=new MessageChannel,We=je.port2;je.port1.onmessage=De,Ve=function(){We.postMessage(null)}}else Ve=function(){W(De,0)};function Ze(Ce){se=Ce,ne||(ne=!0,Ve())}function Ye(Ce,Xe){xe=W(function(){Ce(t.unstable_now())},Xe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){R||L||(R=!0,Ze(K))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Se=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(Ce){switch(C){case 1:case 2:case 3:var Xe=3;break;default:Xe=C}var lt=C;C=Xe;try{return Ce()}finally{C=lt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,Xe){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var lt=C;C=Ce;try{return Xe()}finally{C=lt}},t.unstable_scheduleCallback=function(Ce,Xe,lt){var Dt=t.unstable_now();switch(typeof lt=="object"&&lt!==null?(lt=lt.delay,lt=typeof lt=="number"&&0<lt?Dt+lt:Dt):lt=Dt,Ce){case 1:var mt=-1;break;case 2:mt=250;break;case 5:mt=1073741823;break;case 4:mt=1e4;break;default:mt=5e3}return mt=lt+mt,Ce={id:S++,callback:Xe,priorityLevel:Ce,startTime:lt,expirationTime:mt,sortIndex:-1},lt>Dt?(Ce.sortIndex=lt,e(_,Ce),n(m)===null&&Ce===n(_)&&(D?(z(xe),xe=-1):D=!0,Ye($,lt-Dt))):(Ce.sortIndex=mt,e(m,Ce),R||L||(R=!0,Ze(K))),Ce},t.unstable_shouldYield=Re,t.unstable_wrapCallback=function(Ce){var Xe=C;return function(){var lt=C;C=Xe;try{return Ce.apply(this,arguments)}finally{C=lt}}}})(IM);AM.exports=IM;var $4=AM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G4=q,ao=$4;function ft(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kM=new Set,Zp={};function Ru(t,e){gd(t,e),gd(t+"Capture",e)}function gd(t,e){for(Zp[t]=e,t=0;t<e.length;t++)kM.add(e[t])}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y1=Object.prototype.hasOwnProperty,W4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fP={},pP={};function H4(t){return y1.call(pP,t)?!0:y1.call(fP,t)?!1:W4.test(t)?pP[t]=!0:(fP[t]=!0,!1)}function q4(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Z4(t,e,n,r){if(e===null||typeof e>"u"||q4(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ps(t,e,n,r,i,a,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=h}var Ui={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ui[t]=new Ps(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ui[e]=new Ps(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ui[t]=new Ps(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ui[t]=new Ps(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ui[t]=new Ps(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ui[t]=new Ps(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ui[t]=new Ps(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ui[t]=new Ps(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ui[t]=new Ps(t,5,!1,t.toLowerCase(),null,!1,!1)});var hS=/[\-:]([a-z])/g;function dS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hS,dS);Ui[e]=new Ps(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hS,dS);Ui[e]=new Ps(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hS,dS);Ui[e]=new Ps(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ui[t]=new Ps(t,1,!1,t.toLowerCase(),null,!1,!1)});Ui.xlinkHref=new Ps("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ui[t]=new Ps(t,1,!1,t.toLowerCase(),null,!0,!0)});function fS(t,e,n,r){var i=Ui.hasOwnProperty(e)?Ui[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Z4(e,n,i,r)&&(n=null),r||i===null?H4(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wl=G4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ly=Symbol.for("react.element"),Vh=Symbol.for("react.portal"),Uh=Symbol.for("react.fragment"),pS=Symbol.for("react.strict_mode"),_1=Symbol.for("react.profiler"),MM=Symbol.for("react.provider"),LM=Symbol.for("react.context"),mS=Symbol.for("react.forward_ref"),v1=Symbol.for("react.suspense"),x1=Symbol.for("react.suspense_list"),gS=Symbol.for("react.memo"),Ql=Symbol.for("react.lazy"),RM=Symbol.for("react.offscreen"),mP=Symbol.iterator;function ep(t){return t===null||typeof t!="object"?null:(t=mP&&t[mP]||t["@@iterator"],typeof t=="function"?t:null)}var Br=Object.assign,Wx;function Sp(t){if(Wx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wx=e&&e[1]||""}return`
`+Wx+t}var Hx=!1;function qx(t,e){if(!t||Hx)return"";Hx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var r=_}Reflect.construct(t,[],e)}else{try{e.call()}catch(_){r=_}t.call(e.prototype)}else{try{throw Error()}catch(_){r=_}t()}}catch(_){if(_&&r&&typeof _.stack=="string"){for(var i=_.stack.split(`
`),a=r.stack.split(`
`),h=i.length-1,l=a.length-1;1<=h&&0<=l&&i[h]!==a[l];)l--;for(;1<=h&&0<=l;h--,l--)if(i[h]!==a[l]){if(h!==1||l!==1)do if(h--,l--,0>l||i[h]!==a[l]){var m=`
`+i[h].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=h&&0<=l);break}}}finally{Hx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Sp(t):""}function X4(t){switch(t.tag){case 5:return Sp(t.type);case 16:return Sp("Lazy");case 13:return Sp("Suspense");case 19:return Sp("SuspenseList");case 0:case 2:case 15:return t=qx(t.type,!1),t;case 11:return t=qx(t.type.render,!1),t;case 1:return t=qx(t.type,!0),t;default:return""}}function b1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uh:return"Fragment";case Vh:return"Portal";case _1:return"Profiler";case pS:return"StrictMode";case v1:return"Suspense";case x1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case LM:return(t.displayName||"Context")+".Consumer";case MM:return(t._context.displayName||"Context")+".Provider";case mS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gS:return e=t.displayName||null,e!==null?e:b1(t.type)||"Memo";case Ql:e=t._payload,t=t._init;try{return b1(t(e))}catch{}}return null}function Y4(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return b1(e);case 8:return e===pS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function OM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function K4(t){var e=OM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(h){r=""+h,a.call(this,h)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function cy(t){t._valueTracker||(t._valueTracker=K4(t))}function zM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=OM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function I0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function w1(t,e){var n=e.checked;return Br({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gP(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Sc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function DM(t,e){e=e.checked,e!=null&&fS(t,"checked",e,!1)}function S1(t,e){DM(t,e);var n=Sc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?T1(t,e.type,n):e.hasOwnProperty("defaultValue")&&T1(t,e.type,Sc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function T1(t,e,n){(e!=="number"||I0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Tp=Array.isArray;function id(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Sc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function E1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ft(91));return Br({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _P(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ft(92));if(Tp(n)){if(1<n.length)throw Error(ft(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Sc(n)}}function FM(t,e){var n=Sc(e.value),r=Sc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function vP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function NM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function P1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?NM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var uy,BM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(uy=uy||document.createElement("div"),uy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=uy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Xp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},J4=["Webkit","ms","Moz","O"];Object.keys(Mp).forEach(function(t){J4.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mp[e]=Mp[t]})});function jM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mp.hasOwnProperty(t)&&Mp[t]?(""+e).trim():e+"px"}function VM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=jM(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Q4=Br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function C1(t,e){if(e){if(Q4[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ft(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ft(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ft(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ft(62))}}function A1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var I1=null;function yS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var k1=null,sd=null,od=null;function xP(t){if(t=zm(t)){if(typeof k1!="function")throw Error(ft(280));var e=t.stateNode;e&&(e=A_(e),k1(t.stateNode,t.type,e))}}function UM(t){sd?od?od.push(t):od=[t]:sd=t}function $M(){if(sd){var t=sd,e=od;if(od=sd=null,xP(t),e)for(t=0;t<e.length;t++)xP(e[t])}}function GM(t,e){return t(e)}function WM(){}var Zx=!1;function HM(t,e,n){if(Zx)return t(e,n);Zx=!0;try{return GM(t,e,n)}finally{Zx=!1,(sd!==null||od!==null)&&(WM(),$M())}}function Yp(t,e){var n=t.stateNode;if(n===null)return null;var r=A_(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ft(231,e,typeof n));return n}var M1=!1;if(hl)try{var tp={};Object.defineProperty(tp,"passive",{get:function(){M1=!0}}),window.addEventListener("test",tp,tp),window.removeEventListener("test",tp,tp)}catch{M1=!1}function e5(t,e,n,r,i,a,h,l,m){var _=Array.prototype.slice.call(arguments,3);try{e.apply(n,_)}catch(S){this.onError(S)}}var Lp=!1,k0=null,M0=!1,L1=null,t5={onError:function(t){Lp=!0,k0=t}};function n5(t,e,n,r,i,a,h,l,m){Lp=!1,k0=null,e5.apply(t5,arguments)}function r5(t,e,n,r,i,a,h,l,m){if(n5.apply(this,arguments),Lp){if(Lp){var _=k0;Lp=!1,k0=null}else throw Error(ft(198));M0||(M0=!0,L1=_)}}function Ou(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bP(t){if(Ou(t)!==t)throw Error(ft(188))}function i5(t){var e=t.alternate;if(!e){if(e=Ou(t),e===null)throw Error(ft(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return bP(i),t;if(a===r)return bP(i),e;a=a.sibling}throw Error(ft(188))}if(n.return!==r.return)n=i,r=a;else{for(var h=!1,l=i.child;l;){if(l===n){h=!0,n=i,r=a;break}if(l===r){h=!0,r=i,n=a;break}l=l.sibling}if(!h){for(l=a.child;l;){if(l===n){h=!0,n=a,r=i;break}if(l===r){h=!0,r=a,n=i;break}l=l.sibling}if(!h)throw Error(ft(189))}}if(n.alternate!==r)throw Error(ft(190))}if(n.tag!==3)throw Error(ft(188));return n.stateNode.current===n?t:e}function ZM(t){return t=i5(t),t!==null?XM(t):null}function XM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=XM(t);if(e!==null)return e;t=t.sibling}return null}var YM=ao.unstable_scheduleCallback,wP=ao.unstable_cancelCallback,s5=ao.unstable_shouldYield,o5=ao.unstable_requestPaint,oi=ao.unstable_now,a5=ao.unstable_getCurrentPriorityLevel,_S=ao.unstable_ImmediatePriority,KM=ao.unstable_UserBlockingPriority,L0=ao.unstable_NormalPriority,l5=ao.unstable_LowPriority,JM=ao.unstable_IdlePriority,T_=null,La=null;function c5(t){if(La&&typeof La.onCommitFiberRoot=="function")try{La.onCommitFiberRoot(T_,t,void 0,(t.current.flags&128)===128)}catch{}}var la=Math.clz32?Math.clz32:d5,u5=Math.log,h5=Math.LN2;function d5(t){return t>>>=0,t===0?32:31-(u5(t)/h5|0)|0}var hy=64,dy=4194304;function Ep(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function R0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,h=n&268435455;if(h!==0){var l=h&~i;l!==0?r=Ep(l):(a&=h,a!==0&&(r=Ep(a)))}else h=n&~i,h!==0?r=Ep(h):a!==0&&(r=Ep(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-la(e),i=1<<n,r|=t[n],e&=~i;return r}function f5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p5(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var h=31-la(a),l=1<<h,m=i[h];m===-1?(!(l&n)||l&r)&&(i[h]=f5(l,e)):m<=e&&(t.expiredLanes|=l),a&=~l}}function R1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function QM(){var t=hy;return hy<<=1,!(hy&4194240)&&(hy=64),t}function Xx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Rm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-la(e),t[e]=n}function m5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-la(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function vS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-la(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var tr=0;function eL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tL,xS,nL,rL,iL,O1=!1,fy=[],dc=null,fc=null,pc=null,Kp=new Map,Jp=new Map,tc=[],g5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SP(t,e){switch(t){case"focusin":case"focusout":dc=null;break;case"dragenter":case"dragleave":fc=null;break;case"mouseover":case"mouseout":pc=null;break;case"pointerover":case"pointerout":Kp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jp.delete(e.pointerId)}}function np(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=zm(e),e!==null&&xS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function y5(t,e,n,r,i){switch(e){case"focusin":return dc=np(dc,t,e,n,r,i),!0;case"dragenter":return fc=np(fc,t,e,n,r,i),!0;case"mouseover":return pc=np(pc,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Kp.set(a,np(Kp.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Jp.set(a,np(Jp.get(a)||null,t,e,n,r,i)),!0}return!1}function sL(t){var e=du(t.target);if(e!==null){var n=Ou(e);if(n!==null){if(e=n.tag,e===13){if(e=qM(n),e!==null){t.blockedOn=e,iL(t.priority,function(){nL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function i0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=z1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);I1=r,n.target.dispatchEvent(r),I1=null}else return e=zm(n),e!==null&&xS(e),t.blockedOn=n,!1;e.shift()}return!0}function TP(t,e,n){i0(t)&&n.delete(e)}function _5(){O1=!1,dc!==null&&i0(dc)&&(dc=null),fc!==null&&i0(fc)&&(fc=null),pc!==null&&i0(pc)&&(pc=null),Kp.forEach(TP),Jp.forEach(TP)}function rp(t,e){t.blockedOn===e&&(t.blockedOn=null,O1||(O1=!0,ao.unstable_scheduleCallback(ao.unstable_NormalPriority,_5)))}function Qp(t){function e(i){return rp(i,t)}if(0<fy.length){rp(fy[0],t);for(var n=1;n<fy.length;n++){var r=fy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(dc!==null&&rp(dc,t),fc!==null&&rp(fc,t),pc!==null&&rp(pc,t),Kp.forEach(e),Jp.forEach(e),n=0;n<tc.length;n++)r=tc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<tc.length&&(n=tc[0],n.blockedOn===null);)sL(n),n.blockedOn===null&&tc.shift()}var ad=wl.ReactCurrentBatchConfig,O0=!0;function v5(t,e,n,r){var i=tr,a=ad.transition;ad.transition=null;try{tr=1,bS(t,e,n,r)}finally{tr=i,ad.transition=a}}function x5(t,e,n,r){var i=tr,a=ad.transition;ad.transition=null;try{tr=4,bS(t,e,n,r)}finally{tr=i,ad.transition=a}}function bS(t,e,n,r){if(O0){var i=z1(t,e,n,r);if(i===null)sb(t,e,r,z0,n),SP(t,r);else if(y5(i,t,e,n,r))r.stopPropagation();else if(SP(t,r),e&4&&-1<g5.indexOf(t)){for(;i!==null;){var a=zm(i);if(a!==null&&tL(a),a=z1(t,e,n,r),a===null&&sb(t,e,r,z0,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else sb(t,e,r,null,n)}}var z0=null;function z1(t,e,n,r){if(z0=null,t=yS(r),t=du(t),t!==null)if(e=Ou(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return z0=t,null}function oL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a5()){case _S:return 1;case KM:return 4;case L0:case l5:return 16;case JM:return 536870912;default:return 16}default:return 16}}var ic=null,wS=null,s0=null;function aL(){if(s0)return s0;var t,e=wS,n=e.length,r,i="value"in ic?ic.value:ic.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var h=n-t;for(r=1;r<=h&&e[n-r]===i[a-r];r++);return s0=i.slice(t,1<r?1-r:void 0)}function o0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function py(){return!0}function EP(){return!1}function uo(t){function e(n,r,i,a,h){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=h,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?py:EP,this.isPropagationStopped=EP,this}return Br(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=py)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=py)},persist:function(){},isPersistent:py}),e}var Gd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},SS=uo(Gd),Om=Br({},Gd,{view:0,detail:0}),b5=uo(Om),Yx,Kx,ip,E_=Br({},Om,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:TS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ip&&(ip&&t.type==="mousemove"?(Yx=t.screenX-ip.screenX,Kx=t.screenY-ip.screenY):Kx=Yx=0,ip=t),Yx)},movementY:function(t){return"movementY"in t?t.movementY:Kx}}),PP=uo(E_),w5=Br({},E_,{dataTransfer:0}),S5=uo(w5),T5=Br({},Om,{relatedTarget:0}),Jx=uo(T5),E5=Br({},Gd,{animationName:0,elapsedTime:0,pseudoElement:0}),P5=uo(E5),C5=Br({},Gd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),A5=uo(C5),I5=Br({},Gd,{data:0}),CP=uo(I5),k5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},L5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function R5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=L5[t])?!!e[t]:!1}function TS(){return R5}var O5=Br({},Om,{key:function(t){if(t.key){var e=k5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=o0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?M5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:TS,charCode:function(t){return t.type==="keypress"?o0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?o0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),z5=uo(O5),D5=Br({},E_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AP=uo(D5),F5=Br({},Om,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:TS}),N5=uo(F5),B5=Br({},Gd,{propertyName:0,elapsedTime:0,pseudoElement:0}),j5=uo(B5),V5=Br({},E_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),U5=uo(V5),$5=[9,13,27,32],ES=hl&&"CompositionEvent"in window,Rp=null;hl&&"documentMode"in document&&(Rp=document.documentMode);var G5=hl&&"TextEvent"in window&&!Rp,lL=hl&&(!ES||Rp&&8<Rp&&11>=Rp),IP=String.fromCharCode(32),kP=!1;function cL(t,e){switch(t){case"keyup":return $5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $h=!1;function W5(t,e){switch(t){case"compositionend":return uL(e);case"keypress":return e.which!==32?null:(kP=!0,IP);case"textInput":return t=e.data,t===IP&&kP?null:t;default:return null}}function H5(t,e){if($h)return t==="compositionend"||!ES&&cL(t,e)?(t=aL(),s0=wS=ic=null,$h=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lL&&e.locale!=="ko"?null:e.data;default:return null}}var q5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function MP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!q5[t.type]:e==="textarea"}function hL(t,e,n,r){UM(r),e=D0(e,"onChange"),0<e.length&&(n=new SS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Op=null,em=null;function Z5(t){wL(t,0)}function P_(t){var e=Hh(t);if(zM(e))return t}function X5(t,e){if(t==="change")return e}var dL=!1;if(hl){var Qx;if(hl){var eb="oninput"in document;if(!eb){var LP=document.createElement("div");LP.setAttribute("oninput","return;"),eb=typeof LP.oninput=="function"}Qx=eb}else Qx=!1;dL=Qx&&(!document.documentMode||9<document.documentMode)}function RP(){Op&&(Op.detachEvent("onpropertychange",fL),em=Op=null)}function fL(t){if(t.propertyName==="value"&&P_(em)){var e=[];hL(e,em,t,yS(t)),HM(Z5,e)}}function Y5(t,e,n){t==="focusin"?(RP(),Op=e,em=n,Op.attachEvent("onpropertychange",fL)):t==="focusout"&&RP()}function K5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return P_(em)}function J5(t,e){if(t==="click")return P_(e)}function Q5(t,e){if(t==="input"||t==="change")return P_(e)}function eN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ha=typeof Object.is=="function"?Object.is:eN;function tm(t,e){if(ha(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!y1.call(e,i)||!ha(t[i],e[i]))return!1}return!0}function OP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zP(t,e){var n=OP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=OP(n)}}function pL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?pL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mL(){for(var t=window,e=I0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=I0(t.document)}return e}function PS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function tN(t){var e=mL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&pL(n.ownerDocument.documentElement,n)){if(r!==null&&PS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=zP(n,a);var h=zP(n,r);i&&h&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==h.node||t.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var nN=hl&&"documentMode"in document&&11>=document.documentMode,Gh=null,D1=null,zp=null,F1=!1;function DP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;F1||Gh==null||Gh!==I0(r)||(r=Gh,"selectionStart"in r&&PS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zp&&tm(zp,r)||(zp=r,r=D0(D1,"onSelect"),0<r.length&&(e=new SS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Gh)))}function my(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Wh={animationend:my("Animation","AnimationEnd"),animationiteration:my("Animation","AnimationIteration"),animationstart:my("Animation","AnimationStart"),transitionend:my("Transition","TransitionEnd")},tb={},gL={};hl&&(gL=document.createElement("div").style,"AnimationEvent"in window||(delete Wh.animationend.animation,delete Wh.animationiteration.animation,delete Wh.animationstart.animation),"TransitionEvent"in window||delete Wh.transitionend.transition);function C_(t){if(tb[t])return tb[t];if(!Wh[t])return t;var e=Wh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in gL)return tb[t]=e[n];return t}var yL=C_("animationend"),_L=C_("animationiteration"),vL=C_("animationstart"),xL=C_("transitionend"),bL=new Map,FP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cc(t,e){bL.set(t,e),Ru(e,[t])}for(var nb=0;nb<FP.length;nb++){var rb=FP[nb],rN=rb.toLowerCase(),iN=rb[0].toUpperCase()+rb.slice(1);Cc(rN,"on"+iN)}Cc(yL,"onAnimationEnd");Cc(_L,"onAnimationIteration");Cc(vL,"onAnimationStart");Cc("dblclick","onDoubleClick");Cc("focusin","onFocus");Cc("focusout","onBlur");Cc(xL,"onTransitionEnd");gd("onMouseEnter",["mouseout","mouseover"]);gd("onMouseLeave",["mouseout","mouseover"]);gd("onPointerEnter",["pointerout","pointerover"]);gd("onPointerLeave",["pointerout","pointerover"]);Ru("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ru("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ru("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ru("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ru("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ru("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pp));function NP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,r5(r,e,void 0,t),t.currentTarget=null}function wL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var h=r.length-1;0<=h;h--){var l=r[h],m=l.instance,_=l.currentTarget;if(l=l.listener,m!==a&&i.isPropagationStopped())break e;NP(i,l,_),a=m}else for(h=0;h<r.length;h++){if(l=r[h],m=l.instance,_=l.currentTarget,l=l.listener,m!==a&&i.isPropagationStopped())break e;NP(i,l,_),a=m}}}if(M0)throw t=L1,M0=!1,L1=null,t}function Sr(t,e){var n=e[U1];n===void 0&&(n=e[U1]=new Set);var r=t+"__bubble";n.has(r)||(SL(e,t,2,!1),n.add(r))}function ib(t,e,n){var r=0;e&&(r|=4),SL(n,t,r,e)}var gy="_reactListening"+Math.random().toString(36).slice(2);function nm(t){if(!t[gy]){t[gy]=!0,kM.forEach(function(n){n!=="selectionchange"&&(sN.has(n)||ib(n,!1,t),ib(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[gy]||(e[gy]=!0,ib("selectionchange",!1,e))}}function SL(t,e,n,r){switch(oL(e)){case 1:var i=v5;break;case 4:i=x5;break;default:i=bS}n=i.bind(null,e,n,t),i=void 0,!M1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function sb(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(h===4)for(h=r.return;h!==null;){var m=h.tag;if((m===3||m===4)&&(m=h.stateNode.containerInfo,m===i||m.nodeType===8&&m.parentNode===i))return;h=h.return}for(;l!==null;){if(h=du(l),h===null)return;if(m=h.tag,m===5||m===6){r=a=h;continue e}l=l.parentNode}}r=r.return}HM(function(){var _=a,S=yS(n),P=[];e:{var C=bL.get(t);if(C!==void 0){var L=SS,R=t;switch(t){case"keypress":if(o0(n)===0)break e;case"keydown":case"keyup":L=z5;break;case"focusin":R="focus",L=Jx;break;case"focusout":R="blur",L=Jx;break;case"beforeblur":case"afterblur":L=Jx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=PP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=S5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=N5;break;case yL:case _L:case vL:L=P5;break;case xL:L=j5;break;case"scroll":L=b5;break;case"wheel":L=U5;break;case"copy":case"cut":case"paste":L=A5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=AP}var D=(e&4)!==0,W=!D&&t==="scroll",z=D?C!==null?C+"Capture":null:C;D=[];for(var N=_,F;N!==null;){F=N;var $=F.stateNode;if(F.tag===5&&$!==null&&(F=$,z!==null&&($=Yp(N,z),$!=null&&D.push(rm(N,$,F)))),W)break;N=N.return}0<D.length&&(C=new L(C,R,null,n,S),P.push({event:C,listeners:D}))}}if(!(e&7)){e:{if(C=t==="mouseover"||t==="pointerover",L=t==="mouseout"||t==="pointerout",C&&n!==I1&&(R=n.relatedTarget||n.fromElement)&&(du(R)||R[dl]))break e;if((L||C)&&(C=S.window===S?S:(C=S.ownerDocument)?C.defaultView||C.parentWindow:window,L?(R=n.relatedTarget||n.toElement,L=_,R=R?du(R):null,R!==null&&(W=Ou(R),R!==W||R.tag!==5&&R.tag!==6)&&(R=null)):(L=null,R=_),L!==R)){if(D=PP,$="onMouseLeave",z="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(D=AP,$="onPointerLeave",z="onPointerEnter",N="pointer"),W=L==null?C:Hh(L),F=R==null?C:Hh(R),C=new D($,N+"leave",L,n,S),C.target=W,C.relatedTarget=F,$=null,du(S)===_&&(D=new D(z,N+"enter",R,n,S),D.target=F,D.relatedTarget=W,$=D),W=$,L&&R)t:{for(D=L,z=R,N=0,F=D;F;F=wh(F))N++;for(F=0,$=z;$;$=wh($))F++;for(;0<N-F;)D=wh(D),N--;for(;0<F-N;)z=wh(z),F--;for(;N--;){if(D===z||z!==null&&D===z.alternate)break t;D=wh(D),z=wh(z)}D=null}else D=null;L!==null&&BP(P,C,L,D,!1),R!==null&&W!==null&&BP(P,W,R,D,!0)}}e:{if(C=_?Hh(_):window,L=C.nodeName&&C.nodeName.toLowerCase(),L==="select"||L==="input"&&C.type==="file")var K=X5;else if(MP(C))if(dL)K=Q5;else{K=K5;var ne=Y5}else(L=C.nodeName)&&L.toLowerCase()==="input"&&(C.type==="checkbox"||C.type==="radio")&&(K=J5);if(K&&(K=K(t,_))){hL(P,K,n,S);break e}ne&&ne(t,C,_),t==="focusout"&&(ne=C._wrapperState)&&ne.controlled&&C.type==="number"&&T1(C,"number",C.value)}switch(ne=_?Hh(_):window,t){case"focusin":(MP(ne)||ne.contentEditable==="true")&&(Gh=ne,D1=_,zp=null);break;case"focusout":zp=D1=Gh=null;break;case"mousedown":F1=!0;break;case"contextmenu":case"mouseup":case"dragend":F1=!1,DP(P,n,S);break;case"selectionchange":if(nN)break;case"keydown":case"keyup":DP(P,n,S)}var se;if(ES)e:{switch(t){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else $h?cL(t,n)&&(xe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(xe="onCompositionStart");xe&&(lL&&n.locale!=="ko"&&($h||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&$h&&(se=aL()):(ic=S,wS="value"in ic?ic.value:ic.textContent,$h=!0)),ne=D0(_,xe),0<ne.length&&(xe=new CP(xe,t,null,n,S),P.push({event:xe,listeners:ne}),se?xe.data=se:(se=uL(n),se!==null&&(xe.data=se)))),(se=G5?W5(t,n):H5(t,n))&&(_=D0(_,"onBeforeInput"),0<_.length&&(S=new CP("onBeforeInput","beforeinput",null,n,S),P.push({event:S,listeners:_}),S.data=se))}wL(P,e)})}function rm(t,e,n){return{instance:t,listener:e,currentTarget:n}}function D0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Yp(t,n),a!=null&&r.unshift(rm(t,a,i)),a=Yp(t,e),a!=null&&r.push(rm(t,a,i))),t=t.return}return r}function wh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function BP(t,e,n,r,i){for(var a=e._reactName,h=[];n!==null&&n!==r;){var l=n,m=l.alternate,_=l.stateNode;if(m!==null&&m===r)break;l.tag===5&&_!==null&&(l=_,i?(m=Yp(n,a),m!=null&&h.unshift(rm(n,m,l))):i||(m=Yp(n,a),m!=null&&h.push(rm(n,m,l)))),n=n.return}h.length!==0&&t.push({event:e,listeners:h})}var oN=/\r\n?/g,aN=/\u0000|\uFFFD/g;function jP(t){return(typeof t=="string"?t:""+t).replace(oN,`
`).replace(aN,"")}function yy(t,e,n){if(e=jP(e),jP(t)!==e&&n)throw Error(ft(425))}function F0(){}var N1=null,B1=null;function j1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var V1=typeof setTimeout=="function"?setTimeout:void 0,lN=typeof clearTimeout=="function"?clearTimeout:void 0,VP=typeof Promise=="function"?Promise:void 0,cN=typeof queueMicrotask=="function"?queueMicrotask:typeof VP<"u"?function(t){return VP.resolve(null).then(t).catch(uN)}:V1;function uN(t){setTimeout(function(){throw t})}function ob(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Qp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Qp(e)}function mc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function UP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wd=Math.random().toString(36).slice(2),Aa="__reactFiber$"+Wd,im="__reactProps$"+Wd,dl="__reactContainer$"+Wd,U1="__reactEvents$"+Wd,hN="__reactListeners$"+Wd,dN="__reactHandles$"+Wd;function du(t){var e=t[Aa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[dl]||n[Aa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=UP(t);t!==null;){if(n=t[Aa])return n;t=UP(t)}return e}t=n,n=t.parentNode}return null}function zm(t){return t=t[Aa]||t[dl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ft(33))}function A_(t){return t[im]||null}var $1=[],qh=-1;function Ac(t){return{current:t}}function Er(t){0>qh||(t.current=$1[qh],$1[qh]=null,qh--)}function vr(t,e){qh++,$1[qh]=t.current,t.current=e}var Tc={},ls=Ac(Tc),Ds=Ac(!1),Tu=Tc;function yd(t,e){var n=t.type.contextTypes;if(!n)return Tc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Fs(t){return t=t.childContextTypes,t!=null}function N0(){Er(Ds),Er(ls)}function $P(t,e,n){if(ls.current!==Tc)throw Error(ft(168));vr(ls,e),vr(Ds,n)}function TL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ft(108,Y4(t)||"Unknown",i));return Br({},n,r)}function B0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Tc,Tu=ls.current,vr(ls,t),vr(Ds,Ds.current),!0}function GP(t,e,n){var r=t.stateNode;if(!r)throw Error(ft(169));n?(t=TL(t,e,Tu),r.__reactInternalMemoizedMergedChildContext=t,Er(Ds),Er(ls),vr(ls,t)):Er(Ds),vr(Ds,n)}var sl=null,I_=!1,ab=!1;function EL(t){sl===null?sl=[t]:sl.push(t)}function fN(t){I_=!0,EL(t)}function Ic(){if(!ab&&sl!==null){ab=!0;var t=0,e=tr;try{var n=sl;for(tr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}sl=null,I_=!1}catch(i){throw sl!==null&&(sl=sl.slice(t+1)),YM(_S,Ic),i}finally{tr=e,ab=!1}}return null}var Zh=[],Xh=0,j0=null,V0=0,Co=[],Ao=0,Eu=null,ll=1,cl="";function iu(t,e){Zh[Xh++]=V0,Zh[Xh++]=j0,j0=t,V0=e}function PL(t,e,n){Co[Ao++]=ll,Co[Ao++]=cl,Co[Ao++]=Eu,Eu=t;var r=ll;t=cl;var i=32-la(r)-1;r&=~(1<<i),n+=1;var a=32-la(e)+i;if(30<a){var h=i-i%5;a=(r&(1<<h)-1).toString(32),r>>=h,i-=h,ll=1<<32-la(e)+i|n<<i|r,cl=a+t}else ll=1<<a|n<<i|r,cl=t}function CS(t){t.return!==null&&(iu(t,1),PL(t,1,0))}function AS(t){for(;t===j0;)j0=Zh[--Xh],Zh[Xh]=null,V0=Zh[--Xh],Zh[Xh]=null;for(;t===Eu;)Eu=Co[--Ao],Co[Ao]=null,cl=Co[--Ao],Co[Ao]=null,ll=Co[--Ao],Co[Ao]=null}var ro=null,to=null,Lr=!1,sa=null;function CL(t,e){var n=ko(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function WP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ro=t,to=mc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ro=t,to=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Eu!==null?{id:ll,overflow:cl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ko(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ro=t,to=null,!0):!1;default:return!1}}function G1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function W1(t){if(Lr){var e=to;if(e){var n=e;if(!WP(t,e)){if(G1(t))throw Error(ft(418));e=mc(n.nextSibling);var r=ro;e&&WP(t,e)?CL(r,n):(t.flags=t.flags&-4097|2,Lr=!1,ro=t)}}else{if(G1(t))throw Error(ft(418));t.flags=t.flags&-4097|2,Lr=!1,ro=t}}}function HP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ro=t}function _y(t){if(t!==ro)return!1;if(!Lr)return HP(t),Lr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!j1(t.type,t.memoizedProps)),e&&(e=to)){if(G1(t))throw AL(),Error(ft(418));for(;e;)CL(t,e),e=mc(e.nextSibling)}if(HP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ft(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){to=mc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}to=null}}else to=ro?mc(t.stateNode.nextSibling):null;return!0}function AL(){for(var t=to;t;)t=mc(t.nextSibling)}function _d(){to=ro=null,Lr=!1}function IS(t){sa===null?sa=[t]:sa.push(t)}var pN=wl.ReactCurrentBatchConfig;function sp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ft(309));var r=n.stateNode}if(!r)throw Error(ft(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(h){var l=i.refs;h===null?delete l[a]:l[a]=h},e._stringRef=a,e)}if(typeof t!="string")throw Error(ft(284));if(!n._owner)throw Error(ft(290,t))}return t}function vy(t,e){throw t=Object.prototype.toString.call(e),Error(ft(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qP(t){var e=t._init;return e(t._payload)}function IL(t){function e(z,N){if(t){var F=z.deletions;F===null?(z.deletions=[N],z.flags|=16):F.push(N)}}function n(z,N){if(!t)return null;for(;N!==null;)e(z,N),N=N.sibling;return null}function r(z,N){for(z=new Map;N!==null;)N.key!==null?z.set(N.key,N):z.set(N.index,N),N=N.sibling;return z}function i(z,N){return z=vc(z,N),z.index=0,z.sibling=null,z}function a(z,N,F){return z.index=F,t?(F=z.alternate,F!==null?(F=F.index,F<N?(z.flags|=2,N):F):(z.flags|=2,N)):(z.flags|=1048576,N)}function h(z){return t&&z.alternate===null&&(z.flags|=2),z}function l(z,N,F,$){return N===null||N.tag!==6?(N=pb(F,z.mode,$),N.return=z,N):(N=i(N,F),N.return=z,N)}function m(z,N,F,$){var K=F.type;return K===Uh?S(z,N,F.props.children,$,F.key):N!==null&&(N.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Ql&&qP(K)===N.type)?($=i(N,F.props),$.ref=sp(z,N,F),$.return=z,$):($=f0(F.type,F.key,F.props,null,z.mode,$),$.ref=sp(z,N,F),$.return=z,$)}function _(z,N,F,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=mb(F,z.mode,$),N.return=z,N):(N=i(N,F.children||[]),N.return=z,N)}function S(z,N,F,$,K){return N===null||N.tag!==7?(N=xu(F,z.mode,$,K),N.return=z,N):(N=i(N,F),N.return=z,N)}function P(z,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return N=pb(""+N,z.mode,F),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ly:return F=f0(N.type,N.key,N.props,null,z.mode,F),F.ref=sp(z,null,N),F.return=z,F;case Vh:return N=mb(N,z.mode,F),N.return=z,N;case Ql:var $=N._init;return P(z,$(N._payload),F)}if(Tp(N)||ep(N))return N=xu(N,z.mode,F,null),N.return=z,N;vy(z,N)}return null}function C(z,N,F,$){var K=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return K!==null?null:l(z,N,""+F,$);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case ly:return F.key===K?m(z,N,F,$):null;case Vh:return F.key===K?_(z,N,F,$):null;case Ql:return K=F._init,C(z,N,K(F._payload),$)}if(Tp(F)||ep(F))return K!==null?null:S(z,N,F,$,null);vy(z,F)}return null}function L(z,N,F,$,K){if(typeof $=="string"&&$!==""||typeof $=="number")return z=z.get(F)||null,l(N,z,""+$,K);if(typeof $=="object"&&$!==null){switch($.$$typeof){case ly:return z=z.get($.key===null?F:$.key)||null,m(N,z,$,K);case Vh:return z=z.get($.key===null?F:$.key)||null,_(N,z,$,K);case Ql:var ne=$._init;return L(z,N,F,ne($._payload),K)}if(Tp($)||ep($))return z=z.get(F)||null,S(N,z,$,K,null);vy(N,$)}return null}function R(z,N,F,$){for(var K=null,ne=null,se=N,xe=N=0,Se=null;se!==null&&xe<F.length;xe++){se.index>xe?(Se=se,se=null):Se=se.sibling;var _e=C(z,se,F[xe],$);if(_e===null){se===null&&(se=Se);break}t&&se&&_e.alternate===null&&e(z,se),N=a(_e,N,xe),ne===null?K=_e:ne.sibling=_e,ne=_e,se=Se}if(xe===F.length)return n(z,se),Lr&&iu(z,xe),K;if(se===null){for(;xe<F.length;xe++)se=P(z,F[xe],$),se!==null&&(N=a(se,N,xe),ne===null?K=se:ne.sibling=se,ne=se);return Lr&&iu(z,xe),K}for(se=r(z,se);xe<F.length;xe++)Se=L(se,z,xe,F[xe],$),Se!==null&&(t&&Se.alternate!==null&&se.delete(Se.key===null?xe:Se.key),N=a(Se,N,xe),ne===null?K=Se:ne.sibling=Se,ne=Se);return t&&se.forEach(function(Re){return e(z,Re)}),Lr&&iu(z,xe),K}function D(z,N,F,$){var K=ep(F);if(typeof K!="function")throw Error(ft(150));if(F=K.call(F),F==null)throw Error(ft(151));for(var ne=K=null,se=N,xe=N=0,Se=null,_e=F.next();se!==null&&!_e.done;xe++,_e=F.next()){se.index>xe?(Se=se,se=null):Se=se.sibling;var Re=C(z,se,_e.value,$);if(Re===null){se===null&&(se=Se);break}t&&se&&Re.alternate===null&&e(z,se),N=a(Re,N,xe),ne===null?K=Re:ne.sibling=Re,ne=Re,se=Se}if(_e.done)return n(z,se),Lr&&iu(z,xe),K;if(se===null){for(;!_e.done;xe++,_e=F.next())_e=P(z,_e.value,$),_e!==null&&(N=a(_e,N,xe),ne===null?K=_e:ne.sibling=_e,ne=_e);return Lr&&iu(z,xe),K}for(se=r(z,se);!_e.done;xe++,_e=F.next())_e=L(se,z,xe,_e.value,$),_e!==null&&(t&&_e.alternate!==null&&se.delete(_e.key===null?xe:_e.key),N=a(_e,N,xe),ne===null?K=_e:ne.sibling=_e,ne=_e);return t&&se.forEach(function(De){return e(z,De)}),Lr&&iu(z,xe),K}function W(z,N,F,$){if(typeof F=="object"&&F!==null&&F.type===Uh&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case ly:e:{for(var K=F.key,ne=N;ne!==null;){if(ne.key===K){if(K=F.type,K===Uh){if(ne.tag===7){n(z,ne.sibling),N=i(ne,F.props.children),N.return=z,z=N;break e}}else if(ne.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Ql&&qP(K)===ne.type){n(z,ne.sibling),N=i(ne,F.props),N.ref=sp(z,ne,F),N.return=z,z=N;break e}n(z,ne);break}else e(z,ne);ne=ne.sibling}F.type===Uh?(N=xu(F.props.children,z.mode,$,F.key),N.return=z,z=N):($=f0(F.type,F.key,F.props,null,z.mode,$),$.ref=sp(z,N,F),$.return=z,z=$)}return h(z);case Vh:e:{for(ne=F.key;N!==null;){if(N.key===ne)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){n(z,N.sibling),N=i(N,F.children||[]),N.return=z,z=N;break e}else{n(z,N);break}else e(z,N);N=N.sibling}N=mb(F,z.mode,$),N.return=z,z=N}return h(z);case Ql:return ne=F._init,W(z,N,ne(F._payload),$)}if(Tp(F))return R(z,N,F,$);if(ep(F))return D(z,N,F,$);vy(z,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,N!==null&&N.tag===6?(n(z,N.sibling),N=i(N,F),N.return=z,z=N):(n(z,N),N=pb(F,z.mode,$),N.return=z,z=N),h(z)):n(z,N)}return W}var vd=IL(!0),kL=IL(!1),U0=Ac(null),$0=null,Yh=null,kS=null;function MS(){kS=Yh=$0=null}function LS(t){var e=U0.current;Er(U0),t._currentValue=e}function H1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ld(t,e){$0=t,kS=Yh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Os=!0),t.firstContext=null)}function zo(t){var e=t._currentValue;if(kS!==t)if(t={context:t,memoizedValue:e,next:null},Yh===null){if($0===null)throw Error(ft(308));Yh=t,$0.dependencies={lanes:0,firstContext:t}}else Yh=Yh.next=t;return e}var fu=null;function RS(t){fu===null?fu=[t]:fu.push(t)}function ML(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,RS(e)):(n.next=i.next,i.next=n),e.interleaved=n,fl(t,r)}function fl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ec=!1;function OS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ul(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Wn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fl(t,n)}return i=r.interleaved,i===null?(e.next=e,RS(r)):(e.next=i.next,i.next=e),r.interleaved=e,fl(t,n)}function a0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vS(t,n)}}function ZP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=h:a=a.next=h,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function G0(t,e,n,r){var i=t.updateQueue;ec=!1;var a=i.firstBaseUpdate,h=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var m=l,_=m.next;m.next=null,h===null?a=_:h.next=_,h=m;var S=t.alternate;S!==null&&(S=S.updateQueue,l=S.lastBaseUpdate,l!==h&&(l===null?S.firstBaseUpdate=_:l.next=_,S.lastBaseUpdate=m))}if(a!==null){var P=i.baseState;h=0,S=_=m=null,l=a;do{var C=l.lane,L=l.eventTime;if((r&C)===C){S!==null&&(S=S.next={eventTime:L,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,D=l;switch(C=e,L=n,D.tag){case 1:if(R=D.payload,typeof R=="function"){P=R.call(L,P,C);break e}P=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=D.payload,C=typeof R=="function"?R.call(L,P,C):R,C==null)break e;P=Br({},P,C);break e;case 2:ec=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,C=i.effects,C===null?i.effects=[l]:C.push(l))}else L={eventTime:L,lane:C,tag:l.tag,payload:l.payload,callback:l.callback,next:null},S===null?(_=S=L,m=P):S=S.next=L,h|=C;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;C=l,l=C.next,C.next=null,i.lastBaseUpdate=C,i.shared.pending=null}}while(1);if(S===null&&(m=P),i.baseState=m,i.firstBaseUpdate=_,i.lastBaseUpdate=S,e=i.shared.interleaved,e!==null){i=e;do h|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Cu|=h,t.lanes=h,t.memoizedState=P}}function XP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ft(191,i));i.call(r)}}}var Dm={},Ra=Ac(Dm),sm=Ac(Dm),om=Ac(Dm);function pu(t){if(t===Dm)throw Error(ft(174));return t}function zS(t,e){switch(vr(om,e),vr(sm,t),vr(Ra,Dm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:P1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=P1(e,t)}Er(Ra),vr(Ra,e)}function xd(){Er(Ra),Er(sm),Er(om)}function RL(t){pu(om.current);var e=pu(Ra.current),n=P1(e,t.type);e!==n&&(vr(sm,t),vr(Ra,n))}function DS(t){sm.current===t&&(Er(Ra),Er(sm))}var Dr=Ac(0);function W0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var lb=[];function FS(){for(var t=0;t<lb.length;t++)lb[t]._workInProgressVersionPrimary=null;lb.length=0}var l0=wl.ReactCurrentDispatcher,cb=wl.ReactCurrentBatchConfig,Pu=0,Nr=null,_i=null,Pi=null,H0=!1,Dp=!1,am=0,mN=0;function es(){throw Error(ft(321))}function NS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ha(t[n],e[n]))return!1;return!0}function BS(t,e,n,r,i,a){if(Pu=a,Nr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,l0.current=t===null||t.memoizedState===null?vN:xN,t=n(r,i),Dp){a=0;do{if(Dp=!1,am=0,25<=a)throw Error(ft(301));a+=1,Pi=_i=null,e.updateQueue=null,l0.current=bN,t=n(r,i)}while(Dp)}if(l0.current=q0,e=_i!==null&&_i.next!==null,Pu=0,Pi=_i=Nr=null,H0=!1,e)throw Error(ft(300));return t}function jS(){var t=am!==0;return am=0,t}function Ea(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pi===null?Nr.memoizedState=Pi=t:Pi=Pi.next=t,Pi}function Do(){if(_i===null){var t=Nr.alternate;t=t!==null?t.memoizedState:null}else t=_i.next;var e=Pi===null?Nr.memoizedState:Pi.next;if(e!==null)Pi=e,_i=t;else{if(t===null)throw Error(ft(310));_i=t,t={memoizedState:_i.memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},Pi===null?Nr.memoizedState=Pi=t:Pi=Pi.next=t}return Pi}function lm(t,e){return typeof e=="function"?e(t):e}function ub(t){var e=Do(),n=e.queue;if(n===null)throw Error(ft(311));n.lastRenderedReducer=t;var r=_i,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var h=i.next;i.next=a.next,a.next=h}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=h=null,m=null,_=a;do{var S=_.lane;if((Pu&S)===S)m!==null&&(m=m.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),r=_.hasEagerState?_.eagerState:t(r,_.action);else{var P={lane:S,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};m===null?(l=m=P,h=r):m=m.next=P,Nr.lanes|=S,Cu|=S}_=_.next}while(_!==null&&_!==a);m===null?h=r:m.next=l,ha(r,e.memoizedState)||(Os=!0),e.memoizedState=r,e.baseState=h,e.baseQueue=m,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,Nr.lanes|=a,Cu|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function hb(t){var e=Do(),n=e.queue;if(n===null)throw Error(ft(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var h=i=i.next;do a=t(a,h.action),h=h.next;while(h!==i);ha(a,e.memoizedState)||(Os=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function OL(){}function zL(t,e){var n=Nr,r=Do(),i=e(),a=!ha(r.memoizedState,i);if(a&&(r.memoizedState=i,Os=!0),r=r.queue,VS(NL.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Pi!==null&&Pi.memoizedState.tag&1){if(n.flags|=2048,cm(9,FL.bind(null,n,r,i,e),void 0,null),Ai===null)throw Error(ft(349));Pu&30||DL(n,e,i)}return i}function DL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function FL(t,e,n,r){e.value=n,e.getSnapshot=r,BL(e)&&jL(t)}function NL(t,e,n){return n(function(){BL(e)&&jL(t)})}function BL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ha(t,n)}catch{return!0}}function jL(t){var e=fl(t,1);e!==null&&ca(e,t,1,-1)}function YP(t){var e=Ea();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lm,lastRenderedState:t},e.queue=t,t=t.dispatch=_N.bind(null,Nr,t),[e.memoizedState,t]}function cm(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function VL(){return Do().memoizedState}function c0(t,e,n,r){var i=Ea();Nr.flags|=t,i.memoizedState=cm(1|e,n,void 0,r===void 0?null:r)}function k_(t,e,n,r){var i=Do();r=r===void 0?null:r;var a=void 0;if(_i!==null){var h=_i.memoizedState;if(a=h.destroy,r!==null&&NS(r,h.deps)){i.memoizedState=cm(e,n,a,r);return}}Nr.flags|=t,i.memoizedState=cm(1|e,n,a,r)}function KP(t,e){return c0(8390656,8,t,e)}function VS(t,e){return k_(2048,8,t,e)}function UL(t,e){return k_(4,2,t,e)}function $L(t,e){return k_(4,4,t,e)}function GL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WL(t,e,n){return n=n!=null?n.concat([t]):null,k_(4,4,GL.bind(null,e,t),n)}function US(){}function HL(t,e){var n=Do();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&NS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function qL(t,e){var n=Do();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&NS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ZL(t,e,n){return Pu&21?(ha(n,e)||(n=QM(),Nr.lanes|=n,Cu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Os=!0),t.memoizedState=n)}function gN(t,e){var n=tr;tr=n!==0&&4>n?n:4,t(!0);var r=cb.transition;cb.transition={};try{t(!1),e()}finally{tr=n,cb.transition=r}}function XL(){return Do().memoizedState}function yN(t,e,n){var r=_c(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},YL(t))KL(e,n);else if(n=ML(t,e,n,r),n!==null){var i=Ts();ca(n,t,r,i),JL(n,e,r)}}function _N(t,e,n){var r=_c(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(YL(t))KL(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var h=e.lastRenderedState,l=a(h,n);if(i.hasEagerState=!0,i.eagerState=l,ha(l,h)){var m=e.interleaved;m===null?(i.next=i,RS(e)):(i.next=m.next,m.next=i),e.interleaved=i;return}}catch{}finally{}n=ML(t,e,i,r),n!==null&&(i=Ts(),ca(n,t,r,i),JL(n,e,r))}}function YL(t){var e=t.alternate;return t===Nr||e!==null&&e===Nr}function KL(t,e){Dp=H0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function JL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vS(t,n)}}var q0={readContext:zo,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},vN={readContext:zo,useCallback:function(t,e){return Ea().memoizedState=[t,e===void 0?null:e],t},useContext:zo,useEffect:KP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,c0(4194308,4,GL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return c0(4194308,4,t,e)},useInsertionEffect:function(t,e){return c0(4,2,t,e)},useMemo:function(t,e){var n=Ea();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ea();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=yN.bind(null,Nr,t),[r.memoizedState,t]},useRef:function(t){var e=Ea();return t={current:t},e.memoizedState=t},useState:YP,useDebugValue:US,useDeferredValue:function(t){return Ea().memoizedState=t},useTransition:function(){var t=YP(!1),e=t[0];return t=gN.bind(null,t[1]),Ea().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Nr,i=Ea();if(Lr){if(n===void 0)throw Error(ft(407));n=n()}else{if(n=e(),Ai===null)throw Error(ft(349));Pu&30||DL(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,KP(NL.bind(null,r,a,t),[t]),r.flags|=2048,cm(9,FL.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Ea(),e=Ai.identifierPrefix;if(Lr){var n=cl,r=ll;n=(r&~(1<<32-la(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=am++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=mN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},xN={readContext:zo,useCallback:HL,useContext:zo,useEffect:VS,useImperativeHandle:WL,useInsertionEffect:UL,useLayoutEffect:$L,useMemo:qL,useReducer:ub,useRef:VL,useState:function(){return ub(lm)},useDebugValue:US,useDeferredValue:function(t){var e=Do();return ZL(e,_i.memoizedState,t)},useTransition:function(){var t=ub(lm)[0],e=Do().memoizedState;return[t,e]},useMutableSource:OL,useSyncExternalStore:zL,useId:XL,unstable_isNewReconciler:!1},bN={readContext:zo,useCallback:HL,useContext:zo,useEffect:VS,useImperativeHandle:WL,useInsertionEffect:UL,useLayoutEffect:$L,useMemo:qL,useReducer:hb,useRef:VL,useState:function(){return hb(lm)},useDebugValue:US,useDeferredValue:function(t){var e=Do();return _i===null?e.memoizedState=t:ZL(e,_i.memoizedState,t)},useTransition:function(){var t=hb(lm)[0],e=Do().memoizedState;return[t,e]},useMutableSource:OL,useSyncExternalStore:zL,useId:XL,unstable_isNewReconciler:!1};function ra(t,e){if(t&&t.defaultProps){e=Br({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function q1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Br({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var M_={isMounted:function(t){return(t=t._reactInternals)?Ou(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ts(),i=_c(t),a=ul(r,i);a.payload=e,n!=null&&(a.callback=n),e=gc(t,a,i),e!==null&&(ca(e,t,i,r),a0(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ts(),i=_c(t),a=ul(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=gc(t,a,i),e!==null&&(ca(e,t,i,r),a0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ts(),r=_c(t),i=ul(n,r);i.tag=2,e!=null&&(i.callback=e),e=gc(t,i,r),e!==null&&(ca(e,t,r,n),a0(e,t,r))}};function JP(t,e,n,r,i,a,h){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,h):e.prototype&&e.prototype.isPureReactComponent?!tm(n,r)||!tm(i,a):!0}function QL(t,e,n){var r=!1,i=Tc,a=e.contextType;return typeof a=="object"&&a!==null?a=zo(a):(i=Fs(e)?Tu:ls.current,r=e.contextTypes,a=(r=r!=null)?yd(t,i):Tc),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=M_,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function QP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&M_.enqueueReplaceState(e,e.state,null)}function Z1(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},OS(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=zo(a):(a=Fs(e)?Tu:ls.current,i.context=yd(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(q1(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&M_.enqueueReplaceState(i,i.state,null),G0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bd(t,e){try{var n="",r=e;do n+=X4(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function db(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function X1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var wN=typeof WeakMap=="function"?WeakMap:Map;function eR(t,e,n){n=ul(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){X0||(X0=!0,sw=r),X1(t,e)},n}function tR(t,e,n){n=ul(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){X1(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){X1(t,e),typeof r!="function"&&(yc===null?yc=new Set([this]):yc.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),n}function eC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new wN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=DN.bind(null,t,e,n),e.then(t,t))}function tC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nC(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ul(-1,1),e.tag=2,gc(n,e,1))),n.lanes|=1),t)}var SN=wl.ReactCurrentOwner,Os=!1;function bs(t,e,n,r){e.child=t===null?kL(e,null,n,r):vd(e,t.child,n,r)}function rC(t,e,n,r,i){n=n.render;var a=e.ref;return ld(e,i),r=BS(t,e,n,r,a,i),n=jS(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pl(t,e,i)):(Lr&&n&&CS(e),e.flags|=1,bs(t,e,r,i),e.child)}function iC(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!YS(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,nR(t,e,a,r,i)):(t=f0(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var h=a.memoizedProps;if(n=n.compare,n=n!==null?n:tm,n(h,r)&&t.ref===e.ref)return pl(t,e,i)}return e.flags|=1,t=vc(a,r),t.ref=e.ref,t.return=e,e.child=t}function nR(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(tm(a,r)&&t.ref===e.ref)if(Os=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(Os=!0);else return e.lanes=t.lanes,pl(t,e,i)}return Y1(t,e,n,r,i)}function rR(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(Jh,Ks),Ks|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vr(Jh,Ks),Ks|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,vr(Jh,Ks),Ks|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,vr(Jh,Ks),Ks|=r;return bs(t,e,i,n),e.child}function iR(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Y1(t,e,n,r,i){var a=Fs(n)?Tu:ls.current;return a=yd(e,a),ld(e,i),n=BS(t,e,n,r,a,i),r=jS(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pl(t,e,i)):(Lr&&r&&CS(e),e.flags|=1,bs(t,e,n,i),e.child)}function sC(t,e,n,r,i){if(Fs(n)){var a=!0;B0(e)}else a=!1;if(ld(e,i),e.stateNode===null)u0(t,e),QL(e,n,r),Z1(e,n,r,i),r=!0;else if(t===null){var h=e.stateNode,l=e.memoizedProps;h.props=l;var m=h.context,_=n.contextType;typeof _=="object"&&_!==null?_=zo(_):(_=Fs(n)?Tu:ls.current,_=yd(e,_));var S=n.getDerivedStateFromProps,P=typeof S=="function"||typeof h.getSnapshotBeforeUpdate=="function";P||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==r||m!==_)&&QP(e,h,r,_),ec=!1;var C=e.memoizedState;h.state=C,G0(e,r,h,i),m=e.memoizedState,l!==r||C!==m||Ds.current||ec?(typeof S=="function"&&(q1(e,n,S,r),m=e.memoizedState),(l=ec||JP(e,n,l,r,C,m,_))?(P||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),h.props=r,h.state=m,h.context=_,r=l):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{h=e.stateNode,LL(t,e),l=e.memoizedProps,_=e.type===e.elementType?l:ra(e.type,l),h.props=_,P=e.pendingProps,C=h.context,m=n.contextType,typeof m=="object"&&m!==null?m=zo(m):(m=Fs(n)?Tu:ls.current,m=yd(e,m));var L=n.getDerivedStateFromProps;(S=typeof L=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==P||C!==m)&&QP(e,h,r,m),ec=!1,C=e.memoizedState,h.state=C,G0(e,r,h,i);var R=e.memoizedState;l!==P||C!==R||Ds.current||ec?(typeof L=="function"&&(q1(e,n,L,r),R=e.memoizedState),(_=ec||JP(e,n,_,r,C,R,m)||!1)?(S||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,R,m),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,R,m)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),h.props=r,h.state=R,h.context=m,r=_):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),r=!1)}return K1(t,e,n,r,a,i)}function K1(t,e,n,r,i,a){iR(t,e);var h=(e.flags&128)!==0;if(!r&&!h)return i&&GP(e,n,!1),pl(t,e,a);r=e.stateNode,SN.current=e;var l=h&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&h?(e.child=vd(e,t.child,null,a),e.child=vd(e,null,l,a)):bs(t,e,l,a),e.memoizedState=r.state,i&&GP(e,n,!0),e.child}function sR(t){var e=t.stateNode;e.pendingContext?$P(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$P(t,e.context,!1),zS(t,e.containerInfo)}function oC(t,e,n,r,i){return _d(),IS(i),e.flags|=256,bs(t,e,n,r),e.child}var J1={dehydrated:null,treeContext:null,retryLane:0};function Q1(t){return{baseLanes:t,cachePool:null,transitions:null}}function oR(t,e,n){var r=e.pendingProps,i=Dr.current,a=!1,h=(e.flags&128)!==0,l;if((l=h)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vr(Dr,i&1),t===null)return W1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=r.children,t=r.fallback,a?(r=e.mode,a=e.child,h={mode:"hidden",children:h},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=h):a=O_(h,r,0,null),t=xu(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Q1(n),e.memoizedState=J1,t):$S(e,h));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return TN(t,e,h,r,l,i,n);if(a){a=r.fallback,h=e.mode,i=t.child,l=i.sibling;var m={mode:"hidden",children:r.children};return!(h&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=m,e.deletions=null):(r=vc(i,m),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=vc(l,a):(a=xu(a,h,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,h=t.child.memoizedState,h=h===null?Q1(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},a.memoizedState=h,a.childLanes=t.childLanes&~n,e.memoizedState=J1,r}return a=t.child,t=a.sibling,r=vc(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function $S(t,e){return e=O_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xy(t,e,n,r){return r!==null&&IS(r),vd(e,t.child,null,n),t=$S(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function TN(t,e,n,r,i,a,h){if(n)return e.flags&256?(e.flags&=-257,r=db(Error(ft(422))),xy(t,e,h,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=O_({mode:"visible",children:r.children},i,0,null),a=xu(a,i,h,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&vd(e,t.child,null,h),e.child.memoizedState=Q1(h),e.memoizedState=J1,a);if(!(e.mode&1))return xy(t,e,h,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ft(419)),r=db(a,r,void 0),xy(t,e,h,r)}if(l=(h&t.childLanes)!==0,Os||l){if(r=Ai,r!==null){switch(h&-h){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|h)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,fl(t,i),ca(r,t,i,-1))}return XS(),r=db(Error(ft(421))),xy(t,e,h,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=FN.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,to=mc(i.nextSibling),ro=e,Lr=!0,sa=null,t!==null&&(Co[Ao++]=ll,Co[Ao++]=cl,Co[Ao++]=Eu,ll=t.id,cl=t.overflow,Eu=e),e=$S(e,r.children),e.flags|=4096,e)}function aC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),H1(t.return,e,n)}function fb(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function aR(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(bs(t,e,r.children,n),r=Dr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aC(t,n,e);else if(t.tag===19)aC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vr(Dr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&W0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),fb(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&W0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}fb(e,!0,n,null,a);break;case"together":fb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function u0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Cu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ft(153));if(e.child!==null){for(t=e.child,n=vc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function EN(t,e,n){switch(e.tag){case 3:sR(e),_d();break;case 5:RL(e);break;case 1:Fs(e.type)&&B0(e);break;case 4:zS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;vr(U0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vr(Dr,Dr.current&1),e.flags|=128,null):n&e.child.childLanes?oR(t,e,n):(vr(Dr,Dr.current&1),t=pl(t,e,n),t!==null?t.sibling:null);vr(Dr,Dr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return aR(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vr(Dr,Dr.current),r)break;return null;case 22:case 23:return e.lanes=0,rR(t,e,n)}return pl(t,e,n)}var lR,ew,cR,uR;lR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ew=function(){};cR=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,pu(Ra.current);var a=null;switch(n){case"input":i=w1(t,i),r=w1(t,r),a=[];break;case"select":i=Br({},i,{value:void 0}),r=Br({},r,{value:void 0}),a=[];break;case"textarea":i=E1(t,i),r=E1(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=F0)}C1(n,r);var h;n=null;for(_ in i)if(!r.hasOwnProperty(_)&&i.hasOwnProperty(_)&&i[_]!=null)if(_==="style"){var l=i[_];for(h in l)l.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Zp.hasOwnProperty(_)?a||(a=[]):(a=a||[]).push(_,null));for(_ in r){var m=r[_];if(l=i!=null?i[_]:void 0,r.hasOwnProperty(_)&&m!==l&&(m!=null||l!=null))if(_==="style")if(l){for(h in l)!l.hasOwnProperty(h)||m&&m.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in m)m.hasOwnProperty(h)&&l[h]!==m[h]&&(n||(n={}),n[h]=m[h])}else n||(a||(a=[]),a.push(_,n)),n=m;else _==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,l=l?l.__html:void 0,m!=null&&l!==m&&(a=a||[]).push(_,m)):_==="children"?typeof m!="string"&&typeof m!="number"||(a=a||[]).push(_,""+m):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Zp.hasOwnProperty(_)?(m!=null&&_==="onScroll"&&Sr("scroll",t),a||l===m||(a=[])):(a=a||[]).push(_,m))}n&&(a=a||[]).push("style",n);var _=a;(e.updateQueue=_)&&(e.flags|=4)}};uR=function(t,e,n,r){n!==r&&(e.flags|=4)};function op(t,e){if(!Lr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PN(t,e,n){var r=e.pendingProps;switch(AS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return Fs(e.type)&&N0(),ts(e),null;case 3:return r=e.stateNode,xd(),Er(Ds),Er(ls),FS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(_y(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sa!==null&&(lw(sa),sa=null))),ew(t,e),ts(e),null;case 5:DS(e);var i=pu(om.current);if(n=e.type,t!==null&&e.stateNode!=null)cR(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ft(166));return ts(e),null}if(t=pu(Ra.current),_y(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Aa]=e,r[im]=a,t=(e.mode&1)!==0,n){case"dialog":Sr("cancel",r),Sr("close",r);break;case"iframe":case"object":case"embed":Sr("load",r);break;case"video":case"audio":for(i=0;i<Pp.length;i++)Sr(Pp[i],r);break;case"source":Sr("error",r);break;case"img":case"image":case"link":Sr("error",r),Sr("load",r);break;case"details":Sr("toggle",r);break;case"input":gP(r,a),Sr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Sr("invalid",r);break;case"textarea":_P(r,a),Sr("invalid",r)}C1(n,a),i=null;for(var h in a)if(a.hasOwnProperty(h)){var l=a[h];h==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&yy(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&yy(r.textContent,l,t),i=["children",""+l]):Zp.hasOwnProperty(h)&&l!=null&&h==="onScroll"&&Sr("scroll",r)}switch(n){case"input":cy(r),yP(r,a,!0);break;case"textarea":cy(r),vP(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=F0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{h=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=NM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=h.createElement(n,{is:r.is}):(t=h.createElement(n),n==="select"&&(h=t,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):t=h.createElementNS(t,n),t[Aa]=e,t[im]=r,lR(t,e,!1,!1),e.stateNode=t;e:{switch(h=A1(n,r),n){case"dialog":Sr("cancel",t),Sr("close",t),i=r;break;case"iframe":case"object":case"embed":Sr("load",t),i=r;break;case"video":case"audio":for(i=0;i<Pp.length;i++)Sr(Pp[i],t);i=r;break;case"source":Sr("error",t),i=r;break;case"img":case"image":case"link":Sr("error",t),Sr("load",t),i=r;break;case"details":Sr("toggle",t),i=r;break;case"input":gP(t,r),i=w1(t,r),Sr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Br({},r,{value:void 0}),Sr("invalid",t);break;case"textarea":_P(t,r),i=E1(t,r),Sr("invalid",t);break;default:i=r}C1(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var m=l[a];a==="style"?VM(t,m):a==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&BM(t,m)):a==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&Xp(t,m):typeof m=="number"&&Xp(t,""+m):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Zp.hasOwnProperty(a)?m!=null&&a==="onScroll"&&Sr("scroll",t):m!=null&&fS(t,a,m,h))}switch(n){case"input":cy(t),yP(t,r,!1);break;case"textarea":cy(t),vP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Sc(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?id(t,!!r.multiple,a,!1):r.defaultValue!=null&&id(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=F0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)uR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ft(166));if(n=pu(om.current),pu(Ra.current),_y(e)){if(r=e.stateNode,n=e.memoizedProps,r[Aa]=e,(a=r.nodeValue!==n)&&(t=ro,t!==null))switch(t.tag){case 3:yy(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yy(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Aa]=e,e.stateNode=r}return ts(e),null;case 13:if(Er(Dr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Lr&&to!==null&&e.mode&1&&!(e.flags&128))AL(),_d(),e.flags|=98560,a=!1;else if(a=_y(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(ft(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ft(317));a[Aa]=e}else _d(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),a=!1}else sa!==null&&(lw(sa),sa=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Dr.current&1?vi===0&&(vi=3):XS())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return xd(),ew(t,e),t===null&&nm(e.stateNode.containerInfo),ts(e),null;case 10:return LS(e.type._context),ts(e),null;case 17:return Fs(e.type)&&N0(),ts(e),null;case 19:if(Er(Dr),a=e.memoizedState,a===null)return ts(e),null;if(r=(e.flags&128)!==0,h=a.rendering,h===null)if(r)op(a,!1);else{if(vi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(h=W0(t),h!==null){for(e.flags|=128,op(a,!1),r=h.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,h=a.alternate,h===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,t=h.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vr(Dr,Dr.current&1|2),e.child}t=t.sibling}a.tail!==null&&oi()>wd&&(e.flags|=128,r=!0,op(a,!1),e.lanes=4194304)}else{if(!r)if(t=W0(h),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),op(a,!0),a.tail===null&&a.tailMode==="hidden"&&!h.alternate&&!Lr)return ts(e),null}else 2*oi()-a.renderingStartTime>wd&&n!==1073741824&&(e.flags|=128,r=!0,op(a,!1),e.lanes=4194304);a.isBackwards?(h.sibling=e.child,e.child=h):(n=a.last,n!==null?n.sibling=h:e.child=h,a.last=h)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=oi(),e.sibling=null,n=Dr.current,vr(Dr,r?n&1|2:n&1),e):(ts(e),null);case 22:case 23:return ZS(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ks&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(ft(156,e.tag))}function CN(t,e){switch(AS(e),e.tag){case 1:return Fs(e.type)&&N0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return xd(),Er(Ds),Er(ls),FS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return DS(e),null;case 13:if(Er(Dr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ft(340));_d()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Er(Dr),null;case 4:return xd(),null;case 10:return LS(e.type._context),null;case 22:case 23:return ZS(),null;case 24:return null;default:return null}}var by=!1,os=!1,AN=typeof WeakSet=="function"?WeakSet:Set,Xt=null;function Kh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zr(t,e,r)}else n.current=null}function tw(t,e,n){try{n()}catch(r){Zr(t,e,r)}}var lC=!1;function IN(t,e){if(N1=O0,t=mL(),PS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var h=0,l=-1,m=-1,_=0,S=0,P=t,C=null;t:for(;;){for(var L;P!==n||i!==0&&P.nodeType!==3||(l=h+i),P!==a||r!==0&&P.nodeType!==3||(m=h+r),P.nodeType===3&&(h+=P.nodeValue.length),(L=P.firstChild)!==null;)C=P,P=L;for(;;){if(P===t)break t;if(C===n&&++_===i&&(l=h),C===a&&++S===r&&(m=h),(L=P.nextSibling)!==null)break;P=C,C=P.parentNode}P=L}n=l===-1||m===-1?null:{start:l,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(B1={focusedElem:t,selectionRange:n},O0=!1,Xt=e;Xt!==null;)if(e=Xt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Xt=t;else for(;Xt!==null;){e=Xt;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var D=R.memoizedProps,W=R.memoizedState,z=e.stateNode,N=z.getSnapshotBeforeUpdate(e.elementType===e.type?D:ra(e.type,D),W);z.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch($){Zr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,Xt=t;break}Xt=e.return}return R=lC,lC=!1,R}function Fp(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&tw(e,n,a)}i=i.next}while(i!==r)}}function L_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function nw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hR(t){var e=t.alternate;e!==null&&(t.alternate=null,hR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Aa],delete e[im],delete e[U1],delete e[hN],delete e[dN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dR(t){return t.tag===5||t.tag===3||t.tag===4}function cC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rw(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=F0));else if(r!==4&&(t=t.child,t!==null))for(rw(t,e,n),t=t.sibling;t!==null;)rw(t,e,n),t=t.sibling}function iw(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(iw(t,e,n),t=t.sibling;t!==null;)iw(t,e,n),t=t.sibling}var Ni=null,ia=!1;function Wl(t,e,n){for(n=n.child;n!==null;)fR(t,e,n),n=n.sibling}function fR(t,e,n){if(La&&typeof La.onCommitFiberUnmount=="function")try{La.onCommitFiberUnmount(T_,n)}catch{}switch(n.tag){case 5:os||Kh(n,e);case 6:var r=Ni,i=ia;Ni=null,Wl(t,e,n),Ni=r,ia=i,Ni!==null&&(ia?(t=Ni,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ni.removeChild(n.stateNode));break;case 18:Ni!==null&&(ia?(t=Ni,n=n.stateNode,t.nodeType===8?ob(t.parentNode,n):t.nodeType===1&&ob(t,n),Qp(t)):ob(Ni,n.stateNode));break;case 4:r=Ni,i=ia,Ni=n.stateNode.containerInfo,ia=!0,Wl(t,e,n),Ni=r,ia=i;break;case 0:case 11:case 14:case 15:if(!os&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,h=a.destroy;a=a.tag,h!==void 0&&(a&2||a&4)&&tw(n,e,h),i=i.next}while(i!==r)}Wl(t,e,n);break;case 1:if(!os&&(Kh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Zr(n,e,l)}Wl(t,e,n);break;case 21:Wl(t,e,n);break;case 22:n.mode&1?(os=(r=os)||n.memoizedState!==null,Wl(t,e,n),os=r):Wl(t,e,n);break;default:Wl(t,e,n)}}function uC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new AN),e.forEach(function(r){var i=NN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ta(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,h=e,l=h;e:for(;l!==null;){switch(l.tag){case 5:Ni=l.stateNode,ia=!1;break e;case 3:Ni=l.stateNode.containerInfo,ia=!0;break e;case 4:Ni=l.stateNode.containerInfo,ia=!0;break e}l=l.return}if(Ni===null)throw Error(ft(160));fR(a,h,i),Ni=null,ia=!1;var m=i.alternate;m!==null&&(m.return=null),i.return=null}catch(_){Zr(i,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pR(e,t),e=e.sibling}function pR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ta(e,t),ba(t),r&4){try{Fp(3,t,t.return),L_(3,t)}catch(D){Zr(t,t.return,D)}try{Fp(5,t,t.return)}catch(D){Zr(t,t.return,D)}}break;case 1:ta(e,t),ba(t),r&512&&n!==null&&Kh(n,n.return);break;case 5:if(ta(e,t),ba(t),r&512&&n!==null&&Kh(n,n.return),t.flags&32){var i=t.stateNode;try{Xp(i,"")}catch(D){Zr(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,h=n!==null?n.memoizedProps:a,l=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&DM(i,a),A1(l,h);var _=A1(l,a);for(h=0;h<m.length;h+=2){var S=m[h],P=m[h+1];S==="style"?VM(i,P):S==="dangerouslySetInnerHTML"?BM(i,P):S==="children"?Xp(i,P):fS(i,S,P,_)}switch(l){case"input":S1(i,a);break;case"textarea":FM(i,a);break;case"select":var C=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var L=a.value;L!=null?id(i,!!a.multiple,L,!1):C!==!!a.multiple&&(a.defaultValue!=null?id(i,!!a.multiple,a.defaultValue,!0):id(i,!!a.multiple,a.multiple?[]:"",!1))}i[im]=a}catch(D){Zr(t,t.return,D)}}break;case 6:if(ta(e,t),ba(t),r&4){if(t.stateNode===null)throw Error(ft(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(D){Zr(t,t.return,D)}}break;case 3:if(ta(e,t),ba(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Qp(e.containerInfo)}catch(D){Zr(t,t.return,D)}break;case 4:ta(e,t),ba(t);break;case 13:ta(e,t),ba(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(HS=oi())),r&4&&uC(t);break;case 22:if(S=n!==null&&n.memoizedState!==null,t.mode&1?(os=(_=os)||S,ta(e,t),os=_):ta(e,t),ba(t),r&8192){if(_=t.memoizedState!==null,(t.stateNode.isHidden=_)&&!S&&t.mode&1)for(Xt=t,S=t.child;S!==null;){for(P=Xt=S;Xt!==null;){switch(C=Xt,L=C.child,C.tag){case 0:case 11:case 14:case 15:Fp(4,C,C.return);break;case 1:Kh(C,C.return);var R=C.stateNode;if(typeof R.componentWillUnmount=="function"){r=C,n=C.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(D){Zr(r,n,D)}}break;case 5:Kh(C,C.return);break;case 22:if(C.memoizedState!==null){dC(P);continue}}L!==null?(L.return=C,Xt=L):dC(P)}S=S.sibling}e:for(S=null,P=t;;){if(P.tag===5){if(S===null){S=P;try{i=P.stateNode,_?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=P.stateNode,m=P.memoizedProps.style,h=m!=null&&m.hasOwnProperty("display")?m.display:null,l.style.display=jM("display",h))}catch(D){Zr(t,t.return,D)}}}else if(P.tag===6){if(S===null)try{P.stateNode.nodeValue=_?"":P.memoizedProps}catch(D){Zr(t,t.return,D)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===t)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===t)break e;for(;P.sibling===null;){if(P.return===null||P.return===t)break e;S===P&&(S=null),P=P.return}S===P&&(S=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:ta(e,t),ba(t),r&4&&uC(t);break;case 21:break;default:ta(e,t),ba(t)}}function ba(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dR(n)){var r=n;break e}n=n.return}throw Error(ft(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Xp(i,""),r.flags&=-33);var a=cC(t);iw(t,a,i);break;case 3:case 4:var h=r.stateNode.containerInfo,l=cC(t);rw(t,l,h);break;default:throw Error(ft(161))}}catch(m){Zr(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function kN(t,e,n){Xt=t,mR(t)}function mR(t,e,n){for(var r=(t.mode&1)!==0;Xt!==null;){var i=Xt,a=i.child;if(i.tag===22&&r){var h=i.memoizedState!==null||by;if(!h){var l=i.alternate,m=l!==null&&l.memoizedState!==null||os;l=by;var _=os;if(by=h,(os=m)&&!_)for(Xt=i;Xt!==null;)h=Xt,m=h.child,h.tag===22&&h.memoizedState!==null?fC(i):m!==null?(m.return=h,Xt=m):fC(i);for(;a!==null;)Xt=a,mR(a),a=a.sibling;Xt=i,by=l,os=_}hC(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Xt=a):hC(t)}}function hC(t){for(;Xt!==null;){var e=Xt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:os||L_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!os)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ra(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&XP(e,a,r);break;case 3:var h=e.updateQueue;if(h!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}XP(e,h,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var S=_.memoizedState;if(S!==null){var P=S.dehydrated;P!==null&&Qp(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}os||e.flags&512&&nw(e)}catch(C){Zr(e,e.return,C)}}if(e===t){Xt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Xt=n;break}Xt=e.return}}function dC(t){for(;Xt!==null;){var e=Xt;if(e===t){Xt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Xt=n;break}Xt=e.return}}function fC(t){for(;Xt!==null;){var e=Xt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{L_(4,e)}catch(m){Zr(e,n,m)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(m){Zr(e,i,m)}}var a=e.return;try{nw(e)}catch(m){Zr(e,a,m)}break;case 5:var h=e.return;try{nw(e)}catch(m){Zr(e,h,m)}}}catch(m){Zr(e,e.return,m)}if(e===t){Xt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Xt=l;break}Xt=e.return}}var MN=Math.ceil,Z0=wl.ReactCurrentDispatcher,GS=wl.ReactCurrentOwner,Lo=wl.ReactCurrentBatchConfig,Wn=0,Ai=null,hi=null,ji=0,Ks=0,Jh=Ac(0),vi=0,um=null,Cu=0,R_=0,WS=0,Np=null,Rs=null,HS=0,wd=1/0,il=null,X0=!1,sw=null,yc=null,wy=!1,sc=null,Y0=0,Bp=0,ow=null,h0=-1,d0=0;function Ts(){return Wn&6?oi():h0!==-1?h0:h0=oi()}function _c(t){return t.mode&1?Wn&2&&ji!==0?ji&-ji:pN.transition!==null?(d0===0&&(d0=QM()),d0):(t=tr,t!==0||(t=window.event,t=t===void 0?16:oL(t.type)),t):1}function ca(t,e,n,r){if(50<Bp)throw Bp=0,ow=null,Error(ft(185));Rm(t,n,r),(!(Wn&2)||t!==Ai)&&(t===Ai&&(!(Wn&2)&&(R_|=n),vi===4&&nc(t,ji)),Ns(t,r),n===1&&Wn===0&&!(e.mode&1)&&(wd=oi()+500,I_&&Ic()))}function Ns(t,e){var n=t.callbackNode;p5(t,e);var r=R0(t,t===Ai?ji:0);if(r===0)n!==null&&wP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&wP(n),e===1)t.tag===0?fN(pC.bind(null,t)):EL(pC.bind(null,t)),cN(function(){!(Wn&6)&&Ic()}),n=null;else{switch(eL(r)){case 1:n=_S;break;case 4:n=KM;break;case 16:n=L0;break;case 536870912:n=JM;break;default:n=L0}n=SR(n,gR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function gR(t,e){if(h0=-1,d0=0,Wn&6)throw Error(ft(327));var n=t.callbackNode;if(cd()&&t.callbackNode!==n)return null;var r=R0(t,t===Ai?ji:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=K0(t,r);else{e=r;var i=Wn;Wn|=2;var a=_R();(Ai!==t||ji!==e)&&(il=null,wd=oi()+500,vu(t,e));do try{ON();break}catch(l){yR(t,l)}while(1);MS(),Z0.current=a,Wn=i,hi!==null?e=0:(Ai=null,ji=0,e=vi)}if(e!==0){if(e===2&&(i=R1(t),i!==0&&(r=i,e=aw(t,i))),e===1)throw n=um,vu(t,0),nc(t,r),Ns(t,oi()),n;if(e===6)nc(t,r);else{if(i=t.current.alternate,!(r&30)&&!LN(i)&&(e=K0(t,r),e===2&&(a=R1(t),a!==0&&(r=a,e=aw(t,a))),e===1))throw n=um,vu(t,0),nc(t,r),Ns(t,oi()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ft(345));case 2:su(t,Rs,il);break;case 3:if(nc(t,r),(r&130023424)===r&&(e=HS+500-oi(),10<e)){if(R0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ts(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=V1(su.bind(null,t,Rs,il),e);break}su(t,Rs,il);break;case 4:if(nc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var h=31-la(r);a=1<<h,h=e[h],h>i&&(i=h),r&=~a}if(r=i,r=oi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*MN(r/1960))-r,10<r){t.timeoutHandle=V1(su.bind(null,t,Rs,il),r);break}su(t,Rs,il);break;case 5:su(t,Rs,il);break;default:throw Error(ft(329))}}}return Ns(t,oi()),t.callbackNode===n?gR.bind(null,t):null}function aw(t,e){var n=Np;return t.current.memoizedState.isDehydrated&&(vu(t,e).flags|=256),t=K0(t,e),t!==2&&(e=Rs,Rs=n,e!==null&&lw(e)),t}function lw(t){Rs===null?Rs=t:Rs.push.apply(Rs,t)}function LN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ha(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function nc(t,e){for(e&=~WS,e&=~R_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-la(e),r=1<<n;t[n]=-1,e&=~r}}function pC(t){if(Wn&6)throw Error(ft(327));cd();var e=R0(t,0);if(!(e&1))return Ns(t,oi()),null;var n=K0(t,e);if(t.tag!==0&&n===2){var r=R1(t);r!==0&&(e=r,n=aw(t,r))}if(n===1)throw n=um,vu(t,0),nc(t,e),Ns(t,oi()),n;if(n===6)throw Error(ft(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,su(t,Rs,il),Ns(t,oi()),null}function qS(t,e){var n=Wn;Wn|=1;try{return t(e)}finally{Wn=n,Wn===0&&(wd=oi()+500,I_&&Ic())}}function Au(t){sc!==null&&sc.tag===0&&!(Wn&6)&&cd();var e=Wn;Wn|=1;var n=Lo.transition,r=tr;try{if(Lo.transition=null,tr=1,t)return t()}finally{tr=r,Lo.transition=n,Wn=e,!(Wn&6)&&Ic()}}function ZS(){Ks=Jh.current,Er(Jh)}function vu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,lN(n)),hi!==null)for(n=hi.return;n!==null;){var r=n;switch(AS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&N0();break;case 3:xd(),Er(Ds),Er(ls),FS();break;case 5:DS(r);break;case 4:xd();break;case 13:Er(Dr);break;case 19:Er(Dr);break;case 10:LS(r.type._context);break;case 22:case 23:ZS()}n=n.return}if(Ai=t,hi=t=vc(t.current,null),ji=Ks=e,vi=0,um=null,WS=R_=Cu=0,Rs=Np=null,fu!==null){for(e=0;e<fu.length;e++)if(n=fu[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var h=a.next;a.next=i,r.next=h}n.pending=r}fu=null}return t}function yR(t,e){do{var n=hi;try{if(MS(),l0.current=q0,H0){for(var r=Nr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}H0=!1}if(Pu=0,Pi=_i=Nr=null,Dp=!1,am=0,GS.current=null,n===null||n.return===null){vi=1,um=e,hi=null;break}e:{var a=t,h=n.return,l=n,m=e;if(e=ji,l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var _=m,S=l,P=S.tag;if(!(S.mode&1)&&(P===0||P===11||P===15)){var C=S.alternate;C?(S.updateQueue=C.updateQueue,S.memoizedState=C.memoizedState,S.lanes=C.lanes):(S.updateQueue=null,S.memoizedState=null)}var L=tC(h);if(L!==null){L.flags&=-257,nC(L,h,l,a,e),L.mode&1&&eC(a,_,e),e=L,m=_;var R=e.updateQueue;if(R===null){var D=new Set;D.add(m),e.updateQueue=D}else R.add(m);break e}else{if(!(e&1)){eC(a,_,e),XS();break e}m=Error(ft(426))}}else if(Lr&&l.mode&1){var W=tC(h);if(W!==null){!(W.flags&65536)&&(W.flags|=256),nC(W,h,l,a,e),IS(bd(m,l));break e}}a=m=bd(m,l),vi!==4&&(vi=2),Np===null?Np=[a]:Np.push(a),a=h;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var z=eR(a,m,e);ZP(a,z);break e;case 1:l=m;var N=a.type,F=a.stateNode;if(!(a.flags&128)&&(typeof N.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(yc===null||!yc.has(F)))){a.flags|=65536,e&=-e,a.lanes|=e;var $=tR(a,l,e);ZP(a,$);break e}}a=a.return}while(a!==null)}xR(n)}catch(K){e=K,hi===n&&n!==null&&(hi=n=n.return);continue}break}while(1)}function _R(){var t=Z0.current;return Z0.current=q0,t===null?q0:t}function XS(){(vi===0||vi===3||vi===2)&&(vi=4),Ai===null||!(Cu&268435455)&&!(R_&268435455)||nc(Ai,ji)}function K0(t,e){var n=Wn;Wn|=2;var r=_R();(Ai!==t||ji!==e)&&(il=null,vu(t,e));do try{RN();break}catch(i){yR(t,i)}while(1);if(MS(),Wn=n,Z0.current=r,hi!==null)throw Error(ft(261));return Ai=null,ji=0,vi}function RN(){for(;hi!==null;)vR(hi)}function ON(){for(;hi!==null&&!s5();)vR(hi)}function vR(t){var e=wR(t.alternate,t,Ks);t.memoizedProps=t.pendingProps,e===null?xR(t):hi=e,GS.current=null}function xR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=CN(n,e),n!==null){n.flags&=32767,hi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vi=6,hi=null;return}}else if(n=PN(n,e,Ks),n!==null){hi=n;return}if(e=e.sibling,e!==null){hi=e;return}hi=e=t}while(e!==null);vi===0&&(vi=5)}function su(t,e,n){var r=tr,i=Lo.transition;try{Lo.transition=null,tr=1,zN(t,e,n,r)}finally{Lo.transition=i,tr=r}return null}function zN(t,e,n,r){do cd();while(sc!==null);if(Wn&6)throw Error(ft(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ft(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(m5(t,a),t===Ai&&(hi=Ai=null,ji=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wy||(wy=!0,SR(L0,function(){return cd(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Lo.transition,Lo.transition=null;var h=tr;tr=1;var l=Wn;Wn|=4,GS.current=null,IN(t,n),pR(n,t),tN(B1),O0=!!N1,B1=N1=null,t.current=n,kN(n),o5(),Wn=l,tr=h,Lo.transition=a}else t.current=n;if(wy&&(wy=!1,sc=t,Y0=i),a=t.pendingLanes,a===0&&(yc=null),c5(n.stateNode),Ns(t,oi()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(X0)throw X0=!1,t=sw,sw=null,t;return Y0&1&&t.tag!==0&&cd(),a=t.pendingLanes,a&1?t===ow?Bp++:(Bp=0,ow=t):Bp=0,Ic(),null}function cd(){if(sc!==null){var t=eL(Y0),e=Lo.transition,n=tr;try{if(Lo.transition=null,tr=16>t?16:t,sc===null)var r=!1;else{if(t=sc,sc=null,Y0=0,Wn&6)throw Error(ft(331));var i=Wn;for(Wn|=4,Xt=t.current;Xt!==null;){var a=Xt,h=a.child;if(Xt.flags&16){var l=a.deletions;if(l!==null){for(var m=0;m<l.length;m++){var _=l[m];for(Xt=_;Xt!==null;){var S=Xt;switch(S.tag){case 0:case 11:case 15:Fp(8,S,a)}var P=S.child;if(P!==null)P.return=S,Xt=P;else for(;Xt!==null;){S=Xt;var C=S.sibling,L=S.return;if(hR(S),S===_){Xt=null;break}if(C!==null){C.return=L,Xt=C;break}Xt=L}}}var R=a.alternate;if(R!==null){var D=R.child;if(D!==null){R.child=null;do{var W=D.sibling;D.sibling=null,D=W}while(D!==null)}}Xt=a}}if(a.subtreeFlags&2064&&h!==null)h.return=a,Xt=h;else e:for(;Xt!==null;){if(a=Xt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Fp(9,a,a.return)}var z=a.sibling;if(z!==null){z.return=a.return,Xt=z;break e}Xt=a.return}}var N=t.current;for(Xt=N;Xt!==null;){h=Xt;var F=h.child;if(h.subtreeFlags&2064&&F!==null)F.return=h,Xt=F;else e:for(h=N;Xt!==null;){if(l=Xt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:L_(9,l)}}catch(K){Zr(l,l.return,K)}if(l===h){Xt=null;break e}var $=l.sibling;if($!==null){$.return=l.return,Xt=$;break e}Xt=l.return}}if(Wn=i,Ic(),La&&typeof La.onPostCommitFiberRoot=="function")try{La.onPostCommitFiberRoot(T_,t)}catch{}r=!0}return r}finally{tr=n,Lo.transition=e}}return!1}function mC(t,e,n){e=bd(n,e),e=eR(t,e,1),t=gc(t,e,1),e=Ts(),t!==null&&(Rm(t,1,e),Ns(t,e))}function Zr(t,e,n){if(t.tag===3)mC(t,t,n);else for(;e!==null;){if(e.tag===3){mC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(yc===null||!yc.has(r))){t=bd(n,t),t=tR(e,t,1),e=gc(e,t,1),t=Ts(),e!==null&&(Rm(e,1,t),Ns(e,t));break}}e=e.return}}function DN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ts(),t.pingedLanes|=t.suspendedLanes&n,Ai===t&&(ji&n)===n&&(vi===4||vi===3&&(ji&130023424)===ji&&500>oi()-HS?vu(t,0):WS|=n),Ns(t,e)}function bR(t,e){e===0&&(t.mode&1?(e=dy,dy<<=1,!(dy&130023424)&&(dy=4194304)):e=1);var n=Ts();t=fl(t,e),t!==null&&(Rm(t,e,n),Ns(t,n))}function FN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bR(t,n)}function NN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ft(314))}r!==null&&r.delete(e),bR(t,n)}var wR;wR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ds.current)Os=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Os=!1,EN(t,e,n);Os=!!(t.flags&131072)}else Os=!1,Lr&&e.flags&1048576&&PL(e,V0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;u0(t,e),t=e.pendingProps;var i=yd(e,ls.current);ld(e,n),i=BS(null,e,r,t,i,n);var a=jS();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fs(r)?(a=!0,B0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,OS(e),i.updater=M_,e.stateNode=i,i._reactInternals=e,Z1(e,r,t,n),e=K1(null,e,r,!0,a,n)):(e.tag=0,Lr&&a&&CS(e),bs(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(u0(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=jN(r),t=ra(r,t),i){case 0:e=Y1(null,e,r,t,n);break e;case 1:e=sC(null,e,r,t,n);break e;case 11:e=rC(null,e,r,t,n);break e;case 14:e=iC(null,e,r,ra(r.type,t),n);break e}throw Error(ft(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ra(r,i),Y1(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ra(r,i),sC(t,e,r,i,n);case 3:e:{if(sR(e),t===null)throw Error(ft(387));r=e.pendingProps,a=e.memoizedState,i=a.element,LL(t,e),G0(e,r,null,n);var h=e.memoizedState;if(r=h.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=bd(Error(ft(423)),e),e=oC(t,e,r,n,i);break e}else if(r!==i){i=bd(Error(ft(424)),e),e=oC(t,e,r,n,i);break e}else for(to=mc(e.stateNode.containerInfo.firstChild),ro=e,Lr=!0,sa=null,n=kL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_d(),r===i){e=pl(t,e,n);break e}bs(t,e,r,n)}e=e.child}return e;case 5:return RL(e),t===null&&W1(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,h=i.children,j1(r,i)?h=null:a!==null&&j1(r,a)&&(e.flags|=32),iR(t,e),bs(t,e,h,n),e.child;case 6:return t===null&&W1(e),null;case 13:return oR(t,e,n);case 4:return zS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=vd(e,null,r,n):bs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ra(r,i),rC(t,e,r,i,n);case 7:return bs(t,e,e.pendingProps,n),e.child;case 8:return bs(t,e,e.pendingProps.children,n),e.child;case 12:return bs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,h=i.value,vr(U0,r._currentValue),r._currentValue=h,a!==null)if(ha(a.value,h)){if(a.children===i.children&&!Ds.current){e=pl(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){h=a.child;for(var m=l.firstContext;m!==null;){if(m.context===r){if(a.tag===1){m=ul(-1,n&-n),m.tag=2;var _=a.updateQueue;if(_!==null){_=_.shared;var S=_.pending;S===null?m.next=m:(m.next=S.next,S.next=m),_.pending=m}}a.lanes|=n,m=a.alternate,m!==null&&(m.lanes|=n),H1(a.return,n,e),l.lanes|=n;break}m=m.next}}else if(a.tag===10)h=a.type===e.type?null:a.child;else if(a.tag===18){if(h=a.return,h===null)throw Error(ft(341));h.lanes|=n,l=h.alternate,l!==null&&(l.lanes|=n),H1(h,n,e),h=a.sibling}else h=a.child;if(h!==null)h.return=a;else for(h=a;h!==null;){if(h===e){h=null;break}if(a=h.sibling,a!==null){a.return=h.return,h=a;break}h=h.return}a=h}bs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ld(e,n),i=zo(i),r=r(i),e.flags|=1,bs(t,e,r,n),e.child;case 14:return r=e.type,i=ra(r,e.pendingProps),i=ra(r.type,i),iC(t,e,r,i,n);case 15:return nR(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ra(r,i),u0(t,e),e.tag=1,Fs(r)?(t=!0,B0(e)):t=!1,ld(e,n),QL(e,r,i),Z1(e,r,i,n),K1(null,e,r,!0,t,n);case 19:return aR(t,e,n);case 22:return rR(t,e,n)}throw Error(ft(156,e.tag))};function SR(t,e){return YM(t,e)}function BN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ko(t,e,n,r){return new BN(t,e,n,r)}function YS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jN(t){if(typeof t=="function")return YS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mS)return 11;if(t===gS)return 14}return 2}function vc(t,e){var n=t.alternate;return n===null?(n=ko(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function f0(t,e,n,r,i,a){var h=2;if(r=t,typeof t=="function")YS(t)&&(h=1);else if(typeof t=="string")h=5;else e:switch(t){case Uh:return xu(n.children,i,a,e);case pS:h=8,i|=8;break;case _1:return t=ko(12,n,e,i|2),t.elementType=_1,t.lanes=a,t;case v1:return t=ko(13,n,e,i),t.elementType=v1,t.lanes=a,t;case x1:return t=ko(19,n,e,i),t.elementType=x1,t.lanes=a,t;case RM:return O_(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case MM:h=10;break e;case LM:h=9;break e;case mS:h=11;break e;case gS:h=14;break e;case Ql:h=16,r=null;break e}throw Error(ft(130,t==null?t:typeof t,""))}return e=ko(h,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function xu(t,e,n,r){return t=ko(7,t,r,e),t.lanes=n,t}function O_(t,e,n,r){return t=ko(22,t,r,e),t.elementType=RM,t.lanes=n,t.stateNode={isHidden:!1},t}function pb(t,e,n){return t=ko(6,t,null,e),t.lanes=n,t}function mb(t,e,n){return e=ko(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function VN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xx(0),this.expirationTimes=Xx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function KS(t,e,n,r,i,a,h,l,m){return t=new VN(t,e,n,l,m),e===1?(e=1,a===!0&&(e|=8)):e=0,a=ko(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},OS(a),t}function UN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function TR(t){if(!t)return Tc;t=t._reactInternals;e:{if(Ou(t)!==t||t.tag!==1)throw Error(ft(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ft(171))}if(t.tag===1){var n=t.type;if(Fs(n))return TL(t,n,e)}return e}function ER(t,e,n,r,i,a,h,l,m){return t=KS(n,r,!0,t,i,a,h,l,m),t.context=TR(null),n=t.current,r=Ts(),i=_c(n),a=ul(r,i),a.callback=e??null,gc(n,a,i),t.current.lanes=i,Rm(t,i,r),Ns(t,r),t}function z_(t,e,n,r){var i=e.current,a=Ts(),h=_c(i);return n=TR(n),e.context===null?e.context=n:e.pendingContext=n,e=ul(a,h),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gc(i,e,h),t!==null&&(ca(t,i,h,a),a0(t,i,h)),h}function J0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function JS(t,e){gC(t,e),(t=t.alternate)&&gC(t,e)}function $N(){return null}var PR=typeof reportError=="function"?reportError:function(t){console.error(t)};function QS(t){this._internalRoot=t}D_.prototype.render=QS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ft(409));z_(t,e,null,null)};D_.prototype.unmount=QS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Au(function(){z_(null,t,null,null)}),e[dl]=null}};function D_(t){this._internalRoot=t}D_.prototype.unstable_scheduleHydration=function(t){if(t){var e=rL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<tc.length&&e!==0&&e<tc[n].priority;n++);tc.splice(n,0,t),n===0&&sL(t)}};function e2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function F_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yC(){}function GN(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var _=J0(h);a.call(_)}}var h=ER(e,r,t,0,null,!1,!1,"",yC);return t._reactRootContainer=h,t[dl]=h.current,nm(t.nodeType===8?t.parentNode:t),Au(),h}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var _=J0(m);l.call(_)}}var m=KS(t,0,!1,null,null,!1,!1,"",yC);return t._reactRootContainer=m,t[dl]=m.current,nm(t.nodeType===8?t.parentNode:t),Au(function(){z_(e,m,n,r)}),m}function N_(t,e,n,r,i){var a=n._reactRootContainer;if(a){var h=a;if(typeof i=="function"){var l=i;i=function(){var m=J0(h);l.call(m)}}z_(e,h,t,i)}else h=GN(n,e,t,i,r);return J0(h)}tL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ep(e.pendingLanes);n!==0&&(vS(e,n|1),Ns(e,oi()),!(Wn&6)&&(wd=oi()+500,Ic()))}break;case 13:Au(function(){var r=fl(t,1);if(r!==null){var i=Ts();ca(r,t,1,i)}}),JS(t,1)}};xS=function(t){if(t.tag===13){var e=fl(t,134217728);if(e!==null){var n=Ts();ca(e,t,134217728,n)}JS(t,134217728)}};nL=function(t){if(t.tag===13){var e=_c(t),n=fl(t,e);if(n!==null){var r=Ts();ca(n,t,e,r)}JS(t,e)}};rL=function(){return tr};iL=function(t,e){var n=tr;try{return tr=t,e()}finally{tr=n}};k1=function(t,e,n){switch(e){case"input":if(S1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=A_(r);if(!i)throw Error(ft(90));zM(r),S1(r,i)}}}break;case"textarea":FM(t,n);break;case"select":e=n.value,e!=null&&id(t,!!n.multiple,e,!1)}};GM=qS;WM=Au;var WN={usingClientEntryPoint:!1,Events:[zm,Hh,A_,UM,$M,qS]},ap={findFiberByHostInstance:du,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HN={bundleType:ap.bundleType,version:ap.version,rendererPackageName:ap.rendererPackageName,rendererConfig:ap.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ZM(t),t===null?null:t.stateNode},findFiberByHostInstance:ap.findFiberByHostInstance||$N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sy.isDisabled&&Sy.supportsFiber)try{T_=Sy.inject(HN),La=Sy}catch{}}co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WN;co.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e2(e))throw Error(ft(200));return UN(t,e,null,n)};co.createRoot=function(t,e){if(!e2(t))throw Error(ft(299));var n=!1,r="",i=PR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=KS(t,1,!1,null,null,n,!1,r,i),t[dl]=e.current,nm(t.nodeType===8?t.parentNode:t),new QS(e)};co.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ft(188)):(t=Object.keys(t).join(","),Error(ft(268,t)));return t=ZM(e),t=t===null?null:t.stateNode,t};co.flushSync=function(t){return Au(t)};co.hydrate=function(t,e,n){if(!F_(e))throw Error(ft(200));return N_(null,t,e,!0,n)};co.hydrateRoot=function(t,e,n){if(!e2(t))throw Error(ft(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",h=PR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),e=ER(e,null,t,1,n??null,i,!1,a,h),t[dl]=e.current,nm(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new D_(e)};co.render=function(t,e,n){if(!F_(e))throw Error(ft(200));return N_(null,t,e,!1,n)};co.unmountComponentAtNode=function(t){if(!F_(t))throw Error(ft(40));return t._reactRootContainer?(Au(function(){N_(null,null,t,!1,function(){t._reactRootContainer=null,t[dl]=null})}),!0):!1};co.unstable_batchedUpdates=qS;co.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!F_(n))throw Error(ft(200));if(t==null||t._reactInternals===void 0)throw Error(ft(38));return N_(t,e,n,!1,r)};co.version="18.3.1-next-f1338f8080-20240426";function CR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CR)}catch(t){console.error(t)}}CR(),CM.exports=co;var Fm=CM.exports;const Ty=Mm(Fm);var _C=Fm;g1.createRoot=_C.createRoot,g1.hydrateRoot=_C.hydrateRoot;function Q0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const t2=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),vC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);vC&&parseFloat(vC[1]);const qN="3.4.15";function ml(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const p0=typeof process!="object"||String(process)!=="[object process]"||process.browser,ZN=typeof window<"u"&&typeof window.orientation<"u",xC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);xC&&parseFloat(xC[1]);function hm(t){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(t)}function XN(t,e){if(hm(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(hm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YN(t){var e=XN(t,"string");return hm(e)=="symbol"?e:e+""}function J(t,e,n){return(e=YN(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class KN{constructor(e,n){J(this,"name",void 0),J(this,"workerThread",void 0),J(this,"isRunning",!0),J(this,"result",void 0),J(this,"_resolve",()=>{}),J(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ml(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ml(this.isRunning),this.isRunning=!1,this._reject(e)}}let gb=class{terminate(){}};const yb=new Map;function JN(t){ml(t.source&&!t.url||!t.source&&t.url);let e=yb.get(t.source||t.url);return e||(t.url&&(e=QN(t.url),yb.set(t.url,e)),t.source&&(e=AR(t.source),yb.set(t.source,e))),ml(e),e}function QN(t){if(!t.startsWith("http"))return t;const e=eB(t);return AR(e)}function AR(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function eB(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function IR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(bC(t))r.add(t);else if(bC(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)IR(t[i],e,r)}}return n===void 0?Array.from(r):[]}function bC(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const _b=()=>{};class cw{static isSupported(){return typeof Worker<"u"&&p0||typeof gb<"u"&&!p0}constructor(e){J(this,"name",void 0),J(this,"source",void 0),J(this,"url",void 0),J(this,"terminated",!1),J(this,"worker",void 0),J(this,"onMessage",void 0),J(this,"onError",void 0),J(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ml(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=_b,this.onError=a=>console.log(a),this.worker=p0?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=_b,this.onError=_b,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||IR(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=JN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new gb(r,{eval:!1})}else if(this.source)e=new gb(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class tB{static isSupported(){return cw.isSupported()}constructor(e){J(this,"name","unnamed"),J(this,"source",void 0),J(this,"url",void 0),J(this,"maxConcurrency",1),J(this,"maxMobileConcurrency",1),J(this,"onDebug",()=>{}),J(this,"reuseWorkers",!0),J(this,"props",{}),J(this,"jobQueue",[]),J(this,"idleQueue",[]),J(this,"count",0),J(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(a,h,l)=>a.done(l),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(a,h)=>a.error(h);const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new KN(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new cw({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ZN?this.maxMobileConcurrency:this.maxConcurrency}}const nB={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ol{static isSupported(){return cw.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ol._workerFarm=ol._workerFarm||new ol({}),ol._workerFarm.setProps(e),ol._workerFarm}constructor(e){J(this,"props",void 0),J(this,"workerPools",new Map),this.props={...nB},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let a=this.workerPools.get(n);return a||(a=new tB({name:n,source:r,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}J(ol,"_workerFarm",void 0);const rB="latest";function iB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let a=t.version;a==="latest"&&(a=rB);const h=a?"@".concat(a):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(h,"/dist/").concat(r)}return ml(i),i}function sB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qN;ml(t,"no worker provided");const n=t.version;return!(!e||!n)}function oB(t,e){return!ol.isSupported()||!p0&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function aB(t,e,n,r,i){const a=t.id,h=iB(t,n),m=ol.getWorkerFarm(n).getWorkerPool({name:a,url:h});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const _=await m.startJob("process-on-worker",lB.bind(null,i));return _.postMessage("process",{input:e,options:n,context:r}),await(await _.result).result}async function lB(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:a,options:h}=r;try{const l=await t(a,h);e.postMessage("done",{id:i,result:l})}catch(l){const m=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:i,error:m})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function cB(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}function uB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),i=r.reduce((l,m)=>l+m.byteLength,0),a=new Uint8Array(i);let h=0;for(const l of r)a.set(l,h),h+=l.byteLength;return a.buffer}async function hB(t){const e=[];for await(const n of t)e.push(n);return uB(...e)}function wC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class SC{constructor(e,n){J(this,"name",void 0),J(this,"type",void 0),J(this,"sampleSize",1),J(this,"time",void 0),J(this,"count",void 0),J(this,"samples",void 0),J(this,"lastTiming",void 0),J(this,"lastSampleTime",void 0),J(this,"lastSampleCount",void 0),J(this,"_count",0),J(this,"_time",0),J(this,"_samples",0),J(this,"_startTime",0),J(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=wC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(wC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class n2{constructor(e){J(this,"id",void 0),J(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof SC?this.stats[n]=e:this.stats[n]=new SC(n,r)),this.stats[n]}}let dB="";const TC={};function fB(t){for(const e in TC)if(t.startsWith(e)){const n=TC[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(dB).concat(t)),t}function pB(t){return t&&typeof t=="object"&&t.isBuffer}function kR(t){if(pB(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function MR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function mB(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const gB=t=>typeof t=="boolean",jp=t=>typeof t=="function",Nm=t=>t!==null&&typeof t=="object",EC=t=>Nm(t)&&t.constructor==={}.constructor,yB=t=>t&&typeof t[Symbol.iterator]=="function",_B=t=>t&&typeof t[Symbol.asyncIterator]=="function",zu=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Du=t=>typeof Blob<"u"&&t instanceof Blob,vB=t=>t&&typeof t=="object"&&t.isBuffer,xB=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Nm(t)&&jp(t.tee)&&jp(t.cancel)&&jp(t.getReader),bB=t=>Nm(t)&&jp(t.read)&&jp(t.pipe)&&gB(t.readable),LR=t=>xB(t)||bB(t),wB=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,SB=/^([-\w.]+\/[-\w.+]+)/;function TB(t){const e=SB.exec(t);return e?e[1]:t}function PC(t){const e=wB.exec(t);return e?e[1]:""}const RR=/\?.*/;function EB(t){const e=t.match(RR);return e&&e[0]}function r2(t){return t.replace(RR,"")}function B_(t){return zu(t)?t.url:Du(t)?t.name||"":typeof t=="string"?t:""}function i2(t){if(zu(t)){const e=t,n=e.headers.get("content-type")||"",r=r2(e.url);return TB(n)||PC(r)}return Du(t)?t.type||"":typeof t=="string"?PC(t):""}function PB(t){return zu(t)?t.headers["content-length"]||-1:Du(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function OR(t){if(zu(t))return t;const e={},n=PB(t);n>=0&&(e["content-length"]=String(n));const r=B_(t),i=i2(t);i&&(e["content-type"]=i);const a=await IB(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const h=new Response(t,{headers:e});return Object.defineProperty(h,"url",{value:r}),h}async function CB(t){if(!t.ok){const e=await AB(t);throw new Error(e)}}async function AB(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function IB(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=a=>{var h;return r(a==null||(h=a.target)===null||h===void 0?void 0:h.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=kB(n);return"data:base64,".concat(r)}return null}function kB(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function CC(t,e){if(typeof t=="string"){t=fB(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await OR(t)}function zR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Sl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zR()}const m0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Ey=m0.window||m0.self||m0.global,lp=m0.process||{},DR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Sl();const vb=globalThis;function FR(t){if(!t&&!Sl())return"Node";if(zR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":vb.chrome?"Chrome":vb.safari?"Safari":vb.mozInnerScreenX?"Firefox":"Unknown"}function MB(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class LB{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";J(this,"storage",void 0),J(this,"id",void 0),J(this,"config",void 0),this.storage=MB(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function RB(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function OB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function xb(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const a=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(a/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(a,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let e_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(e_||(e_={}));function AC(t){return typeof t=="string"?e_[t.toUpperCase()]||e_.WHITE:t}function zB(t,e,n){return!Sl&&typeof t=="string"&&(e&&(e=AC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=AC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function DB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(a=>i===a)||(t[i]=t[i].bind(t)))}function t_(t,e){if(!t)throw new Error(e||"Assertion failed")}function Sh(){let t;if(Sl&&"performance"in Ey){var e,n;t=Ey==null||(e=Ey.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in lp){var r;const i=lp==null||(r=lp.hrtime)===null||r===void 0?void 0:r.call(lp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Th={debug:Sl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},FB={enabled:!0,level:0};function Eo(){}const IC={},kC={once:!0};class Bm{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};J(this,"id",void 0),J(this,"VERSION",DR),J(this,"_startTs",Sh()),J(this,"_deltaTs",Sh()),J(this,"_storage",void 0),J(this,"userData",{}),J(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new LB("__probe-".concat(this.id,"__"),FB),this.timeStamp("".concat(this.id," started")),DB(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Sh()-this._startTs).toPrecision(10))}getDelta(){return Number((Sh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){t_(e,n)}warn(e){return this._getLogFunction(0,e,Th.warn,arguments,kC)}error(e){return this._getLogFunction(0,e,Th.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Th.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Th.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return this._getLogFunction(e,n,Th.debug||Th.info,arguments,kC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Eo,r&&[r],{tag:VB(n)}):Eo}image(e){let{logLevel:n,priority:r,image:i,message:a="",scale:h=1}=e;return this._shouldLog(n||r)?Sl?jB({image:i,message:a,scale:h}):BB():Eo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Eo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=MC({logLevel:e,message:n,opts:r}),{collapsed:a}=r;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Eo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=NR(e)}_getLogFunction(e,n,r,i,a){if(this._shouldLog(e)){a=MC({logLevel:e,message:n,args:i,opts:a}),r=r||a.method,t_(r),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=Sh();const h=a.tag||a.message;if(a.once)if(!IC[h])IC[h]=Sh();else return Eo;return n=NB(this.id,a.message,a),r.bind(console,n,...a.args)}return Eo}}J(Bm,"VERSION",DR);function NR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return t_(Number.isFinite(e)&&e>=0),e}function MC(t){const{logLevel:e,message:n}=t;t.logLevel=NR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return t_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function NB(t,e,n){if(typeof e=="string"){const r=n.time?OB(RB(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=zB(e,n.color,n.background)}return e}function BB(t){return console.warn("removed"),Eo}function jB(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const a=new Image;return a.onload=()=>{const h=xb(a,n,r);console.log(...h)},a.src=e,Eo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...xb(e,n,r)),Eo;if(i.toLowerCase()==="canvas"){const a=new Image;return a.onload=()=>console.log(...xb(a,n,r)),a.src=e.toDataURL(),Eo}return Eo}function VB(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const LC=new Bm({id:"loaders.gl"});class UB{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class $B{constructor(){J(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const BR={fetch:null,mimeType:void 0,nothrow:!1,log:new $B,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:t2,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},GB={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function jR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const VR=()=>{const t=jR();return t.globalOptions=t.globalOptions||{...BR},t.globalOptions};function WB(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],HB(t,n),ZB(e,t,r)}function HB(t,e){RC(t,null,BR,GB,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},a=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};RC(r,n.id,i,a,e)}}function RC(t,e,n,r,i){const a=e||"Top level",h=e?"".concat(e,"."):"";for(const l in t){const m=!e&&Nm(t[l]),_=l==="baseUri"&&!e,S=l==="workerUrl"&&e;if(!(l in n)&&!_&&!S){if(l in r)LC.warn("".concat(a," loader option '").concat(h).concat(l,"' no longer supported, use '").concat(r[l],"'"))();else if(!m){const P=qB(l,i);LC.warn("".concat(a," loader option '").concat(h).concat(l,"' not recognized. ").concat(P))()}}}}function qB(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const a in i.options){if(t===a)return"Did you mean '".concat(i.id,".").concat(a,"'?");const h=a.toLowerCase();(n.startsWith(h)||h.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(a,"'?"))}return r}function ZB(t,e,n){const i={...t.options||{}};return XB(i,n),i.log===null&&(i.log=new UB),OC(i,VR()),OC(i,e),i}function OC(t,e){for(const n in e)if(n in e){const r=e[n];EC(r)&&EC(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function XB(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function s2(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function o2(t){var e,n;Q0(t,"null loader"),Q0(s2(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const UR=()=>{const t=jR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function YB(t){const e=UR();t=Array.isArray(t)?t:[t];for(const n of t){const r=o2(n);e.find(i=>r===i)||e.unshift(r)}}function KB(){return UR()}const JB=new Bm({id:"loaders.gl"}),QB=/\.([^.]+)$/;async function e6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!$R(t))return null;let i=zC(t,e,{...n,nothrow:!0},r);if(i)return i;if(Du(t)&&(t=await t.slice(0,10).arrayBuffer(),i=zC(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(GR(t));return i}function zC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!$R(t))return null;if(e&&!Array.isArray(e))return o2(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...KB()),n6(i);const a=t6(t,i,n,r);if(!a&&!(n!=null&&n.nothrow))throw new Error(GR(t));return a}function t6(t,e,n,r){const i=B_(t),a=i2(t),h=r2(i)||(r==null?void 0:r.url);let l=null,m="";if(n!=null&&n.mimeType&&(l=bb(e,n==null?void 0:n.mimeType),m="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||r6(e,h),m=m||(l?"matched url ".concat(h):""),l=l||bb(e,a),m=m||(l?"matched MIME type ".concat(a):""),l=l||s6(e,t),m=m||(l?"matched initial data ".concat(WR(t)):""),l=l||bb(e,n==null?void 0:n.fallbackMimeType),m=m||(l?"matched fallback MIME type ".concat(a):""),m){var _;JB.log(1,"selectLoader selected ".concat((_=l)===null||_===void 0?void 0:_.name,": ").concat(m,"."))}return l}function $R(t){return!(t instanceof Response&&t.status===204)}function GR(t){const e=B_(t),n=i2(t);let r="No valid loader found (";r+=e?"".concat(MR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?WR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function n6(t){for(const e of t)o2(e)}function r6(t,e){const n=e&&QB.exec(e),r=n&&n[1];return r?i6(t,r):null}function i6(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function bb(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function s6(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(o6(e,n))return n}else if(ArrayBuffer.isView(e)){if(DC(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&DC(e,0,n))return n;return null}function o6(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function DC(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>a6(t,e,n,i))}function a6(t,e,n,r){if(r instanceof ArrayBuffer)return cB(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=uw(t,e,r.length);return r===i;default:return!1}}function WR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?uw(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?uw(t,0,e):""}function uw(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let a=0;a<n;a++)i+=String.fromCharCode(r.getUint8(e+a));return i}const l6=256*1024;function*c6(t,e){const n=(e==null?void 0:e.chunkSize)||l6;let r=0;const i=new TextEncoder;for(;r<t.length;){const a=Math.min(t.length-r,n),h=t.slice(r,r+a);r+=a,yield i.encode(h)}}const u6=256*1024;function h6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=u6}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),a=new ArrayBuffer(i),h=new Uint8Array(t,r,i);new Uint8Array(a).set(h),r+=i,yield a}}()}const d6=1024*1024;async function*f6(t,e){const n=(e==null?void 0:e.chunkSize)||d6;let r=0;for(;r<t.size;){const i=r+n,a=await t.slice(r,i).arrayBuffer();r=i,yield a}}function FC(t,e){return t2?p6(t,e):m6(t)}async function*p6(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:a,value:h}=await i;if(a)return;yield kR(h)}}catch{n.releaseLock()}}async function*m6(t,e){for await(const n of t)yield kR(n)}function g6(t,e){if(typeof t=="string")return c6(t,e);if(t instanceof ArrayBuffer)return h6(t,e);if(Du(t))return f6(t,e);if(LR(t))return FC(t,e);if(zu(t))return FC(t.body,e);throw new Error("makeIterator")}const HR="Cannot convert supplied data type";function y6(t,e,n){if(e.text&&typeof t=="string")return t;if(vB(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(HR)}async function _6(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return y6(t,e);if(Du(t)&&(t=await OR(t)),zu(t)){const i=t;return await CB(i),e.binary?await i.arrayBuffer():await i.text()}if(LR(t)&&(t=g6(t,n)),yB(t)||_B(t))return hB(t);throw new Error(HR)}function qR(t,e){const n=VR(),r=t||n;return typeof r.fetch=="function"?r.fetch:Nm(r.fetch)?i=>CC(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:CC}function v6(t,e,n){if(n)return n;const r={fetch:qR(e,t),...t};if(r.url){const i=r2(r.url);r.baseUrl=i,r.queryString=EB(r.url),r.filename=MR(i),r.baseUrl=mB(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function x6(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function a2(t,e,n,r){ml(!r||typeof r=="object"),e&&!Array.isArray(e)&&!s2(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=B_(t),h=x6(e,r),l=await e6(t,h,n);return l?(n=WB(n,l,h,i),r=v6({url:i,parse:a2,loaders:h},n,r||null),await b6(l,t,n,r)):null}async function b6(t,e,n,r){if(sB(t),zu(e)){const i=e,{ok:a,redirected:h,status:l,statusText:m,type:_,url:S}=i,P=Object.fromEntries(i.headers.entries());r.response={headers:P,ok:a,redirected:h,status:l,statusText:m,type:_,url:S}}if(e=await _6(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(oB(t,n))return await aB(t,e,n,r,a2);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ml(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function hw(t,e,n,r){!Array.isArray(e)&&!s2(e)&&(n=e,e=void 0);const i=qR(n);let a=t;return typeof t=="string"&&(a=await i(t)),Du(t)&&(a=await i(t)),await a2(a,e,n)}const w6="3.4.15",{_parseImageNode:S6}=globalThis,dw=typeof Image<"u",fw=typeof ImageBitmap<"u",T6=!!S6,pw=t2?!0:T6;function E6(t){switch(t){case"auto":return fw||dw||pw;case"imagebitmap":return fw;case"image":return dw;case"data":return pw;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function P6(){if(fw)return"imagebitmap";if(dw)return"image";if(pw)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function C6(t){const e=I6(t);if(!e)throw new Error("Not an image");return e}function A6(t){switch(C6(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function I6(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const k6=/^data:image\/svg\+xml/,M6=/\.svg((\?|#).*)?$/;function l2(t){return t&&(k6.test(t)||M6.test(t))}function L6(t,e){if(l2(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(a){throw new Error(a.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return ZR(t,e)}function ZR(t,e){if(l2(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function XR(t,e,n){const r=L6(t,n),i=self.URL||self.webkitURL,a=typeof r!="string"&&i.createObjectURL(r);try{return await R6(a||r,e)}finally{a&&i.revokeObjectURL(a)}}async function R6(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=a=>i(new Error("Could not load image ".concat(t,": ").concat(a)))}catch(a){i(a)}})}const O6={};let NC=!0;async function z6(t,e,n){let r;l2(n)?r=await XR(t,e,n):r=ZR(t,n);const i=e&&e.imagebitmap;return await D6(r,i)}async function D6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((F6(e)||!NC)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),NC=!1}return await createImageBitmap(t)}function F6(t){for(const e in t||O6)return!1;return!0}function N6(t){return!U6(t,"ftyp",4)||!(t[8]&96)?null:B6(t)}function B6(t){switch(j6(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function j6(t,e,n){return String.fromCharCode(...t.slice(e,n))}function V6(t){return[...t].map(e=>e.charCodeAt(0))}function U6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=V6(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Ia=!1,Vp=!0;function YR(t){const e=jm(t);return G6(e)||q6(e)||W6(e)||H6(e)||$6(e)}function $6(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=N6(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function G6(t){const e=jm(t);return e.byteLength>=24&&e.getUint32(0,Ia)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Ia),height:e.getUint32(20,Ia)}:null}function W6(t){const e=jm(t);return e.byteLength>=10&&e.getUint32(0,Ia)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Vp),height:e.getUint16(8,Vp)}:null}function H6(t){const e=jm(t);return e.byteLength>=14&&e.getUint16(0,Ia)===16973&&e.getUint32(2,Vp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Vp),height:e.getUint32(22,Vp)}:null}function q6(t){const e=jm(t);if(!(e.byteLength>=3&&e.getUint16(0,Ia)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=Z6();let a=2;for(;a+9<e.byteLength;){const h=e.getUint16(a,Ia);if(i.has(h))return{mimeType:"image/jpeg",height:e.getUint16(a+5,Ia),width:e.getUint16(a+7,Ia)};if(!r.has(h))return null;a+=2,a+=e.getUint16(a,Ia)}return null}function Z6(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function jm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function X6(t,e){const{mimeType:n}=YR(t)||{},r=globalThis._parseImageNode;return Q0(r),await r(t,n)}async function Y6(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=n||{},h=K6(i);let l;switch(h){case"imagebitmap":l=await z6(t,e,a);break;case"image":l=await XR(t,e,a);break;case"data":l=await X6(t);break;default:Q0(!1)}return i==="data"&&(l=A6(l)),l}function K6(t){switch(t){case"auto":case"data":return P6();default:return E6(t),t}}const J6=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Q6=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],ej={image:{type:"auto",decode:!0}},tj={id:"image",module:"images",name:"Images",version:w6,mimeTypes:Q6,extensions:J6,parse:Y6,tests:[t=>!!YR(new DataView(t))],options:ej},hr=new Bm({id:"deck"});let mw={};function nj(t){mw=t}function ss(t,e,n,r){hr.level>0&&mw[t]&&mw[t].call(null,e,n,r)}function rj(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const ij={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:rj,parseTextSync:JSON.parse};function sj(){const t="8.9.36",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(hr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:hr,_registerLoggers:nj},YB([ij,[tj,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const oj=sj(),qn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(qn,"IDENTITY",{get:()=>(hr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const ka={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},dm={common:0,meters:1,pixels:2},BC={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},ln=new Bm({id:"luma.gl"});function ws(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const aj="Invalid WebGLRenderingContext",lj="Requires WebGL2";function j_(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Vn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function cj(t){return Vn(t)?t:null}function V_(t){return ws(j_(t),aj),t}function Ss(t){return ws(Vn(t),lj),t}const Cp={};function uj(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function hj(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function dj(t,e){Cp[t]=!0,e!==void 0&&uj(e)}function fj(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Cp[r]=!0);while(r!==0);for(r in Cp)if(Cp[r])return delete Cp[r],parseInt(r,10);return 0}}const Vm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Vm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Vm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Fu=function(e){const n=this;this.gl=e,fj(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(a){return a===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(a,h){switch(a){case 34962:n.currentArrayBuffer=h;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=h;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(a,h){const m=n.currentVertexArrayObject.attribs[a];switch(h){case 34975:return m.buffer;case 34338:return m.enabled;case 34339:return m.size;case 34340:return m.stride;case 34341:return m.type;case 34922:return m.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(a,h,l,m,_,S){const P=n.currentVertexArrayObject;P.maxAttrib=Math.max(P.maxAttrib,a);const C=P.attribs[a];return C.buffer=n.currentArrayBuffer,C.size=h,C.type=l,C.normalized=m,C.stride=_,C.offset=S,C.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{hj("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Fu.prototype.VERTEX_ARRAY_BINDING_OES=34229;Fu.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Vm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Fu.prototype.createVertexArrayOES=function(){const e=new Vm(this);return this.vertexArrayObjects.push(e),e};Fu.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Fu.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Vm&&e.hasBeenBound&&e.ext===this)};Fu.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){dj(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const a=this.currentVertexArrayObject;if(i===a)return;(!i||a.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,a.elementArrayBuffer);let h=this.currentArrayBuffer;const l=Math.max(i?i.maxAttrib:0,a.maxAttrib);for(let m=0;m<=l;m++){const _=a.attribs[m],S=i?i.attribs[m]:null;if((!i||_.enabled!==S.enabled)&&(_.enabled?r.enableVertexAttribArray.call(n,m):r.disableVertexAttribArray.call(n,m)),_.enabled){let P=!1;(!i||_.buffer!==S.buffer)&&(h!==_.buffer&&(r.bindBuffer.call(n,34962,_.buffer),h=_.buffer),P=!0),(P||_.cached!==S.cached)&&r.vertexAttribPointer.call(n,m,_.size,_.type,_.normalized,_.stride,_.offset)}}this.currentArrayBuffer!==h&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function pj(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const a=n.call(this,i);return a||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Fu(this)),this.__OESVertexArrayObject))}}const jC="OES_element_index",VC="WEBGL_draw_buffers",mj="EXT_disjoint_timer_query",gj="EXT_disjoint_timer_query_webgl2",yj="EXT_texture_filter_anisotropic",UC="WEBGL_debug_renderer_info",_j=35723,vj=4352,xj=36795,bj=34047,wj=37445,Sj=37446,_r=t=>Vn(t)?void 0:0,Tj={3074:t=>Vn(t)?void 0:36064,[_j]:t=>Vn(t)?void 0:vj,35977:_r,32937:_r,[xj]:(t,e)=>{const n=Vn(t)?t.getExtension(gj):t.getExtension(mj);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[wj]:(t,e)=>{const n=t.getExtension(UC);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Sj]:(t,e)=>{const n=t.getExtension(UC);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[bj]:(t,e)=>{const n=t.luma.extensions[yj];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:_r,35071:_r,37447:_r,36063:(t,e)=>{if(!Vn(t)){const n=t.getExtension(VC);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:_r,35374:_r,35377:_r,34852:t=>{if(!Vn(t)){const e=t.getExtension(VC);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(jC)?2147483647:65535,33001:t=>t.getExtension(jC)?16777216:65535,33e3:t=>16777216,37157:_r,35373:_r,35657:_r,36183:_r,37137:_r,34045:_r,35978:_r,35979:_r,35968:_r,35376:_r,35375:_r,35659:_r,37154:_r,35371:_r,35658:_r,35076:_r,35077:_r,35380:_r};function Ej(t,e,n){const r=Tj[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const Pj="OES_vertex_array_object",KR="ANGLE_instanced_arrays",Cj="WEBGL_draw_buffers",Aj="EXT_disjoint_timer_query",Ij="EXT_texture_filter_anisotropic",kj="VertexArray requires WebGL2 or OES_vertex_array_object extension";function Mj(t,e){return{webgl2:Vn(t),ext:t.getExtension(e)}}const JR={[Pj]:{meta:{suffix:"OES"},createVertexArray:()=>{ws(!1,kj)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[KR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){ws(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Cj]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ws(!1)}},[Aj]:{meta:{suffix:"EXT"},createQuery:()=>{ws(!1)},deleteQuery:()=>{ws(!1)},beginQuery:()=>{ws(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},wb={readBuffer:(t,e,n)=>{Vn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:a}=Mj(t,KR);let h;switch(r){case 35069:h=i?void 0:!1;break;case 35070:h=!i&&!a?0:void 0;break}return h!==void 0?h:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Vn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Vn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,a=i[Ij];r=a&&a.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:Ej,hint(t,e,n,r){return e(n,r)}};function Lj(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(pj(t),Rj(t),zj(t,JR),Oj(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=Lj;function Rj(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Oj(t,e){let{target:n,target2:r}=e;Object.keys(wb).forEach(i=>{if(typeof wb[i]=="function"){const a=t[i]?t[i].bind(t):()=>{},h=wb[i].bind(null,t,a);n[i]=h,r[i]=h}})}function zj(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Dj(t,{extension:n,target:t.luma,target2:t})}function Dj(t,e){let{extension:n,target:r,target2:i}=e;const a=JR[n];ws(a);const{meta:h={}}=a,{suffix:l=""}=h,m=t.getExtension(n);for(const _ of Object.keys(a)){const S="".concat(_).concat(l);let P=null;_==="meta"||typeof t[_]=="function"||(m&&typeof m[S]=="function"?P=function(){return m[S](...arguments)}:typeof a[_]=="function"&&(P=a[_].bind(r))),P&&(r[_]=P,i[_]=P)}}const c2={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Hl=(t,e,n)=>e?t.enable(n):t.disable(n),$C=(t,e,n)=>t.hint(n,e),qs=(t,e,n)=>t.pixelStorei(n,e),Fj=(t,e)=>{const n=Vn(t)?36009:36160;return t.bindFramebuffer(n,e)},Nj=(t,e)=>t.bindFramebuffer(36008,e);function cp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Bj={3042:Hl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Hl,2885:(t,e)=>t.cullFace(e),2929:Hl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Hl,35723:$C,36006:Fj,2886:(t,e)=>t.frontFace(e),33170:$C,2849:(t,e)=>t.lineWidth(e),32823:Hl,32824:"polygonOffset",10752:"polygonOffset",35977:Hl,32938:"sampleCoverage",32939:"sampleCoverage",3089:Hl,3088:(t,e)=>t.scissor(...e),2960:Hl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:qs,3317:qs,37440:qs,37441:qs,37443:qs,3330:qs,3332:qs,3331:qs,36010:Nj,3314:qs,32878:qs,3316:qs,3315:qs,32877:qs,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=cp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=cp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=cp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=cp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,a,h,l)},stencilOp:(t,e)=>{e=cp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,a,h,l)},viewport:(t,e)=>t.viewport(...e)};function Wr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const jj={blendEquation:(t,e,n)=>t.blendEquationSeparate(Wr(32777,e,n),Wr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Wr(32969,e,n),Wr(32968,e,n),Wr(32971,e,n),Wr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Wr(32824,e,n),Wr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Wr(32938,e,n),Wr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Wr(2962,e,n),Wr(2967,e,n),Wr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Wr(34816,e,n),Wr(36003,e,n),Wr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Wr(2964,e,n),Wr(2965,e,n),Wr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Wr(34817,e,n),Wr(34818,e,n),Wr(34819,e,n))},GC={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},wa=(t,e)=>t.isEnabled(e),WC={3042:wa,2884:wa,2929:wa,3024:wa,32823:wa,32926:wa,32928:wa,3089:wa,2960:wa,35977:wa};function QR(t){for(const e in t)return!1;return!0}function Vj(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function HC(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Uj(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var a=arguments.length,h=new Array(a),l=0;l<a;l++)h[l]=arguments[l];const{valueChanged:m,oldValue:_}=n(t.state._updateCache,...h);return m&&r(...h),_},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function $j(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class Gj{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?Hj(e):Object.assign({},c2),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ws(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];gl(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const a in e){ws(a!==void 0);const h=e[a],l=this.cache[a];Vj(h,l)||(n=!0,r=l,i&&!(a in i)&&(i[a]=l),this.cache[a]=h)}return{valueChanged:n,oldValue:r}}}function e3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(ws(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new Gj(t,{copyState:r}),$j(t);for(const a in GC){const h=GC[a];Uj(t,a,h)}HC(t,"getParameter"),HC(t,"isEnabled")}return t.state.enable=n,t}function Wj(t){t.state||e3(t,{copyState:!1}),t.state.push()}function qC(t){ws(t.state),t.state.pop()}function gl(t,e){if(ws(j_(t),"setParameters requires a WebGL context"),QR(e))return;const n={};for(const i in e){const a=Number(i),h=Bj[i];h&&(typeof h=="string"?n[h]=!0:h(t,e[i],a))}const r=t.state&&t.state.cache;if(r)for(const i in n){const a=jj[i];a(t,e,r)}}function Hj(t,e){if(e=e||c2,typeof e=="number"){const i=e,a=WC[i];return a?a(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const a=WC[i];r[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return r}function qj(t){gl(t,c2)}function ua(t,e,n){if(QR(e))return n(t);const{nocatch:r=!0}=e;Wj(t),gl(t,e);let i;if(r)i=n(t),qC(t);else try{i=n(t)}finally{qC(t)}return i}function Sd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function Sb(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=Sd(t),i=t.drawingBufferWidth,a=t.drawingBufferHeight;return Xj(e,r,i,a,n)}function Zj(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function Xj(t,e,n,r,i){const a=ZC(t[0],e,n);let h=XC(t[1],e,r,i),l=ZC(t[0]+1,e,n);const m=l===n-1?l:l-1;l=XC(t[1]+1,e,r,i);let _;return i?(l=l===0?l:l+1,_=h,h=l):_=l===r-1?l:l-1,{x:a,y:h,width:Math.max(m-a+1,1),height:Math.max(_-h+1,1)}}function ZC(t,e,n){return Math.min(Math.round(t*e),n-1)}function XC(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const u2=Sl(),Yj=u2&&typeof document<"u",t3={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function n3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ws(u2,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},t3,t);const{width:e,height:n}=t;function r(l){if(t.throwOnError)throw new Error(l);return console.error(l),null}t.onError=r;let i;const{canvas:a}=t,h=eV({canvas:a,width:e,height:n,onError:r});return i=Qj(h,t),i?(i=h2(i,t),tV(i),i):null}function h2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||nV(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},t3,e);const{manageState:n,debug:r}=e;return n&&e3(t,{copyState:!1,log:function(){for(var i=arguments.length,a=new Array(i),h=0;h<i;h++)a[h]=arguments[h];return ln.log(1,...a)()}}),u2&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),ln.level=Math.max(ln.level,1)):ln.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function Kj(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),a=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:a||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function Jj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=Zj(e.useDevicePixels);rV(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function Qj(t,e){const{onError:n}=e;let r=null;const i=m=>r=m.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:a=!0,webgl2:h=!0}=e;let l=null;return h&&(l=l||t.getContext("webgl2",e),l=l||t.getContext("experimental-webgl2",e)),a&&(l=l||t.getContext("webgl",e),l=l||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),l?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),l):n("Failed to create ".concat(h&&!a?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function eV(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,a;return typeof e=="string"?(Yj&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),a=document.getElementById(e)):e?a=e:(a=document.createElement("canvas"),a.id="lumagl-canvas",a.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",a.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(a,document.body.firstChild)),a}function tV(t){const e=Vn(t)?"WebGL2":"WebGL1",n=Kj(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";ln.info(1,"".concat(e).concat(i," context ").concat(r))()}function nV(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function rV(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(ln.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const a=t.luma.canvasSizeInfo;if(a.clientWidth!==r||a.clientHeight!==i||a.devicePixelRatio!==e){let h=e;const l=Math.floor(r*h),m=Math.floor(i*h);t.canvas.width=l,t.canvas.height=m,(t.drawingBufferWidth!==l||t.drawingBufferHeight!==m)&&(ln.warn("Device pixel ratio clamped")(),h=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*h),t.canvas.height=Math.floor(i*h)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const Up="8.5.21",iV="set luma.log.level=1 (or higher) to trace rendering";class sV{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new n2({id:e})),this.stats.get(e)}}const mu=new sV;if(globalThis.luma&&globalThis.luma.VERSION!==Up)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Up));globalThis.luma||(Sl()&&ln.log(1,"luma.gl ".concat(Up," - ").concat(iV))(),globalThis.luma=globalThis.luma||{VERSION:Up,version:Up,log:ln,stats:mu,globals:{modules:{},nodeIO:{}}});function oV(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function aV(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Vt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Tb(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Vt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function xc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Eb={};function Ec(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Eb[t]=Eb[t]||1;const e=Eb[t]++;return"".concat(t,"-").concat(e)}function YC(t){return Vt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Td(t){let e=!0;for(const n in t){e=!1;break}return e}function r3(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),a=Object.getPrototypeOf(t);r.forEach(h=>{a.methodName||(a[h]=()=>{throw ln.removed("Calling removed method ".concat(e,".").concat(h,": "),i)(),new Error(h)})})}const Eh="Resource subclass must define virtual methods";let Tl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};V_(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Ec(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Tb(this.gl,e),Vt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Vn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const l=i.webgl1,m="webgl2"in i?i.webgl2:i.webgl1;return a?m:l}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},a=Vn(this.gl),h={},l=n||Object.keys(i);for(const m of l){const _=i[m];if(_&&(!("webgl2"in _)||a)&&(!("extension"in _)||this.gl.getExtension(_.extension))){const P=r?xc(this.gl,m):m;h[P]=this.getParameter(m,e),r&&_.type==="GLenum"&&(h[P]=xc(this.gl,h[P]))}}return h}setParameter(e,n){e=Tb(this.gl,e),Vt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Vn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Tb(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return r3(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Eh)}_deleteHandle(){throw new Error(Eh)}_bindHandle(e){throw new Error(Eh)}_getOptsFromHandle(){throw new Error(Eh)}_getParameter(e,n){throw new Error(Eh)}_setParameter(e,n){throw new Error(Eh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=mu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];mu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=mu.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=mu.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const lV="Failed to deduce GL constant from typed array";function gw(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(lV)}}function fm(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function cV(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:a}=t;const h=n*i;a=a||new Uint8Array(h);for(let l=0;l<r/2;++l){const m=l*h,_=(r-l-1)*h;a.set(e.subarray(m,m+h)),e.copyWithin(m,_,_+h),e.set(a,_)}}function uV(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),a=Math.round(r/2),h=new Uint8Array(i*a*4);for(let l=0;l<a;l++)for(let m=0;m<i;m++)for(let _=0;_<4;_++)h[(l*i+m)*4+_]=e[(l*2*n+m*2)*4+_];return{data:h,width:i,height:a}}function yw(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:a={}}=n;for(const l in r)if(l in e){const _=r[l]?"".concat(t,".").concat(r[l]):"N/A";ln.removed("".concat(t,".").concat(l),_)()}for(const l in i)if(l in e){const m=i[l];ln.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))()}let h=null;for(const l in a)if(l in e){const m=a[l];ln.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))(),h=h||Object.assign({},e),h[m]=e[l],delete h[l]}return h||e}const hV={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},dV={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Qs{static getBytesPerElement(e){return fm(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Vt(e.size),fm(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Qs(hV,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Qs.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Qs.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=yw("Accessor",e,dV),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const KC=10,i3={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},fV={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:i3},pV={removedProps:i3};class ur extends Tl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=yw("Buffer",e,fV),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=yw("Buffer",e,pV),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Qs(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,a=e.byteLength||e.length;Vt(n);const h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),i!==0||a!==void 0?(Ss(this.gl),this.gl.bufferSubData(this.target,r,n,i,a)):this.gl.bufferSubData(h,r,n),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:a}=e;const{gl:h}=this;return Ss(h),h.bindBuffer(36662,n.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,r,i,a),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ss(this.gl);const a=fm(this.accessor.type||5126,{clamped:!1}),h=this._getAvailableElementCount(n),l=r;let m,_;e?(_=e.length,m=_-l):(m=Math.min(h,i||h),_=l+m);const S=Math.min(h,m);return i=i||S,Vt(i<=S),e=e||new a(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Vt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(KC,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Vt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,KC),this.bytesUsed=r,this._trackAllocatedMemory(r);const a=gw(e);return Vt(a),this.setAccessor(new Qs(this.accessor,{type:a})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Vt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=fm(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Qs(this.accessor,{type:gw(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return ln.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ln.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return ln.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return ln.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Qs(this.accessor,e),this}}const d2={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},s3={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},o3={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function mV(t,e){const n=d2[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Vn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function gV(t,e){const n=d2[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const yV=[9729,9728],JC=globalThis.WebGLBuffer||function(){};class Ed extends Tl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let a=!0;return r&&(a=a&&mV(e,r),a=a&&(!i||gV(e,r))),a}constructor(e,n){const{id:r=Ec("texture"),handle:i,target:a}=n;super(e,{id:r,handle:i}),this.target=a,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(N=>this.initialize(Object.assign({},e,{pixels:N,data:N}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:a=6408,border:h=0,recreate:l=!1,parameters:m={},pixelStore:_={},textureUnit:S=void 0}=e;n||(n=i);let{width:P,height:C,dataFormat:L,type:R,compressed:D=!1,mipmaps:W=!0}=e;const{depth:z=0}=e;return{width:P,height:C,compressed:D,dataFormat:L,type:R}=this._deduceParameters({format:a,type:R,dataFormat:L,compressed:D,data:n,width:P,height:C}),this.width=P,this.height=C,this.depth=z,this.format=a,this.type=R,this.dataFormat=L,this.border=h,this.textureUnit=S,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),W&&this._isNPOT()&&(ln.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),W=!1,this._updateForNPOT(m)),this.mipmaps=W,this.setImageData({data:n,width:P,height:C,depth:z,format:a,type:R,dataFormat:L,border:h,mipmaps:W,parameters:_,compressed:D}),W&&this.generateMipmap(),this.setParameters(m),l&&(this.data=n),r&&(this._video={video:n,parameters:m,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(ln.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ua(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:a=this.format,border:h=this.border,offset:l=0,parameters:m={}}=e;let{data:_=null,type:S=this.type,width:P=this.width,height:C=this.height,dataFormat:L=this.dataFormat,compressed:R=!1}=e;_||(_=r),{type:S,dataFormat:L,compressed:R,width:P,height:C}=this._deduceParameters({format:a,type:S,dataFormat:L,compressed:R,data:_,width:P,height:C});const{gl:D}=this;D.bindTexture(this.target,this.handle);let W=null;({data:_,dataType:W}=this._getDataType({data:_,compressed:R}));let z,N=0;if(ua(this.gl,m,()=>{switch(W){case"null":D.texImage2D(n,i,a,P,C,h,L,S,_);break;case"typed-array":D.texImage2D(n,i,a,P,C,h,L,S,_,l);break;case"buffer":z=Ss(D),z.bindBuffer(35052,_.handle||_),z.texImage2D(n,i,a,P,C,h,L,S,l),z.bindBuffer(35052,null);break;case"browser-object":Vn(D)?D.texImage2D(n,i,a,P,C,h,L,S,_):D.texImage2D(n,i,a,L,S,_);break;case"compressed":for(const[F,$]of _.entries())D.compressedTexImage2D(n,F,$.format,$.width,$.height,h,$.data),N+=$.levelSize;break;default:Vt(!1,"Unknown image data type")}}),W==="compressed")this._trackAllocatedMemory(N,"Texture");else if(_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const F=s3[this.dataFormat]||4,$=o3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*F*$,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:a=0,y:h=0,width:l=this.width,height:m=this.height,level:_=0,format:S=this.format,type:P=this.type,dataFormat:C=this.dataFormat,compressed:L=!1,offset:R=0,border:D=this.border,parameters:W={}}=e;if({type:P,dataFormat:C,compressed:L,width:l,height:m}=this._deduceParameters({format:S,type:P,dataFormat:C,compressed:L,data:i,width:l,height:m}),Vt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const z=i;i=z.data,l=z.shape[0],m=z.shape[1]}i instanceof ur&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ua(this.gl,W,()=>{if(L)this.gl.compressedTexSubImage2D(n,_,a,h,l,m,S,i);else if(i===null)this.gl.texSubImage2D(n,_,a,h,l,m,C,P,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,_,a,h,l,m,C,P,i,R);else if(i instanceof JC){const z=Ss(this.gl);z.bindBuffer(35052,i),z.texSubImage2D(n,_,a,h,l,m,C,P,R),z.bindBuffer(35052,null)}else Vn(this.gl)?Ss(this.gl).texSubImage2D(n,_,a,h,l,m,C,P,i):this.gl.texSubImage2D(n,_,a,h,C,P,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ln.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ur?{data:n.handle,dataType:"buffer"}:n instanceof JC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:a,dataFormat:h,type:l,compressed:m}=e;const _=d2[n];return h=h||_&&_.dataFormat,l=l||_&&_.types[0],m=m||_&&_.compressed,{width:i,height:a}=this._deduceImageSize(r,i,a),{dataFormat:h,type:l,compressed:m,width:i,height:a,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Vt(i,"Could not deduced texture size"),Vt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Vt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Vt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Vn(this.gl)||!this.width||!this.height?!1:!YC(this.width)||!YC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:yV.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let _V="";function vV(t,e){return Vt(typeof t=="string"),t=_V+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class da extends Ed{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Ed.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};V_(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:vV(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const _w=[34069,34070,34071,34072,34073,34074];class a3 extends Ed{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};V_(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:a=0,mipmapLevel:h=0}=e;return this._subImage({target:n,data:r,x:i,y:a,mipmapLevel:h})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:a,border:h=0,format:l=6408,type:m=5121}=e;const{gl:_}=this,S=i||a,P=await Promise.all(_w.map(C=>{const L=S[C];return Promise.all(Array.isArray(L)?L:[L])}));this.bind(),_w.forEach((C,L)=>{P[L].length>1&&this.opts.mipmaps!==!1&&ln.warn("".concat(this.id," has mipmap and multiple LODs."))(),P[L].forEach((R,D)=>{n&&r?_.texImage2D(C,D,l,n,r,h,l,m,R):_.texImage2D(C,D,l,l,m,R)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:a,data:h,border:l=0,format:m=6408,type:_=5121}=e,{gl:S}=this,P=a||h;return this.bind(),P instanceof Promise?P.then(C=>this.setImageDataForFace(Object.assign({},e,{face:n,data:C,pixels:C}))):this.width||this.height?S.texImage2D(n,0,m,r,i,l,m,_,P):S.texImage2D(n,0,m,m,_,P),this}}a3.FACES=_w;class xV extends Ed{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:a,depth:h=1,border:l=0,format:m,type:_=5121,offset:S=0,data:P,parameters:C={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ua(this.gl,C,()=>{ArrayBuffer.isView(P)&&this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,P),P instanceof ur&&(this.gl.bindBuffer(35052,P.handle),this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,S))}),P&&P.byteLength)this._trackAllocatedMemory(P.byteLength,"Texture");else{const L=s3[this.dataFormat]||4,R=o3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*L*R,"Texture")}return this.loaded=!0,this}}const eu="EXT_color_buffer_float",QC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:eu,bpp:2},33327:{gl2:eu,bpp:4},34842:{gl2:eu,bpp:8},33326:{gl2:eu,bpp:4},33328:{gl2:eu,bpp:8},34836:{gl2:eu,bpp:16},35898:{gl2:eu,bpp:4}};function bV(t,e,n){const r=n[e];if(!r)return!1;const i=Vn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Qh extends Tl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||bV(e,n,QC)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:a=0}=e;return Vt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),a!==0&&Vn(this.gl)?this.gl.renderbufferStorageMultisample(36161,a,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=a,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*QC[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const wV=256,SV=1024,TV=16384,eA=6144,tA=6145,nA=6146,rA=34041,l3="clear: bad arguments";function f2(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a={};e&&(a.framebuffer=e);let h=0;n&&(h|=TV,n!==!0&&(a.clearColor=n)),r&&(h|=wV,r!==!0&&(a.clearDepth=r)),i&&(h|=SV,r!==!0&&(a.clearStencil=r)),Vt(h!==0,l3),ua(t,a,()=>{t.clear(h)})}function EV(t){let{framebuffer:e=null,buffer:n=eA,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(t),ua(t,{framebuffer:e},()=>{switch(n){case eA:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case tA:t.clearBufferfv(tA,0,[i]);break;case nA:t.clearBufferiv(nA,0,[i]);break;case rA:const[a,h]=i;t.clearBufferfi(rA,0,a,h);break;default:Vt(!1,l3)}})}function PV(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Vt(!1),0}}function U_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:a=36064,target:h=null,sourceWidth:l,sourceHeight:m,sourceType:_}=e;const{framebuffer:S,deleteFramebuffer:P}=CV(t);Vt(S);const{gl:C,handle:L,attachments:R}=S;l=l||S.width,m=m||S.height,a===36064&&L===null&&(a=1028),Vt(R[a]),_=_||R[a].type,h=AV(h,_,i,l,m),_=_||gw(h);const D=C.bindFramebuffer(36160,L);return C.readPixels(n,r,l,m,i,_,h),C.bindFramebuffer(36160,D||null),P&&S.delete(),h}function iA(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=U_(t,{sourceAttachment:e}),{width:i,height:a}=t;for(;a>n;)({data:r,width:i,height:a}=uV({data:r,width:i,height:a}));cV({data:r,width:i,height:a});const h=document.createElement("canvas");h.width=i,h.height=a;const l=h.getContext("2d"),m=l.createImageData(i,a);return m.data.set(r),l.putImageData(m,0,0),h.toDataURL()}function CV(t){return t instanceof xi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:NV(t),deleteFramebuffer:!0}}function AV(t,e,n,r,i){if(t)return t;e=e||5121;const a=fm(e,{clamped:!1}),h=PV(n);return new a(r*i*h)}const Tr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function IV(t){const e=new da(t,{format:6408,type:5126,dataFormat:6408}),n=new xi(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const c3={[Tr.WEBGL2]:[!1,!0],[Tr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Tr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Tr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Tr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Tr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Tr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Tr.FLOAT_BLEND]:["EXT_float_blend"],[Tr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Tr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Tr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Tr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Tr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Tr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Tr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Tr.COLOR_ATTACHMENT_RGBA32F]:[IV,"EXT_color_buffer_float"],[Tr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Tr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Tr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Tr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Tr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Tr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},kV=2;function MV(t,e){return p2(t,e)}function p2(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>u3(t,n))}function LV(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in c3)t.luma.caps[e]===void 0&&(t.luma.caps[e]=u3(t,e));return t.luma.caps}function u3(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=RV(t,e)),t.luma.caps[e]||ln.log(kV,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function RV(t,e){const n=c3[e];Vt(n,e);let r;const i=Vn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const a of i)r=r&&!!t.getExtension(a)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Vt(!1);return r}const sA="Multiple render targets not supported";class xi extends Tl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let a=!0;return r&&(a=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(a=a&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),a}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new xi(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ss(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ss(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:a=!0,depth:h=!0,stencil:l=!1,check:m=!0,readBuffer:_=void 0,drawBuffers:S=void 0}=e;if(Vt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const P in i){const C=i[P];(Array.isArray(C)?C[0]:C).resize({width:n,height:r})}else i=this._createDefaultAttachments(a,h,l,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:_,drawBuffers:S}),i&&m&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:a=!1,resizeAttachments:h=!0}=e;this.attach(n,{clearAttachments:a,resizeAttachments:h});const{gl:l}=this,m=l.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),l.bindFramebuffer(36160,m||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Vt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&ln.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(h=>{i[h]=null}),Object.assign(i,e);const a=this.gl.bindFramebuffer(36160,this.handle);for(const h in i){Vt(h!==void 0,"Misspelled framebuffer binding point?");const l=Number(h),m=i[l];let _=m;if(!_)this._unattach(l);else if(_ instanceof Qh)this._attachRenderbuffer({attachment:l,renderbuffer:_});else if(Array.isArray(m)){const[S,P=0,C=0]=m;_=S,this._attachTexture({attachment:l,texture:S,layer:P,level:C})}else this._attachTexture({attachment:l,texture:_,layer:0,level:0});r&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,a||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(h=>!this.attachments[h]).forEach(h=>{delete this.attachments[h]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(zV(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:a=[]}=e,h=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&f2(this.gl,{color:n,depth:r,stencil:i}),a.forEach((l,m)=>{EV(this.gl,{drawBuffer:m,value:l})}),this.gl.bindFramebuffer(36160,h||null),this}readPixels(){return ln.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return ln.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return ln.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return ln.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return ln.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return ln.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:a,height:h}=e;const l=Ss(this.gl),m=l.bindFramebuffer(36008,this.handle);return r===0&&i===0&&a===void 0&&h===void 0?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,r,i,a,h),l.bindFramebuffer(36008,m),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=xc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const a of r){const h=n?xc(this.gl,a):a;i[h]=this.getAttachmentParameter(e,a,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const a=Number(i),h=e?xc(this.gl,a):a;r[h]=this.getAttachmentParameters(a,e)}return r}show(){return typeof window<"u"&&window.open(iA(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>ln.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=iA(this,{targetMaxHeight:100});return ln.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,a){let h=null;return e&&(h=h||{},h[36064]=new da(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:a,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(h[36064])),n&&r?(h=h||{},h[33306]=new Qh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(h[33306])):n?(h=h||{},h[36096]=new Qh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:a}),this.ownResources.push(h[36096])):r&&Vt(!1),h}_unattach(e){const n=this.attachments[e];n&&(n instanceof Qh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:a}=e;const{gl:h}=this;switch(h.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Ss(h).framebufferTextureLayer(36160,n,r.target,a,i);break;case 34067:const m=OV(i);h.framebufferTexture2D(36160,n,m,r.handle,a);break;case 3553:h.framebufferTexture2D(36160,n,3553,r.handle,a);break;default:Vt(!1,"Illegal texture type")}h.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=cj(this.gl);n?n.readBuffer(e):Vt(e===36064||e===1029,sA),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Ss(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Vt(e.length===1&&(e[0]===36064||e[0]===1029),sA)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=LV(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function OV(t){return t<34069?t+34069:t}function zV(t){return(xi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const DV=[36049,36048,33296,33298,33299,33300,33301,33302,33303];xi.ATTACHMENT_PARAMETERS=DV;function FV(t,e){Vt(t instanceof da||t instanceof a3||t instanceof xV);const n=t.constructor,{gl:r,width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:S}=t,P=Object.assign({width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:S},e);return new n(r,P)}function NV(t,e){const{gl:n,width:r,height:i,id:a}=t;return new xi(n,Object.assign({},e,{id:"framebuffer-for-".concat(a),width:r,height:i,attachments:{36064:t}}))}function g0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const BV=35632,jV=35633;function VV(t){switch(t){case BV:return"fragment";case jV:return"vertex";default:return"unknown type"}}function UV(t,e,n,r){const i=t.split(/\r?\n/),a={},h={},l=r||g0(e)||"(unnamed)",m="".concat(VV(n)," shader ").concat(l);for(let S=0;S<i.length;S++){const P=i[S];if(P.length<=1)continue;const C=P.split(":"),L=C[0],R=parseInt(C[2],10);if(isNaN(R))throw new Error("GLSL compilation error in ".concat(m,": ").concat(t));L!=="WARNING"?a[R]=P:h[R]=P}const _=$V(e);return{shaderName:m,errors:oA(a,_),warnings:oA(h,_)}}function oA(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const a=t[r+1],h=a.split(":",3),l=h[0],m=parseInt(h[1],10)||0,_=a.substring(h.join(":").length+1).trim();n+=h3("^^^ ".concat(l,": ").concat(_,`

`),m)}}return n}function $V(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((a,h)=>{const l=String(h+e),m=l.length;return h3(l,i-m)+n+a})}function h3(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function d3(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const GV="Shader: GLSL source code must be a JavaScript string";class pm extends Tl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Vt(!1),"unknown"}}constructor(e,n){V_(e),Vt(typeof n.source=="string",GV);const r=g0(n.source,null)||n.id||Ec("unnamed ".concat(pm.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=g0(n,null);r&&(this.id=Ec(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(pm.getTypeName(this.shaderType),":").concat(this.id)}getName(){return g0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:a,warnings:h}=UV(r,this.source,this.shaderType,this.id);throw ln.error("GLSL compilation errors in ".concat(i,`
`).concat(a))(),ln.warn("GLSL compilation warnings in ".concat(i,`
`).concat(h))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Pb extends pm{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Cb extends pm{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const WV={5126:wr.bind(null,"uniform1fv",Zs,1,ns),35664:wr.bind(null,"uniform2fv",Zs,2,ns),35665:wr.bind(null,"uniform3fv",Zs,3,ns),35666:wr.bind(null,"uniform4fv",Zs,4,ns),5124:wr.bind(null,"uniform1iv",ql,1,ns),35667:wr.bind(null,"uniform2iv",ql,2,ns),35668:wr.bind(null,"uniform3iv",ql,3,ns),35669:wr.bind(null,"uniform4iv",ql,4,ns),35670:wr.bind(null,"uniform1iv",ql,1,ns),35671:wr.bind(null,"uniform2iv",ql,2,ns),35672:wr.bind(null,"uniform3iv",ql,3,ns),35673:wr.bind(null,"uniform4iv",ql,4,ns),35674:wr.bind(null,"uniformMatrix2fv",Zs,4,tl),35675:wr.bind(null,"uniformMatrix3fv",Zs,9,tl),35676:wr.bind(null,"uniformMatrix4fv",Zs,16,tl),35678:Fi,35680:Fi,5125:wr.bind(null,"uniform1uiv",Py,1,ns),36294:wr.bind(null,"uniform2uiv",Py,2,ns),36295:wr.bind(null,"uniform3uiv",Py,3,ns),36296:wr.bind(null,"uniform4uiv",Py,4,ns),35685:wr.bind(null,"uniformMatrix2x3fv",Zs,6,tl),35686:wr.bind(null,"uniformMatrix2x4fv",Zs,8,tl),35687:wr.bind(null,"uniformMatrix3x2fv",Zs,6,tl),35688:wr.bind(null,"uniformMatrix3x4fv",Zs,12,tl),35689:wr.bind(null,"uniformMatrix4x2fv",Zs,8,tl),35690:wr.bind(null,"uniformMatrix4x3fv",Zs,12,tl),35678:Fi,35680:Fi,35679:Fi,35682:Fi,36289:Fi,36292:Fi,36293:Fi,36298:Fi,36299:Fi,36300:Fi,36303:Fi,36306:Fi,36307:Fi,36308:Fi,36311:Fi},HV={},qV={},ZV={},aA=[0];function m2(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(aA[0]=t,t=aA);const i=t.length;if(i%e&&ln.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let a=r[i];a||(a=new n(i),r[i]=a);for(let h=0;h<i;h++)a[h]=t[h];return a}function Zs(t,e){return m2(t,e,Float32Array,HV)}function ql(t,e){return m2(t,e,Int32Array,qV)}function Py(t,e){return m2(t,e,Uint32Array,ZV)}function lA(t,e,n){const r=WV[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function XV(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function YV(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!KV(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function KV(t){return Array.isArray(t)||ArrayBuffer.isView(t)?QV(t):isFinite(t)||t===!0||t===!1||t instanceof Ed||t instanceof Qh?!0:t instanceof xi?!!t.texture:!1}function JV(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,a=n.length;i<a;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function QV(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Fi(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function wr(t,e,n,r){let i=null,a=null;return(h,l,m)=>{const _=e(m,n),S=_.length;let P=!1;if(i===null)i=new Float32Array(S),a=S,P=!0;else{Vt(a===S,"Uniform length cannot change.");for(let C=0;C<S;++C)if(_[C]!==i[C]){P=!0;break}}return P&&(r(h,t,l,_),i.set(_)),P}}function ns(t,e,n,r){t[e](n,r)}function tl(t,e,n,r){t[e](n,!1,r)}const eU=5120,tU=5121,nU=5122,rU=5123,cA=0,Cy=1,iU=2,sU=3,Ay=4,oU=5,aU=6,yi=5126,lU=35664,cU=35665,uU=35666,up=5124,hU=35667,dU=35668,fU=35669,hp=5125,pU=36294,mU=36295,gU=36296,yU=35670,_U=35671,vU=35672,xU=35673,bU=35674,wU=35675,SU=35676,TU=35685,EU=35686,PU=35687,CU=35688,AU=35689,IU=35690,vw={[yi]:[yi,1,"float"],[lU]:[yi,2,"vec2"],[cU]:[yi,3,"vec3"],[uU]:[yi,4,"vec4"],[up]:[up,1,"int"],[hU]:[up,2,"ivec2"],[dU]:[up,3,"ivec3"],[fU]:[up,4,"ivec4"],[hp]:[hp,1,"uint"],[pU]:[hp,2,"uvec2"],[mU]:[hp,3,"uvec3"],[gU]:[hp,4,"uvec4"],[yU]:[yi,1,"bool"],[_U]:[yi,2,"bvec2"],[vU]:[yi,3,"bvec3"],[xU]:[yi,4,"bvec4"],[bU]:[yi,8,"mat2"],[TU]:[yi,8,"mat2x3"],[EU]:[yi,8,"mat2x4"],[wU]:[yi,12,"mat3"],[PU]:[yi,12,"mat3x2"],[CU]:[yi,12,"mat3x4"],[SU]:[yi,16,"mat4"],[AU]:[yi,16,"mat4x2"],[IU]:[yi,16,"mat4x3"]};function kU(t){switch(t){case cA:return cA;case Cy:return Cy;case sU:return Cy;case iU:return Cy;case Ay:return Ay;case oU:return Ay;case aU:return Ay;default:return Vt(!1),0}}function uA(t){const e=vw[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function f3(t,e){switch(t){case eU:case tU:case nU:case rU:t=yi;break}for(const n in vw){const[r,i,a]=vw[n];if(r===t&&i===e)return{glType:n,name:a}}return null}class MU{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getActiveAttrib(e.handle,i),m=n.getAttribLocation(e.handle,a);m>=0&&this._addAttribute(m,a,h,l)}this.attributeInfos.sort((i,a)=>i.location-a.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Vn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,a,h,l)}this.varyingInfos.sort((i,a)=>i.location-a.location)}_addAttribute(e,n,r,i){const{type:a,components:h}=uA(r),l={type:a,size:i*h};this._inferProperties(e,n,l);const m={location:e,name:n,accessor:new Qs(l)};this.attributeInfos.push(m),this.attributeInfosByLocation[e]=m,this.attributeInfosByName[m.name]=m}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:a,components:h}=uA(r),l=new Qs({type:a,size:i*h}),m={location:e,name:n,accessor:l};this.varyingInfos.push(m),this.varyingInfosByName[m.name]=m}}const hA=4,LU=35981,RU=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class p3 extends Tl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",RU),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:a,bufferMode:h=LU}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Pb(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Cb(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Vt(this.vs instanceof Pb),Vt(this.fs instanceof Cb),this.uniforms={},this._textureUniforms={},a&&a.length>0&&(Ss(this.gl),this.varyings=a,this.gl2.transformFeedbackVaryings(this.handle,a,h)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new MU(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:a=0,start:h,end:l,isIndexed:m=!1,indexType:_=5123,instanceCount:S=0,isInstanced:P=S>0,vertexArray:C=null,transformFeedback:L,framebuffer:R,parameters:D={},uniforms:W,samplers:z}=e;if((W||z)&&(ln.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(W||{})),ln.priority>=n){const N=R?R.id:"default",F="mode=".concat(xc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(S," indexType=").concat(xc(this.gl,_)," ")+"isInstanced=".concat(P," isIndexed=").concat(m," ")+"Framebuffer=".concat(N);ln.log(n,F)()}return Vt(C),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||P&&S===0?!1:(C.bindForDraw(i,S,()=>{if(R!==void 0&&(D=Object.assign({},D,{framebuffer:R})),L){const N=kU(r);L.begin(N)}this._bindTextures(),ua(this.gl,D,()=>{m&&P?this.gl2.drawElementsInstanced(r,i,_,a,S):m&&Vn(this.gl)&&!isNaN(h)&&!isNaN(l)?this.gl2.drawRangeElements(r,h,l,i,_,a):m?this.gl.drawElements(r,i,_,a):P?this.gl2.drawArraysInstanced(r,a,i,S):this.gl.drawArrays(r,a,i)}),L&&L.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ln.priority>=2&&YV(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let a=r,h=!1;if(a instanceof xi&&(a=a.texture),a instanceof Ed)if(h=this.uniforms[n]!==r,h){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const l=a,{textureIndex:m}=i;l.bind(m),a=m,this._textureUniforms[n]=l}else a=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(a)||h)&&JV(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Pb({handle:i});break;case 35632:r.fs=new Cb({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Ec(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ln.time(hA,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),ln.timeEnd(hA,"linkProgram for ".concat(this._getName()))(),e.debug||ln.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=XV(r.name);let a=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=lA(e,a,r),r.size>1)for(let h=0;h<r.size;h++)a=e.getUniformLocation(this.handle,"".concat(i,"[").concat(h,"]")),this._uniformSetters["".concat(i,"[").concat(h,"]")]=lA(e,a,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const OU=34918,zU=34919,DU=35007,FU=36795,NU=35976,BU=35887,jU=36202;class n_ extends Tl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Vn(e),i=p2(e,Tr.TIMER_QUERY);let a=r||i;for(const h of n)switch(h){case"queries":a=a&&r;break;case"timers":a=a&&i;break;default:Vt(!1)}return a}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(DU)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?jU:BU)}beginTransformFeedbackQuery(){return this.begin(NU)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,zU);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(FU)}getResult(){return this.gl2.getQueryParameter(this.handle,OU)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const a=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}_createHandle(){return n_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class m3 extends Tl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Td(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:a,byteOffset:h}=this._getBufferParams(n);return r<0?(this.unused[e]=i,ln.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,h,a),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ur?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const a=n&&n.handle;return!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Iy=null;function VU(t){return(!Iy||Iy.byteLength<t)&&(Iy=new ArrayBuffer(t)),Iy}function UU(t,e){const n=VU(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function $U(t){let{target:e,source:n,start:r=0,count:i=1}=t;const a=n.length,h=i*a;let l=0;for(let m=r;l<a;l++)e[m++]=n[l];for(;l<h;)l<h-l?(e.copyWithin(r+l,r,r+l),l*=2):(e.copyWithin(r+l,r,r+h-l),l=h);return e}const GU="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ys extends Tl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Vn(e)||FR()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ys(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ys.MAX_ATTRIBUTES=Ys.MAX_ATTRIBUTES||e.getParameter(34921),Ys.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ys._setConstantFloatArray(e,n,r);break;case Int32Array:Ys._setConstantIntArray(e,n,r);break;case Uint32Array:Ys._setConstantUintArray(e,n,r);break;default:Vt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ys.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Vt(!e||e.target===34963,GU),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:a,stride:h,offset:l,normalized:m,integer:_,divisor:S}=r,{gl:P,gl2:C}=this;return e=Number(e),this.bind(()=>{P.bindBuffer(34962,n.handle),_?(Vt(Vn(P)),C.vertexAttribIPointer(e,i,a,h,l)):P.vertexAttribPointer(e,i,a,m,h,l),P.enableVertexAttribArray(e),C.vertexAttribDivisor(e,S||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ys.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,a=r.length*e;let h=!this.buffer;if(this.buffer=this.buffer||new ur(this.gl,i),h=h||this.buffer.reallocate(i),h=h||!this._compareConstantArrayValues(r,this.bufferValue),h){const l=UU(n.constructor,a);$U({target:l,source:r,start:0,count:a}),this.buffer.subData(l),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Vt(!1)}}static _setConstantIntArray(e,n,r){switch(Vt(Vn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Vt(!1)}}static _setConstantUintArray(e,n,r){switch(Vt(Vn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Vt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Vt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const WU="VertexArray: attributes must be Buffers or constants (i.e. typed array)",HU=/^(.+)__LOCATION_([0-9]+)$/,qU=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class ZU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ys(e),r3(this,"VertexArray","v6.0",qU),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,a)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ur(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ur&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ur&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const a={location:-1,accessor:null},{location:h,name:l}=this._getAttributeIndex(e);if(!Number.isFinite(h)||h<0)return this.unused[e]=n,ln.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),a;const m=this._getAttributeInfo(l||h);if(!m)return a;const _=this.accessors[h]||{},S=Qs.resolve(m.accessor,_,r,i),{size:P,type:C}=S;return Vt(Number.isFinite(P)&&Number.isFinite(C)),{location:h,accessor:S}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=HU.exec(e),i=r?r[1]:e,a=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+a,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ur)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ur){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ur){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(WU)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let a=1;a<this.vertexArrayObject.MAX_ATTRIBUTES;a++)i=this.values[a],ArrayBuffer.isView(i)&&this._setConstantAttribute(a,i)}_setConstantAttributeZero(e,n){if(Ys.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Ys.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:a}=i,h=a>0;if(e.isInstanced=e.isInstanced||h,r instanceof ur){const l=r;if(h){const m=l.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,m)}else{const m=l.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,m)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ln.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function XU(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let h=0;h<t.length&&h<n;++h)h>0&&(i+=",".concat(h%r===0?" ":"")),i+=mm(t[h],e);const a=t.length>n?"...":"]";return"".concat(i).concat(a)}function mm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return XU(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function dA(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Vt(n);const a=".*_.*",h=".*Matrix",l=n._uniformSetters,m={},_=Object.keys(l).sort();let S=0;for(const L of _)!L.match(a)&&!L.match(h)&&Ab({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;for(const L of _)L.match(h)&&Ab({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;for(const L of _)m[L]||Ab({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;let P=0;const C={};if(!i)for(const L in r){const R=r[L];m[L]||(P++,C[L]={Type:"NOT USED: ".concat(R),[e]:mm(R)})}return{table:m,count:S,unusedTable:C,unusedCount:P}}function Ab(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:a}=t;const h=r[i],l=YU(h);return!a||!l?(e[i]={[n]:l?mm(h):"N/A","Uniform Type":l?h:"NOT PROVIDED"},!0):!1}function YU(t){return t!=null}function KU(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=fA(e,e.elements,null,n));const i=e.values;for(const a in i){const h=e._getAttributeInfo(a);if(h){let l="".concat(a,": ").concat(h.name);const m=e.accessors[h.location];m&&(l="".concat(a,": ").concat(JU(h.name,m))),r[l]=fA(e,i[a],m,n)}}return r}function fA(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let a="NOT PROVIDED",h=1,l=0,m=0,_,S,P;if(n&&(a=n.type,h=n.size,a=String(a).replace("Array",""),_=a.indexOf("nt")!==-1),e instanceof ur){const C=e,{data:L,changed:R}=C.getDebugData();S=R?"*":"",P=L,m=C.byteLength,l=m/L.BYTES_PER_ELEMENT/h;let D;if(n){const W=n.divisor>0;D="".concat(W?"I ":"P "," ").concat(l," (x").concat(h,"=").concat(m," bytes ").concat(xc(i,a),")")}else _=!0,D="".concat(m," bytes");return{[r]:"".concat(S).concat(mm(P,{size:h,isInteger:_})),"Format ":D}}return P=e,h=e.length,a=String(e.constructor.name).replace("Array",""),_=a.indexOf("nt")!==-1,{[r]:"".concat(mm(P,{size:h,isInteger:_})," (constant)"),"Format ":"".concat(h,"x").concat(a," (constant)")}}function JU(t,e){const{type:n,size:r}=e,i=f3(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function QU(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=pA(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=pA(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function pA(t){const{type:e,size:n}=t.accessor,r=f3(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const mA=Sl()&&typeof document<"u";let e$=0;class t${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=W=>n3(W),onAddHTML:r=null,onInitialize:i=()=>{},onRender:a=()=>{},onFinalize:h=()=>{},onError:l,gl:m=null,glOptions:_={},debug:S=!1,createFramebuffer:P=!1,autoResizeViewport:C=!0,autoResizeDrawingBuffer:L=!0,stats:R=mu.get("animation-loop-".concat(e$++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(ln.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:a,onFinalize:h,onError:l,gl:m,glOptions:_,debug:S,createFramebuffer:P},this.gl=m,this.needsRedraw=null,this.timeline=null,this.stats=R,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:C,autoResizeDrawingBuffer:L,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Vt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=n_.isSupported(this.gl,["timers"])?new n_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return ln.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=mA?new Promise((e,n)=>{if(mA&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):aV(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):oV(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?h2(this.props.gl,e):this.onCreateContext(e),!j_(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");qj(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Jj(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new xi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Um="vs",g2="fs";function io(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Ib={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function n$(t){const e={};for(const n in t){const r=t[n],i=r$(r);e[n]=i}return e}function r$(t){let e=gA(t);return e==="object"?t?"type"in t?Object.assign({},t,Ib[t.type]):"value"in t?(e=gA(t.value),Object.assign({type:e},t,Ib[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Ib[e])}function gA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const i$="vs",s$="fs";class yA{constructor(e){let{name:n,vs:r,fs:i,dependencies:a=[],uniforms:h,getUniforms:l,deprecations:m=[],defines:_={},inject:S={},vertexShader:P,fragmentShader:C}=e;io(typeof n=="string"),this.name=n,this.vs=r||P,this.fs=i||C,this.getModuleUniforms=l,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(m),this.defines=_,this.injections=o$(S),h&&(this.uniforms=n$(h))}getModuleSource(e){let n;switch(e){case i$:n=this.vs||"";break;case s$:n=this.fs||"";break;default:io(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const a=r[i];i in e&&!a.private?(a.validate&&io(a.validate(e[i],a),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=a.value}return n}}function o$(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function a$(t){return l$(y3(t))}function l$(t){const e={},n={};return g3({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function g3(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)r[a.name]=a,(i[a.name]===void 0||i[a.name]<n)&&(i[a.name]=n);for(const a of e)a.dependencies&&g3({modules:a.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function y3(t,e){return t.map(n=>(n instanceof yA||(io(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),io(n.name,"shader module has no name"),n=new yA(n),n.dependencies=y3(n.dependencies)),n))}function c$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const u$=7936,h$=7937,d$=7938,f$=35724,y2={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ou={};Object.keys(y2).forEach(t=>{ou[t]=t});function p$(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function m$(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||u$),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||h$);return{gpuVendor:g$(n,r),vendor:n,renderer:r,version:t.getParameter(d$),shadingLanguageVersion:t.getParameter(f$)}}function g$(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const kb={};function _A(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=y2[e];if(io(r,e),!c$(n))return!0;if(e in kb)return kb[e];const i=r[0],a=n.behavior||"enable",h="#extension GL_".concat(i," : ").concat(a,`
void main(void) {}`),l=t.createShader(35633);t.shaderSource(l,h),t.compileShader(l);const m=t.getShaderParameter(l,35713);return t.deleteShader(l),kb[e]=m,m}function y$(t,e){const n=y2[e];io(n,e);const r=p$(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return io(i===!1||i===!0),i}function ky(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>y$(t,n))}function _$(t){switch(m$(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function v$(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return ky(t,ou.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),ky(t,ou.GLSL_DERIVATIVES)&&_A(t,ou.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),ky(t,ou.GLSL_FRAG_DATA)&&_A(t,ou.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),ky(t,ou.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const x$=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,b$=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,w$={[Um]:x$,[g2]:b$},y0="__LUMA_INJECT_DECLARATIONS__",vA=/void\s+main\s*\([^)]*\)\s*\{\n?/,xA=/}\n?[^{}]*$/,Mb=[];function bA(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Um;for(const a in n){const h=n[a];h.sort((m,_)=>m.order-_.order),Mb.length=h.length;for(let m=0,_=h.length;m<_;++m)Mb[m]=h[m].injection;const l="".concat(Mb.join(`
`),`
`);switch(a){case"vs:#decl":i&&(t=t.replace(y0,l));break;case"vs:#main-start":i&&(t=t.replace(vA,m=>m+l));break;case"vs:#main-end":i&&(t=t.replace(xA,m=>l+m));break;case"fs:#decl":i||(t=t.replace(y0,l));break;case"fs:#main-start":i||(t=t.replace(vA,m=>m+l));break;case"fs:#main-end":i||(t=t.replace(xA,m=>l+m));break;default:t=t.replace(a,m=>m+l)}}return t=t.replace(y0,""),r&&(t=t.replace(/\}\s*$/,a=>a+w$[e])),t}function xw(t){const e={};return io(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function Pd(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const _3=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],S$=[..._3,[Pd("attribute"),"in $1"],[Pd("varying"),"out $1"]],T$=[..._3,[Pd("varying"),"in $1"]],v3=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],E$=[...v3,[Pd("in"),"attribute $1"],[Pd("out"),"varying $1"]],P$=[...v3,[Pd("in"),"varying $1"]],bw="gl_FragColor",ww=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,C$=/void\s+main\s*\([^)]*\)\s*\{\n?/;function A$(t,e,n){switch(e){case 300:return n?r_(t,S$):I$(t);case 100:return n?r_(t,E$):k$(t);default:throw new Error("unknown GLSL version ".concat(e))}}function r_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function I$(t){t=r_(t,T$);const e=t.match(ww);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(bw,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(C$,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(bw,"\\b"),"g"),n)}return t}function k$(t){t=r_(t,P$);const e=t.match(ww);if(e){const n=e[1];t=t.replace(ww,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),bw)}return t}const M$=`

`.concat(y0,`

`),x3={[Um]:"vertex",[g2]:"fragment"},L$=`precision highp float;

`;function R$(t,e){const{vs:n,fs:r}=e,i=a$(e.modules||[]);return{gl:t,vs:wA(t,Object.assign({},e,{source:n,type:Um,modules:i})),fs:wA(t,Object.assign({},e,{source:r,type:g2,modules:i})),getUniforms:O$(i)}}function wA(t,e){let{id:n,source:r,type:i,modules:a,defines:h={},hookFunctions:l=[],inject:m={},transpileToGLSL100:_=!1,prologue:S=!0,log:P}=e;io(typeof r=="string","shader source must be a string");const C=i===Um,L=r.split(`
`);let R=100,D="",W=r;L[0].indexOf("#version ")===0?(R=300,D=L[0],W=L.slice(1).join(`
`)):D="#version ".concat(R);const z={};a.forEach(se=>{Object.assign(z,se.getDefines())}),Object.assign(z,h);let N=S?"".concat(D,`
`).concat(D$({id:n,source:r,type:i}),`
`).concat(z$({type:i}),`
`).concat(_$(t),`
`).concat(v$(t),`
`).concat(F$(z),`
`).concat(C?"":L$,`
`):"".concat(D,`
`);const F=B$(l),$={},K={},ne={};for(const se in m){const xe=typeof m[se]=="string"?{injection:m[se],order:0}:m[se],Se=se.match(/^(v|f)s:(#)?([\w-]+)$/);if(Se){const _e=Se[2],Re=Se[3];_e?Re==="decl"?K[se]=[xe]:ne[se]=[xe]:$[se]=[xe]}else ne[se]=[xe]}for(const se of a){P&&se.checkDeprecations(W,P);const xe=se.getModuleSource(i,R);N+=xe;const Se=se.injections[i];for(const _e in Se){const Re=_e.match(/^(v|f)s:#([\w-]+)$/);if(Re){const Ve=Re[2]==="decl"?K:ne;Ve[_e]=Ve[_e]||[],Ve[_e].push(Se[_e])}else $[_e]=$[_e]||[],$[_e].push(Se[_e])}}return N+=M$,N=bA(N,i,K),N+=N$(F[i],$),N+=W,N=bA(N,i,ne),N=A$(N,_?100:R,C),N}function O$(t){return function(n){const r={};for(const i of t){const a=i.getUniforms(n,r);Object.assign(r,a)}return r}}function z$(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(x3[e].toUpperCase(),`
`)}function D$(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(x3[r],`

`):""}function F$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function N$(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const a=e[r];a.sort((h,l)=>h.order-l.order);for(const h of a)n+="  ".concat(h.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function B$(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,a]=n.split(":"),h=n.replace(/\(.+/,"");e[i][h]=Object.assign(r,{signature:a})}),e}const j$="void main() {gl_FragColor = vec4(0);}",b3=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,V$=`#version 300 es
`.concat(b3);function w3(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,a]=n;if(!e.includes(r)||!i||!a)return null;const h=a.split(";")[0];return{qualifier:r,type:i,name:h}}function S3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?V$:e>300?"#version ".concat(e,`
`).concat(b3):j$;const a=G$(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(a,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(a,`;
}`)}function U$(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return io(!1),null}}function $$(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return io(!1),null}}function G$(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return io(!1),null}}const W$=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,H$={name:"fp32",vs:W$,fs:null};function SA(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const no={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function q$(t,{precision:e=no.precision}={}){return t=Z$(t),"".concat(parseFloat(t.toPrecision(e)))}function Cd(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function oc(t,e,n){return Y$(t,r=>Math.max(e,Math.min(n,r)))}function gm(t,e,n){return Cd(t)?t.map((r,i)=>gm(r,e[i],n)):n*e+(1-n)*t}function ym(t,e,n){const r=no.EPSILON;n&&(no.EPSILON=n);try{if(t===e)return!0;if(Cd(t)&&Cd(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!ym(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=no.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{no.EPSILON=r}}function Z$(t){return Math.round(t/no.EPSILON)*no.EPSILON}function X$(t){return t.clone?t.clone():new Array(t.length)}function Y$(t,e,n){if(Cd(t)){const r=t;n=n||X$(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function K$(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class T3 extends K$(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Cd(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(no)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+q$(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!ym(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const a=e[i];this[i]=a+r*(n[i]-a)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(no.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function J$(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Js(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Lb(t,e,n=""){if(no.debug&&!J$(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class Q$ extends T3{get x(){return this[0]}set x(e){this[0]=Js(e)}get y(){return this[1]}set y(e){this[1]=Js(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Js(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Js(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return SA(e>=0&&e<this.ELEMENTS,"index is out of range"),Js(this[e])}setComponent(e,n){return SA(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var _0=1e-6,Ad=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function e8(){var t=new Ad(2);return Ad!=Float32Array&&(t[0]=0,t[1]=0),t}function Sw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function t8(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function n8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function r8(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function i8(t,e){return t[0]=-e[0],t[1]=-e[1],t}function E3(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t}function s8(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var o8=t8;(function(){var t=e8();return function(e,n,r,i,a,h){var l,m;for(n||(n=2),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],a(t,t,h),e[l]=t[0],e[l+1]=t[1];return e}})();function a8(t,e,n){const r=e[0],i=e[1],a=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/a,t[1]=(n[1]*r+n[5]*i)/a,t}function P3(t,e,n){const r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a||1;return t[0]=(n[0]*r+n[4]*i+n[8]*a)/h,t[1]=(n[1]*r+n[5]*i+n[9]*a)/h,t[2]=(n[2]*r+n[6]*i+n[10]*a)/h,t}function l8(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function c8(){var t=new Ad(3);return Ad!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function u8(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function h8(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function d8(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function f8(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[0],l=n[1],m=n[2];return t[0]=i*m-a*l,t[1]=a*h-r*m,t[2]=r*l-i*h,t}function C3(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a+n[15];return h=h||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/h,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/h,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/h,t}function p8(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function m8(t,e,n){var r=n[0],i=n[1],a=n[2],h=n[3],l=e[0],m=e[1],_=e[2],S=i*_-a*m,P=a*l-r*_,C=r*m-i*l,L=i*C-a*P,R=a*S-r*C,D=r*P-i*S,W=h*2;return S*=W,P*=W,C*=W,L*=2,R*=2,D*=2,t[0]=l+S+L,t[1]=m+P+R,t[2]=_+C+D,t}function g8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function y8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function _8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function v8(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],h=e[1],l=e[2],m=Math.sqrt(n*n+r*r+i*i),_=Math.sqrt(a*a+h*h+l*l),S=m*_,P=S&&d8(t,e)/S;return Math.acos(Math.min(Math.max(P,-1),1))}var x8=u8;(function(){var t=c8();return function(e,n,r,i,a,h){var l,m;for(n||(n=3),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();const Rb=[0,0,0];let My;class Da extends Q${static get ZERO(){return My||(My=new Da(0,0,0),Object.freeze(My)),My}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Cd(e)?this.copy(e):(no.debug&&(Js(e),Js(n),Js(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return no.debug&&(Js(e.x),Js(e.y),Js(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Js(e)}angle(e){return v8(this,e)}cross(e){return f8(this,this,e),this.check()}rotateX({radians:e,origin:n=Rb}){return g8(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Rb}){return y8(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Rb}){return _8(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return C3(this,this,e),this.check()}transformAsVector(e){return P3(this,this,e),this.check()}transformByMatrix3(e){return p8(this,this,e),this.check()}transformByMatrix2(e){return l8(this,this,e),this.check()}transformByQuaternion(e){return m8(this,this,e),this.check()}}class b8 extends T3{toString(){let e="[";if(no.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Js(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function w8(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S8(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],h=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=h,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Tw(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=e[4],l=e[5],m=e[6],_=e[7],S=e[8],P=e[9],C=e[10],L=e[11],R=e[12],D=e[13],W=e[14],z=e[15],N=n*l-r*h,F=n*m-i*h,$=n*_-a*h,K=r*m-i*l,ne=r*_-a*l,se=i*_-a*m,xe=S*D-P*R,Se=S*W-C*R,_e=S*z-L*R,Re=P*W-C*D,De=P*z-L*D,Ve=C*z-L*W,je=N*Ve-F*De+$*Re+K*_e-ne*Se+se*xe;return je?(je=1/je,t[0]=(l*Ve-m*De+_*Re)*je,t[1]=(i*De-r*Ve-a*Re)*je,t[2]=(D*se-W*ne+z*K)*je,t[3]=(C*ne-P*se-L*K)*je,t[4]=(m*_e-h*Ve-_*Se)*je,t[5]=(n*Ve-i*_e+a*Se)*je,t[6]=(W*$-R*se-z*F)*je,t[7]=(S*se-C*$+L*F)*je,t[8]=(h*De-l*_e+_*xe)*je,t[9]=(r*_e-n*De-a*xe)*je,t[10]=(R*ne-D*$+z*N)*je,t[11]=(P*$-S*ne-L*N)*je,t[12]=(l*Se-h*Re-m*xe)*je,t[13]=(n*Re-r*Se+i*xe)*je,t[14]=(D*F-R*K-W*N)*je,t[15]=(S*K-P*F+C*N)*je,t):null}function T8(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],h=t[5],l=t[6],m=t[7],_=t[8],S=t[9],P=t[10],C=t[11],L=t[12],R=t[13],D=t[14],W=t[15],z=e*h-n*a,N=e*l-r*a,F=e*m-i*a,$=n*l-r*h,K=n*m-i*h,ne=r*m-i*l,se=_*R-S*L,xe=_*D-P*L,Se=_*W-C*L,_e=S*D-P*R,Re=S*W-C*R,De=P*W-C*D;return z*De-N*Re+F*_e+$*Se-K*xe+ne*se}function bu(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3],l=e[4],m=e[5],_=e[6],S=e[7],P=e[8],C=e[9],L=e[10],R=e[11],D=e[12],W=e[13],z=e[14],N=e[15],F=n[0],$=n[1],K=n[2],ne=n[3];return t[0]=F*r+$*l+K*P+ne*D,t[1]=F*i+$*m+K*C+ne*W,t[2]=F*a+$*_+K*L+ne*z,t[3]=F*h+$*S+K*R+ne*N,F=n[4],$=n[5],K=n[6],ne=n[7],t[4]=F*r+$*l+K*P+ne*D,t[5]=F*i+$*m+K*C+ne*W,t[6]=F*a+$*_+K*L+ne*z,t[7]=F*h+$*S+K*R+ne*N,F=n[8],$=n[9],K=n[10],ne=n[11],t[8]=F*r+$*l+K*P+ne*D,t[9]=F*i+$*m+K*C+ne*W,t[10]=F*a+$*_+K*L+ne*z,t[11]=F*h+$*S+K*R+ne*N,F=n[12],$=n[13],K=n[14],ne=n[15],t[12]=F*r+$*l+K*P+ne*D,t[13]=F*i+$*m+K*C+ne*W,t[14]=F*a+$*_+K*L+ne*z,t[15]=F*h+$*S+K*R+ne*N,t}function i_(t,e,n){var r=n[0],i=n[1],a=n[2],h,l,m,_,S,P,C,L,R,D,W,z;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(h=e[0],l=e[1],m=e[2],_=e[3],S=e[4],P=e[5],C=e[6],L=e[7],R=e[8],D=e[9],W=e[10],z=e[11],t[0]=h,t[1]=l,t[2]=m,t[3]=_,t[4]=S,t[5]=P,t[6]=C,t[7]=L,t[8]=R,t[9]=D,t[10]=W,t[11]=z,t[12]=h*r+S*i+R*a+e[12],t[13]=l*r+P*i+D*a+e[13],t[14]=m*r+C*i+W*a+e[14],t[15]=_*r+L*i+z*a+e[15]),t}function _2(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function E8(t,e,n,r){var i=r[0],a=r[1],h=r[2],l=Math.hypot(i,a,h),m,_,S,P,C,L,R,D,W,z,N,F,$,K,ne,se,xe,Se,_e,Re,De,Ve,je,We;return l<_0?null:(l=1/l,i*=l,a*=l,h*=l,m=Math.sin(n),_=Math.cos(n),S=1-_,P=e[0],C=e[1],L=e[2],R=e[3],D=e[4],W=e[5],z=e[6],N=e[7],F=e[8],$=e[9],K=e[10],ne=e[11],se=i*i*S+_,xe=a*i*S+h*m,Se=h*i*S-a*m,_e=i*a*S-h*m,Re=a*a*S+_,De=h*a*S+i*m,Ve=i*h*S+a*m,je=a*h*S-i*m,We=h*h*S+_,t[0]=P*se+D*xe+F*Se,t[1]=C*se+W*xe+$*Se,t[2]=L*se+z*xe+K*Se,t[3]=R*se+N*xe+ne*Se,t[4]=P*_e+D*Re+F*De,t[5]=C*_e+W*Re+$*De,t[6]=L*_e+z*Re+K*De,t[7]=R*_e+N*Re+ne*De,t[8]=P*Ve+D*je+F*We,t[9]=C*Ve+W*je+$*We,t[10]=L*Ve+z*je+K*We,t[11]=R*Ve+N*je+ne*We,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function A3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],h=e[5],l=e[6],m=e[7],_=e[8],S=e[9],P=e[10],C=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+_*r,t[5]=h*i+S*r,t[6]=l*i+P*r,t[7]=m*i+C*r,t[8]=_*i-a*r,t[9]=S*i-h*r,t[10]=P*i-l*r,t[11]=C*i-m*r,t}function P8(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[8],S=e[9],P=e[10],C=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-_*r,t[1]=h*i-S*r,t[2]=l*i-P*r,t[3]=m*i-C*r,t[8]=a*r+_*i,t[9]=h*r+S*i,t[10]=l*r+P*i,t[11]=m*r+C*i,t}function I3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[4],S=e[5],P=e[6],C=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+_*r,t[1]=h*i+S*r,t[2]=l*i+P*r,t[3]=m*i+C*r,t[4]=_*i-a*r,t[5]=S*i-h*r,t[6]=P*i-l*r,t[7]=C*i-m*r,t}function C8(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=n+n,l=r+r,m=i+i,_=n*h,S=r*h,P=r*l,C=i*h,L=i*l,R=i*m,D=a*h,W=a*l,z=a*m;return t[0]=1-P-R,t[1]=S+z,t[2]=C-W,t[3]=0,t[4]=S-z,t[5]=1-_-R,t[6]=L+D,t[7]=0,t[8]=C+W,t[9]=L-D,t[10]=1-_-P,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A8(t,e,n,r,i,a,h){var l=1/(n-e),m=1/(i-r),_=1/(a-h);return t[0]=a*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*m,t[6]=0,t[7]=0,t[8]=(n+e)*l,t[9]=(i+r)*m,t[10]=(h+a)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*a*2*_,t[15]=0,t}function I8(t,e,n,r,i){var a=1/Math.tan(e/2),h;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(h=1/(r-i),t[10]=(i+r)*h,t[14]=2*i*r*h):(t[10]=-1,t[14]=-2*r),t}var k8=I8;function M8(t,e,n,r,i,a,h){var l=1/(e-n),m=1/(r-i),_=1/(a-h);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+n)*l,t[13]=(i+r)*m,t[14]=(h+a)*_,t[15]=1,t}var L8=M8;function R8(t,e,n,r){var i,a,h,l,m,_,S,P,C,L,R=e[0],D=e[1],W=e[2],z=r[0],N=r[1],F=r[2],$=n[0],K=n[1],ne=n[2];return Math.abs(R-$)<_0&&Math.abs(D-K)<_0&&Math.abs(W-ne)<_0?w8(t):(S=R-$,P=D-K,C=W-ne,L=1/Math.hypot(S,P,C),S*=L,P*=L,C*=L,i=N*C-F*P,a=F*S-z*C,h=z*P-N*S,L=Math.hypot(i,a,h),L?(L=1/L,i*=L,a*=L,h*=L):(i=0,a=0,h=0),l=P*h-C*a,m=C*i-S*h,_=S*a-P*i,L=Math.hypot(l,m,_),L?(L=1/L,l*=L,m*=L,_*=L):(l=0,m=0,_=0),t[0]=i,t[1]=l,t[2]=S,t[3]=0,t[4]=a,t[5]=m,t[6]=P,t[7]=0,t[8]=h,t[9]=_,t[10]=C,t[11]=0,t[12]=-(i*R+a*D+h*W),t[13]=-(l*R+m*D+_*W),t[14]=-(S*R+P*D+C*W),t[15]=1,t)}function O8(){var t=new Ad(4);return Ad!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function z8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $m(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*h,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*h,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*h,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*h,t}(function(){var t=O8();return function(e,n,r,i,a,h){var l,m;for(n||(n=4),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();var Ew;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Ew||(Ew={}));const D8=45*Math.PI/180,F8=1,Ob=.1,zb=500,N8=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Fa extends b8{static get IDENTITY(){return j8()}static get ZERO(){return B8()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ew}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,a,h,l,m,_,S,P,C,L,R,D,W){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=a,this[5]=h,this[6]=l,this[7]=m,this[8]=_,this[9]=S,this[10]=P,this[11]=C,this[12]=L,this[13]=R,this[14]=D,this[15]=W,this.check()}setRowMajor(e,n,r,i,a,h,l,m,_,S,P,C,L,R,D,W){return this[0]=e,this[1]=a,this[2]=_,this[3]=L,this[4]=n,this[5]=h,this[6]=S,this[7]=R,this[8]=r,this[9]=l,this[10]=P,this[11]=D,this[12]=i,this[13]=m,this[14]=C,this[15]=W,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(N8)}fromObject(e){return this.check()}fromQuaternion(e){return C8(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:a,near:h=Ob,far:l=zb}=e;return l===1/0?V8(this,n,r,i,a,h):A8(this,n,r,i,a,h,l),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return R8(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:a,near:h=Ob,far:l=zb}=e;return L8(this,n,r,i,a,h,l),this.check()}orthographic(e){const{fovy:n=D8,aspect:r=F8,focalDistance:i=1,near:a=Ob,far:h=zb}=e;TA(n);const l=n/2,m=i*Math.tan(l),_=m*r;return this.ortho({left:-_,right:_,bottom:-m,top:m,near:a,far:h})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:a=500}=e;return TA(n),k8(this,n,r,i,a),this.check()}determinant(){return T8(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*h,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*h,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*h,e}transpose(){return S8(this,this),this.check()}invert(){return Tw(this,this),this.check()}multiplyLeft(e){return bu(this,e,this),this.check()}multiplyRight(e){return bu(this,this,e),this.check()}rotateX(e){return A3(this,this,e),this.check()}rotateY(e){return P8(this,this,e),this.check()}rotateZ(e){return I3(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return E8(this,this,e,n),this.check()}scale(e){return _2(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return i_(this,this,e),this.check()}transform(e,n){return e.length===4?(n=$m(n||[-0,-0,-0,-0],e,this),Lb(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=s8(n||[-0,-0],e,this);break;case 3:i=C3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Lb(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=a8(n||[-0,-0],e,this);break;case 3:r=P3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Lb(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Ly,Ry;function B8(){return Ly||(Ly=new Fa([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Ly)),Ly}function j8(){return Ry||(Ry=new Fa,Object.freeze(Ry)),Ry}function TA(t){if(t>Math.PI*2)throw Error("expected radians")}function V8(t,e,n,r,i,a){const h=2*a/(n-e),l=2*a/(i-r),m=(n+e)/(n-e),_=(i+r)/(i-r),S=-1,P=-1,C=-2*a;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=m,t[9]=_,t[10]=S,t[11]=P,t[12]=0,t[13]=0,t[14]=C,t[15]=0,t}const EA=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,U8={lightSources:{}};function Db(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function $8(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Db(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((a,h)=>{i["lighting_uPointLight[".concat(h,"].color")]=Db(a),i["lighting_uPointLight[".concat(h,"].position")]=a.position,i["lighting_uPointLight[".concat(h,"].attenuation")]=a.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((a,h)=>{i["lighting_uDirectionalLight[".concat(h,"].color")]=Db(a),i["lighting_uDirectionalLight[".concat(h,"].direction")]=a.direction}),i.lighting_uDirectionalLightCount=r.length,i}function k3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:U8;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},$8({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return k3({lightSources:e})}return{}}const G8={name:"lights",vs:EA,fs:EA,getUniforms:k3,defines:{MAX_LIGHTS:3}},W8=new Uint8Array([0,255,255,255]),H8={pickingSelectedColor:null,pickingHighlightColor:W8,pickingActive:!1,pickingAttribute:!1};function q8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H8;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Z8=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,X8=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,Y8={name:"picking",vs:Z8,fs:X8,getUniforms:q8},K8=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,J8={};function Q8(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(a=>a/255)}}function e9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J8;if(!("material"in t))return{};const{material:e}=t;return e?Q8(e):{lighting_uEnabled:!1}}const t9={name:"gouraud-lighting",dependencies:[G8],vs:K8,defines:{LIGHTING_VERTEX:1},getUniforms:e9},n9=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,r9={name:"transform",vs:n9,fs:null};class Gm{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Gm(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:a={},varyings:h=[],bufferMode:l=35981,transpileToGLSL100:m=!1}=e,_=this._getModuleList(e.modules),S=this._getHash(n),P=this._getHash(r),C=_.map(F=>this._getHash(F.name)).sort(),L=h.map(F=>this._getHash(F)),R=Object.keys(i).sort(),D=Object.keys(a).sort(),W=[],z=[];for(const F of R)W.push(this._getHash(F)),W.push(this._getHash(i[F]));for(const F of D)z.push(this._getHash(F)),z.push(this._getHash(a[F]));const N="".concat(S,"/").concat(P,"D").concat(W.join("/"),"M").concat(C.join("/"),"I").concat(z.join("/"),"V").concat(L.join("/"),"H").concat(this.stateHash,"B").concat(l).concat(m?"T":"");if(!this._programCache[N]){const F=R$(this.gl,{vs:n,fs:r,modules:_,inject:a,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:m});this._programCache[N]=new p3(this.gl,{hash:N,vs:F.vs,fs:F.fs,varyings:h,bufferMode:l}),this._getUniforms[N]=F.getUniforms||($=>{}),this._useCounts[N]=0}return this._useCounts[N]++,this._programCache[N]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let a=0,h=this._defaultModules.length;a<h;++a){const l=this._defaultModules[a],m=l.name;n[i++]=l,r[m]=!0}for(let a=0,h=e.length;a<h;++a){const l=e[a],m=l.name;r[m]||(n[i++]=l,r[m]=!0)}return n.length=i,n}}const i9={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function s9(t,e,n){const r={};let i=e.indices;for(const a in e.attributes){const h=e.attributes[a],l=o9(a,n);if(a==="indices")i=h;else if(h.constant)r[l]=h.value;else{const m=h.value,_={...h};delete _.value,r[l]=[new ur(t,m),_],a9(a,_)}}if(i){const a=i.value||i;Vt(a instanceof Uint16Array||a instanceof Uint32Array,'attribute array for "indices" must be of integer type');const h={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ur(t,{data:a,target:34963}),h]}return r}function o9(t,e){const{attributeMap:n=i9}=e||{};return n&&n[t]||t}function a9(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Vt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Ph=2,l9=1e4,c9="Model needs drawMode and vertexCount",PA=()=>{},u9={};class _m{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Ec("model")}=n;Vt(j_(e)),this.id=r,this.gl=e,this.id=n.id||Ec("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Gm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Vt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),c9)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Vt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Vt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=s9(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Td(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return f2(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:a={},transformFeedback:h=this.transformFeedback,parameters:l={},vertexArray:m=this.vertexArray}=e;this.setAttributes(a),this.updateModuleSettings(n),this.setUniforms(i);let _;ln.priority>=Ph&&(_=this._logDrawCallStart(Ph));const S=this.vertexArray.getDrawParams(),{isIndexed:P=S.isIndexed,indexType:C=S.indexType,indexOffset:L=S.indexOffset,vertexArrayInstanced:R=S.isInstanced}=this.props;R&&!this.isInstanced&&ln.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:W}=this,{onBeforeRender:z=PA,onAfterRender:N=PA}=this.props;z(),this.program.setUniforms(this.uniforms);const F=this.program.draw(Object.assign(u9,e,{logPriority:_,uniforms:null,framebuffer:r,parameters:l,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:m,transformFeedback:h,isIndexed:P,indexType:C,isInstanced:D,instanceCount:W,offset:P?L:0}));return N(),ln.priority>=Ph&&this._logDrawCallEnd(_,m,r),F}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:a}=e;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,{35977:n})),i.forEach(h=>h.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:a}))}finally{i.forEach(h=>h.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ln.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:S}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Vt(n instanceof p3,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new ZU(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ur&&n.delete()}}_setAnimationProps(e){this.animated&&Vt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Td(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new m3(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:l9;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),ln.group(Ph,">>> DRAWING MODEL ".concat(this.id),{collapsed:ln.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const a=KU({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:h,unusedTable:l,unusedCount:m}=dA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:_,count:S}=dA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});S>0&&ln.log("MISSING UNIFORMS",Object.keys(_))(),m>0&&ln.log("UNUSED UNIFORMS",Object.keys(l))();const P=QU(this.vertexArray.configuration);ln.table(e,a)(),ln.table(e,h)(),ln.table(e+1,P)(),i&&i.log({logLevel:Ph,message:"Rendered to ".concat(i.id)}),ln.groupEnd(Ph)()}}class h9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ur?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Vt(Vn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const a=this.feedbackMap[i];i in n&&(r[a]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const a=r[i];if(typeof a=="string"){const h=n[a],{byteLength:l,usage:m,accessor:_}=h;r[i]=this._createNewBuffer(i,{byteLength:l,usage:m,accessor:_})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new m3(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const a=this.feedbackMap[i];n[i]=e.feedbackBuffers[a],r[a]=e.sourceBuffers[i],Vt(r[a]instanceof ur)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ur(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const d9="transform_uSampler_",s_="transform_uSize_",CA="transform_position";function f9(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,h=Object.keys(n).length,l=null;const m={};let _=e,S={};if(h>0||r){const P=_.split(`
`),C=P.slice();if(P.forEach((L,R,D)=>{if(h>0){const W=_9(L,n);if(W){const{updatedLine:z,inject:N}=W;C[R]=z,S=xw([S,N]),Object.assign(m,W.samplerTextureMap),h--}}r&&!l&&(l=y9(L,r))}),r){Vt(i);const L="".concat(s_).concat(r),R="uniform vec2 ".concat(L,`;
`),D="     vec2 ".concat(CA," = transform_getPos(").concat(L,`);
     gl_Position = vec4(`).concat(CA,`, 0, 1.);
`);S=xw([S,{"vs:#decl":R,"vs:#main-start":D}])}_=C.join(`
`)}return{vs:_,targetTextureType:l,inject:S,samplerTextureMap:m}}function p9(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let a,h;n&&({width:a,height:h}=r,i["".concat(s_).concat(n)]=[a,h]);for(const l in e)({width:a,height:h}=e[l]),i["".concat(s_).concat(l)]=[a,h];return i}function m9(t){return w3(t,["attribute","in"])}function g9(t){const e="".concat(d9).concat(t),n="".concat(s_).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function y9(t,e){const n=w3(t,["varying","out"]);return n&&n.name===e?n.type:null}function _9(t,e){const n={},r=m9(t);if(!r)return null;const{type:i,name:a}=r;if(a&&e[a]){const h="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:l,sizeName:m,uniformDeclerations:_}=g9(a),S=U$(i),P="  ".concat(i," ").concat(a," = transform_getInput(").concat(l,", ").concat(m,").").concat(S,`;
`);return n[l]=a,{updatedLine:h,inject:{"vs:#decl":_,"vs:#main-start":P},samplerTextureMap:n}}return null}const v9={10241:9728,10240:9728,10242:33071,10243:33071},x9="transform_output";class b9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:a}=this.bindings[this.currentIndex],h=Object.assign({},n,e.attributes),l=Object.assign({},e.uniforms),m=Object.assign({},e.parameters);let _=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){h.transform_elementID=this.elementIDBuffer;for(const P in this.samplerTextureMap){const C=this.samplerTextureMap[P];l[P]=r[C]}this._setSourceTextureParameters();const S=p9({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:a});Object.assign(l,S)}return this.hasTargetTexture&&(_=!1,m.viewport=[0,0,i.width,i.height]),{attributes:h,framebuffer:i,uniforms:l,discard:_,parameters:m}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=U_(n);if(!e)return r;const i=r.constructor,a=$$(this.targetTextureType),h=new i(r.length*a/4);let l=0;for(let m=0;m<r.length;m+=4)for(let _=0;_<a;_++)h[l++]=r[m+_];return h}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof da)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,a=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:a}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,a)=>{a[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ur(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:a}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),a){e.targetTexture=a;const{width:h,height:l}=a,{framebuffer:m}=e;m?(m.update({attachments:{36064:a},resizeAttachments:!1}),m.resize({width:h,height:l})):e.framebuffer=new xi(this.gl,{id:"transform-framebuffer",width:h,height:l,attachments:{36064:a}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(v9)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=FV(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:a,targetTextureType:h,inject:l,samplerTextureMap:m}=f9({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),_=xw([e.inject||{},l]);this.targetTextureType=h,this.samplerTextureMap=m;const S=e._fs||S3({version:d3(i),input:this.targetTextureVarying,inputType:h,output:x9}),P=this.hasSourceTextures||this.targetTextureVarying?[r9].concat(e.modules||[]):e.modules;return{vs:i,fs:S,modules:P,uniforms:a,inject:_}}}class v2{static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Vt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new _m(n,Object.assign({},e,{fs:e.fs||S3({version:d3(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){w9(n)&&(this.bufferTransform=new h9(e,n)),S9(n)&&(this.textureTransform=new b9(e,n)),Vt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function w9(t){return!!(!Td(t.feedbackBuffers)||!Td(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function S9(t){return!!(!Td(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const AA={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class x2{static get DRAW_MODE(){return AA}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ec("geometry"),drawMode:r=AA.TRIANGLES,attributes:i={},indices:a=null,vertexCount:h=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,a),this.vertexCount=h||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Vt(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Vt(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const a=e[i],{value:h,size:l,constant:m}=a;!m&&h&&l>=1&&(r=Math.min(r,h.length/l))}return Vt(Number.isFinite(r)),r}}let T9=1,E9=1;class M3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,h=T9++,l={time:0,delay:n,duration:r,rate:i,repeat:a};return this._setChannelTime(l,this.time),this.channels.set(h,l),h}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:a,channel:h}=i;a.setTime(this.getTime(h))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=E9++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const P9=[255,255,255],C9=1;let A9=0;class I9{constructor(e={}){J(this,"id",void 0),J(this,"color",void 0),J(this,"intensity",void 0),J(this,"type","ambient");const{color:n=P9}=e,{intensity:r=C9}=e;this.id=e.id||"ambient-".concat(A9++),this.color=n,this.intensity=r}}const k9=[255,255,255],M9=1,L9=[0,0,-1];let R9=0;class IA{constructor(e={}){J(this,"id",void 0),J(this,"color",void 0),J(this,"intensity",void 0),J(this,"type","directional"),J(this,"direction",void 0),J(this,"shadow",void 0);const{color:n=k9}=e,{intensity:r=M9}=e,{direction:i=L9}=e,{_shadow:a=!1}=e;this.id=e.id||"directional-".concat(R9++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Da(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class O9{constructor(e,n={id:"pass"}){J(this,"id",void 0),J(this,"gl",void 0),J(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class b2 extends O9{constructor(...e){super(...e),J(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return gl(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:a,onViewportActive:h,clearStack:l=!0,clearCanvas:m=!0}=e;e.pass=e.pass||"unknown";const _=this.gl;m&&D9(_,n),l&&(this._lastRenderIndex=-1);const S=[];for(const P of i){const C=a&&a[P.id];h==null||h(P);const L=this._getDrawLayerParams(P,e),R=P.subViewports||[P];for(const D of R){const W=this._drawLayersInViewport(_,{target:n,moduleParameters:r,viewport:D,view:C,pass:e.pass,layers:e.layers},L);S.push(W)}}return S}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:a,cullRect:h,effects:l,moduleParameters:m},_=!1){const S=[],P=L3(this._lastRenderIndex+1),C={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:h},L={};for(let R=0;R<n.length;R++){const D=n[R],W=this._shouldDrawLayer(D,C,a,L),z={shouldDrawLayer:W};W&&!_&&(z.layerRenderIndex=P(D,W),z.moduleParameters=this._getModuleParameters(D,l,r,m),z.layerParameters=this.getLayerParameters(D,R,e)),S[R]=z}return S}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:a,viewport:h,view:l},m){const _=z9(e,{moduleParameters:r,target:a,viewport:h});if(l&&l.props.clear){const P=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;ua(e,{scissorTest:!0,scissor:_},()=>f2(e,P))}const S={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};gl(e,{viewport:_});for(let P=0;P<n.length;P++){const C=n[P],{shouldDrawLayer:L,layerRenderIndex:R,moduleParameters:D,layerParameters:W}=m[P];if(L&&C.props.pickable&&S.pickableCount++,C.isComposite)S.compositeCount++;else if(L){S.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,R),D.viewport=h;try{C._drawLayer({moduleParameters:D,uniforms:{layerIndex:R},parameters:W})}catch(z){C.raiseError(z,"drawing ".concat(C," to ").concat(i))}}}return S}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let h=e.parent;for(;h;){if(!h.props.visible||!h.filterSubLayer(n))return!1;n.layer=h,h=h.parent}if(r){const l=n.layer.id;if(l in i||(i[l]=r(n)),!i[l])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a;const h=Object.assign(Object.create(((a=e.internalState)===null||a===void 0?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Sd(this.gl)});if(n)for(const m of n){var l;Object.assign(h,(l=m.getModuleParameters)===null||l===void 0?void 0:l.call(m,e))}return Object.assign(h,this.getModuleParameters(e,n),i)}}function L3(t=0,e={}){const n={},r=(i,a)=>{const h=i.props._offset,l=i.id,m=i.parent&&i.parent.id;let _;if(m&&!(m in e)&&r(i.parent,!1),m in n){const S=n[m]=n[m]||L3(e[m],e);_=S(i,a),n[l]=S}else Number.isFinite(h)?(_=h+(e[m]||0),n[l]=null):_=t;return a&&_>=t&&(t=_+1),e[l]=_,_};return r}function z9(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||Sd(t),h=i?n.height:t.drawingBufferHeight,l=r;return[l.x*a,h-(l.y+l.height)*a,l.width*a,l.height*a]}function D9(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;gl(t,{viewport:[0,0,n,r]}),t.clear(16640)}class F9 extends b2{constructor(e,n){super(e,n),J(this,"shadowMap",void 0),J(this,"depthBuffer",void 0),J(this,"fbo",void 0),this.shadowMap=new da(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Qh(e,{format:33189,width:1,height:1}),this.fbo=new xi(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;ua(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=Sd(this.gl),a=r.width*i,h=r.height*i;(a!==n.width||h!==n.height)&&n.resize({width:a,height:h}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const R3="#define SMOOTH_EDGE_RADIUS 0.5",N9=`
`.concat(R3,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),B9=`
`.concat(R3,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),j9={name:"geometry",vs:N9,fs:B9},V9=Object.keys(qn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(qn[t],";")).join(""),U9=Object.keys(ka).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(ka[t],";")).join(""),$9=Object.keys(dm).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(dm[t],";")).join(""),G9="".concat(V9,`
`).concat(U9,`
`).concat($9,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function W9(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Wm(t){let e={},n;return r=>{for(const i in r)if(!W9(r[i],e[i])){n=t(r),e=r;break}return n}}const kA=[0,0,0,0],H9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],O3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q9=[0,0,0],z3=[0,0,0],Z9=Wm(K9);function D3(t,e,n=z3){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,a=!0;switch(e===qn.LNGLAT_OFFSETS||e===qn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case ka.WEB_MERCATOR:(e===qn.LNGLAT||e===qn.CARTESIAN)&&(i=[0,0,0],a=!1);break;case ka.WEB_MERCATOR_AUTO_OFFSET:e===qn.LNGLAT?r=i:e===qn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case ka.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case ka.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:a}}function X9(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:h}=t,l=kA,m=kA,_=t.cameraPosition;const{geospatialOrigin:S,shaderCoordinateOrigin:P,offsetMode:C}=D3(t,e,n);return C&&(m=t.projectPosition(S||P),_=[_[0]-m[0],_[1]-m[1],_[2]-m[2]],m[3]=1,l=$m([],m,h),a=r||a,h=bu([],i,a),h=bu([],h,H9)),{viewMatrix:a,viewProjectionMatrix:h,projectionCenter:l,originCommon:m,cameraPosCommon:_,shaderCoordinateOrigin:P,geospatialOrigin:S}}function Y9({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=qn.DEFAULT,coordinateOrigin:i=z3,autoWrapLongitude:a=!1}){r===qn.DEFAULT&&(r=t.isGeospatial?qn.LNGLAT:qn.CARTESIAN);const h=Z9({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return h.project_uWrapLongitude=a,h.project_uModelMatrix=n||O3,h}function K9({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:h,cameraPosCommon:l,shaderCoordinateOrigin:m,geospatialOrigin:_}=X9(t,n,r),S=t.getDistanceScales(),P=[t.width*e,t.height*e],C=$m([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,L={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:h.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:P,project_uDevicePixelRatio:e,project_uFocalDistance:C,project_uCommonUnitsPerMeter:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:q9,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:O3,project_uCameraPosition:l};if(_){const R=t.getDistanceScales(_);switch(n){case qn.METER_OFFSETS:L.project_uCommonUnitsPerWorldUnit=R.unitsPerMeter,L.project_uCommonUnitsPerWorldUnit2=R.unitsPerMeter2;break;case qn.LNGLAT:case qn.LNGLAT_OFFSETS:t._pseudoMeters||(L.project_uCommonUnitsPerMeter=R.unitsPerMeter),L.project_uCommonUnitsPerWorldUnit=R.unitsPerDegree,L.project_uCommonUnitsPerWorldUnit2=R.unitsPerDegree2;break;case qn.CARTESIAN:L.project_uCommonUnitsPerWorldUnit=[1,1,R.unitsPerMeter[2]],L.project_uCommonUnitsPerWorldUnit2=[0,0,R.unitsPerMeter2[2]];break}}return L}const J9={};function Q9(t=J9){return"viewport"in t?Y9(t):{}}const w2={name:"project",dependencies:[H$,j9],vs:G9,getUniforms:Q9};function eG(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ud(t,e){const n=$m([],e,t);return z8(n,n,1/n[3]),n}function MA(t,e){const n=t%e;return n<0?e+n:n}function tG(t,e,n){return n*e+(1-n)*t}function Pw(t,e,n){return t<e?e:t>n?n:t}function nG(t){return Math.log(t)*Math.LOG2E}const S2=Math.log2||nG;function yl(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const oa=Math.PI,F3=oa/4,Ro=oa/180,Cw=180/oa,Id=512,o_=4003e4,Oy=85.051129,rG=1.5;function LA(t){return Math.pow(2,t)}function N3(t){return S2(t)}function kd(t){const[e,n]=t;yl(Number.isFinite(e)),yl(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Ro,i=n*Ro,a=Id*(r+oa)/(2*oa),h=Id*(oa+Math.log(Math.tan(F3+i*.5)))/(2*oa);return[a,h]}function Iu(t){const[e,n]=t,r=e/Id*(2*oa)-oa,i=2*(Math.atan(Math.exp(n/Id*(2*oa)-oa))-F3);return[r*Cw,i*Cw]}function iG(t){const{latitude:e}=t;yl(Number.isFinite(e));const n=Math.cos(e*Ro);return N3(o_*n)-9}function Fb(t){const e=Math.cos(t*Ro);return Id/o_/e}function Aw(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;yl(Number.isFinite(e)&&Number.isFinite(n));const i=Id,a=Math.cos(e*Ro),h=i/360,l=h/a,m=i/o_/a,_={unitsPerMeter:[m,m,m],metersPerUnit:[1/m,1/m,1/m],unitsPerDegree:[h,l,m],degreesPerUnit:[1/h,1/l,1/m]};if(r){const S=Ro*Math.tan(e*Ro)/a,P=h*S/2,C=i/o_*S,L=C/l*m;_.unitsPerDegree2=[0,P,C],_.unitsPerMeter2=[L,0,L]}return _}function B3(t,e){const[n,r,i]=t,[a,h,l]=e,{unitsPerMeter:m,unitsPerMeter2:_}=Aw({longitude:n,latitude:r,highPrecision:!0}),S=kd(t);S[0]+=a*(m[0]+_[0]*h),S[1]+=h*(m[1]+_[1]*h);const P=Iu(S),C=(i||0)+(l||0);return Number.isFinite(i)||Number.isFinite(l)?[P[0],P[1],C]:P}function sG(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:a,center:h}=t,l=eG();i_(l,l,[0,0,-i]),A3(l,l,-n*Ro),I3(l,l,r*Ro);const m=a/e;return _2(l,l,[m,m,m]),h&&i_(l,l,h8([],h)),l}function oG(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:a,center:h,scale:l,nearZMultiplier:m=1,farZMultiplier:_=1}=t;let{fovy:S=a_(rG)}=t;r!==void 0&&(S=a_(r));const P=S*Ro,C=i*Ro,L=j3(S);let R=L;h&&(R+=h[2]*l/Math.cos(C)/n);const D=P*(.5+(a?a[1]:0)/n),W=Math.sin(D)*R/Math.sin(Pw(Math.PI/2-C-D,.01,Math.PI-.01)),z=Math.sin(C)*W+R,N=R*10,F=Math.min(z*_,N);return{fov:P,aspect:e/n,focalDistance:L,near:m,far:F}}function a_(t){return 2*Math.atan(.5/t)*Cw}function j3(t){return .5/Math.tan(.5*t*Ro)}function V3(t,e){const[n,r,i=0]=t;return yl(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),ud(e,[n,r,i,1])}function T2(t,e,n=0){const[r,i,a]=t;if(yl(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return ud(e,[r,i,a,1]);const h=ud(e,[r,i,0,1]),l=ud(e,[r,i,1,1]),m=h[2],_=l[2],S=m===_?0:((n||0)-m)/(_-m);return E3([],h,l,S)}function aG(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:a=24,offset:h=[0,0]}=t,[[l,m],[_,S]]=r,P=lG(t.padding),C=kd([l,Pw(S,-Oy,Oy)]),L=kd([_,Pw(m,-Oy,Oy)]),R=[Math.max(Math.abs(L[0]-C[0]),i),Math.max(Math.abs(L[1]-C[1]),i)],D=[e-P.left-P.right-Math.abs(h[0])*2,n-P.top-P.bottom-Math.abs(h[1])*2];yl(D[0]>0&&D[1]>0);const W=D[0]/R[0],z=D[1]/R[1],N=(P.right-P.left)/2/W,F=(P.top-P.bottom)/2/z,$=[(L[0]+C[0])/2+N,(L[1]+C[1])/2+F],K=Iu($),ne=Math.min(a,S2(Math.abs(Math.min(W,z))));return yl(Number.isFinite(ne)),{longitude:K[0],latitude:K[1],zoom:ne}}function lG(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(yl(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const RA=Math.PI/180;function cG(t,e=0){const{width:n,height:r,unproject:i}=t,a={targetZ:e},h=i([0,r],a),l=i([n,r],a);let m,_;const S=t.fovy?.5*t.fovy*RA:Math.atan(.5/t.altitude),P=(90-t.pitch)*RA;return S>P-.01?(m=OA(t,0,e),_=OA(t,n,e)):(m=i([0,0],a),_=i([n,0],a)),[h,l,_,m]}function OA(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=ud(r,[e,0,1,1]),a=ud(r,[e,t.height,1,1]),l=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),m=E3([],i,a,l),_=Iu(m);return _.push(n),_}const zA=512;function uG(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:a,zoom:h,bearing:l=0}=t;(i<-180||i>180)&&(i=MA(i+180,360)-180),(l<-180||l>180)&&(l=MA(l+180,360)-180);const m=S2(n/zA);if(h<=m)h=m,a=0;else{const _=n/2/Math.pow(2,h),S=Iu([0,_])[1];if(a<S)a=S;else{const P=Iu([0,zA-_])[1];a>P&&(a=P)}}return{width:e,height:n,longitude:i,latitude:a,zoom:h,pitch:r,bearing:l}}const U3=.01,hG=["longitude","latitude","zoom"],$3={curve:1.414,speed:1.2};function dG(t,e,n,r){const{startZoom:i,startCenterXY:a,uDelta:h,w0:l,u1:m,S:_,rho:S,rho2:P,r0:C}=G3(t,e,r);if(m<U3){const $={};for(const K of hG){const ne=t[K],se=e[K];$[K]=tG(ne,se,n)}return $}const L=n*_,R=Math.cosh(C)/Math.cosh(C+S*L),D=l*((Math.cosh(C)*Math.tanh(C+S*L)-Math.sinh(C))/P)/m,W=1/R,z=i+N3(W),N=n8([],h,D);Sw(N,N,a);const F=Iu(N);return{longitude:F[0],latitude:F[1],zoom:z}}function fG(t,e,n){const r={...$3,...n},{screenSpeed:i,speed:a,maxDuration:h}=r,{S:l,rho:m}=G3(t,e,r),_=1e3*l;let S;return Number.isFinite(i)?S=_/(i/m):S=_/a,Number.isFinite(h)&&S>h?0:S}function G3(t,e,n){n=Object.assign({},$3,n);const r=n.curve,i=t.zoom,a=[t.longitude,t.latitude],h=LA(i),l=e.zoom,m=[e.longitude,e.latitude],_=LA(l-i),S=kd(a),P=kd(m),C=o8([],P,S),L=Math.max(t.width,t.height),R=L/_,D=r8(C)*h,W=Math.max(D,U3),z=r*r,N=(R*R-L*L+z*z*W*W)/(2*L*z*W),F=(R*R-L*L-z*z*W*W)/(2*R*z*W),$=Math.log(Math.sqrt(N*N+1)-N),K=Math.log(Math.sqrt(F*F+1)-F),ne=(K-$)/r;return{startZoom:i,startCenterXY:S,uDelta:C,w0:L,u1:D,S:ne,rho:r,rho2:z,r0:$,r1:K}}const pG=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,mG=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,gG=Wm(bG),yG=Wm(wG),_G=[0,0,0,1],vG=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function xG(t,e){const[n,r,i]=t,a=T2([n,r,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function bG({viewport:t,center:e}){return new Fa(t.viewProjectionMatrix).invert().transform(e)}function wG({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(h=>xG(h,r));for(const h of e){const l=h.clone().translate(new Da(t.center).negate()),m=a.map(S=>l.transform(S)),_=new Fa().ortho({left:Math.min(...m.map(S=>S[0])),right:Math.max(...m.map(S=>S[0])),bottom:Math.min(...m.map(S=>S[1])),top:Math.max(...m.map(S=>S[1])),near:Math.min(...m.map(S=>-S[2])),far:Math.max(...m.map(S=>-S[2]))});n.push(_.multiplyRight(h))}return n}function SG(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||_G,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=gG({viewport:t.viewport,center:e.project_uCenter}),a=[],h=yG({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<t.shadowMatrices.length;l++){const m=h[l],_=m.clone().translate(new Da(t.viewport.center).negate());e.project_uCoordinateSystem===qn.LNGLAT&&e.project_uProjectionMode===ka.WEB_MERCATOR?(h[l]=_,a[l]=i):(h[l]=m.clone().multiplyRight(vG),a[l]=_.transform(i))}for(let l=0;l<h.length;l++)r["shadow_uViewProjectionMatrices[".concat(l,"]")]=h[l],r["shadow_uProjectCenters[".concat(l,"]")]=a[l],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(l)]=t.shadowMaps[l]:r["shadow_uShadowMap".concat(l)]=t.dummyShadowMap;return r}const Nb={name:"shadow",dependencies:[w2],vs:pG,fs:mG,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?SG(t,e):{}},TG={color:[255,255,255],intensity:1},DA=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],EG=[0,0,0,200/255];class W3{constructor(e={}){J(this,"id","lighting-effect"),J(this,"props",void 0),J(this,"shadowColor",EG),J(this,"shadow",void 0),J(this,"ambientLight",void 0),J(this,"directionalLights",void 0),J(this,"pointLights",void 0),J(this,"shadowPasses",[]),J(this,"shadowMaps",[]),J(this,"dummyShadowMap",null),J(this,"programManager",void 0),J(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Gm.getDefaultProgramManager(e),Nb&&this.programManager.addDefaultModule(Nb)),this.dummyShadowMap||(this.dummyShadowMap=new da(e,{width:1,height:1}));for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Nb),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Fa().lookAt({eye:new Da(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new F9(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new I9(TG),this.directionalLights.push(new IA(DA[0]),new IA(DA[1])))}}class PG{constructor(e={}){J(this,"_pool",[]),J(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:a=0,copy:h=!1,initialize:l=!1,maxCount:m}){const _=i||e&&e.constructor||Float32Array,S=n*r+a;if(ArrayBuffer.isView(e)){if(S<=e.length)return e;if(S*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new _(e.buffer,0,S)}let P=1/0;m&&(P=m*r+a);const C=this._allocate(_,S,l,P);return e&&h?C.set(e):l||C.fill(0,0,4),this._release(e),C}release(e){this._release(e)}_allocate(e,n,r,i){let a=Math.max(Math.ceil(n*this.opts.overAlloc),1);a>i&&(a=i);const h=this._pool,l=e.BYTES_PER_ELEMENT*a,m=h.findIndex(_=>_.byteLength>=l);if(m>=0){const _=new e(h.splice(m,1)[0],0,a);return r&&_.fill(0),_}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,a=n.findIndex(h=>h.byteLength>=i);a<0?n.push(r):(a>0||n.length<this.opts.poolSize)&&n.splice(a,0,r),n.length>this.opts.poolSize&&n.shift()}}const Md=new PG;function Ap(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function CG(t){return[t[12],t[13],t[14]]}function AG(t){return{left:Ch(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ch(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ch(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ch(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ch(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ch(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const FA=new Da;function Ch(t,e,n,r){FA.set(t,e,n);const i=FA.len();return{distance:r/i,normal:new Da(-t/i,-e/i,-n/i)}}function IG(t){return t-Math.fround(t)}let dp;function Bb(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-r)/n;dp=Md.allocate(dp,a,{type:Float32Array,size:n*2});let h=r,l=0;for(;h<i;){for(let m=0;m<n;m++){const _=t[h++];dp[l+m]=_,dp[l+m+n]=IG(_)}l+=n*2}return dp.subarray(0,a*n*2)}function kG(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const MG=Math.PI/180,LG=Ap(),NA=[0,0,0],RG={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function OG({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:a,near:h,far:l}){const m=t/e,_=n?new Fa().orthographic({fovy:r,aspect:m,focalDistance:i,near:h,far:l}):new Fa().perspective({fovy:r,aspect:m,near:h,far:l});if(a){const{left:S=0,right:P=0,top:C=0,bottom:L=0}=a,R=oc((S+t-P)/2,0,t)-t/2,D=oc((C+e-L)/2,0,e)-e/2;_[8]-=R*2/t,_[9]+=D*2/e}return _}class Hd{constructor(e={}){J(this,"id",void 0),J(this,"x",void 0),J(this,"y",void 0),J(this,"width",void 0),J(this,"height",void 0),J(this,"padding",void 0),J(this,"isGeospatial",void 0),J(this,"zoom",void 0),J(this,"focalDistance",void 0),J(this,"position",void 0),J(this,"modelMatrix",void 0),J(this,"distanceScales",void 0),J(this,"scale",void 0),J(this,"center",void 0),J(this,"cameraPosition",void 0),J(this,"projectionMatrix",void 0),J(this,"viewMatrix",void 0),J(this,"viewMatrixUncentered",void 0),J(this,"viewMatrixInverse",void 0),J(this,"viewProjectionMatrix",void 0),J(this,"pixelProjectionMatrix",void 0),J(this,"pixelUnprojectionMatrix",void 0),J(this,"resolution",void 0),J(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||RG,this.focalDistance=e.focalDistance||1,this.position=e.position||NA,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?ka.WEB_MERCATOR:ka.WEB_MERCATOR_AUTO_OFFSET:ka.IDENTITY}equals(e){return e instanceof Hd?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ym(e.projectionMatrix,this.projectionMatrix)&&ym(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=V3(r,this.pixelProjectionMatrix),[a,h]=i,l=n?h:this.height-h;return e.length===2?[a,l]:[a,l,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,a,h]=e,l=n?a:this.height-a,m=r&&r*this.distanceScales.unitsPerMeter[2],_=T2([i,l,h],this.pixelUnprojectionMatrix,m),[S,P,C]=this.unprojectPosition(_);return Number.isFinite(h)?[S,P,C]:Number.isFinite(r)?[S,P,r]:[S,P]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=kd(e);return n[1]=oc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Iu(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),a=this.unproject([0,this.height],n),h=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],a[0],h[0]),Math.min(r[1],i[1],a[1],h[1]),Math.max(r[0],i[0],a[0],h[0]),Math.max(r[1],i[1],a[1],h[1])]}getDistanceScales(e){return e?Aw({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,AG(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=iG({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Aw({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:h}=e;let l=NA;if(a&&(l=h?new Fa(h).transformAsVector(a,[]):a),this.isGeospatial){const m=this.projectPosition([n,r,0]);this.center=new Da(l).scale(this.distanceScales.unitsPerMeter).add(m)}else this.center=this.projectPosition(l)}_initMatrices(e){const{viewMatrix:n=LG,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:a,fovy:h=75,near:l=.1,far:m=1e3,padding:_=null,focalDistance:S=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Fa().multiplyRight(n).translate(new Da(this.center).negate()),this.projectionMatrix=r||OG({width:this.width,height:this.height,orthographic:i,fovyRadians:a||h*MG,focalDistance:S,padding:_,near:l,far:m});const P=Ap();bu(P,P,this.projectionMatrix),bu(P,P,this.viewMatrix),this.viewProjectionMatrix=P,this.viewMatrixInverse=Tw([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=CG(this.viewMatrixInverse);const C=Ap(),L=Ap();_2(C,C,[this.width/2,-this.height/2,1]),i_(C,C,[1,-1,0]),bu(L,C,this.viewProjectionMatrix),this.pixelProjectionMatrix=L,this.pixelUnprojectionMatrix=Tw(Ap(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||hr.warn("Pixel project matrix not invertible")()}}J(Hd,"displayName","Viewport");class Ld extends Hd{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:a=0,bearing:h=0,nearZMultiplier:l=.1,farZMultiplier:m=1.01,nearZ:_,farZ:S,orthographic:P=!1,projectionMatrix:C,repeat:L=!1,worldOffset:R=0,position:D,padding:W,legacyMeterSizes:z=!1}=e;let{width:N,height:F,altitude:$=1.5}=e;const K=Math.pow(2,i);N=N||1,F=F||1;let ne,se=null;if(C)$=C[5]/2,ne=a_($);else{e.fovy?(ne=e.fovy,$=j3(ne)):ne=a_($);let Se;if(W){const{top:_e=0,bottom:Re=0}=W;Se=[0,oc((_e+F-Re)/2,0,F)-F/2]}se=oG({width:N,height:F,scale:K,center:D&&[0,0,D[2]*Fb(n)],offset:Se,pitch:a,fovy:ne,nearZMultiplier:l,farZMultiplier:m}),Number.isFinite(_)&&(se.near=_),Number.isFinite(S)&&(se.far=S)}let xe=sG({height:F,pitch:a,bearing:h,scale:K,altitude:$});R&&(xe=new Fa().translate([512*R,0,0]).multiplyLeft(xe)),super({...e,width:N,height:F,viewMatrix:xe,longitude:r,latitude:n,zoom:i,...se,fovy:ne,focalDistance:$}),J(this,"longitude",void 0),J(this,"latitude",void 0),J(this,"pitch",void 0),J(this,"bearing",void 0),J(this,"altitude",void 0),J(this,"fovy",void 0),J(this,"orthographic",void 0),J(this,"_subViewports",void 0),J(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=a,this.bearing=h,this.altitude=$,this.fovy=ne,this.orthographic=P,this._subViewports=L?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const a=i?new Ld({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Fb(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Fb(r);return[n,r,i]}addMetersToLngLat(e,n){return B3(e,n)}panByPosition(e,n){const r=T2(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=Sw([],i,i8([],r)),h=Sw([],this.center,a),[l,m]=this.unprojectFlat(h);return{longitude:l,latitude:m}}getBounds(e={}){const n=cG(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:a,latitude:h,zoom:l}=aG({width:r,height:i,bounds:e,...n});return new Ld({width:r,height:i,longitude:a,latitude:h,zoom:l})}}J(Ld,"displayName","WebMercatorViewport");const BA=[0,0,0];function jb(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Ld){const[i,a,h=0]=t,l=e.getDistanceScales([i,a]);r[2]=h*l.unitsPerMeter[2]}return r}function zG(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:h}=t;return i===qn.DEFAULT&&(i=e.isGeospatial?qn.LNGLAT:qn.CARTESIAN),a===void 0&&(a=i),h===void 0&&(h=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:a,fromCoordinateOrigin:h}}function H3(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:a}){let[h,l,m=0]=t;switch(n&&([h,l,m]=$m([],[h,l,m,1],n)),r){case qn.LNGLAT:return jb([h,l,m],e,a);case qn.LNGLAT_OFFSETS:return jb([h+i[0],l+i[1],m+(i[2]||0)],e,a);case qn.METER_OFFSETS:return jb(B3(i,[h,l,m]),e,a);case qn.CARTESIAN:default:return e.isGeospatial?[h+i[0],l+i[1],m+i[2]]:e.projectPosition([h,l,m])}}function DG(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:h,fromCoordinateOrigin:l}=zG(e),{autoOffset:m=!0}=e,{geospatialOrigin:_=BA,shaderCoordinateOrigin:S=BA,offsetMode:P=!1}=m?D3(n,r,i):{},C=H3(t,{viewport:n,modelMatrix:a,coordinateSystem:h,coordinateOrigin:l,offsetMode:P});if(P){const L=n.projectPosition(_||S);x8(C,C,L)}return C}const jA={blendFunc:[1,0,32771,0],blendEquation:32774};class q3 extends b2{constructor(...e){super(...e),J(this,"pickZ",void 0),J(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,pickingFBO:h,deviceRect:{x:l,y:m,width:_,height:S},cullRect:P,effects:C,pass:L="picking",pickZ:R,moduleParameters:D}){const W=this.gl;this.pickZ=R;const z=this._resetColorEncoder(R),N=ua(W,{scissorTest:!0,scissor:[l,m,_,S],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...jA,blend:!R},()=>super.render({target:h,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,cullRect:P,effects:C==null?void 0:C.filter($=>$.useInPicking),pass:L,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:z&&NG.bind(null,z),stats:N}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:a,operation:h}=e.props;return this._colorEncoderState?a&&h.includes("draw")&&(Object.assign(i,jA),i.blend=!0,i.blendColor=FG(this._colorEncoderState,e,r)):i.blend=!1,h.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function FG(t,e,n){const{byLayer:r,byAlpha:i}=t;let a,h=r.get(e);return h?(h.viewports.push(n),a=h.a):(a=r.size+1,a<=255?(h={a,layer:e,viewports:[n]},r.set(e,h),i[a]=h):(hr.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function NG(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Bh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},l_=Symbol.for("component"),bc=Symbol.for("propTypes"),Vb=Symbol.for("deprecatedProps"),hd=Symbol.for("asyncPropDefaults"),ku=Symbol.for("asyncPropOriginal"),ac=Symbol.for("asyncPropResolved");function E2(t,e=()=>!0){return Array.isArray(t)?Z3(t,e,[]):e(t)?[t]:[]}function Z3(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Z3(i,e,n):e(i)&&n.push(i)}return n}function BG({target:t,source:e,start:n=0,count:r=1}){const i=e.length,a=r*i;let h=0;for(let l=n;h<i;h++)t[l++]=e[h];for(;h<a;)h<a-h?(t.copyWithin(n+h,n,n+h),h*=2):(t.copyWithin(n+h,n,n+a-h),h=a);return t}class jG{constructor(e,n,r){J(this,"id",void 0),J(this,"context",void 0),J(this,"isLoaded",void 0),J(this,"persistent",void 0),J(this,"_loadCount",0),J(this,"_subscribers",new Set),J(this,"_data",void 0),J(this,"_loader",void 0),J(this,"_error",void 0),J(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=hw(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class VG{constructor({gl:e,protocol:n}){J(this,"protocol",void 0),J(this,"_context",void 0),J(this,"_resources",void 0),J(this,"_consumers",void 0),J(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(n,r):(a=new jG(e,n,this._context),this._resources[e]=a),a.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:a,protocol:h}=this;e.startsWith(h)&&(e=e.replace(h,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const l=a[e];if(this._track(r,i,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const a=this._consumers,h=a[e]=a[e]||{},l=h[n]||{},m=l.resourceId&&this._resources[l.resourceId];m&&(m.unsubscribe(l),this.prune()),r&&(h[n]=l,l.onChange=i,l.resourceId=r.id,r.subscribe(l))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const UG=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,P2={name:"project32",dependencies:[w2],vs:UG},C2={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...Y8},$G=[w2],GG=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function WG(t){const e=Gm.getDefaultProgramManager(t);for(const n of $G)e.addDefaultModule(n);for(const n of GG)e.addShaderHook(n);return e}const HG="layerManager.setLayers",qG="layerManager.activateViewport";class ZG{constructor(e,{deck:n,stats:r,viewport:i,timeline:a}={}){J(this,"layers",void 0),J(this,"context",void 0),J(this,"resourceManager",void 0),J(this,"_lastRenderedLayers",[]),J(this,"_needsRedraw",!1),J(this,"_needsUpdate",!1),J(this,"_nextLayers",null),J(this,"_debug",!1),J(this,"activateViewport",h=>{ss(qG,this,h),h&&(this.context.viewport=h)}),this.layers=[],this.resourceManager=new VG({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&WG(e),stats:r||new n2({id:"deck.gl"}),viewport:i||new Hd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:a||new M3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(HG,this,n,e),this._lastRenderedLayers=e;const r=E2(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const h of e)r[h.id]?hr.warn("Multiple old layers with same id ".concat(h.id))():r[h.id]=h;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let a=!1;for(const h of i)if(h.hasUniformTransition()){a="Uniform transition in ".concat(h);break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const a=n[i.id];a===null&&hr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let h=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),h=i.isComposite?i.getSubLayers():null}catch(l){this._handleError("matching",l,i)}h&&this._updateSublayersRecursively(h,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Bh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Bh.MATCHED,n!==e&&(e.lifecycle=Bh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Bh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Bh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Ma(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Ma(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r)if(!e.hasOwnProperty(a)||!Ma(t[a],e[a],n-1))return!1;return!0}return!1}class XG{constructor(e){J(this,"width",void 0),J(this,"height",void 0),J(this,"views",void 0),J(this,"viewState",void 0),J(this,"controllers",void 0),J(this,"timeline",void 0),J(this,"_viewports",void 0),J(this,"_viewportMap",void 0),J(this,"_isUpdating",void 0),J(this,"_needsRedraw",void 0),J(this,"_needsUpdate",void 0),J(this,"_eventManager",void 0),J(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let a=r.length-1;a>=0;--a){const h=r[a];if(h.containsPixel(i)){const l=e.slice();return l[0]-=h.x,l[1]-=h.y,h.unproject(l,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=E2(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ma(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):hr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>{var h;return(h=this.getView(e.id))===null||h===void 0?void 0:h.makeViewport({viewState:a,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const a=e.controller;if(a&&r){const h={...n,...a,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,h)),i&&i.setProps(h),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const a=e[i],h=this.getViewState(a),l=a.makeViewport({viewState:h,width:this.width,height:this.height});let m=n[a.id];const _=!!a.controller;_&&!m&&(r=!0),(r||!_)&&m&&(m.finalize(),m=null),this.controllers[a.id]=this._updateController(a,h,l,m),l&&this._viewports.unshift(l)}for(const i in n){const a=n[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const YG=/([0-9]+\.?[0-9]*)(%|px)/;function Zl(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=YG.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Xl(t,e){return t.relative?Math.round(t.position*e):t.position}function Ci(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Rd{constructor(e){J(this,"id",void 0),J(this,"viewportInstance",void 0),J(this,"_x",void 0),J(this,"_y",void 0),J(this,"_width",void 0),J(this,"_height",void 0),J(this,"_padding",void 0),J(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:a="100%",height:h="100%",padding:l=null,viewportInstance:m}=e||{};Ci(!m||m instanceof Hd),this.viewportInstance=m,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Zl(r),this._y=Zl(i),this._width=Zl(a),this._height=Zl(h),this._padding=l&&{left:Zl(l.left||0),right:Zl(l.right||0),top:Zl(l.top||0),bottom:Zl(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ma(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Xl(this._x,e),y:Xl(this._y,n),width:Xl(this._width,e),height:Xl(this._height,n)};return this._padding&&(r.padding={left:Xl(this._padding.left,e),top:Xl(this._padding.top,n),right:Xl(this._padding.right,e),bottom:Xl(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Hm=class{constructor(e){J(this,"_inProgress",void 0),J(this,"_handle",void 0),J(this,"_timeline",void 0),J(this,"time",void 0),J(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const VA=()=>{},Iw={BREAK:1,SNAP_TO_END:2,IGNORE:3},KG=t=>t,JG=Iw.BREAK;class QG{constructor(e){J(this,"getControllerState",void 0),J(this,"props",void 0),J(this,"propsInTransition",void 0),J(this,"transition",void 0),J(this,"onViewStateChange",void 0),J(this,"onStateChange",void 0),J(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:a,endProps:h,duration:l,easing:m}}=n,_=m(r/l),S=i.interpolateProps(a,h,_);this.propsInTransition=this.getControllerState({...this.props,...S}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Hm(e.timeline),this.onViewStateChange=e.onViewStateChange||VA,this.onStateChange=e.onStateChange||VA}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:a,endProps:h}=this.transition.settings;i={...r,...a===Iw.SNAP_TO_END?h:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Iw.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),a=n.transitionInterpolator,h=a.getDuration?a.getDuration(e,n):n.transitionDuration;if(h===0)return;const l=a.initializeProps(e,i);this.propsInTransition={};const m={duration:h,easing:n.transitionEasing||KG,interpolator:a,interruption:n.transitionInterruption||JG,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(m),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class X3{constructor(e){J(this,"_propsToCompare",void 0),J(this,"_propsToExtract",void 0),J(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!ym(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const a of this._propsToExtract)(a in e||a in n)&&(r[a]=e[a],i[a]=n[a]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ci(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const e7=["longitude","latitude","zoom","bearing","pitch"],t7=["longitude","latitude","zoom"];class Y3 extends X3{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:e7,required:t7},super(r.transitionProps),J(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:a}=this.opts;if(i&&a){const h=i(e),l=i(n),m=h.unproject(a);r.start.around=a,Object.assign(r.end,{around:l.project(m),aroundPosition:m,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const a of this._propsToExtract)i[a]=gm(e[a]||0,n[a]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...n,...i});Object.assign(i,a.panByPosition(n.aroundPosition,gm(e.around,n.around,r)))}return i}}const Yl={transitionDuration:0},n7=300,zy=t=>1-(1-t)*(1-t),Ah={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},tu={};class r7{constructor(e){J(this,"props",void 0),J(this,"state",{}),J(this,"transitionManager",void 0),J(this,"eventManager",void 0),J(this,"onViewStateChange",void 0),J(this,"onStateChange",void 0),J(this,"makeViewport",void 0),J(this,"_controllerState",void 0),J(this,"_events",{}),J(this,"_interactionState",{isDragging:!1}),J(this,"_customEvents",[]),J(this,"_eventStartBlocked",null),J(this,"_panMove",!1),J(this,"invertPan",!1),J(this,"dragMode","rotate"),J(this,"inertia",0),J(this,"scrollZoom",!0),J(this,"dragPan",!0),J(this,"dragRotate",!0),J(this,"doubleClickZoom",!0),J(this,"touchZoom",!0),J(this,"touchRotate",!1),J(this,"keyboard",!0),this.transitionManager=new QG({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const a=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return a&&n&&n.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?n7:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:h=!0,touchZoom:l=!0,touchRotate:m=!1,keyboard:_=!0}=e,S=!!this.onViewStateChange;this.toggleEvents(Ah.WHEEL,S&&r),this.toggleEvents(Ah.PAN,S),this.toggleEvents(Ah.PINCH,S&&(l||m)),this.toggleEvents(Ah.TRIPLE_PAN,S&&m),this.toggleEvents(Ah.DOUBLE_TAP,S&&h),this.toggleEvents(Ah.KEYBOARD,S&&_),this.scrollZoom=r,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=h,this.touchZoom=l,this.touchRotate=m,this.keyboard=_}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),a){const h=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:h})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Yl,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zy},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zy},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let h=2/(1+Math.exp(-Math.abs(a*r)));a<0&&h!==0&&(h=1/h);const l=this.controllerState.zoom({pos:n,scale:h});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Yl,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zy},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return tu._startPinchRotation=e.rotation,tu._lastPinchEvent=e,this.updateViewport(r,Yl,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:tu._startPinchRotation-r})}return this.updateViewport(n,Yl,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),tu._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=tu;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const h=Math.log2(e.scale),l=(h-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),m=Math.pow(2,h+l*n/2);a=a.zoom({pos:i,scale:m}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:zy},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return tu._startPinchRotation=null,tu._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:h}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let m;const _={};switch(e.srcEvent.code){case"Minus":m=n?l.zoomOut(r).zoomOut(r):l.zoomOut(r),_.isZooming=!0;break;case"Equal":m=n?l.zoomIn(r).zoomIn(r):l.zoomIn(r),_.isZooming=!0;break;case"ArrowLeft":n?(m=l.rotateLeft(a),_.isRotating=!0):(m=l.moveLeft(i),_.isPanning=!0);break;case"ArrowRight":n?(m=l.rotateRight(a),_.isRotating=!0):(m=l.moveRight(i),_.isPanning=!0);break;case"ArrowUp":n?(m=l.rotateUp(h),_.isRotating=!0):(m=l.moveUp(i),_.isPanning=!0);break;case"ArrowDown":n?(m=l.rotateDown(h),_.isRotating=!0):(m=l.moveDown(i),_.isPanning=!0);break;default:return!1}return this.updateViewport(m,this._getTransitionProps(),_),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Yl:e?{...n,transitionInterpolator:new Y3({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class i7{constructor(e,n){J(this,"_viewportProps",void 0),J(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const UA=5,s7=1.2;class o7 extends i7{constructor(e){const{width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l=0,pitch:m=0,altitude:_=1.5,position:S=[0,0,0],maxZoom:P=20,minZoom:C=0,maxPitch:L=60,minPitch:R=0,startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$,normalize:K=!0}=e;Ci(Number.isFinite(a)),Ci(Number.isFinite(i)),Ci(Number.isFinite(h)),super({width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l,pitch:m,altitude:_,maxZoom:P,minZoom:C,maxPitch:L,minPitch:R,normalize:K,position:S},{startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$}),J(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:a,startPitch:h}=this.getState();if(!i||a===void 0||h===void 0)return this;let l;return e?l=this._getNewRotation(e,i,h,a):l={bearing:a+n,pitch:h+r},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:h,minZoom:l}=this.getViewportProps();let m=i+Math.log2(r);m=oc(m,l,h);const _=this.makeViewport({...this.getViewportProps(),zoom:m});return this._getUpdatedState({zoom:m,..._.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:a}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(a-n.longitude)>180&&(r.longitude=a<0?a+360:a-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=oc(i,r,n);const{maxPitch:a,minPitch:h,pitch:l}=e;e.pitch=oc(l,h,a);const{normalize:m=!0}=e;return m&&Object.assign(e,uG(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const a=e[0]-n[0],h=e[1]-n[1],l=e[1],m=n[1],{width:_,height:S}=this.getViewportProps(),P=a/_;let C=0;h>0?Math.abs(S-m)>UA&&(C=h/(m-S)*s7):h<0&&m>UA&&(C=1-l/m),C=oc(C,-1,1);const{minPitch:L,maxPitch:R}=this.getViewportProps(),D=i+180*P;let W=r;return C>0?W=r+C*(R-r):C<0&&(W=r-C*(L-r)),{pitch:W,bearing:D}}}class a7 extends r7{constructor(...e){super(...e),J(this,"ControllerState",o7),J(this,"transition",{transitionDuration:300,transitionInterpolator:new Y3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),J(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class K3 extends Rd{get ViewportType(){return Ld}get ControllerType(){return a7}}J(K3,"displayName","MapView");const l7=new W3;function c7(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,a=(r=e.order)!==null&&r!==void 0?r:1/0;return i-a}class u7{constructor(){J(this,"effects",void 0),J(this,"_resolvedEffects",[]),J(this,"_defaultEffects",[]),J(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>c7(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ma(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const a=n[i.id];a&&a!==i?a.setProps?(a.setProps(i.props),r.push(a)):(a.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof W3)||this._resolvedEffects.push(l7),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class h7 extends b2{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const d7="deckRenderer.renderLayers";class f7{constructor(e){J(this,"gl",void 0),J(this,"layerFilter",void 0),J(this,"drawPickingColors",void 0),J(this,"drawLayersPass",void 0),J(this,"pickLayersPass",void 0),J(this,"renderCount",void 0),J(this,"_needsRedraw",void 0),J(this,"renderBuffers",void 0),J(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new h7(e),this.pickLayersPass=new q3(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||xi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,a=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,ss(d7,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new xi(this.gl),new xi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const a of e)if(a.postRender){if(a.id===this.lastPostProcessEffect){i.target=n.target,a.postRender(this.gl,i);break}const h=a.postRender(this.gl,i);i.inputBuffer=h,i.swapBuffer=h===r[0]?r[1]:r[0]}}}const p7={pickedColor:null,pickedObjectIndex:-1};function m7({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:a}){const{x:h,y:l,width:m,height:_}=a;let S=i*i,P=-1,C=0;for(let L=0;L<_;L++){const R=L+l-r,D=R*R;if(D>S)C+=4*m;else for(let W=0;W<m;W++){if(t[C+3]-1>=0){const N=W+h-n,F=N*N+D;F<=S&&(S=F,P=C)}C+=4}}if(P>=0){const L=t.slice(P,P+4),R=e(L);if(R){const D=Math.floor(P/4/m),W=P/4-D*m;return{...R,pickedColor:L,pickedX:h+W,pickedY:l+D}}hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return p7}function g7({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const a=t.slice(r,r+4),h=a.join(",");if(!n.has(h)){const l=e(a);l?n.set(h,{...l,color:a}):hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function J3({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:a}){let h=e[0];e.length>1&&(h=_7((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let l;if(h){const m=[r-h.x,i-h.y];a!==void 0&&(m[2]=a),l=h.unproject(m)}return{color:null,layer:null,viewport:h,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:l,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function y7(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:a,pickedLayer:h,pickedObjectIndex:l}=e,m=h?[h]:[];if(r==="hover"){const P=n.index,C=n.layerId,L=h?h.props.id:null;if(L!==C||l!==P){if(L!==C){const R=i.find(D=>D.props.id===C);R&&m.unshift(R)}n.layerId=L,n.index=l,n.info=null}}const _=J3(t),S=new Map;return S.set(null,_),m.forEach(P=>{let C={..._};P===h&&(C.color=a,C.index=l,C.picked=!0),C=Q3({layer:P,info:C,mode:r});const L=C.layer;P===h&&r==="hover"&&(n.info=C),S.set(L.id,C),r==="hover"&&L.updateAutoHighlight(C)}),S}function Q3({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function _7(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class v7{constructor(e){J(this,"gl",void 0),J(this,"pickingFBO",void 0),J(this,"depthFBO",void 0),J(this,"pickLayersPass",void 0),J(this,"layerFilter",void 0),J(this,"lastPickedInfo",void 0),J(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new q3(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},a=this.lastPickedInfo.info){const h=a&&a.layer&&a.layer.id,l=a&&a.viewport&&a.viewport.id,m=h?r.find(C=>C.id===h):null,_=l&&i.find(C=>C.id===l)||i[0],S=_&&_.unproject([e-_.x,n-_.y]);return{...a,...{x:e,y:n,viewport:_,coordinate:S,layer:m}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new xi(r),xi.isSupported(r,{colorBufferFloat:!0}))){const i=new xi(r);i.attach({36064:new da(r,{format:Vn(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:a,radius:h=0,depth:l=1,mode:m="query",unproject3D:_,onViewportActive:S,effects:P}){const C=this._getPickable(e),L=Sd(this.gl);if(!C)return{result:[],emptyInfo:J3({viewports:r,x:i,y:a,pixelRatio:L})};this._resizeBuffer();const R=Sb(this.gl,[i,a],!0),D=[R.x+Math.floor(R.width/2),R.y+Math.floor(R.height/2)],W=Math.round(h*L),{width:z,height:N}=this.pickingFBO,F=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceWidth:z,deviceHeight:N}),$={x:i-h,y:a-h,width:h*2+1,height:h*2+1};let K;const ne=[],se=new Set;for(let xe=0;xe<l;xe++){let Se;if(F){const Re=this._drawAndSample({layers:C,views:n,viewports:r,onViewportActive:S,deviceRect:F,cullRect:$,effects:P,pass:"picking:".concat(m)});Se=m7({...Re,deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceRect:F})}else Se={pickedColor:null,pickedObjectIndex:-1};let _e;if(Se.pickedLayer&&_&&this.depthFBO){const{pickedColors:Re}=this._drawAndSample({layers:[Se.pickedLayer],views:n,viewports:r,onViewportActive:S,deviceRect:{x:Se.pickedX,y:Se.pickedY,width:1,height:1},cullRect:$,effects:P,pass:"picking:".concat(m,":z")},!0);Re[3]&&(_e=Re[0])}Se.pickedLayer&&xe+1<l&&(se.add(Se.pickedLayer),Se.pickedLayer.disablePickingIndex(Se.pickedObjectIndex)),K=y7({pickInfo:Se,lastPickedInfo:this.lastPickedInfo,mode:m,layers:C,viewports:r,x:i,y:a,z:_e,pixelRatio:L});for(const Re of K.values())Re.layer&&ne.push(Re);if(!Se.pickedColor)break}for(const xe of se)xe.restorePickingColors();return{result:ne,emptyInfo:K.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:a,width:h=1,height:l=1,mode:m="query",maxObjects:_=null,onViewportActive:S,effects:P}){const C=this._getPickable(e);if(!C)return[];this._resizeBuffer();const L=Sd(this.gl),R=Sb(this.gl,[i,a],!0),D=R.x,W=R.y+R.height,z=Sb(this.gl,[i+h,a+l],!0),N=z.x+z.width,F=z.y,$={x:D,y:F,width:N-D,height:W-F},K=this._drawAndSample({layers:C,views:n,viewports:r,onViewportActive:S,deviceRect:$,cullRect:{x:i,y:a,width:h,height:l},effects:P,pass:"picking:".concat(m)}),ne=g7(K),se=new Map,xe=Number.isFinite(_);for(let _e=0;_e<ne.length;_e++){var Se;if(xe&&_&&se.size>=_)break;const Re=ne[_e];let De={color:Re.pickedColor,layer:null,index:Re.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:L};De=Q3({layer:Re.pickedLayer,info:De,mode:m});const Ve=(Se=De.object)!==null&&Se!==void 0?Se:"".concat(De.layer.id,"[").concat(De.index,"]");se.has(Ve)||se.set(Ve,De)}return Array.from(se.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:a,cullRect:h,effects:l,pass:m},_=!1){const S=_?this.depthFBO:this.pickingFBO,P={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:S,deviceRect:a,cullRect:h,effects:l,pass:m,pickZ:_,preRenderStats:{}};for(const N of l)N.useInPicking&&(P.preRenderStats[N.id]=N.preRender(this.gl,P));const{decodePickingColor:C}=this.pickLayersPass.render(P),{x:L,y:R,width:D,height:W}=a,z=new(_?Float32Array:Uint8Array)(D*W*4);return U_(S,{sourceX:L,sourceY:R,sourceWidth:D,sourceHeight:W,target:z}),{pickedColors:z,decodePickingColor:C}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:a}){const h=Math.max(0,e-r),l=Math.max(0,n-r),m=Math.min(i,e+r+1)-h,_=Math.min(a,n+r+1)-l;return m<=0||_<=0?null:{x:h,y:l,width:m,height:_}}}const x7={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let b7=class{constructor(e){J(this,"el",null),J(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,x7),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var eO={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var a=["","webkit","Moz","MS","ms","o"],h=n.createElement("div"),l="function",m=Math.round,_=Math.abs,S=Date.now;function P(ee,oe,we){return setTimeout(F(ee,we),oe)}function C(ee,oe,we){return Array.isArray(ee)?(L(ee,we[oe],we),!0):!1}function L(ee,oe,we){var Ne;if(ee)if(ee.forEach)ee.forEach(oe,we);else if(ee.length!==i)for(Ne=0;Ne<ee.length;)oe.call(we,ee[Ne],Ne,ee),Ne++;else for(Ne in ee)ee.hasOwnProperty(Ne)&&oe.call(we,ee[Ne],Ne,ee)}function R(ee,oe,we){var Ne="DEPRECATED METHOD: "+oe+`
`+we+` AT 
`;return function(){var at=new Error("get-stack-trace"),zt=at&&at.stack?at.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Tn=e.console&&(e.console.warn||e.console.log);return Tn&&Tn.call(e.console,Ne,zt),ee.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(oe){if(oe===i||oe===null)throw new TypeError("Cannot convert undefined or null to object");for(var we=Object(oe),Ne=1;Ne<arguments.length;Ne++){var at=arguments[Ne];if(at!==i&&at!==null)for(var zt in at)at.hasOwnProperty(zt)&&(we[zt]=at[zt])}return we}:D=Object.assign;var W=R(function(oe,we,Ne){for(var at=Object.keys(we),zt=0;zt<at.length;)(!Ne||Ne&&oe[at[zt]]===i)&&(oe[at[zt]]=we[at[zt]]),zt++;return oe},"extend","Use `assign`."),z=R(function(oe,we){return W(oe,we,!0)},"merge","Use `assign`.");function N(ee,oe,we){var Ne=oe.prototype,at;at=ee.prototype=Object.create(Ne),at.constructor=ee,at._super=Ne,we&&D(at,we)}function F(ee,oe){return function(){return ee.apply(oe,arguments)}}function $(ee,oe){return typeof ee==l?ee.apply(oe&&oe[0]||i,oe):ee}function K(ee,oe){return ee===i?oe:ee}function ne(ee,oe,we){L(_e(oe),function(Ne){ee.addEventListener(Ne,we,!1)})}function se(ee,oe,we){L(_e(oe),function(Ne){ee.removeEventListener(Ne,we,!1)})}function xe(ee,oe){for(;ee;){if(ee==oe)return!0;ee=ee.parentNode}return!1}function Se(ee,oe){return ee.indexOf(oe)>-1}function _e(ee){return ee.trim().split(/\s+/g)}function Re(ee,oe,we){if(ee.indexOf&&!we)return ee.indexOf(oe);for(var Ne=0;Ne<ee.length;){if(we&&ee[Ne][we]==oe||!we&&ee[Ne]===oe)return Ne;Ne++}return-1}function De(ee){return Array.prototype.slice.call(ee,0)}function Ve(ee,oe,we){for(var Ne=[],at=[],zt=0;zt<ee.length;){var Tn=oe?ee[zt][oe]:ee[zt];Re(at,Tn)<0&&Ne.push(ee[zt]),at[zt]=Tn,zt++}return we&&(oe?Ne=Ne.sort(function(Ur,fi){return Ur[oe]>fi[oe]}):Ne=Ne.sort()),Ne}function je(ee,oe){for(var we,Ne,at=oe[0].toUpperCase()+oe.slice(1),zt=0;zt<a.length;){if(we=a[zt],Ne=we?we+at:oe,Ne in ee)return Ne;zt++}return i}var We=1;function Ze(){return We++}function Ye(ee){var oe=ee.ownerDocument||ee;return oe.defaultView||oe.parentWindow||e}var Ce=/mobile|tablet|ip(ad|hone|od)|android/i,Xe="ontouchstart"in e,lt=je(e,"PointerEvent")!==i,Dt=Xe&&Ce.test(navigator.userAgent),mt="touch",ht="pen",ot="mouse",xt="kinect",bt=25,Wt=1,nt=2,Et=4,cn=8,en=1,mn=2,Ht=4,It=8,Rt=16,yn=mn|Ht,vn=It|Rt,ut=yn|vn,un=["x","y"],Ae=["clientX","clientY"];function Ct(ee,oe){var we=this;this.manager=ee,this.callback=oe,this.element=ee.element,this.target=ee.options.inputTarget,this.domHandler=function(Ne){$(ee.options.enable,[ee])&&we.handler(Ne)},this.init()}Ct.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(Ye(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&se(this.element,this.evEl,this.domHandler),this.evTarget&&se(this.target,this.evTarget,this.domHandler),this.evWin&&se(Ye(this.element),this.evWin,this.domHandler)}};function bn(ee){var oe,we=ee.options.inputClass;return we?oe=we:lt?oe=Vr:Dt?oe=be:Xe?oe=Ge:oe=tn,new oe(ee,Yt)}function Yt(ee,oe,we){var Ne=we.pointers.length,at=we.changedPointers.length,zt=oe&Wt&&Ne-at===0,Tn=oe&(Et|cn)&&Ne-at===0;we.isFirst=!!zt,we.isFinal=!!Tn,zt&&(ee.session={}),we.eventType=oe,kt(ee,we),ee.emit("hammer.input",we),ee.recognize(we),ee.session.prevInput=we}function kt(ee,oe){var we=ee.session,Ne=oe.pointers,at=Ne.length;we.firstInput||(we.firstInput=zn(oe)),at>1&&!we.firstMultiple?we.firstMultiple=zn(oe):at===1&&(we.firstMultiple=!1);var zt=we.firstInput,Tn=we.firstMultiple,Cr=Tn?Tn.center:zt.center,Ur=oe.center=Qe(Ne);oe.timeStamp=S(),oe.deltaTime=oe.timeStamp-zt.timeStamp,oe.angle=$e(Cr,Ur),oe.distance=hn(Cr,Ur),Ln(we,oe),oe.offsetDirection=vt(oe.deltaX,oe.deltaY);var fi=qe(oe.deltaTime,oe.deltaX,oe.deltaY);oe.overallVelocityX=fi.x,oe.overallVelocityY=fi.y,oe.overallVelocity=_(fi.x)>_(fi.y)?fi.x:fi.y,oe.scale=Tn?qt(Tn.pointers,Ne):1,oe.rotation=Tn?st(Tn.pointers,Ne):0,oe.maxPointers=we.prevInput?oe.pointers.length>we.prevInput.maxPointers?oe.pointers.length:we.prevInput.maxPointers:oe.pointers.length,Un(we,oe);var us=ee.element;xe(oe.srcEvent.target,us)&&(us=oe.srcEvent.target),oe.target=us}function Ln(ee,oe){var we=oe.center,Ne=ee.offsetDelta||{},at=ee.prevDelta||{},zt=ee.prevInput||{};(oe.eventType===Wt||zt.eventType===Et)&&(at=ee.prevDelta={x:zt.deltaX||0,y:zt.deltaY||0},Ne=ee.offsetDelta={x:we.x,y:we.y}),oe.deltaX=at.x+(we.x-Ne.x),oe.deltaY=at.y+(we.y-Ne.y)}function Un(ee,oe){var we=ee.lastInterval||oe,Ne=oe.timeStamp-we.timeStamp,at,zt,Tn,Cr;if(oe.eventType!=cn&&(Ne>bt||we.velocity===i)){var Ur=oe.deltaX-we.deltaX,fi=oe.deltaY-we.deltaY,us=qe(Ne,Ur,fi);zt=us.x,Tn=us.y,at=_(us.x)>_(us.y)?us.x:us.y,Cr=vt(Ur,fi),ee.lastInterval=oe}else at=we.velocity,zt=we.velocityX,Tn=we.velocityY,Cr=we.direction;oe.velocity=at,oe.velocityX=zt,oe.velocityY=Tn,oe.direction=Cr}function zn(ee){for(var oe=[],we=0;we<ee.pointers.length;)oe[we]={clientX:m(ee.pointers[we].clientX),clientY:m(ee.pointers[we].clientY)},we++;return{timeStamp:S(),pointers:oe,center:Qe(oe),deltaX:ee.deltaX,deltaY:ee.deltaY}}function Qe(ee){var oe=ee.length;if(oe===1)return{x:m(ee[0].clientX),y:m(ee[0].clientY)};for(var we=0,Ne=0,at=0;at<oe;)we+=ee[at].clientX,Ne+=ee[at].clientY,at++;return{x:m(we/oe),y:m(Ne/oe)}}function qe(ee,oe,we){return{x:oe/ee||0,y:we/ee||0}}function vt(ee,oe){return ee===oe?en:_(ee)>=_(oe)?ee<0?mn:Ht:oe<0?It:Rt}function hn(ee,oe,we){we||(we=un);var Ne=oe[we[0]]-ee[we[0]],at=oe[we[1]]-ee[we[1]];return Math.sqrt(Ne*Ne+at*at)}function $e(ee,oe,we){we||(we=un);var Ne=oe[we[0]]-ee[we[0]],at=oe[we[1]]-ee[we[1]];return Math.atan2(at,Ne)*180/Math.PI}function st(ee,oe){return $e(oe[1],oe[0],Ae)+$e(ee[1],ee[0],Ae)}function qt(ee,oe){return hn(oe[0],oe[1],Ae)/hn(ee[0],ee[1],Ae)}var wn={mousedown:Wt,mousemove:nt,mouseup:Et},pn="mousedown",tt="mousemove mouseup";function tn(){this.evEl=pn,this.evWin=tt,this.pressed=!1,Ct.apply(this,arguments)}N(tn,Ct,{handler:function(oe){var we=wn[oe.type];we&Wt&&oe.button===0&&(this.pressed=!0),we&nt&&oe.which!==1&&(we=Et),this.pressed&&(we&Et&&(this.pressed=!1),this.callback(this.manager,we,{pointers:[oe],changedPointers:[oe],pointerType:ot,srcEvent:oe}))}});var on={pointerdown:Wt,pointermove:nt,pointerup:Et,pointercancel:cn,pointerout:cn},Pr={2:mt,3:ht,4:ot,5:xt},ci="pointerdown",an="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(ci="MSPointerDown",an="MSPointerMove MSPointerUp MSPointerCancel");function Vr(){this.evEl=ci,this.evWin=an,Ct.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(Vr,Ct,{handler:function(oe){var we=this.store,Ne=!1,at=oe.type.toLowerCase().replace("ms",""),zt=on[at],Tn=Pr[oe.pointerType]||oe.pointerType,Cr=Tn==mt,Ur=Re(we,oe.pointerId,"pointerId");zt&Wt&&(oe.button===0||Cr)?Ur<0&&(we.push(oe),Ur=we.length-1):zt&(Et|cn)&&(Ne=!0),!(Ur<0)&&(we[Ur]=oe,this.callback(this.manager,zt,{pointers:we,changedPointers:[oe],pointerType:Tn,srcEvent:oe}),Ne&&we.splice(Ur,1))}});var he={touchstart:Wt,touchmove:nt,touchend:Et,touchcancel:cn},G="touchstart",Z="touchstart touchmove touchend touchcancel";function ie(){this.evTarget=G,this.evWin=Z,this.started=!1,Ct.apply(this,arguments)}N(ie,Ct,{handler:function(oe){var we=he[oe.type];if(we===Wt&&(this.started=!0),!!this.started){var Ne=de.call(this,oe,we);we&(Et|cn)&&Ne[0].length-Ne[1].length===0&&(this.started=!1),this.callback(this.manager,we,{pointers:Ne[0],changedPointers:Ne[1],pointerType:mt,srcEvent:oe})}}});function de(ee,oe){var we=De(ee.touches),Ne=De(ee.changedTouches);return oe&(Et|cn)&&(we=Ve(we.concat(Ne),"identifier",!0)),[we,Ne]}var pe={touchstart:Wt,touchmove:nt,touchend:Et,touchcancel:cn},Me="touchstart touchmove touchend touchcancel";function be(){this.evTarget=Me,this.targetIds={},Ct.apply(this,arguments)}N(be,Ct,{handler:function(oe){var we=pe[oe.type],Ne=ye.call(this,oe,we);Ne&&this.callback(this.manager,we,{pointers:Ne[0],changedPointers:Ne[1],pointerType:mt,srcEvent:oe})}});function ye(ee,oe){var we=De(ee.touches),Ne=this.targetIds;if(oe&(Wt|nt)&&we.length===1)return Ne[we[0].identifier]=!0,[we,we];var at,zt,Tn=De(ee.changedTouches),Cr=[],Ur=this.target;if(zt=we.filter(function(fi){return xe(fi.target,Ur)}),oe===Wt)for(at=0;at<zt.length;)Ne[zt[at].identifier]=!0,at++;for(at=0;at<Tn.length;)Ne[Tn[at].identifier]&&Cr.push(Tn[at]),oe&(Et|cn)&&delete Ne[Tn[at].identifier],at++;if(Cr.length)return[Ve(zt.concat(Cr),"identifier",!0),Cr]}var Ee=2500,Ue=25;function Ge(){Ct.apply(this,arguments);var ee=F(this.handler,this);this.touch=new be(this.manager,ee),this.mouse=new tn(this.manager,ee),this.primaryTouch=null,this.lastTouches=[]}N(Ge,Ct,{handler:function(oe,we,Ne){var at=Ne.pointerType==mt,zt=Ne.pointerType==ot;if(!(zt&&Ne.sourceCapabilities&&Ne.sourceCapabilities.firesTouchEvents)){if(at)He.call(this,we,Ne);else if(zt&&Kt.call(this,Ne))return;this.callback(oe,we,Ne)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function He(ee,oe){ee&Wt?(this.primaryTouch=oe.changedPointers[0].identifier,Ot.call(this,oe)):ee&(Et|cn)&&Ot.call(this,oe)}function Ot(ee){var oe=ee.changedPointers[0];if(oe.identifier===this.primaryTouch){var we={x:oe.clientX,y:oe.clientY};this.lastTouches.push(we);var Ne=this.lastTouches,at=function(){var zt=Ne.indexOf(we);zt>-1&&Ne.splice(zt,1)};setTimeout(at,Ee)}}function Kt(ee){for(var oe=ee.srcEvent.clientX,we=ee.srcEvent.clientY,Ne=0;Ne<this.lastTouches.length;Ne++){var at=this.lastTouches[Ne],zt=Math.abs(oe-at.x),Tn=Math.abs(we-at.y);if(zt<=Ue&&Tn<=Ue)return!0}return!1}var Pt=je(h.style,"touchAction"),Bt=Pt!==i,At="compute",dn="auto",kn="manipulation",gn="none",fn="pan-x",nn="pan-y",_n=$i();function pr(ee,oe){this.manager=ee,this.set(oe)}pr.prototype={set:function(ee){ee==At&&(ee=this.compute()),Bt&&this.manager.element.style&&_n[ee]&&(this.manager.element.style[Pt]=ee),this.actions=ee.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ee=[];return L(this.manager.recognizers,function(oe){$(oe.options.enable,[oe])&&(ee=ee.concat(oe.getTouchAction()))}),Yr(ee.join(" "))},preventDefaults:function(ee){var oe=ee.srcEvent,we=ee.offsetDirection;if(this.manager.session.prevented){oe.preventDefault();return}var Ne=this.actions,at=Se(Ne,gn)&&!_n[gn],zt=Se(Ne,nn)&&!_n[nn],Tn=Se(Ne,fn)&&!_n[fn];if(at){var Cr=ee.pointers.length===1,Ur=ee.distance<2,fi=ee.deltaTime<250;if(Cr&&Ur&&fi)return}if(!(Tn&&zt)&&(at||zt&&we&yn||Tn&&we&vn))return this.preventSrc(oe)},preventSrc:function(ee){this.manager.session.prevented=!0,ee.preventDefault()}};function Yr(ee){if(Se(ee,gn))return gn;var oe=Se(ee,fn),we=Se(ee,nn);return oe&&we?gn:oe||we?oe?fn:nn:Se(ee,kn)?kn:dn}function $i(){if(!Bt)return!1;var ee={},oe=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(we){ee[we]=oe?e.CSS.supports("touch-action",we):!0}),ee}var Ba=1,Kr=2,cs=4,po=8,Pn=po,$o=16,ki=32;function ir(ee){this.options=D({},this.defaults,ee||{}),this.id=Ze(),this.manager=null,this.options.enable=K(this.options.enable,!0),this.state=Ba,this.simultaneous={},this.requireFail=[]}ir.prototype={defaults:{},set:function(ee){return D(this.options,ee),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ee){if(C(ee,"recognizeWith",this))return this;var oe=this.simultaneous;return ee=di(ee,this),oe[ee.id]||(oe[ee.id]=ee,ee.recognizeWith(this)),this},dropRecognizeWith:function(ee){return C(ee,"dropRecognizeWith",this)?this:(ee=di(ee,this),delete this.simultaneous[ee.id],this)},requireFailure:function(ee){if(C(ee,"requireFailure",this))return this;var oe=this.requireFail;return ee=di(ee,this),Re(oe,ee)===-1&&(oe.push(ee),ee.requireFailure(this)),this},dropRequireFailure:function(ee){if(C(ee,"dropRequireFailure",this))return this;ee=di(ee,this);var oe=Re(this.requireFail,ee);return oe>-1&&this.requireFail.splice(oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ee){return!!this.simultaneous[ee.id]},emit:function(ee){var oe=this,we=this.state;function Ne(at){oe.manager.emit(at,ee)}we<po&&Ne(oe.options.event+bi(we)),Ne(oe.options.event),ee.additionalEvent&&Ne(ee.additionalEvent),we>=po&&Ne(oe.options.event+bi(we))},tryEmit:function(ee){if(this.canEmit())return this.emit(ee);this.state=ki},canEmit:function(){for(var ee=0;ee<this.requireFail.length;){if(!(this.requireFail[ee].state&(ki|Ba)))return!1;ee++}return!0},recognize:function(ee){var oe=D({},ee);if(!$(this.options.enable,[this,oe])){this.reset(),this.state=ki;return}this.state&(Pn|$o|ki)&&(this.state=Ba),this.state=this.process(oe),this.state&(Kr|cs|po|$o)&&this.tryEmit(oe)},process:function(ee){},getTouchAction:function(){},reset:function(){}};function bi(ee){return ee&$o?"cancel":ee&po?"end":ee&cs?"move":ee&Kr?"start":""}function Vu(ee){return ee==Rt?"down":ee==It?"up":ee==mn?"left":ee==Ht?"right":""}function di(ee,oe){var we=oe.manager;return we?we.get(ee):ee}function Zn(){ir.apply(this,arguments)}N(Zn,ir,{defaults:{pointers:1},attrTest:function(ee){var oe=this.options.pointers;return oe===0||ee.pointers.length===oe},process:function(ee){var oe=this.state,we=ee.eventType,Ne=oe&(Kr|cs),at=this.attrTest(ee);return Ne&&(we&cn||!at)?oe|$o:Ne||at?we&Et?oe|po:oe&Kr?oe|cs:Kr:ki}});function Go(){Zn.apply(this,arguments),this.pX=null,this.pY=null}N(Go,Zn,{defaults:{event:"pan",threshold:10,pointers:1,direction:ut},getTouchAction:function(){var ee=this.options.direction,oe=[];return ee&yn&&oe.push(nn),ee&vn&&oe.push(fn),oe},directionTest:function(ee){var oe=this.options,we=!0,Ne=ee.distance,at=ee.direction,zt=ee.deltaX,Tn=ee.deltaY;return at&oe.direction||(oe.direction&yn?(at=zt===0?en:zt<0?mn:Ht,we=zt!=this.pX,Ne=Math.abs(ee.deltaX)):(at=Tn===0?en:Tn<0?It:Rt,we=Tn!=this.pY,Ne=Math.abs(ee.deltaY))),ee.direction=at,we&&Ne>oe.threshold&&at&oe.direction},attrTest:function(ee){return Zn.prototype.attrTest.call(this,ee)&&(this.state&Kr||!(this.state&Kr)&&this.directionTest(ee))},emit:function(ee){this.pX=ee.deltaX,this.pY=ee.deltaY;var oe=Vu(ee.direction);oe&&(ee.additionalEvent=this.options.event+oe),this._super.emit.call(this,ee)}});function mo(){Zn.apply(this,arguments)}N(mo,Zn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[gn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.scale-1)>this.options.threshold||this.state&Kr)},emit:function(ee){if(ee.scale!==1){var oe=ee.scale<1?"in":"out";ee.additionalEvent=this.options.event+oe}this._super.emit.call(this,ee)}});function Jn(){ir.apply(this,arguments),this._timer=null,this._input=null}N(Jn,ir,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dn]},process:function(ee){var oe=this.options,we=ee.pointers.length===oe.pointers,Ne=ee.distance<oe.threshold,at=ee.deltaTime>oe.time;if(this._input=ee,!Ne||!we||ee.eventType&(Et|cn)&&!at)this.reset();else if(ee.eventType&Wt)this.reset(),this._timer=P(function(){this.state=Pn,this.tryEmit()},oe.time,this);else if(ee.eventType&Et)return Pn;return ki},reset:function(){clearTimeout(this._timer)},emit:function(ee){this.state===Pn&&(ee&&ee.eventType&Et?this.manager.emit(this.options.event+"up",ee):(this._input.timeStamp=S(),this.manager.emit(this.options.event,this._input)))}});function Dn(){Zn.apply(this,arguments)}N(Dn,Zn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[gn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.rotation)>this.options.threshold||this.state&Kr)}});function Us(){Zn.apply(this,arguments)}N(Us,Zn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yn|vn,pointers:1},getTouchAction:function(){return Go.prototype.getTouchAction.call(this)},attrTest:function(ee){var oe=this.options.direction,we;return oe&(yn|vn)?we=ee.overallVelocity:oe&yn?we=ee.overallVelocityX:oe&vn&&(we=ee.overallVelocityY),this._super.attrTest.call(this,ee)&&oe&ee.offsetDirection&&ee.distance>this.options.threshold&&ee.maxPointers==this.options.pointers&&_(we)>this.options.velocity&&ee.eventType&Et},emit:function(ee){var oe=Vu(ee.offsetDirection);oe&&this.manager.emit(this.options.event+oe,ee),this.manager.emit(this.options.event,ee)}});function Qn(){ir.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(Qn,ir,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kn]},process:function(ee){var oe=this.options,we=ee.pointers.length===oe.pointers,Ne=ee.distance<oe.threshold,at=ee.deltaTime<oe.time;if(this.reset(),ee.eventType&Wt&&this.count===0)return this.failTimeout();if(Ne&&at&&we){if(ee.eventType!=Et)return this.failTimeout();var zt=this.pTime?ee.timeStamp-this.pTime<oe.interval:!0,Tn=!this.pCenter||hn(this.pCenter,ee.center)<oe.posThreshold;this.pTime=ee.timeStamp,this.pCenter=ee.center,!Tn||!zt?this.count=1:this.count+=1,this._input=ee;var Cr=this.count%oe.taps;if(Cr===0)return this.hasRequireFailures()?(this._timer=P(function(){this.state=Pn,this.tryEmit()},oe.interval,this),Kr):Pn}return ki},failTimeout:function(){return this._timer=P(function(){this.state=ki},this.options.interval,this),ki},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Pn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Gi(ee,oe){return oe=oe||{},oe.recognizers=K(oe.recognizers,Gi.defaults.preset),new Cs(ee,oe)}Gi.VERSION="2.0.7",Gi.defaults={domEvents:!1,touchAction:At,enable:!0,inputTarget:null,inputClass:null,preset:[[Dn,{enable:!1}],[mo,{enable:!1},["rotate"]],[Us,{direction:yn}],[Go,{direction:yn},["swipe"]],[Qn],[Qn,{event:"doubletap",taps:2},["tap"]],[Jn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Wi=1,Pl=2;function Cs(ee,oe){this.options=D({},Gi.defaults,oe||{}),this.options.inputTarget=this.options.inputTarget||ee,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ee,this.input=bn(this),this.touchAction=new pr(this,this.options.touchAction),Lc(this,!0),L(this.options.recognizers,function(we){var Ne=this.add(new we[0](we[1]));we[2]&&Ne.recognizeWith(we[2]),we[3]&&Ne.requireFailure(we[3])},this)}Cs.prototype={set:function(ee){return D(this.options,ee),ee.touchAction&&this.touchAction.update(),ee.inputTarget&&(this.input.destroy(),this.input.target=ee.inputTarget,this.input.init()),this},stop:function(ee){this.session.stopped=ee?Pl:Wi},recognize:function(ee){var oe=this.session;if(!oe.stopped){this.touchAction.preventDefaults(ee);var we,Ne=this.recognizers,at=oe.curRecognizer;(!at||at&&at.state&Pn)&&(at=oe.curRecognizer=null);for(var zt=0;zt<Ne.length;)we=Ne[zt],oe.stopped!==Pl&&(!at||we==at||we.canRecognizeWith(at))?we.recognize(ee):we.reset(),!at&&we.state&(Kr|cs|po)&&(at=oe.curRecognizer=we),zt++}},get:function(ee){if(ee instanceof ir)return ee;for(var oe=this.recognizers,we=0;we<oe.length;we++)if(oe[we].options.event==ee)return oe[we];return null},add:function(ee){if(C(ee,"add",this))return this;var oe=this.get(ee.options.event);return oe&&this.remove(oe),this.recognizers.push(ee),ee.manager=this,this.touchAction.update(),ee},remove:function(ee){if(C(ee,"remove",this))return this;if(ee=this.get(ee),ee){var oe=this.recognizers,we=Re(oe,ee);we!==-1&&(oe.splice(we,1),this.touchAction.update())}return this},on:function(ee,oe){if(ee!==i&&oe!==i){var we=this.handlers;return L(_e(ee),function(Ne){we[Ne]=we[Ne]||[],we[Ne].push(oe)}),this}},off:function(ee,oe){if(ee!==i){var we=this.handlers;return L(_e(ee),function(Ne){oe?we[Ne]&&we[Ne].splice(Re(we[Ne],oe),1):delete we[Ne]}),this}},emit:function(ee,oe){this.options.domEvents&&Rc(ee,oe);var we=this.handlers[ee]&&this.handlers[ee].slice();if(!(!we||!we.length)){oe.type=ee,oe.preventDefault=function(){oe.srcEvent.preventDefault()};for(var Ne=0;Ne<we.length;)we[Ne](oe),Ne++}},destroy:function(){this.element&&Lc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Lc(ee,oe){var we=ee.element;if(we.style){var Ne;L(ee.options.cssProps,function(at,zt){Ne=je(we.style,zt),oe?(ee.oldCssProps[Ne]=we.style[Ne],we.style[Ne]=at):we.style[Ne]=ee.oldCssProps[Ne]||""}),oe||(ee.oldCssProps={})}}function Rc(ee,oe){var we=n.createEvent("Event");we.initEvent(ee,!0,!0),we.gesture=oe,oe.target.dispatchEvent(we)}D(Gi,{INPUT_START:Wt,INPUT_MOVE:nt,INPUT_END:Et,INPUT_CANCEL:cn,STATE_POSSIBLE:Ba,STATE_BEGAN:Kr,STATE_CHANGED:cs,STATE_ENDED:po,STATE_RECOGNIZED:Pn,STATE_CANCELLED:$o,STATE_FAILED:ki,DIRECTION_NONE:en,DIRECTION_LEFT:mn,DIRECTION_RIGHT:Ht,DIRECTION_UP:It,DIRECTION_DOWN:Rt,DIRECTION_HORIZONTAL:yn,DIRECTION_VERTICAL:vn,DIRECTION_ALL:ut,Manager:Cs,Input:Ct,TouchAction:pr,TouchInput:be,MouseInput:tn,PointerEventInput:Vr,TouchMouseInput:Ge,SingleTouchInput:ie,Recognizer:ir,AttrRecognizer:Zn,Tap:Qn,Pan:Go,Swipe:Us,Pinch:mo,Rotate:Dn,Press:Jn,on:ne,off:se,each:L,merge:z,extend:W,assign:D,inherit:N,bindFn:F,prefixed:je});var Cl=typeof e<"u"?e:typeof self<"u"?self:{};Cl.Hammer=Gi,typeof i=="function"&&i.amd?i(function(){return Gi}):t.exports?t.exports=Gi:e[r]=Gi})(window,document,"Hammer")})(eO);var qm=eO.exports;const w7=Mm(qm),Sa=mM({__proto__:null,default:w7},[qm]),tO=1,nO=2,kw=4,S7={mousedown:tO,mousemove:nO,mouseup:kw};function T7(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function E7(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(T7(i,a=>a.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function P7(t){t.prototype.handler=function(n){let r=S7[n.type];r&tO&&n.button>=0&&(this.pressed=!0),r&nO&&n.buttons===0&&(r=kw),this.pressed&&(r&kw&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}E7(qm.PointerEventInput);P7(qm.MouseInput);const C7=qm.Manager;let $_=class{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}};const A7=Sa?[[Sa.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Sa.Rotate,{enable:!1}],[Sa.Pinch,{enable:!1}],[Sa.Swipe,{enable:!1}],[Sa.Pan,{threshold:0,enable:!1}],[Sa.Press,{enable:!1}],[Sa.Tap,{event:"doubletap",taps:2,enable:!1}],[Sa.Tap,{event:"anytap",enable:!1}],[Sa.Tap,{enable:!1}]]:null,$A={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},I7={doubletap:["tap"]},k7={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},A2={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},M7={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},GA={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},L7=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ed=typeof window<"u"?window:global;let Mw=!1;try{const t={get passive(){return Mw=!0,!0}};ed.addEventListener("test",null,t),ed.removeEventListener("test",null)}catch{Mw=!1}const R7=L7.indexOf("firefox")!==-1,{WHEEL_EVENTS:O7}=A2,WA="wheel",HA=4.000244140625,z7=40,D7=.25;class F7 extends $_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;ed.WheelEvent&&(R7&&i.deltaMode===ed.WheelEvent.DOM_DELTA_PIXEL&&(a/=ed.devicePixelRatio),i.deltaMode===ed.WheelEvent.DOM_DELTA_LINE&&(a*=z7)),a!==0&&a%HA===0&&(a=Math.floor(a/HA)),i.shiftKey&&a&&(a=a*D7),this.callback({type:WA,center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(O7),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Mw?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===WA&&(this.options.enable=n)}}const{MOUSE_EVENTS:N7}=A2,qA="pointermove",ZA="pointerover",XA="pointerout",YA="pointerenter",KA="pointerleave";class B7 extends $_{constructor(e,n,r){super(e,n,r),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(N7),this.events.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===qA&&(this.enableMoveEvent=n),e===ZA&&(this.enableOverEvent=n),e===XA&&(this.enableOutEvent=n),e===YA&&(this.enableEnterEvent=n),e===KA&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(ZA,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(XA,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(YA,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(KA,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(qA,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:j7}=A2,JA="keydown",QA="keyup";class V7 extends $_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:JA,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:QA,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(j7),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===JA&&(this.enableDownEvent=n),e===QA&&(this.enableUpEvent=n)}}const eI="contextmenu";class U7 extends $_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:eI,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===eI&&(this.options.enable=n)}}const tI=1,Lw=2,nI=4,$7={pointerdown:tI,pointermove:Lw,pointerup:nI,mousedown:tI,mousemove:Lw,mouseup:nI},G7=0,W7=1,H7=2,q7=1,Z7=2,X7=4;function Y7(t){const e=$7[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,a=!1,h=!1;return e===Lw?(i=!!(n&q7),a=!!(n&X7),h=!!(n&Z7)):(i=r===G7,a=r===W7,h=r===H7),{leftButton:i,middleButton:a,rightButton:h}}function K7(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,a=r.height/e.offsetHeight||1,h={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/a};return{center:n,offsetCenter:h}}const Ub={srcElement:"root",priority:0};class J7{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,a=!1){const{handlers:h,handlersByElement:l}=this;let m=Ub;typeof r=="string"||r&&r.addEventListener?m={...Ub,srcElement:r}:r&&(m={...Ub,...r});let _=l.get(m.srcElement);_||(_=[],l.set(m.srcElement,_));const S={type:e,handler:n,srcElement:m.srcElement,priority:m.priority};i&&(S.once=!0),a&&(S.passive=!0),h.push(S),this._active=this._active||!S.passive;let P=_.length-1;for(;P>=0&&!(_[P].priority>=S.priority);)P--;_.splice(P+1,0,S)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let a=r.length-1;a>=0;a--){const h=r[a];if(h.type===e&&h.handler===n){r.splice(a,1);const l=i.get(h.srcElement);l.splice(l.indexOf(h),1),l.length===0&&i.delete(h.srcElement)}}this._active=r.some(a=>!a.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const a=()=>{e.handled=!0},h=()=>{e.handled=!0,i=!0},l=[];for(let m=0;m<r.length;m++){const{type:_,handler:S,once:P}=r[m];if(S({...e,type:_,stopPropagation:a,stopImmediatePropagation:h}),P&&l.push(r[m]),i)break}for(let m=0;m<l.length;m++){const{type:_,handler:S}=l[m];this.remove(_,S)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Y7(e),...K7(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Q7={events:null,recognizers:null,recognizerOptions:{},Manager:C7,touchAction:"none",tabIndex:0};class eW{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:a}=i,h=k7[a.type];h&&this.manager.emit(h,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Q7,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||A7}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys($A).forEach(i=>{const a=this.manager.get(i);a&&$A[i].forEach(h=>{a.recognizeWith(h)})});for(const i in n.recognizerOptions){const a=this.manager.get(i);if(a){const h=n.recognizerOptions[i];delete h.enable,a.set(h)}}this.wheelInput=new F7(e,this._onOtherEvent,{enable:!1}),this.moveInput=new B7(e,this._onOtherEvent,{enable:!1}),this.keyInput=new V7(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new U7(e,this._onOtherEvent,{enable:!1});for(const[i,a]of this.events)a.isEmpty()||(this._toggleRecognizer(a.recognizerName,!0),this.manager.on(i,a.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const a=I7[e];a&&!this.options.recognizers&&a.forEach(h=>{const l=r.get(h);n?(l.requireFailure(e),i.dropRequireFailure(h)):l.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,a){if(typeof e!="string"){r=n;for(const S in e)this._addEventHandler(S,e[S],r,i,a);return}const{manager:h,events:l}=this,m=GA[e]||e;let _=l.get(m);_||(_=new J7(this),l.set(m,_),_.recognizerName=M7[m]||m,h&&h.on(m,_.handleEvent)),_.add(e,n,r,i,a),_.isEmpty()||this._toggleRecognizer(_.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const h in e)this._removeEventHandler(h,e[h]);return}const{events:r}=this,i=GA[e]||e,a=r.get(i);if(a&&(a.remove(e,n),a.isEmpty())){const{recognizerName:h}=a;let l=!1;for(const m of r.values())if(m.recognizerName===h&&!m.isEmpty()){l=!0;break}l||this._toggleRecognizer(h,!1)}}}function nu(){}const tW=({isDragging:t})=>t?"grabbing":"grab",rO={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:nu,onResize:nu,onViewStateChange:nu,onInteractionStateChange:nu,onBeforeRender:nu,onAfterRender:nu,onLoad:nu,onError:t=>hr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:tW,getTooltip:null,debug:!1,drawPickingColors:!1};class G_{constructor(e){J(this,"props",void 0),J(this,"width",0),J(this,"height",0),J(this,"userData",{}),J(this,"canvas",null),J(this,"viewManager",null),J(this,"layerManager",null),J(this,"effectManager",null),J(this,"deckRenderer",null),J(this,"deckPicker",null),J(this,"eventManager",null),J(this,"tooltip",null),J(this,"metrics",void 0),J(this,"animationLoop",void 0),J(this,"stats",void 0),J(this,"viewState",void 0),J(this,"cursorState",void 0),J(this,"_needsRedraw",void 0),J(this,"_pickRequest",void 0),J(this,"_lastPointerDownInfo",null),J(this,"_metricsCounter",void 0),J(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),J(this,"_onEvent",n=>{const r=BC[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const a=this.layerManager.getLayers(),h=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:a,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:l}=h,m=l&&(l[r.handler]||l.props[r.handler]),_=this.props[r.handler];let S=!1;m&&(S=m.call(l,h,n)),!S&&_&&_(h,n)}),J(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...rO,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&hr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),FR()==="IE"&&hr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new n2({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Md.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,a,h,l,m;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(a=this.deckRenderer)===null||a===void 0||a.finalize(),this.deckRenderer=null,(h=this.deckPicker)===null||h===void 0||h.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(m=this.tooltip)===null||m===void 0||m.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var _;(_=this.canvas.parentElement)===null||_===void 0||_.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&hr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&hr.removed("onLayerClick","onClick")(),e.initialViewState&&!Ma(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),h=this.deckRenderer.needsRedraw(e);return n=n||r||i||a||h,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ci(this.viewManager),this.viewManager.views}getViewports(e){return Ci(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ci(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),a}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ci(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const a=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=a}if(r||r===0){var i;const a=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=a}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,a=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||a!==this.height){var h,l;this.width=i,this.height=a,(h=this.viewManager)===null||h===void 0||h.setProps({width:i,height:a}),(l=this.layerManager)===null||l===void 0||l.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:a})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:a,debug:h,onError:l,onBeforeRender:m,onAfterRender:_,useDevicePixels:S}=e;return new t$({width:n,height:r,useDevicePixels:S,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:P=>n3({...a,...P,canvas:this.canvas,debug:h,onContextLost:()=>this._onContextLost()}),onInitialize:P=>this._setGLContext(P.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:m,onAfterRender:_,onError:l})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new K3({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let a=i,h=!1;for(const l of r){var n;a=l,h=((n=l.layer)===null||n===void 0?void 0:n.onHover(l,e.event))||h}if(!h&&this.props.onHover&&this.props.onHover(a,e.event),this.props.getTooltip&&this.tooltip){const l=this.props.getTooltip(a);this.tooltip.setTooltip(l,a.x,a.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,h2(e,{enable:!0,copyState:!0})),this.tooltip=new b7(this.canvas),gl(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new M3;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new eW(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in BC)this.eventManager.on(i,this._onEvent);this.viewManager=new XG({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new ZG(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new u7,this.deckRenderer=new f7(e),this.deckPicker=new v7(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;gl(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),hr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=mu.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}J(G_,"defaultProps",rO);J(G_,"VERSION",oj);class $b{constructor(e,n){J(this,"opts",void 0),J(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let a=r;if(r&&r.length!==i){a=new Float32Array(i);const h=n.elementOffset||0;for(let l=0;l<i;++l)a[l]=r[h+l]}return a}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function nW(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function v0(t){return t.stride||t.size*t.bytesPerElement}function iO(t,e){e.offset&&hr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=v0(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:n}}function rW(t,e){const n=iO(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class iW{constructor(e,n,r){J(this,"gl",void 0),J(this,"id",void 0),J(this,"size",void 0),J(this,"settings",void 0),J(this,"value",void 0),J(this,"doublePrecision",void 0),J(this,"_buffer",void 0),J(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,a=i===5130;let{defaultValue:h}=n;h=Number.isFinite(h)?[h]:h||new Array(this.size).fill(0);let l;a?l=5126:!i&&n.isIndexed?l=e&&MV(e,Tr.ELEMENT_INDEX_UINT32)?5125:5123:l=i||5126;let m=nW(i||l||5126);this.doublePrecision=a,a&&n.fp64===!1&&(m=Float32Array),this.value=null,this.settings={...n,defaultType:m,defaultValue:h,logicalType:i,type:l,size:this.size,bytesPerElement:m.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ur(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*v0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Md.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,a=rW(this.getAccessor(),n||{});return r[e]=new $b(this,a.high),r["".concat(e,"64Low")]=i?new $b(this,a.low):new Float32Array(this.size),r}if(n){const r=iO(this.getAccessor(),n);return{[e]:new $b(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,a=r*i;if(n&&a&&n.length>=a){const h=new Array(i).fill(1/0),l=new Array(i).fill(-1/0);for(let m=0;m<a;)for(let _=0;_<i;_++){const S=n[m++];S<h[_]&&(h[_]=S),S>l[_]&&(l[_]=S)}e=[h,l]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ur?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let a=r.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!n.constant||!this._areValuesEqual(a,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=a}else if(r.buffer){const a=r.buffer;n.externalBuffer=a,n.constant=!1,this.value=r.value||null;const h=r.value instanceof Float64Array;i.type=r.type||a.accessor.type,i.bytesPerElement=a.accessor.BYTES_PER_ELEMENT*(h?2:1),i.stride=v0(i)}else if(r.value){this._checkExternalBuffer(r);let a=r.value;n.externalBuffer=null,n.constant=!1,this.value=a,i.bytesPerElement=a.BYTES_PER_ELEMENT,i.stride=v0(i);const{buffer:h,byteOffset:l}=this;this.doublePrecision&&a instanceof Float64Array&&(a=Bb(a,i));const m=a.byteLength+l+i.stride*2;h.byteLength<m&&h.reallocate(m),h.setAccessor(null),h.subData({data:a,offset:l}),i.type=r.type||h.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Bb(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,a=Md.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=a;const{buffer:h,byteOffset:l}=this;return h.byteLength<a.byteLength+l&&(h.reallocate(a.byteLength+l),n&&i&&h.subData({data:i instanceof Float64Array?Bb(i,this):i,offset:l})),r.allocatedValue=a,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&hr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let h=a;for(;--h>=0;)n[r+h]=i[h];return n}switch(a){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let h=a;for(;--h>=0;)n[r+h]=Number.isFinite(e[h])?e[h]:i[h]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const rI=[],iI=[];function I2(t,e=0,n=1/0){let r=rI;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(iI.length=t.length,r=iI):r=rI,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function sO(t){return t&&t[Symbol.asyncIterator]}function oO(t,e){const{size:n,stride:r,offset:i,startIndices:a,nested:h}=e,l=t.BYTES_PER_ELEMENT,m=r?r/l:n,_=i?i/l:0,S=Math.floor((t.length-_)/m);return(P,{index:C,target:L})=>{if(!a){const z=C*m+_;for(let N=0;N<n;N++)L[N]=t[z+N];return L}const R=a[C],D=a[C+1]||S;let W;if(h){W=new Array(D-R);for(let z=R;z<D;z++){const N=z*m+_;L=new Array(n);for(let F=0;F<n;F++)L[F]=t[N+F];W[z-R]=L}}else if(m===n)W=t.subarray(R*n+_,D*n+_);else{W=new t.constructor((D-R)*n);let z=0;for(let N=R;N<D;N++){const F=N*m+_;for(let $=0;$<n;$++)W[z++]=t[F+$]}}return W}}const sW=[],x0=[[0,1/0]];function oW(t,e){if(t===x0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let a=0;a<r;a++){const h=t[a];h[1]<e[0]?(n.push(h),i=a+1):h[0]>e[1]?n.push(h):e=[Math.min(h[0],e[0]),Math.max(h[1],e[1])]}return n.splice(i,0,e),n}function Gb(t){const{source:e,target:n,start:r=0,size:i,getData:a}=t,h=t.end||n.length,l=e.length,m=h-r;if(l>m){n.set(e.subarray(0,m),r);return}if(n.set(e,r),!a)return;let _=l;for(;_<m;){const S=a(_,e);for(let P=0;P<i;P++)n[r+_]=S[P]||0,_++}}function aW({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:a}){if(!Array.isArray(a))return Gb({source:t,target:e,size:n,getData:r}),e;let h=0,l=0;const m=r&&((S,P)=>r(S+l,P)),_=Math.min(i.length,a.length);for(let S=1;S<_;S++){const P=i[S]*n,C=a[S]*n;Gb({source:t.subarray(h,P),target:e,start:l,end:C,size:n,getData:m}),h=P,l=C}return l<e.length&&Gb({source:[],target:e,start:l,size:n,getData:m}),e}const lW={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function aO(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...lW[n],...e,...t,type:n}}function lO(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function cO(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function uO(t){t.push(t.shift())}function k2(t,e){const{doublePrecision:n,settings:r,value:i,size:a}=t,h=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*a)*h}function hO({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:a=h=>h}){const h=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*h,m=n.byteOffset,_=n.startIndices,S=i&&_,P=k2(n,e),C=n.isConstant;if(!S&&r>=P)return;const L=C?n.value:n.getBuffer().getData({srcByteOffset:m});if(n.settings.normalized&&!C){const z=a;a=(N,F)=>n.normalizeConstant(z(N,F))}const R=C?(z,N)=>a(L,N):(z,N)=>a(L.subarray(z,z+l),N),D=t.getData({length:r}),W=new Float32Array(P);aW({source:D,target:W,sourceStartIndices:i,targetStartIndices:_,size:l,getData:R}),t.byteLength<W.byteLength+m&&t.reallocate(W.byteLength+m),t.subData({data:W,offset:m})}class M2 extends iW{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:x0}),J(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(a=>e[a])]:e[n];return aO(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=oW(this.state.updateRanges,[r,i])}else this.state.updateRanges=x0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=sW}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==x0),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:h,noAlloc:l}}=this;let m=!0;if(h){for(const[_,S]of a)h.call(i,this,{data:n,startRow:_,endRow:S,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,S]of a){const P=Number.isFinite(_)?this.getVertexOffset(_):0,C=Number.isFinite(S)?this.getVertexOffset(S):l||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:P,endOffset:C})}this._checkAttributeArray()}else m=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),m}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const h=e;Ci(ArrayBuffer.isView(h.value),"invalid ".concat(i.accessor));const l=!!h.size&&h.size!==this.size;return r.binaryAccessor=oO(h.value,{size:h.size||this.size,stride:h.stride,offset:h.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:a,numInstances:h}){if(e.constant)return;const{settings:l,state:m,value:_,size:S,startIndices:P}=e,{accessor:C,transform:L}=l,R=m.binaryAccessor||(typeof C=="function"?C:a[C]);Ci(typeof R=="function",'accessor "'.concat(C,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:W,objectInfo:z}=I2(n,r,i);for(const N of W){z.index++;let F=R(N,z);if(L&&(F=L.call(this,F)),P){const $=(z.index<P.length-1?P[z.index+1]:h)-P[z.index];if(F&&Array.isArray(F[0])){let K=D;for(const ne of F)e._normalizeValue(ne,_,K),K+=S}else F&&F.length>S?_.set(F,D):(e._normalizeValue(F,z.target,0),BG({target:_,source:z.target,start:D,count:$}));D+=$*S}else e._normalizeValue(F,_,D),D+=S}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class cW{constructor({gl:e,attribute:n,timeline:r}){J(this,"gl",void 0),J(this,"type","interpolation"),J(this,"attributeInTransition",void 0),J(this,"settings",void 0),J(this,"attribute",void 0),J(this,"transition",void 0),J(this,"currentStartIndices",void 0),J(this,"currentLength",void 0),J(this,"transform",void 0),J(this,"buffers",void 0),this.gl=e,this.transition=new Hm(r),this.attribute=n,this.attributeInTransition=new M2(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=hW(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:a}=this;uO(i);const h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)hO({buffer:l,...h});this.currentStartIndices=a.startIndices,this.currentLength=k2(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aFrom:i[0],aTo:lO(r,a)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let a=i/n;r&&(a=r(a)),this.transform.run({uniforms:{time:a}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const uW=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function hW(t,e){const n=cO(e.size);return new v2(t,{vs:uW,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class dW{constructor({gl:e,attribute:n,timeline:r}){J(this,"gl",void 0),J(this,"type","spring"),J(this,"attributeInTransition",void 0),J(this,"settings",void 0),J(this,"attribute",void 0),J(this,"transition",void 0),J(this,"currentStartIndices",void 0),J(this,"currentLength",void 0),J(this,"texture",void 0),J(this,"framebuffer",void 0),J(this,"transform",void 0),J(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Hm(r),this.attribute=n,this.attributeInTransition=new M2(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=pW(e),this.framebuffer=mW(e,this.texture),this.transform=fW(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:a}=this,h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)hO({buffer:l,...h});this.settings=e,this.currentStartIndices=a.startIndices,this.currentLength=k2(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aTo:lO(r,a)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const h=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:h.stiffness,damping:h.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),uO(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),U_(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function fW(t,e,n){const r=cO(e.size);return new v2(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function pW(t){return new da(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function mW(t,e){return new xi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const gW={interpolation:cW,spring:dW};class yW{constructor(e,{id:n,timeline:r}){J(this,"id",void 0),J(this,"isSupported",void 0),J(this,"gl",void 0),J(this,"timeline",void 0),J(this,"transitions",void 0),J(this,"needsRedraw",void 0),J(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=v2.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const a=e[i],h=a.getTransitionSetting(n);h&&this._updateAttribute(i,a,h)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let a=!i||i.type!==r.type;if(a){if(!this.isSupported){hr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const h=gW[r.type];h?this.transitions[e]=new h({attribute:n,timeline:this.timeline,gl:this.gl}):(hr.error("unsupported transition type '".concat(r.type,"'"))(),a=!1)}(a||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const sI="attributeManager.invalidate",_W="attributeManager.updateStart",vW="attributeManager.updateEnd",xW="attribute.updateStart",bW="attribute.allocate",wW="attribute.updateEnd";class SW{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){J(this,"id",void 0),J(this,"gl",void 0),J(this,"attributes",void 0),J(this,"updateTriggers",void 0),J(this,"needsRedraw",void 0),J(this,"userData",void 0),J(this,"stats",void 0),J(this,"attributeTransitionManager",void 0),J(this,"mergeBoundsMemoized",Wm(kG)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new yW(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);ss(sI,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(sI,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:a={},buffers:h={},context:l={}}){let m=!1;ss(_W,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const S=this.attributes[_],P=S.settings.accessor;S.startIndices=r,S.numInstances=n,a[_]&&hr.removed("props.".concat(_),"data.attributes.".concat(_))(),S.setExternalBuffer(h[_])||S.setBinaryValue(typeof P=="string"?h[P]:void 0,e.startIndices)||typeof P=="string"&&!h[P]&&S.setConstantValue(a[P])||S.needsUpdate()&&(m=!0,this._updateAttribute({attribute:S,numInstances:n,data:e,props:a,context:l})),this.needsRedraw=this.needsRedraw||S.needsRedraw()}m&&ss(vW,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const a in n){const h=n[a];h.needsRedraw(e)&&!r.hasAttribute(a)&&(i[a]=h)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new M2(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,a=i[e];return a&&a.forEach(h=>{const l=r[h];l&&l.setNeedsUpdate(l.id,n)}),a}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(ss(xW,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&ss(bW,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(wW,n,r))}}class TW extends Hm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:a}}=this,h=a(e/i);this._value=gm(n,r,h)}}const oI=1e-5;function aI(t,e,n,r,i){const a=e-t,l=(n-e)*i,m=-a*r;return l+m+a+e}function EW(t,e,n,r,i){if(Array.isArray(n)){const a=[];for(let h=0;h<n.length;h++)a[h]=aI(t[h],e[h],n[h],r,i);return a}return aI(t,e,n,r,i)}function lI(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class PW extends Hm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:h=e}=this;let l=EW(a,h,n,r,i);const m=lI(l,n),_=lI(l,h);m<oI&&_<oI&&(l=n,this.end()),this._prevValue=h,this._currValue=l}}const CW={interpolation:TW,spring:PW};class AW{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:a}=this;if(a.has(e)){const m=a.get(e),{value:_=m.settings.fromValue}=m;n=_,this.remove(e)}if(i=aO(i),!i)return;const h=CW[i.type];if(!h){hr.error("unsupported transition type '".concat(i.type,"'"))();return}const l=new h(this.timeline);l.start({...i,fromValue:n,toValue:r}),a.set(e,l)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function IW(t){const e=t[bc];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function kW(t,e){const n=dO({newProps:t,oldProps:e,propTypes:t[bc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=LW(t,e);let i=!1;return r||(i=RW(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:OW(t,e),transitionsChanged:MW(t,e)}}function MW(t,e){if(!t.transitions)return!1;const n={},r=t[bc];let i=!1;for(const a in t.transitions){const h=r[a],l=h&&h.type;(l==="number"||l==="color"||l==="array")&&Rw(t[a],e[a],h)&&(n[a]=!0,i=!0)}return i?n:!1}function dO({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(i,".").concat(a," added");const h=Rw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(i,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const h=Rw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}}return!1}function Rw(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function LW(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function RW(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&cI(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&cI(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function OW(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function cI(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},dO({oldProps:i,newProps:r,triggerName:n})}const zW="count(): argument not an object",DW="count(): argument not a container";function FW(t){if(!BW(t))throw new Error(zW);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(NW(t))return Object.keys(t).length;throw new Error(DW)}function NW(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function BW(t){return t!==null&&typeof t=="object"}function jW(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const VW={10241:9987,10240:9729,10242:33071,10243:33071},Ow={};function UW(t,e,n,r){if(n instanceof da)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const a=new da(e,{...n,parameters:{...VW,...i,...r}});return Ow[a.id]=t,a}function $W(t,e){!e||!(e instanceof da)||Ow[e.id]===t&&(e.delete(),delete Ow[e.id])}const GW={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||zw(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Ma(t,e,1)}},accessor:{validate(t,e){const n=c_(t);return n==="function"||n===c_(e.value)},equal(t,e,n){return typeof e=="function"?!0:Ma(t,e,1)}},array:{validate(t,e){return e.optional&&!t||zw(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ma(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ma(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:UW(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{$W(n.id,t)}}};function WW(t){const e={},n={},r={};for(const[i,a]of Object.entries(t)){const h=a==null?void 0:a.deprecatedFor;if(h)r[i]=Array.isArray(h)?h:[h];else{const l=HW(i,a);e[i]=l,n[i]=l.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function HW(t,e){switch(c_(e)){case"object":return fp(t,e);case"array":return fp(t,{type:"array",value:e,compare:!1});case"boolean":return fp(t,{type:"boolean",value:e});case"number":return fp(t,{type:"number",value:e});case"function":return fp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function fp(t,e){return"type"in e?{name:t,...GW[e.type],...e}:"value"in e?{name:t,type:c_(e.value),...e}:{name:t,type:"object",value:e}}function zw(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function c_(t){return zw(t)?"array":t===null?"null":typeof t}function qW(t,e){let n;for(let a=e.length-1;a>=0;a--){const h=e[a];"extensions"in h&&(n=h.extensions)}const r=Dw(t.constructor,n),i=Object.create(r);i[l_]=t,i[ku]={},i[ac]={};for(let a=0;a<e.length;++a){const h=e[a];for(const l in h)i[l]=h[l]}return Object.freeze(i),i}const ZW="_mergedDefaultProps";function Dw(t,e){let n=ZW;if(e)for(const i of e){const a=i.constructor;a&&(n+=":".concat(a.extensionName||a.name))}const r=fO(t,n);return r||(t[n]=XW(t,e||[]))}function XW(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Dw(r),a=fO(t,"defaultProps")||{},h=WW(a),l=Object.assign(Object.create(null),i,h.defaultProps),m=Object.assign(Object.create(null),i==null?void 0:i[bc],h.propTypes),_=Object.assign(Object.create(null),i==null?void 0:i[Vb],h.deprecatedProps);for(const S of e){const P=Dw(S.constructor);P&&(Object.assign(l,P),Object.assign(m,P[bc]),Object.assign(_,P[Vb]))}return YW(l,t),JW(l,m),KW(l,_),l[bc]=m,l[Vb]=_,e.length===0&&!L2(t,"_propTypes")&&(t._propTypes=m),l}function YW(t,e){const n=eH(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function KW(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const a of e[n])L2(this,a)||(this[a]=r);hr.deprecated(i,e[n].join("/"))()}})}function JW(t,e){const n={},r={};for(const i in e){const a=e[i],{name:h,value:l}=a;a.async&&(n[h]=l,r[h]=QW(h))}t[hd]=n,t[ku]={},Object.defineProperties(t,r)}function QW(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||sO(e)?this[ku][t]=e:this[ac][t]=e},get(){if(this[ac]){if(t in this[ac])return this[ac][t]||this[hd][t];if(t in this[ku]){const e=this[l_]&&this[l_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[hd][t]}}return this[hd][t]}}}function L2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fO(t,e){return L2(t,e)&&t[e]}function eH(t){const e=t.componentName;return e||hr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let tH=0;class R2{constructor(...e){J(this,"id",void 0),J(this,"props",void 0),J(this,"count",void 0),this.props=qW(this,e),this.id=this.props.id,this.count=tH++}clone(e){const{props:n}=this,r={};for(const i in n[hd])i in n[ac]?r[i]=n[ac][i]:i in n[ku]&&(r[i]=n[ku][i]);return new this.constructor({...n,...r,...e})}}J(R2,"componentName","Component");J(R2,"defaultProps",{});const nH=Object.freeze({});class rH{constructor(e){J(this,"component",void 0),J(this,"onAsyncPropUpdated",void 0),J(this,"asyncProps",void 0),J(this,"oldProps",void 0),J(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||nH}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[l_]||this.component;const n=e[ac]||{},r=e[ku]||e,i=e[hd]||{};for(const a in n){const h=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h),n[a]=this.getAsyncProp(a)}for(const a in r){const h=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(sO(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(a=>{this.component&&(a=this._postProcessValue(r,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let a=[],h=0;for await(const l of n){if(!this.component)return;const{dataTransform:m}=this.component.props;m?a=m(l,a):a=a.concat(l),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:h,endRow:a.length}]}),h=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[bc];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class iH extends rH{constructor({attributeManager:e,layer:n}){super(n),J(this,"attributeManager",void 0),J(this,"needsRedraw",void 0),J(this,"needsUpdate",void 0),J(this,"subLayers",void 0),J(this,"usesPickingColorCache",void 0),J(this,"hasPickingBuffer",void 0),J(this,"changeFlags",void 0),J(this,"viewport",void 0),J(this,"uniformTransitions",void 0),J(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const sH="layer.changeFlag",oH="layer.initialize",aH="layer.update",lH="layer.finalize",cH="layer.matched",uI=2**24-1,uH=Object.freeze([]),hH=Wm(({oldViewport:t,viewport:e})=>t.equals(e));let Ta=new Uint8ClampedArray(0);const dH={data:{type:"data",value:uH,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:a})=>{const{resourceManager:h}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,a){var l;i={...i,fetch:{...(l=i)===null||l===void 0?void 0:l.fetch,signal:a}}}let m=h.contains(t);return!m&&!i&&(h.add({resourceId:t,data:hw(t,r),persistent:!1}),m=!0),m?h.subscribe({resourceId:t,onChange:_=>{var S;return(S=n.internalState)===null||S===void 0?void 0:S.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):hw(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:qn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Nu extends R2{constructor(...e){super(...e),J(this,"internalState",null),J(this,"lifecycle",Bh.NO_STATE),J(this,"context",void 0),J(this,"state",void 0),J(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ci(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=H3(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,h]=V3(r,n.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,h]}unproject(e){return Ci(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ci(this.internalState);const r=this.internalState.viewport||this.context.viewport;return DG(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===qn.DEFAULT||e===qn.LNGLAT||e===qn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ci(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:FW(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=jW(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,a=this.internalState.hasPickingBuffer,h=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(a!==h){this.internalState.hasPickingBuffer=h;const{pickingColors:l,instancePickingColors:m}=n.attributes,_=l||m;_&&(h&&_.constant&&(_.constant=!1,n.invalidate(_.id)),!_.value&&!h&&(_.constant=!0,_.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var a,h;(a=this.context)===null||a===void 0||(h=a.onError)===null||h===void 0||h.call(a,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!hH({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ta.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>uI&&hr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ta=Md.allocate(Ta,n,{size:3,copy:!0,maxCount:Math.max(n,uI)});const i=Math.floor(Ta.length/3),a=[];for(let h=r;h<i;h++)this.encodePickingColor(h,a),Ta[h*3+0]=a[0],Ta[h*3+1]=a[1],Ta[h*3+2]=a[2]}e.value=Ta.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},a=r.getShaderAttributes(n,i);e.setAttributes(a)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,a=r||i,h=a&&n.attributes&&n.attributes[a.id];if(h&&h.value){const l=h.value,m=this.encodePickingColor(e);for(let _=0;_<n.length;_++){const S=a.getVertexOffset(_);l[S]===m[0]&&l[S+1]===m[1]&&l[S+2]===m[2]&&this._disablePickingIndex(_)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const a=i.getVertexOffset(e),h=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(h-a),offset:a})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ta.buffer&&(r.value=Ta.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ci(!this.internalState),Ci(Number.isFinite(this.props.coordinateSystem)),ss(oH,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new iH({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(hr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new AW(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(cH,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ss(aH,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,a=r.viewport,h=this._updateUniformTransition();i.propsInTransition=h,r.viewport=i.viewport||a,this.props=h;try{const l=this._getUpdateParams(),m=this.getModels();if(r.gl)this.updateState(l);else try{this.updateState(l)}catch{}for(const S of this.props.extensions)S.updateState.call(this,l,S);const _=this.getModels()[0]!==m[0];this._postUpdate(l,_)}finally{r.viewport=a,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ss(lH,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,a=this.context;this.props=this.internalState.propsInTransition||i;const h=this.props.opacity;n.opacity=Math.pow(h,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:l}=this.props,m=l&&l(n)||[0,0];gl(a.gl,{polygonOffset:m}),ua(a.gl,r,()=>{const _={moduleParameters:e,uniforms:n,parameters:r,context:a};for(const S of this.props.extensions)S.draw.call(this,_,S);this.draw(_)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const h=e[i],l=n[i];h&&Array.isArray(l)&&(n.dataChanged=Array.isArray(h)?l.concat(h):h,a=!0);default:n[i]||(n[i]=e[i],a=!0)}a&&ss(sH,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=kW(e,n);if(r.updateTriggersChanged)for(const a in r.updateTriggersChanged)r.updateTriggersChanged[a]&&this.invalidateAttribute(a);if(r.transitionsChanged)for(const a in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(a,n[a],e[a],(i=e.transitions)===null||i===void 0?void 0:i[a])}return this.setChangeFlags(r)}validateProps(){IW(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new SW(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:a}=this.state;a==null||a.setInstanceCount(this.getNumInstances());const{autoHighlight:h,highlightedObjectIndex:l,highlightColor:m}=r;if(n||i.autoHighlight!==h||i.highlightedObjectIndex!==l||i.highlightColor!==m){const _={};h||(_.pickingSelectedColor=null),Array.isArray(m)&&(_.pickingHighlightColor=m),(n||l!==i.highlightedObjectIndex)&&(_.pickingSelectedColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setModuleParameters(_)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}J(Nu,"defaultProps",dH);J(Nu,"layerName","Layer");const fH="compositeLayer.renderLayers";class pO extends Nu{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:S,coordinateSystem:P,coordinateOrigin:C,wrapLongitude:L,positionFormat:R,modelMatrix:D,extensions:W,fetch:z,operation:N,_subLayerProps:F}=this.props,$={id:"",updateTriggers:{},opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:S,coordinateSystem:P,coordinateOrigin:C,wrapLongitude:L,positionFormat:R,modelMatrix:D,extensions:W,fetch:z,operation:N},K=F&&e.id&&F[e.id],ne=K&&K.updateTriggers,se=e.id||"sublayer";if(K){const xe=this.props[bc],Se=e.type?e.type._propTypes:{};for(const _e in K){const Re=Se[_e]||xe[_e];Re&&Re.type==="accessor"&&(K[_e]=this.getSubLayerAccessor(K[_e]))}}Object.assign($,e,K),$.id="".concat(this.props.id,"-").concat(se),$.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...ne};for(const xe of W){const Se=xe.getSubLayerProps.call(this,xe);Se&&Object.assign($,Se,{updateTriggers:Object.assign($.updateTriggers,Se.updateTriggers)})}return $}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const a=this.renderLayers();r=E2(a,Boolean),this.internalState.subLayers=r}ss(fH,this,i,r);for(const a of r)a.parent=this}}J(pO,"layerName","CompositeLayer");const Wb={bearing:0,pitch:0,position:[0,0,0]},pH={speed:1.2,curve:1.414};class mH extends X3{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),J(this,"opts",void 0),this.opts={...pH,...e}}interpolateProps(e,n,r){const i=dG(e,n,r,this.opts);for(const a in Wb)i[a]=gm(e[a]||Wb[a],n[a]||Wb[a],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=fG(e,n,this.opts)),r}}class mO{constructor(e){J(this,"opts",void 0),J(this,"typedArrayManager",void 0),J(this,"indexStarts",[0]),J(this,"vertexStarts",[0]),J(this,"vertexCount",0),J(this,"instanceCount",0),J(this,"attributes",void 0),J(this,"_attributeDefs",void 0),J(this,"data",void 0),J(this,"getGeometry",void 0),J(this,"geometryBuffer",void 0),J(this,"buffers",void 0),J(this,"positionSize",void 0),J(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Md,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:a,positionFormat:h,dataChanged:l,normalize:m=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=a&&a.size||(h==="XY"?2:3),this.buffers=r,this.normalize=m,a&&(Ci(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(a),m||(r.positions=a)),this.geometryBuffer=r.positions,Array.isArray(l))for(const _ of l)this._rebuildGeometry(_);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?oO(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:a,typedArrayManager:h}=this;for(const l in a)if(l in i)h.release(r[l]),r[l]=null;else{const m=a[l];m.copy=n,r[l]=h.allocate(r[l],e,m)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:a}=this,{iterable:h,objectInfo:l}=I2(i,n,r);for(const m of h){l.index++;const _=a?a(m,l):null;e(_,l.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:a,geometryBuffer:h}=this,{startRow:l=0,endRow:m=1/0}=e||{},_={};if(e||(n=[0],r=[0]),this.normalize||!h)this._forEachGeometry((P,C)=>{const L=P&&this.normalizeGeometry(P);_[C]=L,r[C+1]=r[C]+(L?this.getGeometrySize(L):0)},l,m),i=r[r.length-1];else if(r=a.startIndices,i=r[a.length]||0,ArrayBuffer.isView(h))i=i||h.length/this.positionSize;else if(h instanceof ur){const P=h.accessor.stride||this.positionSize*4;i=i||h.byteLength/P}else if(h.buffer){const P=h.stride||this.positionSize*4;i=i||h.buffer.byteLength/P}else if(h.value){const P=h.value,C=h.stride/P.BYTES_PER_ELEMENT||this.positionSize;i=i||P.length/C}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const S={};this._forEachGeometry((P,C)=>{const L=_[C]||P;S.vertexStart=r[C],S.indexStart=n[C];const R=C<r.length-1?r[C+1]:i;S.geometrySize=R-r[C],S.geometryIndex=C,this.updateGeometryAttributes(L,S)},l,m),this.vertexCount=n[n.length-1]}}const gH=typeof window<"u"?q.useLayoutEffect:q.useEffect,yH=gH;function u_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const _H={position:"absolute",zIndex:-1};function gO(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>gO(n,e));if(W_(t)){if(vH(t))return e.style=_H,q.cloneElement(t,e);if(xH(t))return q.cloneElement(t,e)}return t}function W_(t){return t&&typeof t=="object"&&"type"in t||!1}function vH(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function xH(t){const e=t.type;return e&&e.deckGLViewProps}function Fw(t){if(typeof t=="function")return q.createElement(Rd,{},t);if(Array.isArray(t))return t.map(Fw);if(W_(t)){if(t.type===q.Fragment)return Fw(t.props.children);if(u_(t.type,Rd))return t}return t}function bH({children:t,layers:e=[],views:n=null}){const r=[],i=[],a={};return q.Children.forEach(Fw(t),h=>{if(W_(h)){const l=h.type;if(u_(l,Nu)){const m=wH(l,h.props);i.push(m)}else r.push(h);if(u_(l,Rd)&&l!==Rd&&h.props.id){const m=new l(h.props);a[m.id]=m}}else h&&r.push(h)}),Object.keys(a).length>0&&(Array.isArray(n)?n.forEach(h=>{a[h.id]=h}):n&&(a[n.id]=n),n=Object.values(a)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function wH(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function SH({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},a=r.views[0].id;for(const h of t){let l=a,m=h;W_(h)&&u_(h.type,Rd)&&(l=h.props.id||a,m=h.props.children);const _=r.getViewport(l),S=r.getViewState(l);if(_){S.padding=_.padding;const{x:P,y:C,width:L,height:R}=_;m=gO(m,{x:P,y:C,width:L,height:R,viewport:_,viewState:S}),i[l]||(i[l]={viewport:_,children:[]}),i[l].children.push(m)}}return Object.keys(i).map(h=>{const{viewport:l,children:m}=i[h],{x:_,y:S,width:P,height:C}=l,L={position:"absolute",left:_,top:S,width:P,height:C},R="view-".concat(h),D=q.createElement("div",{key:R,id:R,style:L},...m);if(n){const W={viewport:l,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:z=>{z.viewId=h,e._onViewStateChange(z)}};return q.createElement(n,{key:R,value:W},D)}return D})}const TH={mixBlendMode:null};function EH({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const a in n)a in TH?i[a]=n[a]:r[a]=n[a];return{containerStyle:r,canvasStyle:i}}function PH(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function yO(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function CH(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const a=r.getViewports();t.lastRenderedViewports!==a?t.forceUpdate():yO(t)}});return r}const _O=q.forwardRef((t,e)=>{const[n,r]=q.useState(0),a=q.useRef({control:null,version:n,forceUpdate:()=>r(K=>K+1)}).current,h=q.useRef(null),l=q.useRef(null),m=q.useMemo(()=>bH(t),[t.layers,t.views,t.children]);let _=!0;const S=K=>{var ne;return _&&t.viewState?(a.viewStateUpdateRequested=K,null):(a.viewStateUpdateRequested=null,(ne=t.onViewStateChange)===null||ne===void 0?void 0:ne.call(t,K))},P=K=>{if(_)a.interactionStateUpdateRequested=K;else{var ne;a.interactionStateUpdateRequested=null,(ne=t.onInteractionStateChange)===null||ne===void 0||ne.call(t,K)}},C=q.useMemo(()=>{const K={...t,style:null,width:"100%",height:"100%",parent:h.current,canvas:l.current,layers:m.layers,views:m.views,onViewStateChange:S,onInteractionStateChange:P};return delete K._customRender,a.deck&&a.deck.setProps(K),K},[t]);q.useEffect(()=>{const K=t.Deck||G_;return a.deck=CH(a,K,{...C,parent:h.current,canvas:l.current}),()=>{var ne;return(ne=a.deck)===null||ne===void 0?void 0:ne.finalize()}},[]),yH(()=>{yO(a);const{viewStateUpdateRequested:K,interactionStateUpdateRequested:ne}=a;K&&S(K),ne&&P(ne)}),q.useImperativeHandle(e,()=>PH(a),[]);const L=a.deck&&a.deck.isInitialized?a.deck.getViewports():void 0,{ContextProvider:R,width:D,height:W,id:z,style:N}=t,{containerStyle:F,canvasStyle:$}=q.useMemo(()=>EH({width:D,height:W,style:N}),[D,W,N]);if(!a.viewStateUpdateRequested&&a.lastRenderedViewports===L||a.version!==n){a.lastRenderedViewports=L,a.version=n;const K=SH({children:m.children,deck:a.deck,ContextProvider:R}),ne=q.createElement("canvas",{key:"canvas",id:z||"deckgl-overlay",ref:l,style:$});a.control=q.createElement("div",{id:"".concat(z||"deckgl","-wrapper"),ref:h,style:F},[ne,K])}return _=!1,a.control});_O.defaultProps=G_.defaultProps;const AH=_O,IH="modulepreload",kH=function(t){return"/RutasEnBolivia/"+t},hI={},MH=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=kH(a),a in hI)return;hI[a]=!0;const h=a.endsWith(".css"),l=h?'[rel="stylesheet"]':"";if(!!r)for(let S=i.length-1;S>=0;S--){const P=i[S];if(P.href===a&&(!h||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":IH,h||(_.as="script",_.crossOrigin=""),_.href=a,document.head.appendChild(_),h)return new Promise((S,P)=>{_.addEventListener("load",S),_.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=a,window.dispatchEvent(h),!h.defaultPrevented)throw a})},LH=q.createContext(null);function RH(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===a}function al(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!al(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!al(t[i],e[i]))return!1;return!0}return!1}function OH(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function dI(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();al(n,r)||e.setProjection(n)}function fI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function pI(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const zH=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function mI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=e[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const h of zH)h in a&&(i[h]=a[h])}return i||r});return{...t,layers:n}}const gI={version:8,sources:{},layers:[]},yI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Hb={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},_I={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},DH=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],FH=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Od{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const a=this.props[_I[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[yI[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const a=this.props[Hb[i.type]];a&&a(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Od.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);i._container=n;const h=i._resizeObserver;h&&(h.disconnect(),h.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=gI}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||NH()||null,container:e,style:mI(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const S=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=S,n.gl)}const h=new this._MapClass(i);a.padding&&h.setPadding(a.padding),n.cursor&&(h.getCanvas().style.cursor=n.cursor),this._createShadowTransform(h);const l=h._render;h._render=S=>{this._inRender=!0,l.call(h,S),this._inRender=!1};const m=h._renderTaskQueue.run;h._renderTaskQueue.run=S=>{m.call(h._renderTaskQueue,S),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const _=h.fire;h.fire=this._fireEvent.bind(this,_),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),dI(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const S in yI)h.on(S,this._onPointerEvent);for(const S in Hb)h.on(S,this._onCameraEvent);for(const S in _I)h.on(S,this._onEvent);this._map=h}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Od.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=OH(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:a,pitch:h,bearing:l}=i,m=r.isMoving();m&&(i.cameraElevationReference="sea");const _=pI(i,{...fI(r.transform),...e});if(m&&(i.cameraElevationReference="ground"),_&&n){const S=this._deferredEvents;S.move=!0,S.zoom||(S.zoom=a!==i.zoom),S.rotate||(S.rotate=l!==i.bearing),S.pitch||(S.pitch=h!==i.pitch)}return m||pI(r.transform,e),_}_updateSettings(e,n){const r=this._map;let i=!1;for(const a of DH)if(a in e&&!al(e[a],n[a])){i=!0;const h=r[`set${a[0].toUpperCase()}${a.slice(1)}`];h==null||h.call(r,e[a])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=gI,styleDiffing:i=!0}=e,a={diff:i};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(mI(r),a),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!al(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!al(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!al(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const a=this._map;let h=!1;for(const l of FH){const m=(r=e[l])!==null&&r!==void 0?r:!0,_=(i=n[l])!==null&&i!==void 0?i:!0;al(m,_)||(h=!0,m?a[l].enable(m):a[l].disable())}return h}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const a=e.type,h=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,l=this._queryRenderedFeatures(e.point),m=l.length>0;!m&&h&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,m&&!h&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,a=i.transform,h=typeof n=="string"?n:n.type;return h==="move"&&this._updateViewState(this.props,!1),h in Hb&&(typeof n=="object"&&(n.viewState=fI(a)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=a,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{dI(this._renderTransform,n),e.transform=n}}}Od.savedMaps=[];function NH(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const BH=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function jH(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const a=e.project(r);return e.transform=i,a},unproject:r=>{const i=e.transform;e.transform=t.transform;const a=e.unproject(r);return e.transform=i,a},queryTerrainElevation:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryTerrainElevation(r,i);return e.transform=a,h},queryRenderedFeatures:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryRenderedFeatures(r,i);return e.transform=a,h}};for(const r of VH(e))!(r in n)&&!BH.includes(r)&&(n[r]=e[r].bind(e));return n}function VH(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const UH=typeof document<"u"?q.useLayoutEffect:q.useEffect,$H=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function GH(t,e){for(const r of $H)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const H_=q.createContext(null);function WH(t,e,n){const r=q.useContext(LH),[i,a]=q.useState(null),h=q.useRef(),{current:l}=q.useRef({mapLib:null,map:null});q.useEffect(()=>{const S=t.mapLib;let P=!0,C;return Promise.resolve(S||n).then(L=>{if(!P)return;if(!L)throw new Error("Invalid mapLib");const R="Map"in L?L:L.default;if(!R.Map)throw new Error("Invalid mapLib");if(GH(R,t),!R.supported||R.supported(t))t.reuseMaps&&(C=Od.reuse(t,h.current)),C||(C=new Od(R.Map,t,h.current)),l.map=jH(C),l.mapLib=R,a(C),r==null||r.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(L=>{const{onError:R}=t;R?R({type:"error",target:null,originalEvent:null,error:L}):console.error(L)}),()=>{P=!1,C&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?C.recycle():C.destroy())}},[]),UH(()=>{i&&i.setProps(t)}),q.useImperativeHandle(e,()=>l.map,[i]);const m=q.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),_={height:"100%"};return q.createElement("div",{id:t.id,ref:h,style:m},i&&q.createElement(H_.Provider,{value:l},q.createElement("div",{"mapboxgl-children":"",style:_},t.children)))}const HH=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Bu(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!HH.test(r)?n[r]=`${i}px`:n[r]=i}}function qH(t,e){const{map:n,mapLib:r}=q.useContext(H_),i=q.useRef({props:t});i.current.props=t;const a=q.useMemo(()=>{let D=!1;q.Children.forEach(t.children,N=>{N&&(D=!0)});const W={...t,element:D?document.createElement("div"):null},z=new r.Marker(W);return z.setLngLat([t.longitude,t.latitude]),z.getElement().addEventListener("click",N=>{var F,$;($=(F=i.current.props).onClick)===null||$===void 0||$.call(F,{type:"click",target:z,originalEvent:N})}),z.on("dragstart",N=>{var F,$;const K=N;K.lngLat=a.getLngLat(),($=(F=i.current.props).onDragStart)===null||$===void 0||$.call(F,K)}),z.on("drag",N=>{var F,$;const K=N;K.lngLat=a.getLngLat(),($=(F=i.current.props).onDrag)===null||$===void 0||$.call(F,K)}),z.on("dragend",N=>{var F,$;const K=N;K.lngLat=a.getLngLat(),($=(F=i.current.props).onDragEnd)===null||$===void 0||$.call(F,K)}),z},[]);q.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:h,latitude:l,offset:m,style:_,draggable:S=!1,popup:P=null,rotation:C=0,rotationAlignment:L="auto",pitchAlignment:R="auto"}=t;return q.useEffect(()=>{Bu(a.getElement(),_)},[_]),q.useImperativeHandle(e,()=>a,[]),(a.getLngLat().lng!==h||a.getLngLat().lat!==l)&&a.setLngLat([h,l]),m&&!RH(a.getOffset(),m)&&a.setOffset(m),a.isDraggable()!==S&&a.setDraggable(S),a.getRotation()!==C&&a.setRotation(C),a.getRotationAlignment()!==L&&a.setRotationAlignment(L),a.getPitchAlignment()!==R&&a.setPitchAlignment(R),a.getPopup()!==P&&a.setPopup(P),Fm.createPortal(t.children,a.getElement())}q.memo(q.forwardRef(qH));function vI(t){return new Set(t?t.trim().split(/\s+/):[])}function ZH(t,e){const{map:n,mapLib:r}=q.useContext(H_),i=q.useMemo(()=>document.createElement("div"),[]),a=q.useRef({props:t});a.current.props=t;const h=q.useMemo(()=>{const l={...t},m=new r.Popup(l);return m.setLngLat([t.longitude,t.latitude]),m.once("open",_=>{var S,P;(P=(S=a.current.props).onOpen)===null||P===void 0||P.call(S,_)}),m},[]);if(q.useEffect(()=>{const l=m=>{var _,S;(S=(_=a.current.props).onClose)===null||S===void 0||S.call(_,m)};return h.on("close",l),h.setDOMContent(i).addTo(n.getMap()),()=>{h.off("close",l),h.isOpen()&&h.remove()}},[]),q.useEffect(()=>{Bu(h.getElement(),t.style)},[t.style]),q.useImperativeHandle(e,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==t.longitude||h.getLngLat().lat!==t.latitude)&&h.setLngLat([t.longitude,t.latitude]),t.offset&&!al(h.options.offset,t.offset)&&h.setOffset(t.offset),(h.options.anchor!==t.anchor||h.options.maxWidth!==t.maxWidth)&&(h.options.anchor=t.anchor,h.setMaxWidth(t.maxWidth)),h.options.className!==t.className)){const l=vI(h.options.className),m=vI(t.className);for(const _ of l)m.has(_)||h.removeClassName(_);for(const _ of m)l.has(_)||h.addClassName(_);h.options.className=t.className}return Fm.createPortal(t.children,i)}q.memo(q.forwardRef(ZH));function Zm(t,e,n,r){const i=q.useContext(H_),a=q.useMemo(()=>t(i),[]);return q.useEffect(()=>{const h=r||n||e,l=typeof e=="function"&&typeof n=="function"?e:null,m=typeof n=="function"?n:typeof e=="function"?e:null,{map:_}=i;return _.hasControl(a)||(_.addControl(a,h==null?void 0:h.position),l&&l(i)),()=>{m&&m(i),_.hasControl(a)&&_.removeControl(a)}},[]),a}function XH(t){const e=Zm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return q.useEffect(()=>{Bu(e._container,t.style)},[t.style]),null}q.memo(XH);function YH(t){const e=Zm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return q.useEffect(()=>{Bu(e._controlContainer,t.style)},[t.style]),null}q.memo(YH);function KH(t,e){const n=q.useRef({props:t}),r=Zm(({mapLib:i})=>{const a=new i.GeolocateControl(t),h=a._setupUI;return a._setupUI=l=>{a._container.hasChildNodes()||h(l)},a.on("geolocate",l=>{var m,_;(_=(m=n.current.props).onGeolocate)===null||_===void 0||_.call(m,l)}),a.on("error",l=>{var m,_;(_=(m=n.current.props).onError)===null||_===void 0||_.call(m,l)}),a.on("outofmaxbounds",l=>{var m,_;(_=(m=n.current.props).onOutOfMaxBounds)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationstart",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationStart)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationend",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationEnd)===null||_===void 0||_.call(m,l)}),a},{position:t.position});return n.current.props=t,q.useImperativeHandle(e,()=>r,[]),q.useEffect(()=>{Bu(r._container,t.style)},[t.style]),null}q.memo(q.forwardRef(KH));function JH(t){const e=Zm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return q.useEffect(()=>{Bu(e._container,t.style)},[t.style]),null}q.memo(JH);function QH(t){const e=Zm(({mapLib:a})=>new a.ScaleControl(t),{position:t.position}),n=q.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),q.useEffect(()=>{Bu(e._container,i)},[i]),null}q.memo(QH);const eq=MH(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),tq=(()=>q.forwardRef(function(e,n){return WH(e,n,eq)}))();var vO={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(b4,function(){var n,r,i;function a(l,m){if(!n)n=m;else if(!r)r=m;else{var _="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",S={};n(S),i=m(S),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}a(["exports"],function(l){function m(c,s,u,f){return new(u||(u=Promise))(function(g,x){function w(M){try{I(f.next(M))}catch(B){x(B)}}function T(M){try{I(f.throw(M))}catch(B){x(B)}}function I(M){var B;M.done?g(M.value):(B=M.value,B instanceof u?B:new u(function(U){U(B)})).then(w,T)}I((f=f.apply(c,s||[])).next())})}function _(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}typeof SuppressedError=="function"&&SuppressedError;var S=P;function P(c,s){this.x=c,this.y=s}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,u=c.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),u=Math.sin(c),f=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,s){var u=Math.cos(c),f=Math.sin(c),g=s.y+f*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-f*(this.y-s.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},P.convert=function(c){return c instanceof P?c:Array.isArray(c)?new P(c[0],c[1]):c};var C=_(S),L=R;function R(c,s,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=u,this.p2y=f}R.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var w=0,T=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<s));f++)c>g?w=u:T=u,u=.5*(T-w)+w;return u},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var D=_(L);let W,z;function N(){return W==null&&(W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),W}function F(){if(z==null&&(z=!1,N())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let f=0;f<5*5;f++){const g=4*f;s.fillStyle=`rgb(${g},${g+1},${g+2})`,s.fillRect(f%5,Math.floor(f/5),1,1)}const u=s.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&u[f]!==f){z=!0;break}}}return z||!1}function $(c,s,u,f){const g=new D(c,s,u,f);return function(x){return g.solve(x)}}const K=$(.25,.1,.25,1);function ne(c,s,u){return Math.min(u,Math.max(s,c))}function se(c,s,u){const f=u-s,g=((c-s)%f+f)%f+s;return g===s?u:g}function xe(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}let Se=1;function _e(c,s,u){const f={};for(const g in c)f[g]=s.call(u||this,c[g],g,c);return f}function Re(c,s,u){const f={};for(const g in c)s.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function De(c){return Array.isArray(c)?c.map(De):typeof c=="object"&&c?_e(c,De):c}const Ve={};function je(c){Ve[c]||(typeof console<"u"&&console.warn(c),Ve[c]=!0)}function We(c,s,u){return(u.y-c.y)*(s.x-c.x)>(s.y-c.y)*(u.x-c.x)}function Ze(c){let s=0;for(let u,f,g=0,x=c.length,w=x-1;g<x;w=g++)u=c[g],f=c[w],s+=(f.x-u.x)*(u.y+f.y);return s}function Ye(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ce=null;function Xe(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Dt(c,s,u,f,g){return m(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x==null?void 0:x.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const T=w.startsWith("BGR"),I=new Uint8ClampedArray(f*g*4);if(yield x.copyTo(I,function(M,B,U,H,Y){const Q=4*Math.max(-B,0),le=(Math.max(0,U)-U)*H*4+Q,me=4*H,ve=Math.max(0,B),ke=Math.max(0,U);return{rect:{x:ve,y:ke,width:Math.min(M.width,B+H)-ve,height:Math.min(M.height,U+Y)-ke},layout:[{offset:le,stride:me}]}}(c,s,u,f,g)),T)for(let M=0;M<I.length;M+=4){const B=I[M];I[M]=I[M+2],I[M+2]=B}return I}finally{x.close()}})}let mt,ht,ot,xt;const bt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const s=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(c,s=0){return this.getImageCanvasContext(c).getImageData(-s,-s,c.width+2*s,c.height+2*s)},getImageCanvasContext(c){const s=window.document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return s.width=c.width,s.height=c.height,u.drawImage(c,0,0,c.width,c.height),u},resolveURL:c=>(ot||(ot=document.createElement("a")),ot.href=c,ot.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(xt==null&&(xt=matchMedia("(prefers-reduced-motion: reduce)")),xt.matches)}},Wt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class nt extends Error{constructor(s,u,f,g){super(`AJAXError: ${u} (${s}): ${f}`),this.status=s,this.statusText=u,this.url=f,this.body=g}}const Et=Ye()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,cn=c=>Wt.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))];function en(c,s){const u=new AbortController,f=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Et(),signal:u.signal});let g=!1,x=!1;return c.type==="json"&&f.headers.set("Accept","application/json"),x||fetch(f).then(w=>w.ok?(T=>{(c.type==="arrayBuffer"||c.type==="image"?T.arrayBuffer():c.type==="json"?T.json():T.text()).then(I=>{x||(g=!0,s(null,I,T.headers.get("Cache-Control"),T.headers.get("Expires")))}).catch(I=>{x||s(new Error(I.message))})})(w):w.blob().then(T=>s(new nt(w.status,w.statusText,c.url,T)))).catch(w=>{w.code!==20&&s(new Error(w.message))}),{cancel:()=>{x=!0,g||u.abort()}}}const mn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s);if(!Ye())return(cn(c.url)||en)(c,s)}if(!(/^file:/.test(u=c.url)||/^file:/.test(Et())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return en(c,s);if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var u;return function(f,g){const x=new XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(x.responseType="arraybuffer");for(const w in f.headers)x.setRequestHeader(w,f.headers[w]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(f.type==="json")try{w=JSON.parse(x.response)}catch(T){return g(T)}g(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else{const w=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new nt(x.status,x.statusText,f.url,w))}},x.send(f.body),{cancel:()=>x.abort()}}(c,s)},Ht=function(c,s){return mn(xe(c,{type:"arrayBuffer"}),s)};function It(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),u=window.location;return s.protocol===u.protocol&&s.host===u.host}function Rt(c,s,u){u[c]&&u[c].indexOf(s)!==-1||(u[c]=u[c]||[],u[c].push(s))}function yn(c,s,u){if(u&&u[c]){const f=u[c].indexOf(s);f!==-1&&u[c].splice(f,1)}}class vn{constructor(s,u={}){xe(this,u),this.type=s}}class ut extends vn{constructor(s,u={}){super("error",xe({error:s},u))}}class un{on(s,u){return this._listeners=this._listeners||{},Rt(s,u,this._listeners),this}off(s,u){return yn(s,u,this._listeners),yn(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Rt(s,u,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,u){typeof s=="string"&&(s=new vn(s,u||{}));const f=s.type;if(this.listens(f)){s.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of g)T.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of x)yn(f,T,this._oneTimeListeners),T.call(this,s);const w=this._eventedParent;w&&(xe(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof ut&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ct=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bn(c,s){const u={};for(const f in c)f!=="ref"&&(u[f]=c[f]);return Ct.forEach(f=>{f in s&&(u[f]=s[f])}),u}function Yt(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let u=0;u<c.length;u++)if(!Yt(c[u],s[u]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const u in c)if(!Yt(c[u],s[u]))return!1;return!0}return c===s}const kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ln(c,s,u){u.push({command:kt.addSource,args:[c,s[c]]})}function Un(c,s,u){s.push({command:kt.removeSource,args:[c]}),u[c]=!0}function zn(c,s,u,f){Un(c,u,f),Ln(c,s,u)}function Qe(c,s,u){let f;for(f in c[u])if(Object.prototype.hasOwnProperty.call(c[u],f)&&f!=="data"&&!Yt(c[u][f],s[u][f]))return!1;for(f in s[u])if(Object.prototype.hasOwnProperty.call(s[u],f)&&f!=="data"&&!Yt(c[u][f],s[u][f]))return!1;return!0}function qe(c,s,u,f,g,x){let w;for(w in s=s||{},c=c||{})Object.prototype.hasOwnProperty.call(c,w)&&(Yt(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}));for(w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&(Yt(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}))}function vt(c){return c.id}function hn(c,s){return c[s.id]=s,c}class $e{constructor(s,u,f,g){this.message=(s?`${s}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function st(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}class qt extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class wn{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(s){return new wn(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const pn={kind:"null"},tt={kind:"number"},tn={kind:"string"},on={kind:"boolean"},Pr={kind:"color"},ci={kind:"object"},an={kind:"value"},Vr={kind:"collator"},he={kind:"formatted"},G={kind:"padding"},Z={kind:"resolvedImage"},ie={kind:"variableAnchorOffsetCollection"};function de(c,s){return{kind:"array",itemType:c,N:s}}function pe(c){if(c.kind==="array"){const s=pe(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const Me=[pn,tt,tn,on,Pr,he,ci,de(an),G,Z,ie];function be(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!be(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const u of Me)if(!be(u,s))return null}}return`Expected ${pe(c)} but found ${pe(s)} instead.`}function ye(c,s){return s.some(u=>u.kind===c.kind)}function Ee(c,s){return s.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}function Ue(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const Ge=.96422,He=.82521,Ot=4/29,Kt=6/29,Pt=3*Kt*Kt,Bt=Kt*Kt*Kt,At=Math.PI/180,dn=180/Math.PI;function kn(c){return(c%=360)<0&&(c+=360),c}function gn([c,s,u,f]){let g,x;const w=nn((.2225045*(c=fn(c))+.7168786*(s=fn(s))+.0606169*(u=fn(u)))/1);c===s&&s===u?g=x=w:(g=nn((.4360747*c+.3850649*s+.1430804*u)/Ge),x=nn((.0139322*c+.0971045*s+.7141733*u)/He));const T=116*w-16;return[T<0?0:T,500*(g-w),200*(w-x),f]}function fn(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function nn(c){return c>Bt?Math.pow(c,1/3):c/Pt+Ot}function _n([c,s,u,f]){let g=(c+16)/116,x=isNaN(s)?g:g+s/500,w=isNaN(u)?g:g-u/200;return g=1*Yr(g),x=Ge*Yr(x),w=He*Yr(w),[pr(3.1338561*x-1.6168667*g-.4906146*w),pr(-.9787684*x+1.9161415*g+.033454*w),pr(.0719453*x-.2289914*g+1.4052427*w),f]}function pr(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function Yr(c){return c>Kt?c*c*c:Pt*(c-Ot)}function $i(c){return parseInt(c.padEnd(2,c),16)/255}function Ba(c,s){return Kr(s?c/100:c,0,1)}function Kr(c,s,u){return Math.min(Math.max(s,c),u)}function cs(c){return!c.some(Number.isNaN)}const po={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Pn{constructor(s,u,f,g=1,x=!0){this.r=s,this.g=u,this.b=f,this.a=g,x||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[s,u,f,g]))}static parse(s){if(s instanceof Pn)return s;if(typeof s!="string")return;const u=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=po[f];if(g){const[w,T,I]=g;return[w/255,T/255,I/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const w=f.length<6?1:2;let T=1;return[$i(f.slice(T,T+=w)),$i(f.slice(T,T+=w)),$i(f.slice(T,T+=w)),$i(f.slice(T,T+w)||"ff")]}if(f.startsWith("rgb")){const w=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[T,I,M,B,U,H,Y,Q,le,me,ve,ke]=w,Te=[B||" ",Y||" ",me].join("");if(Te==="  "||Te==="  /"||Te===",,"||Te===",,,"){const Le=[M,H,le].join(""),ze=Le==="%%%"?100:Le===""?255:0;if(ze){const Je=[Kr(+I/ze,0,1),Kr(+U/ze,0,1),Kr(+Q/ze,0,1),ve?Ba(+ve,ke):1];if(cs(Je))return Je}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,I,M,B,U,H,Y,Q]=x,le=[I||" ",B||" ",H].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const me=[+T,Kr(+M,0,100),Kr(+U,0,100),Y?Ba(+Y,Q):1];if(cs(me))return function([ve,ke,Te,Le]){function ze(Je){const Tt=(Je+ve/30)%12,Nt=ke*Math.min(Te,1-Te);return Te-Nt*Math.max(-1,Math.min(Tt-3,9-Tt,1))}return ve=kn(ve),ke/=100,Te/=100,[ze(0),ze(8),ze(4),Le]}(me)}}}(s);return u?new Pn(...u,!1):void 0}get rgb(){const{r:s,g:u,b:f,a:g}=this,x=g||1/0;return this.overwriteGetter("rgb",[s/x,u/x,f/x,g])}get hcl(){return this.overwriteGetter("hcl",function(s){const[u,f,g,x]=gn(s),w=Math.sqrt(f*f+g*g);return[Math.round(1e4*w)?kn(Math.atan2(g,f)*dn):NaN,w,u,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gn(this.rgb))}overwriteGetter(s,u){return Object.defineProperty(this,s,{value:u}),u}toString(){const[s,u,f,g]=this.rgb;return`rgba(${[s,u,f].map(x=>Math.round(255*x)).join(",")},${g})`}}Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1);class $o{constructor(s,u,f){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ki{constructor(s,u,f,g,x){this.text=s,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class ir{constructor(s){this.sections=s}static fromString(s){return new ir([new ki(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof ir?s:ir.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class bi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof bi)return s;if(typeof s=="number")return new bi([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const u of s)if(typeof u!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new bi(s)}}toString(){return JSON.stringify(this.values)}}const Vu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class di{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof di)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let u=0;u<s.length;u+=2){const f=s[u],g=s[u+1];if(typeof f!="string"||!Vu.has(f)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new di(s)}}toString(){return JSON.stringify(this.values)}}class Zn{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Zn({name:s,available:!1}):null}}function Go(c,s,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,s,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,s,u,f]:[c,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function mo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Pn||c instanceof $o||c instanceof ir||c instanceof bi||c instanceof di||c instanceof Zn)return!0;if(Array.isArray(c)){for(const s of c)if(!mo(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!mo(c[s]))return!1;return!0}return!1}function Jn(c){if(c===null)return pn;if(typeof c=="string")return tn;if(typeof c=="boolean")return on;if(typeof c=="number")return tt;if(c instanceof Pn)return Pr;if(c instanceof $o)return Vr;if(c instanceof ir)return he;if(c instanceof bi)return G;if(c instanceof di)return ie;if(c instanceof Zn)return Z;if(Array.isArray(c)){const s=c.length;let u;for(const f of c){const g=Jn(f);if(u){if(u===g)continue;u=an;break}u=g}return de(u||an,s)}return ci}function Dn(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Pn||c instanceof ir||c instanceof bi||c instanceof di||c instanceof Zn?c.toString():JSON.stringify(c)}class Us{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!mo(s[1]))return u.error("invalid value");const f=s[1];let g=Jn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Us(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Qn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Gi={string:tn,number:tt,boolean:on,object:ci};class Wi{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=s[0];if(x==="array"){let T,I;if(s.length>2){const M=s[1];if(typeof M!="string"||!(M in Gi)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=Gi[M],g++}else T=an;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);I=s[2],g++}f=de(T,I)}else{if(!Gi[x])throw new Error(`Types doesn't contain name = ${x}`);f=Gi[x]}const w=[];for(;g<s.length;g++){const T=u.parse(s[g],g,an);if(!T)return null;w.push(T)}return new Wi(f,w)}evaluate(s){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(s);if(!be(this.type,Jn(f)))return f;if(u===this.args.length-1)throw new Qn(`Expected value to be of type ${pe(this.type)}, but found ${pe(Jn(f))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Pl={"to-boolean":on,"to-color":Pr,"to-number":tt,"to-string":tn};class Cs{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[0];if(!Pl[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&s.length!==2)return u.error("Expected one argument.");const g=Pl[f],x=[];for(let w=1;w<s.length;w++){const T=u.parse(s[w],w,an);if(!T)return null;x.push(T)}return new Cs(g,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let u,f;for(const g of this.args){if(u=g.evaluate(s),f=null,u instanceof Pn)return u;if(typeof u=="string"){const x=s.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Go(u[0],u[1],u[2],u[3]),!f))return new Pn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Qn(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const f of this.args){u=f.evaluate(s);const g=bi.parse(u);if(g)return g}throw new Qn(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const f of this.args){u=f.evaluate(s);const g=di.parse(u);if(g)return g}throw new Qn(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const f of this.args){if(u=f.evaluate(s),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Qn(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return ir.fromString(Dn(this.args[0].evaluate(s)));case"resolvedImage":return Zn.fromString(Dn(this.args[0].evaluate(s)));default:return Dn(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Lc=["Unknown","Point","LineString","Polygon"];class Rc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Pn.parse(s)),u}}class Cl{constructor(s,u,f=[],g,x=new wn,w=[]){this.registry=s,this.path=f,this.key=f.map(T=>`[${T}]`).join(""),this.scope=x,this.errors=w,this.expectedType=g,this._isConstant=u}parse(s,u,f,g,x={}){return u?this.concat(u,f,g)._parse(s,x):this._parse(s,x)}_parse(s,u){function f(g,x,w){return w==="assert"?new Wi(x,[g]):w==="coerce"?new Cs(x,[g]):g}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=s[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const T=this.expectedType,I=w.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||I.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(T.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(T.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(T,I))return null}else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"assert")}if(!(w instanceof Us)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const T=new Rc;try{w=new Us(w.type,w.evaluate(T))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,f){const g=typeof s=="number"?this.path.concat(s):this.path,x=f?this.scope.concat(f):this.scope;return new Cl(this.registry,this._isConstant,g,u||null,x,this.errors)}error(s,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new qt(f,s))}checkSubtype(s,u){const f=be(s,u);return f&&this.error(f),f}}class ee{constructor(s,u,f){this.type=Vr,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,on);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,on);if(!x)return null;let w=null;return f.locale&&(w=u.parse(f.locale,1,tn),!w)?null:new ee(g,x,w)}evaluate(s){return new $o(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const oe=8192;function we(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Ne(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function at(c,s){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,s.z);return[Math.round(u*g*oe),Math.round(f*g*oe)]}function zt(c,s,u){const f=c[0]-s[0],g=c[1]-s[1],x=c[0]-u[0],w=c[1]-u[1];return f*w-x*g==0&&f*x<=0&&g*w<=0}function Tn(c,s){let u=!1;for(let w=0,T=s.length;w<T;w++){const I=s[w];for(let M=0,B=I.length;M<B-1;M++){if(zt(c,I[M],I[M+1]))return!1;(g=I[M])[1]>(f=c)[1]!=(x=I[M+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function Cr(c,s){for(let u=0;u<s.length;u++)if(Tn(c,s[u]))return!0;return!1}function Ur(c,s,u,f){const g=f[0]-u[0],x=f[1]-u[1],w=(c[0]-u[0])*x-g*(c[1]-u[1]),T=(s[0]-u[0])*x-g*(s[1]-u[1]);return w>0&&T<0||w<0&&T>0}function fi(c,s,u){for(const M of u)for(let B=0;B<M.length-1;++B)if((T=[(w=M[B+1])[0]-(x=M[B])[0],w[1]-x[1]])[0]*(I=[(g=s)[0]-(f=c)[0],g[1]-f[1]])[1]-T[1]*I[0]!=0&&Ur(f,g,x,w)&&Ur(x,w,f,g))return!0;var f,g,x,w,T,I;return!1}function us(c,s){for(let u=0;u<c.length;++u)if(!Tn(c[u],s))return!1;for(let u=0;u<c.length-1;++u)if(fi(c[u],c[u+1],s))return!1;return!0}function sg(c,s){for(let u=0;u<s.length;u++)if(us(c,s[u]))return!0;return!1}function Uu(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=[];for(let w=0;w<c[g].length;w++){const T=at(c[g][w],u);we(s,T),x.push(T)}f.push(x)}return f}function og(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=Uu(c[g],s,u);f.push(x)}return f}function ag(c,s,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let x=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;x===0&&(x=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=x}we(s,c)}function Qd(c,s,u,f){const g=Math.pow(2,f.z)*oe,x=[f.x*oe,f.y*oe],w=[];for(const T of c)for(const I of T){const M=[I.x+x[0],I.y+x[1]];ag(M,s,u,g),w.push(M)}return w}function ef(c,s,u,f){const g=Math.pow(2,f.z)*oe,x=[f.x*oe,f.y*oe],w=[];for(const I of c){const M=[];for(const B of I){const U=[B.x+x[0],B.y+x[1]];we(s,U),M.push(U)}w.push(M)}if(s[2]-s[0]<=g/2){(T=s)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const I of w)for(const M of I)ag(M,s,u,g)}var T;return w}class ja{constructor(s,u){this.type=on,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(mo(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new ja(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new ja(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new ja(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=Uu(f.coordinates,x,w),I=Qd(u.geometry(),g,x,w);if(!Ne(g,x))return!1;for(const M of I)if(!Tn(M,T))return!1}if(f.type==="MultiPolygon"){const T=og(f.coordinates,x,w),I=Qd(u.geometry(),g,x,w);if(!Ne(g,x))return!1;for(const M of I)if(!Cr(M,T))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=Uu(f.coordinates,x,w),I=ef(u.geometry(),g,x,w);if(!Ne(g,x))return!1;for(const M of I)if(!us(M,T))return!1}if(f.type==="MultiPolygon"){const T=og(f.coordinates,x,w),I=ef(u.geometry(),g,x,w);if(!Ne(g,x))return!1;for(const M of I)if(!sg(M,T))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class $u{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=s[1];return u.scope.has(f)?new $u(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class As{constructor(s,u,f,g){this.name=s,this.type=u,this._evaluate=f,this.args=g}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,u){const f=s[0],g=As.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=w.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let I=null;for(const[M,B]of T){I=new Cl(u.registry,Gu,u.path,null,u.scope);const U=[];let H=!1;for(let Y=1;Y<s.length;Y++){const Q=s[Y],le=Array.isArray(M)?M[Y-1]:M.type,me=I.parse(Q,1+U.length,le);if(!me){H=!0;break}U.push(me)}if(!H)if(Array.isArray(M)&&M.length!==U.length)I.error(`Expected ${M.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const Q=Array.isArray(M)?M[Y]:M.type,le=U[Y];I.concat(Y+1).checkSubtype(Q,le.type)}if(I.errors.length===0)return new As(f,x,B,U)}}if(T.length===1)u.errors.push(...I.errors);else{const M=(T.length?T:w).map(([U])=>{return H=U,Array.isArray(H)?`(${H.map(pe).join(", ")})`:`(${pe(H.type)}...)`;var H}).join(" | "),B=[];for(let U=1;U<s.length;U++){const H=u.parse(s[U],1+B.length);if(!H)return null;B.push(pe(H.type))}u.error(`Expected arguments of type ${M}, but found (${B.join(", ")}) instead.`)}return null}static register(s,u){As.definitions=u;for(const f in u)s[f]=As}}function Gu(c){if(c instanceof $u)return Gu(c.boundExpression);if(c instanceof As&&c.name==="error"||c instanceof ee||c instanceof ja)return!1;const s=c instanceof Cs||c instanceof Wi;let u=!0;return c.eachChild(f=>{u=s?u&&Gu(f):u&&f instanceof Us}),!!u&&Wu(c)&&Hu(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Wu(c){if(c instanceof As&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof ja)return!1;let s=!0;return c.eachChild(u=>{s&&!Wu(u)&&(s=!1)}),s}function Oc(c){if(c instanceof As&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(u=>{s&&!Oc(u)&&(s=!1)}),s}function Hu(c,s){if(c instanceof As&&s.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!Hu(f,s)&&(u=!1)}),u}function Al(c,s){const u=c.length-1;let f,g,x=0,w=u,T=0;for(;x<=w;)if(T=Math.floor((x+w)/2),f=c[T],g=c[T+1],f<=s){if(T===u||s<g)return T;x=T+1}else{if(!(f>s))throw new Qn("Input is not a number.");w=T-1}return 0}class pa{constructor(s,u,f){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(s[1],1,tt);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let w=1;w<s.length;w+=2){const T=w===1?-1/0:s[w],I=s[w+1],M=w,B=w+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const U=u.parse(I,B,x);if(!U)return null;x=x||U.type,g.push([T,U])}return new pa(x,f,g)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(s):f[Al(u,g)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Rn(c,s,u){return c+u*(s-c)}function qu(c,s,u){return c.map((f,g)=>Rn(f,s[g],u))}const hs={number:Rn,color:function(c,s,u,f="rgb"){switch(f){case"rgb":{const[g,x,w,T]=qu(c.rgb,s.rgb,u);return new Pn(g,x,w,T,!1)}case"hcl":{const[g,x,w,T]=c.hcl,[I,M,B,U]=s.hcl;let H,Y;if(isNaN(g)||isNaN(I))isNaN(g)?isNaN(I)?H=NaN:(H=I,w!==1&&w!==0||(Y=M)):(H=g,B!==1&&B!==0||(Y=x));else{let ke=I-g;I>g&&ke>180?ke-=360:I<g&&g-I>180&&(ke+=360),H=g+u*ke}const[Q,le,me,ve]=function([ke,Te,Le,ze]){return ke=isNaN(ke)?0:ke*At,_n([Le,Math.cos(ke)*Te,Math.sin(ke)*Te,ze])}([H,Y??Rn(x,M,u),Rn(w,B,u),Rn(T,U,u)]);return new Pn(Q,le,me,ve,!1)}case"lab":{const[g,x,w,T]=_n(qu(c.lab,s.lab,u));return new Pn(g,x,w,T,!1)}}},array:qu,padding:function(c,s,u){return new bi(qu(c.values,s.values,u))},variableAnchorOffsetCollection:function(c,s,u){const f=c.values,g=s.values;if(f.length!==g.length)throw new Qn(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${s.toString()}`);const x=[];for(let w=0;w<f.length;w+=2){if(f[w]!==g[w])throw new Qn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${g[w]}`);x.push(f[w]);const[T,I]=f[w+1],[M,B]=g[w+1];x.push([Rn(T,M,u),Rn(I,B,u)])}return new di(x)}};class ds{constructor(s,u,f,g,x){this.type=s,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[w,T]of x)this.labels.push(w),this.outputs.push(T)}static interpolationFactor(s,u,f,g){let x=0;if(s.name==="exponential")x=tf(u,s.base,f,g);else if(s.name==="linear")x=tf(u,1,f,g);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new D(w[0],w[1],w[2],w[3]).solve(tf(u,1,f,g))}return x}static parse(s,u){let[f,g,x,...w]=s;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some(B=>typeof B!="number"||B<0||B>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,tt),!x)return null;const T=[];let I=null;f==="interpolate-hcl"||f==="interpolate-lab"?I=Pr:u.expectedType&&u.expectedType.kind!=="value"&&(I=u.expectedType);for(let M=0;M<w.length;M+=2){const B=w[M],U=w[M+1],H=M+3,Y=M+4;if(typeof B!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(T.length&&T[T.length-1][0]>=B)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const Q=u.parse(U,Y,I);if(!Q)return null;I=I||Q.type,T.push([B,Q])}return Ue(I,tt)||Ue(I,Pr)||Ue(I,G)||Ue(I,ie)||Ue(I,de(tt))?new ds(I,f,g,x,T):u.error(`Type ${pe(I)} is not interpolatable.`)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(s);const w=Al(u,g),T=ds.interpolationFactor(this.interpolation,g,u[w],u[w+1]),I=f[w].evaluate(s),M=f[w+1].evaluate(s);switch(this.operator){case"interpolate":return hs[this.type.kind](I,M,T);case"interpolate-hcl":return hs.color(I,M,T,"hcl");case"interpolate-lab":return hs.color(I,M,T,"lab")}}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function tf(c,s,u,f){const g=f-u,x=c-u;return g===0?0:s===1?x/g:(Math.pow(s,x)-1)/(Math.pow(s,g)-1)}class Zu{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const T of s.slice(1)){const I=u.parse(T,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!I)return null;f=f||I.type,x.push(I)}if(!f)throw new Error("No output type");const w=g&&x.some(T=>be(g,T.type));return new Zu(w?an:f,x)}evaluate(s){let u,f=null,g=0;for(const x of this.args)if(g++,f=x.evaluate(s),f&&f instanceof Zn&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class Xu{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return u.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const T=u.parse(s[x+1],x+1);if(!T)return null;f.push([w,T])}const g=u.parse(s[s.length-1],s.length-1,u.expectedType,f);return g?new Xu(f,g):null}outputDefined(){return this.result.outputDefined()}}class nf{constructor(s,u,f){this.type=s,this.index=u,this.input=f}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,tt),g=u.parse(s[2],2,de(u.expectedType||an));return f&&g?new nf(g.type.itemType,f,g):null}evaluate(s){const u=this.index.evaluate(s),f=this.input.evaluate(s);if(u<0)throw new Qn(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Qn(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Qn(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class rf{constructor(s,u){this.type=on,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,an),g=u.parse(s[2],2,an);return f&&g?ye(f.type,[on,tn,tt,pn,an])?new rf(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pe(f.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!f)return!1;if(!Ee(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${pe(Jn(u))} instead.`);if(!Ee(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${pe(Jn(f))} instead.`);return f.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Yu{constructor(s,u,f){this.type=tt,this.needle=s,this.haystack=u,this.fromIndex=f}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,an),g=u.parse(s[2],2,an);if(!f||!g)return null;if(!ye(f.type,[on,tn,tt,pn,an]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pe(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,tt);return x?new Yu(f,g,x):null}return new Yu(f,g)}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!Ee(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${pe(Jn(u))} instead.`);if(!Ee(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${pe(Jn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(s);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class sf{constructor(s,u,f,g,x,w){this.inputType=s,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=w}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},w=[];for(let M=2;M<s.length-1;M+=2){let B=s[M];const U=s[M+1];Array.isArray(B)||(B=[B]);const H=u.concat(M);if(B.length===0)return H.error("Expected at least one branch label.");for(const Q of B){if(typeof Q!="number"&&typeof Q!="string")return H.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return H.error("Numeric branch labels must be integer values.");if(f){if(H.checkSubtype(f,Jn(Q)))return null}else f=Jn(Q);if(x[String(Q)]!==void 0)return H.error("Branch labels must be unique.");x[String(Q)]=w.length}const Y=u.parse(U,M,g);if(!Y)return null;g=g||Y.type,w.push(Y)}const T=u.parse(s[1],1,an);if(!T)return null;const I=u.parse(s[s.length-1],s.length-1,g);return I?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new sf(f,g,T,x,w,I):null}evaluate(s){const u=this.input.evaluate(s);return(Jn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class of{constructor(s,u,f){this.type=s,this.branches=u,this.otherwise=f}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let w=1;w<s.length-1;w+=2){const T=u.parse(s[w],w,on);if(!T)return null;const I=u.parse(s[w+1],w+1,f);if(!I)return null;g.push([T,I]),f=f||I.type}const x=u.parse(s[s.length-1],s.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new of(f,g,x)}evaluate(s){for(const[u,f]of this.branches)if(u.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,f]of this.branches)s(u),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Ku{constructor(s,u,f,g){this.type=s,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,an),g=u.parse(s[2],2,tt);if(!f||!g)return null;if(!ye(f.type,[de(an),tn,an]))return u.error(`Expected first argument to be of type array or string, but found ${pe(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,tt);return x?new Ku(f.type,f,g,x):null}return new Ku(f.type,f,g)}evaluate(s){const u=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!Ee(u,["string","array"]))throw new Qn(`Expected first argument to be of type array or string, but found ${pe(Jn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(s);return u.slice(f,g)}return u.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function lg(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function cg(c,s,u,f){return f.compare(s,u)===0}function Il(c,s,u){const f=c!=="=="&&c!=="!=";return class xO{constructor(x,w,T){this.type=on,this.lhs=x,this.rhs=w,this.collator=T,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const T=x[0];let I=w.parse(x[1],1,an);if(!I)return null;if(!lg(T,I.type))return w.concat(1).error(`"${T}" comparisons are not supported for type '${pe(I.type)}'.`);let M=w.parse(x[2],2,an);if(!M)return null;if(!lg(T,M.type))return w.concat(2).error(`"${T}" comparisons are not supported for type '${pe(M.type)}'.`);if(I.type.kind!==M.type.kind&&I.type.kind!=="value"&&M.type.kind!=="value")return w.error(`Cannot compare types '${pe(I.type)}' and '${pe(M.type)}'.`);f&&(I.type.kind==="value"&&M.type.kind!=="value"?I=new Wi(M.type,[I]):I.type.kind!=="value"&&M.type.kind==="value"&&(M=new Wi(I.type,[M])));let B=null;if(x.length===4){if(I.type.kind!=="string"&&M.type.kind!=="string"&&I.type.kind!=="value"&&M.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(B=w.parse(x[3],3,Vr),!B)return null}return new xO(I,M,B)}evaluate(x){const w=this.lhs.evaluate(x),T=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const I=Jn(w),M=Jn(T);if(I.kind!==M.kind||I.kind!=="string"&&I.kind!=="number")throw new Qn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const I=Jn(w),M=Jn(T);if(I.kind!=="string"||M.kind!=="string")return s(x,w,T)}return this.collator?u(x,w,T,this.collator.evaluate(x)):s(x,w,T)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const jv=Il("==",function(c,s,u){return s===u},cg),Vv=Il("!=",function(c,s,u){return s!==u},function(c,s,u,f){return!cg(0,s,u,f)}),Uv=Il("<",function(c,s,u){return s<u},function(c,s,u,f){return f.compare(s,u)<0}),$v=Il(">",function(c,s,u){return s>u},function(c,s,u,f){return f.compare(s,u)>0}),Gv=Il("<=",function(c,s,u){return s<=u},function(c,s,u,f){return f.compare(s,u)<=0}),Wv=Il(">=",function(c,s,u){return s>=u},function(c,s,u,f){return f.compare(s,u)>=0});class af{constructor(s,u,f,g,x){this.type=tn,this.number=s,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const f=u.parse(s[1],1,tt);if(!f)return null;const g=s[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,tn),!x))return null;let w=null;if(g.currency&&(w=u.parse(g.currency,1,tn),!w))return null;let T=null;if(g["min-fraction-digits"]&&(T=u.parse(g["min-fraction-digits"],1,tt),!T))return null;let I=null;return g["max-fraction-digits"]&&(I=u.parse(g["max-fraction-digits"],1,tt),!I)?null:new af(f,x,w,T,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Ju{constructor(s){this.type=he,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let w=1;w<=s.length-1;++w){const T=s[w];if(x&&typeof T=="object"&&!Array.isArray(T)){x=!1;let I=null;if(T["font-scale"]&&(I=u.parse(T["font-scale"],1,tt),!I))return null;let M=null;if(T["text-font"]&&(M=u.parse(T["text-font"],1,de(tn)),!M))return null;let B=null;if(T["text-color"]&&(B=u.parse(T["text-color"],1,Pr),!B))return null;const U=g[g.length-1];U.scale=I,U.font=M,U.textColor=B}else{const I=u.parse(s[w],1,an);if(!I)return null;const M=I.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new Ju(g)}evaluate(s){return new ir(this.sections.map(u=>{const f=u.content.evaluate(s);return Jn(f)===Z?new ki("",f,null,null,null):new ki(Dn(f),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}}class lf{constructor(s){this.type=Z,this.input=s}static parse(s,u){if(s.length!==2)return u.error("Expected two arguments.");const f=u.parse(s[1],1,tn);return f?new lf(f):u.error("No image name provided.")}evaluate(s){const u=this.input.evaluate(s),f=Zn.fromString(u);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(u)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}}class cf{constructor(s){this.type=tt,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=u.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${pe(f.type)} instead.`):new cf(f):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Qn(`Expected value to be of type string or array, but found ${pe(Jn(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const kl={"==":jv,"!=":Vv,">":$v,"<":Uv,">=":Wv,"<=":Gv,array:Wi,at:nf,boolean:Wi,case:of,coalesce:Zu,collator:ee,format:Ju,image:lf,in:rf,"index-of":Yu,interpolate:ds,"interpolate-hcl":ds,"interpolate-lab":ds,length:cf,let:Xu,literal:Us,match:sf,number:Wi,"number-format":af,object:Wi,slice:Ku,step:pa,string:Wi,"to-boolean":Cs,"to-color":Cs,"to-number":Cs,"to-string":Cs,var:$u,within:ja};function ug(c,[s,u,f,g]){s=s.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const x=g?g.evaluate(c):1,w=Go(s,u,f,x);if(w)throw new Qn(w);return new Pn(s/255,u/255,f/255,x,!1)}function hg(c,s){return c in s}function uf(c,s){const u=s[c];return u===void 0?null:u}function Va(c){return{type:c}}function dg(c){return{result:"success",value:c}}function ma(c){return{result:"error",value:c}}function Ml(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function fg(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function hf(c){return!!c.expression&&c.expression.interpolated}function $n(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function mr(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Hv(c){return c}function On(c,s){const u=s.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),x=c.type||(hf(s)?"exponential":"interval");if(u||s.type==="padding"){const B=u?Pn.parse:bi.parse;(c=st({},c)).stops&&(c.stops=c.stops.map(U=>[U[0],B(U[1])])),c.default=B(c.default?c.default:s.default)}if(c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;let T,I,M;if(x==="exponential")T=zc;else if(x==="interval")T=dr;else if(x==="categorical"){T=gr,I=Object.create(null);for(const B of c.stops)I[B[0]]=B[1];M=typeof c.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);T=pg}if(f){const B={},U=[];for(let Q=0;Q<c.stops.length;Q++){const le=c.stops[Q],me=le[0].zoom;B[me]===void 0&&(B[me]={zoom:me,type:c.type,property:c.property,default:c.default,stops:[]},U.push(me)),B[me].stops.push([le[0].value,le[1]])}const H=[];for(const Q of U)H.push([B[Q].zoom,On(B[Q],s)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:ds.interpolationFactor.bind(void 0,Y),zoomStops:H.map(Q=>Q[0]),evaluate:({zoom:Q},le)=>zc({stops:H,base:c.base},s,Q).evaluate(Q,le)}}if(g){const B=x==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:ds.interpolationFactor.bind(void 0,B),zoomStops:c.stops.map(U=>U[0]),evaluate:({zoom:U})=>T(c,s,U,I,M)}}return{kind:"source",evaluate(B,U){const H=U&&U.properties?U.properties[c.property]:void 0;return H===void 0?Ua(c.default,s.default):T(c,s,H,I,M)}}}function Ua(c,s,u){return c!==void 0?c:s!==void 0?s:u!==void 0?u:void 0}function gr(c,s,u,f,g){return Ua(typeof u===g?f[u]:void 0,c.default,s.default)}function dr(c,s,u){if($n(u)!=="number")return Ua(c.default,s.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Al(c.stops.map(x=>x[0]),u);return c.stops[g][1]}function zc(c,s,u){const f=c.base!==void 0?c.base:1;if($n(u)!=="number")return Ua(c.default,s.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const x=Al(c.stops.map(B=>B[0]),u),w=function(B,U,H,Y){const Q=Y-H,le=B-H;return Q===0?0:U===1?le/Q:(Math.pow(U,le)-1)/(Math.pow(U,Q)-1)}(u,f,c.stops[x][0],c.stops[x+1][0]),T=c.stops[x][1],I=c.stops[x+1][1],M=hs[s.type]||Hv;return typeof T.evaluate=="function"?{evaluate(...B){const U=T.evaluate.apply(void 0,B),H=I.evaluate.apply(void 0,B);if(U!==void 0&&H!==void 0)return M(U,H,w,c.colorSpace)}}:M(T,I,w,c.colorSpace)}function pg(c,s,u){switch(s.type){case"color":u=Pn.parse(u);break;case"formatted":u=ir.fromString(u.toString());break;case"resolvedImage":u=Zn.fromString(u.toString());break;case"padding":u=bi.parse(u);break;default:$n(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0)}return Ua(u,c.default,s.default)}As.register(kl,{error:[{kind:"error"},[tn],(c,[s])=>{throw new Qn(s.evaluate(c))}],typeof:[tn,[an],(c,[s])=>pe(Jn(s.evaluate(c)))],"to-rgba":[de(tt,4),[Pr],(c,[s])=>{const[u,f,g,x]=s.evaluate(c).rgb;return[255*u,255*f,255*g,x]}],rgb:[Pr,[tt,tt,tt],ug],rgba:[Pr,[tt,tt,tt,tt],ug],has:{type:on,overloads:[[[tn],(c,[s])=>hg(s.evaluate(c),c.properties())],[[tn,ci],(c,[s,u])=>hg(s.evaluate(c),u.evaluate(c))]]},get:{type:an,overloads:[[[tn],(c,[s])=>uf(s.evaluate(c),c.properties())],[[tn,ci],(c,[s,u])=>uf(s.evaluate(c),u.evaluate(c))]]},"feature-state":[an,[tn],(c,[s])=>uf(s.evaluate(c),c.featureState||{})],properties:[ci,[],c=>c.properties()],"geometry-type":[tn,[],c=>c.geometryType()],id:[an,[],c=>c.id()],zoom:[tt,[],c=>c.globals.zoom],"heatmap-density":[tt,[],c=>c.globals.heatmapDensity||0],"line-progress":[tt,[],c=>c.globals.lineProgress||0],accumulated:[an,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[tt,Va(tt),(c,s)=>{let u=0;for(const f of s)u+=f.evaluate(c);return u}],"*":[tt,Va(tt),(c,s)=>{let u=1;for(const f of s)u*=f.evaluate(c);return u}],"-":{type:tt,overloads:[[[tt,tt],(c,[s,u])=>s.evaluate(c)-u.evaluate(c)],[[tt],(c,[s])=>-s.evaluate(c)]]},"/":[tt,[tt,tt],(c,[s,u])=>s.evaluate(c)/u.evaluate(c)],"%":[tt,[tt,tt],(c,[s,u])=>s.evaluate(c)%u.evaluate(c)],ln2:[tt,[],()=>Math.LN2],pi:[tt,[],()=>Math.PI],e:[tt,[],()=>Math.E],"^":[tt,[tt,tt],(c,[s,u])=>Math.pow(s.evaluate(c),u.evaluate(c))],sqrt:[tt,[tt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[tt,[tt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[tt,[tt],(c,[s])=>Math.log(s.evaluate(c))],log2:[tt,[tt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[tt,[tt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[tt,[tt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[tt,[tt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[tt,[tt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[tt,[tt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[tt,[tt],(c,[s])=>Math.atan(s.evaluate(c))],min:[tt,Va(tt),(c,s)=>Math.min(...s.map(u=>u.evaluate(c)))],max:[tt,Va(tt),(c,s)=>Math.max(...s.map(u=>u.evaluate(c)))],abs:[tt,[tt],(c,[s])=>Math.abs(s.evaluate(c))],round:[tt,[tt],(c,[s])=>{const u=s.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[tt,[tt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[tt,[tt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[on,[tn,an],(c,[s,u])=>c.properties()[s.value]===u.value],"filter-id-==":[on,[an],(c,[s])=>c.id()===s.value],"filter-type-==":[on,[tn],(c,[s])=>c.geometryType()===s.value],"filter-<":[on,[tn,an],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[on,[an],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<f}],"filter->":[on,[tn,an],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[on,[an],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>f}],"filter-<=":[on,[tn,an],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[on,[an],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<=f}],"filter->=":[on,[tn,an],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[on,[an],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>=f}],"filter-has":[on,[an],(c,[s])=>s.value in c.properties()],"filter-has-id":[on,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[on,[de(tn)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[on,[de(an)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[on,[tn,de(an)],(c,[s,u])=>u.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[on,[tn,de(an)],(c,[s,u])=>function(f,g,x,w){for(;x<=w;){const T=x+w>>1;if(g[T]===f)return!0;g[T]>f?w=T-1:x=T+1}return!1}(c.properties()[s.value],u.value,0,u.value.length-1)],all:{type:on,overloads:[[[on,on],(c,[s,u])=>s.evaluate(c)&&u.evaluate(c)],[Va(on),(c,s)=>{for(const u of s)if(!u.evaluate(c))return!1;return!0}]]},any:{type:on,overloads:[[[on,on],(c,[s,u])=>s.evaluate(c)||u.evaluate(c)],[Va(on),(c,s)=>{for(const u of s)if(u.evaluate(c))return!0;return!1}]]},"!":[on,[on],(c,[s])=>!s.evaluate(c)],"is-supported-script":[on,[tn],(c,[s])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(s.evaluate(c))}],upcase:[tn,[tn],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[tn,[tn],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[tn,Va(an),(c,s)=>s.map(u=>Dn(u.evaluate(c))).join("")],"resolved-locale":[tn,[Vr],(c,[s])=>s.evaluate(c).resolvedLocale()]});class df{constructor(s,u){var f;this.expression=s,this._warningHistory={},this._evaluator=new Rc,this._defaultValue=u?(f=u).type==="color"&&mr(f.default)?new Pn(0,0,0,0):f.type==="color"?Pn.parse(f.default)||null:f.type==="padding"?bi.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?di.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,u,f,g,x,w){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Qu(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in kl}function eh(c,s){const u=new Cl(kl,Gu,[],s?function(g){const x={color:Pr,string:tn,number:tt,enum:tn,boolean:on,formatted:he,padding:G,resolvedImage:Z,variableAnchorOffsetCollection:ie};return g.type==="array"?de(x[g.value]||an,g.length):x[g.type]}(s):void 0),f=u.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?dg(new df(f,s)):ma(u.errors)}class ff{constructor(s,u){this.kind=s,this._styleExpression=u,this.isStateDependent=s!=="constant"&&!Oc(u.expression)}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}}class th{constructor(s,u,f,g){this.kind=s,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!Oc(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}interpolationFactor(s,u,f){return this.interpolationType?ds.interpolationFactor(this.interpolationType,s,u,f):0}}function pf(c,s){const u=eh(c,s);if(u.result==="error")return u;const f=u.value.expression,g=Wu(f);if(!g&&!Ml(s))return ma([new qt("","data expressions not supported")]);const x=Hu(f,["zoom"]);if(!x&&!fg(s))return ma([new qt("","zoom expressions not supported")]);const w=Fc(f);return w||x?w instanceof qt?ma([w]):w instanceof ds&&!hf(s)?ma([new qt("",'"interpolate" expressions cannot be used with this property')]):dg(w?new th(g?"camera":"composite",u.value,w.labels,w instanceof ds?w.interpolation:void 0):new ff(g?"constant":"source",u.value)):ma([new qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Dc{constructor(s,u){this._parameters=s,this._specification=u,st(this,On(this._parameters,this._specification))}static deserialize(s){return new Dc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Fc(c){let s=null;if(c instanceof Xu)s=Fc(c.result);else if(c instanceof Zu){for(const u of c.args)if(s=Fc(u),s)break}else(c instanceof pa||c instanceof ds)&&c.input instanceof As&&c.input.name==="zoom"&&(s=c);return s instanceof qt||c.eachChild(u=>{const f=Fc(u);f instanceof qt?s=f:!s&&f?s=new qt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new qt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function Nc(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!Nc(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const qv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function mf(c){if(c==null)return{filter:()=>!0,needGeometry:!1};Nc(c)||(c=nh(c));const s=eh(c,qv);if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,f,g)=>s.value.evaluate(u,f,{},g),needGeometry:mg(c)}}function Zv(c,s){return c<s?-1:c>s?1:0}function mg(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(mg(c[s]))return!0;return!1}function nh(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?gf(c[1],c[2],"=="):s==="!="?Bc(gf(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?gf(c[1],c[2],s):s==="any"?(u=c.slice(1),["any"].concat(u.map(nh))):s==="all"?["all"].concat(c.slice(1).map(nh)):s==="none"?["all"].concat(c.slice(1).map(nh).map(Bc)):s==="in"?gg(c[1],c.slice(2)):s==="!in"?Bc(gg(c[1],c.slice(2))):s==="has"?yg(c[1]):s==="!has"?Bc(yg(c[1])):s!=="within"||c;var u}function gf(c,s,u){switch(c){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,c,s]}}function gg(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",c,["literal",s.sort(Zv)]]:["filter-in-small",c,["literal",s]]}}function yg(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Bc(c){return["!",c]}function rh(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let g="[";for(const x of c)g+=`${rh(x)},`;return`${g}]`}const u=Object.keys(c).sort();let f="{";for(let g=0;g<u.length;g++)f+=`${JSON.stringify(u[g])}:${rh(c[u[g]])},`;return`${f}}`}function ih(c){let s="";for(const u of Ct)s+=`/${rh(c[u])}`;return s}function _g(c){const s=c.value;return s?[new $e(c.key,s,"constants have been deprecated as of v8")]:[]}function xr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function $a(c){if(Array.isArray(c))return c.map($a);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const u in c)s[u]=$a(c[u]);return s}return xr(c)}function Hi(c){const s=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},x=c.style,w=c.styleSpec,T=c.validateSpec;let I=[];const M=$n(u);if(M!=="object")return[new $e(s,u,`object expected, ${M} found`)];for(const B in u){const U=B.split(".")[0],H=f[U]||f["*"];let Y;if(g[U])Y=g[U];else if(f[U])Y=T;else if(g["*"])Y=g["*"];else{if(!f["*"]){I.push(new $e(s,u[B],`unknown property "${B}"`));continue}Y=T}I=I.concat(Y({key:(s&&`${s}.`)+B,value:u[B],valueSpec:H,style:x,styleSpec:w,object:u,objectKey:B,validateSpec:T},u))}for(const B in f)g[B]||f[B].required&&f[B].default===void 0&&u[B]===void 0&&I.push(new $e(s,u,`missing required property "${B}"`));return I}function Ll(c){const s=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if($n(s)!=="array")return[new $e(x,s,`array expected, ${$n(s)} found`)];if(u.length&&s.length!==u.length)return[new $e(x,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new $e(x,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let T={type:u.value,values:u.values};g.$version<7&&(T.function=u.function),$n(u.value)==="object"&&(T=u.value);let I=[];for(let M=0;M<s.length;M++)I=I.concat(w({array:s,arrayIndex:M,value:s[M],valueSpec:T,validateSpec:c.validateSpec,style:f,styleSpec:g,key:`${x}[${M}]`}));return I}function jc(c){const s=c.key,u=c.value,f=c.valueSpec;let g=$n(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new $e(s,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new $e(s,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new $e(s,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function sh(c){const s=c.valueSpec,u=xr(c.value.type);let f,g,x,w={};const T=u!=="categorical"&&c.value.property===void 0,I=!T,M=$n(c.value.stops)==="array"&&$n(c.value.stops[0])==="array"&&$n(c.value.stops[0][0])==="object",B=Hi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new $e(Y.key,Y.value,'identity function may not have a "stops" property')];let Q=[];const le=Y.value;return Q=Q.concat(Ll({key:Y.key,value:le,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:U})),$n(le)==="array"&&le.length===0&&Q.push(new $e(Y.key,le,"array must have at least one stop")),Q},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&T&&B.push(new $e(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||B.push(new $e(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!hf(c.valueSpec)&&B.push(new $e(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Ml(c.valueSpec)?B.push(new $e(c.key,c.value,"property functions not supported")):T&&!fg(c.valueSpec)&&B.push(new $e(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!M||c.value.property!==void 0||B.push(new $e(c.key,c.value,'"property" property is required')),B;function U(Y){let Q=[];const le=Y.value,me=Y.key;if($n(le)!=="array")return[new $e(me,le,`array expected, ${$n(le)} found`)];if(le.length!==2)return[new $e(me,le,`array length 2 expected, length ${le.length} found`)];if(M){if($n(le[0])!=="object")return[new $e(me,le,`object expected, ${$n(le[0])} found`)];if(le[0].zoom===void 0)return[new $e(me,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new $e(me,le,"object stop key must have value")];if(x&&x>xr(le[0].zoom))return[new $e(me,le[0].zoom,"stop zoom values must appear in ascending order")];xr(le[0].zoom)!==x&&(x=xr(le[0].zoom),g=void 0,w={}),Q=Q.concat(Hi({key:`${me}[0]`,value:le[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:jc,value:H}}))}else Q=Q.concat(H({key:`${me}[0]`,value:le[0],valueSpec:{},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},le));return Qu($a(le[1]))?Q.concat([new $e(`${me}[1]`,le[1],"expressions are not allowed in function stops.")]):Q.concat(Y.validateSpec({key:`${me}[1]`,value:le[1],valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function H(Y,Q){const le=$n(Y.value),me=xr(Y.value),ve=Y.value!==null?Y.value:Q;if(f){if(le!==f)return[new $e(Y.key,ve,`${le} stop domain type must match previous stop domain type ${f}`)]}else f=le;if(le!=="number"&&le!=="string"&&le!=="boolean")return[new $e(Y.key,ve,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&u!=="categorical"){let ke=`number expected, ${le} found`;return Ml(s)&&u===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(Y.key,ve,ke)]}return u!=="categorical"||le!=="number"||isFinite(me)&&Math.floor(me)===me?u!=="categorical"&&le==="number"&&g!==void 0&&me<g?[new $e(Y.key,ve,"stop domain values must appear in ascending order")]:(g=me,u==="categorical"&&me in w?[new $e(Y.key,ve,"stop domain values must be unique")]:(w[me]=!0,[])):[new $e(Y.key,ve,`integer expected, found ${me}`)]}}function Ga(c){const s=(c.expressionContext==="property"?pf:eh)($a(c.value),c.valueSpec);if(s.result==="error")return s.value.map(f=>new $e(`${c.key}${f.key}`,c.value,f.message));const u=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new $e(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Oc(u))return[new $e(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Oc(u))return[new $e(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Hu(u,["zoom","feature-state"]))return[new $e(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Wu(u))return[new $e(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vc(c){const s=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(xr(u))===-1&&g.push(new $e(s,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(xr(u))===-1&&g.push(new $e(s,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function Rl(c){return Nc($a(c.value))?Ga(st({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vg(c)}function vg(c){const s=c.value,u=c.key;if($n(s)!=="array")return[new $e(u,s,`array expected, ${$n(s)} found`)];const f=c.styleSpec;let g,x=[];if(s.length<1)return[new $e(u,s,"filter array must have at least 1 element")];switch(x=x.concat(Vc({key:`${u}[0]`,value:s[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),xr(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&xr(s[1])==="$type"&&x.push(new $e(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new $e(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(g=$n(s[1]),g!=="string"&&x.push(new $e(`${u}[1]`,s[1],`string expected, ${g} found`)));for(let w=2;w<s.length;w++)g=$n(s[w]),xr(s[1])==="$type"?x=x.concat(Vc({key:`${u}[${w}]`,value:s[w],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new $e(`${u}[${w}]`,s[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(vg({key:`${u}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=$n(s[1]),s.length!==2?x.push(new $e(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new $e(`${u}[1]`,s[1],`string expected, ${g} found`));break;case"within":g=$n(s[1]),s.length!==2?x.push(new $e(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new $e(`${u}[1]`,s[1],`object expected, ${g} found`))}return x}function xg(c,s){const u=c.key,f=c.validateSpec,g=c.style,x=c.styleSpec,w=c.value,T=c.objectKey,I=x[`${s}_${c.layerType}`];if(!I)return[];const M=T.match(/^(.*)-transition$/);if(s==="paint"&&M&&I[M[1]]&&I[M[1]].transition)return f({key:u,value:w,valueSpec:x.transition,style:g,styleSpec:x});const B=c.valueSpec||I[T];if(!B)return[new $e(u,w,`unknown property "${T}"`)];let U;if($n(w)==="string"&&Ml(B)&&!B.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new $e(u,w,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const H=[];return c.layerType==="symbol"&&(T==="text-field"&&g&&!g.glyphs&&H.push(new $e(u,w,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&mr($a(w))&&xr(w.type)==="identity"&&H.push(new $e(u,w,'"text-font" does not support identity functions'))),H.concat(f({key:c.key,value:w,valueSpec:B,style:g,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:T}))}function bg(c){return xg(c,"paint")}function wg(c){return xg(c,"layout")}function Sg(c){let s=[];const u=c.value,f=c.key,g=c.style,x=c.styleSpec;u.type||u.ref||s.push(new $e(f,u,'either "type" or "ref" is required'));let w=xr(u.type);const T=xr(u.ref);if(u.id){const I=xr(u.id);for(let M=0;M<c.arrayIndex;M++){const B=g.layers[M];xr(B.id)===I&&s.push(new $e(f,u.id,`duplicate layer id "${u.id}", previously used at line ${B.id.__line__}`))}}if("ref"in u){let I;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&s.push(new $e(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{xr(M.id)===T&&(I=M)}),I?I.ref?s.push(new $e(f,u.ref,"ref cannot reference another ref layer")):w=xr(I.type):s.push(new $e(f,u.ref,`ref layer "${T}" not found`))}else if(w!=="background")if(u.source){const I=g.sources&&g.sources[u.source],M=I&&xr(I.type);I?M==="vector"&&w==="raster"?s.push(new $e(f,u.source,`layer "${u.id}" requires a raster source`)):M!=="raster-dem"&&w==="hillshade"?s.push(new $e(f,u.source,`layer "${u.id}" requires a raster-dem source`)):M==="raster"&&w!=="raster"?s.push(new $e(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&w!=="hillshade"?s.push(new $e(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!u.paint||!u.paint["line-gradient"]||M==="geojson"&&I.lineMetrics||s.push(new $e(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new $e(f,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new $e(f,u.source,`source "${u.source}" not found`))}else s.push(new $e(f,u,'missing required property "source"'));return s=s.concat(Hi({key:f,value:u,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:u,objectKey:"type"}),filter:Rl,layout:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>wg(st({layerType:w},M))}}),paint:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>bg(st({layerType:w},M))}})}})),s}function go(c){const s=c.value,u=c.key,f=$n(s);return f!=="string"?[new $e(u,s,`string expected, ${f} found`)]:[]}const Uc={promoteId:function({key:c,value:s}){if($n(s)==="string")return go({key:c,value:s});{const u=[];for(const f in s)u.push(...go({key:`${c}.${f}`,value:s[f]}));return u}}};function fs(c){const s=c.value,u=c.key,f=c.styleSpec,g=c.style,x=c.validateSpec;if(!s.type)return[new $e(u,s,'"type" is required')];const w=xr(s.type);let T;switch(w){case"vector":case"raster":return T=Hi({key:u,value:s,valueSpec:f[`source_${w.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:Uc,validateSpec:x}),T;case"raster-dem":return T=function(I){var M;const B=(M=I.sourceName)!==null&&M!==void 0?M:"",U=I.value,H=I.styleSpec,Y=H.source_raster_dem,Q=I.style;let le=[];const me=$n(U);if(U===void 0)return le;if(me!=="object")return le.push(new $e("source_raster_dem",U,`object expected, ${me} found`)),le;const ve=xr(U.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],Te=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Le in U)!ve&&ke.includes(Le)?le.push(new $e(Le,U[Le],`In "${B}": "${Le}" is only valid when "encoding" is set to "custom". ${Te} encoding found`)):Y[Le]?le=le.concat(I.validateSpec({key:Le,value:U[Le],valueSpec:Y[Le],validateSpec:I.validateSpec,style:Q,styleSpec:H})):le.push(new $e(Le,U[Le],`unknown property "${Le}"`));return le}({sourceName:u,value:s,style:c.style,styleSpec:f,validateSpec:x}),T;case"geojson":if(T=Hi({key:u,value:s,valueSpec:f.source_geojson,style:g,styleSpec:f,validateSpec:x,objectElementValidators:Uc}),s.cluster)for(const I in s.clusterProperties){const[M,B]=s.clusterProperties[I],U=typeof M=="string"?[M,["accumulated"],["get",I]]:M;T.push(...Ga({key:`${u}.${I}.map`,value:B,validateSpec:x,expressionContext:"cluster-map"})),T.push(...Ga({key:`${u}.${I}.reduce`,value:U,validateSpec:x,expressionContext:"cluster-reduce"}))}return T;case"video":return Hi({key:u,value:s,valueSpec:f.source_video,style:g,validateSpec:x,styleSpec:f});case"image":return Hi({key:u,value:s,valueSpec:f.source_image,style:g,validateSpec:x,styleSpec:f});case"canvas":return[new $e(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vc({key:`${u}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:x,styleSpec:f})}}function $c(c){const s=c.value,u=c.styleSpec,f=u.light,g=c.style;let x=[];const w=$n(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new $e("light",s,`object expected, ${w} found`)]),x;for(const T in s){const I=T.match(/^(.*)-transition$/);x=x.concat(I&&f[I[1]]&&f[I[1]].transition?c.validateSpec({key:T,value:s[T],valueSpec:u.transition,validateSpec:c.validateSpec,style:g,styleSpec:u}):f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new $e(T,s[T],`unknown property "${T}"`)])}return x}function Tg(c){const s=c.value,u=c.styleSpec,f=u.terrain,g=c.style;let x=[];const w=$n(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new $e("terrain",s,`object expected, ${w} found`)]),x;for(const T in s)x=x.concat(f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new $e(T,s[T],`unknown property "${T}"`)]);return x}function Eg(c){let s=[];const u=c.value,f=c.key;if(Array.isArray(u)){const g=[],x=[];for(const w in u)u[w].id&&g.includes(u[w].id)&&s.push(new $e(f,u,`all the sprites' ids must be unique, but ${u[w].id} is duplicated`)),g.push(u[w].id),u[w].url&&x.includes(u[w].url)&&s.push(new $e(f,u,`all the sprites' URLs must be unique, but ${u[w].url} is duplicated`)),x.push(u[w].url),s=s.concat(Hi({key:`${f}[${w}]`,value:u[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return go({key:f,value:u})}const Pg={"*":()=>[],array:Ll,boolean:function(c){const s=c.value,u=c.key,f=$n(s);return f!=="boolean"?[new $e(u,s,`boolean expected, ${f} found`)]:[]},number:jc,color:function(c){const s=c.key,u=c.value,f=$n(u);return f!=="string"?[new $e(s,u,`color expected, ${f} found`)]:Pn.parse(String(u))?[]:[new $e(s,u,`color expected, "${u}" found`)]},constants:_g,enum:Vc,filter:Rl,function:sh,layer:Sg,object:Hi,source:fs,light:$c,terrain:Tg,string:go,formatted:function(c){return go(c).length===0?[]:Ga(c)},resolvedImage:function(c){return go(c).length===0?[]:Ga(c)},padding:function(c){const s=c.key,u=c.value;if($n(u)==="array"){if(u.length<1||u.length>4)return[new $e(s,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let x=0;x<u.length;x++)g=g.concat(c.validateSpec({key:`${s}[${x}]`,value:u[x],validateSpec:c.validateSpec,valueSpec:f}));return g}return jc({key:s,value:u,valueSpec:{}})},variableAnchorOffsetCollection:function(c){const s=c.key,u=c.value,f=$n(u),g=c.styleSpec;if(f!=="array"||u.length<1||u.length%2!=0)return[new $e(s,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<u.length;w+=2)x=x.concat(Vc({key:`${s}[${w}]`,value:u[w],valueSpec:g.layout_symbol["text-anchor"]})),x=x.concat(Ll({key:`${s}[${w+1}]`,value:u[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:g}));return x},sprite:Eg};function Wo(c){const s=c.value,u=c.valueSpec,f=c.styleSpec;return c.validateSpec=Wo,u.expression&&mr(xr(s))?sh(c):u.expression&&Qu($a(s))?Ga(c):u.type&&Pg[u.type]?Pg[u.type](c):Hi(st({},c,{valueSpec:u.type?f[u.type]:u}))}function Cg(c){const s=c.value,u=c.key,f=go(c);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new $e(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new $e(u,s,'"glyphs" url must include a "{range}" token'))),f}function Is(c,s=Ae){let u=[];return u=u.concat(Wo({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:Wo,objectElementValidators:{glyphs:Cg,"*":()=>[]}})),c.constants&&(u=u.concat(_g({key:"constants",value:c.constants,style:c,styleSpec:s,validateSpec:Wo}))),oh(u)}function Ho(c){return function(s){return c({...s,validateSpec:Wo})}}function oh(c){return[].concat(c).sort((s,u)=>s.line-u.line)}function qo(c){return function(...s){return oh(c.apply(this,s))}}Is.source=qo(Ho(fs)),Is.sprite=qo(Ho(Eg)),Is.glyphs=qo(Ho(Cg)),Is.light=qo(Ho($c)),Is.terrain=qo(Ho(Tg)),Is.layer=qo(Ho(Sg)),Is.filter=qo(Ho(Rl)),Is.paintProperty=qo(Ho(bg)),Is.layoutProperty=qo(Ho(wg));const Zo=Is,Xv=Zo.light,yf=Zo.paintProperty,Ag=Zo.layoutProperty;function ah(c,s){let u=!1;if(s&&s.length)for(const f of s)c.fire(new ut(new Error(f.message))),u=!0;return u}class Ol{constructor(s,u,f){const g=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(u=w[1])+2*(f=w[2]);for(let I=0;I<this.d*this.d;I++){const M=w[3+I],B=w[3+I+1];g.push(M===B?null:w.subarray(M,B))}const T=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],T),this.bboxes=w.subarray(T),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=f,this.scale=u/s,this.uid=0;const x=f/u*s;this.min=-x,this.max=s+x}insert(s,u,f,g,x){this._forEachCell(u,f,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,u,f,g,x,w){this.cells[x].push(w)}query(s,u,f,g,x){const w=this.min,T=this.max;if(s<=w&&u<=w&&T<=f&&T<=g&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,u,f,g,this._queryCell,I,{},x),I}}_queryCell(s,u,f,g,x,w,T,I){const M=this.cells[x];if(M!==null){const B=this.keys,U=this.bboxes;for(let H=0;H<M.length;H++){const Y=M[H];if(T[Y]===void 0){const Q=4*Y;(I?I(U[Q+0],U[Q+1],U[Q+2],U[Q+3]):s<=U[Q+2]&&u<=U[Q+3]&&f>=U[Q+0]&&g>=U[Q+1])?(T[Y]=!0,w.push(B[Y])):T[Y]=!1}}}}_forEachCell(s,u,f,g,x,w,T,I){const M=this._convertToCellCoord(s),B=this._convertToCellCoord(u),U=this._convertToCellCoord(f),H=this._convertToCellCoord(g);for(let Y=M;Y<=U;Y++)for(let Q=B;Q<=H;Q++){const le=this.d*Q+Y;if((!I||I(this._convertFromCellCoord(Y),this._convertFromCellCoord(Q),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(Q+1)))&&x.call(this,s,u,f,g,le,w,T,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,u=3+this.cells.length+1+1;let f=0;for(let w=0;w<this.cells.length;w++)f+=this.cells[w].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=u;for(let w=0;w<s.length;w++){const T=s[w];g[3+w]=x,g.set(T,x),x+=T.length}return g[3+s.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+s.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(s,u){const f=s.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(s){return new Ol(s.buffer)}}const Xo={};function Mt(c,s,u={}){if(Xo[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Xo[c]={klass:s,omit:u.omit||[],shallow:u.shallow||[]}}Mt("Object",Object),Mt("TransferableGridIndex",Ol),Mt("Color",Pn),Mt("Error",Error),Mt("AJAXError",nt),Mt("ResolvedImage",Zn),Mt("StylePropertyFunction",Dc),Mt("StyleExpression",df,{omit:["_evaluator"]}),Mt("ZoomDependentExpression",th),Mt("ZoomConstantExpression",ff),Mt("CompoundExpression",As,{omit:["_evaluate"]});for(const c in kl)kl[c]._classRegistryKey||Mt(`Expression_${c}`,kl[c]);function lh(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function ga(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(lh(c)||Xe(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return s&&s.push(u.buffer),u}if(c instanceof ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(ga(f,s));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");if(!Xo[f])throw new Error(`${f} is not registered.`);const g=u.serialize?u.serialize(c,s):{};if(u.serialize){if(s&&g===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||Xo[f].omit.indexOf(x)>=0)continue;const w=c[x];g[x]=Xo[f].shallow.indexOf(x)>=0?w:ga(w,s)}c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function zl(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||lh(c)||Xe(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(zl);if(typeof c=="object"){const s=c.$name||"Object";if(!Xo[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:u}=Xo[s];if(!u)throw new Error(`can't deserialize unregistered class ${s}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c)){if(g==="$name")continue;const x=c[g];f[g]=Xo[s].shallow.indexOf(g)>=0?x:zl(x)}return f}throw new Error("can't deserialize object of type "+typeof c)}class Ig{constructor(){this.first=!0}update(s,u){const f=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=f,!0))}}const St={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function _f(c){for(const s of c)if(xf(s.charCodeAt(0)))return!0;return!1}function vf(c){for(const s of c)if(!Yv(s.charCodeAt(0)))return!1;return!0}function Yv(c){return!(St.Arabic(c)||St["Arabic Supplement"](c)||St["Arabic Extended-A"](c)||St["Arabic Presentation Forms-A"](c)||St["Arabic Presentation Forms-B"](c))}function xf(c){return!(c!==746&&c!==747&&(c<4352||!(St["Bopomofo Extended"](c)||St.Bopomofo(c)||St["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||St["CJK Compatibility Ideographs"](c)||St["CJK Compatibility"](c)||St["CJK Radicals Supplement"](c)||St["CJK Strokes"](c)||!(!St["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||St["CJK Unified Ideographs Extension A"](c)||St["CJK Unified Ideographs"](c)||St["Enclosed CJK Letters and Months"](c)||St["Hangul Compatibility Jamo"](c)||St["Hangul Jamo Extended-A"](c)||St["Hangul Jamo Extended-B"](c)||St["Hangul Jamo"](c)||St["Hangul Syllables"](c)||St.Hiragana(c)||St["Ideographic Description Characters"](c)||St.Kanbun(c)||St["Kangxi Radicals"](c)||St["Katakana Phonetic Extensions"](c)||St.Katakana(c)&&c!==12540||!(!St["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!St["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||St["Unified Canadian Aboriginal Syllabics"](c)||St["Unified Canadian Aboriginal Syllabics Extended"](c)||St["Vertical Forms"](c)||St["Yijing Hexagram Symbols"](c)||St["Yi Syllables"](c)||St["Yi Radicals"](c))))}function kg(c){return!(xf(c)||function(s){return!!(St["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||St["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||St["Letterlike Symbols"](s)||St["Number Forms"](s)||St["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||St["Control Pictures"](s)&&s!==9251||St["Optical Character Recognition"](s)||St["Enclosed Alphanumerics"](s)||St["Geometric Shapes"](s)||St["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||St["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||St["CJK Symbols and Punctuation"](s)||St.Katakana(s)||St["Private Use Area"](s)||St["CJK Compatibility Forms"](s)||St["Small Form Variants"](s)||St["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function Mg(c){return c>=1424&&c<=2303||St["Arabic Presentation Forms-A"](c)||St["Arabic Presentation Forms-B"](c)}function Lg(c,s){return!(!s&&Mg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||St.Khmer(c))}function Kv(c){for(const s of c)if(Mg(s.charCodeAt(0)))return!0;return!1}const bf="deferred",wf="loading",Sf="loaded";let Tf=null,qi="unavailable",ya=null;const Gc=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(qi="error"),Tf&&Tf(c)};function Ef(){Wc.fire(new vn("pluginStateChange",{pluginStatus:qi,pluginURL:ya}))}const Wc=new un,Pf=function(){return qi},Rg=function(){if(qi!==bf||!ya)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi=wf,Ef(),ya&&Ht({url:ya},c=>{c?Gc(c):(qi=Sf,Ef())})},ps={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qi===Sf||ps.applyArabicShaping!=null,isLoading:()=>qi===wf,setState(c){if(!Ye())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qi=c.pluginStatus,ya=c.pluginURL},isParsed(){if(!Ye())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ps.applyArabicShaping!=null&&ps.processBidirectionalText!=null&&ps.processStyledBidirectionalText!=null},getPluginURL(){if(!Ye())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ya}};class sr{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ig,this.transition={})}isSupportedScript(s){return function(u,f){for(const g of u)if(!Lg(g.charCodeAt(0),f))return!1;return!0}(s,ps.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,u=s-Math.floor(s),f=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}class ch{constructor(s,u){this.property=s,this.value=u,this.expression=function(f,g){if(mr(f))return new Dc(f,g);if(Qu(f)){const x=pf(f,g);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=f;return g.type==="color"&&typeof f=="string"?x=Pn.parse(f):g.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(x=di.parse(f)):x=bi.parse(f),{kind:"constant",evaluate:()=>x}}}(u===void 0?s.specification.default:u,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,f){return this.property.possiblyEvaluate(this,s,u,f)}}class Cf{constructor(s){this.property=s,this.value=new ch(s,void 0)}transitioned(s,u){return new zg(this.property,this.value,u,xe({},s.transition,this.transition),s.now)}untransitioned(){return new zg(this.property,this.value,null,{},0)}}class Og{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return De(this._values[s].value.value)}setValue(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Cf(this._values[s].property)),this._values[s].value=new ch(this._values[s].property,u===null?void 0:De(u))}getTransition(s){return De(this._values[s].transition)}setTransition(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Cf(this._values[s].property)),this._values[s].transition=De(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f);const g=this.getTransition(u);g!==void 0&&(s[`${u}-transition`]=g)}return s}transitioned(s,u){const f=new Dg(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(s,u._values[g]);return f}untransitioned(){const s=new Dg(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class zg{constructor(s,u,f,g,x){this.property=s,this.value=u,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,s.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(s,u,f){const g=s.now||0,x=this.value.possiblyEvaluate(s,u,f),w=this.prior;if(w){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return w.possiblyEvaluate(s,u,f);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,u,f),x,function(I){if(I<=0)return 0;if(I>=1)return 1;const M=I*I,B=M*I;return 4*(I<.5?B:3*(I-M)+B-.75)}(T))}}return x}}class Dg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,f){const g=new uh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Jv{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return De(this._values[s].value)}setValue(s,u){this._values[s]=new ch(this._values[s].property,u===null?void 0:De(u))}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f)}return s}possiblyEvaluate(s,u,f){const g=new uh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}}class Mi{constructor(s,u,f){this.property=s,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,f,g){return this.property.evaluate(this.value,this.parameters,s,u,f,g)}}class uh{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Zt{constructor(s){this.specification=s}possiblyEvaluate(s,u){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(u)}interpolate(s,u,f){const g=hs[this.specification.type];return g?g(s,u,f):s}}class rn{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,f,g){return new Mi(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},f,g)}:s.expression,u)}interpolate(s,u,f){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new Mi(this,{kind:"constant",value:void 0},s.parameters);const g=hs[this.specification.type];if(g){const x=g(s.value.value,u.value.value,f);return new Mi(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,u,f,g,x,w){return s.kind==="constant"?s.value:s.evaluate(u,f,g,x,w)}}class Hc extends rn{possiblyEvaluate(s,u,f,g){if(s.value===void 0)return new Mi(this,{kind:"constant",value:void 0},u);if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,T=this._calculate(w,w,w,u);return new Mi(this,{kind:"constant",value:T},u)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:u.zoom-1}),s.expression.evaluate({zoom:u.zoom}),s.expression.evaluate({zoom:u.zoom+1}),u);return new Mi(this,{kind:"constant",value:x},u)}return new Mi(this,s.expression,u)}evaluate(s,u,f,g,x,w){if(s.kind==="source"){const T=s.evaluate(u,f,g,x,w);return this._calculate(T,T,T,u)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(u.zoom)-1},f,g),s.evaluate({zoom:Math.floor(u.zoom)},f,g),s.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):s.value}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class Af{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g);return this._calculate(x,x,x,u)}return this._calculate(s.expression.evaluate(new sr(Math.floor(u.zoom-1),u)),s.expression.evaluate(new sr(Math.floor(u.zoom),u)),s.expression.evaluate(new sr(Math.floor(u.zoom+1),u)),u)}}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class If{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){return!!s.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Rr{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in s){const f=s[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new ch(f,void 0),x=this.defaultTransitionablePropertyValues[u]=new Cf(f);this.defaultTransitioningPropertyValues[u]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}Mt("DataDrivenProperty",rn),Mt("DataConstantProperty",Zt),Mt("CrossFadedDataDrivenProperty",Hc),Mt("CrossFadedProperty",Af),Mt("ColorRampProperty",If);const kf="-transition";class ks extends un{constructor(s,u){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),u.layout&&(this._unevaluatedLayout=new Jv(u.layout)),u.paint)){this._transitionablePaint=new Og(u.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new uh(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u,f={}){u!=null&&this._validate(Ag,`layers.${this.id}.layout.${s}`,s,u,f)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,u):this.visibility=u)}getPaintProperty(s){return s.endsWith(kf)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u,f={}){if(u!=null&&this._validate(yf,`layers.${this.id}.paint.${s}`,s,u,f))return!1;if(s.endsWith(kf))return this._transitionablePaint.setTransition(s.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[s],x=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(s,u),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,T,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,u,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Re(s,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(s,u,f,g,x={}){return(!x||x.validate!==!1)&&ah(this,s.call(Zo,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof Mi&&Ml(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const Fg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Wa{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class br{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yr(c,s=1){let u=0,f=0;return{members:c.map(g=>{const x=Fg[g.type].BYTES_PER_ELEMENT,w=u=Dl(u,Math.max(s,x)),T=g.components||1;return f=Math.max(f,x),u+=x*T,{name:g.name,type:g.type,components:T,offset:w}}),size:Dl(u,Math.max(f,s)),alignment:s}}function Dl(c,s){return Math.ceil(c/s)*s}class qc extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.int16[g+0]=u,this.int16[g+1]=f,s}}qc.prototype.bytesPerElement=4,Mt("StructArrayLayout2i4",qc);class Zc extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,s}}Zc.prototype.bytesPerElement=6,Mt("StructArrayLayout3i6",Zc);class Ha extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.int16[w+0]=u,this.int16[w+1]=f,this.int16[w+2]=g,this.int16[w+3]=x,s}}Ha.prototype.bytesPerElement=8,Mt("StructArrayLayout4i8",Ha);class Mf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=T,s}}Mf.prototype.bytesPerElement=12,Mt("StructArrayLayout2i4i12",Mf);class Lf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=4*s,M=8*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.uint8[M+4]=g,this.uint8[M+5]=x,this.uint8[M+6]=w,this.uint8[M+7]=T,s}}Lf.prototype.bytesPerElement=8,Mt("StructArrayLayout2i4ub8",Lf);class Fl extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.float32[g+0]=u,this.float32[g+1]=f,s}}Fl.prototype.bytesPerElement=8,Mt("StructArrayLayout2f8",Fl);class Rf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B){const U=this.length;return this.resize(U+1),this.emplace(U,s,u,f,g,x,w,T,I,M,B)}emplace(s,u,f,g,x,w,T,I,M,B,U){const H=10*s;return this.uint16[H+0]=u,this.uint16[H+1]=f,this.uint16[H+2]=g,this.uint16[H+3]=x,this.uint16[H+4]=w,this.uint16[H+5]=T,this.uint16[H+6]=I,this.uint16[H+7]=M,this.uint16[H+8]=B,this.uint16[H+9]=U,s}}Rf.prototype.bytesPerElement=20,Mt("StructArrayLayout10ui20",Rf);class Of extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,u,f,g,x,w,T,I,M,B,U,H)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y){const Q=12*s;return this.int16[Q+0]=u,this.int16[Q+1]=f,this.int16[Q+2]=g,this.int16[Q+3]=x,this.uint16[Q+4]=w,this.uint16[Q+5]=T,this.uint16[Q+6]=I,this.uint16[Q+7]=M,this.int16[Q+8]=B,this.int16[Q+9]=U,this.int16[Q+10]=H,this.int16[Q+11]=Y,s}}Of.prototype.bytesPerElement=24,Mt("StructArrayLayout4i4ui4i24",Of);class Gn extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}Gn.prototype.bytesPerElement=12,Mt("StructArrayLayout3f12",Gn);class v extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}v.prototype.bytesPerElement=4,Mt("StructArrayLayout1ul4",v);class o extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M){const B=this.length;return this.resize(B+1),this.emplace(B,s,u,f,g,x,w,T,I,M)}emplace(s,u,f,g,x,w,T,I,M,B){const U=10*s,H=5*s;return this.int16[U+0]=u,this.int16[U+1]=f,this.int16[U+2]=g,this.int16[U+3]=x,this.int16[U+4]=w,this.int16[U+5]=T,this.uint32[H+3]=I,this.uint16[U+8]=M,this.uint16[U+9]=B,s}}o.prototype.bytesPerElement=20,Mt("StructArrayLayout6i1ul2ui20",o);class d extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=T,s}}d.prototype.bytesPerElement=12,Mt("StructArrayLayout2i2i2i12",d);class p extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,u,f,g,x)}emplace(s,u,f,g,x,w){const T=4*s,I=8*s;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=g,this.int16[I+6]=x,this.int16[I+7]=w,s}}p.prototype.bytesPerElement=16,Mt("StructArrayLayout2f1f2i16",p);class y extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=12*s,T=3*s;return this.uint8[w+0]=u,this.uint8[w+1]=f,this.float32[T+1]=g,this.float32[T+2]=x,s}}y.prototype.bytesPerElement=12,Mt("StructArrayLayout2ub2f12",y);class b extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,s}}b.prototype.bytesPerElement=6,Mt("StructArrayLayout3ui6",b);class E extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve){const ke=this.length;return this.resize(ke+1),this.emplace(ke,s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve,ke){const Te=24*s,Le=12*s,ze=48*s;return this.int16[Te+0]=u,this.int16[Te+1]=f,this.uint16[Te+2]=g,this.uint16[Te+3]=x,this.uint32[Le+2]=w,this.uint32[Le+3]=T,this.uint32[Le+4]=I,this.uint16[Te+10]=M,this.uint16[Te+11]=B,this.uint16[Te+12]=U,this.float32[Le+7]=H,this.float32[Le+8]=Y,this.uint8[ze+36]=Q,this.uint8[ze+37]=le,this.uint8[ze+38]=me,this.uint32[Le+10]=ve,this.int16[Te+22]=ke,s}}E.prototype.bytesPerElement=48,Mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",E);class A extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve,ke,Te,Le,ze,Je,Tt,Nt,wt,yt,dt,Lt){const pt=this.length;return this.resize(pt+1),this.emplace(pt,s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve,ke,Te,Le,ze,Je,Tt,Nt,wt,yt,dt,Lt)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le,me,ve,ke,Te,Le,ze,Je,Tt,Nt,wt,yt,dt,Lt,pt){const it=32*s,Jt=16*s;return this.int16[it+0]=u,this.int16[it+1]=f,this.int16[it+2]=g,this.int16[it+3]=x,this.int16[it+4]=w,this.int16[it+5]=T,this.int16[it+6]=I,this.int16[it+7]=M,this.uint16[it+8]=B,this.uint16[it+9]=U,this.uint16[it+10]=H,this.uint16[it+11]=Y,this.uint16[it+12]=Q,this.uint16[it+13]=le,this.uint16[it+14]=me,this.uint16[it+15]=ve,this.uint16[it+16]=ke,this.uint16[it+17]=Te,this.uint16[it+18]=Le,this.uint16[it+19]=ze,this.uint16[it+20]=Je,this.uint16[it+21]=Tt,this.uint16[it+22]=Nt,this.uint32[Jt+12]=wt,this.float32[Jt+13]=yt,this.float32[Jt+14]=dt,this.uint16[it+30]=Lt,this.uint16[it+31]=pt,s}}A.prototype.bytesPerElement=64,Mt("StructArrayLayout8i15ui1ul2f2ui64",A);class k extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}k.prototype.bytesPerElement=4,Mt("StructArrayLayout1f4",k);class O extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[6*s+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}O.prototype.bytesPerElement=12,Mt("StructArrayLayout1ui2f12",O);class j extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=4*s;return this.uint32[2*s+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=g,s}}j.prototype.bytesPerElement=8,Mt("StructArrayLayout1ul2ui8",j);class V extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.uint16[g+0]=u,this.uint16[g+1]=f,s}}V.prototype.bytesPerElement=4,Mt("StructArrayLayout2ui4",V);class X extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}X.prototype.bytesPerElement=2,Mt("StructArrayLayout1ui2",X);class ue extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.float32[w+0]=u,this.float32[w+1]=f,this.float32[w+2]=g,this.float32[w+3]=x,s}}ue.prototype.bytesPerElement=16,Mt("StructArrayLayout4f16",ue);class ce extends Wa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new C(this.anchorPointX,this.anchorPointY)}}ce.prototype.size=20;class fe extends o{get(s){return new ce(this,s)}}Mt("CollisionBoxArray",fe);class ae extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ae.prototype.size=48;class Pe extends E{get(s){return new ae(this,s)}}Mt("PlacedSymbolArray",Pe);class Oe extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Oe.prototype.size=64;class ge extends A{get(s){return new Oe(this,s)}}Mt("SymbolInstanceArray",ge);class Ie extends k{getoffsetX(s){return this.float32[1*s+0]}}Mt("GlyphOffsetArray",Ie);class Fe extends Zc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}Mt("SymbolLineVertexArray",Fe);class Be extends Wa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Be.prototype.size=12;class Ke extends O{get(s){return new Be(this,s)}}Mt("TextAnchorOffsetArray",Ke);class rt extends Wa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rt.prototype.size=8;class et extends j{get(s){return new rt(this,s)}}Mt("FeatureIndexArray",et);class ct extends qc{}class Ft extends qc{}class Cn extends qc{}class gt extends Mf{}class sn extends Lf{}class jt extends Fl{}class Hn extends Rf{}class En extends Of{}class xn extends Gn{}class An extends v{}class Ar extends d{}class er extends y{}class pi extends b{}class Jr extends V{}const Or=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ms}=Or;class or{constructor(s=[]){this.segments=s}prepareSegment(s,u,f,g){let x=this.segments[this.segments.length-1];return s>or.MAX_VERTEX_ARRAY_LENGTH&&je(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!x||x.vertexLength+s>or.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,f,g){return new or([{vertexOffset:s,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function yo(c,s){return 256*(c=ne(Math.floor(c),0,255))+ne(Math.floor(s),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mt("SegmentVector",or);const _o=yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var _a={exports:{}},qa={exports:{}};qa.exports=function(c,s){var u,f,g,x,w,T,I,M;for(f=c.length-(u=3&c.length),g=s,w=3432918353,T=461845907,M=0;M<f;)I=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,g=27492+(65535&(x=5*(65535&(g=(g^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(I=0,u){case 3:I^=(255&c.charCodeAt(M+2))<<16;case 2:I^=(255&c.charCodeAt(M+1))<<8;case 1:g^=I=(65535&(I=(I=(65535&(I^=255&c.charCodeAt(M)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Nl=qa.exports,wi={exports:{}};wi.exports=function(c,s){for(var u,f=c.length,g=s^f,x=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(x)|(255&c.charCodeAt(++x))<<8|(255&c.charCodeAt(++x))<<16|(255&c.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&c.charCodeAt(x+2))<<16;case 2:g^=(255&c.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var mi=Nl,Li=wi.exports;_a.exports=mi,_a.exports.murmur3=mi,_a.exports.murmur2=Li;var Za=_(_a.exports);class Ir{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,u,f,g){this.ids.push(Qr(s)),this.positions.push(u,f,g)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=Qr(s);let f=0,g=this.ids.length-1;for(;f<g;){const w=f+g>>1;this.ids[w]>=u?g=w:f=w+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(s,u){const f=new Float64Array(s.ids),g=new Uint32Array(s.positions);return Zi(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(s){const u=new Ir;return u.ids=s.ids,u.positions=s.positions,u.indexed=!0,u}}function Qr(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Za(String(c))}function Zi(c,s,u,f){for(;u<f;){const g=c[u+f>>1];let x=u-1,w=f+1;for(;;){do x++;while(c[x]<g);do w--;while(c[w]>g);if(x>=w)break;kr(c,x,w),kr(s,3*x,3*w),kr(s,3*x+1,3*w+1),kr(s,3*x+2,3*w+2)}w-u<f-w?(Zi(c,s,u,w),u=w+1):(Zi(c,s,w+1,f),f=w)}}function kr(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}Mt("FeaturePositionMap",Ir);class Xa{constructor(s,u){this.gl=s.gl,this.location=u}}class hh extends Xa{constructor(s,u){super(s,u),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class Ng extends Xa{constructor(s,u){super(s,u),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Bg extends Xa{constructor(s,u){super(s,u),this.current=Pn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Qv=new Float32Array(16);function zf(c){return[yo(255*c.r,255*c.g),yo(255*c.b,255*c.a)]}class vo{constructor(s,u,f){this.value=s,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(s,u,f){s.set(f.constantOr(this.value))}getBinding(s,u,f){return this.type==="color"?new Bg(s,u):new hh(s,u)}}class Ya{constructor(s,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=s.tlbr}setUniform(s,u,f,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,u,f){return f.substr(0,9)==="u_pattern"?new Ng(s,u):new hh(s,u)}}class xo{constructor(s,u,f,g){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(s,u,f,g,x){const w=this.paintVertexArray.length,T=this.expression.evaluate(new sr(0),u,{},g,[],x);this.paintVertexArray.resize(s),this._setPaintValue(w,s,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:0},f,g);this._setPaintValue(s,u,x)}_setPaintValue(s,u,f){if(this.type==="color"){const g=zf(f);for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=s;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ms{constructor(s,u,f,g,x,w){this.expression=s,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,u,f,g,x){const w=this.expression.evaluate(new sr(this.zoom),u,{},g,[],x),T=this.expression.evaluate(new sr(this.zoom+1),u,{},g,[],x),I=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(I,s,w,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:this.zoom},f,g),w=this.expression.evaluate({zoom:this.zoom+1},f,g);this._setPaintValue(s,u,x,w)}_setPaintValue(s,u,f,g){if(this.type==="color"){const x=zf(f),w=zf(g);for(let T=s;T<u;T++)this.paintVertexArray.emplace(T,x[0],x[1],w[0],w[1])}else{for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=ne(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);s.set(g)}getBinding(s,u,f){return new hh(s,u)}}class bo{constructor(s,u,f,g,x,w){this.expression=s,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(g,s,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(s,u,f,g,x){this._setPaintValues(s,u,f.patterns&&f.patterns[this.layerId],x)}_setPaintValues(s,u,f,g){if(!g||!f)return;const{min:x,mid:w,max:T}=f,I=g[x],M=g[w],B=g[T];if(I&&M&&B)for(let U=s;U<u;U++)this.zoomInPaintVertexArray.emplace(U,M.tl[0],M.tl[1],M.br[0],M.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],M.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,M.tl[0],M.tl[1],M.br[0],M.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],M.pixelRatio,B.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,_o.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,_o.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Df{constructor(s,u,f){this.binders={},this._buffers=[];const g=[];for(const x in s.paint._values){if(!f(x))continue;const w=s.paint.get(x);if(!(w instanceof Mi&&Ml(w.property.specification)))continue;const T=CD(x,s.type),I=w.value,M=w.property.specification.type,B=w.property.useIntegerZoom,U=w.property.specification["property-type"],H=U==="cross-faded"||U==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=H?new Ya(I.value,T):new vo(I.value,T,M),g.push(`/u_${x}`);else if(I.kind==="source"||H){const Y=CT(x,M,"source");this.binders[x]=H?new bo(I,M,B,u,Y,s.id):new xo(I,T,M,Y),g.push(`/a_${x}`)}else{const Y=CT(x,M,"composite");this.binders[x]=new Ms(I,T,M,B,u,Y),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof xo||u instanceof Ms?u.maxValue:0}populatePaintArrays(s,u,f,g,x){for(const w in this.binders){const T=this.binders[w];(T instanceof xo||T instanceof Ms||T instanceof bo)&&T.populatePaintArray(s,u,f,g,x)}}setConstantPatternPositions(s,u){for(const f in this.binders){const g=this.binders[f];g instanceof Ya&&g.setConstantPatternPositions(s,u)}}updatePaintArrays(s,u,f,g,x){let w=!1;for(const T in s){const I=u.getPositions(T);for(const M of I){const B=f.feature(M.index);for(const U in this.binders){const H=this.binders[U];if((H instanceof xo||H instanceof Ms||H instanceof bo)&&H.expression.isStateDependent===!0){const Y=g.paint.get(U);H.expression=Y.value,H.updatePaintArray(M.start,M.end,B,s[T],x),w=!0}}}}return w}defines(){const s=[];for(const u in this.binders){const f=this.binders[u];(f instanceof vo||f instanceof Ya)&&s.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof xo||f instanceof Ms)for(let g=0;g<f.paintVertexAttributes.length;g++)s.push(f.paintVertexAttributes[g].name);else if(f instanceof bo)for(let g=0;g<_o.members.length;g++)s.push(_o.members[g].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof vo||f instanceof Ya||f instanceof Ms)for(const g of f.uniformNames)s.push(g)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,u){const f=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof vo||x instanceof Ya||x instanceof Ms){for(const w of x.uniformNames)if(u[w]){const T=x.getBinding(s,u[w],w);f.push({name:w,property:g,binding:T})}}}return f}setUniforms(s,u,f,g){for(const{name:x,property:w,binding:T}of u)this.binders[w].setUniform(T,g,f.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(s&&f instanceof bo){const g=s.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof xo||f instanceof Ms)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(s){for(const u in this.binders){const f=this.binders[u];(f instanceof xo||f instanceof Ms||f instanceof bo)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof xo||u instanceof Ms||u instanceof bo)&&u.destroy()}}}class Yo{constructor(s,u,f=()=>!0){this.programConfigurations={};for(const g of s)this.programConfigurations[g.id]=new Df(g,u,f);this.needsUpload=!1,this._featureMap=new Ir,this._bufferOffset=0}populatePaintArrays(s,u,f,g,x,w){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(s,u,g,x,w);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,f,g){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,u,x,g)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function CD(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function CT(c,s,u){const f={color:{source:Fl,composite:ue},number:{source:k,composite:Fl}},g=function(x){return{"line-pattern":{source:Hn,composite:Hn},"fill-pattern":{source:Hn,composite:Hn},"fill-extrusion-pattern":{source:Hn,composite:Hn}}[x]}(c);return g&&g[u]||f[s][u]}Mt("ConstantBinder",vo),Mt("CrossFadedConstantBinder",Ya),Mt("SourceExpressionBinder",xo),Mt("CrossFadedCompositeBinder",bo),Mt("CompositeExpressionBinder",Ms),Mt("ProgramConfiguration",Df,{omit:["_buffers"]}),Mt("ProgramConfigurationSet",Yo);const $r=8192,ex=Math.pow(2,14)-1,AT=-ex-1;function Xc(c){const s=$r/c.extent,u=c.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let x=0;x<g.length;x++){const w=g[x],T=Math.round(w.x*s),I=Math.round(w.y*s);w.x=ne(T,AT,ex),w.y=ne(I,AT,ex),(T<w.x||T>w.x+1||I<w.y||I>w.y+1)&&je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function Yc(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Xc(c):[]}}function jg(c,s,u,f,g){c.emplaceBack(2*s+(f+1)/2,2*u+(g+1)/2)}class tx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Ft,this.indexArray=new pi,this.segments=new or,this.programConfigurations=new Yo(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){const g=this.layers[0],x=[];let w=null,T=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),T=!w.isConstant());for(const{feature:I,id:M,index:B,sourceLayerIndex:U}of s){const H=this.layers[0]._featureFilter.needGeometry,Y=Yc(I,H);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),Y,f))continue;const Q=T?w.evaluate(Y,{},f):void 0,le={id:M,properties:I.properties,type:I.type,sourceLayerIndex:U,index:B,geometry:H?Y.geometry:Xc(I),patterns:{},sortKey:Q};x.push(le)}T&&x.sort((I,M)=>I.sortKey-M.sortKey);for(const I of x){const{geometry:M,index:B,sourceLayerIndex:U}=I,H=s[B].feature;this.addFeature(I,M,B,f),u.featureIndex.insert(H,M,B,U,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ms),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,f,g){for(const x of u)for(const w of x){const T=w.x,I=w.y;if(T<0||T>=$r||I<0||I>=$r)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),B=M.vertexLength;jg(this.layoutVertexArray,T,I,-1,-1),jg(this.layoutVertexArray,T,I,1,-1),jg(this.layoutVertexArray,T,I,1,1),jg(this.layoutVertexArray,T,I,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},g)}}function IT(c,s){for(let u=0;u<c.length;u++)if(dh(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(dh(c,s[u]))return!0;return!!nx(c,s)}function AD(c,s,u){return!!dh(c,s)||!!rx(s,c,u)}function kT(c,s){if(c.length===1)return LT(s,c[0]);for(let u=0;u<s.length;u++){const f=s[u];for(let g=0;g<f.length;g++)if(dh(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(LT(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(nx(c,s[u]))return!0;return!1}function ID(c,s,u){if(c.length>1){if(nx(c,s))return!0;for(let f=0;f<s.length;f++)if(rx(s[f],c,u))return!0}for(let f=0;f<c.length;f++)if(rx(c[f],s,u))return!0;return!1}function nx(c,s){if(c.length===0||s.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let x=0;x<s.length-1;x++)if(kD(f,g,s[x],s[x+1]))return!0}return!1}function kD(c,s,u,f){return We(c,u,f)!==We(s,u,f)&&We(c,s,u)!==We(c,s,f)}function rx(c,s,u){const f=u*u;if(s.length===1)return c.distSqr(s[0])<f;for(let g=1;g<s.length;g++)if(MT(c,s[g-1],s[g])<f)return!0;return!1}function MT(c,s,u){const f=s.distSqr(u);if(f===0)return c.distSqr(s);const g=((c.x-s.x)*(u.x-s.x)+(c.y-s.y)*(u.y-s.y))/f;return c.distSqr(g<0?s:g>1?u:u.sub(s)._mult(g)._add(s))}function LT(c,s){let u,f,g,x=!1;for(let w=0;w<c.length;w++){u=c[w];for(let T=0,I=u.length-1;T<u.length;I=T++)f=u[T],g=u[I],f.y>s.y!=g.y>s.y&&s.x<(g.x-f.x)*(s.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function dh(c,s){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const x=c[f],w=c[g];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(u=!u)}return u}function MD(c,s,u){const f=u[0],g=u[2];if(c.x<f.x&&s.x<f.x||c.x>g.x&&s.x>g.x||c.y<f.y&&s.y<f.y||c.y>g.y&&s.y>g.y)return!1;const x=We(c,s,u[0]);return x!==We(c,s,u[1])||x!==We(c,s,u[2])||x!==We(c,s,u[3])}function Ff(c,s,u){const f=s.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(s.id).getMaxValue(c)}function Vg(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ug(c,s,u,f,g){if(!s[0]&&!s[1])return c;const x=C.convert(s)._mult(g);u==="viewport"&&x._rotate(-f);const w=[];for(let T=0;T<c.length;T++)w.push(c[T].sub(x));return w}let RT,OT;Mt("CircleBucket",tx,{omit:["layers"]});var LD={get paint(){return OT=OT||new Rr({"circle-radius":new rn(Ae.paint_circle["circle-radius"]),"circle-color":new rn(Ae.paint_circle["circle-color"]),"circle-blur":new rn(Ae.paint_circle["circle-blur"]),"circle-opacity":new rn(Ae.paint_circle["circle-opacity"]),"circle-translate":new Zt(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rn(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rn(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rn(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return RT=RT||new Rr({"circle-sort-key":new rn(Ae.layout_circle["circle-sort-key"])})}},Xi=1e-6,fh=typeof Float32Array<"u"?Float32Array:Array;function ix(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function zT(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3],T=s[4],I=s[5],M=s[6],B=s[7],U=s[8],H=s[9],Y=s[10],Q=s[11],le=s[12],me=s[13],ve=s[14],ke=s[15],Te=u[0],Le=u[1],ze=u[2],Je=u[3];return c[0]=Te*f+Le*T+ze*U+Je*le,c[1]=Te*g+Le*I+ze*H+Je*me,c[2]=Te*x+Le*M+ze*Y+Je*ve,c[3]=Te*w+Le*B+ze*Q+Je*ke,c[4]=(Te=u[4])*f+(Le=u[5])*T+(ze=u[6])*U+(Je=u[7])*le,c[5]=Te*g+Le*I+ze*H+Je*me,c[6]=Te*x+Le*M+ze*Y+Je*ve,c[7]=Te*w+Le*B+ze*Q+Je*ke,c[8]=(Te=u[8])*f+(Le=u[9])*T+(ze=u[10])*U+(Je=u[11])*le,c[9]=Te*g+Le*I+ze*H+Je*me,c[10]=Te*x+Le*M+ze*Y+Je*ve,c[11]=Te*w+Le*B+ze*Q+Je*ke,c[12]=(Te=u[12])*f+(Le=u[13])*T+(ze=u[14])*U+(Je=u[15])*le,c[13]=Te*g+Le*I+ze*H+Je*me,c[14]=Te*x+Le*M+ze*Y+Je*ve,c[15]=Te*w+Le*B+ze*Q+Je*ke,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var Nf,RD=zT;function $g(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3];return c[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*w,c[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*w,c[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*w,c[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*w,c}Nf=new fh(4),fh!=Float32Array&&(Nf[0]=0,Nf[1]=0,Nf[2]=0,Nf[3]=0);class OD extends ks{constructor(s){super(s,LD)}createBucket(s){return new tx(s)}queryRadius(s){const u=s;return Ff("circle-radius",this,u)+Ff("circle-stroke-width",this,u)+Vg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T,I){const M=Ug(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,T),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),U=this.paint.get("circle-pitch-alignment")==="map",H=U?M:function(Q,le){return Q.map(me=>DT(me,le))}(M,I),Y=U?B*T:B;for(const Q of g)for(const le of Q){const me=U?le:DT(le,I);let ve=Y;const ke=$g([],[le.x,le.y,0,1],I);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ve*=ke[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ve*=w.cameraToCenterDistance/ke[3]),AD(H,me,ve))return!0}return!1}}function DT(c,s){const u=$g([],[c.x,c.y,0,1],s);return new C(u[0]/u[3],u[1]/u[3])}class FT extends tx{}let NT;Mt("HeatmapBucket",FT,{omit:["layers"]});var zD={get paint(){return NT=NT||new Rr({"heatmap-radius":new rn(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rn(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new If(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(Ae.paint_heatmap["heatmap-opacity"])})}};function sx(c,{width:s,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==s*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${s*u*f}`)}else g=new Uint8Array(s*u*f);return c.width=s,c.height=u,c.data=g,c}function BT(c,{width:s,height:u},f){if(s===c.width&&u===c.height)return;const g=sx({},{width:s,height:u},f);ox(c,g,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,u)},f),c.width=s,c.height=u,c.data=g.data}function ox(c,s,u,f,g,x){if(g.width===0||g.height===0)return s;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>s.width||g.height>s.height||f.x>s.width-g.width||f.y>s.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,T=s.data;if(w===T)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const M=((u.y+I)*c.width+u.x)*x,B=((f.y+I)*s.width+f.x)*x;for(let U=0;U<g.width*x;U++)T[B+U]=w[M+U]}return s}class Bf{constructor(s,u){sx(this,s,1,u)}resize(s){BT(this,s,1)}clone(){return new Bf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){ox(s,u,f,g,x,1)}}class $s{constructor(s,u){sx(this,s,4,u)}resize(s){BT(this,s,4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new $s({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){ox(s,u,f,g,x,4)}}function jT(c){const s={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new $s({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const x=(w,T,I)=>{s[c.evaluationKey]=I;const M=c.expression.evaluate(s);g.data[w+T+0]=Math.floor(255*M.r/M.a),g.data[w+T+1]=Math.floor(255*M.g/M.a),g.data[w+T+2]=Math.floor(255*M.b/M.a),g.data[w+T+3]=Math.floor(255*M.a)};if(c.clips)for(let w=0,T=0;w<f;++w,T+=4*u)for(let I=0,M=0;I<u;I++,M+=4){const B=I/(u-1),{start:U,end:H}=c.clips[w];x(T,M,U*(1-B)+H*B)}else for(let w=0,T=0;w<u;w++,T+=4)x(0,T,w/(u-1));return g}Mt("AlphaImage",Bf),Mt("RGBAImage",$s);class DD extends ks{createBucket(s){return new FT(s)}constructor(s){super(s,zD),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let VT;var FD={get paint(){return VT=VT||new Rr({"hillshade-illumination-direction":new Zt(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(Ae.paint_hillshade["hillshade-accent-color"])})}};class ND extends ks{constructor(s){super(s,FD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const BD=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:jD}=BD;var ax={exports:{}};function Gg(c,s,u){u=u||2;var f,g,x,w,T,I,M,B=s&&s.length,U=B?s[0]*u:c.length,H=UT(c,0,U,u,!0),Y=[];if(!H||H.next===H.prev)return Y;if(B&&(H=function(le,me,ve,ke){var Te,Le,ze,Je=[];for(Te=0,Le=me.length;Te<Le;Te++)(ze=UT(le,me[Te]*ke,Te<Le-1?me[Te+1]*ke:le.length,ke,!1))===ze.next&&(ze.steiner=!0),Je.push(ZD(ze));for(Je.sort(WD),Te=0;Te<Je.length;Te++)ve=HD(Je[Te],ve);return ve}(c,s,H,u)),c.length>80*u){f=x=c[0],g=w=c[1];for(var Q=u;Q<U;Q+=u)(T=c[Q])<f&&(f=T),(I=c[Q+1])<g&&(g=I),T>x&&(x=T),I>w&&(w=I);M=(M=Math.max(x-f,w-g))!==0?32767/M:0}return jf(H,Y,u,f,g,M,0),Y}function UT(c,s,u,f,g){var x,w;if(g===ux(c,s,u,f)>0)for(x=s;x<u;x+=f)w=WT(x,c[x],c[x+1],w);else for(x=u-f;x>=s;x-=f)w=WT(x,c[x],c[x+1],w);return w&&Wg(w,w.next)&&(Uf(w),w=w.next),w}function Kc(c,s){if(!c)return c;s||(s=c);var u,f=c;do if(u=!1,f.steiner||!Wg(f,f.next)&&zr(f.prev,f,f.next)!==0)f=f.next;else{if(Uf(f),(f=s=f.prev)===f.next)break;u=!0}while(u||f!==s);return s}function jf(c,s,u,f,g,x,w){if(c){!w&&x&&function(B,U,H,Y){var Q=B;do Q.z===0&&(Q.z=lx(Q.x,Q.y,U,H,Y)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==B);Q.prevZ.nextZ=null,Q.prevZ=null,function(le){var me,ve,ke,Te,Le,ze,Je,Tt,Nt=1;do{for(ve=le,le=null,Le=null,ze=0;ve;){for(ze++,ke=ve,Je=0,me=0;me<Nt&&(Je++,ke=ke.nextZ);me++);for(Tt=Nt;Je>0||Tt>0&&ke;)Je!==0&&(Tt===0||!ke||ve.z<=ke.z)?(Te=ve,ve=ve.nextZ,Je--):(Te=ke,ke=ke.nextZ,Tt--),Le?Le.nextZ=Te:le=Te,Te.prevZ=Le,Le=Te;ve=ke}Le.nextZ=null,Nt*=2}while(ze>1)}(Q)}(c,f,g,x);for(var T,I,M=c;c.prev!==c.next;)if(T=c.prev,I=c.next,x?UD(c,f,g,x):VD(c))s.push(T.i/u|0),s.push(c.i/u|0),s.push(I.i/u|0),Uf(c),c=I.next,M=I.next;else if((c=I)===M){w?w===1?jf(c=$D(Kc(c),s,u),s,u,f,g,x,2):w===2&&GD(c,s,u,f,g,x):jf(Kc(c),s,u,f,g,x,1);break}}}function VD(c){var s=c.prev,u=c,f=c.next;if(zr(s,u,f)>=0)return!1;for(var g=s.x,x=u.x,w=f.x,T=s.y,I=u.y,M=f.y,B=g<x?g<w?g:w:x<w?x:w,U=T<I?T<M?T:M:I<M?I:M,H=g>x?g>w?g:w:x>w?x:w,Y=T>I?T>M?T:M:I>M?I:M,Q=f.next;Q!==s;){if(Q.x>=B&&Q.x<=H&&Q.y>=U&&Q.y<=Y&&ph(g,T,x,I,w,M,Q.x,Q.y)&&zr(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function UD(c,s,u,f){var g=c.prev,x=c,w=c.next;if(zr(g,x,w)>=0)return!1;for(var T=g.x,I=x.x,M=w.x,B=g.y,U=x.y,H=w.y,Y=T<I?T<M?T:M:I<M?I:M,Q=B<U?B<H?B:H:U<H?U:H,le=T>I?T>M?T:M:I>M?I:M,me=B>U?B>H?B:H:U>H?U:H,ve=lx(Y,Q,s,u,f),ke=lx(le,me,s,u,f),Te=c.prevZ,Le=c.nextZ;Te&&Te.z>=ve&&Le&&Le.z<=ke;){if(Te.x>=Y&&Te.x<=le&&Te.y>=Q&&Te.y<=me&&Te!==g&&Te!==w&&ph(T,B,I,U,M,H,Te.x,Te.y)&&zr(Te.prev,Te,Te.next)>=0||(Te=Te.prevZ,Le.x>=Y&&Le.x<=le&&Le.y>=Q&&Le.y<=me&&Le!==g&&Le!==w&&ph(T,B,I,U,M,H,Le.x,Le.y)&&zr(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;Te&&Te.z>=ve;){if(Te.x>=Y&&Te.x<=le&&Te.y>=Q&&Te.y<=me&&Te!==g&&Te!==w&&ph(T,B,I,U,M,H,Te.x,Te.y)&&zr(Te.prev,Te,Te.next)>=0)return!1;Te=Te.prevZ}for(;Le&&Le.z<=ke;){if(Le.x>=Y&&Le.x<=le&&Le.y>=Q&&Le.y<=me&&Le!==g&&Le!==w&&ph(T,B,I,U,M,H,Le.x,Le.y)&&zr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function $D(c,s,u){var f=c;do{var g=f.prev,x=f.next.next;!Wg(g,x)&&$T(g,f,f.next,x)&&Vf(g,x)&&Vf(x,g)&&(s.push(g.i/u|0),s.push(f.i/u|0),s.push(x.i/u|0),Uf(f),Uf(f.next),f=c=x),f=f.next}while(f!==c);return Kc(f)}function GD(c,s,u,f,g,x){var w=c;do{for(var T=w.next.next;T!==w.prev;){if(w.i!==T.i&&XD(w,T)){var I=GT(w,T);return w=Kc(w,w.next),I=Kc(I,I.next),jf(w,s,u,f,g,x,0),void jf(I,s,u,f,g,x,0)}T=T.next}w=w.next}while(w!==c)}function WD(c,s){return c.x-s.x}function HD(c,s){var u=function(g,x){var w,T=x,I=g.x,M=g.y,B=-1/0;do{if(M<=T.y&&M>=T.next.y&&T.next.y!==T.y){var U=T.x+(M-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(U<=I&&U>B&&(B=U,w=T.x<T.next.x?T:T.next,U===I))return w}T=T.next}while(T!==x);if(!w)return null;var H,Y=w,Q=w.x,le=w.y,me=1/0;T=w;do I>=T.x&&T.x>=Q&&I!==T.x&&ph(M<le?I:B,M,Q,le,M<le?B:I,M,T.x,T.y)&&(H=Math.abs(M-T.y)/(I-T.x),Vf(T,g)&&(H<me||H===me&&(T.x>w.x||T.x===w.x&&qD(w,T)))&&(w=T,me=H)),T=T.next;while(T!==Y);return w}(c,s);if(!u)return s;var f=GT(u,c);return Kc(f,f.next),Kc(u,u.next)}function qD(c,s){return zr(c.prev,c,s.prev)<0&&zr(s.next,c,c.next)<0}function lx(c,s,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function ZD(c){var s=c,u=c;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==c);return u}function ph(c,s,u,f,g,x,w,T){return(g-w)*(s-T)>=(c-w)*(x-T)&&(c-w)*(f-T)>=(u-w)*(s-T)&&(u-w)*(x-T)>=(g-w)*(f-T)}function XD(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&$T(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,s)&&(Vf(c,s)&&Vf(s,c)&&function(u,f){var g=u,x=!1,w=(u.x+f.x)/2,T=(u.y+f.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&w<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(c,s)&&(zr(c.prev,c,s.prev)||zr(c,s.prev,s))||Wg(c,s)&&zr(c.prev,c,c.next)>0&&zr(s.prev,s,s.next)>0)}function zr(c,s,u){return(s.y-c.y)*(u.x-s.x)-(s.x-c.x)*(u.y-s.y)}function Wg(c,s){return c.x===s.x&&c.y===s.y}function $T(c,s,u,f){var g=qg(zr(c,s,u)),x=qg(zr(c,s,f)),w=qg(zr(u,f,c)),T=qg(zr(u,f,s));return g!==x&&w!==T||!(g!==0||!Hg(c,u,s))||!(x!==0||!Hg(c,f,s))||!(w!==0||!Hg(u,c,f))||!(T!==0||!Hg(u,s,f))}function Hg(c,s,u){return s.x<=Math.max(c.x,u.x)&&s.x>=Math.min(c.x,u.x)&&s.y<=Math.max(c.y,u.y)&&s.y>=Math.min(c.y,u.y)}function qg(c){return c>0?1:c<0?-1:0}function Vf(c,s){return zr(c.prev,c,c.next)<0?zr(c,s,c.next)>=0&&zr(c,c.prev,s)>=0:zr(c,s,c.prev)<0||zr(c,c.next,s)<0}function GT(c,s){var u=new cx(c.i,c.x,c.y),f=new cx(s.i,s.x,s.y),g=c.next,x=s.prev;return c.next=s,s.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function WT(c,s,u,f){var g=new cx(c,s,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function Uf(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function cx(c,s,u){this.i=c,this.x=s,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ux(c,s,u,f){for(var g=0,x=s,w=u-f;x<u;x+=f)g+=(c[w]-c[x])*(c[x+1]+c[w+1]),w=x;return g}ax.exports=Gg,ax.exports.default=Gg,Gg.deviation=function(c,s,u,f){var g=s&&s.length,x=Math.abs(ux(c,0,g?s[0]*u:c.length,u));if(g)for(var w=0,T=s.length;w<T;w++)x-=Math.abs(ux(c,s[w]*u,w<T-1?s[w+1]*u:c.length,u));var I=0;for(w=0;w<f.length;w+=3){var M=f[w]*u,B=f[w+1]*u,U=f[w+2]*u;I+=Math.abs((c[M]-c[U])*(c[B+1]-c[M+1])-(c[M]-c[B])*(c[U+1]-c[M+1]))}return x===0&&I===0?0:Math.abs((I-x)/x)},Gg.flatten=function(c){for(var s=c[0][0].length,u={vertices:[],holes:[],dimensions:s},f=0,g=0;g<c.length;g++){for(var x=0;x<c[g].length;x++)for(var w=0;w<s;w++)u.vertices.push(c[g][x][w]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var HT=_(ax.exports);function YD(c,s,u,f,g){qT(c,s,u||0,f||c.length-1,g||KD)}function qT(c,s,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,w=s-u+1,T=Math.log(x),I=.5*Math.exp(2*T/3),M=.5*Math.sqrt(T*I*(x-I)/x)*(w-x/2<0?-1:1);qT(c,s,Math.max(u,Math.floor(s-w*I/x+M)),Math.min(f,Math.floor(s+(x-w)*I/x+M)),g)}var B=c[s],U=u,H=f;for($f(c,u,s),g(c[f],B)>0&&$f(c,u,f);U<H;){for($f(c,U,H),U++,H--;g(c[U],B)<0;)U++;for(;g(c[H],B)>0;)H--}g(c[u],B)===0?$f(c,u,H):$f(c,++H,f),H<=s&&(u=H+1),s<=H&&(f=H-1)}}function $f(c,s,u){var f=c[s];c[s]=c[u],c[u]=f}function KD(c,s){return c<s?-1:c>s?1:0}function hx(c,s){const u=c.length;if(u<=1)return[c];const f=[];let g,x;for(let w=0;w<u;w++){const T=Ze(c[w]);T!==0&&(c[w].area=Math.abs(T),x===void 0&&(x=T<0),x===T<0?(g&&f.push(g),g=[c[w]]):g.push(c[w]))}if(g&&f.push(g),s>1)for(let w=0;w<f.length;w++)f[w].length<=s||(YD(f[w],s,1,f[w].length-1,JD),f[w]=f[w].slice(0,s));return f}function JD(c,s){return s.area-c.area}function dx(c,s,u){const f=u.patternDependencies;let g=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(g=!0);const T=w.constantOr(null);T&&(g=!0,f[T.to]=!0,f[T.from]=!0)}return g}function fx(c,s,u,f,g){const x=g.patternDependencies;for(const w of s){const T=w.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let I=T.evaluate({zoom:f-1},u,{},g.availableImages),M=T.evaluate({zoom:f},u,{},g.availableImages),B=T.evaluate({zoom:f+1},u,{},g.availableImages);I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,B=B&&B.name?B.name:B,x[I]=!0,x[M]=!0,x[B]=!0,u.patterns[w.id]={min:I,mid:M,max:B}}}return u}class px{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Cn,this.indexArray=new pi,this.indexArray2=new Jr,this.programConfigurations=new Yo(s.layers,s.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=dx("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:I,index:M,sourceLayerIndex:B}of s){const U=this.layers[0]._featureFilter.needGeometry,H=Yc(T,U);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f,u.availableImages):void 0,Q={id:I,properties:T.properties,type:T.type,sourceLayerIndex:B,index:M,geometry:U?H.geometry:Xc(T),patterns:{},sortKey:Y};w.push(Q)}x&&w.sort((T,I)=>T.sortKey-I.sortKey);for(const T of w){const{geometry:I,index:M,sourceLayerIndex:B}=T;if(this.hasPattern){const U=fx("fill",this.layers,T,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(T,I,M,f,{});u.featureIndex.insert(s[M].feature,I,M,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,f,g,x){for(const w of hx(u,500)){let T=0;for(const Y of w)T+=Y.length;const I=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),M=I.vertexLength,B=[],U=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&U.push(B.length/2);const Q=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),le=Q.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(le+Y.length-1,le),B.push(Y[0].x),B.push(Y[0].y);for(let me=1;me<Y.length;me++)this.layoutVertexArray.emplaceBack(Y[me].x,Y[me].y),this.indexArray2.emplaceBack(le+me-1,le+me),B.push(Y[me].x),B.push(Y[me].y);Q.vertexLength+=Y.length,Q.primitiveLength+=Y.length}const H=HT(B,U);for(let Y=0;Y<H.length;Y+=3)this.indexArray.emplaceBack(M+H[Y],M+H[Y+1],M+H[Y+2]);I.vertexLength+=T,I.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}let ZT,XT;Mt("FillBucket",px,{omit:["layers","patternFeatures"]});var QD={get paint(){return XT=XT||new Rr({"fill-antialias":new Zt(Ae.paint_fill["fill-antialias"]),"fill-opacity":new rn(Ae.paint_fill["fill-opacity"]),"fill-color":new rn(Ae.paint_fill["fill-color"]),"fill-outline-color":new rn(Ae.paint_fill["fill-outline-color"]),"fill-translate":new Zt(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new Hc(Ae.paint_fill["fill-pattern"])})},get layout(){return ZT=ZT||new Rr({"fill-sort-key":new rn(Ae.layout_fill["fill-sort-key"])})}};class eF extends ks{constructor(s){super(s,QD)}recalculate(s,u){super.recalculate(s,u);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new px(s)}queryRadius(){return Vg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){return kT(Ug(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,T),g)}isTileClipped(){return!0}}const tF=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),nF=yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:rF}=tF;var Bl={},iF=S,YT=mh;function mh(c,s,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(sF,this,s)}function sF(c,s,u){c==1?s.id=u.readVarint():c==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var w=g._keys[f.readVarint()],T=g._values[f.readVarint()];g.properties[w]=T}}(u,s):c==3?s.type=u.readVarint():c==4&&(s._geometry=u.pos)}function oF(c){for(var s,u,f=0,g=0,x=c.length,w=x-1;g<x;w=g++)f+=((u=c[w]).x-(s=c[g]).x)*(s.y+u.y);return f}mh.types=["Unknown","Point","LineString","Polygon"],mh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,u=c.readVarint()+c.pos,f=1,g=0,x=0,w=0,T=[];c.pos<u;){if(g<=0){var I=c.readVarint();f=7&I,g=I>>3}if(g--,f===1||f===2)x+=c.readSVarint(),w+=c.readSVarint(),f===1&&(s&&T.push(s),s=[]),s.push(new iF(x,w));else{if(f!==7)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&T.push(s),T},mh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,u=1,f=0,g=0,x=0,w=1/0,T=-1/0,I=1/0,M=-1/0;c.pos<s;){if(f<=0){var B=c.readVarint();u=7&B,f=B>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<w&&(w=g),g>T&&(T=g),(x+=c.readSVarint())<I&&(I=x),x>M&&(M=x);else if(u!==7)throw new Error("unknown command "+u)}return[w,I,T,M]},mh.prototype.toGeoJSON=function(c,s,u){var f,g,x=this.extent*Math.pow(2,u),w=this.extent*c,T=this.extent*s,I=this.loadGeometry(),M=mh.types[this.type];function B(Y){for(var Q=0;Q<Y.length;Q++){var le=Y[Q];Y[Q]=[360*(le.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+T)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(f=0;f<I.length;f++)U[f]=I[f][0];B(I=U);break;case 2:for(f=0;f<I.length;f++)B(I[f]);break;case 3:for(I=function(Y){var Q=Y.length;if(Q<=1)return[Y];for(var le,me,ve=[],ke=0;ke<Q;ke++){var Te=oF(Y[ke]);Te!==0&&(me===void 0&&(me=Te<0),me===Te<0?(le&&ve.push(le),le=[Y[ke]]):le.push(Y[ke]))}return le&&ve.push(le),ve}(I),f=0;f<I.length;f++)for(g=0;g<I[f].length;g++)B(I[f][g])}I.length===1?I=I[0]:M="Multi"+M;var H={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(H.id=this.id),H};var aF=YT,KT=JT;function JT(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(lF,this,s),this.length=this._features.length}function lF(c,s,u){c===15?s.version=u.readVarint():c===1?s.name=u.readString():c===5?s.extent=u.readVarint():c===2?s._features.push(u.pos):c===3?s._keys.push(u.readString()):c===4&&s._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var w=f.readVarint()>>3;g=w===1?f.readString():w===2?f.readFloat():w===3?f.readDouble():w===4?f.readVarint64():w===5?f.readVarint():w===6?f.readSVarint():w===7?f.readBoolean():null}return g}(u))}JT.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new aF(this._pbf,s,this.extent,this._keys,this._values)};var cF=KT;function uF(c,s,u){if(c===3){var f=new cF(u,u.readVarint()+u.pos);f.length&&(s[f.name]=f)}}Bl.VectorTile=function(c,s){this.layers=c.readFields(uF,{},s)},Bl.VectorTileFeature=YT,Bl.VectorTileLayer=KT;const hF=Bl.VectorTileFeature.types,mx=Math.pow(2,13);function Gf(c,s,u,f,g,x,w,T){c.emplaceBack(s,u,2*Math.floor(f*mx)+w,g*mx*2,x*mx*2,Math.round(T))}class gx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new gt,this.centroidVertexArray=new ct,this.indexArray=new pi,this.programConfigurations=new Yo(s.layers,s.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.features=[],this.hasPattern=dx("fill-extrusion",this.layers,u);for(const{feature:g,id:x,index:w,sourceLayerIndex:T}of s){const I=this.layers[0]._featureFilter.needGeometry,M=Yc(g,I);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),M,f))continue;const B={id:x,sourceLayerIndex:T,index:w,geometry:I?M.geometry:Xc(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(fx("fill-extrusion",this.layers,B,this.zoom,u)):this.addFeature(B,B.geometry,w,f,{}),u.featureIndex.insert(g,B.geometry,w,T,this.index,!0)}}addFeatures(s,u,f){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,u,f)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rF),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,nF.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,u,f,g,x){const w={x:0,y:0,vertexCount:0};for(const T of hx(u,500)){let I=0;for(const Q of T)I+=Q.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Q of T){if(Q.length===0||fF(Q))continue;let le=0;for(let me=0;me<Q.length;me++){const ve=Q[me];if(me>=1){const ke=Q[me-1];if(!dF(ve,ke)){M.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Te=ve.sub(ke)._perp()._unit(),Le=ke.dist(ve);le+Le>32768&&(le=0),Gf(this.layoutVertexArray,ve.x,ve.y,Te.x,Te.y,0,0,le),Gf(this.layoutVertexArray,ve.x,ve.y,Te.x,Te.y,0,1,le),w.x+=2*ve.x,w.y+=2*ve.y,w.vertexCount+=2,le+=Le,Gf(this.layoutVertexArray,ke.x,ke.y,Te.x,Te.y,0,0,le),Gf(this.layoutVertexArray,ke.x,ke.y,Te.x,Te.y,0,1,le),w.x+=2*ke.x,w.y+=2*ke.y,w.vertexCount+=2;const ze=M.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+I>or.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),hF[s.type]!=="Polygon")continue;const B=[],U=[],H=M.vertexLength;for(const Q of T)if(Q.length!==0){Q!==T[0]&&U.push(B.length/2);for(let le=0;le<Q.length;le++){const me=Q[le];Gf(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),w.x+=me.x,w.y+=me.y,w.vertexCount+=1,B.push(me.x),B.push(me.y)}}const Y=HT(B,U);for(let Q=0;Q<Y.length;Q+=3)this.indexArray.emplaceBack(H+Y[Q],H+Y[Q+2],H+Y[Q+1]);M.primitiveLength+=Y.length/3,M.vertexLength+=I}for(let T=0;T<w.vertexCount;T++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}function dF(c,s){return c.x===s.x&&(c.x<0||c.x>$r)||c.y===s.y&&(c.y<0||c.y>$r)}function fF(c){return c.every(s=>s.x<0)||c.every(s=>s.x>$r)||c.every(s=>s.y<0)||c.every(s=>s.y>$r)}let QT;Mt("FillExtrusionBucket",gx,{omit:["layers","features"]});var pF={get paint(){return QT=QT||new Rr({"fill-extrusion-opacity":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rn(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Hc(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rn(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rn(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class mF extends ks{constructor(s){super(s,pF)}createBucket(s){return new gx(s)}queryRadius(){return Vg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,u,f,g,x,w,T,I){const M=Ug(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,T),B=this.paint.get("fill-extrusion-height").evaluate(u,f),U=this.paint.get("fill-extrusion-base").evaluate(u,f),H=function(Q,le,me,ve){const ke=[];for(const Te of Q){const Le=[Te.x,Te.y,0,1];$g(Le,Le,le),ke.push(new C(Le[0]/Le[3],Le[1]/Le[3]))}return ke}(M,I),Y=function(Q,le,me,ve){const ke=[],Te=[],Le=ve[8]*le,ze=ve[9]*le,Je=ve[10]*le,Tt=ve[11]*le,Nt=ve[8]*me,wt=ve[9]*me,yt=ve[10]*me,dt=ve[11]*me;for(const Lt of Q){const pt=[],it=[];for(const Jt of Lt){const Ut=Jt.x,Sn=Jt.y,ar=ve[0]*Ut+ve[4]*Sn+ve[12],fr=ve[1]*Ut+ve[5]*Sn+ve[13],ti=ve[2]*Ut+ve[6]*Sn+ve[14],Ls=ve[3]*Ut+ve[7]*Sn+ve[15],Yi=ti+Je,Gr=Ls+Tt,gi=ar+Nt,Ti=fr+wt,Ki=ti+yt,Ji=Ls+dt,ni=new C((ar+Le)/Gr,(fr+ze)/Gr);ni.z=Yi/Gr,pt.push(ni);const ri=new C(gi/Ji,Ti/Ji);ri.z=Ki/Ji,it.push(ri)}ke.push(pt),Te.push(it)}return[ke,Te]}(g,U,B,I);return function(Q,le,me){let ve=1/0;kT(me,le)&&(ve=eE(me,le[0]));for(let ke=0;ke<le.length;ke++){const Te=le[ke],Le=Q[ke];for(let ze=0;ze<Te.length-1;ze++){const Je=Te[ze],Tt=[Je,Te[ze+1],Le[ze+1],Le[ze],Je];IT(me,Tt)&&(ve=Math.min(ve,eE(me,Tt)))}}return ve!==1/0&&ve}(Y[0],Y[1],H)}}function Wf(c,s){return c.x*s.x+c.y*s.y}function eE(c,s){if(c.length===1){let u=0;const f=s[u++];let g;for(;!g||f.equals(g);)if(g=s[u++],!g)return 1/0;for(;u<s.length;u++){const x=s[u],w=c[0],T=g.sub(f),I=x.sub(f),M=w.sub(f),B=Wf(T,T),U=Wf(T,I),H=Wf(I,I),Y=Wf(M,T),Q=Wf(M,I),le=B*H-U*U,me=(H*Y-U*Q)/le,ve=(B*Q-U*Y)/le,ke=f.z*(1-me-ve)+g.z*me+x.z*ve;if(isFinite(ke))return ke}return 1/0}{let u=1/0;for(const f of s)u=Math.min(u,f.z);return u}}const gF=yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:yF}=gF,_F=yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:vF}=_F,xF=Bl.VectorTileFeature.types,bF=Math.cos(Math.PI/180*37.5),tE=Math.pow(2,14)/.5;class yx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new sn,this.layoutVertexArray2=new jt,this.indexArray=new pi,this.programConfigurations=new Yo(s.layers,s.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=dx("line",this.layers,u);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:I,index:M,sourceLayerIndex:B}of s){const U=this.layers[0]._featureFilter.needGeometry,H=Yc(T,U);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f):void 0,Q={id:I,properties:T.properties,type:T.type,sourceLayerIndex:B,index:M,geometry:U?H.geometry:Xc(T),patterns:{},sortKey:Y};w.push(Q)}x&&w.sort((T,I)=>T.sortKey-I.sortKey);for(const T of w){const{geometry:I,index:M,sourceLayerIndex:B}=T;if(this.hasPattern){const U=fx("line",this.layers,T,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(T,I,M,f,{});u.featureIndex.insert(s[M].feature,I,M,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,vF)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,yF),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,f,g,x){const w=this.layers[0].layout,T=w.get("line-join").evaluate(s,{}),I=w.get("line-cap"),M=w.get("line-miter-limit"),B=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const U of u)this.addLine(U,s,T,I,M,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}addLine(s,u,f,g,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<s.length-1;ve++)this.totalDistance+=s[ve].dist(s[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=xF[u.type]==="Polygon";let I=s.length;for(;I>=2&&s[I-1].equals(s[I-2]);)I--;let M=0;for(;M<I-1&&s[M].equals(s[M+1]);)M++;if(I<(T?3:2))return;f==="bevel"&&(x=1.05);const B=this.overscaling<=16?15*$r/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let H,Y,Q,le,me;this.e1=this.e2=-1,T&&(H=s[I-2],me=s[M].sub(H)._unit()._perp());for(let ve=M;ve<I;ve++){if(Q=ve===I-1?T?s[M+1]:void 0:s[ve+1],Q&&s[ve].equals(Q))continue;me&&(le=me),H&&(Y=H),H=s[ve],me=Q?Q.sub(H)._unit()._perp():le,le=le||me;let ke=le.add(me);ke.x===0&&ke.y===0||ke._unit();const Te=le.x*me.x+le.y*me.y,Le=ke.x*me.x+ke.y*me.y,ze=Le!==0?1/Le:1/0,Je=2*Math.sqrt(2-2*Le),Tt=Le<bF&&Y&&Q,Nt=le.x*me.y-le.y*me.x>0;if(Tt&&ve>M){const dt=H.dist(Y);if(dt>2*B){const Lt=H.sub(H.sub(Y)._mult(B/dt)._round());this.updateDistance(Y,Lt),this.addCurrentVertex(Lt,le,0,0,U),Y=Lt}}const wt=Y&&Q;let yt=wt?f:T?"butt":g;if(wt&&yt==="round"&&(ze<w?yt="miter":ze<=2&&(yt="fakeround")),yt==="miter"&&ze>x&&(yt="bevel"),yt==="bevel"&&(ze>2&&(yt="flipbevel"),ze<x&&(yt="miter")),Y&&this.updateDistance(Y,H),yt==="miter")ke._mult(ze),this.addCurrentVertex(H,ke,0,0,U);else if(yt==="flipbevel"){if(ze>100)ke=me.mult(-1);else{const dt=ze*le.add(me).mag()/le.sub(me).mag();ke._perp()._mult(dt*(Nt?-1:1))}this.addCurrentVertex(H,ke,0,0,U),this.addCurrentVertex(H,ke.mult(-1),0,0,U)}else if(yt==="bevel"||yt==="fakeround"){const dt=-Math.sqrt(ze*ze-1),Lt=Nt?dt:0,pt=Nt?0:dt;if(Y&&this.addCurrentVertex(H,le,Lt,pt,U),yt==="fakeround"){const it=Math.round(180*Je/Math.PI/20);for(let Jt=1;Jt<it;Jt++){let Ut=Jt/it;if(Ut!==.5){const ar=Ut-.5;Ut+=Ut*ar*(Ut-1)*((1.0904+Te*(Te*(3.55645-1.43519*Te)-3.2452))*ar*ar+(.848013+Te*(.215638*Te-1.06021)))}const Sn=me.sub(le)._mult(Ut)._add(le)._unit()._mult(Nt?-1:1);this.addHalfVertex(H,Sn.x,Sn.y,!1,Nt,0,U)}}Q&&this.addCurrentVertex(H,me,-Lt,-pt,U)}else if(yt==="butt")this.addCurrentVertex(H,ke,0,0,U);else if(yt==="square"){const dt=Y?1:-1;this.addCurrentVertex(H,ke,dt,dt,U)}else yt==="round"&&(Y&&(this.addCurrentVertex(H,le,0,0,U),this.addCurrentVertex(H,le,1,1,U,!0)),Q&&(this.addCurrentVertex(H,me,-1,-1,U,!0),this.addCurrentVertex(H,me,0,0,U)));if(Tt&&ve<I-1){const dt=H.dist(Q);if(dt>2*B){const Lt=H.add(Q.sub(H)._mult(B/dt)._round());this.updateDistance(H,Lt),this.addCurrentVertex(Lt,me,0,0,U),H=Lt}}}}addCurrentVertex(s,u,f,g,x,w=!1){const T=u.y*g-u.x,I=-u.y-u.x*g;this.addHalfVertex(s,u.x+u.y*f,u.y-u.x*f,w,!1,f,x),this.addHalfVertex(s,T,I,w,!0,-g,x),this.distance>tE/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,u,f,g,x,w))}addHalfVertex({x:s,y:u},f,g,x,w,T,I){const M=.5*(this.lineClips?this.scaledDistance*(tE-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(u<<1)+(w?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),I.primitiveLength++),w?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,u){this.distance+=s.dist(u),this.updateScaledDistance()}}let nE,rE;Mt("LineBucket",yx,{omit:["layers","patternFeatures"]});var iE={get paint(){return rE=rE||new Rr({"line-opacity":new rn(Ae.paint_line["line-opacity"]),"line-color":new rn(Ae.paint_line["line-color"]),"line-translate":new Zt(Ae.paint_line["line-translate"]),"line-translate-anchor":new Zt(Ae.paint_line["line-translate-anchor"]),"line-width":new rn(Ae.paint_line["line-width"]),"line-gap-width":new rn(Ae.paint_line["line-gap-width"]),"line-offset":new rn(Ae.paint_line["line-offset"]),"line-blur":new rn(Ae.paint_line["line-blur"]),"line-dasharray":new Af(Ae.paint_line["line-dasharray"]),"line-pattern":new Hc(Ae.paint_line["line-pattern"]),"line-gradient":new If(Ae.paint_line["line-gradient"])})},get layout(){return nE=nE||new Rr({"line-cap":new Zt(Ae.layout_line["line-cap"]),"line-join":new rn(Ae.layout_line["line-join"]),"line-miter-limit":new Zt(Ae.layout_line["line-miter-limit"]),"line-round-limit":new Zt(Ae.layout_line["line-round-limit"]),"line-sort-key":new rn(Ae.layout_line["line-sort-key"])})}};class wF extends rn{possiblyEvaluate(s,u){return u=new sr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,f,g){return u=xe({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,f,g)}}let Zg;class SF extends ks{constructor(s){super(s,iE),this.gradientVersion=0,Zg||(Zg=new wF(iE.paint.properties["line-width"].specification),Zg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof pa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,u){super.recalculate(s,u),this.paint._values["line-floorwidth"]=Zg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new yx(s)}queryRadius(s){const u=s,f=sE(Ff("line-width",this,u),Ff("line-gap-width",this,u)),g=Ff("line-offset",this,u);return f/2+Math.abs(g)+Vg(this.paint.get("line-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){const I=Ug(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,T),M=T/2*sE(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(g=function(U,H){const Y=[];for(let Q=0;Q<U.length;Q++){const le=U[Q],me=[];for(let ve=0;ve<le.length;ve++){const ke=le[ve-1],Te=le[ve],Le=le[ve+1],ze=ve===0?new C(0,0):Te.sub(ke)._unit()._perp(),Je=ve===le.length-1?new C(0,0):Le.sub(Te)._unit()._perp(),Tt=ze._add(Je)._unit(),Nt=Tt.x*Je.x+Tt.y*Je.y;Nt!==0&&Tt._mult(1/Nt),me.push(Tt._mult(H)._add(Te))}Y.push(me)}return Y}(g,B*T)),function(U,H,Y){for(let Q=0;Q<H.length;Q++){const le=H[Q];if(U.length>=3){for(let me=0;me<le.length;me++)if(dh(U,le[me]))return!0}if(ID(U,le,Y))return!0}return!1}(I,g,M)}isTileClipped(){return!0}}function sE(c,s){return s>0?s+2*c:c}const TF=yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),EF=yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const PF=yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const oE=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),CF=yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function AF(c,s,u){return c.sections.forEach(f=>{f.text=function(g,x,w){const T=x.layout.get("text-transform").evaluate(w,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),ps.applyArabicShaping&&(g=ps.applyArabicShaping(g)),g}(f.text,s,u)}),c}yr([{name:"triangle",components:3,type:"Uint16"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),yr([{type:"Float32",name:"offsetX"}]),yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Hf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ei=24,aE=Xn,lE=function(c,s,u,f,g){var x,w,T=8*g-f-1,I=(1<<T)-1,M=I>>1,B=-7,U=u?g-1:0,H=u?-1:1,Y=c[s+U];for(U+=H,x=Y&(1<<-B)-1,Y>>=-B,B+=T;B>0;x=256*x+c[s+U],U+=H,B-=8);for(w=x&(1<<-B)-1,x>>=-B,B+=f;B>0;w=256*w+c[s+U],U+=H,B-=8);if(x===0)x=1-M;else{if(x===I)return w?NaN:1/0*(Y?-1:1);w+=Math.pow(2,f),x-=M}return(Y?-1:1)*w*Math.pow(2,x-f)},cE=function(c,s,u,f,g,x){var w,T,I,M=8*x-g-1,B=(1<<M)-1,U=B>>1,H=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,Q=f?1:-1,le=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(T=isNaN(s)?1:0,w=B):(w=Math.floor(Math.log(s)/Math.LN2),s*(I=Math.pow(2,-w))<1&&(w--,I*=2),(s+=w+U>=1?H/I:H*Math.pow(2,1-U))*I>=2&&(w++,I/=2),w+U>=B?(T=0,w=B):w+U>=1?(T=(s*I-1)*Math.pow(2,g),w+=U):(T=s*Math.pow(2,U-1)*Math.pow(2,g),w=0));g>=8;c[u+Y]=255&T,Y+=Q,T/=256,g-=8);for(w=w<<g|T,M+=g;M>0;c[u+Y]=255&w,Y+=Q,w/=256,M-=8);c[u+Y-Q]|=128*le};function Xn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var _x=4294967296,uE=1/_x,hE=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ka(c){return c.type===Xn.Bytes?c.readVarint()+c.pos:c.pos+1}function gh(c,s,u){return u?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function dE(c,s,u){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function IF(c,s){for(var u=0;u<c.length;u++)s.writeVarint(c[u])}function kF(c,s){for(var u=0;u<c.length;u++)s.writeSVarint(c[u])}function MF(c,s){for(var u=0;u<c.length;u++)s.writeFloat(c[u])}function LF(c,s){for(var u=0;u<c.length;u++)s.writeDouble(c[u])}function RF(c,s){for(var u=0;u<c.length;u++)s.writeBoolean(c[u])}function OF(c,s){for(var u=0;u<c.length;u++)s.writeFixed32(c[u])}function zF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed32(c[u])}function DF(c,s){for(var u=0;u<c.length;u++)s.writeFixed64(c[u])}function FF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed64(c[u])}function Xg(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function yh(c,s,u){c[u]=s,c[u+1]=s>>>8,c[u+2]=s>>>16,c[u+3]=s>>>24}function fE(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}Xn.prototype={destroy:function(){this.buf=null},readFields:function(c,s,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,c(g,s,this),this.pos===x&&this.skip(f)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=Xg(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=fE(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=Xg(this.buf,this.pos)+Xg(this.buf,this.pos+4)*_x;return this.pos+=8,c},readSFixed64:function(){var c=Xg(this.buf,this.pos)+fE(this.buf,this.pos+4)*_x;return this.pos+=8,c},readFloat:function(){var c=lE(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=lE(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,u,f=this.buf;return s=127&(u=f[this.pos++]),u<128?s:(s|=(127&(u=f[this.pos++]))<<7,u<128?s:(s|=(127&(u=f[this.pos++]))<<14,u<128?s:(s|=(127&(u=f[this.pos++]))<<21,u<128?s:function(g,x,w){var T,I,M=w.buf;if(T=(112&(I=M[w.pos++]))>>4,I<128||(T|=(127&(I=M[w.pos++]))<<3,I<128)||(T|=(127&(I=M[w.pos++]))<<10,I<128)||(T|=(127&(I=M[w.pos++]))<<17,I<128)||(T|=(127&(I=M[w.pos++]))<<24,I<128)||(T|=(1&(I=M[w.pos++]))<<31,I<128))return gh(g,T,x);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&hE?function(u,f,g){return hE.decode(u.subarray(f,g))}(this.buf,s,c):function(u,f,g){for(var x="",w=f;w<g;){var T,I,M,B=u[w],U=null,H=B>239?4:B>223?3:B>191?2:1;if(w+H>g)break;H===1?B<128&&(U=B):H===2?(192&(T=u[w+1]))==128&&(U=(31&B)<<6|63&T)<=127&&(U=null):H===3?(I=u[w+2],(192&(T=u[w+1]))==128&&(192&I)==128&&((U=(15&B)<<12|(63&T)<<6|63&I)<=2047||U>=55296&&U<=57343)&&(U=null)):H===4&&(I=u[w+2],M=u[w+3],(192&(T=u[w+1]))==128&&(192&I)==128&&(192&M)==128&&((U=(15&B)<<18|(63&T)<<12|(63&I)<<6|63&M)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,H=1):U>65535&&(U-=65536,x+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),x+=String.fromCharCode(U),w+=H}return x}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Xn.Bytes)return c.push(this.readVarint(s));var u=Ka(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSVarint());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Xn.Bytes)return c.push(this.readBoolean());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFloat());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Xn.Bytes)return c.push(this.readDouble());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed32());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed32());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed64());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed64());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Xn.Fixed32)this.pos+=4;else{if(s!==Xn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var u=new Uint8Array(s);u.set(this.buf),this.buf=u,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),yh(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),yh(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),yh(this.buf,-1&c,this.pos),yh(this.buf,Math.floor(c*uE),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),yh(this.buf,-1&c,this.pos),yh(this.buf,Math.floor(c*uE),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,u){var f,g;if(s>=0?(f=s%4294967296|0,g=s/4294967296|0):(g=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,g=g+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,w,T){T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,T.buf[T.pos]=127&(x>>>=7)}(f,0,u),function(x,w){var T=(7&x)<<4;w.buf[w.pos++]|=T|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(f,g,x){for(var w,T,I=0;I<g.length;I++){if((w=g.charCodeAt(I))>55295&&w<57344){if(!T){w>56319||I+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):T=w;continue}if(w<56320){f[x++]=239,f[x++]=191,f[x++]=189,T=w;continue}w=T-55296<<10|w-56320|65536,T=null}else T&&(f[x++]=239,f[x++]=191,f[x++]=189,T=null);w<128?f[x++]=w:(w<2048?f[x++]=w>>6|192:(w<65536?f[x++]=w>>12|224:(f[x++]=w>>18|240,f[x++]=w>>12&63|128),f[x++]=w>>6&63|128),f[x++]=63&w|128)}return x}(this.buf,c,this.pos);var u=this.pos-s;u>=128&&dE(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),cE(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),cE(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var u=0;u<s;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,s){this.pos++;var u=this.pos;c(s,this);var f=this.pos-u;f>=128&&dE(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,s,u){this.writeTag(c,Xn.Bytes),this.writeRawMessage(s,u)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,IF,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,kF,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,RF,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,MF,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,LF,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,OF,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,zF,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,DF,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,FF,s)},writeBytesField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var vx=_(aE);const xx=3;function NF(c,s,u){c===1&&u.readMessage(BF,s)}function BF(c,s,u){if(c===3){const{id:f,bitmap:g,width:x,height:w,left:T,top:I,advance:M}=u.readMessage(jF,{});s.push({id:f,bitmap:new Bf({width:x+2*xx,height:w+2*xx},g),metrics:{width:x,height:w,left:T,top:I,advance:M}})}}function jF(c,s,u){c===1?s.id=u.readVarint():c===2?s.bitmap=u.readBytes():c===3?s.width=u.readVarint():c===4?s.height=u.readVarint():c===5?s.left=u.readSVarint():c===6?s.top=u.readSVarint():c===7&&(s.advance=u.readVarint())}const pE=xx;function mE(c){let s=0,u=0;for(const w of c)s+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,T)=>T.h-w.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let g=0,x=0;for(const w of c)for(let T=f.length-1;T>=0;T--){const I=f[T];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,x=Math.max(x,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===I.w&&w.h===I.h){const M=f.pop();T<f.length&&(f[T]=M)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(f.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:g,h:x,fill:s/(g*x)||0}}const gs=1;class bx{constructor(s,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:w}){this.paddedRect=s,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=w,this.version=f}get tl(){return[this.paddedRect.x+gs,this.paddedRect.y+gs]}get br(){return[this.paddedRect.x+this.paddedRect.w-gs,this.paddedRect.y+this.paddedRect.h-gs]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*gs)/this.pixelRatio,(this.paddedRect.h-2*gs)/this.pixelRatio]}}class gE{constructor(s,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,f,x),this.addImages(u,g,x);const{w,h:T}=mE(x),I=new $s({width:w||1,height:T||1});for(const M in s){const B=s[M],U=f[M].paddedRect;$s.copy(B.data,I,{x:0,y:0},{x:U.x+gs,y:U.y+gs},B.data)}for(const M in u){const B=u[M],U=g[M].paddedRect,H=U.x+gs,Y=U.y+gs,Q=B.data.width,le=B.data.height;$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y},B.data),$s.copy(B.data,I,{x:0,y:le-1},{x:H,y:Y-1},{width:Q,height:1}),$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y+le},{width:Q,height:1}),$s.copy(B.data,I,{x:Q-1,y:0},{x:H-1,y:Y},{width:1,height:le}),$s.copy(B.data,I,{x:0,y:0},{x:H+Q,y:Y},{width:1,height:le})}this.image=I,this.iconPositions=f,this.patternPositions=g}addImages(s,u,f){for(const g in s){const x=s[g],w={x:0,y:0,w:x.data.width+2*gs,h:x.data.height+2*gs};f.push(w),u[g]=new bx(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(s,u){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),u)}patchUpdatedImage(s,u,f){if(!s||!u||s.version===u.version)return;s.version=u.version;const[g,x]=s.tl;f.update(u.data,void 0,{x:g,y:x})}}var jl;Mt("ImagePosition",bx),Mt("ImageAtlas",gE),l.ai=void 0,(jl=l.ai||(l.ai={}))[jl.none=0]="none",jl[jl.horizontal=1]="horizontal",jl[jl.vertical=2]="vertical",jl[jl.horizontalOnly=3]="horizontalOnly";const qf=-17;class Zf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,u){const f=new Zf;return f.scale=s||1,f.fontStack=u,f}static forImage(s){const u=new Zf;return u.imageName=s,u}}class _h{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const f=new _h;for(let g=0;g<s.sections.length;g++){const x=s.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let u="";for(let f=0;f<s.length;f++){const g=s.charCodeAt(f+1)||null,x=s.charCodeAt(f-1)||null;u+=g&&kg(g)&&!Hf[s[f+1]]||x&&kg(x)&&!Hf[s[f-1]]||!Hf[s[f]]?s[f]:Hf[s[f]]}return u}(this.text)}trim(){let s=0;for(let f=0;f<this.text.length&&Kg[this.text.charCodeAt(f)];f++)s++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&Kg[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const f=new _h;return f.text=this.text.substring(s,u),f.sectionIndex=this.sectionIndex.slice(s,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(Zf.forText(s.scale,s.fontStack||u));const f=this.sections.length-1;for(let g=0;g<s.text.length;++g)this.sectionIndex.push(f)}addImageSection(s){const u=s.image?s.image.name:"";if(u.length===0)return void je("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Zf.forImage(u)),this.sectionIndex.push(this.sections.length-1)):je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yg(c,s,u,f,g,x,w,T,I,M,B,U,H,Y,Q,le){const me=_h.fromFeature(c,g);let ve;U===l.ai.vertical&&me.verticalizePunctuation();const{processBidirectionalText:ke,processStyledBidirectionalText:Te}=ps;if(ke&&me.sections.length===1){ve=[];const Je=ke(me.toString(),wx(me,M,x,s,f,Y,Q));for(const Tt of Je){const Nt=new _h;Nt.text=Tt,Nt.sections=me.sections;for(let wt=0;wt<Tt.length;wt++)Nt.sectionIndex.push(0);ve.push(Nt)}}else if(Te){ve=[];const Je=Te(me.text,me.sectionIndex,wx(me,M,x,s,f,Y,Q));for(const Tt of Je){const Nt=new _h;Nt.text=Tt[0],Nt.sectionIndex=Tt[1],Nt.sections=me.sections,ve.push(Nt)}}else ve=function(Je,Tt){const Nt=[],wt=Je.text;let yt=0;for(const dt of Tt)Nt.push(Je.substring(yt,dt)),yt=dt;return yt<wt.length&&Nt.push(Je.substring(yt,wt.length)),Nt}(me,wx(me,M,x,s,f,Y,Q));const Le=[],ze={positionedLines:Le,text:me.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(Je,Tt,Nt,wt,yt,dt,Lt,pt,it,Jt,Ut,Sn){let ar=0,fr=qf,ti=0,Ls=0;const Yi=pt==="right"?1:pt==="left"?0:.5;let Gr=0;for(const ni of yt){ni.trim();const ri=ni.getMaxScale(),Ri=(ri-1)*ei,Qi={positionedGlyphs:[],lineOffset:0};Je.positionedLines[Gr]=Qi;const Oi=Qi.positionedGlyphs;let ys=0;if(!ni.length()){fr+=dt,++Gr;continue}for(let ii=0;ii<ni.length();ii++){const Mn=ni.getSection(ii),zi=ni.getSectionIndex(ii),Ei=ni.getCharCode(ii);let si=0,wo=null,Ko=null,Jo=null,Ja=ei;const So=!(it===l.ai.horizontal||!Ut&&!xf(Ei)||Ut&&(Kg[Ei]||(gi=Ei,St.Arabic(gi)||St["Arabic Supplement"](gi)||St["Arabic Extended-A"](gi)||St["Arabic Presentation Forms-A"](gi)||St["Arabic Presentation Forms-B"](gi))));if(Mn.imageName){const Ws=wt[Mn.imageName];if(!Ws)continue;Jo=Mn.imageName,Je.iconsInText=Je.iconsInText||!0,Ko=Ws.paddedRect;const vs=Ws.displaySize;Mn.scale=Mn.scale*ei/Sn,wo={width:vs[0],height:vs[1],left:gs,top:-pE,advance:So?vs[1]:vs[0]},si=Ri+(ei-vs[1]*Mn.scale),Ja=wo.advance;const Qa=So?vs[0]*Mn.scale-ei*ri:vs[1]*Mn.scale-ei*ri;Qa>0&&Qa>ys&&(ys=Qa)}else{const Ws=Nt[Mn.fontStack],vs=Ws&&Ws[Ei];if(vs&&vs.rect)Ko=vs.rect,wo=vs.metrics;else{const Qa=Tt[Mn.fontStack],Qf=Qa&&Qa[Ei];if(!Qf)continue;wo=Qf.metrics}si=(ri-Mn.scale)*ei}So?(Je.verticalizable=!0,Oi.push({glyph:Ei,imageName:Jo,x:ar,y:fr+si,vertical:So,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:zi,metrics:wo,rect:Ko}),ar+=Ja*Mn.scale+Jt):(Oi.push({glyph:Ei,imageName:Jo,x:ar,y:fr+si,vertical:So,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:zi,metrics:wo,rect:Ko}),ar+=wo.advance*Mn.scale+Jt)}Oi.length!==0&&(ti=Math.max(ar-Jt,ti),$F(Oi,0,Oi.length-1,Yi,ys)),ar=0;const _s=dt*ri+ys;Qi.lineOffset=Math.max(ys,Ri),fr+=_s,Ls=Math.max(_s,Ls),++Gr}var gi;const Ti=fr-qf,{horizontalAlign:Ki,verticalAlign:Ji}=Sx(Lt);(function(ni,ri,Ri,Qi,Oi,ys,_s,ii,Mn){const zi=(ri-Ri)*Oi;let Ei=0;Ei=ys!==_s?-ii*Qi-qf:(-Qi*Mn+.5)*_s;for(const si of ni)for(const wo of si.positionedGlyphs)wo.x+=zi,wo.y+=Ei})(Je.positionedLines,Yi,Ki,Ji,ti,Ls,dt,Ti,yt.length),Je.top+=-Ji*Ti,Je.bottom=Je.top+Ti,Je.left+=-Ki*ti,Je.right=Je.left+ti}(ze,s,u,f,ve,w,T,I,U,M,H,le),!function(Je){for(const Tt of Je)if(Tt.positionedGlyphs.length!==0)return!1;return!0}(Le)&&ze}const Kg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},VF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function yE(c,s,u,f,g,x){if(s.imageName){const w=f[s.imageName];return w?w.displaySize[0]*s.scale*ei/x+g:0}{const w=u[s.fontStack],T=w&&w[c];return T?T.metrics.advance*s.scale+g:0}}function _E(c,s,u,f){const g=Math.pow(c-s,2);return f?c<s?g/2:2*g:g+Math.abs(u)*u}function UF(c,s,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function vE(c,s,u,f,g,x){let w=null,T=_E(s,u,g,x);for(const I of f){const M=_E(s-I.x,u,g,x)+I.badness;M<=T&&(w=I,T=M)}return{index:c,x:s,priorBreak:w,badness:T}}function xE(c){return c?xE(c.priorBreak).concat(c.index):[]}function wx(c,s,u,f,g,x,w){if(x!=="point")return[];if(!c)return[];const T=[],I=function(H,Y,Q,le,me,ve){let ke=0;for(let Te=0;Te<H.length();Te++){const Le=H.getSection(Te);ke+=yE(H.getCharCode(Te),Le,le,me,Y,ve)}return ke/Math.max(1,Math.ceil(ke/Q))}(c,s,u,f,g,w),M=c.text.indexOf("")>=0;let B=0;for(let H=0;H<c.length();H++){const Y=c.getSection(H),Q=c.getCharCode(H);if(Kg[Q]||(B+=yE(Q,Y,f,g,s,w)),H<c.length()-1){const le=!((U=Q)<11904||!(St["Bopomofo Extended"](U)||St.Bopomofo(U)||St["CJK Compatibility Forms"](U)||St["CJK Compatibility Ideographs"](U)||St["CJK Compatibility"](U)||St["CJK Radicals Supplement"](U)||St["CJK Strokes"](U)||St["CJK Symbols and Punctuation"](U)||St["CJK Unified Ideographs Extension A"](U)||St["CJK Unified Ideographs"](U)||St["Enclosed CJK Letters and Months"](U)||St["Halfwidth and Fullwidth Forms"](U)||St.Hiragana(U)||St["Ideographic Description Characters"](U)||St["Kangxi Radicals"](U)||St["Katakana Phonetic Extensions"](U)||St.Katakana(U)||St["Vertical Forms"](U)||St["Yi Radicals"](U)||St["Yi Syllables"](U)));(VF[Q]||le||Y.imageName)&&T.push(vE(H+1,B,I,T,UF(Q,c.getCharCode(H+1),le&&M),!1))}}var U;return xE(vE(c.length(),B,I,T,0,!0))}function Sx(c){let s=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function $F(c,s,u,f,g){if(!f&&!g)return;const x=c[u],w=(c[u].x+x.metrics.advance*x.scale)*f;for(let T=s;T<=u;T++)c[T].x-=w,c[T].y+=g}function GF(c,s,u){const{horizontalAlign:f,verticalAlign:g}=Sx(u),x=s[0]-c.displaySize[0]*f,w=s[1]-c.displaySize[1]*g;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function bE(c,s,u,f,g,x){const w=c.image;let T;if(w.content){const me=w.content,ve=w.pixelRatio||1;T=[me[0]/ve,me[1]/ve,w.displaySize[0]-me[2]/ve,w.displaySize[1]-me[3]/ve]}const I=s.left*x,M=s.right*x;let B,U,H,Y;u==="width"||u==="both"?(Y=g[0]+I-f[3],U=g[0]+M+f[1]):(Y=g[0]+(I+M-w.displaySize[0])/2,U=Y+w.displaySize[0]);const Q=s.top*x,le=s.bottom*x;return u==="height"||u==="both"?(B=g[1]+Q-f[0],H=g[1]+le+f[2]):(B=g[1]+(Q+le-w.displaySize[1])/2,H=B+w.displaySize[1]),{image:w,top:B,right:U,bottom:H,left:Y,collisionPadding:T}}const Xf=255,va=128,Vl=Xf*va;function wE(c,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new sr(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<f.length&&f[w]<c+1;)w++;w=Math.min(f.length-1,w);const T=f[x],I=f[w];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:I,minSize:u.evaluate(new sr(T)),maxSize:u.evaluate(new sr(I)),interpolationType:g}}}function Tx(c,s,u){let f="never";const g=c.get(s);return g?f=g:c.get(u)&&(f="always"),f}const WF=Bl.VectorTileFeature.types,HF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Jg(c,s,u,f,g,x,w,T,I,M,B,U,H){const Y=T?Math.min(Vl,Math.round(T[0])):0,Q=T?Math.min(Vl,Math.round(T[1])):0;c.emplaceBack(s,u,Math.round(32*f),Math.round(32*g),x,w,(Y<<1)+(I?1:0),Q,16*M,16*B,256*U,256*H)}function Ex(c,s,u){c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u)}function qF(c){for(const s of c.sections)if(Kv(s.text))return!0;return!1}class Px{constructor(s){this.layoutVertexArray=new En,this.indexArray=new pi,this.programConfigurations=s,this.segments=new or,this.dynamicLayoutVertexArray=new xn,this.opacityVertexArray=new An,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,TF.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,EF.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,HF,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Mt("SymbolBuffers",Px);class Cx{constructor(s,u,f){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new f,this.segments=new or,this.collisionVertexArray=new er}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,PF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Mt("CollisionBuffers",Cx);class vh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ix([]),this.placementViewportMatrix=ix([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wE(this.zoom,u["text-size"]),this.iconSizeData=wE(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=Tx(f,"text-overlap","text-allow-overlap")!=="never"||Tx(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(w=>l.ai[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID}createArrays(){this.text=new Px(new Yo(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new Px(new Yo(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ie,this.lineVertexArray=new Fe,this.symbolInstances=new ge,this.textAnchorOffsets=new Ke}calculateGlyphDependencies(s,u,f,g,x){for(let w=0;w<s.length;w++)if(u[s.charCodeAt(w)]=!0,(f||g)&&x){const T=Hf[s.charAt(w)];T&&(u[T.charCodeAt(0)]=!0)}}populate(s,u,f){const g=this.layers[0],x=g.layout,w=x.get("text-font"),T=x.get("text-field"),I=x.get("icon-image"),M=(T.value.kind!=="constant"||T.value.value instanceof ir&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),B=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,U=x.get("symbol-sort-key");if(this.features=[],!M&&!B)return;const H=u.iconDependencies,Y=u.glyphDependencies,Q=u.availableImages,le=new sr(this.zoom);for(const{feature:me,id:ve,index:ke,sourceLayerIndex:Te}of s){const Le=g._featureFilter.needGeometry,ze=Yc(me,Le);if(!g._featureFilter.filter(le,ze,f))continue;let Je,Tt;if(Le||(ze.geometry=Xc(me)),M){const wt=g.getValueAndResolveTokens("text-field",ze,f,Q),yt=ir.factory(wt);qF(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||Pf()==="unavailable"||this.hasRTLText&&ps.isParsed())&&(Je=AF(yt,g,ze))}if(B){const wt=g.getValueAndResolveTokens("icon-image",ze,f,Q);Tt=wt instanceof Zn?wt:Zn.fromString(wt)}if(!Je&&!Tt)continue;const Nt=this.sortFeaturesByKey?U.evaluate(ze,{},f):void 0;if(this.features.push({id:ve,text:Je,icon:Tt,index:ke,sourceLayerIndex:Te,geometry:ze.geometry,properties:me.properties,type:WF[me.type],sortKey:Nt}),Tt&&(H[Tt.name]=!0),Je){const wt=w.evaluate(ze,{},f).join(","),yt=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ai.vertical)>=0;for(const dt of Je.sections)if(dt.image)H[dt.image.name]=!0;else{const Lt=_f(Je.toString()),pt=dt.fontStack||wt,it=Y[pt]=Y[pt]||{};this.calculateGlyphDependencies(dt.text,it,yt,this.allowVerticalPlacement,Lt)}}}x.get("symbol-placement")==="line"&&(this.features=function(me){const ve={},ke={},Te=[];let Le=0;function ze(wt){Te.push(me[wt]),Le++}function Je(wt,yt,dt){const Lt=ke[wt];return delete ke[wt],ke[yt]=Lt,Te[Lt].geometry[0].pop(),Te[Lt].geometry[0]=Te[Lt].geometry[0].concat(dt[0]),Lt}function Tt(wt,yt,dt){const Lt=ve[yt];return delete ve[yt],ve[wt]=Lt,Te[Lt].geometry[0].shift(),Te[Lt].geometry[0]=dt[0].concat(Te[Lt].geometry[0]),Lt}function Nt(wt,yt,dt){const Lt=dt?yt[0][yt[0].length-1]:yt[0][0];return`${wt}:${Lt.x}:${Lt.y}`}for(let wt=0;wt<me.length;wt++){const yt=me[wt],dt=yt.geometry,Lt=yt.text?yt.text.toString():null;if(!Lt){ze(wt);continue}const pt=Nt(Lt,dt),it=Nt(Lt,dt,!0);if(pt in ke&&it in ve&&ke[pt]!==ve[it]){const Jt=Tt(pt,it,dt),Ut=Je(pt,it,Te[Jt].geometry);delete ve[pt],delete ke[it],ke[Nt(Lt,Te[Ut].geometry,!0)]=Ut,Te[Jt].geometry=null}else pt in ke?Je(pt,it,dt):it in ve?Tt(pt,it,dt):(ze(wt),ve[pt]=Le-1,ke[it]=Le-1)}return Te.filter(wt=>wt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,ve)=>me.sortKey-ve.sortKey)}update(s,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(s,u,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const f=this.lineVertexArray.length;if(s.segment!==void 0){let g=s.dist(u[s.segment+1]),x=s.dist(u[s.segment]);const w={};for(let T=s.segment+1;T<u.length;T++)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:g},T<u.length-1&&(g+=u[T+1].dist(u[T]));for(let T=s.segment||0;T>=0;T--)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:x},T>0&&(x+=u[T-1].dist(u[T]));for(let T=0;T<u.length;T++){const I=w[T];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,u,f,g,x,w,T,I,M,B,U,H){const Y=s.indexArray,Q=s.layoutVertexArray,le=s.segments.prepareSegment(4*u.length,Q,Y,this.canOverlap?w.sortKey:void 0),me=this.glyphOffsetArray.length,ve=le.vertexLength,ke=this.allowVerticalPlacement&&T===l.ai.vertical?Math.PI/2:0,Te=w.text&&w.text.sections;for(let Le=0;Le<u.length;Le++){const{tl:ze,tr:Je,bl:Tt,br:Nt,tex:wt,pixelOffsetTL:yt,pixelOffsetBR:dt,minFontScaleX:Lt,minFontScaleY:pt,glyphOffset:it,isSDF:Jt,sectionIndex:Ut}=u[Le],Sn=le.vertexLength,ar=it[1];Jg(Q,I.x,I.y,ze.x,ar+ze.y,wt.x,wt.y,f,Jt,yt.x,yt.y,Lt,pt),Jg(Q,I.x,I.y,Je.x,ar+Je.y,wt.x+wt.w,wt.y,f,Jt,dt.x,yt.y,Lt,pt),Jg(Q,I.x,I.y,Tt.x,ar+Tt.y,wt.x,wt.y+wt.h,f,Jt,yt.x,dt.y,Lt,pt),Jg(Q,I.x,I.y,Nt.x,ar+Nt.y,wt.x+wt.w,wt.y+wt.h,f,Jt,dt.x,dt.y,Lt,pt),Ex(s.dynamicLayoutVertexArray,I,ke),Y.emplaceBack(Sn,Sn+1,Sn+2),Y.emplaceBack(Sn+1,Sn+2,Sn+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),Le!==u.length-1&&Ut===u[Le+1].sectionIndex||s.programConfigurations.populatePaintArrays(Q.length,w,w.index,{},H,Te&&Te[Ut])}s.placedSymbolArray.emplaceBack(I.x,I.y,me,this.glyphOffsetArray.length-me,ve,M,B,I.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],T,0,!1,0,U)}_addCollisionDebugVertex(s,u,f,g,x,w){return u.emplaceBack(0,0),s.emplaceBack(f.x,f.y,g,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,u,f,g,x,w,T){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),M=I.vertexLength,B=x.layoutVertexArray,U=x.collisionVertexArray,H=T.anchorX,Y=T.anchorY;this._addCollisionDebugVertex(B,U,w,H,Y,new C(s,u)),this._addCollisionDebugVertex(B,U,w,H,Y,new C(f,u)),this._addCollisionDebugVertex(B,U,w,H,Y,new C(f,g)),this._addCollisionDebugVertex(B,U,w,H,Y,new C(s,g)),I.vertexLength+=4;const Q=x.indexArray;Q.emplaceBack(M,M+1),Q.emplaceBack(M+1,M+2),Q.emplaceBack(M+2,M+3),Q.emplaceBack(M+3,M),I.primitiveLength+=4}addDebugCollisionBoxes(s,u,f,g){for(let x=s;x<u;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cx(Ar,oE.members,Jr),this.iconCollisionBox=new Cx(Ar,oE.members,Jr);for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(s,u,f,g,x,w,T,I,M){const B={};for(let U=u;U<f;U++){const H=s.get(U);B.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.textFeatureIndex=H.featureIndex;break}for(let U=g;U<x;U++){const H=s.get(U);B.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalTextFeatureIndex=H.featureIndex;break}for(let U=w;U<T;U++){const H=s.get(U);B.iconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.iconFeatureIndex=H.featureIndex;break}for(let U=I;U<M;U++){const H=s.get(U);B.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalIconFeatureIndex=H.featureIndex;break}return B}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,u){const f=s.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)s.indexArray.emplaceBack(x,x+1,x+2),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),f=Math.cos(s),g=[],x=[],w=[];for(let T=0;T<this.symbolInstances.length;++T){w.push(T);const I=this.symbolInstances.get(T);g.push(0|Math.round(u*I.anchorX+f*I.anchorY)),x.push(I.featureIndex)}return w.sort((T,I)=>g[T]-g[I]||x[I]-x[T]),w}addToSortKeyRanges(s,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,x,w)=>{g>=0&&w.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let SE,TE;Mt("SymbolBucket",vh,{omit:["layers","collisionBoxArray","features","compareText"]}),vh.MAX_GLYPHS=65535,vh.addDynamicAttributes=Ex;var Ax={get paint(){return TE=TE||new Rr({"icon-opacity":new rn(Ae.paint_symbol["icon-opacity"]),"icon-color":new rn(Ae.paint_symbol["icon-color"]),"icon-halo-color":new rn(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new rn(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rn(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new rn(Ae.paint_symbol["text-opacity"]),"text-color":new rn(Ae.paint_symbol["text-color"],{runtimeType:Pr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new rn(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new rn(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new rn(Ae.paint_symbol["text-halo-blur"]),"text-translate":new Zt(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return SE=SE||new Rr({"symbol-placement":new Zt(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rn(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Zt(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Zt(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new rn(Ae.layout_symbol["icon-size"]),"icon-text-fit":new Zt(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new rn(Ae.layout_symbol["icon-image"]),"icon-rotate":new rn(Ae.layout_symbol["icon-rotate"]),"icon-padding":new rn(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new rn(Ae.layout_symbol["icon-offset"]),"icon-anchor":new rn(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new rn(Ae.layout_symbol["text-field"]),"text-font":new rn(Ae.layout_symbol["text-font"]),"text-size":new rn(Ae.layout_symbol["text-size"]),"text-max-width":new rn(Ae.layout_symbol["text-max-width"]),"text-line-height":new Zt(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new rn(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new rn(Ae.layout_symbol["text-justify"]),"text-radial-offset":new rn(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rn(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rn(Ae.layout_symbol["text-anchor"]),"text-max-angle":new Zt(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new rn(Ae.layout_symbol["text-rotate"]),"text-padding":new Zt(Ae.layout_symbol["text-padding"]),"text-keep-upright":new Zt(Ae.layout_symbol["text-keep-upright"]),"text-transform":new rn(Ae.layout_symbol["text-transform"]),"text-offset":new rn(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Zt(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Zt(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(Ae.layout_symbol["text-optional"])})}};class EE{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:pn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Mt("FormatSectionOverride",EE,{omit:["defaultValue"]});class Qg extends ks{constructor(s){super(s,Ax)}recalculate(s,u){if(super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,u,f,g){const x=this.layout.get(s).evaluate(u,{},f,g),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Qu(w.value)||!x?x:function(T,I){return I.replace(/{([^{}]+)}/g,(M,B)=>T&&B in T?String(T[B]):"")}(u.properties,x)}createBucket(s){return new vh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Ax.paint.overridableProperties){if(!Qg.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),f=new EE(u),g=new df(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new ff("source",g):new th("composite",g,u.value.zoomStops),this.paint._values[s]=new Mi(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Qg.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const f=s.get("text-field"),g=Ax.paint.properties[u];let x=!1;const w=T=>{for(const I of T)if(g.overrides&&g.overrides.hasOverride(I))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ir)w(f.value.value.sections);else if(f.value.kind==="source"){const T=M=>{x||(M instanceof Us&&Jn(M.value)===he?w(M.value.sections):M instanceof Ju?w(M.sections):M.eachChild(T))},I=f.value;I._styleExpression&&T(I._styleExpression.expression)}return x}}let PE;var ZF={get paint(){return PE=PE||new Rr({"background-color":new Zt(Ae.paint_background["background-color"]),"background-pattern":new Af(Ae.paint_background["background-pattern"]),"background-opacity":new Zt(Ae.paint_background["background-opacity"])})}};class XF extends ks{constructor(s){super(s,ZF)}}let CE;var YF={get paint(){return CE=CE||new Rr({"raster-opacity":new Zt(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(Ae.paint_raster["raster-saturation"]),"raster-contrast":new Zt(Ae.paint_raster["raster-contrast"]),"raster-resampling":new Zt(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(Ae.paint_raster["raster-fade-duration"])})}};class KF extends ks{constructor(s){super(s,YF)}}class JF extends ks{constructor(s){super(s,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class QF{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Ix=63710088e-1;class Ul{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ul(se(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,f=this.lat*u,g=s.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((s.lng-this.lng)*u);return Ix*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof Ul)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Ul(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Ul(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const AE=2*Math.PI*Ix;function IE(c){return AE*Math.cos(c*Math.PI/180)}function kE(c){return(180+c)/360}function ME(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function LE(c,s){return c/IE(s)}function RE(c){return 360*c-180}function kx(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class ey{constructor(s,u,f=0){this.x=+s,this.y=+u,this.z=+f}static fromLngLat(s,u=0){const f=Ul.convert(s);return new ey(kE(f.lng),ME(f.lat),LE(u,f.lat))}toLngLat(){return new Ul(RE(this.x),kx(this.y))}toAltitude(){return this.z*IE(kx(this.y))}meterInMercatorCoordinateUnits(){return 1/AE*(s=kx(this.y),1/Math.cos(s*Math.PI/180));var s}}function OE(c,s,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class Mx{constructor(s,u,f){if(s<0||s>25||f<0||f>=Math.pow(2,s)||u<0||u>=Math.pow(2,s))throw new Error(`x=${u}, y=${f}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=u,this.y=f,this.key=Yf(0,s,s,u,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u,f){const g=(w=this.y,T=this.z,I=OE(256*(x=this.x),256*(w=Math.pow(2,T)-w-1),T),M=OE(256*(x+1),256*(w+1),T),I[0]+","+I[1]+","+M[0]+","+M[1]);var x,w,T,I,M;const B=function(U,H,Y){let Q,le="";for(let me=U;me>0;me--)Q=1<<me-1,le+=(H&Q?1:0)+(Y&Q?2:0);return le}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,g)}isChildOf(s){const u=this.z-s.z;return u>0&&s.x===this.x>>u&&s.y===this.y>>u}getTilePoint(s){const u=Math.pow(2,this.z);return new C((s.x*u-this.x)*$r,(s.y*u-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zE{constructor(s,u){this.wrap=s,this.canonical=u,this.key=Yf(s,u.z,u.z,u.x,u.y)}}class Gs{constructor(s,u,f,g,x){if(s<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${f}`);this.overscaledZ=s,this.wrap=u,this.canonical=new Mx(f,+g,+x),this.key=Yf(u,s,f,g,x)}clone(){return new Gs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-s;return s>this.canonical.z?new Gs(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gs(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-s;return s>this.canonical.z?Yf(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y):Yf(this.wrap*+u,s,s,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new Gs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new Gs(u,this.wrap,u,f,g),new Gs(u,this.wrap,u,f+1,g),new Gs(u,this.wrap,u,f,g+1),new Gs(u,this.wrap,u,f+1,g+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Gs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Gs(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new ey(s.x-this.wrap,s.y))}}function Yf(c,s,u,f,g){(c*=2)<0&&(c=-1*c-1);const x=1<<u;return(x*x*c+x*g+f).toString(36)+u.toString(36)+s.toString(36)}Mt("CanonicalTileID",Mx),Mt("OverscaledTileID",Gs,{omit:["posMatrix"]});class DE{constructor(s,u,f,g=1,x=1,w=1,T=0){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void je(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const I=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=x,this.blueFactor=w,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<I;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(I,M)]=this.data[this._idx(I-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,I)]=this.data[this._idx(M,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<I;M++)for(let B=0;B<I;B++){const U=this.get(M,B);U>this.max&&(this.max=U),U<this.min&&(this.min=U)}}get(s,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(s,u);return this.unpack(f[g],f[g+1],f[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}unpack(s,u,f){return s*this.redFactor+u*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new $s({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,u,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,w=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:w=T-1;break;case 1:T=w+1}const I=-u*this.dim,M=-f*this.dim;for(let B=w;B<T;B++)for(let U=g;U<x;U++)this.data[this._idx(U,B)]=s.data[this._idx(U+I,B+M)]}}Mt("DEMData",DE);class FE{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const f=s[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class NE{constructor(s,u,f,g,x){this.type="Feature",this._vectorTileFeature=s,s._z=u,s._x=f,s._y=g,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(s[u]=this[u]);return s}}class BE{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Ol($r,16,0),this.grid3D=new Ol($r,16,0),this.featureIndexArray=new et,this.promoteId=u}insert(s,u,f,g,x,w){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x);const I=w?this.grid3D:this.grid;for(let M=0;M<u.length;M++){const B=u[M],U=[1/0,1/0,-1/0,-1/0];for(let H=0;H<B.length;H++){const Y=B[H];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}U[0]<$r&&U[1]<$r&&U[2]>=0&&U[3]>=0&&I.insert(T,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Bl.VectorTile(new vx(this.rawTileData)).layers,this.sourceLayerCoder=new FE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,u,f,g){this.loadVTLayers();const x=s.params||{},w=$r/s.tileSize/s.scale,T=mf(x.filter),I=s.queryGeometry,M=s.queryPadding*w,B=VE(I),U=this.grid.query(B.minX-M,B.minY-M,B.maxX+M,B.maxY+M),H=VE(s.cameraQueryGeometry),Y=this.grid3D.query(H.minX-M,H.minY-M,H.maxX+M,H.maxY+M,(me,ve,ke,Te)=>function(Le,ze,Je,Tt,Nt){for(const yt of Le)if(ze<=yt.x&&Je<=yt.y&&Tt>=yt.x&&Nt>=yt.y)return!0;const wt=[new C(ze,Je),new C(ze,Nt),new C(Tt,Nt),new C(Tt,Je)];if(Le.length>2){for(const yt of wt)if(dh(Le,yt))return!0}for(let yt=0;yt<Le.length-1;yt++)if(MD(Le[yt],Le[yt+1],wt))return!0;return!1}(s.cameraQueryGeometry,me-M,ve-M,ke+M,Te+M));for(const me of Y)U.push(me);U.sort(e4);const Q={};let le;for(let me=0;me<U.length;me++){const ve=U[me];if(ve===le)continue;le=ve;const ke=this.featureIndexArray.get(ve);let Te=null;this.loadMatchingFeature(Q,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,T,x.layers,x.availableImages,u,f,g,(Le,ze,Je)=>(Te||(Te=Xc(Le)),ze.queryIntersectsFeature(I,Le,Je,Te,this.z,s.transform,w,s.pixelPosMatrix)))}return Q}loadMatchingFeature(s,u,f,g,x,w,T,I,M,B,U){const H=this.bucketLayerIDs[u];if(w&&!function(me,ve){for(let ke=0;ke<me.length;ke++)if(ve.indexOf(me[ke])>=0)return!0;return!1}(w,H))return;const Y=this.sourceLayerCoder.decode(f),Q=this.vtLayers[Y].feature(g);if(x.needGeometry){const me=Yc(Q,!0);if(!x.filter(new sr(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!x.filter(new sr(this.tileID.overscaledZ),Q))return;const le=this.getId(Q,Y);for(let me=0;me<H.length;me++){const ve=H[me];if(w&&w.indexOf(ve)<0)continue;const ke=I[ve];if(!ke)continue;let Te={};le&&B&&(Te=B.getState(ke.sourceLayer||"_geojsonTileLayer",le));const Le=xe({},M[ve]);Le.paint=jE(Le.paint,ke.paint,Q,Te,T),Le.layout=jE(Le.layout,ke.layout,Q,Te,T);const ze=!U||U(Q,ke,Te);if(!ze)continue;const Je=new NE(Q,this.z,this.x,this.y,le);Je.layer=Le;let Tt=s[ve];Tt===void 0&&(Tt=s[ve]=[]),Tt.push({featureIndex:g,feature:Je,intersectionZ:ze})}}lookupSymbolFeatures(s,u,f,g,x,w,T,I){const M={};this.loadVTLayers();const B=mf(x);for(const U of s)this.loadMatchingFeature(M,f,g,U,B,w,T,I,u);return M}hasLayer(s){for(const u of this.bucketLayerIDs)for(const f of u)if(s===f)return!0;return!1}getId(s,u){let f=s.id;return this.promoteId&&(f=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof f=="boolean"&&(f=Number(f))),f}}function jE(c,s,u,f,g){return _e(c,(x,w)=>{const T=s instanceof uh?s.get(w):null;return T&&T.evaluate?T.evaluate(u,f,g):T})}function VE(c){let s=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of c)s=Math.min(s,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{minX:s,minY:u,maxX:f,maxY:g}}function e4(c,s){return s-c}function UE(c,s,u,f,g){const x=[];for(let w=0;w<c.length;w++){const T=c[w];let I;for(let M=0;M<T.length-1;M++){let B=T[M],U=T[M+1];B.x<s&&U.x<s||(B.x<s?B=new C(s,B.y+(s-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x<s&&(U=new C(s,B.y+(s-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y<u&&U.y<u||(B.y<u?B=new C(B.x+(u-B.y)/(U.y-B.y)*(U.x-B.x),u)._round():U.y<u&&(U=new C(B.x+(u-B.y)/(U.y-B.y)*(U.x-B.x),u)._round()),B.x>=f&&U.x>=f||(B.x>=f?B=new C(f,B.y+(f-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x>=f&&(U=new C(f,B.y+(f-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y>=g&&U.y>=g||(B.y>=g?B=new C(B.x+(g-B.y)/(U.y-B.y)*(U.x-B.x),g)._round():U.y>=g&&(U=new C(B.x+(g-B.y)/(U.y-B.y)*(U.x-B.x),g)._round()),I&&B.equals(I[I.length-1])||(I=[B],x.push(I)),I.push(U)))))}}return x}Mt("FeatureIndex",BE,{omit:["rawTileData","sourceLayerCoder"]});class $l extends C{constructor(s,u,f,g){super(s,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new $l(this.x,this.y,this.angle,this.segment)}}function $E(c,s,u,f,g){if(s.segment===void 0||u===0)return!0;let x=s,w=s.segment+1,T=0;for(;T>-u/2;){if(w--,w<0)return!1;T-=c[w].dist(x),x=c[w]}T+=c[w].dist(c[w+1]),w++;const I=[];let M=0;for(;T<u/2;){const B=c[w],U=c[w+1];if(!U)return!1;let H=c[w-1].angleTo(B)-B.angleTo(U);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:T,angleDelta:H}),M+=H;T-I[0].distance>f;)M-=I.shift().angleDelta;if(M>g)return!1;w++,T+=B.dist(U)}return!0}function GE(c){let s=0;for(let u=0;u<c.length-1;u++)s+=c[u].dist(c[u+1]);return s}function WE(c,s,u){return c?.6*s*u:0}function HE(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function t4(c,s,u,f,g,x){const w=WE(u,g,x),T=HE(u,f)*x;let I=0;const M=GE(c)/2;for(let B=0;B<c.length-1;B++){const U=c[B],H=c[B+1],Y=U.dist(H);if(I+Y>M){const Q=(M-I)/Y,le=hs.number(U.x,H.x,Q),me=hs.number(U.y,H.y,Q),ve=new $l(le,me,H.angleTo(U),B);return ve._round(),!w||$E(c,ve,T,w,s)?ve:void 0}I+=Y}}function n4(c,s,u,f,g,x,w,T,I){const M=WE(f,x,w),B=HE(f,g),U=B*w,H=c[0].x===0||c[0].x===I||c[0].y===0||c[0].y===I;return s-U<s/4&&(s=U+s/4),qE(c,H?s/2*T%s:(B/2+2*x)*w*T%s,s,M,u,U,H,!1,I)}function qE(c,s,u,f,g,x,w,T,I){const M=x/2,B=GE(c);let U=0,H=s-u,Y=[];for(let Q=0;Q<c.length-1;Q++){const le=c[Q],me=c[Q+1],ve=le.dist(me),ke=me.angleTo(le);for(;H+u<U+ve;){H+=u;const Te=(H-U)/ve,Le=hs.number(le.x,me.x,Te),ze=hs.number(le.y,me.y,Te);if(Le>=0&&Le<I&&ze>=0&&ze<I&&H-M>=0&&H+M<=B){const Je=new $l(Le,ze,ke,Q);Je._round(),f&&!$E(c,Je,x,f,g)||Y.push(Je)}}U+=ve}return T||Y.length||w||(Y=qE(c,U/2,u,f,g,x,w,!0,I)),Y}Mt("Anchor",$l);const xh=gs;function ZE(c,s,u,f){const g=[],x=c.image,w=x.pixelRatio,T=x.paddedRect.w-2*xh,I=x.paddedRect.h-2*xh,M=c.right-c.left,B=c.bottom-c.top,U=x.stretchX||[[0,T]],H=x.stretchY||[[0,I]],Y=(dt,Lt)=>dt+Lt[1]-Lt[0],Q=U.reduce(Y,0),le=H.reduce(Y,0),me=T-Q,ve=I-le;let ke=0,Te=Q,Le=0,ze=le,Je=0,Tt=me,Nt=0,wt=ve;if(x.content&&f){const dt=x.content;ke=ty(U,0,dt[0]),Le=ty(H,0,dt[1]),Te=ty(U,dt[0],dt[2]),ze=ty(H,dt[1],dt[3]),Je=dt[0]-ke,Nt=dt[1]-Le,Tt=dt[2]-dt[0]-Te,wt=dt[3]-dt[1]-ze}const yt=(dt,Lt,pt,it)=>{const Jt=ny(dt.stretch-ke,Te,M,c.left),Ut=ry(dt.fixed-Je,Tt,dt.stretch,Q),Sn=ny(Lt.stretch-Le,ze,B,c.top),ar=ry(Lt.fixed-Nt,wt,Lt.stretch,le),fr=ny(pt.stretch-ke,Te,M,c.left),ti=ry(pt.fixed-Je,Tt,pt.stretch,Q),Ls=ny(it.stretch-Le,ze,B,c.top),Yi=ry(it.fixed-Nt,wt,it.stretch,le),Gr=new C(Jt,Sn),gi=new C(fr,Sn),Ti=new C(fr,Ls),Ki=new C(Jt,Ls),Ji=new C(Ut/w,ar/w),ni=new C(ti/w,Yi/w),ri=s*Math.PI/180;if(ri){const Oi=Math.sin(ri),ys=Math.cos(ri),_s=[ys,-Oi,Oi,ys];Gr._matMult(_s),gi._matMult(_s),Ki._matMult(_s),Ti._matMult(_s)}const Ri=dt.stretch+dt.fixed,Qi=Lt.stretch+Lt.fixed;return{tl:Gr,tr:gi,bl:Ki,br:Ti,tex:{x:x.paddedRect.x+xh+Ri,y:x.paddedRect.y+xh+Qi,w:pt.stretch+pt.fixed-Ri,h:it.stretch+it.fixed-Qi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:ni,minFontScaleX:Tt/w/M,minFontScaleY:wt/w/B,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const dt=XE(U,me,Q),Lt=XE(H,ve,le);for(let pt=0;pt<dt.length-1;pt++){const it=dt[pt],Jt=dt[pt+1];for(let Ut=0;Ut<Lt.length-1;Ut++)g.push(yt(it,Lt[Ut],Jt,Lt[Ut+1]))}}else g.push(yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:I+1}));return g}function ty(c,s,u){let f=0;for(const g of c)f+=Math.max(s,Math.min(u,g[1]))-Math.max(s,Math.min(u,g[0]));return f}function XE(c,s,u){const f=[{fixed:-xh,stretch:0}];for(const[g,x]of c){const w=f[f.length-1];f.push({fixed:g-w.stretch,stretch:w.stretch}),f.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return f.push({fixed:s+xh,stretch:u}),f}function ny(c,s,u,f){return c/s*u+f}function ry(c,s,u,f){return c-s*u/f}class iy{constructor(s,u,f,g,x,w,T,I,M,B){if(this.boxStartIndex=s.length,M){let U=w.top,H=w.bottom;const Y=w.collisionPadding;Y&&(U-=Y[1],H+=Y[3]);let Q=H-U;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{let U=w.top*T-I[0],H=w.bottom*T+I[2],Y=w.left*T-I[3],Q=w.right*T+I[1];const le=w.collisionPadding;if(le&&(Y-=le[0]*T,U-=le[1]*T,Q+=le[2]*T,H+=le[3]*T),B){const me=new C(Y,U),ve=new C(Q,U),ke=new C(Y,H),Te=new C(Q,H),Le=B*Math.PI/180;me._rotate(Le),ve._rotate(Le),ke._rotate(Le),Te._rotate(Le),Y=Math.min(me.x,ve.x,ke.x,Te.x),Q=Math.max(me.x,ve.x,ke.x,Te.x),U=Math.min(me.y,ve.y,ke.y,Te.y),H=Math.max(me.y,ve.y,ke.y,Te.y)}s.emplaceBack(u.x,u.y,Y,U,Q,H,f,g,x)}this.boxEndIndex=s.length}}class r4{constructor(s=[],u=i4){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:f}=this,g=u[s];for(;s>0;){const x=s-1>>1,w=u[x];if(f(g,w)>=0)break;u[s]=w,s=x}u[s]=g}_down(s){const{data:u,compare:f}=this,g=this.length>>1,x=u[s];for(;s<g;){let w=1+(s<<1),T=u[w];const I=w+1;if(I<this.length&&f(u[I],T)<0&&(w=I,T=u[I]),f(T,x)>=0)break;u[s]=T,s=w}u[s]=x}}function i4(c,s){return c<s?-1:c>s?1:0}function s4(c,s=1,u=!1){let f=1/0,g=1/0,x=-1/0,w=-1/0;const T=c[0];for(let Y=0;Y<T.length;Y++){const Q=T[Y];(!Y||Q.x<f)&&(f=Q.x),(!Y||Q.y<g)&&(g=Q.y),(!Y||Q.x>x)&&(x=Q.x),(!Y||Q.y>w)&&(w=Q.y)}const I=Math.min(x-f,w-g);let M=I/2;const B=new r4([],o4);if(I===0)return new C(f,g);for(let Y=f;Y<x;Y+=I)for(let Q=g;Q<w;Q+=I)B.push(new bh(Y+M,Q+M,M,c));let U=function(Y){let Q=0,le=0,me=0;const ve=Y[0];for(let ke=0,Te=ve.length,Le=Te-1;ke<Te;Le=ke++){const ze=ve[ke],Je=ve[Le],Tt=ze.x*Je.y-Je.x*ze.y;le+=(ze.x+Je.x)*Tt,me+=(ze.y+Je.y)*Tt,Q+=3*Tt}return new bh(le/Q,me/Q,0,Y)}(c),H=B.length;for(;B.length;){const Y=B.pop();(Y.d>U.d||!U.d)&&(U=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,H)),Y.max-U.d<=s||(M=Y.h/2,B.push(new bh(Y.p.x-M,Y.p.y-M,M,c)),B.push(new bh(Y.p.x+M,Y.p.y-M,M,c)),B.push(new bh(Y.p.x-M,Y.p.y+M,M,c)),B.push(new bh(Y.p.x+M,Y.p.y+M,M,c)),H+=4)}return u&&(console.log(`num probes: ${H}`),console.log(`best distance: ${U.d}`)),U.p}function o4(c,s){return s.max-c.max}function bh(c,s,u,f){this.p=new C(c,s),this.h=u,this.d=function(g,x){let w=!1,T=1/0;for(let I=0;I<x.length;I++){const M=x[I];for(let B=0,U=M.length,H=U-1;B<U;H=B++){const Y=M[B],Q=M[H];Y.y>g.y!=Q.y>g.y&&g.x<(Q.x-Y.x)*(g.y-Y.y)/(Q.y-Y.y)+Y.x&&(w=!w),T=Math.min(T,MT(g,Y,Q))}}return(w?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Si;l.aq=void 0,(Si=l.aq||(l.aq={}))[Si.center=1]="center",Si[Si.left=2]="left",Si[Si.right=3]="right",Si[Si.top=4]="top",Si[Si.bottom=5]="bottom",Si[Si["top-left"]=6]="top-left",Si[Si["top-right"]=7]="top-right",Si[Si["bottom-left"]=8]="bottom-left",Si[Si["bottom-right"]=9]="bottom-right";const Gl=7,Lx=Number.POSITIVE_INFINITY;function YE(c,s){return s[1]!==Lx?function(u,f,g){let x=0,w=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":w=g-Gl;break;case"bottom-right":case"bottom-left":case"bottom":w=-g+Gl}switch(u){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,w]}(c,s[0],s[1]):function(u,f){let g=0,x=0;f<0&&(f=0);const w=f/Math.SQRT2;switch(u){case"top-right":case"top-left":x=w-Gl;break;case"bottom-right":case"bottom-left":x=-w+Gl;break;case"bottom":x=-f+Gl;break;case"top":x=f-Gl}switch(u){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=f;break;case"right":g=-f}return[g,x]}(c,s[0])}function KE(c,s,u){var f;const g=c.layout,x=(f=g.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(s,{},u);if(x){const T=x.values,I=[];for(let M=0;M<T.length;M+=2){const B=I[M]=T[M],U=T[M+1].map(H=>H*ei);B.startsWith("top")?U[1]-=Gl:B.startsWith("bottom")&&(U[1]+=Gl),I[M+1]=U}return new di(I)}const w=g.get("text-variable-anchor");if(w){let T;T=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(s,{},u)*ei,Lx]:g.get("text-offset").evaluate(s,{},u).map(M=>M*ei);const I=[];for(const M of w)I.push(M,YE(M,T));return new di(I)}return null}function Rx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function a4(c,s,u,f,g,x,w,T,I,M,B){let U=x.textMaxSize.evaluate(s,{});U===void 0&&(U=w);const H=c.layers[0].layout,Y=H.get("icon-offset").evaluate(s,{},B),Q=QE(u.horizontal),le=w/24,me=c.tilePixelRatio*le,ve=c.tilePixelRatio*U/24,ke=c.tilePixelRatio*T,Te=c.tilePixelRatio*H.get("symbol-spacing"),Le=H.get("text-padding")*c.tilePixelRatio,ze=function(it,Jt,Ut,Sn=1){const ar=it.get("icon-padding").evaluate(Jt,{},Ut),fr=ar&&ar.values;return[fr[0]*Sn,fr[1]*Sn,fr[2]*Sn,fr[3]*Sn]}(H,s,B,c.tilePixelRatio),Je=H.get("text-max-angle")/180*Math.PI,Tt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Nt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",wt=H.get("symbol-placement"),yt=Te/2,dt=H.get("icon-text-fit");let Lt;f&&dt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(Lt=bE(f,u.vertical,dt,H.get("icon-text-fit-padding"),Y,le)),Q&&(f=bE(f,Q,dt,H.get("icon-text-fit-padding"),Y,le)));const pt=(it,Jt)=>{Jt.x<0||Jt.x>=$r||Jt.y<0||Jt.y>=$r||function(Ut,Sn,ar,fr,ti,Ls,Yi,Gr,gi,Ti,Ki,Ji,ni,ri,Ri,Qi,Oi,ys,_s,ii,Mn,zi,Ei,si,wo){const Ko=Ut.addToLineVertexArray(Sn,ar);let Jo,Ja,So,Ws,vs=0,Qa=0,Qf=0,rP=0,Vx=-1,Ux=-1;const el={};let iP=Za("");if(Ut.allowVerticalPlacement&&fr.vertical){const Di=Gr.layout.get("text-rotate").evaluate(Mn,{},si)+90;So=new iy(gi,Sn,Ti,Ki,Ji,fr.vertical,ni,ri,Ri,Di),Yi&&(Ws=new iy(gi,Sn,Ti,Ki,Ji,Yi,Oi,ys,Ri,Di))}if(ti){const Di=Gr.layout.get("icon-rotate").evaluate(Mn,{}),Hs=Gr.layout.get("icon-text-fit")!=="none",Jc=ZE(ti,Di,Ei,Hs),ea=Yi?ZE(Yi,Di,Ei,Hs):void 0;Ja=new iy(gi,Sn,Ti,Ki,Ji,ti,Oi,ys,!1,Di),vs=4*Jc.length;const Qc=Ut.iconSizeData;let xa=null;Qc.kind==="source"?(xa=[va*Gr.layout.get("icon-size").evaluate(Mn,{})],xa[0]>Vl&&je(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${Xf}. Reduce your "icon-size".`)):Qc.kind==="composite"&&(xa=[va*zi.compositeIconSizes[0].evaluate(Mn,{},si),va*zi.compositeIconSizes[1].evaluate(Mn,{},si)],(xa[0]>Vl||xa[1]>Vl)&&je(`${Ut.layerIds[0]}: Value for "icon-size" is >= ${Xf}. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,Jc,xa,ii,_s,Mn,l.ai.none,Sn,Ko.lineStartIndex,Ko.lineLength,-1,si),Vx=Ut.icon.placedSymbolArray.length-1,ea&&(Qa=4*ea.length,Ut.addSymbols(Ut.icon,ea,xa,ii,_s,Mn,l.ai.vertical,Sn,Ko.lineStartIndex,Ko.lineLength,-1,si),Ux=Ut.icon.placedSymbolArray.length-1)}const sP=Object.keys(fr.horizontal);for(const Di of sP){const Hs=fr.horizontal[Di];if(!Jo){iP=Za(Hs.text);const ea=Gr.layout.get("text-rotate").evaluate(Mn,{},si);Jo=new iy(gi,Sn,Ti,Ki,Ji,Hs,ni,ri,Ri,ea)}const Jc=Hs.positionedLines.length===1;if(Qf+=JE(Ut,Sn,Hs,Ls,Gr,Ri,Mn,Qi,Ko,fr.vertical?l.ai.horizontal:l.ai.horizontalOnly,Jc?sP:[Di],el,Vx,zi,si),Jc)break}fr.vertical&&(rP+=JE(Ut,Sn,fr.vertical,Ls,Gr,Ri,Mn,Qi,Ko,l.ai.vertical,["vertical"],el,Ux,zi,si));const u4=Jo?Jo.boxStartIndex:Ut.collisionBoxArray.length,h4=Jo?Jo.boxEndIndex:Ut.collisionBoxArray.length,d4=So?So.boxStartIndex:Ut.collisionBoxArray.length,f4=So?So.boxEndIndex:Ut.collisionBoxArray.length,p4=Ja?Ja.boxStartIndex:Ut.collisionBoxArray.length,m4=Ja?Ja.boxEndIndex:Ut.collisionBoxArray.length,g4=Ws?Ws.boxStartIndex:Ut.collisionBoxArray.length,y4=Ws?Ws.boxEndIndex:Ut.collisionBoxArray.length;let Qo=-1;const oy=(Di,Hs)=>Di&&Di.circleDiameter?Math.max(Di.circleDiameter,Hs):Hs;Qo=oy(Jo,Qo),Qo=oy(So,Qo),Qo=oy(Ja,Qo),Qo=oy(Ws,Qo);const oP=Qo>-1?1:0;oP&&(Qo*=wo/ei),Ut.glyphOffsetArray.length>=vh.MAX_GLYPHS&&je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mn.sortKey!==void 0&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,Mn.sortKey);const _4=KE(Gr,Mn,si),[v4,x4]=function(Di,Hs){const Jc=Di.length,ea=Hs==null?void 0:Hs.values;if((ea==null?void 0:ea.length)>0)for(let Qc=0;Qc<ea.length;Qc+=2){const xa=ea[Qc+1];Di.emplaceBack(l.aq[ea[Qc]],xa[0],xa[1])}return[Jc,Di.length]}(Ut.textAnchorOffsets,_4);Ut.symbolInstances.emplaceBack(Sn.x,Sn.y,el.right>=0?el.right:-1,el.center>=0?el.center:-1,el.left>=0?el.left:-1,el.vertical||-1,Vx,Ux,iP,u4,h4,d4,f4,p4,m4,g4,y4,Ti,Qf,rP,vs,Qa,oP,0,ni,Qo,v4,x4)}(c,Jt,it,u,f,g,Lt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,me,[Le,Le,Le,Le],Tt,I,ke,ze,Nt,Y,s,x,M,B,w)};if(wt==="line")for(const it of UE(s.geometry,0,0,$r,$r)){const Jt=n4(it,Te,Je,u.vertical||Q,f,24,ve,c.overscaling,$r);for(const Ut of Jt)Q&&l4(c,Q.text,yt,Ut)||pt(it,Ut)}else if(wt==="line-center"){for(const it of s.geometry)if(it.length>1){const Jt=t4(it,Je,u.vertical||Q,f,24,ve);Jt&&pt(it,Jt)}}else if(s.type==="Polygon")for(const it of hx(s.geometry,0)){const Jt=s4(it,16);pt(it[0],new $l(Jt.x,Jt.y,0))}else if(s.type==="LineString")for(const it of s.geometry)pt(it,new $l(it[0].x,it[0].y,0));else if(s.type==="Point")for(const it of s.geometry)for(const Jt of it)pt([Jt],new $l(Jt.x,Jt.y,0))}function JE(c,s,u,f,g,x,w,T,I,M,B,U,H,Y,Q){const le=function(ke,Te,Le,ze,Je,Tt,Nt,wt){const yt=ze.layout.get("text-rotate").evaluate(Tt,{})*Math.PI/180,dt=[];for(const Lt of Te.positionedLines)for(const pt of Lt.positionedGlyphs){if(!pt.rect)continue;const it=pt.rect||{};let Jt=pE+1,Ut=!0,Sn=1,ar=0;const fr=(Je||wt)&&pt.vertical,ti=pt.metrics.advance*pt.scale/2;if(wt&&Te.verticalizable&&(ar=Lt.lineOffset/2-(pt.imageName?-(ei-pt.metrics.width*pt.scale)/2:(pt.scale-1)*ei)),pt.imageName){const ii=Nt[pt.imageName];Ut=ii.sdf,Sn=ii.pixelRatio,Jt=gs/Sn}const Ls=Je?[pt.x+ti,pt.y]:[0,0];let Yi=Je?[0,0]:[pt.x+ti+Le[0],pt.y+Le[1]-ar],Gr=[0,0];fr&&(Gr=Yi,Yi=[0,0]);const gi=pt.metrics.isDoubleResolution?2:1,Ti=(pt.metrics.left-Jt)*pt.scale-ti+Yi[0],Ki=(-pt.metrics.top-Jt)*pt.scale+Yi[1],Ji=Ti+it.w/gi*pt.scale/Sn,ni=Ki+it.h/gi*pt.scale/Sn,ri=new C(Ti,Ki),Ri=new C(Ji,Ki),Qi=new C(Ti,ni),Oi=new C(Ji,ni);if(fr){const ii=new C(-ti,ti-qf),Mn=-Math.PI/2,zi=ei/2-ti,Ei=new C(5-qf-zi,-(pt.imageName?zi:0)),si=new C(...Gr);ri._rotateAround(Mn,ii)._add(Ei)._add(si),Ri._rotateAround(Mn,ii)._add(Ei)._add(si),Qi._rotateAround(Mn,ii)._add(Ei)._add(si),Oi._rotateAround(Mn,ii)._add(Ei)._add(si)}if(yt){const ii=Math.sin(yt),Mn=Math.cos(yt),zi=[Mn,-ii,ii,Mn];ri._matMult(zi),Ri._matMult(zi),Qi._matMult(zi),Oi._matMult(zi)}const ys=new C(0,0),_s=new C(0,0);dt.push({tl:ri,tr:Ri,bl:Qi,br:Oi,tex:it,writingMode:Te.writingMode,glyphOffset:Ls,sectionIndex:pt.sectionIndex,isSDF:Ut,pixelOffsetTL:ys,pixelOffsetBR:_s,minFontScaleX:0,minFontScaleY:0})}return dt}(0,u,T,g,x,w,f,c.allowVerticalPlacement),me=c.textSizeData;let ve=null;me.kind==="source"?(ve=[va*g.layout.get("text-size").evaluate(w,{})],ve[0]>Vl&&je(`${c.layerIds[0]}: Value for "text-size" is >= ${Xf}. Reduce your "text-size".`)):me.kind==="composite"&&(ve=[va*Y.compositeTextSizes[0].evaluate(w,{},Q),va*Y.compositeTextSizes[1].evaluate(w,{},Q)],(ve[0]>Vl||ve[1]>Vl)&&je(`${c.layerIds[0]}: Value for "text-size" is >= ${Xf}. Reduce your "text-size".`)),c.addSymbols(c.text,le,ve,T,x,w,M,s,I.lineStartIndex,I.lineLength,H,Q);for(const ke of B)U[ke]=c.text.placedSymbolArray.length-1;return 4*le.length}function QE(c){for(const s in c)return c[s];return null}function l4(c,s,u,f){const g=c.compareText;if(s in g){const x=g[s];for(let w=x.length-1;w>=0;w--)if(f.dist(x[w])<u)return!0}else g[s]=[];return g[s].push(f),!1}const eP=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ox{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=eP[15&f];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[T]=new Uint32Array(s,4,1);return new Ox(T,w,x,s)}constructor(s,u=64,f=Float64Array,g){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=eP.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,T=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-T%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+T+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=u,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return zx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:T}=this,I=[0,x.length-1,0],M=[];for(;I.length;){const B=I.pop()||0,U=I.pop()||0,H=I.pop()||0;if(U-H<=T){for(let me=H;me<=U;me++){const ve=w[2*me],ke=w[2*me+1];ve>=s&&ve<=f&&ke>=u&&ke<=g&&M.push(x[me])}continue}const Y=H+U>>1,Q=w[2*Y],le=w[2*Y+1];Q>=s&&Q<=f&&le>=u&&le<=g&&M.push(x[Y]),(B===0?s<=Q:u<=le)&&(I.push(H),I.push(Y-1),I.push(1-B)),(B===0?f>=Q:g>=le)&&(I.push(Y+1),I.push(U),I.push(1-B))}return M}within(s,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:w}=this,T=[0,g.length-1,0],I=[],M=f*f;for(;T.length;){const B=T.pop()||0,U=T.pop()||0,H=T.pop()||0;if(U-H<=w){for(let me=H;me<=U;me++)nP(x[2*me],x[2*me+1],s,u)<=M&&I.push(g[me]);continue}const Y=H+U>>1,Q=x[2*Y],le=x[2*Y+1];nP(Q,le,s,u)<=M&&I.push(g[Y]),(B===0?s-f<=Q:u-f<=le)&&(T.push(H),T.push(Y-1),T.push(1-B)),(B===0?s+f>=Q:u+f>=le)&&(T.push(Y+1),T.push(U),T.push(1-B))}return I}}function zx(c,s,u,f,g,x){if(g-f<=u)return;const w=f+g>>1;tP(c,s,w,f,g,x),zx(c,s,u,f,w-1,1-x),zx(c,s,u,w+1,g,1-x)}function tP(c,s,u,f,g,x){for(;g>f;){if(g-f>600){const M=g-f+1,B=u-f+1,U=Math.log(M),H=.5*Math.exp(2*U/3),Y=.5*Math.sqrt(U*H*(M-H)/M)*(B-M/2<0?-1:1);tP(c,s,u,Math.max(f,Math.floor(u-B*H/M+Y)),Math.min(g,Math.floor(u+(M-B)*H/M+Y)),x)}const w=s[2*u+x];let T=f,I=g;for(Kf(c,s,f,u),s[2*g+x]>w&&Kf(c,s,f,g);T<I;){for(Kf(c,s,T,I),T++,I--;s[2*T+x]<w;)T++;for(;s[2*I+x]>w;)I--}s[2*f+x]===w?Kf(c,s,f,I):(I++,Kf(c,s,I,g)),I<=u&&(f=I+1),u<=I&&(g=I-1)}}function Kf(c,s,u,f){Dx(c,u,f),Dx(s,2*u,2*f),Dx(s,2*u+1,2*f+1)}function Dx(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}function nP(c,s,u,f){const g=c-u,x=s-f;return g*g+x*x}var Fx;l.bh=void 0,(Fx=l.bh||(l.bh={})).create="create",Fx.load="load",Fx.fullLoad="fullLoad";let sy=null,Jf=[];const Nx=1e3/60,Bx="loadTime",jx="fullLoadTime",c4={mark(c){performance.mark(c)},frame(c){const s=c;sy!=null&&Jf.push(s-sy),sy=s},clearMetrics(){sy=null,Jf=[],performance.clearMeasures(Bx),performance.clearMeasures(jx);for(const c in l.bh)performance.clearMarks(l.bh[c])},getPerformanceMetrics(){performance.measure(Bx,l.bh.create,l.bh.load),performance.measure(jx,l.bh.create,l.bh.fullLoad);const c=performance.getEntriesByName(Bx)[0].duration,s=performance.getEntriesByName(jx)[0].duration,u=Jf.length,f=1/(Jf.reduce((x,w)=>x+w,0)/u/1e3),g=Jf.filter(x=>x>Nx).reduce((x,w)=>x+(w-Nx)/Nx,0);return{loadTime:c,fullLoadTime:s,fps:f,percentDroppedFrames:g/(u+g)*100,totalFrames:u}}};l.$=function(c,s,u){var f,g,x,w,T,I,M,B,U,H,Y,Q,le=u[0],me=u[1],ve=u[2];return s===c?(c[12]=s[0]*le+s[4]*me+s[8]*ve+s[12],c[13]=s[1]*le+s[5]*me+s[9]*ve+s[13],c[14]=s[2]*le+s[6]*me+s[10]*ve+s[14],c[15]=s[3]*le+s[7]*me+s[11]*ve+s[15]):(g=s[1],x=s[2],w=s[3],T=s[4],I=s[5],M=s[6],B=s[7],U=s[8],H=s[9],Y=s[10],Q=s[11],c[0]=f=s[0],c[1]=g,c[2]=x,c[3]=w,c[4]=T,c[5]=I,c[6]=M,c[7]=B,c[8]=U,c[9]=H,c[10]=Y,c[11]=Q,c[12]=f*le+T*me+U*ve+s[12],c[13]=g*le+I*me+H*ve+s[13],c[14]=x*le+M*me+Y*ve+s[14],c[15]=w*le+B*me+Q*ve+s[15]),c},l.A=fh,l.B=hs,l.C=class{constructor(c,s,u){this.receive=f=>{const g=f.data,x=g.id;if(x&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[x];const w=this.cancelCallbacks[x];delete this.cancelCallbacks[x],w&&w()}else Ye()||g.mustQueue?(this.tasks[x]=g,this.taskQueue.push(x),this.invoker.trigger()):this.processTask(x,g)},this.process=()=>{if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),g=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(f,g)},this.target=c,this.parent=s,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new QF(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ye()?c:window}send(c,s,u,f,g=!1){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[x]=u);const w=[],T={id:x,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:ga(s,w)};return this.target.postMessage(T,{transfer:w}),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}processTask(c,s){if(s.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(s.error?u(zl(s.error)):u(null,zl(s.data)))}else{let u=!1;const f=[],g=s.hasCallback?(T,I)=>{u=!0,delete this.cancelCallbacks[c];const M={id:c,type:"<response>",sourceMapId:this.mapId,error:T?ga(T):null,data:ga(I,f)};this.target.postMessage(M,{transfer:f})}:T=>{u=!0};let x=null;const w=zl(s.data);if(this.parent[s.type])x=this.parent[s.type](s.sourceMapId,w,g);else if("getWorkerSource"in this.parent){const T=s.type.split(".");x=this.parent.getWorkerSource(s.sourceMapId,T[0],w.source)[T[1]](w,g)}else g(new Error(`Could not find function ${s.type}`));!u&&x&&x.cancel&&(this.cancelCallbacks[c]=x.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.D=Zt,l.E=un,l.F=function(c,s){const u={};for(let f=0;f<s.length;f++){const g=s[f];g in c&&(u[g]=c[g])}return u},l.G=kE,l.H=ME,l.I=bx,l.J=N,l.K=F,l.L=Ul,l.M=Dt,l.N=$r,l.O=Gs,l.P=C,l.Q=yr,l.R=$s,l.S=or,l.T=Og,l.U=ey,l.V=class extends Ha{},l.W=Mx,l.X=function(c,s){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let f=0;f<c.length;f++){const g=window.document.createElement("source");It(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},l.Y=$e,l.Z=function(){var c=new fh(16);return fh!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},l._=m,l.a=Xe,l.a$=class extends X{},l.a0=function(c,s,u){var f=u[0],g=u[1],x=u[2];return c[0]=s[0]*f,c[1]=s[1]*f,c[2]=s[2]*f,c[3]=s[3]*f,c[4]=s[4]*g,c[5]=s[5]*g,c[6]=s[6]*g,c[7]=s[7]*g,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.a1=zT,l.a2=function(){return Se++},l.a3=fe,l.a4=vh,l.a5=function(){ps.isLoading()||ps.isLoaded()||Pf()!=="deferred"||Rg()},l.a6=mf,l.a7=Yc,l.a8=sr,l.a9=NE,l.aA=Gc,l.aB=function(c){c=c.slice();const s=Object.create(null);for(let u=0;u<c.length;u++)s[c[u].id]=c[u];for(let u=0;u<c.length;u++)"ref"in c[u]&&(c[u]=bn(c[u],s[c[u].ref]));return c},l.aC=function(c){if(c.type==="custom")return new JF(c);switch(c.type){case"background":return new XF(c);case"circle":return new OD(c);case"fill":return new eF(c);case"fill-extrusion":return new mF(c);case"heatmap":return new DD(c);case"hillshade":return new ND(c);case"line":return new SF(c);case"raster":return new KF(c);case"symbol":return new Qg(c)}},l.aD=De,l.aE=function(c,s){if(!c)return[{command:kt.setStyle,args:[s]}];let u=[];try{if(!Yt(c.version,s.version))return[{command:kt.setStyle,args:[s]}];Yt(c.center,s.center)||u.push({command:kt.setCenter,args:[s.center]}),Yt(c.zoom,s.zoom)||u.push({command:kt.setZoom,args:[s.zoom]}),Yt(c.bearing,s.bearing)||u.push({command:kt.setBearing,args:[s.bearing]}),Yt(c.pitch,s.pitch)||u.push({command:kt.setPitch,args:[s.pitch]}),Yt(c.sprite,s.sprite)||u.push({command:kt.setSprite,args:[s.sprite]}),Yt(c.glyphs,s.glyphs)||u.push({command:kt.setGlyphs,args:[s.glyphs]}),Yt(c.transition,s.transition)||u.push({command:kt.setTransition,args:[s.transition]}),Yt(c.light,s.light)||u.push({command:kt.setLight,args:[s.light]});const f={},g=[];(function(w,T,I,M){let B;for(B in T=T||{},w=w||{})Object.prototype.hasOwnProperty.call(w,B)&&(Object.prototype.hasOwnProperty.call(T,B)||Un(B,I,M));for(B in T)Object.prototype.hasOwnProperty.call(T,B)&&(Object.prototype.hasOwnProperty.call(w,B)?Yt(w[B],T[B])||(w[B].type==="geojson"&&T[B].type==="geojson"&&Qe(w,T,B)?I.push({command:kt.setGeoJSONSourceData,args:[B,T[B].data]}):zn(B,T,I,M)):Ln(B,T,I))})(c.sources,s.sources,g,f);const x=[];c.layers&&c.layers.forEach(w=>{f[w.source]?u.push({command:kt.removeLayer,args:[w.id]}):x.push(w)}),u=u.concat(g),function(w,T,I){T=T||[];const M=(w=w||[]).map(vt),B=T.map(vt),U=w.reduce(hn,{}),H=T.reduce(hn,{}),Y=M.slice(),Q=Object.create(null);let le,me,ve,ke,Te,Le,ze;for(le=0,me=0;le<M.length;le++)ve=M[le],Object.prototype.hasOwnProperty.call(H,ve)?me++:(I.push({command:kt.removeLayer,args:[ve]}),Y.splice(Y.indexOf(ve,me),1));for(le=0,me=0;le<B.length;le++)ve=B[B.length-1-le],Y[Y.length-1-le]!==ve&&(Object.prototype.hasOwnProperty.call(U,ve)?(I.push({command:kt.removeLayer,args:[ve]}),Y.splice(Y.lastIndexOf(ve,Y.length-me),1)):me++,Le=Y[Y.length-le],I.push({command:kt.addLayer,args:[H[ve],Le]}),Y.splice(Y.length-le,0,ve),Q[ve]=!0);for(le=0;le<B.length;le++)if(ve=B[le],ke=U[ve],Te=H[ve],!Q[ve]&&!Yt(ke,Te))if(Yt(ke.source,Te.source)&&Yt(ke["source-layer"],Te["source-layer"])&&Yt(ke.type,Te.type)){for(ze in qe(ke.layout,Te.layout,I,ve,null,kt.setLayoutProperty),qe(ke.paint,Te.paint,I,ve,null,kt.setPaintProperty),Yt(ke.filter,Te.filter)||I.push({command:kt.setFilter,args:[ve,Te.filter]}),Yt(ke.minzoom,Te.minzoom)&&Yt(ke.maxzoom,Te.maxzoom)||I.push({command:kt.setLayerZoomRange,args:[ve,Te.minzoom,Te.maxzoom]}),ke)Object.prototype.hasOwnProperty.call(ke,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?qe(ke[ze],Te[ze],I,ve,ze.slice(6),kt.setPaintProperty):Yt(ke[ze],Te[ze])||I.push({command:kt.setLayerProperty,args:[ve,ze,Te[ze]]}));for(ze in Te)Object.prototype.hasOwnProperty.call(Te,ze)&&!Object.prototype.hasOwnProperty.call(ke,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?qe(ke[ze],Te[ze],I,ve,ze.slice(6),kt.setPaintProperty):Yt(ke[ze],Te[ze])||I.push({command:kt.setLayerProperty,args:[ve,ze,Te[ze]]}))}else I.push({command:kt.removeLayer,args:[ve]}),Le=Y[Y.lastIndexOf(ve)+1],I.push({command:kt.addLayer,args:[Te,Le]})}(x,s.layers,u)}catch(f){console.warn("Unable to compute style diff:",f),u=[{command:kt.setStyle,args:[s]}]}return u},l.aF=function(c){const s=[],u=c.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},l.aG=function c(s,u){if(Array.isArray(s)){if(!Array.isArray(u)||s.length!==u.length)return!1;for(let f=0;f<s.length;f++)if(!c(s[f],u[f]))return!1;return!0}if(typeof s=="object"&&s!==null&&u!==null){if(typeof u!="object"||Object.keys(s).length!==Object.keys(u).length)return!1;for(const f in s)if(!c(s[f],u[f]))return!1;return!0}return s===u},l.aH=_e,l.aI=Re,l.aJ=Wc,l.aK=function(c){return c({pluginStatus:qi,pluginURL:ya}),Wc.on("pluginStateChange",c),c},l.aL=class extends Xa{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},l.aM=hh,l.aN=class extends Xa{constructor(c,s){super(c,s),this.current=Qv}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},l.aO=Ng,l.aP=class extends Xa{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},l.aQ=class extends Xa{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},l.aR=Bg,l.aS=function(c,s,u,f,g,x,w){var T=1/(s-u),I=1/(f-g),M=1/(x-w);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(s+u)*T,c[13]=(g+f)*I,c[14]=(w+x)*M,c[15]=1,c},l.aT=Pn,l.aU=RD,l.aV=class extends p{},l.aW=CF,l.aX=class extends b{},l.aY=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},l.aZ=jT,l.a_=ct,l.aa=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const w=g||x;return s[f]=!w||w.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s},l.ab=function(c,s){const u=[];for(const f in c)f in s||u.push(f);return u},l.ac=function(c){if(Ce==null){const s=c.navigator?c.navigator.userAgent:null;Ce=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ce},l.ad=ne,l.ae=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[0],w=s[1],T=s[2],I=s[3],M=s[4],B=s[5],U=s[6],H=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*g+M*f,c[1]=w*g+B*f,c[2]=T*g+U*f,c[3]=I*g+H*f,c[4]=M*g-x*f,c[5]=B*g-w*f,c[6]=U*g-T*f,c[7]=H*g-I*f,c},l.af=function(c){var s=new fh(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},l.ag=$g,l.ah=function(c,s){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:w}=c,T=g?ne(ds.interpolationFactor(g,s,x,w),0,1):0;c.kind==="camera"?f=hs.number(c.minSize,c.maxSize,T):u=T}return{uSizeT:u,uSize:f}},l.aj=function(c,{uSize:s,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/va:c.kind==="composite"?hs.number(f/va,g/va,u):s},l.ak=Ex,l.al=function(c,s,u,f){const g=s.y-c.y,x=s.x-c.x,w=f.y-u.y,T=f.x-u.x,I=w*x-T*g;if(I===0)return null;const M=(T*(c.y-u.y)-w*(c.x-u.x))/I;return new C(c.x+M*x,c.y+M*g)},l.am=UE,l.an=IT,l.ao=ix,l.ap=ei,l.ar=Tx,l.as=function(c,s){var u=s[0],f=s[1],g=s[2],x=s[3],w=s[4],T=s[5],I=s[6],M=s[7],B=s[8],U=s[9],H=s[10],Y=s[11],Q=s[12],le=s[13],me=s[14],ve=s[15],ke=u*T-f*w,Te=u*I-g*w,Le=u*M-x*w,ze=f*I-g*T,Je=f*M-x*T,Tt=g*M-x*I,Nt=B*le-U*Q,wt=B*me-H*Q,yt=B*ve-Y*Q,dt=U*me-H*le,Lt=U*ve-Y*le,pt=H*ve-Y*me,it=ke*pt-Te*Lt+Le*dt+ze*yt-Je*wt+Tt*Nt;return it?(c[0]=(T*pt-I*Lt+M*dt)*(it=1/it),c[1]=(g*Lt-f*pt-x*dt)*it,c[2]=(le*Tt-me*Je+ve*ze)*it,c[3]=(H*Je-U*Tt-Y*ze)*it,c[4]=(I*yt-w*pt-M*wt)*it,c[5]=(u*pt-g*yt+x*wt)*it,c[6]=(me*Le-Q*Tt-ve*Te)*it,c[7]=(B*Tt-H*Le+Y*Te)*it,c[8]=(w*Lt-T*yt+M*Nt)*it,c[9]=(f*yt-u*Lt-x*Nt)*it,c[10]=(Q*Je-le*Le+ve*ke)*it,c[11]=(U*Le-B*Je-Y*ke)*it,c[12]=(T*wt-w*dt-I*Nt)*it,c[13]=(u*dt-f*wt+g*Nt)*it,c[14]=(le*Te-Q*ze-me*ke)*it,c[15]=(B*ze-U*Te+H*ke)*it,c):null},l.at=Rx,l.au=Sx,l.av=Ox,l.aw=function(){const c={},s=Ae.$version;for(const u in Ae.$root){const f=Ae.$root[u];if(f.required){let g=null;g=u==="version"?s:f.type==="array"?[]:{},g!=null&&(c[u]=g)}}return c},l.ax=kt,l.ay=Ig,l.az=Et,l.b=function(c,s){const u=new Blob([new Uint8Array(c)],{type:"image/png"});createImageBitmap(u).then(f=>{s(null,f)}).catch(f=>{s(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.b0=pi,l.b1=function(c,s){var u=c[0],f=c[1],g=c[2],x=c[3],w=c[4],T=c[5],I=c[6],M=c[7],B=c[8],U=c[9],H=c[10],Y=c[11],Q=c[12],le=c[13],me=c[14],ve=c[15],ke=s[0],Te=s[1],Le=s[2],ze=s[3],Je=s[4],Tt=s[5],Nt=s[6],wt=s[7],yt=s[8],dt=s[9],Lt=s[10],pt=s[11],it=s[12],Jt=s[13],Ut=s[14],Sn=s[15];return Math.abs(u-ke)<=Xi*Math.max(1,Math.abs(u),Math.abs(ke))&&Math.abs(f-Te)<=Xi*Math.max(1,Math.abs(f),Math.abs(Te))&&Math.abs(g-Le)<=Xi*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(x-ze)<=Xi*Math.max(1,Math.abs(x),Math.abs(ze))&&Math.abs(w-Je)<=Xi*Math.max(1,Math.abs(w),Math.abs(Je))&&Math.abs(T-Tt)<=Xi*Math.max(1,Math.abs(T),Math.abs(Tt))&&Math.abs(I-Nt)<=Xi*Math.max(1,Math.abs(I),Math.abs(Nt))&&Math.abs(M-wt)<=Xi*Math.max(1,Math.abs(M),Math.abs(wt))&&Math.abs(B-yt)<=Xi*Math.max(1,Math.abs(B),Math.abs(yt))&&Math.abs(U-dt)<=Xi*Math.max(1,Math.abs(U),Math.abs(dt))&&Math.abs(H-Lt)<=Xi*Math.max(1,Math.abs(H),Math.abs(Lt))&&Math.abs(Y-pt)<=Xi*Math.max(1,Math.abs(Y),Math.abs(pt))&&Math.abs(Q-it)<=Xi*Math.max(1,Math.abs(Q),Math.abs(it))&&Math.abs(le-Jt)<=Xi*Math.max(1,Math.abs(le),Math.abs(Jt))&&Math.abs(me-Ut)<=Xi*Math.max(1,Math.abs(me),Math.abs(Ut))&&Math.abs(ve-Sn)<=Xi*Math.max(1,Math.abs(ve),Math.abs(Sn))},l.b2=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.b3=function(c,s,u){return c[0]=s[0]*u[0],c[1]=s[1]*u[1],c[2]=s[2]*u[2],c[3]=s[3]*u[3],c},l.b4=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},l.b5=se,l.b6=zE,l.b7=LE,l.b8=function(c,s,u,f,g){var x,w=1/Math.tan(s/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(x=1/(f-g)),c[14]=2*g*f*x):(c[10]=-1,c[14]=-2*f),c},l.b9=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[4],w=s[5],T=s[6],I=s[7],M=s[8],B=s[9],U=s[10],H=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*g+M*f,c[5]=w*g+B*f,c[6]=T*g+U*f,c[7]=I*g+H*f,c[8]=M*g-x*f,c[9]=B*g-w*f,c[10]=U*g-T*f,c[11]=H*g-I*f,c},l.bA=S,l.bB=aE,l.bC=eh,l.bD=ps,l.ba=$,l.bb=K,l.bc=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},l.bd=class extends Zc{},l.be=Ix,l.bf=RE,l.bg=c4,l.bi=nt,l.bj=function(c,s,u=!1){if(qi===bf||qi===wf||qi===Sf)throw new Error("setRTLTextPlugin cannot be called multiple times.");ya=bt.resolveURL(c),qi=bf,Tf=s,Ef(),u||Rg()},l.bk=Pf,l.bl=function(c,s){const u={};for(let g=0;g<c.length;g++){const x=s&&s[c[g].id]||ih(c[g]);s&&(s[c[g].id]=x);let w=u[x];w||(w=u[x]=[]),w.push(c[g])}const f=[];for(const g in u)f.push(u[g]);return f},l.bm=Mt,l.bn=FE,l.bo=BE,l.bp=gE,l.bq=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=$r/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],u=s.layout,f=s._unevaluatedLayout._values,g={layoutIconSize:f["icon-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new sr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:B}=c.bucket.textSizeData;g.compositeTextSizes=[f["text-size"].possiblyEvaluate(new sr(M),c.canonical),f["text-size"].possiblyEvaluate(new sr(B),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:B}=c.bucket.iconSizeData;g.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new sr(M),c.canonical),f["icon-size"].possiblyEvaluate(new sr(B),c.canonical)]}const x=u.get("text-line-height")*ei,w=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",T=u.get("text-keep-upright"),I=u.get("text-size");for(const M of c.bucket.features){const B=u.get("text-font").evaluate(M,{},c.canonical).join(","),U=I.evaluate(M,{},c.canonical),H=g.layoutTextSize.evaluate(M,{},c.canonical),Y=g.layoutIconSize.evaluate(M,{},c.canonical),Q={horizontal:{},vertical:void 0},le=M.text;let me,ve=[0,0];if(le){const Le=le.toString(),ze=u.get("text-letter-spacing").evaluate(M,{},c.canonical)*ei,Je=vf(Le)?ze:0,Tt=u.get("text-anchor").evaluate(M,{},c.canonical),Nt=KE(s,M,c.canonical);if(!Nt){const pt=u.get("text-radial-offset").evaluate(M,{},c.canonical);ve=pt?YE(Tt,[pt*ei,Lx]):u.get("text-offset").evaluate(M,{},c.canonical).map(it=>it*ei)}let wt=w?"center":u.get("text-justify").evaluate(M,{},c.canonical);const yt=u.get("symbol-placement"),dt=yt==="point"?u.get("text-max-width").evaluate(M,{},c.canonical)*ei:0,Lt=()=>{c.bucket.allowVerticalPlacement&&_f(Le)&&(Q.vertical=Yg(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,Tt,"left",Je,ve,l.ai.vertical,!0,yt,H,U))};if(!w&&Nt){const pt=new Set;if(wt==="auto")for(let Jt=0;Jt<Nt.values.length;Jt+=2)pt.add(Rx(Nt.values[Jt]));else pt.add(wt);let it=!1;for(const Jt of pt)if(!Q.horizontal[Jt])if(it)Q.horizontal[Jt]=Q.horizontal[0];else{const Ut=Yg(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,"center",Jt,Je,ve,l.ai.horizontal,!1,yt,H,U);Ut&&(Q.horizontal[Jt]=Ut,it=Ut.positionedLines.length===1)}Lt()}else{wt==="auto"&&(wt=Rx(Tt));const pt=Yg(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,Tt,wt,Je,ve,l.ai.horizontal,!1,yt,H,U);pt&&(Q.horizontal[wt]=pt),Lt(),_f(Le)&&w&&T&&(Q.vertical=Yg(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,Tt,wt,Je,ve,l.ai.vertical,!1,yt,H,U))}}let ke=!1;if(M.icon&&M.icon.name){const Le=c.imageMap[M.icon.name];Le&&(me=GF(c.imagePositions[M.icon.name],u.get("icon-offset").evaluate(M,{},c.canonical),u.get("icon-anchor").evaluate(M,{},c.canonical)),ke=!!Le.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=ke:c.bucket.sdfIcons!==ke&&je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==c.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Te=QE(Q.horizontal)||Q.vertical;c.bucket.iconsInText=!!Te&&Te.iconsInText,(Te||me)&&a4(c.bucket,M,Q,me,c.imageMap,g,H,Y,ve,ke,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},l.br=yx,l.bs=px,l.bt=gx,l.bu=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},l.bv=vx,l.bw=Bl,l.bx=function(c,s,u,f,g){return m(this,void 0,void 0,function*(){if(F())try{return yield Dt(c,s,u,f,g)}catch{}return function(x,w,T,I,M){const B=x.width,U=x.height;mt&&ht||(mt=new OffscreenCanvas(B,U),ht=mt.getContext("2d",{willReadFrequently:!0})),mt.width=B,mt.height=U,ht.drawImage(x,0,0,B,U);const H=ht.getImageData(w,T,I,M);return ht.clearRect(0,0,B,U),H.data}(c,s,u,f,g)})},l.by=DE,l.bz=_,l.c=Wt,l.d=function(c,s){const u=new Image;u.onload=()=>{s(null,u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=lt})},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(c)],{type:"image/png"});u.src=c.byteLength?URL.createObjectURL(f):lt},l.e=xe,l.f=function(c,s){return mn(xe(c,{type:"json"}),s)},l.g=cn,l.h=bt,l.i=Ye,l.j=ut,l.k=vn,l.l=Ht,l.m=mn,l.n=function(c){return new vx(c).readFields(NF,[])},l.o=function(c,s,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let x=null;c.forEach((w,T)=>{s(w,(I,M)=>{I&&(x=I),g[T]=M,--f==0&&u(x,g)})})},l.p=mE,l.q=Bf,l.r=Rr,l.s=It,l.t=Xv,l.u=St,l.v=Ae,l.w=je,l.x=ah,l.y=Zo,l.z=function([c,s,u]){return s+=90,s*=Math.PI/180,u*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(u),y:c*Math.sin(s)*Math.sin(u),z:c*Math.cos(u)}}}),a(["./shared"],function(l){class m{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G){this._layerConfigs={},this._layers={},this.update(G,[])}update(G,Z){for(const de of G){this._layerConfigs[de.id]=de;const pe=this._layers[de.id]=l.aC(de);pe._featureFilter=l.a6(pe.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of Z)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const ie=l.bl(Object.values(this._layerConfigs),this.keyCache);for(const de of ie){const pe=de.map(Ge=>this._layers[Ge.id]),Me=pe[0];if(Me.visibility==="none")continue;const be=Me.source||"";let ye=this.familiesBySource[be];ye||(ye=this.familiesBySource[be]={});const Ee=Me.sourceLayer||"_geojsonTileLayer";let Ue=ye[Ee];Ue||(Ue=ye[Ee]=[]),Ue.push(pe)}}}class _{constructor(G){const Z={},ie=[];for(const be in G){const ye=G[be],Ee=Z[be]={};for(const Ue in ye){const Ge=ye[+Ue];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const He={x:0,y:0,w:Ge.bitmap.width+2,h:Ge.bitmap.height+2};ie.push(He),Ee[Ue]={rect:He,metrics:Ge.metrics}}}const{w:de,h:pe}=l.p(ie),Me=new l.q({width:de||1,height:pe||1});for(const be in G){const ye=G[be];for(const Ee in ye){const Ue=ye[+Ee];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Ge=Z[be][Ee].rect;l.q.copy(Ue.bitmap,Me,{x:0,y:0},{x:Ge.x+1,y:Ge.y+1},Ue.bitmap)}}this.image=Me,this.positions=Z}}l.bm("GlyphAtlas",_);class S{constructor(G){this.tileID=new l.O(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.uid=G.uid,this.zoom=G.zoom,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=G.showCollisionBoxes,this.collectResourceTiming=!!G.collectResourceTiming,this.returnDependencies=!!G.returnDependencies,this.promoteId=G.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(G,Z,ie,de,pe){this.status="parsing",this.data=G,this.collisionBoxArray=new l.a3;const Me=new l.bn(Object.keys(G.layers).sort()),be=new l.bo(this.tileID,this.promoteId);be.bucketLayerIDs=[];const ye={},Ee={featureIndex:be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie},Ue=Z.familiesBySource[this.source];for(const gn in Ue){const fn=G.layers[gn];if(!fn)continue;fn.version===1&&l.w(`Vector tile source "${this.source}" layer "${gn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const nn=Me.encode(gn),_n=[];for(let pr=0;pr<fn.length;pr++){const Yr=fn.feature(pr),$i=be.getId(Yr,gn);_n.push({feature:Yr,id:$i,index:pr,sourceLayerIndex:nn})}for(const pr of Ue[gn]){const Yr=pr[0];Yr.source!==this.source&&l.w(`layer.source = ${Yr.source} does not equal this.source = ${this.source}`),Yr.minzoom&&this.zoom<Math.floor(Yr.minzoom)||Yr.maxzoom&&this.zoom>=Yr.maxzoom||Yr.visibility!=="none"&&(P(pr,this.zoom,ie),(ye[Yr.id]=Yr.createBucket({index:be.bucketLayerIDs.length,layers:pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:nn,sourceID:this.source})).populate(_n,Ee,this.tileID.canonical),be.bucketLayerIDs.push(pr.map($i=>$i.id)))}}let Ge,He,Ot,Kt;const Pt=l.aH(Ee.glyphDependencies,gn=>Object.keys(gn).map(Number));this.inFlightDependencies.forEach(gn=>gn==null?void 0:gn.cancel()),this.inFlightDependencies=[];const Bt=++this.dependencySentinel;Object.keys(Pt).length?this.inFlightDependencies.push(de.send("getGlyphs",{uid:this.uid,stacks:Pt,source:this.source,tileID:this.tileID,type:"glyphs"},(gn,fn)=>{Bt===this.dependencySentinel&&(Ge||(Ge=gn,He=fn,kn.call(this)))})):He={};const At=Object.keys(Ee.iconDependencies);At.length?this.inFlightDependencies.push(de.send("getImages",{icons:At,source:this.source,tileID:this.tileID,type:"icons"},(gn,fn)=>{Bt===this.dependencySentinel&&(Ge||(Ge=gn,Ot=fn,kn.call(this)))})):Ot={};const dn=Object.keys(Ee.patternDependencies);function kn(){if(Ge)return pe(Ge);if(He&&Ot&&Kt){const gn=new _(He),fn=new l.bp(Ot,Kt);for(const nn in ye){const _n=ye[nn];_n instanceof l.a4?(P(_n.layers,this.zoom,ie),l.bq({bucket:_n,glyphMap:He,glyphPositions:gn.positions,imageMap:Ot,imagePositions:fn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):_n.hasPattern&&(_n instanceof l.br||_n instanceof l.bs||_n instanceof l.bt)&&(P(_n.layers,this.zoom,ie),_n.addFeatures(Ee,this.tileID.canonical,fn.patternPositions))}this.status="done",pe(null,{buckets:Object.values(ye).filter(nn=>!nn.isEmpty()),featureIndex:be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gn.image,imageAtlas:fn,glyphMap:this.returnDependencies?He:null,iconMap:this.returnDependencies?Ot:null,glyphPositions:this.returnDependencies?gn.positions:null})}}dn.length?this.inFlightDependencies.push(de.send("getImages",{icons:dn,source:this.source,tileID:this.tileID,type:"patterns"},(gn,fn)=>{Bt===this.dependencySentinel&&(Ge||(Ge=gn,Kt=fn,kn.call(this)))})):Kt={},kn.call(this)}}function P(he,G,Z){const ie=new l.a8(G);for(const de of he)de.recalculate(ie,Z)}function C(he,G){const Z=l.l(he.request,(ie,de,pe,Me)=>{if(ie)G(ie);else if(de)try{const be=new l.bw.VectorTile(new l.bv(de));G(null,{vectorTile:be,rawData:de,cacheControl:pe,expires:Me})}catch(be){const ye=new Uint8Array(de);let Ee=`Unable to parse the tile at ${he.request.url}, `;Ee+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${be.messge}`,G(new Error(Ee))}});return()=>{Z.cancel(),G()}}class L{constructor(G,Z,ie,de){this.actor=G,this.layerIndex=Z,this.availableImages=ie,this.loadVectorData=de||C,this.fetching={},this.loading={},this.loaded={}}loadTile(G,Z){const ie=G.uid;this.loading||(this.loading={});const de=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.bu(G.request),pe=this.loading[ie]=new S(G);pe.abort=this.loadVectorData(G,(Me,be)=>{if(delete this.loading[ie],Me||!be)return pe.status="done",this.loaded[ie]=pe,Z(Me);const ye=be.rawData,Ee={};be.expires&&(Ee.expires=be.expires),be.cacheControl&&(Ee.cacheControl=be.cacheControl);const Ue={};if(de){const Ge=de.finish();Ge&&(Ue.resourceTiming=JSON.parse(JSON.stringify(Ge)))}pe.vectorTile=be.vectorTile,pe.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ge,He)=>{if(delete this.fetching[ie],Ge||!He)return Z(Ge);Z(null,l.e({rawTileData:ye.slice(0)},He,Ee,Ue))}),this.loaded=this.loaded||{},this.loaded[ie]=pe,this.fetching[ie]={rawTileData:ye,cacheControl:Ee,resourceTiming:Ue}})}reloadTile(G,Z){const ie=this.loaded,de=G.uid;if(ie&&ie[de]){const pe=ie[de];pe.showCollisionBoxes=G.showCollisionBoxes,pe.status==="parsing"?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Me,be)=>{if(Me||!be)return Z(Me,be);let ye;if(this.fetching[de]){const{rawTileData:Ee,cacheControl:Ue,resourceTiming:Ge}=this.fetching[de];delete this.fetching[de],ye=l.e({rawTileData:Ee.slice(0)},be,Ue,Ge)}else ye=be;Z(null,ye)}):pe.status==="done"&&(pe.vectorTile?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,Z):Z())}}abortTile(G,Z){const ie=this.loading,de=G.uid;ie&&ie[de]&&ie[de].abort&&(ie[de].abort(),delete ie[de]),Z()}removeTile(G,Z){const ie=this.loaded,de=G.uid;ie&&ie[de]&&delete ie[de],Z()}}class R{constructor(){this.loaded={}}loadTile(G,Z){return l._(this,void 0,void 0,function*(){const{uid:ie,encoding:de,rawImageData:pe,redFactor:Me,greenFactor:be,blueFactor:ye,baseShift:Ee}=G,Ue=pe.width+2,Ge=pe.height+2,He=l.a(pe)?new l.R({width:Ue,height:Ge},yield l.bx(pe,-1,-1,Ue,Ge)):pe,Ot=new l.by(ie,He,de,Me,be,ye,Ee);this.loaded=this.loaded||{},this.loaded[ie]=Ot,Z(null,Ot)})}removeTile(G){const Z=this.loaded,ie=G.uid;Z&&Z[ie]&&delete Z[ie]}}function D(he,G){if(he.length!==0){W(he[0],G);for(var Z=1;Z<he.length;Z++)W(he[Z],!G)}}function W(he,G){for(var Z=0,ie=0,de=0,pe=he.length,Me=pe-1;de<pe;Me=de++){var be=(he[de][0]-he[Me][0])*(he[Me][1]+he[de][1]),ye=Z+be;ie+=Math.abs(Z)>=Math.abs(be)?Z-ye+be:be-ye+Z,Z=ye}Z+ie>=0!=!!G&&he.reverse()}var z=l.bz(function he(G,Z){var ie,de=G&&G.type;if(de==="FeatureCollection")for(ie=0;ie<G.features.length;ie++)he(G.features[ie],Z);else if(de==="GeometryCollection")for(ie=0;ie<G.geometries.length;ie++)he(G.geometries[ie],Z);else if(de==="Feature")he(G.geometry,Z);else if(de==="Polygon")D(G.coordinates,Z);else if(de==="MultiPolygon")for(ie=0;ie<G.coordinates.length;ie++)D(G.coordinates[ie],Z);return G});const N=l.bw.VectorTileFeature.prototype.toGeoJSON;var F={exports:{}},$=l.bA,K=l.bw.VectorTileFeature,ne=se;function se(he,G){this.options=G||{},this.features=he,this.length=he.length}function xe(he,G){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=G||4096}se.prototype.feature=function(he){return new xe(this.features[he],this.options.extent)},xe.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var G=0;G<he.length;G++){for(var Z=he[G],ie=[],de=0;de<Z.length;de++)ie.push(new $(Z[de][0],Z[de][1]));this.geometry.push(ie)}return this.geometry},xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,G=1/0,Z=-1/0,ie=1/0,de=-1/0,pe=0;pe<he.length;pe++)for(var Me=he[pe],be=0;be<Me.length;be++){var ye=Me[be];G=Math.min(G,ye.x),Z=Math.max(Z,ye.x),ie=Math.min(ie,ye.y),de=Math.max(de,ye.y)}return[G,ie,Z,de]},xe.prototype.toGeoJSON=K.prototype.toGeoJSON;var Se=l.bB,_e=ne;function Re(he){var G=new Se;return function(Z,ie){for(var de in Z.layers)ie.writeMessage(3,De,Z.layers[de])}(he,G),G.finish()}function De(he,G){var Z;G.writeVarintField(15,he.version||1),G.writeStringField(1,he.name||""),G.writeVarintField(5,he.extent||4096);var ie={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<he.length;Z++)ie.feature=he.feature(Z),G.writeMessage(2,Ve,ie);var de=ie.keys;for(Z=0;Z<de.length;Z++)G.writeStringField(3,de[Z]);var pe=ie.values;for(Z=0;Z<pe.length;Z++)G.writeMessage(4,Ce,pe[Z])}function Ve(he,G){var Z=he.feature;Z.id!==void 0&&G.writeVarintField(1,Z.id),G.writeMessage(2,je,he),G.writeVarintField(3,Z.type),G.writeMessage(4,Ye,Z)}function je(he,G){var Z=he.feature,ie=he.keys,de=he.values,pe=he.keycache,Me=he.valuecache;for(var be in Z.properties){var ye=Z.properties[be],Ee=pe[be];if(ye!==null){Ee===void 0&&(ie.push(be),pe[be]=Ee=ie.length-1),G.writeVarint(Ee);var Ue=typeof ye;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(ye=JSON.stringify(ye));var Ge=Ue+":"+ye,He=Me[Ge];He===void 0&&(de.push(ye),Me[Ge]=He=de.length-1),G.writeVarint(He)}}}function We(he,G){return(G<<3)+(7&he)}function Ze(he){return he<<1^he>>31}function Ye(he,G){for(var Z=he.loadGeometry(),ie=he.type,de=0,pe=0,Me=Z.length,be=0;be<Me;be++){var ye=Z[be],Ee=1;ie===1&&(Ee=ye.length),G.writeVarint(We(1,Ee));for(var Ue=ie===3?ye.length-1:ye.length,Ge=0;Ge<Ue;Ge++){Ge===1&&ie!==1&&G.writeVarint(We(2,Ue-1));var He=ye[Ge].x-de,Ot=ye[Ge].y-pe;G.writeVarint(Ze(He)),G.writeVarint(Ze(Ot)),de+=He,pe+=Ot}ie===3&&G.writeVarint(We(7,1))}}function Ce(he,G){var Z=typeof he;Z==="string"?G.writeStringField(1,he):Z==="boolean"?G.writeBooleanField(7,he):Z==="number"&&(he%1!=0?G.writeDoubleField(3,he):he<0?G.writeSVarintField(6,he):G.writeVarintField(5,he))}F.exports=Re,F.exports.fromVectorTileJs=Re,F.exports.fromGeojsonVt=function(he,G){G=G||{};var Z={};for(var ie in he)Z[ie]=new _e(he[ie].features,G),Z[ie].name=ie,Z[ie].version=G.version,Z[ie].extent=G.extent;return Re({layers:Z})},F.exports.GeoJSONWrapper=_e;var Xe=l.bz(F.exports);const lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},Dt=Math.fround||(mt=new Float32Array(1),he=>(mt[0]=+he,mt[0]));var mt;const ht=3,ot=5,xt=6;class bt{constructor(G){this.options=Object.assign(Object.create(lt),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:Z,minZoom:ie,maxZoom:de}=this.options;Z&&console.time("total time");const pe=`prepare ${G.length} points`;Z&&console.time(pe),this.points=G;const Me=[];for(let ye=0;ye<G.length;ye++){const Ee=G[ye];if(!Ee.geometry)continue;const[Ue,Ge]=Ee.geometry.coordinates,He=Dt(Et(Ue)),Ot=Dt(cn(Ge));Me.push(He,Ot,1/0,ye,-1,1),this.options.reduce&&Me.push(0)}let be=this.trees[de+1]=this._createTree(Me);Z&&console.timeEnd(pe);for(let ye=de;ye>=ie;ye--){const Ee=+Date.now();be=this.trees[ye]=this._createTree(this._cluster(be,ye)),Z&&console.log("z%d: %d clusters in %dms",ye,be.numItems,+Date.now()-Ee)}return Z&&console.timeEnd("total time"),this}getClusters(G,Z){let ie=((G[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,G[1]));let pe=G[2]===180?180:((G[2]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)ie=-180,pe=180;else if(ie>pe){const Ge=this.getClusters([ie,de,180,Me],Z),He=this.getClusters([-180,de,pe,Me],Z);return Ge.concat(He)}const be=this.trees[this._limitZoom(Z)],ye=be.range(Et(ie),cn(Me),Et(pe),cn(de)),Ee=be.data,Ue=[];for(const Ge of ye){const He=this.stride*Ge;Ue.push(Ee[He+ot]>1?Wt(Ee,He,this.clusterProps):this.points[Ee[He+ht]])}return Ue}getChildren(G){const Z=this._getOriginId(G),ie=this._getOriginZoom(G),de="No cluster with the specified id.",pe=this.trees[ie];if(!pe)throw new Error(de);const Me=pe.data;if(Z*this.stride>=Me.length)throw new Error(de);const be=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),ye=pe.within(Me[Z*this.stride],Me[Z*this.stride+1],be),Ee=[];for(const Ue of ye){const Ge=Ue*this.stride;Me[Ge+4]===G&&Ee.push(Me[Ge+ot]>1?Wt(Me,Ge,this.clusterProps):this.points[Me[Ge+ht]])}if(Ee.length===0)throw new Error(de);return Ee}getLeaves(G,Z,ie){const de=[];return this._appendLeaves(de,G,Z=Z||10,ie=ie||0,0),de}getTile(G,Z,ie){const de=this.trees[this._limitZoom(G)],pe=Math.pow(2,G),{extent:Me,radius:be}=this.options,ye=be/Me,Ee=(ie-ye)/pe,Ue=(ie+1+ye)/pe,Ge={features:[]};return this._addTileFeatures(de.range((Z-ye)/pe,Ee,(Z+1+ye)/pe,Ue),de.data,Z,ie,pe,Ge),Z===0&&this._addTileFeatures(de.range(1-ye/pe,Ee,1,Ue),de.data,pe,ie,pe,Ge),Z===pe-1&&this._addTileFeatures(de.range(0,Ee,ye/pe,Ue),de.data,-1,ie,pe,Ge),Ge.features.length?Ge:null}getClusterExpansionZoom(G){let Z=this._getOriginZoom(G)-1;for(;Z<=this.options.maxZoom;){const ie=this.getChildren(G);if(Z++,ie.length!==1)break;G=ie[0].properties.cluster_id}return Z}_appendLeaves(G,Z,ie,de,pe){const Me=this.getChildren(Z);for(const be of Me){const ye=be.properties;if(ye&&ye.cluster?pe+ye.point_count<=de?pe+=ye.point_count:pe=this._appendLeaves(G,ye.cluster_id,ie,de,pe):pe<de?pe++:G.push(be),G.length===ie)break}return pe}_createTree(G){const Z=new l.av(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ie=0;ie<G.length;ie+=this.stride)Z.add(G[ie],G[ie+1]);return Z.finish(),Z.data=G,Z}_addTileFeatures(G,Z,ie,de,pe,Me){for(const be of G){const ye=be*this.stride,Ee=Z[ye+ot]>1;let Ue,Ge,He;if(Ee)Ue=nt(Z,ye,this.clusterProps),Ge=Z[ye],He=Z[ye+1];else{const Pt=this.points[Z[ye+ht]];Ue=Pt.properties;const[Bt,At]=Pt.geometry.coordinates;Ge=Et(Bt),He=cn(At)}const Ot={type:1,geometry:[[Math.round(this.options.extent*(Ge*pe-ie)),Math.round(this.options.extent*(He*pe-de))]],tags:Ue};let Kt;Kt=Ee||this.options.generateId?Z[ye+ht]:this.points[Z[ye+ht]].id,Kt!==void 0&&(Ot.id=Kt),Me.features.push(Ot)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,Z){const{radius:ie,extent:de,reduce:pe,minPoints:Me}=this.options,be=ie/(de*Math.pow(2,Z)),ye=G.data,Ee=[],Ue=this.stride;for(let Ge=0;Ge<ye.length;Ge+=Ue){if(ye[Ge+2]<=Z)continue;ye[Ge+2]=Z;const He=ye[Ge],Ot=ye[Ge+1],Kt=G.within(ye[Ge],ye[Ge+1],be),Pt=ye[Ge+ot];let Bt=Pt;for(const At of Kt){const dn=At*Ue;ye[dn+2]>Z&&(Bt+=ye[dn+ot])}if(Bt>Pt&&Bt>=Me){let At,dn=He*Pt,kn=Ot*Pt,gn=-1;const fn=((Ge/Ue|0)<<5)+(Z+1)+this.points.length;for(const nn of Kt){const _n=nn*Ue;if(ye[_n+2]<=Z)continue;ye[_n+2]=Z;const pr=ye[_n+ot];dn+=ye[_n]*pr,kn+=ye[_n+1]*pr,ye[_n+4]=fn,pe&&(At||(At=this._map(ye,Ge,!0),gn=this.clusterProps.length,this.clusterProps.push(At)),pe(At,this._map(ye,_n)))}ye[Ge+4]=fn,Ee.push(dn/Bt,kn/Bt,1/0,fn,-1,Bt),pe&&Ee.push(gn)}else{for(let At=0;At<Ue;At++)Ee.push(ye[Ge+At]);if(Bt>1)for(const At of Kt){const dn=At*Ue;if(!(ye[dn+2]<=Z)){ye[dn+2]=Z;for(let kn=0;kn<Ue;kn++)Ee.push(ye[dn+kn])}}}}return Ee}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,Z,ie){if(G[Z+ot]>1){const Me=this.clusterProps[G[Z+xt]];return ie?Object.assign({},Me):Me}const de=this.points[G[Z+ht]].properties,pe=this.options.map(de);return ie&&pe===de?Object.assign({},pe):pe}}function Wt(he,G,Z){return{type:"Feature",id:he[G+ht],properties:nt(he,G,Z),geometry:{type:"Point",coordinates:[(ie=he[G],360*(ie-.5)),en(he[G+1])]}};var ie}function nt(he,G,Z){const ie=he[G+ot],de=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie,pe=he[G+xt],Me=pe===-1?{}:Object.assign({},Z[pe]);return Object.assign(Me,{cluster:!0,cluster_id:he[G+ht],point_count:ie,point_count_abbreviated:de})}function Et(he){return he/360+.5}function cn(he){const G=Math.sin(he*Math.PI/180),Z=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Z<0?0:Z>1?1:Z}function en(he){const G=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function mn(he,G,Z,ie){for(var de,pe=ie,Me=Z-G>>1,be=Z-G,ye=he[G],Ee=he[G+1],Ue=he[Z],Ge=he[Z+1],He=G+3;He<Z;He+=3){var Ot=Ht(he[He],he[He+1],ye,Ee,Ue,Ge);if(Ot>pe)de=He,pe=Ot;else if(Ot===pe){var Kt=Math.abs(He-Me);Kt<be&&(de=He,be=Kt)}}pe>ie&&(de-G>3&&mn(he,G,de,ie),he[de+2]=pe,Z-de>3&&mn(he,de,Z,ie))}function Ht(he,G,Z,ie,de,pe){var Me=de-Z,be=pe-ie;if(Me!==0||be!==0){var ye=((he-Z)*Me+(G-ie)*be)/(Me*Me+be*be);ye>1?(Z=de,ie=pe):ye>0&&(Z+=Me*ye,ie+=be*ye)}return(Me=he-Z)*Me+(be=G-ie)*be}function It(he,G,Z,ie){var de={id:he===void 0?null:he,type:G,geometry:Z,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var Me=pe.geometry,be=pe.type;if(be==="Point"||be==="MultiPoint"||be==="LineString")Rt(pe,Me);else if(be==="Polygon"||be==="MultiLineString")for(var ye=0;ye<Me.length;ye++)Rt(pe,Me[ye]);else if(be==="MultiPolygon")for(ye=0;ye<Me.length;ye++)for(var Ee=0;Ee<Me[ye].length;Ee++)Rt(pe,Me[ye][Ee])}(de),de}function Rt(he,G){for(var Z=0;Z<G.length;Z+=3)he.minX=Math.min(he.minX,G[Z]),he.minY=Math.min(he.minY,G[Z+1]),he.maxX=Math.max(he.maxX,G[Z]),he.maxY=Math.max(he.maxY,G[Z+1])}function yn(he,G,Z,ie){if(G.geometry){var de=G.geometry.coordinates,pe=G.geometry.type,Me=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),be=[],ye=G.id;if(Z.promoteId?ye=G.properties[Z.promoteId]:Z.generateId&&(ye=ie||0),pe==="Point")vn(de,be);else if(pe==="MultiPoint")for(var Ee=0;Ee<de.length;Ee++)vn(de[Ee],be);else if(pe==="LineString")ut(de,be,Me,!1);else if(pe==="MultiLineString"){if(Z.lineMetrics){for(Ee=0;Ee<de.length;Ee++)ut(de[Ee],be=[],Me,!1),he.push(It(ye,"LineString",be,G.properties));return}un(de,be,Me,!1)}else if(pe==="Polygon")un(de,be,Me,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Ee=0;Ee<G.geometry.geometries.length;Ee++)yn(he,{id:ye,geometry:G.geometry.geometries[Ee],properties:G.properties},Z,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ee=0;Ee<de.length;Ee++){var Ue=[];un(de[Ee],Ue,Me,!0),be.push(Ue)}}he.push(It(ye,pe,be,G.properties))}}function vn(he,G){G.push(Ae(he[0])),G.push(Ct(he[1])),G.push(0)}function ut(he,G,Z,ie){for(var de,pe,Me=0,be=0;be<he.length;be++){var ye=Ae(he[be][0]),Ee=Ct(he[be][1]);G.push(ye),G.push(Ee),G.push(0),be>0&&(Me+=ie?(de*Ee-ye*pe)/2:Math.sqrt(Math.pow(ye-de,2)+Math.pow(Ee-pe,2))),de=ye,pe=Ee}var Ue=G.length-3;G[2]=1,mn(G,0,Ue,Z),G[Ue+2]=1,G.size=Math.abs(Me),G.start=0,G.end=G.size}function un(he,G,Z,ie){for(var de=0;de<he.length;de++){var pe=[];ut(he[de],pe,Z,ie),G.push(pe)}}function Ae(he){return he/360+.5}function Ct(he){var G=Math.sin(he*Math.PI/180),Z=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Z<0?0:Z>1?1:Z}function bn(he,G,Z,ie,de,pe,Me,be){if(ie/=G,pe>=(Z/=G)&&Me<ie)return he;if(Me<Z||pe>=ie)return null;for(var ye=[],Ee=0;Ee<he.length;Ee++){var Ue=he[Ee],Ge=Ue.geometry,He=Ue.type,Ot=de===0?Ue.minX:Ue.minY,Kt=de===0?Ue.maxX:Ue.maxY;if(Ot>=Z&&Kt<ie)ye.push(Ue);else if(!(Kt<Z||Ot>=ie)){var Pt=[];if(He==="Point"||He==="MultiPoint")Yt(Ge,Pt,Z,ie,de);else if(He==="LineString")kt(Ge,Pt,Z,ie,de,!1,be.lineMetrics);else if(He==="MultiLineString")Un(Ge,Pt,Z,ie,de,!1);else if(He==="Polygon")Un(Ge,Pt,Z,ie,de,!0);else if(He==="MultiPolygon")for(var Bt=0;Bt<Ge.length;Bt++){var At=[];Un(Ge[Bt],At,Z,ie,de,!0),At.length&&Pt.push(At)}if(Pt.length){if(be.lineMetrics&&He==="LineString"){for(Bt=0;Bt<Pt.length;Bt++)ye.push(It(Ue.id,He,Pt[Bt],Ue.tags));continue}He!=="LineString"&&He!=="MultiLineString"||(Pt.length===1?(He="LineString",Pt=Pt[0]):He="MultiLineString"),He!=="Point"&&He!=="MultiPoint"||(He=Pt.length===3?"Point":"MultiPoint"),ye.push(It(Ue.id,He,Pt,Ue.tags))}}}return ye.length?ye:null}function Yt(he,G,Z,ie,de){for(var pe=0;pe<he.length;pe+=3){var Me=he[pe+de];Me>=Z&&Me<=ie&&(G.push(he[pe]),G.push(he[pe+1]),G.push(he[pe+2]))}}function kt(he,G,Z,ie,de,pe,Me){for(var be,ye,Ee=Ln(he),Ue=de===0?Qe:qe,Ge=he.start,He=0;He<he.length-3;He+=3){var Ot=he[He],Kt=he[He+1],Pt=he[He+2],Bt=he[He+3],At=he[He+4],dn=de===0?Ot:Kt,kn=de===0?Bt:At,gn=!1;Me&&(be=Math.sqrt(Math.pow(Ot-Bt,2)+Math.pow(Kt-At,2))),dn<Z?kn>Z&&(ye=Ue(Ee,Ot,Kt,Bt,At,Z),Me&&(Ee.start=Ge+be*ye)):dn>ie?kn<ie&&(ye=Ue(Ee,Ot,Kt,Bt,At,ie),Me&&(Ee.start=Ge+be*ye)):zn(Ee,Ot,Kt,Pt),kn<Z&&dn>=Z&&(ye=Ue(Ee,Ot,Kt,Bt,At,Z),gn=!0),kn>ie&&dn<=ie&&(ye=Ue(Ee,Ot,Kt,Bt,At,ie),gn=!0),!pe&&gn&&(Me&&(Ee.end=Ge+be*ye),G.push(Ee),Ee=Ln(he)),Me&&(Ge+=be)}var fn=he.length-3;Ot=he[fn],Kt=he[fn+1],Pt=he[fn+2],(dn=de===0?Ot:Kt)>=Z&&dn<=ie&&zn(Ee,Ot,Kt,Pt),fn=Ee.length-3,pe&&fn>=3&&(Ee[fn]!==Ee[0]||Ee[fn+1]!==Ee[1])&&zn(Ee,Ee[0],Ee[1],Ee[2]),Ee.length&&G.push(Ee)}function Ln(he){var G=[];return G.size=he.size,G.start=he.start,G.end=he.end,G}function Un(he,G,Z,ie,de,pe){for(var Me=0;Me<he.length;Me++)kt(he[Me],G,Z,ie,de,pe,!1)}function zn(he,G,Z,ie){he.push(G),he.push(Z),he.push(ie)}function Qe(he,G,Z,ie,de,pe){var Me=(pe-G)/(ie-G);return he.push(pe),he.push(Z+(de-Z)*Me),he.push(1),Me}function qe(he,G,Z,ie,de,pe){var Me=(pe-Z)/(de-Z);return he.push(G+(ie-G)*Me),he.push(pe),he.push(1),Me}function vt(he,G){for(var Z=[],ie=0;ie<he.length;ie++){var de,pe=he[ie],Me=pe.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")de=hn(pe.geometry,G);else if(Me==="MultiLineString"||Me==="Polygon"){de=[];for(var be=0;be<pe.geometry.length;be++)de.push(hn(pe.geometry[be],G))}else if(Me==="MultiPolygon")for(de=[],be=0;be<pe.geometry.length;be++){for(var ye=[],Ee=0;Ee<pe.geometry[be].length;Ee++)ye.push(hn(pe.geometry[be][Ee],G));de.push(ye)}Z.push(It(pe.id,Me,de,pe.tags))}return Z}function hn(he,G){var Z=[];Z.size=he.size,he.start!==void 0&&(Z.start=he.start,Z.end=he.end);for(var ie=0;ie<he.length;ie+=3)Z.push(he[ie]+G,he[ie+1],he[ie+2]);return Z}function $e(he,G){if(he.transformed)return he;var Z,ie,de,pe=1<<he.z,Me=he.x,be=he.y;for(Z=0;Z<he.features.length;Z++){var ye=he.features[Z],Ee=ye.geometry,Ue=ye.type;if(ye.geometry=[],Ue===1)for(ie=0;ie<Ee.length;ie+=2)ye.geometry.push(st(Ee[ie],Ee[ie+1],G,pe,Me,be));else for(ie=0;ie<Ee.length;ie++){var Ge=[];for(de=0;de<Ee[ie].length;de+=2)Ge.push(st(Ee[ie][de],Ee[ie][de+1],G,pe,Me,be));ye.geometry.push(Ge)}}return he.transformed=!0,he}function st(he,G,Z,ie,de,pe){return[Math.round(Z*(he*ie-de)),Math.round(Z*(G*ie-pe))]}function qt(he,G,Z,ie,de){for(var pe=G===de.maxZoom?0:de.tolerance/((1<<G)*de.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Z,y:ie,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},be=0;be<he.length;be++){Me.numFeatures++,wn(Me,he[be],pe,de);var ye=he[be].minX,Ee=he[be].minY,Ue=he[be].maxX,Ge=he[be].maxY;ye<Me.minX&&(Me.minX=ye),Ee<Me.minY&&(Me.minY=Ee),Ue>Me.maxX&&(Me.maxX=Ue),Ge>Me.maxY&&(Me.maxY=Ge)}return Me}function wn(he,G,Z,ie){var de=G.geometry,pe=G.type,Me=[];if(pe==="Point"||pe==="MultiPoint")for(var be=0;be<de.length;be+=3)Me.push(de[be]),Me.push(de[be+1]),he.numPoints++,he.numSimplified++;else if(pe==="LineString")pn(Me,de,he,Z,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(be=0;be<de.length;be++)pn(Me,de[be],he,Z,pe==="Polygon",be===0);else if(pe==="MultiPolygon")for(var ye=0;ye<de.length;ye++){var Ee=de[ye];for(be=0;be<Ee.length;be++)pn(Me,Ee[be],he,Z,!0,be===0)}if(Me.length){var Ue=G.tags||null;if(pe==="LineString"&&ie.lineMetrics){for(var Ge in Ue={},G.tags)Ue[Ge]=G.tags[Ge];Ue.mapbox_clip_start=de.start/de.size,Ue.mapbox_clip_end=de.end/de.size}var He={geometry:Me,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Ue};G.id!==null&&(He.id=G.id),he.features.push(He)}}function pn(he,G,Z,ie,de,pe){var Me=ie*ie;if(ie>0&&G.size<(de?Me:ie))Z.numPoints+=G.length/3;else{for(var be=[],ye=0;ye<G.length;ye+=3)(ie===0||G[ye+2]>Me)&&(Z.numSimplified++,be.push(G[ye]),be.push(G[ye+1])),Z.numPoints++;de&&function(Ee,Ue){for(var Ge=0,He=0,Ot=Ee.length,Kt=Ot-2;He<Ot;Kt=He,He+=2)Ge+=(Ee[He]-Ee[Kt])*(Ee[He+1]+Ee[Kt+1]);if(Ge>0===Ue)for(He=0,Ot=Ee.length;He<Ot/2;He+=2){var Pt=Ee[He],Bt=Ee[He+1];Ee[He]=Ee[Ot-2-He],Ee[He+1]=Ee[Ot-1-He],Ee[Ot-2-He]=Pt,Ee[Ot-1-He]=Bt}}(be,pe),he.push(be)}}function tt(he,G){var Z=(G=this.options=function(de,pe){for(var Me in pe)de[Me]=pe[Me];return de}(Object.create(this.options),G)).debug;if(Z&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");var ie=function(de,pe){var Me=[];if(de.type==="FeatureCollection")for(var be=0;be<de.features.length;be++)yn(Me,de.features[be],pe,be);else yn(Me,de.type==="Feature"?de:{geometry:de},pe);return Me}(he,G);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ie=function(de,pe){var Me=pe.buffer/pe.extent,be=de,ye=bn(de,1,-1-Me,Me,0,-1,2,pe),Ee=bn(de,1,1-Me,2+Me,0,-1,2,pe);return(ye||Ee)&&(be=bn(de,1,-Me,1+Me,0,-1,2,pe)||[],ye&&(be=vt(ye,1).concat(be)),Ee&&(be=be.concat(vt(Ee,-1)))),be}(ie,G),ie.length&&this.splitTile(ie,0,0,0),Z&&(ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tn(he,G,Z){return 32*((1<<he)*Z+G)+he}function on(he,G){return G?he.properties[G]:he.id}function Pr(he,G){if(he==null)return!0;if(he.type==="Feature")return on(he,G)!=null;if(he.type==="FeatureCollection"){const Z=new Set;for(const ie of he.features){const de=on(ie,G);if(de==null||Z.has(de))return!1;Z.add(de)}return!0}return!1}function ci(he,G){const Z=new Map;if(he!=null)if(he.type==="Feature")Z.set(on(he,G),he);else for(const ie of he.features)Z.set(on(ie,G),ie);return Z}tt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tt.prototype.splitTile=function(he,G,Z,ie,de,pe,Me){for(var be=[he,G,Z,ie],ye=this.options,Ee=ye.debug;be.length;){ie=be.pop(),Z=be.pop(),G=be.pop(),he=be.pop();var Ue=1<<G,Ge=tn(G,Z,ie),He=this.tiles[Ge];if(!He&&(Ee>1&&console.time("creation"),He=this.tiles[Ge]=qt(he,G,Z,ie,ye),this.tileCoords.push({z:G,x:Z,y:ie}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,Z,ie,He.numFeatures,He.numPoints,He.numSimplified),console.timeEnd("creation"));var Ot="z"+G;this.stats[Ot]=(this.stats[Ot]||0)+1,this.total++}if(He.source=he,de){if(G===ye.maxZoom||G===de)continue;var Kt=1<<de-G;if(Z!==Math.floor(pe/Kt)||ie!==Math.floor(Me/Kt))continue}else if(G===ye.indexMaxZoom||He.numPoints<=ye.indexMaxPoints)continue;if(He.source=null,he.length!==0){Ee>1&&console.time("clipping");var Pt,Bt,At,dn,kn,gn,fn=.5*ye.buffer/ye.extent,nn=.5-fn,_n=.5+fn,pr=1+fn;Pt=Bt=At=dn=null,kn=bn(he,Ue,Z-fn,Z+_n,0,He.minX,He.maxX,ye),gn=bn(he,Ue,Z+nn,Z+pr,0,He.minX,He.maxX,ye),he=null,kn&&(Pt=bn(kn,Ue,ie-fn,ie+_n,1,He.minY,He.maxY,ye),Bt=bn(kn,Ue,ie+nn,ie+pr,1,He.minY,He.maxY,ye),kn=null),gn&&(At=bn(gn,Ue,ie-fn,ie+_n,1,He.minY,He.maxY,ye),dn=bn(gn,Ue,ie+nn,ie+pr,1,He.minY,He.maxY,ye),gn=null),Ee>1&&console.timeEnd("clipping"),be.push(Pt||[],G+1,2*Z,2*ie),be.push(Bt||[],G+1,2*Z,2*ie+1),be.push(At||[],G+1,2*Z+1,2*ie),be.push(dn||[],G+1,2*Z+1,2*ie+1)}}},tt.prototype.getTile=function(he,G,Z){var ie=this.options,de=ie.extent,pe=ie.debug;if(he<0||he>24)return null;var Me=1<<he,be=tn(he,G=(G%Me+Me)%Me,Z);if(this.tiles[be])return $e(this.tiles[be],de);pe>1&&console.log("drilling down to z%d-%d-%d",he,G,Z);for(var ye,Ee=he,Ue=G,Ge=Z;!ye&&Ee>0;)Ee--,Ue=Math.floor(Ue/2),Ge=Math.floor(Ge/2),ye=this.tiles[tn(Ee,Ue,Ge)];return ye&&ye.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Ee,Ue,Ge),pe>1&&console.time("drilling down"),this.splitTile(ye.source,Ee,Ue,Ge,he,G,Z),pe>1&&console.timeEnd("drilling down"),this.tiles[be]?$e(this.tiles[be],de):null):null};class an extends L{constructor(G,Z,ie,de){super(G,Z,ie),this._dataUpdateable=new Map,this.loadGeoJSON=(pe,Me)=>{const{promoteId:be}=pe;if(pe.request)return l.f(pe.request,(ye,Ee,Ue,Ge)=>{this._dataUpdateable=Pr(Ee,be)?ci(Ee,be):void 0,Me(ye,Ee,Ue,Ge)});if(typeof pe.data=="string")try{const ye=JSON.parse(pe.data);this._dataUpdateable=Pr(ye,be)?ci(ye,be):void 0,Me(null,ye)}catch{Me(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}else pe.dataDiff?this._dataUpdateable?(function(ye,Ee,Ue){var Ge,He,Ot,Kt;if(Ee.removeAll&&ye.clear(),Ee.remove)for(const Pt of Ee.remove)ye.delete(Pt);if(Ee.add)for(const Pt of Ee.add){const Bt=on(Pt,Ue);Bt!=null&&ye.set(Bt,Pt)}if(Ee.update)for(const Pt of Ee.update){let Bt=ye.get(Pt.id);if(Bt==null)continue;const At=!Pt.removeAllProperties&&(((Ge=Pt.removeProperties)===null||Ge===void 0?void 0:Ge.length)>0||((He=Pt.addOrUpdateProperties)===null||He===void 0?void 0:He.length)>0);if((Pt.newGeometry||Pt.removeAllProperties||At)&&(Bt=Object.assign({},Bt),ye.set(Pt.id,Bt),At&&(Bt.properties=Object.assign({},Bt.properties))),Pt.newGeometry&&(Bt.geometry=Pt.newGeometry),Pt.removeAllProperties)Bt.properties={};else if(((Ot=Pt.removeProperties)===null||Ot===void 0?void 0:Ot.length)>0)for(const dn of Pt.removeProperties)Object.prototype.hasOwnProperty.call(Bt.properties,dn)&&delete Bt.properties[dn];if(((Kt=Pt.addOrUpdateProperties)===null||Kt===void 0?void 0:Kt.length)>0)for(const{key:dn,value:kn}of Pt.addOrUpdateProperties)Bt.properties[dn]=kn}}(this._dataUpdateable,pe.dataDiff,be),Me(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Me(new Error(`Cannot update existing geojson data in ${pe.source}`)):Me(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,de&&(this.loadGeoJSON=de)}loadGeoJSONTile(G,Z){const ie=G.tileID.canonical;if(!this._geoJSONIndex)return Z(null,null);const de=this._geoJSONIndex.getTile(ie.z,ie.x,ie.y);if(!de)return Z(null,null);const pe=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.N,this.length=be.length,this._features=be}feature(be){return new class{constructor(ye){this._feature=ye,this.extent=l.N,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Ee of this._feature.geometry)ye.push([new l.P(Ee[0],Ee[1])]);return ye}{const ye=[];for(const Ee of this._feature.geometry){const Ue=[];for(const Ge of Ee)Ue.push(new l.P(Ge[0],Ge[1]));ye.push(Ue)}return ye}}toGeoJSON(ye,Ee,Ue){return N.call(this,ye,Ee,Ue)}}(this._features[be])}}(de.features);let Me=Xe(pe);Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),Z(null,{vectorTile:pe,rawData:Me.buffer})}loadData(G,Z){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const de=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.bu(G.request);this._pendingCallback=Z,this._pendingRequest=this.loadGeoJSON(G,(pe,Me)=>{if(delete this._pendingCallback,delete this._pendingRequest,pe||!Me)return Z(pe);if(typeof Me!="object")return Z(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{z(Me,!0);try{if(G.filter){const ye=l.bC(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Ue=>`${Ue.key}: ${Ue.message}`).join(", "));Me={type:"FeatureCollection",features:Me.features.filter(Ue=>ye.value.evaluate({zoom:0},Ue))}}this._geoJSONIndex=G.cluster?new bt(function({superclusterOptions:ye,clusterProperties:Ee}){if(!Ee||!ye)return ye;const Ue={},Ge={},He={accumulated:null,zoom:0},Ot={properties:null},Kt=Object.keys(Ee);for(const Pt of Kt){const[Bt,At]=Ee[Pt],dn=l.bC(At),kn=l.bC(typeof Bt=="string"?[Bt,["accumulated"],["get",Pt]]:Bt);Ue[Pt]=dn.value,Ge[Pt]=kn.value}return ye.map=Pt=>{Ot.properties=Pt;const Bt={};for(const At of Kt)Bt[At]=Ue[At].evaluate(He,Ot);return Bt},ye.reduce=(Pt,Bt)=>{Ot.properties=Bt;for(const At of Kt)He.accumulated=Pt[At],Pt[At]=Ge[At].evaluate(He,Ot)},ye}(G)).load(Me.features):function(ye,Ee){return new tt(ye,Ee)}(Me,G.geojsonVtOptions)}catch(ye){return Z(ye)}this.loaded={};const be={};if(de){const ye=de.finish();ye&&(be.resourceTiming={},be.resourceTiming[G.source]=JSON.parse(JSON.stringify(ye)))}Z(null,be)}})}reloadTile(G,Z){const ie=this.loaded;return ie&&ie[G.uid]?super.reloadTile(G,Z):this.loadTile(G,Z)}removeSource(G,Z){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Z()}getClusterExpansionZoom(G,Z){try{Z(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(ie){Z(ie)}}getClusterChildren(G,Z){try{Z(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(ie){Z(ie)}}getClusterLeaves(G,Z){try{Z(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(ie){Z(ie)}}}class Vr{constructor(G){this.self=G,this.actor=new l.C(G,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:L,geojson:an},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Z,ie)=>{if(this.workerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.workerSourceTypes[Z]=ie},this.self.registerRTLTextPlugin=Z=>{if(l.bD.isParsed())throw new Error("RTL text plugin already registered.");l.bD.applyArabicShaping=Z.applyArabicShaping,l.bD.processBidirectionalText=Z.processBidirectionalText,l.bD.processStyledBidirectionalText=Z.processStyledBidirectionalText}}setReferrer(G,Z){this.referrer=Z}setImages(G,Z,ie){this.availableImages[G]=Z;for(const de in this.workerSources[G]){const pe=this.workerSources[G][de];for(const Me in pe)pe[Me].availableImages=Z}ie()}setLayers(G,Z,ie){this.getLayerIndex(G).replace(Z),ie()}updateLayers(G,Z,ie){this.getLayerIndex(G).update(Z.layers,Z.removedIds),ie()}loadTile(G,Z,ie){this.getWorkerSource(G,Z.type,Z.source).loadTile(Z,ie)}loadDEMTile(G,Z,ie){this.getDEMWorkerSource(G,Z.source).loadTile(Z,ie)}reloadTile(G,Z,ie){this.getWorkerSource(G,Z.type,Z.source).reloadTile(Z,ie)}abortTile(G,Z,ie){this.getWorkerSource(G,Z.type,Z.source).abortTile(Z,ie)}removeTile(G,Z,ie){this.getWorkerSource(G,Z.type,Z.source).removeTile(Z,ie)}removeDEMTile(G,Z){this.getDEMWorkerSource(G,Z.source).removeTile(Z)}removeSource(G,Z,ie){if(!this.workerSources[G]||!this.workerSources[G][Z.type]||!this.workerSources[G][Z.type][Z.source])return;const de=this.workerSources[G][Z.type][Z.source];delete this.workerSources[G][Z.type][Z.source],de.removeSource!==void 0?de.removeSource(Z,ie):ie()}loadWorkerSource(G,Z,ie){try{this.self.importScripts(Z.url),ie()}catch(de){ie(de.toString())}}syncRTLPluginState(G,Z,ie){try{l.bD.setState(Z);const de=l.bD.getPluginURL();if(l.bD.isLoaded()&&!l.bD.isParsed()&&de!=null){this.self.importScripts(de);const pe=l.bD.isParsed();ie(pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${de}`),pe)}}catch(de){ie(de.toString())}}getAvailableImages(G){let Z=this.availableImages[G];return Z||(Z=[]),Z}getLayerIndex(G){let Z=this.layerIndexes[G];return Z||(Z=this.layerIndexes[G]=new m),Z}getWorkerSource(G,Z,ie){return this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][Z]||(this.workerSources[G][Z]={}),this.workerSources[G][Z][ie]||(this.workerSources[G][Z][ie]=new this.workerSourceTypes[Z]({send:(de,pe,Me)=>{this.actor.send(de,pe,Me,G)}},this.getLayerIndex(G),this.getAvailableImages(G))),this.workerSources[G][Z][ie]}getDEMWorkerSource(G,Z){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][Z]||(this.demWorkerSources[G][Z]=new R),this.demWorkerSources[G][Z]}}return l.i()&&(self.worker=new Vr(self)),Vr}),a(["./shared"],function(l){var m="3.6.2";class _{static testProp(o){if(!_.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in _.docStyle)return o[d];return o[0]}static create(o,d,p){const y=window.document.createElement(o);return d!==void 0&&(y.className=d),p&&p.appendChild(y),y}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){_.docStyle&&_.selectProp&&(_.userSelect=_.docStyle[_.selectProp],_.docStyle[_.selectProp]="none")}static enableDrag(){_.docStyle&&_.selectProp&&(_.docStyle[_.selectProp]=_.userSelect)}static setTransform(o,d){o.style[_.transformProp]=d}static addEventListener(o,d,p,y={}){o.addEventListener(d,p,"passive"in y?y:y.capture)}static removeEventListener(o,d,p,y={}){o.removeEventListener(d,p,"passive"in y?y:y.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",_.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_.suppressClickInternal,!0)},0)}static mousePos(o,d){const p=o.getBoundingClientRect();return new l.P(d.clientX-p.left-o.clientLeft,d.clientY-p.top-o.clientTop)}static touchPos(o,d){const p=o.getBoundingClientRect(),y=[];for(let b=0;b<d.length;b++)y.push(new l.P(d[b].clientX-p.left-o.clientLeft,d[b].clientY-p.top-o.clientTop));return y}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}_.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_.selectProp=_.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_.transformProp=_.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(v){!L&&C&&(R?D(v):P=v)}};let P,C,L=!1,R=!1;function D(v){const o=v.createTexture();v.bindTexture(v.TEXTURE_2D,o);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,C),v.isContextLost())return;S.supported=!0}catch{}v.deleteTexture(o),L=!0}var W,z;typeof document<"u"&&(C=document.createElement("img"),C.onload=function(){P&&D(P),P=null,R=!0},C.onerror=function(){L=!0,P=null},C.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let o,d,p,y;v.resetRequestQueue=()=>{o=[],d=0,p=0,y={}},v.addThrottleControl=O=>{const j=p++;return y[j]=O,j},v.removeThrottleControl=O=>{delete y[O],A()},v.getImage=(O,j,V=!0)=>{S.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*");const X={requestParameters:O,supportImageRefresh:V,callback:j,cancelled:!1,completed:!1,cancel:()=>{X.completed||X.cancelled||(X.cancelled=!0,X.innerRequest&&(X.innerRequest.cancel(),d--),A())}};return o.push(X),A(),X};const b=O=>{const{requestParameters:j,supportImageRefresh:V,callback:X}=O;return l.e(j,{type:"image"}),(V!==!1||l.i()||l.g(j.url)||j.headers&&!Object.keys(j.headers).reduce((ue,ce)=>ue&&ce==="accept",!0)?l.m:k)(j,(ue,ce,fe,ae)=>{E(O,X,ue,ce,fe,ae)})},E=(O,j,V,X,ue,ce)=>{V?j(V):X instanceof HTMLImageElement||l.a(X)?j(null,X):X&&((fe,ae)=>{typeof createImageBitmap=="function"?l.b(fe,ae):l.d(fe,ae)})(X,(fe,ae)=>{fe!=null?j(fe):ae!=null&&j(null,ae,{cacheControl:ue,expires:ce})}),O.cancelled||(O.completed=!0,d--,A())},A=()=>{const O=(()=>{const j=Object.keys(y);let V=!1;if(j.length>0){for(const X of j)if(V=y[X](),V)break}return V})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=d;j<O&&o.length>0;j++){const V=o.shift();if(V.cancelled){j--;continue}const X=b(V);d++,V.innerRequest=X}},k=(O,j)=>{const V=new Image,X=O.url;let ue=!1;const ce=O.credentials;return ce&&ce==="include"?V.crossOrigin="use-credentials":(ce&&ce==="same-origin"||!l.s(X))&&(V.crossOrigin="anonymous"),V.fetchPriority="high",V.onload=()=>{j(null,V),V.onerror=V.onload=null},V.onerror=()=>{ue||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),V.onerror=V.onload=null},V.src=X,{cancel:()=>{ue=!0,V.src=""}}}}(W||(W={})),W.resetRequestQueue(),function(v){v.Glyphs="Glyphs",v.Image="Image",v.Source="Source",v.SpriteImage="SpriteImage",v.SpriteJSON="SpriteJSON",v.Style="Style",v.Tile="Tile",v.Unknown="Unknown"}(z||(z={}));class N{constructor(o){this._transformRequestFn=o}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeSpriteURL(o,d,p){const y=function(b){const E=b.match(F);if(!E)throw new Error(`Unable to parse URL "${b}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(o);return y.path+=`${d}${p}`,function(b){const E=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${E}`}(y)}setTransformRequest(o){this._transformRequestFn=o}}const F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $(v){var o=new l.A(3);return o[0]=v[0],o[1]=v[1],o[2]=v[2],o}var K,ne=function(v,o,d){return v[0]=o[0]-d[0],v[1]=o[1]-d[1],v[2]=o[2]-d[2],v};K=new l.A(3),l.A!=Float32Array&&(K[0]=0,K[1]=0,K[2]=0);var se=function(v){var o=v[0],d=v[1];return o*o+d*d};function xe(v){const o=[];if(typeof v=="string")o.push({id:"default",url:v});else if(v&&v.length>0){const d=[];for(const{id:p,url:y}of v){const b=`${p}${y}`;d.indexOf(b)===-1&&(d.push(b),o.push({id:p,url:y}))}}return o}function Se(v,o,d,p,y){if(p)return void v(p);if(y!==Object.values(o).length||y!==Object.values(d).length)return;const b={};for(const E in o){b[E]={};const A=l.h.getImageCanvasContext(d[E]),k=o[E];for(const O in k){const{width:j,height:V,x:X,y:ue,sdf:ce,pixelRatio:fe,stretchX:ae,stretchY:Pe,content:Oe}=k[O];b[E][O]={data:null,pixelRatio:fe,sdf:ce,stretchX:ae,stretchY:Pe,content:Oe,spriteData:{width:j,height:V,x:X,y:ue,context:A}}}}v(null,b)}(function(){var v=new l.A(2);l.A!=Float32Array&&(v[0]=0,v[1]=0)})();class _e{constructor(o,d,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(d,y)}update(o,d,p){const{width:y,height:b}=o,E=!(this.size&&this.size[0]===y&&this.size[1]===b||p),{context:A}=this,{gl:k}=A;if(this.useMipmap=!!(d&&d.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!d||d.premultiply!==!1)),E)this.size=[y,b],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.a(o)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,o):k.texImage2D(k.TEXTURE_2D,0,this.format,y,b,0,this.format,k.UNSIGNED_BYTE,o.data);else{const{x:O,y:j}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.a(o)?k.texSubImage2D(k.TEXTURE_2D,0,O,j,k.RGBA,k.UNSIGNED_BYTE,o):k.texSubImage2D(k.TEXTURE_2D,0,O,j,y,b,k.RGBA,k.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(o,d,p){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),o!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||o),this.filter=o),d!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Re(v){const{userImage:o}=v;return!!(o&&o.render&&o.render())&&(v.data.replace(new Uint8Array(o.data.buffer)),!0)}class De extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:p}of this.requestors)this._notify(d,p);this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new l.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let p=!0;const y=d.data||d.spriteData;return this._validateStretch(d.stretchX,y&&y.width)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,y&&y.height)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,d){if(!o)return!0;let p=0;for(const y of o){if(y[0]<p||y[1]<y[0]||d<y[1])return!1;p=y[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const p=d.spriteData,y=p&&p.width||d.data.width,b=p&&p.height||d.data.height;return!(o[0]<0||y<o[0]||o[1]<0||b<o[1]||o[2]<0||y<o[2]||o[3]<0||b<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,p=!0){const y=this.getImage(o);if(p&&(y.data.width!==d.data.width||y.data.height!==d.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=y.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let p=!0;if(!this.isLoaded())for(const y of o)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const p={};for(const y of o){let b=this.getImage(y);b||(this.fire(new l.k("styleimagemissing",{id:y})),b=this.getImage(y)),b?p[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:l.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,p)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],p=this.getImage(o);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new l.I(y,p);this.patterns[o]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _e(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const b in this.patterns)o.push(this.patterns[b].bin);const{w:d,h:p}=l.p(o),y=this.atlasImage;y.resize({width:d||1,height:p||1});for(const b in this.patterns){const{bin:E}=this.patterns[b],A=E.x+1,k=E.y+1,O=this.getImage(b).data,j=O.width,V=O.height;l.R.copy(O,y,{x:0,y:0},{x:A,y:k},{width:j,height:V}),l.R.copy(O,y,{x:0,y:V-1},{x:A,y:k-1},{width:j,height:1}),l.R.copy(O,y,{x:0,y:0},{x:A,y:k+V},{width:j,height:1}),l.R.copy(O,y,{x:j-1,y:0},{x:A-1,y:k},{width:1,height:V}),l.R.copy(O,y,{x:0,y:0},{x:A+j,y:k},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||l.w(`Image with ID: "${d}" was not found`),Re(p)&&this.updateImage(d,p)}}}const Ve=1e20;function je(v,o,d,p,y,b,E,A,k){for(let O=o;O<o+p;O++)We(v,d*b+O,b,y,E,A,k);for(let O=d;O<d+y;O++)We(v,O*b+o,1,p,E,A,k)}function We(v,o,d,p,y,b,E){b[0]=0,E[0]=-Ve,E[1]=Ve,y[0]=v[o];for(let A=1,k=0,O=0;A<p;A++){y[A]=v[o+A*d];const j=A*A;do{const V=b[k];O=(y[A]-y[V]+j-V*V)/(A-V)/2}while(O<=E[k]&&--k>-1);k++,b[k]=A,E[k]=O,E[k+1]=Ve}for(let A=0,k=0;A<p;A++){for(;E[k+1]<A;)k++;const O=b[k],j=A-O;v[o+A*d]=y[O]+j*j}}class Ze{constructor(o,d){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={}}setURL(o){this.url=o}getGlyphs(o,d){const p=[];for(const y in o)for(const b of o[y])p.push({stack:y,id:b});l.o(p,({stack:y,id:b},E)=>{let A=this.entries[y];A||(A=this.entries[y]={glyphs:{},requests:{},ranges:{}});let k=A.glyphs[b];if(k!==void 0)return void E(null,{stack:y,id:b,glyph:k});if(k=this._tinySDF(A,y,b),k)return A.glyphs[b]=k,void E(null,{stack:y,id:b,glyph:k});const O=Math.floor(b/256);if(256*O>65535)return void E(new Error("glyphs > 65535 not supported"));if(A.ranges[O])return void E(null,{stack:y,id:b,glyph:k});if(!this.url)return void E(new Error("glyphsUrl is not set"));let j=A.requests[O];j||(j=A.requests[O]=[],Ze.loadGlyphRange(y,O,this.url,this.requestManager,(V,X)=>{if(X){for(const ue in X)this._doesCharSupportLocalGlyph(+ue)||(A.glyphs[+ue]=X[+ue]);A.ranges[O]=!0}for(const ue of j)ue(V,X);delete A.requests[O]})),j.push((V,X)=>{V?E(V):X&&E(null,{stack:y,id:b,glyph:X[b]||null})})},(y,b)=>{if(y)d(y);else if(b){const E={};for(const{stack:A,id:k,glyph:O}of b)(E[A]||(E[A]={}))[k]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};d(null,E)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(l.u["CJK Unified Ideographs"](o)||l.u["Hangul Syllables"](o)||l.u.Hiragana(o)||l.u.Katakana(o))}_tinySDF(o,d,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let b=o.tinySDF;if(!b){let A="400";/bold/i.test(d)?A="900":/medium/i.test(d)?A="500":/light/i.test(d)&&(A="200"),b=o.tinySDF=new Ze.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:A})}const E=b.draw(String.fromCharCode(p));return{id:p,bitmap:new l.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ze.loadGlyphRange=function(v,o,d,p,y){const b=256*o,E=b+255,A=p.transformRequest(d.replace("{fontstack}",v).replace("{range}",`${b}-${E}`),z.Glyphs);l.l(A,(k,O)=>{if(k)y(k);else if(O){const j={};for(const V of l.n(O))j[V.id]=V;y(null,j)}})},Ze.TinySDF=class{constructor({fontSize:v=24,buffer:o=3,radius:d=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=d;const A=this.size=v+4*o,k=this._createCanvas(A),O=this.ctx=k.getContext("2d",{willReadFrequently:!0});O.font=`${E} ${b} ${v}px ${y}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(v){const o=document.createElement("canvas");return o.width=o.height=v,o}draw(v){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(v),E=Math.ceil(d),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-y))),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),O=A+2*this.buffer,j=k+2*this.buffer,V=Math.max(O*j,0),X=new Uint8ClampedArray(V),ue={data:X,width:O,height:j,glyphWidth:A,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(A===0||k===0)return ue;const{ctx:ce,buffer:fe,gridInner:ae,gridOuter:Pe}=this;ce.clearRect(fe,fe,A,k),ce.fillText(v,fe,fe+E);const Oe=ce.getImageData(fe,fe,A,k);Pe.fill(Ve,0,V),ae.fill(0,0,V);for(let ge=0;ge<k;ge++)for(let Ie=0;Ie<A;Ie++){const Fe=Oe.data[4*(ge*A+Ie)+3]/255;if(Fe===0)continue;const Be=(ge+fe)*O+Ie+fe;if(Fe===1)Pe[Be]=0,ae[Be]=Ve;else{const Ke=.5-Fe;Pe[Be]=Ke>0?Ke*Ke:0,ae[Be]=Ke<0?Ke*Ke:0}}je(Pe,0,0,O,j,O,this.f,this.v,this.z),je(ae,fe,fe,A,k,O,this.f,this.v,this.z);for(let ge=0;ge<V;ge++){const Ie=Math.sqrt(Pe[ge])-Math.sqrt(ae[ge]);X[ge]=Math.round(255-255*(Ie/this.radius+this.cutoff))}return ue}};class Ye{constructor(){this.specification=l.v.light.position}possiblyEvaluate(o,d){return l.z(o.expression.evaluate(d))}interpolate(o,d,p){return{x:l.B.number(o.x,d.x,p),y:l.B.number(o.y,d.y,p),z:l.B.number(o.z,d.z,p)}}}let Ce;class Xe extends l.E{constructor(o){super(),Ce=Ce||new l.r({anchor:new l.D(l.v.light.anchor),position:new Ye,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(Ce),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(l.t,o,d))for(const p in o){const y=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,p){return(!p||p.validate!==!1)&&l.x(this,o.call(l.y,l.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}}class lt{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const p=o.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,d)),this.dashEntry[p]}getDashRanges(o,d,p){const y=[];let b=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,A=!0;y.push({left:b,right:E,isDash:A,zeroLength:o[0]===0});let k=o[0];for(let O=1;O<o.length;O++){A=!A;const j=o[O];b=k*p,k+=j,E=k*p,y.push({left:b,right:E,isDash:A,zeroLength:j===0})}return y}addRoundDash(o,d,p){const y=d/2;for(let b=-p;b<=p;b++){const E=this.width*(this.nextRow+p+b);let A=0,k=o[A];for(let O=0;O<this.width;O++){O/k.right>1&&(k=o[++A]);const j=Math.abs(O-k.left),V=Math.abs(O-k.right),X=Math.min(j,V);let ue;const ce=b/p*(y+1);if(k.isDash){const fe=y-Math.abs(ce);ue=Math.sqrt(X*X+fe*fe)}else ue=y-Math.sqrt(X*X+ce*ce);this.data[E+O]=Math.max(0,Math.min(255,ue+128))}}}addRegularDash(o){for(let A=o.length-1;A>=0;--A){const k=o[A],O=o[A+1];k.zeroLength?o.splice(A,1):O&&O.isDash===k.isDash&&(O.left=k.left,o.splice(A,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const y=this.width*this.nextRow;let b=0,E=o[b];for(let A=0;A<this.width;A++){A/E.right>1&&(E=o[++b]);const k=Math.abs(A-E.left),O=Math.abs(A-E.right),j=Math.min(k,O);this.data[y+A]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(o,d){const p=d?7:0,y=2*p+1;if(this.nextRow+y>this.height)return l.w("LineAtlas out of space"),null;let b=0;for(let A=0;A<o.length;A++)b+=o[A];if(b!==0){const A=this.width/b,k=this.getDashRanges(o,this.width,A);d?this.addRoundDash(k,A,p):this.addRegularDash(k)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=y,this.dirty=!0,E}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class Dt{constructor(o,d,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const y=this.workerPool.acquire(p);for(let b=0;b<y.length;b++){const E=new l.C(y[b],d,p);E.name=`Worker ${b}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d,p){l.o(this.actors,(y,b)=>{y.send(o,d,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function mt(v,o,d){const p=function(y,b){if(y)return d(y);if(b){const E=l.F(l.e(b,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(E.vectorLayers=b.vector_layers,E.vectorLayerIds=E.vectorLayers.map(A=>A.id)),d(null,E)}};return v.url?l.f(o.transformRequest(v.url,z.Source),p):l.h.frame(()=>p(null,v))}class ht{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof l.L?new l.L(o.lng,o.lat):l.L.convert(o),this}setSouthWest(o){return this._sw=o instanceof l.L?new l.L(o.lng,o.lat):l.L.convert(o),this}extend(o){const d=this._sw,p=this._ne;let y,b;if(o instanceof l.L)y=o,b=o;else{if(!(o instanceof ht))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(ht.convert(o)):this.extend(l.L.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(l.L.convert(o)):this;if(y=o._sw,b=o._ne,!y||!b)return this}return d||p?(d.lng=Math.min(y.lng,d.lng),d.lat=Math.min(y.lat,d.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new l.L(y.lng,y.lat),this._ne=new l.L(b.lng,b.lat)),this}getCenter(){return new l.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.L(this.getWest(),this.getNorth())}getSouthEast(){return new l.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:p}=l.L.convert(o);let y=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(o){return o instanceof ht?o:o&&new ht(o)}static fromLngLat(o,d=0){const p=360*d/40075017,y=p/Math.cos(Math.PI/180*o.lat);return new ht(new l.L(o.lng-y,o.lat-p),new l.L(o.lng+y,o.lat+p))}}class ot{constructor(o,d,p){this.bounds=ht.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),p=Math.floor(l.G(this.bounds.getWest())*d),y=Math.floor(l.H(this.bounds.getNorth())*d),b=Math.ceil(l.G(this.bounds.getEast())*d),E=Math.ceil(l.H(this.bounds.getSouth())*d);return o.x>=p&&o.x<b&&o.y>=y&&o.y<E}}class xt extends l.E{constructor(o,d,p,y){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=mt(this._options,this.map._requestManager,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b?this.fire(new l.j(b)):E&&(l.e(this,E),E.bounds&&(this.tileBounds=new ot(E.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.e({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.F(d,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(p,z.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(E,A){return delete o.request,o.aborted?d(null):E&&E.status!==404?d(E):(A&&A.resourceTiming&&(o.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&o.setExpiryData(A),o.loadVectorData(A,this.map.painter),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",y,b.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",y,b.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class bt extends l.E{constructor(o,d,p,y){super(),this.id=o,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},d),l.e(this,l.F(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=mt(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new l.j(o)):d&&(l.e(this,d),d.bounds&&(this.tileBounds=new ot(d.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return l.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=W.getImage(this.map._requestManager.transformRequest(p,z.Tile),(y,b,E)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(y)o.state="errored",d(y);else if(b){this.map._refreshExpiredTiles&&E&&o.setExpiryData(E);const A=this.map.painter.context,k=A.gl;o.texture=this.map.painter.getTileTexture(b.width),o.texture?o.texture.update(b,{useMipmap:!0}):(o.texture=new _e(A,b,k.RGBA,{useMipmap:!0}),o.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),A.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,A.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,A.extTextureFilterAnisotropicMax)),o.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}class Wt extends bt{constructor(o,d,p,y){super(o,d,p,y),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(p,z.Tile);function b(E,A){E&&(o.state="errored",d(E)),A&&(o.dem=A,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",d(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=W.getImage(y,(E,A,k)=>l._(this,void 0,void 0,function*(){if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(E)o.state="errored",d(E);else if(A){this.map._refreshExpiredTiles&&o.setExpiryData(k);const O=l.a(A)&&l.J()?A:yield function(V){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.K()){const X=V.width+2,ue=V.height+2;try{return new l.R({width:X,height:ue},yield l.M(V,-1,-1,X,ue))}catch{}}return l.h.getImageData(V,1)})}(A),j={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:O,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",j,b))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const d=o.canonical,p=Math.pow(2,d.z),y=(d.x-1+p)%p,b=d.x===0?o.wrap-1:o.wrap,E=(d.x+1+p)%p,A=d.x+1===p?o.wrap+1:o.wrap,k={};return k[new l.O(o.overscaledZ,b,d.z,y,d.y).key]={backfilled:!1},k[new l.O(o.overscaledZ,A,d.z,E,d.y).key]={backfilled:!1},d.y>0&&(k[new l.O(o.overscaledZ,b,d.z,y,d.y-1).key]={backfilled:!1},k[new l.O(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},k[new l.O(o.overscaledZ,A,d.z,E,d.y-1).key]={backfilled:!1}),d.y+1<p&&(k[new l.O(o.overscaledZ,b,d.z,y,d.y+1).key]={backfilled:!1},k[new l.O(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},k[new l.O(o.overscaledZ,A,d.z,E,d.y+1).key]={backfilled:!1}),k}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class nt extends l.E{constructor(o,d,p,y){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.e({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=d.data,this._options=l.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const b=l.N/this.tileSize;this.workerOptions=l.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*b,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*b,extent:l.N,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.N,radius:(d.clusterRadius||50)*b,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},d),this}getClusterChildren(o,d){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},d),this}getClusterLeaves(o,d,p,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:d,offset:p},y),this}_updateWorkerData(o){const d=l.e({},this.workerOptions);o?d.dataDiff=o:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(l.h.resolveURL(this._data),z.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(p,y)=>{if(this._pendingLoads--,this._removed||y&&y.abandoned)return void this.fire(new l.k("dataabort",{dataType:"source"}));let b=null;if(y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b=y.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.j(p));const E={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&l.e(E,{resourceTiming:b}),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(o,d){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const y={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,y,(b,E)=>(delete o.request,o.unloadVectorData(),o.aborted?d(null):b?d(b):(o.loadVectorData(E,this.map.painter,p==="reloadTile"),d(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Et=l.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class cn extends l.E{constructor(o,d,p,y){super(),this.load=(b,E)=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=W.getImage(this.map._requestManager.transformRequest(this.url,z.Image),(A,k)=>{this._request=null,this._loaded=!0,A?this.fire(new l.j(A)):k&&(this.image=k,b&&(this.coordinates=b),E&&E(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _e(b,this.image,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let A=!1;for(const k in this.tiles){const O=this.tiles[k];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,A=!0)}A&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=d}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(l.U.fromLngLat);this.tileID=function(y){let b=1/0,E=1/0,A=-1/0,k=-1/0;for(const X of y)b=Math.min(b,X.x),E=Math.min(E,X.y),A=Math.max(A,X.x),k=Math.max(k,X.y);const O=Math.max(A-b,k-E),j=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),V=Math.pow(2,j);return new l.W(j,Math.floor((b+A)/2*V),Math.floor((E+k)/2*V))}(d),this.minzoom=this.maxzoom=this.tileID.z;const p=d.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new l.V,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,l.N,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,l.N),this._boundsArray.emplaceBack(p[2].x,p[2].y,l.N,l.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}hasTransition(){return!1}}class en extends cn{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!1;const b=this.options;this.urls=[];for(const E of b.urls)this.urls.push(this.map._requestManager.transformRequest(E,z.Source).url);l.X(this.urls,(E,A)=>{this._loaded=!0,E?this.fire(new l.j(E)):A&&(this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.texSubImage2D(E.TEXTURE_2D,0,0,0,E.RGBA,E.UNSIGNED_BYTE,this.video)):(this.texture=new _e(b,this.video,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let A=!1;for(const k in this.tiles){const O=this.tiles[k];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,A=!0)}A&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new l.j(new l.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class mn extends cn{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const E=this.map.painter.context,A=E.gl;this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _e(E,this.canvas,A.RGBA,{premultiply:!0});let k=!1;for(const O in this.tiles){const j=this.tiles[O];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,k=!0)}k&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(E=>typeof E!="number"))||this.fire(new l.j(new l.Y(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.j(new l.Y(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.j(new l.Y(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new l.j(new l.Y(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.j(new l.Y(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ht={},It=v=>{switch(v){case"geojson":return nt;case"image":return cn;case"raster":return bt;case"raster-dem":return Wt;case"vector":return xt;case"video":return en;case"canvas":return mn}return Ht[v]};function Rt(v,o){const d=l.Z();return l.$(d,d,[1,1,0]),l.a0(d,d,[.5*v.width,.5*v.height,1]),l.a1(d,d,v.calculatePosMatrix(o.toUnwrapped()))}function yn(v,o,d,p,y,b){const E=function(V,X,ue){if(V)for(const ce of V){const fe=X[ce];if(fe&&fe.source===ue&&fe.type==="fill-extrusion")return!0}else for(const ce in X){const fe=X[ce];if(fe.source===ue&&fe.type==="fill-extrusion")return!0}return!1}(y&&y.layers,o,v.id),A=b.maxPitchScaleFactor(),k=v.tilesIn(p,A,E);k.sort(vn);const O=[];for(const V of k)O.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(o,d,v._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,y,b,A,Rt(v.transform,V.tileID))});const j=function(V){const X={},ue={};for(const ce of V){const fe=ce.queryResults,ae=ce.wrappedTileID,Pe=ue[ae]=ue[ae]||{};for(const Oe in fe){const ge=fe[Oe],Ie=Pe[Oe]=Pe[Oe]||{},Fe=X[Oe]=X[Oe]||[];for(const Be of ge)Ie[Be.featureIndex]||(Ie[Be.featureIndex]=!0,Fe.push(Be))}}return X}(O);for(const V in j)j[V].forEach(X=>{const ue=X.feature,ce=v.getFeatureState(ue.layer["source-layer"],ue.id);ue.source=ue.layer.source,ue.layer["source-layer"]&&(ue.sourceLayer=ue.layer["source-layer"]),ue.state=ce});return j}function vn(v,o){const d=v.tileID,p=o.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}class ut{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=l.a2(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const d=o+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,b){const E={};if(!b)return E;for(const A of y){const k=A.layerIds.map(O=>b.getLayer(O)).filter(Boolean);if(k.length!==0){A.layers=k,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(O=>k.filter(j=>j.id===O)[0]));for(const O of k)E[O.id]=A}}return E}(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.a4){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.a4&&b.hasRTLText){this.hasRTLText=!0,l.a5();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(y).queryRadius(b))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new l.a3}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _e(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _e(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,p,y,b,E,A,k,O,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:b,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:k,params:A,queryPadding:this.queryPadding*O},o,d,p):{}}querySourceFeatures(o,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),b=d&&d.sourceLayer?d.sourceLayer:"",E=y._geojsonTileLayer||y[b];if(!E)return;const A=l.a6(d&&d.filter),{z:k,x:O,y:j}=this.tileID.canonical,V={z:k,x:O,y:j};for(let X=0;X<E.length;X++){const ue=E.feature(X);if(A.needGeometry){const ae=l.a7(ue,!0);if(!A.filter(new l.a8(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!A.filter(new l.a8(this.tileID.overscaledZ),ue))continue;const ce=p.getId(ue,b),fe=new l.a9(ue,k,O,j,ce);fe.tile=V,o.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const p=l.aa(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(d)if(this.expirationTime<d)y=!0;else{const b=this.expirationTime-d;b?this.expirationTime=p+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!d.style.hasLayer(y))continue;const b=this.buckets[y],E=b.layers[0].sourceLayer||"_geojsonTileLayer",A=p[E],k=o[E];if(!A||!k||Object.keys(k).length===0)continue;b.update(k,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=d&&d.style&&d.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=l.h.now()+o}setDependencies(o,d){const p={};for(const y of d)p[y]=!0;this.dependencies[o]=p}hasDependency(o,d){for(const p of o){const y=this.dependencies[p];if(y){for(const b of d)if(y[b])return!0}}return!1}}class un{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,p){const y=o.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const b={value:d,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(o,b)},p)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const p=o.wrapped().key,y=d===void 0?0:this.data[p].indexOf(d),b=this.data[p][y];return this.data[p].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||d.push(y);for(const p of d)this.remove(p.value.tileID,p)}}class Ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,p){const y=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},l.e(this.stateChanges[o][y],p),this.deletedStates[o]===null){this.deletedStates[o]={};for(const b in this.state[o])b!==y&&(this.deletedStates[o][b]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][y]===null){this.deletedStates[o][y]={};for(const b in this.state[o][y])p[b]||(this.deletedStates[o][y][b]=null)}else for(const b in p)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][b]===null&&delete this.deletedStates[o][y][b]}removeFeatureState(o,d,p){if(this.deletedStates[o]===null)return;const y=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&d!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,d){const p=String(d),y=l.e({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const b=this.deletedStates[o][d];if(b===null)return{};for(const E in b)delete y[E]}return y}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),l.e(this.state[y][E],this.stateChanges[y][E]),b[E]=this.state[y][E];p[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(this.deletedStates[y]===null)for(const E in this.state[y])b[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const A of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][A];b[E]=this.state[y][E]}p[y]=p[y]||{},l.e(p[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in o)o[y].setFeatureState(p,d)}}class Ct extends l.E{constructor(o,d,p){super(),this.id=o,this.dispatcher=p,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,b,E,A)=>{const k=new(It(b.type))(y,b,E,A);if(k.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${k.id}`);return k})(o,d,p,this),this._tiles={},this._cache=new un(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ae,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d){return this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new l.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(bn).map(o=>o.key)}getRenderableIds(o){const d=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&d.push(this._tiles[p]);return o?d.sort((p,y)=>{const b=p.tileID,E=y.tileID,A=new l.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),k=new l.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||k.y-A.y||k.x-A.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(bn).map(p=>p.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,d){const p=this._tiles[o];p&&(p.state!=="loading"&&(p.state=d),this._loadTile(p,this._tileLoaded.bind(this,p,o,d)))}_tileLoaded(o,d,p,y){if(y)return o.state="errored",void(y.status!==404?this._source.fire(new l.j(y,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=l.h.now(),p==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new l.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const d=this.getRenderableIds();for(let y=0;y<d.length;y++){const b=d[y];if(o.neighboringTiles&&o.neighboringTiles[b]){const E=this.getTileByID(b);p(o,E),p(E,o)}}function p(y,b){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=b.tileID.canonical.x-y.tileID.canonical.x;const A=b.tileID.canonical.y-y.tileID.canonical.y,k=Math.pow(2,y.tileID.canonical.z),O=b.tileID.key;E===0&&A===0||Math.abs(A)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,E,A),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,p,y){for(const b in this._tiles){let E=this._tiles[b];if(y[b]||!E.hasData()||E.tileID.overscaledZ<=d||E.tileID.overscaledZ>p)continue;let A=E.tileID;for(;E&&E.tileID.overscaledZ>d+1;){const O=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[O.key],E&&E.hasData()&&(A=O)}let k=A;for(;k.overscaledZ>d;)if(k=k.scaledTo(k.overscaledZ-1),o[k.key]){y[A.key]=A;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=d?p:null}for(let p=o.overscaledZ-1;p>=d;p--){const y=o.scaledTo(p),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,y=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const p={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+d),p[b.tileID.key]=b}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(o,d){if(this.transform=o,this.terrain=d,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new l.O(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(p=p.filter(j=>this._source.hasTile(j)))):p=[];const y=o.coveringZoomLevel(this._source),b=Math.max(y-Ct.maxOverzooming,this._source.minzoom),E=Math.max(y+Ct.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const V of p)if(V.canonical.z>this._source.minzoom){const X=V.scaledTo(V.canonical.z-1);j[X.key]=X;const ue=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));j[ue.key]=ue}p=p.concat(Object.values(j))}const A=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new l.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(p,y);if(Yt(this._source.type)){const j={},V={},X=Object.keys(k),ue=l.h.now();for(const ce of X){const fe=k[ce],ae=this._tiles[ce];if(!ae||ae.fadeEndTime!==0&&ae.fadeEndTime<=ue)continue;const Pe=this.findLoadedParent(fe,b);Pe&&(this._addTile(Pe.tileID),j[Pe.tileID.key]=Pe.tileID),V[ce]=fe}this._retainLoadedChildren(V,y,E,k);for(const ce in j)k[ce]||(this._coveredTiles[ce]=!0,k[ce]=j[ce]);if(d){const ce={},fe={};for(const ae of p)this._tiles[ae.key].hasData()?ce[ae.key]=ae:fe[ae.key]=ae;for(const ae in fe){const Pe=fe[ae].children(this._source.maxzoom);this._tiles[Pe[0].key]&&this._tiles[Pe[1].key]&&this._tiles[Pe[2].key]&&this._tiles[Pe[3].key]&&(ce[Pe[0].key]=k[Pe[0].key]=Pe[0],ce[Pe[1].key]=k[Pe[1].key]=Pe[1],ce[Pe[2].key]=k[Pe[2].key]=Pe[2],ce[Pe[3].key]=k[Pe[3].key]=Pe[3],delete fe[ae])}for(const ae in fe){const Pe=this.findLoadedParent(fe[ae],this._source.minzoom);if(Pe){ce[Pe.tileID.key]=k[Pe.tileID.key]=Pe.tileID;for(const Oe in ce)ce[Oe].isChildOf(Pe.tileID)&&delete ce[Oe]}}for(const ae in this._tiles)ce[ae]||(this._coveredTiles[ae]=!0)}}for(const j in k)this._tiles[j].clearFadeHold();const O=l.ab(this._tiles,k);for(const j of O){const V=this._tiles[j];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){const p={},y={},b=Math.max(d-Ct.maxOverzooming,this._source.minzoom),E=Math.max(d+Ct.maxUnderzooming,this._source.minzoom),A={};for(const k of o){const O=this._addTile(k);p[k.key]=k,O.hasData()||d<this._source.maxzoom&&(A[k.key]=k)}this._retainLoadedChildren(A,d,E,p);for(const k of o){let O=this._tiles[k.key];if(O.hasData())continue;if(d+1>this._source.maxzoom){const V=k.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){p[V.key]=V;continue}}else{const V=k.children(this._source.maxzoom);if(p[V[0].key]&&p[V[1].key]&&p[V[2].key]&&p[V[3].key])continue}let j=O.wasRequested();for(let V=k.overscaledZ-1;V>=b;--V){const X=k.scaledTo(V);if(y[X.key])break;if(y[X.key]=!0,O=this.getTile(X),!O&&j&&(O=this._addTile(X)),O){const ue=O.hasData();if((j||ue)&&(p[X.key]=X),j=O.wasRequested(),ue)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}d.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;y=b}for(const b of d)this._loadedParentTiles[b]=p}}_addTile(o){let d=this._tiles[o.key];if(d)return d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const p=d;return d||(d=new ut(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))),d.uses++,this._tiles[o.key]=d,p||this._source.fire(new l.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=d.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,d,p){const y=[],b=this.transform;if(!b)return y;const E=p?b.getCameraQueryGeometry(o):o,A=o.map(ce=>b.pointCoordinate(ce,this.terrain)),k=E.map(ce=>b.pointCoordinate(ce,this.terrain)),O=this.getIds();let j=1/0,V=1/0,X=-1/0,ue=-1/0;for(const ce of k)j=Math.min(j,ce.x),V=Math.min(V,ce.y),X=Math.max(X,ce.x),ue=Math.max(ue,ce.y);for(let ce=0;ce<O.length;ce++){const fe=this._tiles[O[ce]];if(fe.holdingForFade())continue;const ae=fe.tileID,Pe=Math.pow(2,b.zoom-fe.tileID.overscaledZ),Oe=d*fe.queryPadding*l.N/fe.tileSize/Pe,ge=[ae.getTilePoint(new l.U(j,V)),ae.getTilePoint(new l.U(X,ue))];if(ge[0].x-Oe<l.N&&ge[0].y-Oe<l.N&&ge[1].x+Oe>=0&&ge[1].y+Oe>=0){const Ie=A.map(Be=>ae.getTilePoint(Be)),Fe=k.map(Be=>ae.getTilePoint(Be));y.push({tile:fe,tileID:ae,queryGeometry:Ie,cameraQueryGeometry:Fe,scale:Pe})}}return y}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of d)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Yt(this._source.type)){const o=l.h.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=o)return!0}return!1}setFeatureState(o,d,p){this._state.updateState(o=o||"_geojsonTileLayer",d,p)}removeFeatureState(o,d,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,p)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,p){const y=this._tiles[o];y&&y.setDependencies(d,p)}reloadTilesForDependencies(o,d){for(const p in this._tiles)this._tiles[p].hasDependency(o,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,d))}}function bn(v,o){const d=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return v.overscaledZ-o.overscaledZ||p-d||o.canonical.y-v.canonical.y||o.canonical.x-v.canonical.x}function Yt(v){return v==="raster"||v==="image"||v==="video"}Ct.maxOverzooming=10,Ct.maxUnderzooming=3;const kt="mapboxgl_preloaded_worker_pool";class Ln{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Ln.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[kt]}numActive(){return Object.keys(this.active).length}}const Un=Math.floor(l.h.hardwareConcurrency/2);let zn;function Qe(){return zn||(zn=new Ln),zn}Ln.workerCount=l.ac(globalThis)?Math.max(Math.min(Un,3),1):1;class qe{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=l.ad(o,0,1);let d=1,p=this._distances[d];const y=o*this.paddedLength+this.padding;for(;p<y&&d<this._distances.length;)p=this._distances[++d];const b=d-1,E=this._distances[b],A=p-E,k=A>0?(y-E)/A:0;return this.points[b].mult(1-k).add(this.points[d].mult(k))}}function vt(v,o){let d=!0;return v==="always"||v!=="never"&&o!=="never"||(d=!1),d}class hn{constructor(o,d,p){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(d/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,p,y,b){this._forEachCell(d,p,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(o,d,p,y){this._forEachCell(d-y,p-y,d+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(p),this.circles.push(y)}_insertBoxCell(o,d,p,y,b,E){this.boxCells[b].push(E)}_insertCircleCell(o,d,p,y,b,E){this.circleCells[b].push(E)}_query(o,d,p,y,b,E,A){if(p<0||o>this.width||y<0||d>this.height)return[];const k=[];if(o<=0&&d<=0&&this.width<=p&&this.height<=y){if(b)return[{key:null,x1:o,y1:d,x2:p,y2:y}];for(let O=0;O<this.boxKeys.length;O++)k.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const j=this.circles[3*O],V=this.circles[3*O+1],X=this.circles[3*O+2];k.push({key:this.circleKeys[O],x1:j-X,y1:V-X,x2:j+X,y2:V+X})}}else this._forEachCell(o,d,p,y,this._queryCell,k,{hitTest:b,overlapMode:E,seenUids:{box:{},circle:{}}},A);return k}query(o,d,p,y){return this._query(o,d,p,y,!1,null)}hitTest(o,d,p,y,b,E){return this._query(o,d,p,y,!0,b,E).length>0}hitTestCircle(o,d,p,y,b){const E=o-p,A=o+p,k=d-p,O=d+p;if(A<0||E>this.width||O<0||k>this.height)return!1;const j=[];return this._forEachCell(E,k,A,O,this._queryCellCircle,j,{hitTest:!0,overlapMode:y,circle:{x:o,y:d,radius:p},seenUids:{box:{},circle:{}}},b),j.length>0}_queryCell(o,d,p,y,b,E,A,k){const{seenUids:O,hitTest:j,overlapMode:V}=A,X=this.boxCells[b];if(X!==null){const ce=this.bboxes;for(const fe of X)if(!O.box[fe]){O.box[fe]=!0;const ae=4*fe,Pe=this.boxKeys[fe];if(o<=ce[ae+2]&&d<=ce[ae+3]&&p>=ce[ae+0]&&y>=ce[ae+1]&&(!k||k(Pe))&&(!j||!vt(V,Pe.overlapMode))&&(E.push({key:Pe,x1:ce[ae],y1:ce[ae+1],x2:ce[ae+2],y2:ce[ae+3]}),j))return!0}}const ue=this.circleCells[b];if(ue!==null){const ce=this.circles;for(const fe of ue)if(!O.circle[fe]){O.circle[fe]=!0;const ae=3*fe,Pe=this.circleKeys[fe];if(this._circleAndRectCollide(ce[ae],ce[ae+1],ce[ae+2],o,d,p,y)&&(!k||k(Pe))&&(!j||!vt(V,Pe.overlapMode))){const Oe=ce[ae],ge=ce[ae+1],Ie=ce[ae+2];if(E.push({key:Pe,x1:Oe-Ie,y1:ge-Ie,x2:Oe+Ie,y2:ge+Ie}),j)return!0}}}return!1}_queryCellCircle(o,d,p,y,b,E,A,k){const{circle:O,seenUids:j,overlapMode:V}=A,X=this.boxCells[b];if(X!==null){const ce=this.bboxes;for(const fe of X)if(!j.box[fe]){j.box[fe]=!0;const ae=4*fe,Pe=this.boxKeys[fe];if(this._circleAndRectCollide(O.x,O.y,O.radius,ce[ae+0],ce[ae+1],ce[ae+2],ce[ae+3])&&(!k||k(Pe))&&!vt(V,Pe.overlapMode))return E.push(!0),!0}}const ue=this.circleCells[b];if(ue!==null){const ce=this.circles;for(const fe of ue)if(!j.circle[fe]){j.circle[fe]=!0;const ae=3*fe,Pe=this.circleKeys[fe];if(this._circlesCollide(ce[ae],ce[ae+1],ce[ae+2],O.x,O.y,O.radius)&&(!k||k(Pe))&&!vt(V,Pe.overlapMode))return E.push(!0),!0}}}_forEachCell(o,d,p,y,b,E,A,k){const O=this._convertToXCellCoord(o),j=this._convertToYCellCoord(d),V=this._convertToXCellCoord(p),X=this._convertToYCellCoord(y);for(let ue=O;ue<=V;ue++)for(let ce=j;ce<=X;ce++)if(b.call(this,o,d,p,y,this.xCellCount*ce+ue,E,A,k))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,p,y,b,E){const A=y-o,k=b-d,O=p+E;return O*O>A*A+k*k}_circleAndRectCollide(o,d,p,y,b,E,A){const k=(E-y)/2,O=Math.abs(o-(y+k));if(O>k+p)return!1;const j=(A-b)/2,V=Math.abs(d-(b+j));if(V>j+p)return!1;if(O<=k||V<=j)return!0;const X=O-k,ue=V-j;return X*X+ue*ue<=p*p}}function $e(v,o,d,p,y){const b=l.Z();return o?(l.a0(b,b,[1/y,1/y,1]),d||l.ae(b,b,p.angle)):l.a1(b,p.labelPlaneMatrix,v),b}function st(v,o,d,p,y){if(o){const b=l.af(v);return l.a0(b,b,[y,y,1]),d||l.ae(b,b,-p.angle),b}return p.glCoordMatrix}function qt(v,o,d){let p;d?(p=[v.x,v.y,d(v.x,v.y),1],l.ag(p,p,o)):(p=[v.x,v.y,0,1],de(p,p,o));const y=p[3];return{point:new l.P(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function wn(v,o){return .5+v/o*.5}function pn(v,o){const d=v[0]/v[3],p=v[1]/v[3];return d>=-o[0]&&d<=o[0]&&p>=-o[1]&&p<=o[1]}function tt(v,o,d,p,y,b,E,A,k,O){const j=p?v.textSizeData:v.iconSizeData,V=l.ah(j,d.transform.zoom),X=[256/d.width*2+1,256/d.height*2+1],ue=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ue.clear();const ce=v.lineVertexArray,fe=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,ae=d.transform.width/d.transform.height;let Pe=!1;for(let Oe=0;Oe<fe.length;Oe++){const ge=fe.get(Oe);if(ge.hidden||ge.writingMode===l.ai.vertical&&!Pe){ie(ge.numGlyphs,ue);continue}let Ie;if(Pe=!1,O?(Ie=[ge.anchorX,ge.anchorY,O(ge.anchorX,ge.anchorY),1],l.ag(Ie,Ie,o)):(Ie=[ge.anchorX,ge.anchorY,0,1],de(Ie,Ie,o)),!pn(Ie,X)){ie(ge.numGlyphs,ue);continue}const Fe=wn(d.transform.cameraToCenterDistance,Ie[3]),Be=l.aj(j,V,ge),Ke=E?Be/Fe:Be*Fe,rt=new l.P(ge.anchorX,ge.anchorY),et=qt(rt,y,O).point,ct={projections:{},offsets:{}},Ft=Pr(ge,Ke,!1,A,o,y,b,v.glyphOffsetArray,ce,ue,et,rt,ct,ae,k,O);Pe=Ft.useVertical,(Ft.notEnoughRoom||Pe||Ft.needsFlipping&&Pr(ge,Ke,!0,A,o,y,b,v.glyphOffsetArray,ce,ue,et,rt,ct,ae,k,O).notEnoughRoom)&&ie(ge.numGlyphs,ue)}p?v.text.dynamicLayoutVertexBuffer.updateData(ue):v.icon.dynamicLayoutVertexBuffer.updateData(ue)}function tn(v,o,d,p,y,b,E,A,k,O,j,V,X){const ue=A.glyphStartIndex+A.numGlyphs,ce=A.lineStartIndex,fe=A.lineStartIndex+A.lineLength,ae=o.getoffsetX(A.glyphStartIndex),Pe=o.getoffsetX(ue-1),Oe=G(v*ae,d,p,y,b,E,A.segment,ce,fe,k,O,j,V,X);if(!Oe)return null;const ge=G(v*Pe,d,p,y,b,E,A.segment,ce,fe,k,O,j,V,X);return ge?{first:Oe,last:ge}:null}function on(v,o,d,p){return v===l.ai.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*p?{useVertical:!0}:(v===l.ai.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function Pr(v,o,d,p,y,b,E,A,k,O,j,V,X,ue,ce,fe){const ae=o/24,Pe=v.lineOffsetX*ae,Oe=v.lineOffsetY*ae;let ge;if(v.numGlyphs>1){const Ie=v.glyphStartIndex+v.numGlyphs,Fe=v.lineStartIndex,Be=v.lineStartIndex+v.lineLength,Ke=tn(ae,A,Pe,Oe,d,j,V,v,k,b,X,ce,fe);if(!Ke)return{notEnoughRoom:!0};const rt=qt(Ke.first.point,E,fe).point,et=qt(Ke.last.point,E,fe).point;if(p&&!d){const ct=on(v.writingMode,rt,et,ue);if(ct)return ct}ge=[Ke.first];for(let ct=v.glyphStartIndex+1;ct<Ie-1;ct++)ge.push(G(ae*A.getoffsetX(ct),Pe,Oe,d,j,V,v.segment,Fe,Be,k,b,X,ce,fe));ge.push(Ke.last)}else{if(p&&!d){const Fe=qt(V,y,fe).point,Be=v.lineStartIndex+v.segment+1,Ke=new l.P(k.getx(Be),k.gety(Be)),rt=qt(Ke,y,fe),et=rt.signedDistanceFromCamera>0?rt.point:ci(V,Ke,Fe,1,y,fe),ct=on(v.writingMode,Fe,et,ue);if(ct)return ct}const Ie=G(ae*A.getoffsetX(v.glyphStartIndex),Pe,Oe,d,j,V,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,k,b,X,ce,fe);if(!Ie)return{notEnoughRoom:!0};ge=[Ie]}for(const Ie of ge)l.ak(O,Ie.point,Ie.angle);return{}}function ci(v,o,d,p,y,b){const E=qt(v.add(v.sub(o)._unit()),y,b).point,A=d.sub(E);return d.add(A._mult(p/A.mag()))}function an(v,o){const{projectionCache:d,lineVertexArray:p,labelPlaneMatrix:y,tileAnchorPoint:b,distanceFromAnchor:E,getElevation:A,previousVertex:k,direction:O,absOffsetX:j}=o;if(d.projections[v])return d.projections[v];const V=new l.P(p.getx(v),p.gety(v)),X=qt(V,y,A);if(X.signedDistanceFromCamera>0)return d.projections[v]=X.point,X.point;const ue=v-O;return ci(E===0?b:new l.P(p.getx(ue),p.gety(ue)),V,k,j-E+1,y,A)}function Vr(v,o,d){return v._unit()._perp()._mult(o*d)}function he(v,o,d,p,y,b,E,A){const{projectionCache:k,direction:O}=A;if(k.offsets[v])return k.offsets[v];const j=d.add(o);if(v+O<p||v+O>=y)return k.offsets[v]=j,j;const V=an(v+O,A),X=Vr(V.sub(d),E,O),ue=d.add(X),ce=V.add(X);return k.offsets[v]=l.al(b,j,ue,ce)||j,k.offsets[v]}function G(v,o,d,p,y,b,E,A,k,O,j,V,X,ue){const ce=p?v-o:v+o;let fe=ce>0?1:-1,ae=0;p&&(fe*=-1,ae=Math.PI),fe<0&&(ae+=Math.PI);let Pe,Oe,ge=fe>0?A+E:A+E+1,Ie=y,Fe=y,Be=0,Ke=0;const rt=Math.abs(ce),et=[];let ct;for(;Be+Ke<=rt;){if(ge+=fe,ge<A||ge>=k)return null;Be+=Ke,Fe=Ie,Oe=Pe;const gt={projectionCache:V,lineVertexArray:O,labelPlaneMatrix:j,tileAnchorPoint:b,distanceFromAnchor:Be,getElevation:ue,previousVertex:Fe,direction:fe,absOffsetX:rt};if(Ie=an(ge,gt),d===0)et.push(Fe),ct=Ie.sub(Fe);else{let sn;const jt=Ie.sub(Fe);sn=jt.mag()===0?Vr(an(ge+fe,gt).sub(Ie),d,fe):Vr(jt,d,fe),Oe||(Oe=Fe.add(sn)),Pe=he(ge,sn,Ie,A,k,Oe,d,gt),et.push(Oe),ct=Pe.sub(Oe)}Ke=ct.mag()}const Ft=ct._mult((rt-Be)/Ke)._add(Oe||Fe),Cn=ae+Math.atan2(Ie.y-Fe.y,Ie.x-Fe.x);return et.push(Ft),{point:Ft,angle:X?Cn:0,path:et}}const Z=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ie(v,o){for(let d=0;d<v;d++){const p=o.length;o.resize(p+4),o.float32.set(Z,3*p)}}function de(v,o,d){const p=o[0],y=o[1];return v[0]=d[0]*p+d[4]*y+d[12],v[1]=d[1]*p+d[5]*y+d[13],v[3]=d[3]*p+d[7]*y+d[15],v}const pe=100;class Me{constructor(o,d=new hn(o.width+200,o.height+200,25),p=new hn(o.width+200,o.height+200,25)){this.transform=o,this.grid=d,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+pe,this.screenBottomBoundary=o.height+pe,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,p,y,b,E){const A=this.projectAndGetPerspectiveRatio(y,o.anchorPointX,o.anchorPointY,E),k=p*A.perspectiveRatio,O=o.x1*k+A.point.x,j=o.y1*k+A.point.y,V=o.x2*k+A.point.x,X=o.y2*k+A.point.y;return!this.isInsideGrid(O,j,V,X)||d!=="always"&&this.grid.hitTest(O,j,V,X,d,b)||A.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[O,j,V,X],offscreen:this.isOffscreen(O,j,V,X)}}placeCollisionCircles(o,d,p,y,b,E,A,k,O,j,V,X,ue,ce){const fe=[],ae=new l.P(d.anchorX,d.anchorY),Pe=qt(ae,E,ce),Oe=wn(this.transform.cameraToCenterDistance,Pe.signedDistanceFromCamera),ge=(j?b/Oe:b*Oe)/l.ap,Ie=qt(ae,A,ce).point,Fe=tn(ge,y,d.lineOffsetX*ge,d.lineOffsetY*ge,!1,Ie,ae,d,p,A,{projections:{},offsets:{}},!1,ce);let Be=!1,Ke=!1,rt=!0;if(Fe){const et=.5*X*Oe+ue,ct=new l.P(-100,-100),Ft=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Cn=new qe,gt=Fe.first,sn=Fe.last;let jt=[];for(let xn=gt.path.length-1;xn>=1;xn--)jt.push(gt.path[xn]);for(let xn=1;xn<sn.path.length;xn++)jt.push(sn.path[xn]);const Hn=2.5*et;if(k){const xn=jt.map(An=>qt(An,k,ce));jt=xn.some(An=>An.signedDistanceFromCamera<=0)?[]:xn.map(An=>An.point)}let En=[];if(jt.length>0){const xn=jt[0].clone(),An=jt[0].clone();for(let Ar=1;Ar<jt.length;Ar++)xn.x=Math.min(xn.x,jt[Ar].x),xn.y=Math.min(xn.y,jt[Ar].y),An.x=Math.max(An.x,jt[Ar].x),An.y=Math.max(An.y,jt[Ar].y);En=xn.x>=ct.x&&An.x<=Ft.x&&xn.y>=ct.y&&An.y<=Ft.y?[jt]:An.x<ct.x||xn.x>Ft.x||An.y<ct.y||xn.y>Ft.y?[]:l.am([jt],ct.x,ct.y,Ft.x,Ft.y)}for(const xn of En){Cn.reset(xn,.25*et);let An=0;An=Cn.length<=.5*et?1:Math.ceil(Cn.paddedLength/Hn)+1;for(let Ar=0;Ar<An;Ar++){const er=Ar/Math.max(An-1,1),pi=Cn.lerp(er),Jr=pi.x+pe,Or=pi.y+pe;fe.push(Jr,Or,et,0);const ms=Jr-et,or=Or-et,yo=Jr+et,_o=Or+et;if(rt=rt&&this.isOffscreen(ms,or,yo,_o),Ke=Ke||this.isInsideGrid(ms,or,yo,_o),o!=="always"&&this.grid.hitTestCircle(Jr,Or,et,o,V)&&(Be=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Be}}}}return{circles:!O&&Be||!Ke||Oe<this.perspectiveRatioCutoff?[]:fe,offscreen:rt,collisionDetected:Be}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let p=1/0,y=1/0,b=-1/0,E=-1/0;for(const j of o){const V=new l.P(j.x+pe,j.y+pe);p=Math.min(p,V.x),y=Math.min(y,V.y),b=Math.max(b,V.x),E=Math.max(E,V.y),d.push(V)}const A=this.grid.query(p,y,b,E).concat(this.ignoredGrid.query(p,y,b,E)),k={},O={};for(const j of A){const V=j.key;if(k[V.bucketInstanceId]===void 0&&(k[V.bucketInstanceId]={}),k[V.bucketInstanceId][V.featureIndex])continue;const X=[new l.P(j.x1,j.y1),new l.P(j.x2,j.y1),new l.P(j.x2,j.y2),new l.P(j.x1,j.y2)];l.an(d,X)&&(k[V.bucketInstanceId][V.featureIndex]=!0,O[V.bucketInstanceId]===void 0&&(O[V.bucketInstanceId]=[]),O[V.bucketInstanceId].push(V.featureIndex))}return O}insertCollisionBox(o,d,p,y,b,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:E,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,p,y,b,E){const A=p?this.ignoredGrid:this.grid,k={bucketInstanceId:y,featureIndex:b,collisionGroupID:E,overlapMode:d};for(let O=0;O<o.length;O+=4)A.insertCircle(k,o[O],o[O+1],o[O+2])}projectAndGetPerspectiveRatio(o,d,p,y){let b;return y?(b=[d,p,y(d,p),1],l.ag(b,b,o)):(b=[d,p,0,1],de(b,b,o)),{point:new l.P((b[0]/b[3]+1)/2*this.transform.width+pe,(-b[1]/b[3]+1)/2*this.transform.height+pe),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(o,d,p,y){return p<pe||o>=this.screenRightBoundary||y<pe||d>this.screenBottomBoundary}isInsideGrid(o,d,p,y){return p>=0&&o<this.gridRightBoundary&&y>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=l.ao([]);return l.$(o,o,[-100,-100,0]),o}}function be(v,o,d){return o*(l.N/(v.tileSize*Math.pow(2,d-v.tileID.overscaledZ)))}class ye{constructor(o,d,p,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Ee{constructor(o,d,p,y,b){this.text=new ye(o?o.text:null,d,p,b),this.icon=new ye(o?o.icon:null,d,y,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ue{constructor(o,d,p){this.text=o,this.icon=d,this.skipFade=p}}class Ge{constructor(){this.invProjMatrix=l.Z(),this.viewportMatrix=l.Z(),this.circles=[]}}class He{constructor(o,d,p,y,b){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=b}}class Ot{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[o]}}function Kt(v,o,d,p,y){const{horizontalAlign:b,verticalAlign:E}=l.au(v);return new l.P(-(b-.5)*o+p[0]*y,-(E-.5)*d+p[1]*y)}function Pt(v,o,d,p,y,b){const{x1:E,x2:A,y1:k,y2:O,anchorPointX:j,anchorPointY:V}=v,X=new l.P(o,d);return p&&X._rotate(y?b:-b),{x1:E+X.x,y1:k+X.y,x2:A+X.x,y2:O+X.y,anchorPointX:j,anchorPointY:V}}class Bt{constructor(o,d,p,y,b){this.transform=o.clone(),this.terrain=d,this.collisionIndex=new Me(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Ot(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,p,y){const b=p.getBucket(d),E=p.latestFeatureIndex;if(!b||!E||d.id!==b.layerIds[0])return;const A=p.collisionBoxArray,k=b.layers[0].layout,O=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),j=p.tileSize/l.N,V=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),X=k.get("text-pitch-alignment")==="map",ue=k.get("text-rotation-alignment")==="map",ce=be(p,1,this.transform.zoom),fe=$e(V,X,ue,this.transform,ce);let ae=null;if(X){const Oe=st(V,X,ue,this.transform,ce);ae=l.a1([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[b.bucketInstanceId]=new He(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,p.tileID);const Pe={bucket:b,layout:k,posMatrix:V,textLabelPlaneMatrix:fe,labelToScreenMatrix:ae,scale:O,textPixelRatio:j,holdingForFade:p.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:l.ah(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Oe of b.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:Fe}=Oe;o.push({sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:Fe,parameters:Pe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(o,d,p,y,b,E,A,k,O,j,V,X,ue,ce,fe,ae){const Pe=l.aq[o.textAnchor],Oe=[o.textOffset0,o.textOffset1],ge=Kt(Pe,p,y,Oe,b),Ie=this.collisionIndex.placeCollisionBox(Pt(d,ge.x,ge.y,E,A,this.transform.angle),V,k,O,j.predicate,ae);if((!fe||this.collisionIndex.placeCollisionBox(Pt(fe,ge.x,ge.y,E,A,this.transform.angle),V,k,O,j.predicate,ae).box.length!==0)&&Ie.box.length>0){let Fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Fe=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Oe,width:p,height:y,anchor:Pe,textBoxScale:b,prevAnchor:Fe},this.markUsedJustification(ue,Pe,X,ce),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,ce,X),this.placedOrientations[X.crossTileID]=ce),{shift:ge,placedGlyphBoxes:Ie}}}placeLayerBucketPart(o,d,p){const{bucket:y,layout:b,posMatrix:E,textLabelPlaneMatrix:A,labelToScreenMatrix:k,textPixelRatio:O,holdingForFade:j,collisionBoxArray:V,partiallyEvaluatedTextSize:X,collisionGroup:ue}=o.parameters,ce=b.get("text-optional"),fe=b.get("icon-optional"),ae=l.ar(b,"text-overlap","text-allow-overlap"),Pe=ae==="always",Oe=l.ar(b,"icon-overlap","icon-allow-overlap"),ge=Oe==="always",Ie=b.get("text-rotation-alignment")==="map",Fe=b.get("text-pitch-alignment")==="map",Be=b.get("icon-text-fit")!=="none",Ke=b.get("symbol-z-order")==="viewport-y",rt=Pe&&(ge||!y.hasIconData()||fe),et=ge&&(Pe||!y.hasTextData()||ce);!y.collisionArrays&&V&&y.deserializeCollisionBoxes(V);const ct=this.retainedQueryData[y.bucketInstanceId].tileID,Ft=this.terrain?(gt,sn)=>this.terrain.getElevation(ct,gt,sn):null,Cn=(gt,sn)=>{var jt,Hn;if(d[gt.crossTileID])return;if(j)return void(this.placements[gt.crossTileID]=new Ue(!1,!1,!1));let En=!1,xn=!1,An=!0,Ar=null,er={box:null,offscreen:null},pi={box:null,offscreen:null},Jr=null,Or=null,ms=null,or=0,yo=0,_o=0;sn.textFeatureIndex?or=sn.textFeatureIndex:gt.useRuntimeCollisionCircles&&(or=gt.featureIndex),sn.verticalTextFeatureIndex&&(yo=sn.verticalTextFeatureIndex);const _a=sn.textBox;if(_a){const wi=Ir=>{let Qr=l.ai.horizontal;if(y.allowVerticalPlacement&&!Ir&&this.prevPlacement){const Zi=this.prevPlacement.placedOrientations[gt.crossTileID];Zi&&(this.placedOrientations[gt.crossTileID]=Zi,Qr=Zi,this.markUsedOrientation(y,Qr,gt))}return Qr},mi=(Ir,Qr)=>{if(y.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&sn.verticalTextBox){for(const Zi of y.writingModes)if(Zi===l.ai.vertical?(er=Qr(),pi=er):er=Ir(),er&&er.box&&er.box.length)break}else er=Ir()},Li=gt.textAnchorOffsetStartIndex,Za=gt.textAnchorOffsetEndIndex;if(Za===Li){const Ir=(Qr,Zi)=>{const kr=this.collisionIndex.placeCollisionBox(Qr,ae,O,E,ue.predicate,Ft);return kr&&kr.box&&kr.box.length&&(this.markUsedOrientation(y,Zi,gt),this.placedOrientations[gt.crossTileID]=Zi),kr};mi(()=>Ir(_a,l.ai.horizontal),()=>{const Qr=sn.verticalTextBox;return y.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&Qr?Ir(Qr,l.ai.vertical):{box:null,offscreen:null}}),wi(er&&er.box&&er.box.length)}else{let Ir=l.aq[(Hn=(jt=this.prevPlacement)===null||jt===void 0?void 0:jt.variableOffsets[gt.crossTileID])===null||Hn===void 0?void 0:Hn.anchor];const Qr=(kr,Xa,hh)=>{const Ng=kr.x2-kr.x1,Bg=kr.y2-kr.y1,Qv=gt.textBoxScale,zf=Be&&Oe==="never"?Xa:null;let vo={box:[],offscreen:!1},Ya=ae==="never"?1:2,xo="never";Ir&&Ya++;for(let Ms=0;Ms<Ya;Ms++){for(let bo=Li;bo<Za;bo++){const Df=y.textAnchorOffsets.get(bo);if(Ir&&Df.textAnchor!==Ir)continue;const Yo=this.attemptAnchorPlacement(Df,kr,Ng,Bg,Qv,Ie,Fe,O,E,ue,xo,gt,y,hh,zf,Ft);if(Yo&&(vo=Yo.placedGlyphBoxes,vo&&vo.box&&vo.box.length))return En=!0,Ar=Yo.shift,vo}Ir?Ir=null:xo=ae}return vo};mi(()=>Qr(_a,sn.iconBox,l.ai.horizontal),()=>{const kr=sn.verticalTextBox;return y.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&gt.numVerticalGlyphVertices>0&&kr?Qr(kr,sn.verticalIconBox,l.ai.vertical):{box:null,offscreen:null}}),er&&(En=er.box,An=er.offscreen);const Zi=wi(er&&er.box);if(!En&&this.prevPlacement){const kr=this.prevPlacement.variableOffsets[gt.crossTileID];kr&&(this.variableOffsets[gt.crossTileID]=kr,this.markUsedJustification(y,kr.anchor,gt,Zi))}}}if(Jr=er,En=Jr&&Jr.box&&Jr.box.length>0,An=Jr&&Jr.offscreen,gt.useRuntimeCollisionCircles){const wi=y.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex),mi=l.aj(y.textSizeData,X,wi),Li=b.get("text-padding");Or=this.collisionIndex.placeCollisionCircles(ae,wi,y.lineVertexArray,y.glyphOffsetArray,mi,E,A,k,p,Fe,ue.predicate,gt.collisionCircleDiameter,Li,Ft),Or.circles.length&&Or.collisionDetected&&!p&&l.w("Collisions detected, but collision boxes are not shown"),En=Pe||Or.circles.length>0&&!Or.collisionDetected,An=An&&Or.offscreen}if(sn.iconFeatureIndex&&(_o=sn.iconFeatureIndex),sn.iconBox){const wi=mi=>{const Li=Be&&Ar?Pt(mi,Ar.x,Ar.y,Ie,Fe,this.transform.angle):mi;return this.collisionIndex.placeCollisionBox(Li,Oe,O,E,ue.predicate,Ft)};pi&&pi.box&&pi.box.length&&sn.verticalIconBox?(ms=wi(sn.verticalIconBox),xn=ms.box.length>0):(ms=wi(sn.iconBox),xn=ms.box.length>0),An=An&&ms.offscreen}const qa=ce||gt.numHorizontalGlyphVertices===0&&gt.numVerticalGlyphVertices===0,Nl=fe||gt.numIconVertices===0;if(qa||Nl?Nl?qa||(xn=xn&&En):En=xn&&En:xn=En=xn&&En,En&&Jr&&Jr.box&&this.collisionIndex.insertCollisionBox(Jr.box,ae,b.get("text-ignore-placement"),y.bucketInstanceId,pi&&pi.box&&yo?yo:or,ue.ID),xn&&ms&&this.collisionIndex.insertCollisionBox(ms.box,Oe,b.get("icon-ignore-placement"),y.bucketInstanceId,_o,ue.ID),Or&&(En&&this.collisionIndex.insertCollisionCircles(Or.circles,ae,b.get("text-ignore-placement"),y.bucketInstanceId,or,ue.ID),p)){const wi=y.bucketInstanceId;let mi=this.collisionCircleArrays[wi];mi===void 0&&(mi=this.collisionCircleArrays[wi]=new Ge);for(let Li=0;Li<Or.circles.length;Li+=4)mi.circles.push(Or.circles[Li+0]),mi.circles.push(Or.circles[Li+1]),mi.circles.push(Or.circles[Li+2]),mi.circles.push(Or.collisionDetected?1:0)}if(gt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[gt.crossTileID]=new Ue(En||rt,xn||et,An||y.justReloaded),d[gt.crossTileID]=!0};if(Ke){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const gt=y.getSortedSymbolIndexes(this.transform.angle);for(let sn=gt.length-1;sn>=0;--sn){const jt=gt[sn];Cn(y.symbolInstances.get(jt),y.collisionArrays[jt])}}else for(let gt=o.symbolInstanceStart;gt<o.symbolInstanceEnd;gt++)Cn(y.symbolInstances.get(gt),y.collisionArrays[gt]);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const gt=this.collisionCircleArrays[y.bucketInstanceId];l.as(gt.invProjMatrix,E),gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(o,d,p,y){let b;b=y===l.ai.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.at(d)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const A of E)A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=b>=0&&A!==b?0:p.crossTileID)}markUsedOrientation(o,d,p){const y=d===l.ai.horizontal||d===l.ai.horizontalOnly?d:0,b=d===l.ai.vertical?d:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const A of E)o.text.placedSymbolArray.get(A).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const y=d?d.symbolFadeChange(o):1,b=d?d.opacities:{},E=d?d.variableOffsets:{},A=d?d.placedOrientations:{};for(const k in this.placements){const O=this.placements[k],j=b[k];j?(this.opacities[k]=new Ee(j,y,O.text,O.icon),p=p||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[k]=new Ee(null,y,O.text,O.icon,O.skipFade),p=p||O.text||O.icon)}for(const k in b){const O=b[k];if(!this.opacities[k]){const j=new Ee(O,y,!1,!1);j.isHidden()||(this.opacities[k]=j,p=p||O.text.placed||O.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in A)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=A[k]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const p={};for(const y of d){const b=y.getBucket(o);b&&y.latestFeatureIndex&&o.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,y.collisionBoxArray)}}updateBucketOpacities(o,d,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const y=o.layers[0],b=y.layout,E=new Ee(null,0,!1,!1,!0),A=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),O=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=b.get("text-rotation-alignment")==="map",V=b.get("text-pitch-alignment")==="map",X=b.get("icon-text-fit")!=="none",ue=new Ee(null,0,A&&(k||!o.hasIconData()||b.get("icon-optional")),k&&(A||!o.hasTextData()||b.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const ce=(fe,ae,Pe)=>{for(let Oe=0;Oe<ae/4;Oe++)fe.opacityVertexArray.emplaceBack(Pe);fe.hasVisibleVertices=fe.hasVisibleVertices||Pe!==$i};for(let fe=0;fe<o.symbolInstances.length;fe++){const ae=o.symbolInstances.get(fe),{numHorizontalGlyphVertices:Pe,numVerticalGlyphVertices:Oe,crossTileID:ge}=ae;let Ie=this.opacities[ge];d[ge]?Ie=E:Ie||(Ie=ue,this.opacities[ge]=Ie),d[ge]=!0;const Fe=ae.numIconVertices>0,Be=this.placedOrientations[ae.crossTileID],Ke=Be===l.ai.vertical,rt=Be===l.ai.horizontal||Be===l.ai.horizontalOnly;if(Pe>0||Oe>0){const et=Yr(Ie.text);ce(o.text,Pe,Ke?$i:et),ce(o.text,Oe,rt?$i:et);const ct=Ie.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach(gt=>{gt>=0&&(o.text.placedSymbolArray.get(gt).hidden=ct||Ke?1:0)}),ae.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=ct||rt?1:0);const Ft=this.variableOffsets[ae.crossTileID];Ft&&this.markUsedJustification(o,Ft.anchor,ae,Be);const Cn=this.placedOrientations[ae.crossTileID];Cn&&(this.markUsedJustification(o,"left",ae,Cn),this.markUsedOrientation(o,Cn,ae))}if(Fe){const et=Yr(Ie.icon),ct=!(X&&ae.verticalPlacedIconSymbolIndex&&Ke);ae.placedIconSymbolIndex>=0&&(ce(o.icon,ae.numIconVertices,ct?et:$i),o.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=Ie.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(ce(o.icon,ae.numVerticalIconVertices,ct?$i:et),o.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=Ie.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const et=o.collisionArrays[fe];if(et){let ct=new l.P(0,0);if(et.textBox||et.verticalTextBox){let Cn=!0;if(O){const gt=this.variableOffsets[ge];gt?(ct=Kt(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textBoxScale),j&&ct._rotate(V?this.transform.angle:-this.transform.angle)):Cn=!1}et.textBox&&At(o.textCollisionBox.collisionVertexArray,Ie.text.placed,!Cn||Ke,ct.x,ct.y),et.verticalTextBox&&At(o.textCollisionBox.collisionVertexArray,Ie.text.placed,!Cn||rt,ct.x,ct.y)}const Ft=!!(!rt&&et.verticalIconBox);et.iconBox&&At(o.iconCollisionBox.collisionVertexArray,Ie.icon.placed,Ft,X?ct.x:0,X?ct.y:0),et.verticalIconBox&&At(o.iconCollisionBox.collisionVertexArray,Ie.icon.placed,!Ft,X?ct.x:0,X?ct.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const fe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=fe.invProjMatrix,o.placementViewportMatrix=fe.viewportMatrix,o.collisionCircleArray=fe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function At(v,o,d,p,y){v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0)}const dn=Math.pow(2,25),kn=Math.pow(2,24),gn=Math.pow(2,17),fn=Math.pow(2,16),nn=Math.pow(2,9),_n=Math.pow(2,8),pr=Math.pow(2,1);function Yr(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const o=v.placed?1:0,d=Math.floor(127*v.opacity);return d*dn+o*kn+d*gn+o*fn+d*nn+o*_n+d*pr+o}const $i=0;class Ba{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,p,y,b){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(E,y,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((A,k)=>A.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(d.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Kr{constructor(o,d,p,y,b,E,A,k){this.placement=new Bt(o,d,E,A,k),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,d,p){const y=l.h.now(),b=()=>!this._forceFullPlacement&&l.h.now()-y>2;for(;this._currentPlacementIndex>=0;){const E=d[o[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=A)&&(!E.maxzoom||E.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new Ba(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const cs=512/l.N/2;class po{constructor(o,d,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const y=new Map;for(let b=0;b<d.length;b++){const E=d.get(b),A=E.key,k=y.get(A);k?k.push(E):y.set(A,[E])}for(const[b,E]of y){const A={positions:E.map(k=>({x:Math.floor(k.anchorX*cs),y:Math.floor(k.anchorY*cs)})),crossTileIDs:E.map(k=>k.crossTileID)};if(A.positions.length>128){const k=new l.av(A.positions.length,16,Uint16Array);for(const{x:O,y:j}of A.positions)k.add(O,j);k.finish(),delete A.positions,A.index=k}this._symbolsByKey[b]=A}}getScaledCoordinates(o,d){const{x:p,y,z:b}=this.tileID.canonical,{x:E,y:A,z:k}=d.canonical,O=cs/Math.pow(2,k-b),j=(A*l.N+o.anchorY)*O,V=y*l.N*cs;return{x:Math.floor((E*l.N+o.anchorX)*O-p*l.N*cs),y:Math.floor(j-V)}}findMatches(o,d,p){const y=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let b=0;b<o.length;b++){const E=o.get(b);if(E.crossTileID)continue;const A=this._symbolsByKey[E.key];if(!A)continue;const k=this.getScaledCoordinates(E,d);if(A.index){const O=A.index.range(k.x-y,k.y-y,k.x+y,k.y+y).sort();for(const j of O){const V=A.crossTileIDs[j];if(!p[V]){p[V]=!0,E.crossTileID=V;break}}}else if(A.positions)for(let O=0;O<A.positions.length;O++){const j=A.positions[O],V=A.crossTileIDs[O];if(Math.abs(j.x-k.x)<=y&&Math.abs(j.y-k.y)<=y&&!p[V]){p[V]=!0,E.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Pn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $o{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const p in this.indexes){const y=this.indexes[p],b={};for(const E in y){const A=y[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+d),b[A.tileID.key]=A}this.indexes[p]=b}this.lng=o}addBucket(o,d,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const y=this.usedCrossTileIDs[o.overscaledZ];for(const b in this.indexes){const E=this.indexes[b];if(Number(b)>o.overscaledZ)for(const A in E){const k=E[A];k.tileID.isChildOf(o)&&k.findMatches(d.symbolInstances,o,y)}else{const A=E[o.scaledTo(Number(b)).key];A&&A.findMatches(d.symbolInstances,o,y)}}for(let b=0;b<d.symbolInstances.length;b++){const E=d.symbolInstances.get(b);E.crossTileID||(E.crossTileID=p.generate(),y[E.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new po(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const p of d.getCrossTileIDsLists())for(const y of p)delete this.usedCrossTileIDs[o][y]}removeStaleBuckets(o){let d=!1;for(const p in this.indexes){const y=this.indexes[p];for(const b in y)o[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[b]),delete y[b],d=!0)}return d}}class ki{constructor(){this.layerIndexes={},this.crossTileIDs=new Pn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,p){let y=this.layerIndexes[o.id];y===void 0&&(y=this.layerIndexes[o.id]=new $o);let b=!1;const E={};y.handleWrapJump(p);for(const A of d){const k=A.getBucket(o);k&&o.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(A.tileID,k,this.crossTileIDs)&&(b=!0),E[k.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(b=!0),b}pruneUnusedLayers(o){const d={};o.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}const ir=(v,o)=>l.x(v,o&&o.filter(d=>d.identifier!=="source.canvas")),bi=l.F(l.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Vu=l.F(l.ax,["setCenter","setZoom","setBearing","setPitch"]),di=l.aw();class Zn extends l.E{constructor(o,d={}){super(),this.map=o,this.dispatcher=new Dt(Qe(),this,o._getMapId()),this.imageManager=new De,this.imageManager.setEventedParent(this),this.glyphManager=new Ze(o._requestManager,d.localIdeographFontFamily),this.lineAtlas=new lt(256,512),this.crossTileSymbolIndex=new ki,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.az());const p=this;this._rtlTextPluginCallback=Zn.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,E)=>{if(l.aA(b),E&&E.every(A=>A))for(const A in p.sourceCaches){const k=p.sourceCaches[A].getSource().type;k!=="vector"&&k!=="geojson"||p.sourceCaches[A].reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.sourceCaches[y.sourceId];if(!b)return;const E=b.getSource();if(E&&E.vectorLayerIds)for(const A in this._layers){const k=this._layers[A];k.source===E.id&&this._validateLayer(k)}})}loadURL(o,d={},p){this.fire(new l.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const y=this.map._requestManager.transformRequest(o,z.Style);this._request=l.f(y,(b,E)=>{this._request=null,b?this.fire(new l.j(b)):E&&this._load(E,d,p)})}loadJSON(o,d={},p){this.fire(new l.k("dataloading",{dataType:"style"})),this._request=l.h.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(o,d,p)})}loadEmpty(){this.fire(new l.k("dataloading",{dataType:"style"})),this._load(di,{validate:!1})}_load(o,d,p){var y;const b=d.transformStyle?d.transformStyle(p,o):o;if(!d.validate||!ir(this,l.y(b))){this._loaded=!0,this.stylesheet=b;for(const E in b.sources)this.addSource(E,b.sources[E],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new Xe(this.stylesheet.light),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.k("data",{dataType:"style"})),this.fire(new l.k("style.load"))}}_createLayers(){const o=l.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of o){const p=l.aC(d);p.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=p}}_loadSprite(o,d=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(y,b,E,A){const k=xe(y),O=k.length,j=E>1?"@2x":"",V={},X={},ue={};for(const{id:ce,url:fe}of k){const ae=b.transformRequest(b.normalizeSpriteURL(fe,j,".json"),z.SpriteJSON),Pe=`${ce}_${ae.url}`;V[Pe]=l.f(ae,(Ie,Fe)=>{delete V[Pe],X[ce]=Fe,Se(A,X,ue,Ie,O)});const Oe=b.transformRequest(b.normalizeSpriteURL(fe,j,".png"),z.SpriteImage),ge=`${ce}_${Oe.url}`;V[ge]=W.getImage(Oe,(Ie,Fe)=>{delete V[ge],ue[ce]=Fe,Se(A,X,ue,Ie,O)})}return{cancel(){for(const ce of Object.values(V))ce.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(y,b)=>{if(this._spriteRequest=null,y)this.fire(new l.j(y));else if(b)for(const E in b){this._spritesImagesIds[E]=[];const A=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(k=>!(k in b)):[];for(const k of A)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in b[E]){const O=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,b[E][k],!1):this.imageManager.addImage(O,b[E][k]),d&&(this._changedImages[O]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"})),p&&p(y)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}_validateLayer(o){const d=this.sourceCaches[o.source];if(!d)return;const p=o.sourceLayer;if(!p)return;const y=d.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.j(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const d=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d);const p=[];for(const y of o)d[y]&&p.push(d[y]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const y=this._layers[p];y.type!=="custom"&&(o[p]=y.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const E in this._updatedSources){const A=this._updatedSources[E];if(A==="reload")this._reloadSource(E);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const b=this.sourceCaches[y];p[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];b.recalculate(o,this._availableImages),!b.isHidden(o.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const y in p){const b=this.sourceCaches[y];p[y]!==b.used&&b.fire(new l.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(o),this.z=o.zoom,d&&this.fire(new l.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){this._checkLoaded();const p=this.serialize();if(o=d.transformStyle?d.transformStyle(p,o):o,ir(this,l.y(o)))return!1;(o=l.aD(o)).layers=l.aB(o.layers);const y=l.aE(p,o).filter(E=>!(E.command in Vu));if(y.length===0)return!1;const b=y.filter(E=>!(E.command in bi));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);for(const E of y)E.command!=="setTransition"&&this[E.command].apply(this,E.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,d){if(this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,p={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(l.y.source,`sources.${o}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const y=this.sourceCaches[o]=new Ct(o,d,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:o})),y.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new l.j(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new l.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,d,p={}){this._checkLoaded();const y=o.id;if(this.getLayer(y))return void this.fire(new l.j(new Error(`Layer "${y}" already exists on this map.`)));let b;if(o.type==="custom"){if(ir(this,l.aF(o)))return;b=l.aC(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(y,o.source),o=l.aD(o),o=l.e(o,{source:y})),this._validate(l.y.layer,`layers.${y}`,o,{arrayIndex:-1},p))return;b=l.aC(o),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}})}const E=d?this._order.indexOf(d):this._order.length;if(d&&E===-1)this.fire(new l.j(new Error(`Cannot add layer "${y}" before non-existing layer "${d}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=b,this._removedLayers[y]&&b.source&&b.type!=="custom"){const A=this._removedLayers[y];delete this._removedLayers[y],A.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new l.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const p=this._order.indexOf(o);this._order.splice(p,1);const y=d?this._order.indexOf(d):this._order.length;d&&y===-1?this.fire(new l.j(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(y,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new l.j(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,p){this._checkLoaded();const y=this.getLayer(o);y?y.minzoom===d&&y.maxzoom===p||(d!=null&&(y.minzoom=d),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,p={}){this._checkLoaded();const y=this.getLayer(o);if(y){if(!l.aG(y.filter,d))return d==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.y.filter,`layers.${y.id}.filter`,d,null,p)||(y.filter=l.aD(d),this._updateLayer(y)))}else this.fire(new l.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return l.aD(this.getLayer(o).filter)}setLayoutProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.aG(b.getLayoutProperty(d),p)||(b.setLayoutProperty(d,p,y),this._updateLayer(b)):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const p=this.getLayer(o);if(p)return p.getLayoutProperty(d);this.fire(new l.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.aG(b.getPaintProperty(d),p)||(b.setPaintProperty(d,p,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const p=o.source,y=o.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new l.j(new Error(`The source '${p}' does not exist in the map's style.`)));const E=b.getSource().type;E==="geojson"&&y?this.fire(new l.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),b.setFeatureState(y,o.id,d)):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const p=o.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new l.j(new Error(`The source '${p}' does not exist in the map's style.`)));const b=y.getSource().type,E=b==="vector"?o.sourceLayer:void 0;b!=="vector"||E?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new l.j(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,o.id,d):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,p=o.sourceLayer,y=this.sourceCaches[d];if(y!==void 0)return y.getSource().type!=="vector"||p?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,o.id)):void this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=l.aH(this.sourceCaches,b=>b.serialize()),d=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,y=this.stylesheet;return l.aI({version:y.version,name:y.name,metadata:y.metadata,light:y.light,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,sources:o,layers:d,terrain:p},b=>b!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=E=>this._layers[E].type==="fill-extrusion",p={},y=[];for(let E=this._order.length-1;E>=0;E--){const A=this._order[E];if(d(A)){p[A]=E;for(const k of o){const O=k[A];if(O)for(const j of O)y.push(j)}}}y.sort((E,A)=>A.intersectionZ-E.intersectionZ);const b=[];for(let E=this._order.length-1;E>=0;E--){const A=this._order[E];if(d(A))for(let k=y.length-1;k>=0;k--){const O=y[k].feature;if(p[O.layer.id]<E)break;b.push(O),y.pop()}else for(const k of o){const O=k[A];if(O)for(const j of O)b.push(j.feature)}}return b}queryRenderedFeatures(o,d,p){d&&d.filter&&this._validate(l.y.filter,"queryRenderedFeatures.filter",d.filter,null,d);const y={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new l.j(new Error("parameters.layers must be an Array."))),[];for(const A of d.layers){const k=this._layers[A];if(!k)return this.fire(new l.j(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];y[k.source]=!0}}const b=[];d.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const A in this.sourceCaches)d.layers&&!y[A]||b.push(yn(this.sourceCaches[A],this._layers,E,o,d,p));return this.placement&&b.push(function(A,k,O,j,V,X,ue){const ce={},fe=X.queryRenderedSymbols(j),ae=[];for(const Pe of Object.keys(fe).map(Number))ae.push(ue[Pe]);ae.sort(vn);for(const Pe of ae){const Oe=Pe.featureIndex.lookupSymbolFeatures(fe[Pe.bucketInstanceId],k,Pe.bucketIndex,Pe.sourceLayerIndex,V.filter,V.layers,V.availableImages,A);for(const ge in Oe){const Ie=ce[ge]=ce[ge]||[],Fe=Oe[ge];Fe.sort((Be,Ke)=>{const rt=Pe.featureSortOrder;if(rt){const et=rt.indexOf(Be.featureIndex);return rt.indexOf(Ke.featureIndex)-et}return Ke.featureIndex-Be.featureIndex});for(const Be of Fe)Ie.push(Be)}}for(const Pe in ce)ce[Pe].forEach(Oe=>{const ge=Oe.feature,Ie=O[A[Pe].source].getFeatureState(ge.layer["source-layer"],ge.id);ge.source=ge.layer.source,ge.layer["source-layer"]&&(ge.sourceLayer=ge.layer["source-layer"]),ge.state=Ie});return ce}(this._layers,E,this.sourceCaches,o,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,d){d&&d.filter&&this._validate(l.y.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[o];return p?function(y,b){const E=y.getRenderableIds().map(O=>y.getTileByID(O)),A=[],k={};for(let O=0;O<E.length;O++){const j=E[O],V=j.tileID.canonical.key;k[V]||(k[V]=!0,j.querySourceFeatures(A,b))}return A}(p,d):[]}addSourceType(o,d,p){return It(o)?p(new Error(`A source type called "${o}" already exists.`)):(((y,b)=>{Ht[y]=b})(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const E in o)if(!l.aG(o[E],p[E])){y=!0;break}if(!y)return;const b={now:l.h.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(b)}_validate(o,d,p,y,b={}){return(!b||b.validate!==!1)&&ir(this,o.call(l.y,l.e({key:d,style:this.serialize(),value:p,styleSpec:l.v},y)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const d in this.sourceCaches)this.sourceCaches[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,d,p,y,b=!1){let E=!1,A=!1;const k={};for(const O of this._order){const j=this._layers[O];if(j.type!=="symbol")continue;if(!k[j.source]){const X=this.sourceCaches[j.source];k[j.source]=X.getRenderableIds(!0).map(ue=>X.getTileByID(ue)).sort((ue,ce)=>ce.tileID.overscaledZ-ue.tileID.overscaledZ||(ue.tileID.isLessThan(ce.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(j,k[j.source],o.center.lng);E=E||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.h.now(),o.zoom))&&(this.pauseablePlacement=new Kr(o,this.map.terrain,this._order,b,d,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.h.now()),A=!0),E&&this.pauseablePlacement.placement.setStale()),A||E)for(const O of this._order){const j=this._layers[O];j.type==="symbol"&&this.placement.updateLayerOpacities(j,k[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.h.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,p){this.imageManager.getImages(d.icons,p),this._updateTilesForChangedImages();const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(o,d,p){this.glyphManager.getGlyphs(d.stacks,p);const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,[""])}getResource(o,d,p){return l.m(d,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(l.y.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,d,p={},y){this._checkLoaded();const b=[{id:o,url:d}],E=[...xe(this.stylesheet.sprite),...b];this._validate(l.y.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(b,!0,y))}removeSprite(o){this._checkLoaded();const d=xe(this.stylesheet.sprite);if(d.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}else this.fire(new l.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return xe(this.stylesheet.sprite)}setSprite(o,d={},p){this._checkLoaded(),o&&this._validate(l.y.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}Zn.registerForPluginStateChange=l.aK;var Go=l.Q([{name:"a_pos",type:"Int16",components:2}]),mo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Jn={prelude:Dn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",mo),terrainDepth:Dn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",mo),terrainCoords:Dn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",mo)};function Dn(v,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),y=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=b?b.concat(y):y,A={};return{fragmentSource:v=v.replace(d,(k,O,j,V,X)=>(A[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${j} ${V} ${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = u_${X};
#endif
`)),vertexSource:o=o.replace(d,(k,O,j,V,X)=>{const ue=V==="float"?"vec2":"vec4",ce=X.match(/color/)?"color":ue;return A[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${j} ${ue} a_${X};
varying ${j} ${V} ${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${j} ${ue} a_${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = a_${X};
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${j} ${V} ${X} = u_${X};
#endif
`}),staticAttributes:p,staticUniforms:E}}class Us{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,p,y,b,E,A,k,O){this.context=o;let j=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!j&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(j=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||j||this.boundIndexBuffer!==b||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==O?this.freshBind(d,p,y,b,E,A,k,O):(o.bindVertexArray.set(this.vao),A&&A.bind(),b&&b.dynamicDraw&&b.bind(),k&&k.bind(),O&&O.bind())}freshBind(o,d,p,y,b,E,A,k){const O=o.numAttributes,j=this.context,V=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=k,d.enableAttributes(V,o);for(const X of p)X.enableAttributes(V,o);E&&E.enableAttributes(V,o),A&&A.enableAttributes(V,o),k&&k.enableAttributes(V,o),d.bind(),d.setVertexAttribPointers(V,o,b);for(const X of p)X.bind(),X.setVertexAttribPointers(V,o,b);E&&(E.bind(),E.setVertexAttribPointers(V,o,b)),y&&y.bind(),A&&(A.bind(),A.setVertexAttribPointers(V,o,b)),k&&(k.bind(),k.setVertexAttribPointers(V,o,b)),j.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Qn(v){const o=[];for(let d=0;d<v.length;d++){if(v[d]===null)continue;const p=v[d].split(" ");o.push(p.pop())}return o}class Gi{constructor(o,d,p,y,b,E){const A=o.gl;this.program=A.createProgram();const k=Qn(d.staticAttributes),O=p?p.getBinderAttributes():[],j=k.concat(O),V=Jn.prelude.staticUniforms?Qn(Jn.prelude.staticUniforms):[],X=d.staticUniforms?Qn(d.staticUniforms):[],ue=p?p.getBinderUniforms():[],ce=V.concat(X).concat(ue),fe=[];for(const Be of ce)fe.indexOf(Be)<0&&fe.push(Be);const ae=p?p.defines():[];b&&ae.push("#define OVERDRAW_INSPECTOR;"),E&&ae.push("#define TERRAIN3D;");const Pe=ae.concat(Jn.prelude.fragmentSource,d.fragmentSource).join(`
`),Oe=ae.concat(Jn.prelude.vertexSource,d.vertexSource).join(`
`),ge=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(ge,Pe),A.compileShader(ge),!A.getShaderParameter(ge,A.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${A.getShaderInfoLog(ge)}`);A.attachShader(this.program,ge);const Ie=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(Ie,Oe),A.compileShader(Ie),!A.getShaderParameter(Ie,A.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${A.getShaderInfoLog(Ie)}`);A.attachShader(this.program,Ie),this.attributes={};const Fe={};this.numAttributes=j.length;for(let Be=0;Be<this.numAttributes;Be++)j[Be]&&(A.bindAttribLocation(this.program,Be,j[Be]),this.attributes[j[Be]]=Be);if(A.linkProgram(this.program),!A.getProgramParameter(this.program,A.LINK_STATUS))throw new Error(`Program failed to link: ${A.getProgramInfoLog(this.program)}`);A.deleteShader(Ie),A.deleteShader(ge);for(let Be=0;Be<fe.length;Be++){const Ke=fe[Be];if(Ke&&!Fe[Ke]){const rt=A.getUniformLocation(this.program,Ke);rt&&(Fe[Ke]=rt)}}this.fixedUniforms=y(o,Fe),this.terrainUniforms=((Be,Ke)=>({u_depth:new l.aL(Be,Ke.u_depth),u_terrain:new l.aL(Be,Ke.u_terrain),u_terrain_dim:new l.aM(Be,Ke.u_terrain_dim),u_terrain_matrix:new l.aN(Be,Ke.u_terrain_matrix),u_terrain_unpack:new l.aO(Be,Ke.u_terrain_unpack),u_terrain_exaggeration:new l.aM(Be,Ke.u_terrain_exaggeration)}))(o,Fe),this.binderUniforms=p?p.getUniforms(o,Fe):[]}draw(o,d,p,y,b,E,A,k,O,j,V,X,ue,ce,fe,ae,Pe,Oe){const ge=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(y),o.setColorMode(b),o.setCullFace(E),k){o.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,k.depthTexture),o.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,k.texture);for(const Fe in this.terrainUniforms)this.terrainUniforms[Fe].set(k[Fe])}for(const Fe in this.fixedUniforms)this.fixedUniforms[Fe].set(A[Fe]);fe&&fe.setUniforms(o,this.binderUniforms,ue,{zoom:ce});let Ie=0;switch(d){case ge.LINES:Ie=2;break;case ge.TRIANGLES:Ie=3;break;case ge.LINE_STRIP:Ie=1}for(const Fe of X.get()){const Be=Fe.vaos||(Fe.vaos={});(Be[O]||(Be[O]=new Us)).bind(o,this,j,fe?fe.getPaintVertexBuffers():[],V,Fe.vertexOffset,ae,Pe,Oe),ge.drawElements(d,Fe.primitiveLength*Ie,ge.UNSIGNED_SHORT,Fe.primitiveOffset*Ie*2)}}}function Wi(v,o,d){const p=1/be(d,1,o.transform.tileZoom),y=Math.pow(2,d.tileID.overscaledZ),b=d.tileSize*Math.pow(2,o.transform.tileZoom)/y,E=b*(d.tileID.canonical.x+d.tileID.wrap*y),A=b*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[E>>16,A>>16],u_pixel_coord_lower:[65535&E,65535&A]}}const Pl=(v,o,d,p)=>{const y=o.style.light,b=y.properties.get("position"),E=[b.x,b.y,b.z],A=function(){var O=new l.A(9);return l.A!=Float32Array&&(O[1]=0,O[2]=0,O[3]=0,O[5]=0,O[6]=0,O[7]=0),O[0]=1,O[4]=1,O[8]=1,O}();y.properties.get("anchor")==="viewport"&&function(O,j){var V=Math.sin(j),X=Math.cos(j);O[0]=X,O[1]=V,O[2]=0,O[3]=-V,O[4]=X,O[5]=0,O[6]=0,O[7]=0,O[8]=1}(A,-o.transform.angle),function(O,j,V){var X=j[0],ue=j[1],ce=j[2];O[0]=X*V[0]+ue*V[3]+ce*V[6],O[1]=X*V[1]+ue*V[4]+ce*V[7],O[2]=X*V[2]+ue*V[5]+ce*V[8]}(E,E,A);const k=y.properties.get("color");return{u_matrix:v,u_lightpos:E,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+d,u_opacity:p}},Cs=(v,o,d,p,y,b,E)=>l.e(Pl(v,o,d,p),Wi(b,o,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),Lc=v=>({u_matrix:v}),Rc=(v,o,d,p)=>l.e(Lc(v),Wi(d,o,p)),Cl=(v,o)=>({u_matrix:v,u_world:o}),ee=(v,o,d,p,y)=>l.e(Rc(v,o,d,p),{u_world:y}),oe=(v,o,d,p)=>{const y=v.transform;let b,E;if(p.paint.get("circle-pitch-alignment")==="map"){const A=be(d,1,y.zoom);b=!0,E=[A,A]}else b=!1,E=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(o.posMatrix,d,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:E}},we=(v,o,d)=>{const p=be(d,1,o.zoom),y=Math.pow(2,o.zoom-d.tileID.overscaledZ),b=d.tileID.overscaleFactor();return{u_matrix:v,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*y),o.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:b}},Ne=(v,o,d=1)=>({u_matrix:v,u_color:o,u_overlay:0,u_overlay_scale:d}),at=v=>({u_matrix:v}),zt=(v,o,d,p)=>({u_matrix:v,u_extrude_scale:be(o,1,d),u_intensity:p});function Tn(v,o){const d=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new l.U(0,p/d).toLngLat().lat,new l.U(0,(p+1)/d).toLngLat().lat]}const Cr=(v,o,d,p)=>{const y=v.transform;return{u_matrix:Uu(v,o,d,p),u_ratio:1/be(o,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Ur=(v,o,d,p,y)=>l.e(Cr(v,o,d,y),{u_image:0,u_image_height:p}),fi=(v,o,d,p,y)=>{const b=v.transform,E=sg(o,b);return{u_matrix:Uu(v,o,d,y),u_texsize:o.imageAtlasTexture.size,u_ratio:1/be(o,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},us=(v,o,d,p,y,b)=>{const E=v.lineAtlas,A=sg(o,v.transform),k=d.layout.get("line-cap")==="round",O=E.getDash(p.from,k),j=E.getDash(p.to,k),V=O.width*y.fromScale,X=j.width*y.toScale;return l.e(Cr(v,o,d,b),{u_patternscale_a:[A/V,-O.height/2],u_patternscale_b:[A/X,-j.height/2],u_sdfgamma:E.width/(256*Math.min(V,X)*v.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:j.y,u_mix:y.t})};function sg(v,o){return 1/be(v,1,o.tileZoom)}function Uu(v,o,d,p){return v.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const og=(v,o,d,p,y)=>{return{u_matrix:v,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(E=y.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(b=y.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:ag(y.paint.get("raster-hue-rotate"))};var b,E};function ag(v){v*=Math.PI/180;const o=Math.sin(v),d=Math.cos(v);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Qd=(v,o,d,p,y,b,E,A,k,O)=>{const j=y.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:j.width/j.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:A,u_is_text:+k,u_pitch_with_map:+p,u_texsize:O,u_texture:0}},ef=(v,o,d,p,y,b,E,A,k,O,j)=>{const V=y.transform;return l.e(Qd(v,o,d,p,y,b,E,A,k,O),{u_gamma_scale:p?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+j})},ja=(v,o,d,p,y,b,E,A,k,O)=>l.e(ef(v,o,d,p,y,b,E,A,!0,k,!0),{u_texsize_icon:O,u_texture_icon:1}),$u=(v,o,d)=>({u_matrix:v,u_opacity:o,u_color:d}),As=(v,o,d,p,y,b)=>l.e(function(E,A,k,O){const j=k.imageManager.getPattern(E.from.toString()),V=k.imageManager.getPattern(E.to.toString()),{width:X,height:ue}=k.imageManager.getPixelSize(),ce=Math.pow(2,O.tileID.overscaledZ),fe=O.tileSize*Math.pow(2,k.transform.tileZoom)/ce,ae=fe*(O.tileID.canonical.x+O.tileID.wrap*ce),Pe=fe*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[X,ue],u_mix:A.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/be(O,1,k.transform.tileZoom),u_pixel_coord_upper:[ae>>16,Pe>>16],u_pixel_coord_lower:[65535&ae,65535&Pe]}}(p,b,d,y),{u_matrix:v,u_opacity:o}),Gu={fillExtrusion:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_lightpos:new l.aP(v,o.u_lightpos),u_lightintensity:new l.aM(v,o.u_lightintensity),u_lightcolor:new l.aP(v,o.u_lightcolor),u_vertical_gradient:new l.aM(v,o.u_vertical_gradient),u_opacity:new l.aM(v,o.u_opacity)}),fillExtrusionPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_lightpos:new l.aP(v,o.u_lightpos),u_lightintensity:new l.aM(v,o.u_lightintensity),u_lightcolor:new l.aP(v,o.u_lightcolor),u_vertical_gradient:new l.aM(v,o.u_vertical_gradient),u_height_factor:new l.aM(v,o.u_height_factor),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade),u_opacity:new l.aM(v,o.u_opacity)}),fill:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix)}),fillPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),fillOutline:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world)}),fillOutlinePattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),circle:(v,o)=>({u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_scale_with_map:new l.aL(v,o.u_scale_with_map),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_extrude_scale:new l.aQ(v,o.u_extrude_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_matrix:new l.aN(v,o.u_matrix)}),collisionBox:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.aM(v,o.u_pixels_to_tile_units),u_extrude_scale:new l.aQ(v,o.u_extrude_scale),u_overscale_factor:new l.aM(v,o.u_overscale_factor)}),collisionCircle:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_inv_matrix:new l.aN(v,o.u_inv_matrix),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_viewport_size:new l.aQ(v,o.u_viewport_size)}),debug:(v,o)=>({u_color:new l.aR(v,o.u_color),u_matrix:new l.aN(v,o.u_matrix),u_overlay:new l.aL(v,o.u_overlay),u_overlay_scale:new l.aM(v,o.u_overlay_scale)}),clippingMask:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix)}),heatmap:(v,o)=>({u_extrude_scale:new l.aM(v,o.u_extrude_scale),u_intensity:new l.aM(v,o.u_intensity),u_matrix:new l.aN(v,o.u_matrix)}),heatmapTexture:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world),u_image:new l.aL(v,o.u_image),u_color_ramp:new l.aL(v,o.u_color_ramp),u_opacity:new l.aM(v,o.u_opacity)}),hillshade:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_latrange:new l.aQ(v,o.u_latrange),u_light:new l.aQ(v,o.u_light),u_shadow:new l.aR(v,o.u_shadow),u_highlight:new l.aR(v,o.u_highlight),u_accent:new l.aR(v,o.u_accent)}),hillshadePrepare:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_dimension:new l.aQ(v,o.u_dimension),u_zoom:new l.aM(v,o.u_zoom),u_unpack:new l.aO(v,o.u_unpack)}),line:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels)}),lineGradient:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_image:new l.aL(v,o.u_image),u_image_height:new l.aM(v,o.u_image_height)}),linePattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texsize:new l.aQ(v,o.u_texsize),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_image:new l.aL(v,o.u_image),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),lineSDF:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_patternscale_a:new l.aQ(v,o.u_patternscale_a),u_patternscale_b:new l.aQ(v,o.u_patternscale_b),u_sdfgamma:new l.aM(v,o.u_sdfgamma),u_image:new l.aL(v,o.u_image),u_tex_y_a:new l.aM(v,o.u_tex_y_a),u_tex_y_b:new l.aM(v,o.u_tex_y_b),u_mix:new l.aM(v,o.u_mix)}),raster:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_tl_parent:new l.aQ(v,o.u_tl_parent),u_scale_parent:new l.aM(v,o.u_scale_parent),u_buffer_scale:new l.aM(v,o.u_buffer_scale),u_fade_t:new l.aM(v,o.u_fade_t),u_opacity:new l.aM(v,o.u_opacity),u_image0:new l.aL(v,o.u_image0),u_image1:new l.aL(v,o.u_image1),u_brightness_low:new l.aM(v,o.u_brightness_low),u_brightness_high:new l.aM(v,o.u_brightness_high),u_saturation_factor:new l.aM(v,o.u_saturation_factor),u_contrast_factor:new l.aM(v,o.u_contrast_factor),u_spin_weights:new l.aP(v,o.u_spin_weights)}),symbolIcon:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texture:new l.aL(v,o.u_texture)}),symbolSDF:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texture:new l.aL(v,o.u_texture),u_gamma_scale:new l.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_is_halo:new l.aL(v,o.u_is_halo)}),symbolTextAndIcon:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texsize_icon:new l.aQ(v,o.u_texsize_icon),u_texture:new l.aL(v,o.u_texture),u_texture_icon:new l.aL(v,o.u_texture_icon),u_gamma_scale:new l.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_is_halo:new l.aL(v,o.u_is_halo)}),background:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_opacity:new l.aM(v,o.u_opacity),u_color:new l.aR(v,o.u_color)}),backgroundPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_opacity:new l.aM(v,o.u_opacity),u_image:new l.aL(v,o.u_image),u_pattern_tl_a:new l.aQ(v,o.u_pattern_tl_a),u_pattern_br_a:new l.aQ(v,o.u_pattern_br_a),u_pattern_tl_b:new l.aQ(v,o.u_pattern_tl_b),u_pattern_br_b:new l.aQ(v,o.u_pattern_br_b),u_texsize:new l.aQ(v,o.u_texsize),u_mix:new l.aM(v,o.u_mix),u_pattern_size_a:new l.aQ(v,o.u_pattern_size_a),u_pattern_size_b:new l.aQ(v,o.u_pattern_size_b),u_scale_a:new l.aM(v,o.u_scale_a),u_scale_b:new l.aM(v,o.u_scale_b),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.aM(v,o.u_tile_units_to_pixels)}),terrain:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texture:new l.aL(v,o.u_texture),u_ele_delta:new l.aM(v,o.u_ele_delta)}),terrainDepth:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ele_delta:new l.aM(v,o.u_ele_delta)}),terrainCoords:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texture:new l.aL(v,o.u_texture),u_terrain_coords_id:new l.aM(v,o.u_terrain_coords_id),u_ele_delta:new l.aM(v,o.u_ele_delta)})};class Wu{constructor(o,d,p){this.context=o;const y=o.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Oc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Hu{constructor(o,d,p,y){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=y,this.context=o;const b=o.gl;this.buffer=b.createBuffer(),o.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let p=0;p<this.attributes.length;p++){const y=d.attributes[this.attributes[p].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,d,p){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],E=d.attributes[b.name];E!==void 0&&o.vertexAttribPointer(E,b.components,o[Oc[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Al=new WeakMap;function pa(v){var o;if(Al.has(v))return Al.get(v);{const d=(o=v.getParameter(v.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Al.set(v,d),d}}class Rn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qu extends Rn{getDefault(){return l.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class hs extends Rn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ds extends Rn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class tf extends Rn{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Zu extends Rn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Xu extends Rn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class nf extends Rn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class rf extends Rn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Yu extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class sf extends Rn{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class of extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ku extends Rn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class lg extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class cg extends Rn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Il extends Rn{getDefault(){return l.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class jv extends Rn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Vv extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Uv extends Rn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class $v extends Rn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Gv extends Rn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Wv extends Rn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class af extends Rn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ju extends Rn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class lf extends Rn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class cf extends Rn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class kl extends Rn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ug extends Rn{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class hg extends Rn{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const p=this.gl;pa(p)?p.bindVertexArray(o):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class uf extends Rn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Va extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class dg extends Rn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ma extends Rn{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Ml extends ma{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class fg extends ma{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class hf extends ma{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class $n{constructor(o,d,p,y,b){this.context=o,this.width=d,this.height=p;const E=o.gl,A=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Ml(o,A),y)this.depthAttachment=b?new hf(o,A):new fg(o,A);else if(b)throw new Error("Stencil cannot be setted without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class mr{constructor(o,d,p){this.blendFunction=o,this.blendColor=d,this.mask=p}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,l.aT.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,l.aT.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],l.aT.transparent,[!0,!0,!0,!0]);class Hv{constructor(o){var d,p;if(this.gl=o,this.clearColor=new qu(this),this.clearDepth=new hs(this),this.clearStencil=new ds(this),this.colorMask=new tf(this),this.depthMask=new Zu(this),this.stencilMask=new Xu(this),this.stencilFunc=new nf(this),this.stencilOp=new rf(this),this.stencilTest=new Yu(this),this.depthRange=new sf(this),this.depthTest=new of(this),this.depthFunc=new Ku(this),this.blend=new lg(this),this.blendFunc=new cg(this),this.blendColor=new Il(this),this.blendEquation=new jv(this),this.cullFace=new Vv(this),this.cullFaceSide=new Uv(this),this.frontFace=new $v(this),this.program=new Gv(this),this.activeTexture=new Wv(this),this.viewport=new af(this),this.bindFramebuffer=new Ju(this),this.bindRenderbuffer=new lf(this),this.bindTexture=new cf(this),this.bindVertexBuffer=new kl(this),this.bindElementBuffer=new ug(this),this.bindVertexArray=new hg(this),this.pixelStoreUnpack=new uf(this),this.pixelStoreUnpackPremultiplyAlpha=new Va(this),this.pixelStoreUnpackFlipY=new dg(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),pa(o)){this.HALF_FLOAT=o.HALF_FLOAT;const y=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(p=o.RGB16F)!==null&&p!==void 0?p:y==null?void 0:y.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const y=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new Wu(this,o,d)}createVertexBuffer(o,d,p){return new Hu(this,o,d,p)}createRenderbuffer(o,d,p){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,o,d,p),this.bindRenderbuffer.set(null),b}createFramebuffer(o,d,p,y){return new $n(this,o,d,p,y)}clear({color:o,depth:d,stencil:p}){const y=this.gl;let b=0;o&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(b)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){l.aG(o.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return pa(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return pa(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class On{constructor(o,d,p){this.func=o,this.mask=d,this.range=p}}On.ReadOnly=!1,On.ReadWrite=!0,On.disabled=new On(519,On.ReadOnly,[0,1]);const Ua=7680;class gr{constructor(o,d,p,y,b,E){this.test=o,this.ref=d,this.mask=p,this.fail=y,this.depthFail=b,this.pass=E}}gr.disabled=new gr({func:519,mask:0},0,0,Ua,Ua,Ua);class dr{constructor(o,d,p){this.enable=o,this.mode=d,this.frontFace=p}}let zc;function pg(v,o,d,p,y,b,E){const A=v.context,k=A.gl,O=v.useProgram("collisionBox"),j=[];let V=0,X=0;for(let ge=0;ge<p.length;ge++){const Ie=p[ge],Fe=o.getTile(Ie),Be=Fe.getBucket(d);if(!Be)continue;let Ke=Ie.posMatrix;y[0]===0&&y[1]===0||(Ke=v.translatePosMatrix(Ie.posMatrix,Fe,y,b));const rt=E?Be.textCollisionBox:Be.iconCollisionBox,et=Be.collisionCircleArray;if(et.length>0){const ct=l.Z(),Ft=Ke;l.aU(ct,Be.placementInvProjMatrix,v.transform.glCoordMatrix),l.aU(ct,ct,Be.placementViewportMatrix),j.push({circleArray:et,circleOffset:X,transform:Ft,invTransform:ct,coord:Ie}),V+=et.length/4,X=V}rt&&O.draw(A,k.LINES,On.disabled,gr.disabled,v.colorModeForRenderPass(),dr.disabled,we(Ke,v.transform,Fe),v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ie),d.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,null,v.transform.zoom,null,null,rt.collisionVertexBuffer)}if(!E||!j.length)return;const ue=v.useProgram("collisionCircle"),ce=new l.aV;ce.resize(4*V),ce._trim();let fe=0;for(const ge of j)for(let Ie=0;Ie<ge.circleArray.length/4;Ie++){const Fe=4*Ie,Be=ge.circleArray[Fe+0],Ke=ge.circleArray[Fe+1],rt=ge.circleArray[Fe+2],et=ge.circleArray[Fe+3];ce.emplace(fe++,Be,Ke,rt,et,0),ce.emplace(fe++,Be,Ke,rt,et,1),ce.emplace(fe++,Be,Ke,rt,et,2),ce.emplace(fe++,Be,Ke,rt,et,3)}(!zc||zc.length<2*V)&&(zc=function(ge){const Ie=2*ge,Fe=new l.aX;Fe.resize(Ie),Fe._trim();for(let Be=0;Be<Ie;Be++){const Ke=6*Be;Fe.uint16[Ke+0]=4*Be+0,Fe.uint16[Ke+1]=4*Be+1,Fe.uint16[Ke+2]=4*Be+2,Fe.uint16[Ke+3]=4*Be+2,Fe.uint16[Ke+4]=4*Be+3,Fe.uint16[Ke+5]=4*Be+0}return Fe}(V));const ae=A.createIndexBuffer(zc,!0),Pe=A.createVertexBuffer(ce,l.aW.members,!0);for(const ge of j){const Ie={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(Oe=v.transform).cameraToCenterDistance,u_viewport_size:[Oe.width,Oe.height]};ue.draw(A,k.TRIANGLES,On.disabled,gr.disabled,v.colorModeForRenderPass(),dr.disabled,Ie,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ge.coord),d.id,Pe,ae,l.S.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,v.transform.zoom,null,null,null)}var Oe;Pe.destroy(),ae.destroy()}dr.disabled=new dr(!1,1029,2305),dr.backCCW=new dr(!0,1029,2305);const df=l.ao(new Float32Array(16));function Qu(v,o,d,p,y,b){const{horizontalAlign:E,verticalAlign:A}=l.au(v);return new l.P((-(E-.5)*o/y+p[0])*b,(-(A-.5)*d/y+p[1])*b)}function eh(v,o,d,p,y,b,E,A,k,O,j){const V=v.text.placedSymbolArray,X=v.text.dynamicLayoutVertexArray,ue=v.icon.dynamicLayoutVertexArray,ce={};X.clear();for(let fe=0;fe<V.length;fe++){const ae=V.get(fe),Pe=ae.hidden||!ae.crossTileID||v.allowVerticalPlacement&&!ae.placedOrientation?null:p[ae.crossTileID];if(Pe){const Oe=new l.P(ae.anchorX,ae.anchorY),ge=qt(Oe,d?E:b,j),Ie=wn(y.cameraToCenterDistance,ge.signedDistanceFromCamera);let Fe=l.aj(v.textSizeData,k,ae)*Ie/l.ap;d&&(Fe*=v.tilePixelRatio/A);const{width:Be,height:Ke,anchor:rt,textOffset:et,textBoxScale:ct}=Pe,Ft=Qu(rt,Be,Ke,et,ct,Fe),Cn=d?qt(Oe.add(Ft),b,j).point:ge.point.add(o?Ft.rotate(-y.angle):Ft),gt=v.allowVerticalPlacement&&ae.placedOrientation===l.ai.vertical?Math.PI/2:0;for(let sn=0;sn<ae.numGlyphs;sn++)l.ak(X,Cn,gt);O&&ae.associatedIconIndex>=0&&(ce[ae.associatedIconIndex]={shiftedAnchor:Cn,angle:gt})}else ie(ae.numGlyphs,X)}if(O){ue.clear();const fe=v.icon.placedSymbolArray;for(let ae=0;ae<fe.length;ae++){const Pe=fe.get(ae);if(Pe.hidden)ie(Pe.numGlyphs,ue);else{const Oe=ce[ae];if(Oe)for(let ge=0;ge<Pe.numGlyphs;ge++)l.ak(ue,Oe.shiftedAnchor,Oe.angle);else ie(Pe.numGlyphs,ue)}}v.icon.dynamicLayoutVertexBuffer.updateData(ue)}v.text.dynamicLayoutVertexBuffer.updateData(X)}function ff(v,o,d){return d.iconsInText&&o?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function th(v,o,d,p,y,b,E,A,k,O,j,V){const X=v.context,ue=X.gl,ce=v.transform,fe=A==="map",ae=k==="map",Pe=A!=="viewport"&&d.layout.get("symbol-placement")!=="point",Oe=fe&&!ae&&!Pe,ge=!d.layout.get("symbol-sort-key").isConstant();let Ie=!1;const Fe=v.depthModeForSublayer(0,On.ReadOnly),Be=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ke=[];for(const rt of p){const et=o.getTile(rt),ct=et.getBucket(d);if(!ct)continue;const Ft=y?ct.text:ct.icon;if(!Ft||!Ft.segments.get().length||!Ft.hasVisibleVertices)continue;const Cn=Ft.programConfigurations.get(d.id),gt=y||ct.sdfIcons,sn=y?ct.textSizeData:ct.iconSizeData,jt=ae||ce.pitch!==0,Hn=v.useProgram(ff(gt,y,ct),Cn),En=l.ah(sn,ce.zoom),xn=v.style.map.terrain&&v.style.map.terrain.getTerrainData(rt);let An,Ar,er,pi,Jr=[0,0],Or=null;if(y)Ar=et.glyphAtlasTexture,er=ue.LINEAR,An=et.glyphAtlasTexture.size,ct.iconsInText&&(Jr=et.imageAtlasTexture.size,Or=et.imageAtlasTexture,pi=jt||v.options.rotating||v.options.zooming||sn.kind==="composite"||sn.kind==="camera"?ue.LINEAR:ue.NEAREST);else{const Ir=d.layout.get("icon-size").constantOr(0)!==1||ct.iconsNeedLinear;Ar=et.imageAtlasTexture,er=gt||v.options.rotating||v.options.zooming||Ir||jt?ue.LINEAR:ue.NEAREST,An=et.imageAtlasTexture.size}const ms=be(et,1,v.transform.zoom),or=$e(rt.posMatrix,ae,fe,v.transform,ms),yo=st(rt.posMatrix,ae,fe,v.transform,ms),_o=Be&&ct.hasTextData(),_a=d.layout.get("icon-text-fit")!=="none"&&_o&&ct.hasIconData();if(Pe){const Ir=v.style.map.terrain?(Zi,kr)=>v.style.map.terrain.getElevation(rt,Zi,kr):null,Qr=d.layout.get("text-rotation-alignment")==="map";tt(ct,rt.posMatrix,v,y,or,yo,ae,O,Qr,Ir)}const qa=v.translatePosMatrix(rt.posMatrix,et,b,E),Nl=Pe||y&&Be||_a?df:or,wi=v.translatePosMatrix(yo,et,b,E,!0),mi=gt&&d.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Li;Li=gt?ct.iconsInText?ja(sn.kind,En,Oe,ae,v,qa,Nl,wi,An,Jr):ef(sn.kind,En,Oe,ae,v,qa,Nl,wi,y,An,!0):Qd(sn.kind,En,Oe,ae,v,qa,Nl,wi,y,An);const Za={program:Hn,buffers:Ft,uniformValues:Li,atlasTexture:Ar,atlasTextureIcon:Or,atlasInterpolation:er,atlasInterpolationIcon:pi,isSDF:gt,hasHalo:mi};if(ge&&ct.canOverlap){Ie=!0;const Ir=Ft.segments.get();for(const Qr of Ir)Ke.push({segments:new l.S([Qr]),sortKey:Qr.sortKey,state:Za,terrainData:xn})}else Ke.push({segments:Ft.segments,sortKey:0,state:Za,terrainData:xn})}Ie&&Ke.sort((rt,et)=>rt.sortKey-et.sortKey);for(const rt of Ke){const et=rt.state;if(X.activeTexture.set(ue.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,ue.CLAMP_TO_EDGE),et.atlasTextureIcon&&(X.activeTexture.set(ue.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,ue.CLAMP_TO_EDGE)),et.isSDF){const ct=et.uniformValues;et.hasHalo&&(ct.u_is_halo=1,pf(et.buffers,rt.segments,d,v,et.program,Fe,j,V,ct,rt.terrainData)),ct.u_is_halo=0}pf(et.buffers,rt.segments,d,v,et.program,Fe,j,V,et.uniformValues,rt.terrainData)}}function pf(v,o,d,p,y,b,E,A,k,O){const j=p.context;y.draw(j,j.gl.TRIANGLES,b,E,A,dr.disabled,k,O,d.id,v.layoutVertexBuffer,v.indexBuffer,o,d.paint,p.transform.zoom,v.programConfigurations.get(d.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Dc(v,o,d,p,y){if(!d||!p||!p.imageAtlas)return;const b=p.imageAtlas.patternPositions;let E=b[d.to.toString()],A=b[d.from.toString()];if(!E&&A&&(E=A),!A&&E&&(A=E),!E||!A){const k=y.getPaintProperty(o);E=b[k],A=b[k]}E&&A&&v.setConstantPatternPositions(E,A)}function Fc(v,o,d,p,y,b,E){const A=v.context.gl,k="fill-pattern",O=d.paint.get(k),j=O&&O.constantOr(1),V=d.getCrossfadeParameters();let X,ue,ce,fe,ae;E?(ue=j&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=A.LINES):(ue=j?"fillPattern":"fill",X=A.TRIANGLES);const Pe=O.constantOr(null);for(const Oe of p){const ge=o.getTile(Oe);if(j&&!ge.patternsLoaded())continue;const Ie=ge.getBucket(d);if(!Ie)continue;const Fe=Ie.programConfigurations.get(d.id),Be=v.useProgram(ue,Fe),Ke=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Oe);j&&(v.context.activeTexture.set(A.TEXTURE0),ge.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Fe.updatePaintBuffers(V)),Dc(Fe,k,Pe,ge,d);const rt=Ke?Oe:null,et=v.translatePosMatrix(rt?rt.posMatrix:Oe.posMatrix,ge,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(E){fe=Ie.indexBuffer2,ae=Ie.segments2;const ct=[A.drawingBufferWidth,A.drawingBufferHeight];ce=ue==="fillOutlinePattern"&&j?ee(et,v,V,ge,ct):Cl(et,ct)}else fe=Ie.indexBuffer,ae=Ie.segments,ce=j?Rc(et,v,V,ge):Lc(et);Be.draw(v.context,X,y,v.stencilModeForClipping(Oe),b,dr.disabled,ce,Ke,d.id,Ie.layoutVertexBuffer,fe,ae,d.paint,v.transform.zoom,Fe)}}function Nc(v,o,d,p,y,b,E){const A=v.context,k=A.gl,O="fill-extrusion-pattern",j=d.paint.get(O),V=j.constantOr(1),X=d.getCrossfadeParameters(),ue=d.paint.get("fill-extrusion-opacity"),ce=j.constantOr(null);for(const fe of p){const ae=o.getTile(fe),Pe=ae.getBucket(d);if(!Pe)continue;const Oe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(fe),ge=Pe.programConfigurations.get(d.id),Ie=v.useProgram(V?"fillExtrusionPattern":"fillExtrusion",ge);V&&(v.context.activeTexture.set(k.TEXTURE0),ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ge.updatePaintBuffers(X)),Dc(ge,O,ce,ae,d);const Fe=v.translatePosMatrix(fe.posMatrix,ae,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Be=d.paint.get("fill-extrusion-vertical-gradient"),Ke=V?Cs(Fe,v,Be,ue,fe,X,ae):Pl(Fe,v,Be,ue);Ie.draw(A,A.gl.TRIANGLES,y,b,E,dr.backCCW,Ke,Oe,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,v.transform.zoom,ge,v.style.map.terrain&&Pe.centroidVertexBuffer)}}function qv(v,o,d,p,y,b,E){const A=v.context,k=A.gl,O=d.fbo;if(!O)return;const j=v.useProgram("hillshade"),V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(o);A.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get()),j.draw(A,k.TRIANGLES,y,b,E,dr.disabled,((X,ue,ce,fe)=>{const ae=ce.paint.get("hillshade-shadow-color"),Pe=ce.paint.get("hillshade-highlight-color"),Oe=ce.paint.get("hillshade-accent-color");let ge=ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);ce.paint.get("hillshade-illumination-anchor")==="viewport"&&(ge-=X.transform.angle);const Ie=!X.options.moving;return{u_matrix:fe?fe.posMatrix:X.transform.calculatePosMatrix(ue.tileID.toUnwrapped(),Ie),u_image:0,u_latrange:Tn(0,ue.tileID),u_light:[ce.paint.get("hillshade-exaggeration"),ge],u_shadow:ae,u_highlight:Pe,u_accent:Oe}})(v,d,p,V?o:null),V,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function mf(v,o,d,p,y,b){const E=v.context,A=E.gl,k=o.dem;if(k&&k.data){const O=k.dim,j=k.stride,V=k.getPixels();if(E.activeTexture.set(A.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||v.getTileTexture(j),o.demTexture){const ue=o.demTexture;ue.update(V,{premultiply:!1}),ue.bind(A.NEAREST,A.CLAMP_TO_EDGE)}else o.demTexture=new _e(E,V,A.RGBA,{premultiply:!1}),o.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);E.activeTexture.set(A.TEXTURE0);let X=o.fbo;if(!X){const ue=new _e(E,{width:O,height:O,data:null},A.RGBA);ue.bind(A.LINEAR,A.CLAMP_TO_EDGE),X=o.fbo=E.createFramebuffer(O,O,!0,!1),X.colorAttachment.set(ue.texture)}E.bindFramebuffer.set(X.framebuffer),E.viewport.set([0,0,O,O]),v.useProgram("hillshadePrepare").draw(E,A.TRIANGLES,p,y,b,dr.disabled,((ue,ce)=>{const fe=ce.stride,ae=l.Z();return l.aS(ae,0,l.N,-l.N,0,0,1),l.$(ae,ae,[0,-l.N,0]),{u_matrix:ae,u_image:1,u_dimension:[fe,fe],u_zoom:ue.overscaledZ,u_unpack:ce.getUnpackVector()}})(o.tileID,k),null,d.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Zv(v,o,d,p,y,b){const E=p.paint.get("raster-fade-duration");if(!b&&E>0){const A=l.h.now(),k=(A-v.timeAdded)/E,O=o?(A-o.timeAdded)/E:-1,j=d.getSource(),V=y.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),X=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(v.tileID.overscaledZ-V),ue=X&&v.refreshedUponExpiration?1:l.ad(X?k:1-O,0,1);return v.refreshedUponExpiration&&k>=1&&(v.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ue}:{opacity:ue,mix:0}}return{opacity:1,mix:0}}const mg=new l.aT(1,0,0,1),nh=new l.aT(0,1,0,1),gf=new l.aT(0,0,1,1),gg=new l.aT(1,0,1,1),yg=new l.aT(0,1,1,1);function Bc(v,o,d,p){ih(v,0,o+d/2,v.transform.width,d,p)}function rh(v,o,d,p){ih(v,o-d/2,0,d,v.transform.height,p)}function ih(v,o,d,p,y,b){const E=v.context,A=E.gl;A.enable(A.SCISSOR_TEST),A.scissor(o*v.pixelRatio,d*v.pixelRatio,p*v.pixelRatio,y*v.pixelRatio),E.clear({color:b}),A.disable(A.SCISSOR_TEST)}function _g(v,o,d){const p=v.context,y=p.gl,b=d.posMatrix,E=v.useProgram("debug"),A=On.disabled,k=gr.disabled,O=v.colorModeForRenderPass(),j="$debug",V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(d);p.activeTexture.set(y.TEXTURE0);const X=o.getTileByID(d.key).latestRawTileData,ue=Math.floor((X&&X.byteLength||0)/1024),ce=o.getTile(d).tileSize,fe=512/Math.min(ce,512)*(d.overscaledZ/v.transform.zoom)*.5;let ae=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(ae+=` => ${d.overscaledZ}`),function(Pe,Oe){Pe.initDebugOverlayCanvas();const ge=Pe.debugOverlayCanvas,Ie=Pe.context.gl,Fe=Pe.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,ge.width,ge.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(Oe,5,5),Fe.strokeText(Oe,5,5),Pe.debugOverlayTexture.update(ge),Pe.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(v,`${ae} ${ue}kB`),E.draw(p,y.TRIANGLES,A,k,mr.alphaBlended,dr.disabled,Ne(b,l.aT.transparent,fe),null,j,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),E.draw(p,y.LINE_STRIP,A,k,O,dr.disabled,Ne(b,l.aT.red),V,j,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function xr(v,o,d){const p=v.context,y=p.gl,b=v.colorModeForRenderPass(),E=new On(y.LEQUAL,On.ReadWrite,v.depthRangeFor3D),A=v.useProgram("terrain"),k=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const O of d){const j=v.renderToTexture.getTexture(O),V=o.getTerrainData(O.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,j.texture);const X={u_matrix:v.transform.calculatePosMatrix(O.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(v.transform.zoom)};A.draw(p,y.TRIANGLES,E,gr.disabled,b,dr.backCCW,X,V,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class $a{constructor(o,d){this.context=new Hv(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.Z(),renderTime:0},this.setup(),this.numSublayers=Ct.maxUnderzooming+Ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ki}resize(o,d,p){if(this.width=Math.floor(o*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const o=this.context,d=new l.a_;d.emplaceBack(0,0),d.emplaceBack(l.N,0),d.emplaceBack(0,l.N),d.emplaceBack(l.N,l.N),this.tileExtentBuffer=o.createVertexBuffer(d,Go.members),this.tileExtentSegments=l.S.simpleSegment(0,0,4,2);const p=new l.a_;p.emplaceBack(0,0),p.emplaceBack(l.N,0),p.emplaceBack(0,l.N),p.emplaceBack(l.N,l.N),this.debugBuffer=o.createVertexBuffer(p,Go.members),this.debugSegments=l.S.simpleSegment(0,0,4,5);const y=new l.V;y.emplaceBack(0,0,0,0),y.emplaceBack(l.N,0,l.N,0),y.emplaceBack(0,l.N,0,l.N),y.emplaceBack(l.N,l.N,l.N,l.N),this.rasterBoundsBuffer=o.createVertexBuffer(y,Et.members),this.rasterBoundsSegments=l.S.simpleSegment(0,0,4,2);const b=new l.a_;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,Go.members),this.viewportSegments=l.S.simpleSegment(0,0,4,2);const E=new l.a$;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(E);const A=new l.b0;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(A);const k=this.context.gl;this.stencilClearMode=new gr({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.Z();l.aS(p,0,this.width,this.height,0,0,1),l.a0(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,d.TRIANGLES,On.disabled,this.stencilClearMode,mr.disabled,dr.disabled,at(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source;const p=this.context,y=p.gl;this.nextStencilID+d.length>256&&this.clearStencil(),p.setColorMode(mr.disabled),p.setDepthMode(On.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of d){const A=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);b.draw(p,y.TRIANGLES,On.disabled,new gr({func:y.ALWAYS,mask:0},A,255,y.KEEP,y.KEEP,y.REPLACE),mr.disabled,dr.disabled,at(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new gr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new gr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,p=o.sort((E,A)=>A.overscaledZ-E.overscaledZ),y=p[p.length-1].overscaledZ,b=p[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const E={};for(let A=0;A<b;A++)E[A+y]=new gr({func:d.GEQUAL,mask:255},A+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[E,p]}return[{[y]:gr.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new mr([o.CONSTANT_COLOR,o.ONE],new l.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(o,d,p){if(!this.opaquePassEnabledForLayer())return On.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new On(p||this.context.gl.LEQUAL,d,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(l.h.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,b={},E={},A={};for(const k in y){const O=y[k];O.used&&O.prepare(this.context),b[k]=O.getVisibleCoordinates(),E[k]=b[k].slice().reverse(),A[k]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<p.length;k++)if(this.style._layers[p[k]].is3D()){this.opaquePassCutoff=k;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const k=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(l.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(O,j){const V=O.context,X=V.gl,ue=mr.unblended,ce=new On(X.LEQUAL,On.ReadWrite,[0,1]),fe=j.getTerrainMesh(),ae=j.sourceCache.getRenderableTiles(),Pe=O.useProgram("terrainDepth");V.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),V.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),V.clear({color:l.aT.transparent,depth:1});for(const Oe of ae){const ge=j.getTerrainData(Oe.tileID),Ie={u_matrix:O.transform.calculatePosMatrix(Oe.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(O.transform.zoom)};Pe.draw(V,X.TRIANGLES,ce,gr.disabled,ue,dr.backCCW,Ie,ge,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments)}V.bindFramebuffer.set(null),V.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain),function(O,j){const V=O.context,X=V.gl,ue=mr.unblended,ce=new On(X.LEQUAL,On.ReadWrite,[0,1]),fe=j.getTerrainMesh(),ae=j.getCoordsTexture(),Pe=j.sourceCache.getRenderableTiles(),Oe=O.useProgram("terrainCoords");V.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),V.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),V.clear({color:l.aT.transparent,depth:1}),j.coordsIndex=[];for(const ge of Pe){const Ie=j.getTerrainData(ge.tileID);V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,ae.texture);const Fe={u_matrix:O.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(O.transform.zoom)};Oe.draw(V,X.TRIANGLES,ce,gr.disabled,ue,dr.backCCW,Fe,Ie,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments),j.coordsIndex.push(ge.tileID.key)}V.bindFramebuffer.set(null),V.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const k of p){const O=this.style._layers[k];if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const j=E[O.source];(O.type==="custom"||j.length)&&this.renderLayer(this,y[O.source],O,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?l.aT.black:l.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[p[this.currentLayer]],O=y[k.source],j=b[k.source];this._renderTileClippingMasks(k,j),this.renderLayer(this,O,k,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const k=this.style._layers[p[this.currentLayer]],O=y[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const j=(k.type==="symbol"?A:E)[k.source];this._renderTileClippingMasks(k,b[k.source]),this.renderLayer(this,O,k,j)}if(this.options.showTileBoundaries){const k=function(O,j){let V=null;const X=Object.values(O._layers).flatMap(ae=>ae.source&&!ae.isHidden(j)?[O.sourceCaches[ae.source]]:[]),ue=X.filter(ae=>ae.getSource().type==="vector"),ce=X.filter(ae=>ae.getSource().type!=="vector"),fe=ae=>{(!V||V.getSource().maxzoom<ae.getSource().maxzoom)&&(V=ae)};return ue.forEach(ae=>fe(ae)),V||ce.forEach(ae=>fe(ae)),V}(this.style,this.transform.zoom);k&&function(O,j,V){for(let X=0;X<V.length;X++)_g(O,j,V[X])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const O=k.transform.padding;Bc(k,k.transform.height-(O.top||0),3,mg),Bc(k,O.bottom||0,3,nh),rh(k,O.left||0,3,gf),rh(k,k.transform.width-(O.right||0),3,gg);const j=k.transform.centerPoint;(function(V,X,ue,ce){ih(V,X-1,ue-10,2,20,ce),ih(V,X-10,ue-1,20,2,ce)})(k,j.x,k.transform.height-j.y,yg)}(this),this.context.setDefault()}renderLayer(o,d,p,y){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(y||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,E,A,k,O){if(b.renderPass!=="translucent")return;const j=gr.disabled,V=b.colorModeForRenderPass();(A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(X,ue,ce,fe,ae,Pe,Oe){const ge=ue.transform,Ie=ae==="map",Fe=Pe==="map";for(const Be of X){const Ke=fe.getTile(Be),rt=Ke.getBucket(ce);if(!rt||!rt.text||!rt.text.segments.get().length)continue;const et=l.ah(rt.textSizeData,ge.zoom),ct=be(Ke,1,ue.transform.zoom),Ft=$e(Be.posMatrix,Fe,Ie,ue.transform,ct),Cn=ce.layout.get("icon-text-fit")!=="none"&&rt.hasIconData();if(et){const gt=Math.pow(2,ge.zoom-Ke.tileID.overscaledZ);eh(rt,Ie,Fe,Oe,ge,Ft,Be.posMatrix,gt,et,Cn,ue.style.map.terrain?(sn,jt)=>ue.style.map.terrain.getElevation(Be,sn,jt):null)}}}(k,b,A,E,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),O),A.paint.get("icon-opacity").constantOr(1)!==0&&th(b,E,A,k,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),j,V),A.paint.get("text-opacity").constantOr(1)!==0&&th(b,E,A,k,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),j,V),E.map.showCollisionBoxes&&(pg(b,E,A,k,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),!0),pg(b,E,A,k,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),!1))})(o,d,p,y,this.style.placement.variableOffsets);break;case"circle":(function(b,E,A,k){if(b.renderPass!=="translucent")return;const O=A.paint.get("circle-opacity"),j=A.paint.get("circle-stroke-width"),V=A.paint.get("circle-stroke-opacity"),X=!A.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&(j.constantOr(1)===0||V.constantOr(1)===0))return;const ue=b.context,ce=ue.gl,fe=b.depthModeForSublayer(0,On.ReadOnly),ae=gr.disabled,Pe=b.colorModeForRenderPass(),Oe=[];for(let ge=0;ge<k.length;ge++){const Ie=k[ge],Fe=E.getTile(Ie),Be=Fe.getBucket(A);if(!Be)continue;const Ke=Be.programConfigurations.get(A.id),rt=b.useProgram("circle",Ke),et=Be.layoutVertexBuffer,ct=Be.indexBuffer,Ft=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),Cn={programConfiguration:Ke,program:rt,layoutVertexBuffer:et,indexBuffer:ct,uniformValues:oe(b,Ie,Fe,A),terrainData:Ft};if(X){const gt=Be.segments.get();for(const sn of gt)Oe.push({segments:new l.S([sn]),sortKey:sn.sortKey,state:Cn})}else Oe.push({segments:Be.segments,sortKey:0,state:Cn})}X&&Oe.sort((ge,Ie)=>ge.sortKey-Ie.sortKey);for(const ge of Oe){const{programConfiguration:Ie,program:Fe,layoutVertexBuffer:Be,indexBuffer:Ke,uniformValues:rt,terrainData:et}=ge.state;Fe.draw(ue,ce.TRIANGLES,fe,ae,Pe,dr.disabled,rt,et,A.id,Be,Ke,ge.segments,A.paint,b.transform.zoom,Ie)}})(o,d,p,y);break;case"heatmap":(function(b,E,A,k){if(A.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const O=b.context,j=O.gl,V=gr.disabled,X=new mr([j.ONE,j.ONE],l.aT.transparent,[!0,!0,!0,!0]);(function(ue,ce,fe){const ae=ue.gl;ue.activeTexture.set(ae.TEXTURE1),ue.viewport.set([0,0,ce.width/4,ce.height/4]);let Pe=fe.heatmapFbo;if(Pe)ae.bindTexture(ae.TEXTURE_2D,Pe.colorAttachment.get()),ue.bindFramebuffer.set(Pe.framebuffer);else{const Oe=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Oe),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),Pe=fe.heatmapFbo=ue.createFramebuffer(ce.width/4,ce.height/4,!1,!1),function(ge,Ie,Fe,Be){var Ke,rt;const et=ge.gl,ct=(Ke=ge.HALF_FLOAT)!==null&&Ke!==void 0?Ke:et.UNSIGNED_BYTE,Ft=(rt=ge.RGBA16F)!==null&&rt!==void 0?rt:et.RGBA;et.texImage2D(et.TEXTURE_2D,0,Ft,Ie.width/4,Ie.height/4,0,et.RGBA,ct,null),Be.colorAttachment.set(Fe)}(ue,ce,Oe,Pe)}})(O,b,A),O.clear({color:l.aT.transparent});for(let ue=0;ue<k.length;ue++){const ce=k[ue];if(E.hasRenderableParent(ce))continue;const fe=E.getTile(ce),ae=fe.getBucket(A);if(!ae)continue;const Pe=ae.programConfigurations.get(A.id),Oe=b.useProgram("heatmap",Pe),{zoom:ge}=b.transform;Oe.draw(O,j.TRIANGLES,On.disabled,V,X,dr.disabled,zt(ce.posMatrix,fe,ge,A.paint.get("heatmap-intensity")),null,A.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,A.paint,b.transform.zoom,Pe)}O.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(O,j){const V=O.context,X=V.gl,ue=j.heatmapFbo;if(!ue)return;V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,ue.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1);let ce=j.colorRampTexture;ce||(ce=j.colorRampTexture=new _e(V,j.colorRamp,X.RGBA)),ce.bind(X.LINEAR,X.CLAMP_TO_EDGE),O.useProgram("heatmapTexture").draw(V,X.TRIANGLES,On.disabled,gr.disabled,O.colorModeForRenderPass(),dr.disabled,((fe,ae,Pe,Oe)=>{const ge=l.Z();l.aS(ge,0,fe.width,fe.height,0,0,1);const Ie=fe.context.gl;return{u_matrix:ge,u_world:[Ie.drawingBufferWidth,Ie.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ae.paint.get("heatmap-opacity")}})(O,j),null,j.id,O.viewportBuffer,O.quadTriangleIndexBuffer,O.viewportSegments,j.paint,O.transform.zoom)}(b,A))})(o,d,p,y);break;case"line":(function(b,E,A,k){if(b.renderPass!=="translucent")return;const O=A.paint.get("line-opacity"),j=A.paint.get("line-width");if(O.constantOr(1)===0||j.constantOr(1)===0)return;const V=b.depthModeForSublayer(0,On.ReadOnly),X=b.colorModeForRenderPass(),ue=A.paint.get("line-dasharray"),ce=A.paint.get("line-pattern"),fe=ce.constantOr(1),ae=A.paint.get("line-gradient"),Pe=A.getCrossfadeParameters(),Oe=fe?"linePattern":ue?"lineSDF":ae?"lineGradient":"line",ge=b.context,Ie=ge.gl;let Fe=!0;for(const Be of k){const Ke=E.getTile(Be);if(fe&&!Ke.patternsLoaded())continue;const rt=Ke.getBucket(A);if(!rt)continue;const et=rt.programConfigurations.get(A.id),ct=b.context.program.get(),Ft=b.useProgram(Oe,et),Cn=Fe||Ft.program!==ct,gt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Be),sn=ce.constantOr(null);if(sn&&Ke.imageAtlas){const En=Ke.imageAtlas,xn=En.patternPositions[sn.to.toString()],An=En.patternPositions[sn.from.toString()];xn&&An&&et.setConstantPatternPositions(xn,An)}const jt=gt?Be:null,Hn=fe?fi(b,Ke,A,Pe,jt):ue?us(b,Ke,A,ue,Pe,jt):ae?Ur(b,Ke,A,rt.lineClipsArray.length,jt):Cr(b,Ke,A,jt);if(fe)ge.activeTexture.set(Ie.TEXTURE0),Ke.imageAtlasTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),et.updatePaintBuffers(Pe);else if(ue&&(Cn||b.lineAtlas.dirty))ge.activeTexture.set(Ie.TEXTURE0),b.lineAtlas.bind(ge);else if(ae){const En=rt.gradients[A.id];let xn=En.texture;if(A.gradientVersion!==En.version){let An=256;if(A.stepInterpolant){const Ar=E.getSource().maxzoom,er=Be.canonical.z===Ar?Math.ceil(1<<b.transform.maxZoom-Be.canonical.z):1;An=l.ad(l.aY(rt.maxLineLength/l.N*1024*er),256,ge.maxTextureSize)}En.gradient=l.aZ({expression:A.gradientExpression(),evaluationKey:"lineProgress",resolution:An,image:En.gradient||void 0,clips:rt.lineClipsArray}),En.texture?En.texture.update(En.gradient):En.texture=new _e(ge,En.gradient,Ie.RGBA),En.version=A.gradientVersion,xn=En.texture}ge.activeTexture.set(Ie.TEXTURE0),xn.bind(A.stepInterpolant?Ie.NEAREST:Ie.LINEAR,Ie.CLAMP_TO_EDGE)}Ft.draw(ge,Ie.TRIANGLES,V,b.stencilModeForClipping(Be),X,dr.disabled,Hn,gt,A.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,A.paint,b.transform.zoom,et,rt.layoutVertexBuffer2),Fe=!1}})(o,d,p,y);break;case"fill":(function(b,E,A,k){const O=A.paint.get("fill-color"),j=A.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const V=b.colorModeForRenderPass(),X=A.paint.get("fill-pattern"),ue=b.opaquePassEnabledForLayer()&&!X.constantOr(1)&&O.constantOr(l.aT.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===ue){const ce=b.depthModeForSublayer(1,b.renderPass==="opaque"?On.ReadWrite:On.ReadOnly);Fc(b,E,A,k,ce,V,!1)}if(b.renderPass==="translucent"&&A.paint.get("fill-antialias")){const ce=b.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,On.ReadOnly);Fc(b,E,A,k,ce,V,!0)}})(o,d,p,y);break;case"fill-extrusion":(function(b,E,A,k){const O=A.paint.get("fill-extrusion-opacity");if(O!==0&&b.renderPass==="translucent"){const j=new On(b.context.gl.LEQUAL,On.ReadWrite,b.depthRangeFor3D);if(O!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))Nc(b,E,A,k,j,gr.disabled,mr.disabled),Nc(b,E,A,k,j,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const V=b.colorModeForRenderPass();Nc(b,E,A,k,j,gr.disabled,V)}}})(o,d,p,y);break;case"hillshade":(function(b,E,A,k){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const O=b.context,j=b.depthModeForSublayer(0,On.ReadOnly),V=b.colorModeForRenderPass(),[X,ue]=b.renderPass==="translucent"?b.stencilConfigForOverlap(k):[{},k];for(const ce of ue){const fe=E.getTile(ce);fe.needsHillshadePrepare!==void 0&&fe.needsHillshadePrepare&&b.renderPass==="offscreen"?mf(b,fe,A,j,gr.disabled,V):b.renderPass==="translucent"&&qv(b,ce,fe,A,j,X[ce.overscaledZ],V)}O.viewport.set([0,0,b.width,b.height])})(o,d,p,y);break;case"raster":(function(b,E,A,k){if(b.renderPass!=="translucent"||A.paint.get("raster-opacity")===0||!k.length)return;const O=b.context,j=O.gl,V=E.getSource(),X=b.useProgram("raster"),ue=b.colorModeForRenderPass(),[ce,fe]=V instanceof cn?[{},k]:b.stencilConfigForOverlap(k),ae=fe[fe.length-1].overscaledZ,Pe=!b.options.moving;for(const Oe of fe){const ge=b.depthModeForSublayer(Oe.overscaledZ-ae,A.paint.get("raster-opacity")===1?On.ReadWrite:On.ReadOnly,j.LESS),Ie=E.getTile(Oe);Ie.registerFadeDuration(A.paint.get("raster-fade-duration"));const Fe=E.findLoadedParent(Oe,0),Be=Zv(Ie,Fe,E,A,b.transform,b.style.map.terrain);let Ke,rt;const et=A.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;O.activeTexture.set(j.TEXTURE0),Ie.texture.bind(et,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(j.TEXTURE1),Fe?(Fe.texture.bind(et,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ke=Math.pow(2,Fe.tileID.overscaledZ-Ie.tileID.overscaledZ),rt=[Ie.tileID.canonical.x*Ke%1,Ie.tileID.canonical.y*Ke%1]):Ie.texture.bind(et,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe),Ft=ct?Oe:null,Cn=Ft?Ft.posMatrix:b.transform.calculatePosMatrix(Oe.toUnwrapped(),Pe),gt=og(Cn,rt||[0,0],Ke||1,Be,A);V instanceof cn?X.draw(O,j.TRIANGLES,ge,gr.disabled,ue,dr.disabled,gt,ct,A.id,V.boundsBuffer,b.quadTriangleIndexBuffer,V.boundsSegments):X.draw(O,j.TRIANGLES,ge,ce[Oe.overscaledZ],ue,dr.disabled,gt,ct,A.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(o,d,p,y);break;case"background":(function(b,E,A,k){const O=A.paint.get("background-color"),j=A.paint.get("background-opacity");if(j===0)return;const V=b.context,X=V.gl,ue=b.transform,ce=ue.tileSize,fe=A.paint.get("background-pattern");if(b.isPatternMissing(fe))return;const ae=!fe&&O.a===1&&j===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ae)return;const Pe=gr.disabled,Oe=b.depthModeForSublayer(0,ae==="opaque"?On.ReadWrite:On.ReadOnly),ge=b.colorModeForRenderPass(),Ie=b.useProgram(fe?"backgroundPattern":"background"),Fe=k||ue.coveringTiles({tileSize:ce,terrain:b.style.map.terrain});fe&&(V.activeTexture.set(X.TEXTURE0),b.imageManager.bind(b.context));const Be=A.getCrossfadeParameters();for(const Ke of Fe){const rt=k?Ke.posMatrix:b.transform.calculatePosMatrix(Ke.toUnwrapped()),et=fe?As(rt,j,b,fe,{tileID:Ke,tileSize:ce},Be):$u(rt,j,O),ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ke);Ie.draw(V,X.TRIANGLES,Oe,Pe,ge,dr.disabled,et,ct,A.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(o,0,p,y);break;case"custom":(function(b,E,A){const k=b.context,O=A.implementation;if(b.renderPass==="offscreen"){const j=O.prerender;j&&(b.setCustomLayerDefaults(),k.setColorMode(b.colorModeForRenderPass()),j.call(O,k.gl,b.transform.customLayerMatrix()),k.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),k.setColorMode(b.colorModeForRenderPass()),k.setStencilMode(gr.disabled);const j=O.renderingMode==="3d"?new On(b.context.gl.LEQUAL,On.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,On.ReadOnly);k.setDepthMode(j),O.render(k.gl,b.transform.customLayerMatrix()),k.setDirty(),b.setBaseState(),k.bindFramebuffer.set(null)}})(o,0,p)}}translatePosMatrix(o,d,p,y,b){if(!p[0]&&!p[1])return o;const E=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(E){const O=Math.sin(E),j=Math.cos(E);p=[p[0]*j-p[1]*O,p[0]*O+p[1]*j]}const A=[b?p[0]:be(d,p[0],this.transform.zoom),b?p[1]:be(d,p[1],this.transform.zoom),0],k=new Float32Array(16);return l.$(k,o,A),k}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!d||!p}useProgram(o,d){this.cache=this.cache||{};const p=o+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Gi(this.context,Jn[o],d,Gu[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _e(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}class Hi{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,p){const y=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const k=1/(A=l.ag([],A,o))[3]/d*y;return l.b3(A,A,[k,k,1/A[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const k=function(X,ue){var ce=ue[0],fe=ue[1],ae=ue[2],Pe=ce*ce+fe*fe+ae*ae;return Pe>0&&(Pe=1/Math.sqrt(Pe)),X[0]=ue[0]*Pe,X[1]=ue[1]*Pe,X[2]=ue[2]*Pe,X}([],function(X,ue,ce){var fe=ue[0],ae=ue[1],Pe=ue[2],Oe=ce[0],ge=ce[1],Ie=ce[2];return X[0]=ae*Ie-Pe*ge,X[1]=Pe*Oe-fe*Ie,X[2]=fe*ge-ae*Oe,X}([],ne([],b[A[0]],b[A[1]]),ne([],b[A[2]],b[A[1]]))),O=-((j=k)[0]*(V=b[A[1]])[0]+j[1]*V[1]+j[2]*V[2]);var j,V;return k.concat(O)});return new Hi(b,E)}}class Ll{constructor(o,d){this.min=o,this.max=d,this.center=function(p,y,b){return p[0]=.5*y[0],p[1]=.5*y[1],p[2]=.5*y[2],p}([],function(p,y,b){return p[0]=y[0]+b[0],p[1]=y[1]+b[1],p[2]=y[2]+b[2],p}([],this.min,this.max))}quadrant(o){const d=[o%2==0,o<2],p=$(this.min),y=$(this.max);for(let b=0;b<d.length;b++)p[b]=d[b]?this.min[b]:this.center[b],y[b]=d[b]?this.center[b]:this.max[b];return y[2]=this.max[2],new Ll(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<o.planes.length;y++){const b=o.planes[y];let E=0;for(let A=0;A<d.length;A++)l.b4(b,d[A])>=0&&E++;if(E===0)return 0;E!==d.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let b=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let A=0;A<o.points.length;A++){const k=o.points[A][y]-this.min[y];b=Math.min(b,k),E=Math.max(E,k)}if(E<0||b>this.max[y]-this.min[y])return 0}return 1}}class jc{constructor(o=0,d=0,p=0,y=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=p,this.right=y}interpolate(o,d,p){return d.top!=null&&o.top!=null&&(this.top=l.B.number(o.top,d.top,p)),d.bottom!=null&&o.bottom!=null&&(this.bottom=l.B.number(o.bottom,d.bottom,p)),d.left!=null&&o.left!=null&&(this.left=l.B.number(o.left,d.left,p)),d.right!=null&&o.right!=null&&(this.right=l.B.number(o.right,d.right,p)),this}getCenter(o,d){const p=l.ad((this.left+o-this.right)/2,0,o),y=l.ad((this.top+d-this.bottom)/2,0,d);return new l.P(p,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new jc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class sh{constructor(o,d,p,y,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=b===void 0||!!b,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new jc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new sh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-l.b5(o,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var p=new l.A(4);return l.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,y,b){var E=y[0],A=y[1],k=y[2],O=y[3],j=Math.sin(b),V=Math.cos(b);p[0]=E*V+k*j,p[1]=A*V+O*j,p[2]=E*-j+k*V,p[3]=A*-j+O*V}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=l.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,p){this._unmodified=!1,this._edgeInsets.interpolate(o,d,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new l.b6(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new l.P(0,0)),y=this.pointCoordinate(new l.P(this.width,0)),b=this.pointCoordinate(new l.P(this.width,this.height)),E=this.pointCoordinate(new l.P(0,this.height)),A=Math.floor(Math.min(p.x,y.x,b.x,E.x)),k=Math.floor(Math.max(p.x,y.x,b.x,E.x)),O=1;for(let j=A-O;j<=k+O;j++)j!==0&&d.push(new l.b6(j,o))}return d}coveringTiles(o){var d,p;let y=this.coveringZoomLevel(o);const b=y;if(o.minzoom!==void 0&&y<o.minzoom)return[];o.maxzoom!==void 0&&y>o.maxzoom&&(y=o.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),A=l.U.fromLngLat(this.center),k=Math.pow(2,y),O=[k*E.x,k*E.y,0],j=[k*A.x,k*A.y,0],V=Hi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let X=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(X=y);const ue=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,ce=ge=>({aabb:new Ll([ge*k,0,0],[(ge+1)*k,k,0]),zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),fe=[],ae=[],Pe=y,Oe=o.reparseOverscaled?b:y;if(this._renderWorldCopies)for(let ge=1;ge<=3;ge++)fe.push(ce(-ge)),fe.push(ce(ge));for(fe.push(ce(0));fe.length>0;){const ge=fe.pop(),Ie=ge.x,Fe=ge.y;let Be=ge.fullyVisible;if(!Be){const Ft=ge.aabb.intersects(V);if(Ft===0)continue;Be=Ft===2}const Ke=o.terrain?O:j,rt=ge.aabb.distanceX(Ke),et=ge.aabb.distanceY(Ke),ct=Math.max(Math.abs(rt),Math.abs(et));if(ge.zoom===Pe||ct>ue+(1<<Pe-ge.zoom)-2&&ge.zoom>=X){const Ft=Pe-ge.zoom,Cn=O[0]-.5-(Ie<<Ft),gt=O[1]-.5-(Fe<<Ft);ae.push({tileID:new l.O(ge.zoom===Pe?Oe:ge.zoom,ge.wrap,ge.zoom,Ie,Fe),distanceSq:se([j[0]-.5-Ie,j[1]-.5-Fe]),tileDistanceToCamera:Math.sqrt(Cn*Cn+gt*gt)})}else for(let Ft=0;Ft<4;Ft++){const Cn=(Ie<<1)+Ft%2,gt=(Fe<<1)+(Ft>>1),sn=ge.zoom+1;let jt=ge.aabb.quadrant(Ft);if(o.terrain){const Hn=new l.O(sn,ge.wrap,sn,Cn,gt),En=o.terrain.getMinMaxElevation(Hn),xn=(d=En.minElevation)!==null&&d!==void 0?d:this.elevation,An=(p=En.maxElevation)!==null&&p!==void 0?p:this.elevation;jt=new Ll([jt.min[0],jt.min[1],xn],[jt.max[0],jt.max[1],An])}fe.push({aabb:jt,zoom:sn,x:Cn,y:gt,wrap:ge.wrap,fullyVisible:Be})}}return ae.sort((ge,Ie)=>ge.distanceSq-Ie.distanceSq).map(ge=>ge.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=l.ad(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.P(l.G(o.lng)*this.worldSize,l.H(d)*this.worldSize)}unproject(o){return new l.U(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const d=this.pointLocation(this.centerPoint,o),p=o.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-p))return;const y=this.getCameraPosition(),b=l.U.fromLngLat(y.lngLat,y.altitude),E=l.U.fromLngLat(d,p),A=b.x-E.x,k=b.y-E.y,O=b.z-E.z,j=Math.sqrt(A*A+k*k+O*O),V=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=p,this._center=d,this.zoom=V}setLocationAtPoint(o,d){const p=this.pointCoordinate(d),y=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(o),E=new l.U(b.x-(p.x-y.x),b.y-(p.y-y.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,d){return d?this.coordinatePoint(this.locationCoordinate(o),d.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,d){return this.coordinateLocation(this.pointCoordinate(o,d))}locationCoordinate(o){return l.U.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,d){if(d){const X=d.pointCoordinate(o);if(X!=null)return X}const p=[o.x,o.y,0,1],y=[o.x,o.y,1,1];l.ag(p,p,this.pixelMatrixInverse),l.ag(y,y,this.pixelMatrixInverse);const b=p[3],E=y[3],A=p[1]/b,k=y[1]/E,O=p[2]/b,j=y[2]/E,V=O===j?0:(0-O)/(j-O);return new l.U(l.B.number(p[0]/b,y[0]/E,V)/this.worldSize,l.B.number(A,k,V)/this.worldSize)}coordinatePoint(o,d=0,p=this.pixelMatrix){const y=[o.x*this.worldSize,o.y*this.worldSize,d,1];return l.ag(y,y,p),new l.P(y[0]/y[3],y[1]/y[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new ht().extend(this.pointLocation(new l.P(0,o))).extend(this.pointLocation(new l.P(this.width,o))).extend(this.pointLocation(new l.P(this.width,this.height))).extend(this.pointLocation(new l.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ht([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,d=!1){const p=o.key,y=d?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const b=o.canonical,E=this.worldSize/this.zoomScale(b.z),A=b.x+Math.pow(2,b.z)*o.wrap,k=l.ao(new Float64Array(16));return l.$(k,k,[A*E,b.y*E,0]),l.a0(k,k,[E/l.N,E/l.N,1]),l.a1(k,d?this.alignedProjMatrix:this.projMatrix,k),y[p]=new Float32Array(k),y[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,d,p,y,b=-90,E=90,A=-180,k=180;const O=this.size,j=this._unmodified;if(this.latRange){const ue=this.latRange;b=l.H(ue[1])*this.worldSize,E=l.H(ue[0])*this.worldSize,o=E-b<O.y?O.y/(E-b):0}if(this.lngRange){const ue=this.lngRange;A=l.b5(l.G(ue[0])*this.worldSize,0,this.worldSize),k=l.b5(l.G(ue[1])*this.worldSize,0,this.worldSize),k<A&&(k+=this.worldSize),d=k-A<O.x?O.x/(k-A):0}const V=this.point,X=Math.max(d||0,o||0);if(X)return this.center=this.unproject(new l.P(d?(k+A)/2:V.x,o?(E+b)/2:V.y)),this.zoom+=this.scaleZoom(X),this._unmodified=j,void(this._constraining=!1);if(this.latRange){const ue=V.y,ce=O.y/2;ue-ce<b&&(y=b+ce),ue+ce>E&&(y=E-ce)}if(this.lngRange){const ue=(A+k)/2,ce=l.b5(V.x,ue-this.worldSize/2,ue+this.worldSize/2),fe=O.x/2;ce-fe<A&&(p=A+fe),ce+fe>k&&(p=k-fe)}p===void 0&&y===void 0||(this.center=this.unproject(new l.P(p!==void 0?p:V.x,y!==void 0?y:V.y)).wrap()),this._unmodified=j,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.b7(1,this.center.lat)*this.worldSize;let y=l.ao(new Float64Array(16));l.a0(y,y,[this.width/2,-this.height/2,1]),l.$(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=l.ao(new Float64Array(16)),l.a0(y,y,[1,-1,1]),l.$(y,y,[-1,-1,0]),l.a0(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this._minEleveationForCurrentTile),A=b-E*this._pixelPerMeter/Math.cos(this._pitch),k=E<0?A:b,O=Math.PI/2+this._pitch,j=this._fov*(.5+o.y/this.height),V=Math.sin(j)*k/Math.sin(l.ad(Math.PI-O-j,.01,Math.PI-.01)),X=this.getHorizon(),ue=2*Math.atan(X/this.cameraToCenterDistance)*(.5+o.y/(2*X)),ce=Math.sin(ue)*k/Math.sin(l.ad(Math.PI-O-ue,.01,Math.PI-.01)),fe=Math.min(V,ce),ae=1.01*(Math.cos(Math.PI/2-this._pitch)*fe+k),Pe=this.height/50;y=new Float64Array(16),l.b8(y,this._fov,this.width/this.height,Pe,ae),y[8]=2*-o.x/this.width,y[9]=2*o.y/this.height,l.a0(y,y,[1,-1,1]),l.$(y,y,[0,0,-this.cameraToCenterDistance]),l.b9(y,y,this._pitch),l.ae(y,y,this.angle),l.$(y,y,[-d,-p,0]),this.mercatorMatrix=l.a0([],y,[this.worldSize,this.worldSize,this.worldSize]),l.a0(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.a1(new Float64Array(16),this.labelPlaneMatrix,y),l.$(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=l.as([],y),this.pixelMatrix3D=l.a1(new Float64Array(16),this.labelPlaneMatrix,y);const Oe=this.width%2/2,ge=this.height%2/2,Ie=Math.cos(this.angle),Fe=Math.sin(this.angle),Be=d-Math.round(d)+Ie*Oe+Fe*ge,Ke=p-Math.round(p)+Ie*ge+Fe*Oe,rt=new Float64Array(y);if(l.$(rt,rt,[Be>.5?Be-1:Be,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=rt,y=l.as(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new l.P(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.ag(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(0,o))}getCameraQueryGeometry(o){const d=this.getCameraPoint();if(o.length===1)return[o[0],d];{let p=d.x,y=d.y,b=d.x,E=d.y;for(const A of o)p=Math.min(p,A.x),y=Math.min(y,A.y),b=Math.max(b,A.x),E=Math.max(E,A.y);return[new l.P(p,y),new l.P(b,y),new l.P(b,E),new l.P(p,E),new l.P(p,y)]}}}function Ga(v,o){let d,p=!1,y=null,b=null;const E=()=>{y=null,p&&(v.apply(b,d),y=setTimeout(E,o),p=!1)};return(...A)=>(p=!0,b=this,d=A,y||E(),y)}class Vc{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Ga(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),E=Math.round(d.lng*b)/b,A=Math.round(d.lat*b)/b,k=this._map.getBearing(),O=this._map.getPitch();let j="";if(j+=o?`/${E}/${A}/${p}`:`${p}/${A}/${E}`,(k||O)&&(j+="/"+Math.round(10*k)/10),O&&(j+=`/${Math.round(O)}`),this._hashName){const V=this._hashName;let X=!1;const ue=window.location.hash.slice(1).split("&").map(ce=>{const fe=ce.split("=")[0];return fe===V?(X=!0,`${fe}=${j}`):ce}).filter(ce=>ce);return X||ue.push(`${V}=${j}`),`#${ue.join("&")}`}return`#${j}`}}const Rl={linearity:.3,easing:l.ba(0,0,.3,1)},vg=l.e({deceleration:2500,maxSpeed:1400},Rl),xg=l.e({deceleration:20,maxSpeed:1400},Rl),bg=l.e({deceleration:1e3,maxSpeed:360},Rl),wg=l.e({deceleration:1e3,maxSpeed:90},Rl);class Sg{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.h.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=l.h.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(d.pan.mag()){const b=Uc(d.pan.mag(),p,l.e({},vg,o||{}));y.offset=d.pan.mult(b.amount/d.pan.mag()),y.center=this._map.transform.center,go(y,b)}if(d.zoom){const b=Uc(d.zoom,p,xg);y.zoom=this._map.transform.zoom+b.amount,go(y,b)}if(d.bearing){const b=Uc(d.bearing,p,bg);y.bearing=this._map.transform.bearing+l.ad(b.amount,-179,179),go(y,b)}if(d.pitch){const b=Uc(d.pitch,p,wg);y.pitch=this._map.transform.pitch+b.amount,go(y,b)}if(y.zoom||y.bearing){const b=d.pinchAround===void 0?d.around:d.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),l.e(y,{noMoveStart:!0})}}function go(v,o){(!v.duration||v.duration<o.duration)&&(v.duration=o.duration,v.easing=o.easing)}function Uc(v,o,d){const{maxSpeed:p,linearity:y,deceleration:b}=d,E=l.ad(v*y/(o/1e3),-p,p),A=Math.abs(E)/(b*y);return{easing:d.easing,duration:1e3*A,amount:E*(A/2)}}class fs extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p,y={}){const b=_.mousePos(d.getCanvasContainer(),p),E=d.unproject(b);super(o,l.e({point:b,lngLat:E,originalEvent:p},y)),this._defaultPrevented=!1,this.target=d}}class $c extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){const y=o==="touchend"?p.changedTouches:p.touches,b=_.touchPos(d.getCanvasContainer(),y),E=b.map(k=>d.unproject(k)),A=b.reduce((k,O,j,V)=>k.add(O.div(V.length)),new l.P(0,0));super(o,{points:b,point:A,lngLats:E,lngLat:d.unproject(A),originalEvent:p}),this._defaultPrevented=!1}}class Tg extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class Eg{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Tg(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new fs(o.type,this._map,o))}mouseup(o){this._map.fire(new fs(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new fs(o.type,this._map,o))}dblclick(o){return this._firePreventable(new fs(o.type,this._map,o))}mouseover(o){this._map.fire(new fs(o.type,this._map,o))}mouseout(o){this._map.fire(new fs(o.type,this._map,o))}touchstart(o){return this._firePreventable(new $c(o.type,this._map,o))}touchmove(o){this._map.fire(new $c(o.type,this._map,o))}touchend(o){this._map.fire(new $c(o.type,this._map,o))}touchcancel(o){this._map.fire(new $c(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pg{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new fs(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new fs(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wo{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(l.P.convert(o),this._map.terrain)}}class Cg{constructor(o,d){this._map=o,this._tr=new Wo(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(_.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=_.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const b=Math.min(y.x,p.x),E=Math.max(y.x,p.x),A=Math.min(y.y,p.y),k=Math.max(y.y,p.y);_.setTransform(this._box,`translate(${b}px,${A}px)`),this._box.style.width=E-b+"px",this._box.style.height=k-A+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const p=this._startPos,y=d;if(this.reset(),_.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.k("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(p,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new l.k(o,{originalEvent:d}))}}function Is(v,o){if(v.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${o.length}`);const d={};for(let p=0;p<v.length;p++)d[v[p].identifier]=o[p];return d}class Ho{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const b=new l.P(0,0);for(const E of y)b._add(E);return b.div(y.length)}(d),this.touches=Is(p,d)))}touchmove(o,d,p){if(this.aborted||!this.centroid)return;const y=Is(p,d);for(const b in this.touches){const E=y[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(o,d,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class oh{constructor(o){this.singleTap=new Ho(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,p){this.singleTap.touchstart(o,d,p)}touchmove(o,d,p){this.singleTap.touchmove(o,d,p)}touchend(o,d,p){const y=this.singleTap.touchend(o,d,p);if(y){const b=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(b&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class qo{constructor(o){this._tr=new Wo(o),this._zoomIn=new oh({numTouches:1,numTaps:2}),this._zoomOut=new oh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,p){this._zoomIn.touchstart(o,d,p),this._zoomOut.touchstart(o,d,p)}touchmove(o,d,p){this._zoomIn.touchmove(o,d,p),this._zoomOut.touchmove(o,d,p)}touchend(o,d,p){const y=this._zoomIn.touchend(o,d,p),b=this._zoomOut.touchend(o,d,p),E=this._tr;return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(y)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zo{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const y=d.length?d[0]:d;return!this._moved&&y.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(p,y))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&_.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Xv={0:1,2:2};class yf{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=_.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,p){const y=Xv[p];return d.buttons===void 0||(d.buttons&y)!==y}(o,this._eventButton)}isValidEndEvent(o){return _.mouseButton(o)===this._eventButton}}class Ag{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const ah=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=function(o){o.preventDefault()}},Ol=({enable:v,clickTolerance:o,bearingDegreesPerPixelMoved:d=.8})=>{const p=new yf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new Zo({clickTolerance:o,move:(y,b)=>({bearingDelta:(b.x-y.x)*d}),moveStateManager:p,enable:v,assignEvents:ah})},Xo=({enable:v,clickTolerance:o,pitchDegreesPerPixelMoved:d=-.5})=>{const p=new yf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new Zo({clickTolerance:o,move:(y,b)=>({pitchDelta:(b.y-y.y)*d}),moveStateManager:p,enable:v,assignEvents:ah})};class Mt{constructor(o,d){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,d,p){return this._calculateTransform(o,d,p)}touchmove(o,d,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,d,p)}touchend(o,d,p){this._calculateTransform(o,d,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,p){p.length>0&&(this._active=!0);const y=Is(p,d),b=new l.P(0,0),E=new l.P(0,0);let A=0;for(const O in y){const j=y[O],V=this._touches[O];V&&(b._add(j),E._add(j.sub(V)),A++,y[O]=j)}if(this._touches=y,A<this._minTouches||!E.mag())return;const k=E.div(A);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(A),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,p){if(!this._firstTwoTouches)return;o.preventDefault();const[y,b]=this._firstTwoTouches,E=ga(p,d,y),A=ga(p,d,b);if(!E||!A)return;const k=this._aroundCenter?null:E.add(A).div(2);return this._move([E,A],k,o)}touchend(o,d,p){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,E=ga(p,d,y),A=ga(p,d,b);E&&A||(this._active&&_.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ga(v,o,d){for(let p=0;p<v.length;p++)if(v[p].identifier===d)return o[p]}function zl(v,o){return Math.log(v/o)/Math.LN2}class Ig extends lh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(zl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zl(this._distance,p),pinchAround:d}}}function St(v,o){return 180*v.angleWith(o)/Math.PI}class _f extends lh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:St(this._vector,p),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,p=St(o,this._startVector);return Math.abs(p)<d}}function vf(v){return Math.abs(v.y)>Math.abs(v.x)}class Yv extends lh{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,p){super.touchstart(o,d,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,vf(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=o[0].sub(this._lastPoints[0]),b=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,b,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(y.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,p){if(this._valid!==void 0)return this._valid;const y=o.mag()>=2,b=d.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=o.y>0==d.y>0;return vf(o)&&vf(d)&&E}}const xf={panStep:100,bearingStep:15,pitchStep:10};class kg{constructor(o){this._tr=new Wo(o);const d=xf;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,p=0,y=0,b=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:A=>{const k=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:Mg,zoom:d?Math.round(k.zoom)+d*(o.shiftKey?2:1):k.zoom,bearing:k.bearing+p*this._bearingStep,pitch:k.pitch+y*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:k.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Mg(v){return v*(2-v)}const Lg=4.000244140625;class Kv{constructor(o,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new Wo(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=l.h.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%Lg==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=_.mousePos(this._el,o),p=this._tr;this._around=l.L.convert(this._aroundCenter?p.center:p.unproject(d)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Lg?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&k!==0&&(k=1/k);const O=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(O*k))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,p=this._startZoom,y=this._easing;let b,E=!1;if(this._type==="wheel"&&p&&y){const A=Math.min((l.h.now()-this._lastWheelEventTime)/200,1),k=y(A);b=l.B.number(p,d,k),A<1?this._frameId||(this._frameId=!0):E=!0}else b=d,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:b-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=l.bb;if(this._prevEase){const p=this._prevEase,y=(l.h.now()-p.start)/p.duration,b=p.easing(y+.01)-p.easing(y),E=.27/Math.sqrt(b*b+1e-4)*.01,A=Math.sqrt(.0729-E*E);d=l.ba(E,A,.25,1)}return this._prevEase={start:l.h.now(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class bf{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class wf{constructor(o){this._tr=new Wo(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sf{constructor(){this._tap=new oh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,p){if(!this._swipePoint)if(this._tapTime){const y=d[0],b=o.timeStamp-this._tapTime<500,E=this._tapPoint.dist(y)<30;b&&E?p.length>0&&(this._swipePoint=y,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,d,p)}touchmove(o,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=d[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,d,p)}touchend(o,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const y=this._tap.touchend(o,d,p);y&&(this._tapTime=o.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tf{constructor(o,d,p){this._el=o,this._mousePan=d,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(o,d,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ya{constructor(o,d,p,y){this._el=o,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Gc=v=>v.zoom||v.drag||v.pitch||v.rotate;class Ef extends l.k{}function Wc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Pf{constructor(o,d){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,b)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=y.type==="renderFrame"?void 0:y,A={needsRenderFrame:!1},k={},O={},j=y.touches,V=j?this._getMapTouches(j):void 0,X=V?_.touchPos(this._el,V):_.mousePos(this._el,y);for(const{handlerName:fe,handler:ae,allowed:Pe}of this._handlers){if(!ae.isEnabled())continue;let Oe;this._blockedByActive(O,Pe,fe)?ae.reset():ae[b||y.type]&&(Oe=ae[b||y.type](y,X,V),this.mergeHandlerResult(A,k,Oe,fe,E),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||ae.isActive())&&(O[fe]=ae)}const ue={};for(const fe in this._previousActiveHandlers)O[fe]||(ue[fe]=E);this._previousActiveHandlers=O,(Object.keys(ue).length||Wc(A))&&(this._changes.push([A,k,ue]),this._triggerRenderFrame()),(Object.keys(O).length||Wc(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ce}=A;ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ce(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sg(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,b,E]of this._listeners)_.addEventListener(y,b,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,d,p]of this._listeners)_.removeEventListener(o,d,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new Eg(d,o));const y=d.boxZoom=new Cg(d,o);this._add("boxZoom",y),o.interactive&&o.boxZoom&&y.enable();const b=new qo(d),E=new wf(d);d.doubleClickZoom=new bf(E,b),this._add("tapZoom",b),this._add("clickZoom",E),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const A=new Sf;this._add("tapDragZoom",A);const k=d.touchPitch=new Yv(d);this._add("touchPitch",k),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const O=Ol(o),j=Xo(o);d.dragRotate=new qi(o,O,j),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const V=(({enable:Pe,clickTolerance:Oe})=>{const ge=new yf({checkCorrectEvent:Ie=>_.mouseButton(Ie)===0&&!Ie.ctrlKey});return new Zo({clickTolerance:Oe,move:(Ie,Fe)=>({around:Fe,panDelta:Fe.sub(Ie)}),activateOnStart:!0,moveStateManager:ge,enable:Pe,assignEvents:ah})})(o),X=new Mt(o,d);d.dragPan=new Tf(p,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const ue=new _f,ce=new Ig;d.touchZoomRotate=new ya(p,ce,ue,A),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate);const fe=d.scrollZoom=new Kv(d,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const ae=d.keyboard=new kg(d);this._add("keyboard",ae),o.interactive&&o.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new Pg(d))}_add(o,d,p){this._handlers.push({handlerName:o,handler:d,allowed:p}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gc(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,p){for(const y in o)if(y!==p&&(!d||d.indexOf(y)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const p of o)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(o,d,p,y,b){if(!p)return;l.e(o,p);const E={handlerName:y,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(d.zoom=E),p.panDelta!==void 0&&(d.drag=E),p.pitchDelta!==void 0&&(d.pitch=E),p.bearingDelta!==void 0&&(d.rotate=E)}_applyChanges(){const o={},d={},p={};for(const[y,b,E]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new l.P(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),l.e(d,b),l.e(p,E);this._updateMapTransform(o,d,p),this._changes=[]}_updateMapTransform(o,d,p){const y=this._map,b=y._getTransformForUpdate(),E=y.terrain;if(!(Wc(o)||E&&this._terrainMovement))return this._fireEvents(d,p,!0);let{panDelta:A,zoomDelta:k,bearingDelta:O,pitchDelta:j,around:V,pinchAround:X}=o;X!==void 0&&(V=X),y._stop(!0),V=V||y.transform.centerPoint;const ue=b.pointLocation(A?V.sub(A):V);O&&(b.bearing+=O),j&&(b.pitch+=j),k&&(b.zoom+=k),E?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(A)):b.setLocationAtPoint(ue,V):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(ue,V),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(y.terrain)})):b.setLocationAtPoint(ue,V),y._applyUpdatedTransform(b),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,p,!0)}_fireEvents(o,d,p){const y=Gc(this._eventsInProgress),b=Gc(o),E={};for(const j in o){const{originalEvent:V}=o[j];this._eventsInProgress[j]||(E[`${j}start`]=V),this._eventsInProgress[j]=o[j]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const j in E)this._fireEvent(j,E[j]);b&&this._fireEvent("move",b.originalEvent);for(const j in o){const{originalEvent:V}=o[j];this._fireEvent(j,V)}const A={};let k;for(const j in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[j];this._handlersById[V].isActive()||(delete this._eventsInProgress[j],k=d[V]||X,A[`${j}end`]=k)}for(const j in A)this._fireEvent(j,A[j]);const O=Gc(this._eventsInProgress);if(p&&(y||b)&&!O){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!j||!j.essential&&l.h.prefersReducedMotion?(this._map.fire(new l.k("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()):(V(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new l.k(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Ef("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Rg extends l.E{constructor(o,d){super(),this._renderFrameCallback=()=>{const p=Math.min((l.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.L(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,p){return o=l.P.convert(o).mult(-1),this.panTo(this.transform.center,l.e({offset:o},d),p)}panTo(o,d,p){return this.easeTo(l.e({center:o},d),p)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,p){return this.easeTo(l.e({zoom:o},d),p)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,p){return this.easeTo(l.e({bearing:o},d),p)}resetNorth(o,d){return this.rotateTo(0,l.e({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(l.e({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=ht.convert(o);const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,d)}_cameraForBoxAndBearing(o,d,p,y){const b={top:0,bottom:0,right:0,left:0};if(typeof(y=l.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const Fe=y.padding;y.padding={top:Fe,bottom:Fe,right:Fe,left:Fe}}y.padding=l.e(b,y.padding);const E=this.transform,A=E.padding,k=E.project(l.L.convert(o)),O=E.project(l.L.convert(d)),j=k.rotate(-p*Math.PI/180),V=O.rotate(-p*Math.PI/180),X=new l.P(Math.max(j.x,V.x),Math.max(j.y,V.y)),ue=new l.P(Math.min(j.x,V.x),Math.min(j.y,V.y)),ce=X.sub(ue),fe=(E.width-(A.left+A.right+y.padding.left+y.padding.right))/ce.x,ae=(E.height-(A.top+A.bottom+y.padding.top+y.padding.bottom))/ce.y;if(ae<0||fe<0)return void l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Pe=Math.min(E.scaleZoom(E.scale*Math.min(fe,ae)),y.maxZoom),Oe=l.P.convert(y.offset),ge=new l.P((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(p*Math.PI/180),Ie=Oe.add(ge).mult(E.scale/E.zoomScale(Pe));return{center:E.unproject(k.add(O).div(2).sub(Ie)),zoom:Pe,bearing:p}}fitBounds(o,d,p){return this._fitInternal(this.cameraForBounds(o,d),d,p)}fitScreenCoordinates(o,d,p,y,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.P.convert(o)),this.transform.pointLocation(l.P.convert(d)),p,y),y,b)}_fitInternal(o,d,p){return o?(delete(d=l.e(o,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(o,d){this.stop();const p=this._getTransformForUpdate();let y=!1,b=!1,E=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(y=!0,p.zoom=+o.zoom),o.center!==void 0&&(p.center=l.L.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(b=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(E=!0,p.pitch=+o.pitch),o.padding==null||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new l.k("movestart",d)).fire(new l.k("move",d)),y&&this.fire(new l.k("zoomstart",d)).fire(new l.k("zoom",d)).fire(new l.k("zoomend",d)),b&&this.fire(new l.k("rotatestart",d)).fire(new l.k("rotate",d)).fire(new l.k("rotateend",d)),E&&this.fire(new l.k("pitchstart",d)).fire(new l.k("pitch",d)).fire(new l.k("pitchend",d)),this.fire(new l.k("moveend",d))}calculateCameraOptionsFromTo(o,d,p,y=0){const b=l.U.fromLngLat(o,d),E=l.U.fromLngLat(p,y),A=E.x-b.x,k=E.y-b.y,O=E.z-b.z,j=Math.hypot(A,k,O);if(j===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(A,k),X=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),ue=180*Math.atan2(A,-k)/Math.PI;let ce=180*Math.acos(V/j)/Math.PI;return ce=O<0?90-ce:90+ce,{center:E.toLngLat(),zoom:X,pitch:ce,bearing:ue}}easeTo(o,d){this._stop(!1,o.easeId),((o=l.e({offset:[0,0],duration:500,easing:l.bb},o)).animate===!1||!o.essential&&l.h.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),A=this.getPadding(),k="zoom"in o?+o.zoom:y,O="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,X=l.P.convert(o.offset);let ue=p.centerPoint.add(X);const ce=p.pointLocation(ue),fe=l.L.convert(o.center||ce);this._normalizeCenter(fe);const ae=p.project(ce),Pe=p.project(fe).sub(ae),Oe=p.zoomScale(k-y);let ge,Ie;o.around&&(ge=l.L.convert(o.around),Ie=p.locationPoint(ge));const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==y,this._rotating=this._rotating||b!==O,this._pitching=this._pitching||j!==E,this._padding=!p.isPaddingEqual(V),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,Fe),this.terrain&&this._prepareElevation(fe),this._ease(Be=>{if(this._zooming&&(p.zoom=l.B.number(y,k,Be)),this._rotating&&(p.bearing=l.B.number(b,O,Be)),this._pitching&&(p.pitch=l.B.number(E,j,Be)),this._padding&&(p.interpolatePadding(A,V,Be),ue=p.centerPoint.add(X)),this.terrain&&!o.freezeElevation&&this._updateElevation(Be),ge)p.setLocationAtPoint(ge,Ie);else{const Ke=p.zoomScale(p.zoom-y),rt=k>y?Math.min(2,Oe):Math.max(.5,Oe),et=Math.pow(rt,1-Be),ct=p.unproject(ae.add(Pe.mult(Be*et)).mult(Ke));p.setLocationAtPoint(p.renderWorldCopies?ct.wrap():ct,ue)}this._applyUpdatedTransform(p),this._fireMoveEvents(d)},Be=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Be)},o),this}_prepareEase(o,d,p={}){this._moving=!0,d||p.moving||this.fire(new l.k("movestart",o)),this._zooming&&!p.zooming&&this.fire(new l.k("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new l.k("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new l.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(d-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.elevation=l.B.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const d=o.clone(),{center:p,zoom:y,pitch:b,bearing:E,elevation:A}=this.transformCameraUpdate(d);p&&(d.center=p),y!==void 0&&(d.zoom=y),b!==void 0&&(d.pitch=b),E!==void 0&&(d.bearing=E),A!==void 0&&(d.elevation=A),this.transform.apply(d)}_fireMoveEvents(o){this.fire(new l.k("move",o)),this._zooming&&this.fire(new l.k("zoom",o)),this._rotating&&this.fire(new l.k("rotate",o)),this._pitching&&this.fire(new l.k("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.k("zoomend",o)),y&&this.fire(new l.k("rotateend",o)),b&&this.fire(new l.k("pitchend",o)),this.fire(new l.k("moveend",o))}flyTo(o,d){if(!o.essential&&l.h.prefersReducedMotion){const jt=l.F(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(jt,d)}this.stop(),o=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.bb},o);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),A=this.getPadding(),k="zoom"in o?l.ad(+o.zoom,p.minZoom,p.maxZoom):y,O="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,X=p.zoomScale(k-y),ue=l.P.convert(o.offset);let ce=p.centerPoint.add(ue);const fe=p.pointLocation(ce),ae=l.L.convert(o.center||fe);this._normalizeCenter(ae);const Pe=p.project(fe),Oe=p.project(ae).sub(Pe);let ge=o.curve;const Ie=Math.max(p.width,p.height),Fe=Ie/X,Be=Oe.mag();if("minZoom"in o){const jt=l.ad(Math.min(o.minZoom,y,k),p.minZoom,p.maxZoom),Hn=Ie/p.zoomScale(jt-y);ge=Math.sqrt(Hn/Be*2)}const Ke=ge*ge;function rt(jt){const Hn=(Fe*Fe-Ie*Ie+(jt?-1:1)*Ke*Ke*Be*Be)/(2*(jt?Fe:Ie)*Ke*Be);return Math.log(Math.sqrt(Hn*Hn+1)-Hn)}function et(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function ct(jt){return(Math.exp(jt)+Math.exp(-jt))/2}const Ft=rt(!1);let Cn=function(jt){return ct(Ft)/ct(Ft+ge*jt)},gt=function(jt){return Ie*((ct(Ft)*(et(Hn=Ft+ge*jt)/ct(Hn))-et(Ft))/Ke)/Be;var Hn},sn=(rt(!0)-Ft)/ge;if(Math.abs(Be)<1e-6||!isFinite(sn)){if(Math.abs(Ie-Fe)<1e-6)return this.easeTo(o,d);const jt=Fe<Ie?-1:1;sn=Math.abs(Math.log(Fe/Ie))/ge,gt=function(){return 0},Cn=function(Hn){return Math.exp(jt*ge*Hn)}}return o.duration="duration"in o?+o.duration:1e3*sn/("screenSpeed"in o?+o.screenSpeed/ge:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==O,this._pitching=j!==E,this._padding=!p.isPaddingEqual(V),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(ae),this._ease(jt=>{const Hn=jt*sn,En=1/Cn(Hn);p.zoom=jt===1?k:y+p.scaleZoom(En),this._rotating&&(p.bearing=l.B.number(b,O,jt)),this._pitching&&(p.pitch=l.B.number(E,j,jt)),this._padding&&(p.interpolatePadding(A,V,jt),ce=p.centerPoint.add(ue)),this.terrain&&!o.freezeElevation&&this._updateElevation(jt);const xn=jt===1?ae:p.unproject(Pe.add(Oe.mult(gt(Hn))).mult(En));p.setLocationAtPoint(p.renderWorldCopies?xn.wrap():xn,ce),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,d)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,d,p){p.animate===!1||p.duration===0?(o(1),d()):(this._easeStart=l.h.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=l.b5(o,-180,180);const p=Math.abs(o-d);return Math.abs(o-360-d)<p&&(o-=360),Math.abs(o+360-d)<p&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const p=o.lng-d.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(l.L.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class ps{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const p=this._map._getUIString(`AttributionControl.${d}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const d=this._map.style.sourceCaches;for(const y in d){const b=d[y];if(b.used||b.usedForTerrain){const E=b.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(y=>String(y).trim()),o.sort((y,b)=>y.length-b.length),o=o.filter((y,b)=>{for(let E=b+1;E<o.length;E++)if(o[E].indexOf(y)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("div","maplibregl-ctrl");const d=_.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ch{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const y of p)if(y.id===o)return void(y.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Cf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Og=l.Q([{name:"a_pos3d",type:"Int16",components:3}]);class zg extends l.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,d){this.sourceCache.update(o,d),this._renderableTilesKeys=[];const p={};for(const y of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))p[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),l.aS(y.posMatrix,0,l.N,0,l.N,0,1),this._tiles[y.key]=new ut(y,this.tileSize));for(const y in this._tiles)p[y]||delete this._tiles[y]}freeRtt(o){for(const d in this._tiles){const p=this._tiles[d];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const d={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16),l.aS(b.posMatrix,0,l.N,0,l.N,0,1),d[p]=b}else if(y.canonical.isChildOf(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=y.canonical.z-o.canonical.z,A=y.canonical.x-(y.canonical.x>>E<<E),k=y.canonical.y-(y.canonical.y>>E<<E),O=l.N>>E;l.aS(b.posMatrix,0,O,0,O,0,1),l.$(b.posMatrix,b.posMatrix,[-A*O,-k*O,0]),d[p]=b}else if(o.canonical.isChildOf(y.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=o.canonical.z-y.canonical.z,A=o.canonical.x-(o.canonical.x>>E<<E),k=o.canonical.y-(o.canonical.y>>E<<E),O=l.N>>E;l.aS(b.posMatrix,0,l.N,0,l.N,0,1),l.$(b.posMatrix,b.posMatrix,[A*O,k*O,0]),l.a0(b.posMatrix,b.posMatrix,[1/2**E,1/2**E,0]),d[p]=b}}return d}getSourceTile(o,d){const p=this.sourceCache._source;let y=o.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(y).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!b||!b.dem)&&d)for(;y>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(o.scaledTo(y--).key);return b}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=o)}}class Dg{constructor(o,d,p){this.painter=o,this.sourceCache=new zg(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,p,y=l.N){var b;if(!(d>=0&&d<y&&p>=0&&p<y))return 0;const E=this.getTerrainData(o),A=(b=E.tile)===null||b===void 0?void 0:b.dem;if(!A)return 0;const k=function(ce,fe,ae){var Pe=fe[0],Oe=fe[1];return ce[0]=ae[0]*Pe+ae[4]*Oe+ae[12],ce[1]=ae[1]*Pe+ae[5]*Oe+ae[13],ce}([],[d/y*l.N,p/y*l.N],E.u_terrain_matrix),O=[k[0]*A.dim,k[1]*A.dim],j=Math.floor(O[0]),V=Math.floor(O[1]),X=O[0]-j,ue=O[1]-V;return A.get(j,V)*(1-X)*(1-ue)+A.get(j+1,V)*X*(1-ue)+A.get(j,V+1)*(1-X)*ue+A.get(j+1,V+1)*X*ue}getElevationForLngLatZoom(o,d){const{tileID:p,mercatorX:y,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(p,y%l.N,b%l.N,l.N)}getElevation(o,d,p,y=l.N){return this.getDEMElevation(o,d,p,y)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const y=this.painter.context,b=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _e(y,b,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _e(y,new l.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ao([])}const d=this.sourceCache.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const y=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new _e(y,d.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),d.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let b=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=y?b=o.canonical.z-y:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>b<<b),A=o.canonical.y-(o.canonical.y>>b<<b),k=l.bc(new Float64Array(16),[1/(l.N<<b),1/(l.N<<b),0]);l.$(k,k,[E*l.N,A*l.N,0]),this._demMatrixCache[o.key]={matrix:k,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,p=d.width/devicePixelRatio,y=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _e(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _e(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,y,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,E=0;b<this._coordsTextureSize;b++)for(let A=0;A<this._coordsTextureSize;A++,E+=4)d[E+0]=255&A,d[E+1]=255&b,d[E+2]=A>>8<<4|b>>8,d[E+3]=0;const p=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),y=new _e(o,p,o.gl.RGBA,{premultiply:!1});return y.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(o){const d=new Uint8Array(4),p=this.painter.context,y=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const b=d[0]+(d[2]>>4<<8),E=d[1]+((15&d[2])<<8),A=this.coordsIndex[255-d[3]],k=A&&this.sourceCache.getTileByID(A);if(!k)return null;const O=this._coordsTextureSize,j=(1<<k.tileID.canonical.z)*O;return new l.U(this._allowMercatorOverflow(o,(k.tileID.canonical.x*O+b)/j),(k.tileID.canonical.y*O+E)/j,this.getElevation(k.tileID,b,E,O))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,d=new l.bd,p=new l.b0,y=this.meshSize,b=l.N/y,E=y*y;for(let V=0;V<=y;V++)for(let X=0;X<=y;X++)d.emplaceBack(X*b,V*b,0);for(let V=0;V<E;V+=y+1)for(let X=0;X<y;X++)p.emplaceBack(X+V,y+X+V+1,y+X+V+2),p.emplaceBack(X+V,y+X+V+2,X+V+1);const A=d.length,k=A+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ue of[0,1])d.emplaceBack(X*b,V*l.N,ue);for(let V=0;V<2*y;V+=2)p.emplaceBack(k+V,k+V+1,k+V+3),p.emplaceBack(k+V,k+V+3,k+V+2),p.emplaceBack(A+V,A+V+3,A+V+1),p.emplaceBack(A+V,A+V+2,A+V+3);const O=d.length,j=O+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ue of[0,1])d.emplaceBack(V*l.N,X*b,ue);for(let V=0;V<2*y;V+=2)p.emplaceBack(O+V,O+V+1,O+V+3),p.emplaceBack(O+V,O+V+3,O+V+2),p.emplaceBack(j+V,j+V+3,j+V+1),p.emplaceBack(j+V,j+V+2,j+V+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(d,Og.members),segments:l.S.simpleSegment(0,0,d.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*l.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,d){var p;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(p=this.getMinMaxElevation(y).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(o,d){const p=l.U.fromLngLat(o.wrap()),y=(1<<d)*l.N,b=p.x*y,E=p.y*y,A=Math.floor(b/l.N),k=Math.floor(E/l.N);return{tileID:new l.O(d,0,d,A,k),mercatorX:b,mercatorY:E}}_allowMercatorOverflow(o,d){const p=o.x<this.painter.width/2;let y=l.bf(d);const b=this.painter.transform.center.lng;return p&&Math.sign(y)>0&&Math.sign(b)<0||!p&&Math.sign(y)<0&&Math.sign(b)>0?(y=360*Math.sign(b)+y,l.G(y)):d}}class Jv{constructor(o,d,p){this._context=o,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new _e(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:o,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const Mi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class uh{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Jv(o.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(d)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const y=o.sourceCaches[p].getVisibleCoordinates();for(const b of y){const E=this.terrain.sourceCache.getTerrainCoords(b);for(const A in E)this._coordsDescendingInv[p][A]||(this._coordsDescendingInv[p][A]=[]),this._coordsDescendingInv[p][A].push(E[A])}}this._coordsDescendingInvStr={};for(const p of o._order){const y=o._layers[p],b=y.source;if(Mi[y.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const E in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][E]=this._coordsDescendingInv[b][E].map(A=>A.key).sort().join()}}for(const p of this._renderableTiles)for(const y in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[y][p.tileID.key];b&&b!==p.rttCoords[y]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const d=o.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Mi[d]&&(this._prevType&&Mi[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(o.id),!y))return!0;if(Mi[this._prevType]||Mi[d]&&y){this._prevType=d;const b=this._stacks.length-1,E=this._stacks[b]||[];for(const A of this._renderableTiles){if(this.pool.isFull()&&(xr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(A),A.rtt[b]){const O=this.pool.getObjectForId(A.rtt[b].id);if(O.stamp===A.rtt[b].stamp){this.pool.useObject(O);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),A.rtt[b]={id:k.id,stamp:k.stamp},p.context.bindFramebuffer.set(k.fbo.framebuffer),p.context.clear({color:l.aT.transparent,stencil:0}),p.currentStencilSource=void 0;for(let O=0;O<E.length;O++){const j=p.style._layers[E[O]],V=j.source?this._coordsDescendingInv[j.source][A.tileID.key]:[A.tileID];p.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),p._renderTileClippingMasks(j,V),p.renderLayer(p,p.style.sourceCaches[j.source],j,V),j.source&&(A.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][A.tileID.key])}}return xr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Mi[d]}return!1}}const Zt=m,rn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Hc=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},Af={showCompass:!0,showZoom:!0,visualizePitch:!1};class If{constructor(o,d,p=!1){this.mousedown=E=>{this.startMouse(l.e({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),_.mousePos(this.element,E)),_.addEventListener(window,"mousemove",this.mousemove),_.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,_.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),_.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=_.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const y=o.dragRotate._mouseRotate.getClickTolerance(),b=o.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Ol({clickTolerance:y,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:A,bearingDegreesPerPixelMoved:k=.8})=>{const O=new Ag;return new Zo({clickTolerance:A,move:(j,V)=>({bearingDelta:(V.x-j.x)*k}),moveStateManager:O,enable:E,assignEvents:Hc})})({clickTolerance:y,enable:!0}),this.map=o,p&&(this.mousePitch=Xo({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:A,pitchDegreesPerPixelMoved:k=-.5})=>{const O=new Ag;return new Zo({clickTolerance:A,move:(j,V)=>({pitchDelta:(V.y-j.y)*k}),moveStateManager:O,enable:E,assignEvents:Hc})})({clickTolerance:b,enable:!0})),_.addEventListener(d,"mousedown",this.mousedown),_.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(d,"touchcancel",this.reset)}startMouse(o,d){this.mouseRotate.dragStart(o,d),this.mousePitch&&this.mousePitch.dragStart(o,d),_.disableDrag()}startTouch(o,d){this.touchRotate.dragStart(o,d),this.touchPitch&&this.touchPitch.dragStart(o,d),_.disableDrag()}moveMouse(o,d){const p=this.map,{bearingDelta:y}=this.mouseRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const{pitchDelta:b}=this.mousePitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(o,d){const p=this.map,{bearingDelta:y}=this.touchRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.touchPitch){const{pitchDelta:b}=this.touchPitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}off(){const o=this.element;_.removeEventListener(o,"mousedown",this.mousedown),_.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend),_.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){_.enableDrag(),_.removeEventListener(window,"mousemove",this.mousemove),_.removeEventListener(window,"mouseup",this.mouseup),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend)}}let Rr;function kf(v,o,d){if(v=new l.L(v.lng,v.lat),o){const p=new l.L(v.lng-360,v.lat),y=new l.L(v.lng+360,v.lat),b=d.locationPoint(v).distSqr(o);d.locationPoint(p).distSqr(o)<b?v=p:d.locationPoint(y).distSqr(o)<b&&(v=y)}for(;Math.abs(v.lng-d.center.lng)>180;){const p=d.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=d.width&&p.y<=d.height)break;v.lng>d.center.lng?v.lng-=360:v.lng+=360}return v}const ks={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fg(v,o,d){const p=v.classList;for(const y in ks)p.remove(`maplibregl-${d}-anchor-${y}`);p.add(`maplibregl-${d}-anchor-${o}`)}class Wa extends l.E{constructor(o){if(super(),this._onKeyPress=d=>{const p=d.code,y=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!p)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=kf(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),_.setTransform(this._element,`${ks[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${y}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const E=this._map.unproject(this._pos),A=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=E.distanceTo(this._lngLat)>20*A?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.k("dragstart"))),this.fire(new l.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=l.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div"),this._element.setAttribute("aria-label","Map marker");const d=_.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${y}px`),d.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const b=_.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const E=_.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const A=_.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of k){const Oe=_.createNS("http://www.w3.org/2000/svg","ellipse");Oe.setAttributeNS(null,"opacity","0.04"),Oe.setAttributeNS(null,"cx","10.5"),Oe.setAttributeNS(null,"cy","5.80029008"),Oe.setAttributeNS(null,"rx",Pe.rx),Oe.setAttributeNS(null,"ry",Pe.ry),A.appendChild(Oe)}const O=_.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const j=_.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(j);const V=_.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const X=_.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(X);const ue=_.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ue.setAttributeNS(null,"fill","#FFFFFF");const ce=_.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(8.0, 8.0)");const fe=_.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");const ae=_.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),ce.appendChild(fe),ce.appendChild(ae),E.appendChild(A),E.appendChild(O),E.appendChild(V),E.appendChild(ue),E.appendChild(ce),d.appendChild(E),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(d),this._offset=l.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),Fg(this._element,this._anchor,"marker"),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=l.L.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const y=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=l.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const br={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let yr=0,Dl=!1;const qc={maxWidth:100,unit:"metric"};function Zc(v,o,d){const p=d&&d.maxWidth||100,y=v._container.clientHeight/2,b=v.unproject([0,y]),E=v.unproject([p,y]),A=b.distanceTo(E);if(d&&d.unit==="imperial"){const k=3.2808*A;k>5280?Ha(o,p,k/5280,v._getUIString("ScaleControl.Miles")):Ha(o,p,k,v._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Ha(o,p,A/1852,v._getUIString("ScaleControl.NauticalMiles")):A>=1e3?Ha(o,p,A/1e3,v._getUIString("ScaleControl.Kilometers")):Ha(o,p,A,v._getUIString("ScaleControl.Meters"))}function Ha(v,o,d,p){const y=function(b){const E=Math.pow(10,`${Math.floor(b)}`.length-1);let A=b/E;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(k){const O=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*O)/O}(A),E*A}(d);v.style.width=o*(y/d)+"px",v.innerHTML=`${y}&nbsp;${p}`}const Mf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Lf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fl(v){if(v){if(typeof v=="number"){const o=Math.round(Math.abs(v)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,v),"top-left":new l.P(o,o),"top-right":new l.P(-o,o),bottom:new l.P(0,-v),"bottom-left":new l.P(o,-o),"bottom-right":new l.P(-o,-o),left:new l.P(v,0),right:new l.P(-v,0)}}if(v instanceof l.P||Array.isArray(v)){const o=l.P.convert(v);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:l.P.convert(v.center||[0,0]),top:l.P.convert(v.top||[0,0]),"top-left":l.P.convert(v["top-left"]||[0,0]),"top-right":l.P.convert(v["top-right"]||[0,0]),bottom:l.P.convert(v.bottom||[0,0]),"bottom-left":l.P.convert(v["bottom-left"]||[0,0]),"bottom-right":l.P.convert(v["bottom-right"]||[0,0]),left:l.P.convert(v.left||[0,0]),right:l.P.convert(v.right||[0,0])}}return Fl(new l.P(0,0))}const Rf={extend:(v,...o)=>l.e(v,...o),run(v){v()},logToElement(v,o=!1,d="log"){const p=window.document.getElementById(d);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${v}`)}},Of=m;class Gn{static get version(){return Of}static get workerCount(){return Ln.workerCount}static set workerCount(o){Ln.workerCount=o}static get maxParallelImageRequests(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){l.c.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return l.c.WORKER_URL}static set workerUrl(o){l.c.WORKER_URL=o}static addProtocol(o,d){l.c.REGISTERED_PROTOCOLS[o]=d}static removeProtocol(o){delete l.c.REGISTERED_PROTOCOLS[o]}}return Gn.Map=class extends Rg{constructor(v){if(l.bg.mark(l.bh.create),(v=l.e({},rn,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new sh(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),{bearingSnap:v.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._cooperativeGestures=v.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new ch,this._controls=[],this._mapId=l.a2(),this._locale=l.e({},Cf,v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new N(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const d=Ga(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{o?d(p):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Pf(this,v),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=v.hash&&new Vc(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,l.e({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new ps({customAttribution:v.customAttribution})),v.maplibreLogo&&this.addControl(new sr,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new l.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new l.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new l.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(v,o){if(o===void 0&&(o=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new l.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[o];return o.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new l.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(v);return o>-1&&this._controls.splice(o,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,o,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,o,d,p)}resize(v){var o;const d=this._containerDimensions(),p=d[0],y=d[1],b=this._getClampedPixelRatio(p,y);if(this._resizeCanvas(p,y,b),this.painter.resize(p,y,b),this.painter.overLimit()){const A=this.painter.context.gl;this._maxCanvasSize=[A.drawingBufferWidth,A.drawingBufferHeight];const k=this._getClampedPixelRatio(p,y);this._resizeCanvas(p,y,k),this.painter.resize(p,y,k)}this.transform.resize(p,y),(o=this._requestedCameraState)===null||o===void 0||o.resize(p,y);const E=!this._moving;return E&&(this.stop(),this.fire(new l.k("movestart",v)).fire(new l.k("move",v))),this.fire(new l.k("resize",v)),E&&this.fire(new l.k("moveend",v)),this}_getClampedPixelRatio(v,o){const{0:d,1:p}=this._maxCanvasSize,y=this.getPixelRatio(),b=v*y,E=o*y;return Math.min(b>d?d/b:1,E>p?p/E:1)*y}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ht.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(v){return this._cooperativeGestures=v,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(v){return this.transform.locationPoint(l.L.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(l.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,o,d){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:b=>{const E=this.getLayer(o)?this.queryRenderedFeatures(b.point,{layers:[o]}):[];E.length?p||(p=!0,d.call(this,new fs(v,this,b.originalEvent,{features:E}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:E=>{(this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,d.call(this,new fs(v,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,d.call(this,new fs(v,this,E.originalEvent)))}}}}{const p=y=>{const b=this.getLayer(o)?this.queryRenderedFeatures(y.point,{layers:[o]}):[];b.length&&(y.features=b,d.call(this,y),delete y.features)};return{layer:o,listener:d,delegates:{[v]:p}}}}on(v,o,d){if(d===void 0)return super.on(v,o);const p=this._createDelegatedListener(v,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(v,o,d){if(d===void 0)return super.once(v,o);const p=this._createDelegatedListener(v,o,d);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(v,o,d){return d===void 0?super.off(v,o):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{const y=this._delegatedListeners[v];for(let b=0;b<y.length;b++){const E=y[b];if(E.layer===o&&E.listener===d){for(const A in E.delegates)this.off(A,E.delegates[A]);return y.splice(b,1),this}}})(),this)}queryRenderedFeatures(v,o){if(!this.style)return[];let d;const p=v instanceof l.P||Array.isArray(v),y=p?v:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:v)||{},y instanceof l.P||typeof y[0]=="number")d=[l.P.convert(y)];else{const b=l.P.convert(y[0]),E=l.P.convert(y[1]);d=[b,new l.P(E.x,b.y),E,new l.P(b.x,E.y),b]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(v,o){return this.style.querySourceFeatures(v,o)}setStyle(v,o){return(o=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(v,o))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const o=this._locale[v];if(o==null)throw new Error(`Missing UI string '${v}'`);return o}_updateStyle(v,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,o));const d=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Zn(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,o,d):this.style.loadJSON(v,o,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,o){if(typeof v=="string"){const d=this._requestManager.transformRequest(v,z.Style);l.f(d,(p,y)=>{p?this.fire(new l.j(p)):y&&this._updateDiff(y,o)})}else typeof v=="object"&&this._updateDiff(v,o)}_updateDiff(v,o){try{this.style.setState(v,o)&&this._update(!0)}catch(d){l.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(v,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(v,o){return this._lazyInitEmptyStyle(),this.style.addSource(v,o),this._update(!0)}isSourceLoaded(v){const o=this.style&&this.style.sourceCaches[v];if(o!==void 0)return o.loaded();this.fire(new l.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const o=this.style.sourceCaches[v.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===v.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Dg(this.painter,o,v),this.painter.renderToTexture=new uh(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==v.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.k("terrain",{terrain:v})),this}getTerrain(){var v,o;return(o=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const o in v){const d=v[o]._tiles;for(const p in d){const y=d[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(v,o,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,o,d)}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,o,d={}){const{pixelRatio:p=1,sdf:y=!1,stretchX:b,stretchY:E,content:A}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||l.a(o))){if(o.width===void 0||o.height===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:O,data:j}=o,V=o;return this.style.addImage(v,{data:new l.R({width:k,height:O},new Uint8Array(j)),pixelRatio:p,stretchX:b,stretchY:E,content:A,sdf:y,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v),this}}{const{width:k,height:O,data:j}=l.h.getImageData(o);this.style.addImage(v,{data:new l.R({width:k,height:O},j),pixelRatio:p,stretchX:b,stretchY:E,content:A,sdf:y,version:0})}}updateImage(v,o){const d=this.style.getImage(v);if(!d)return this.fire(new l.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||l.a(o)?l.h.getImageData(o):o,{width:y,height:b,data:E}=p;if(y===void 0||b===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==d.data.width||b!==d.data.height)return this.fire(new l.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(o instanceof HTMLImageElement||l.a(o));return d.data.replace(E,A),this.style.updateImage(v,d),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new l.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,o){W.getImage(this._requestManager.transformRequest(v,z.Image),o)}listImages(){return this.style.listImages()}addLayer(v,o){return this._lazyInitEmptyStyle(),this.style.addLayer(v,o),this._update(!0)}moveLayer(v,o){return this.style.moveLayer(v,o),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,o,d){return this.style.setLayerZoomRange(v,o,d),this._update(!0)}setFilter(v,o,d={}){return this.style.setFilter(v,o,d),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,o,d,p={}){return this.style.setPaintProperty(v,o,d,p),this._update(!0)}getPaintProperty(v,o){return this.style.getPaintProperty(v,o)}setLayoutProperty(v,o,d,p={}){return this.style.setLayoutProperty(v,o,d,p),this._update(!0)}getLayoutProperty(v,o){return this.style.getLayoutProperty(v,o)}setGlyphs(v,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,o,d,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,o,d=>{d||this._update(!0)}),this}setLight(v,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(v,o){return this.style.setFeatureState(v,o),this._update()}removeFeatureState(v,o){return this.style.removeFeatureState(v,o),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,o=0;return this._container&&(v=this._container.clientWidth||400,o=this._container.clientHeight||300),[v,o]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const o=this._canvasContainer=_.create("div","maplibregl-canvas-container",v);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=_.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const y=this._controlContainer=_.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{b[E]=_.create("div",`maplibregl-ctrl-${E} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=_.create("div","maplibregl-cooperative-gesture-screen",this._container);let v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${v}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){_.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(v,o,d){this._canvas.width=Math.floor(d*v),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:v},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const d=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!d){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new $a(d,this.transform),S.testSupport(d)}_onCooperativeGesture(v,o,d){return!o&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=l.h.now();this.style.zoomHistory.update(y,b);const E=new l.a8(y,{now:b,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),A=E.crossFadingFactor();A===1&&A===this._crossFadingFactor||(d=!0,this._crossFadingFactor=A),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new l.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.bg.mark(l.bh.load),this.fire(new l.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,l.bg.mark(l.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_.remove(this._canvasContainer),_.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.bg.clearMetrics(),this._removed=!0,this.fire(new l.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.h.frame(v=>{l.bg.frame(v),this._frame=null,this._render(v)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Zt}getCameraTargetElevation(){return this.transform.elevation}},Gn.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);o.title=p,o.setAttribute("aria-label",p)},this.options=l.e({},Af,v),this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=_.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new If(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,o){const d=_.create("button",v,this._container);return d.type="button",d.addEventListener("click",o),d}},Gn.GeolocateControl=class extends l.E{constructor(v){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new l.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new l.L(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,y=this._map.getBearing(),b=l.e({bearing:y},this.options.fitBoundsOptions),E=ht.fromLngLat(d,p);this._map.fitBounds(E,b,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new l.L(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Dl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=_.create("button","maplibregl-ctrl-geolocate",this._container),_.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wa({element:this._dotElement}),this._circleElement=_.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.k("trackuserlocationend")))})}},this.options=l.e({},br,v)}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,d=!1){Rr===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Rr=p.state!=="denied",o(Rr)}).catch(()=>{Rr=!!window.navigator.geolocation,o(Rr)}):(Rr=!!window.navigator.geolocation,o(Rr)):o(Rr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,yr=0,Dl=!1}_isOutOfMapMaxBounds(v){const o=this._map.getMaxBounds(),d=v.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),o=v.getSouthEast(),d=v.getNorthEast(),p=o.distanceTo(d),y=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":yr--,Dl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),yr++,yr>1?(v={maximumAge:6e5,timeout:0},Dl=!0):(v=this.options.positionOptions,Dl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Gn.AttributionControl=ps,Gn.LogoControl=sr,Gn.ScaleControl=class{constructor(v){this._onMove=()=>{Zc(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Zc(this._map,this._container,this.options)},this.options=l.e({},qc,v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Gn.FullscreenControl=class extends l.E{constructor(v={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=_.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Gn.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=v}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_.create("button","maplibregl-ctrl-terrain",this._container),_.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Gn.Popup=class extends l.E{constructor(v){super(),this.remove=()=>(this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.k("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kf(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const y=Fl(this.options.offset);if(!p){const E=this._container.offsetWidth,A=this._container.offsetHeight;let k;k=d.y+y.bottom.y<A?["top"]:d.y>this._map.transform.height-A?["bottom"]:[],d.x<E/2?k.push("left"):d.x>this._map.transform.width-E/2&&k.push("right"),p=k.length===0?"bottom":k.join("-")}const b=d.add(y[p]).round();_.setTransform(this._container,`${ks[p]} translate(${b.x}px,${b.y}px)`),Fg(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Mf),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=l.L.convert(v),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const o=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=v;p=d.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){this._container&&this._container.classList.add(v)}removeClassName(v){this._container&&this._container.classList.remove(v)}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}_createCloseButton(){this.options.closeButton&&(this._closeButton=_.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Lf);v&&v.focus()}},Gn.Marker=Wa,Gn.Style=Zn,Gn.LngLat=l.L,Gn.LngLatBounds=ht,Gn.Point=l.P,Gn.MercatorCoordinate=l.U,Gn.Evented=l.E,Gn.AJAXError=l.bi,Gn.config=l.c,Gn.CanvasSource=mn,Gn.GeoJSONSource=nt,Gn.ImageSource=cn,Gn.RasterDEMTileSource=Wt,Gn.RasterTileSource=bt,Gn.VectorTileSource=xt,Gn.VideoSource=en,Gn.setRTLTextPlugin=l.bj,Gn.getRTLTextPluginStatus=l.bk,Gn.prewarm=function(){Qe().acquire(kt)},Gn.clearPrewarmedResources=function(){const v=zn;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(kt),zn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Rf.extend(Gn,{isSafari:l.ac,getPerformanceMetrics:l.bg.getPerformanceMetrics}),Gn});var h=i;return h})})(vO);var nq=vO.exports;const rq=Mm(nq),iq=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,sq=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xI=[0,0,0,255],oq={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:xI},getLineColor:{type:"accessor",value:xI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class O2 extends Nu{getShaders(){return super.getShaders({vs:iq,fs:sq,modules:[P2,C2]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,stroked:h,filled:l,billboard:m,antialiasing:_,lineWidthUnits:S,lineWidthScale:P,lineWidthMinPixels:C,lineWidthMaxPixels:L}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:h?1:0,filled:l,billboard:m,antialiasing:_,radiusUnits:dm[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,lineWidthUnits:dm[S],lineWidthScale:P,lineWidthMinPixels:C,lineWidthMaxPixels:L}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new _m(e,{...this.getShaders(),id:this.props.id,geometry:new x2({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}J(O2,"defaultProps",oq);J(O2,"layerName","ScatterplotLayer");const bO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function wO(t,e,n={}){return aq(t,n)!==e?(cq(t,n),!0):!1}function aq(t,e={}){return Math.sign(lq(t,e))}function lq(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let a=0;for(let h=n,l=r-i;h<r;h+=i)a+=(t[h]-t[l])*(t[h+1]+t[l+1]),l=h;return a/2}function cq(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,a=(r-n)/i,h=Math.floor(a/2);for(let l=0;l<h;++l){const m=n+l*i,_=n+(a-1-l)*i;for(let S=0;S<i;++S){const P=t[m+S];t[m+S]=t[_+S],t[_+S]=P}}}function aa(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let a=0;a<n;a++)if(t[r-n+a]!==e[a]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Nw(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function vm(t,e,n,r,i=[]){const a=r+e*n;for(let h=0;h<n;h++)i[h]=t[a+h];return i}function Bw(t,e,n,r,i=[]){let a,h;if(n&8)a=(r[3]-t[1])/(e[1]-t[1]),h=3;else if(n&4)a=(r[1]-t[1])/(e[1]-t[1]),h=1;else if(n&2)a=(r[2]-t[0])/(e[0]-t[0]),h=2;else if(n&1)a=(r[0]-t[0])/(e[0]-t[0]),h=0;else return null;for(let l=0;l<t.length;l++)i[l]=(h&1)===l?r[h]:a*(e[l]-t[l])+t[l];return i}function b0(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function SO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:a=[0,0],startIndex:h=0,endIndex:l=t.length}=e||{},m=(l-h)/n;let _=[];const S=[_],P=vm(t,0,n,h);let C,L;const R=EO(P,i,a,[]),D=[];aa(_,P);for(let W=1;W<m;W++){for(C=vm(t,W,n,h,C),L=b0(C,R);L;){Bw(P,C,L,R,D);const z=b0(D,R);z&&(Bw(P,D,z,R,D),L=z),aa(_,D),Nw(P,D),hq(R,i,L),r&&_.length>n&&(_=[],S.push(_),aa(_,P)),L=b0(C,R)}aa(_,C),Nw(P,C)}return r?S:S[0]}const bI=0,uq=1;function Dy(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function TO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:a=[0,0],edgeTypes:h=!1}=n||{},l=[],m=[{pos:t,types:h?new Array(t.length/r).fill(uq):null,holes:e||[]}],_=[[],[]];let S=[];for(;m.length;){const{pos:P,types:C,holes:L}=m.shift();dq(P,r,L[0]||P.length,_),S=EO(_[0],i,a,S);const R=b0(_[1],S);if(R){let D=wI(P,C,r,0,L[0]||P.length,S,R);const W={pos:D[0].pos,types:D[0].types,holes:[]},z={pos:D[1].pos,types:D[1].types,holes:[]};m.push(W,z);for(let N=0;N<L.length;N++)D=wI(P,C,r,L[N],L[N+1]||P.length,S,R),D[0]&&(W.holes.push(W.pos.length),W.pos=Dy(W.pos,D[0].pos),h&&(W.types=Dy(W.types,D[0].types))),D[1]&&(z.holes.push(z.pos.length),z.pos=Dy(z.pos,D[1].pos),h&&(z.types=Dy(z.types,D[1].types)))}else{const D={positions:P};h&&(D.edgeTypes=C),L.length&&(D.holeIndices=L),l.push(D)}}return l}function wI(t,e,n,r,i,a,h){const l=(i-r)/n,m=[],_=[],S=[],P=[],C=[];let L,R,D;const W=vm(t,l-1,n,r);let z=Math.sign(h&8?W[1]-a[3]:W[0]-a[2]),N=e&&e[l-1],F=0,$=0;for(let K=0;K<l;K++)L=vm(t,K,n,r,L),R=Math.sign(h&8?L[1]-a[3]:L[0]-a[2]),D=e&&e[r/n+K],R&&z&&z!==R&&(Bw(W,L,h,a,C),aa(m,C)&&S.push(N),aa(_,C)&&P.push(N)),R<=0?(aa(m,L)&&S.push(D),F-=R):S.length&&(S[S.length-1]=bI),R>=0?(aa(_,L)&&P.push(D),$+=R):P.length&&(P[P.length-1]=bI),Nw(W,L),z=R,N=D;return[F?{pos:m,types:e&&S}:null,$?{pos:_,types:e&&P}:null]}function EO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],a=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=a,r[2]=i+e,r[3]=a+e,r}function hq(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function dq(t,e,n,r){let i=1/0,a=-1/0,h=1/0,l=-1/0;for(let m=0;m<n;m+=e){const _=t[m],S=t[m+1];i=_<i?_:i,a=_>a?_:a,h=S<h?S:h,l=S>l?S:l}return r[0][0]=i,r[0][1]=h,r[1][0]=a,r[1][1]=l,r}const fq=85.051129;function pq(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:a=!0}=e||{},h=t.slice(r,i);PO(h,n,0,i-r);const l=SO(h,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(a)for(const m of l)CO(m,n);return l}function mq(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:a=!1}=n||{};e=e||[];const h=[],l=[];let m=0,_=0;for(let P=0;P<=e.length;P++){const C=e[P]||t.length,L=_,R=gq(t,r,m,C);for(let D=R;D<C;D++)h[_++]=t[D];for(let D=m;D<R;D++)h[_++]=t[D];PO(h,r,L,_),yq(h,r,L,_,n==null?void 0:n.maxLatitude),m=C,l[P]=_}l.pop();const S=TO(h,l,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:a});if(i)for(const P of S)CO(P.positions,r);return S}function gq(t,e,n,r){let i=-1,a=-1;for(let h=n+1;h<r;h+=e){const l=Math.abs(t[h]);l>i&&(i=l,a=h-1)}return a}function yq(t,e,n,r,i=fq){const a=t[n],h=t[r-e];if(Math.abs(a-h)>180){const l=vm(t,0,e,n);l[0]+=Math.round((h-a)/360)*360,aa(t,l),l[1]=Math.sign(l[1])*i,aa(t,l),l[0]=a,aa(t,l)}}function PO(t,e,n,r){let i=t[0],a;for(let h=n;h<r;h+=e){a=t[h];const l=a-i;(l>180||l<-180)&&(a-=Math.round(l/360)*360),t[h]=i=a}}function CO(t,e){let n;const r=t.length/e;for(let a=0;a<r&&(n=t[a*e],(n+180)%360===0);a++);const i=-Math.round(n/360)*360;if(i!==0)for(let a=0;a<r;a++)t[a*e]+=i}function _q(t,e,n,r){let i;if(Array.isArray(t[0])){const a=t.length*e;i=new Array(a);for(let h=0;h<t.length;h++)for(let l=0;l<e;l++)i[h*e+l]=t[h][l]||0}else i=t;return n?SO(i,{size:e,gridResolution:n}):r?pq(i,{size:e}):i}const vq=1,xq=2,qb=4;class bq extends mO{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?_q(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(SI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&SI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:a,geometrySize:h}=n;r.fill(0,a,a+h),i?(r[a]=qb,r[a+h-2]=qb):(r[a]+=vq,r[a+h-2]+=xq),r[a+h-1]=qb}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:a}=n,h=new Array(3);for(let l=i,m=0;m<a;l++,m++)this.getPointOnPath(e,m,h),r[l*3]=h[0],r[l*3+1]=h[1],r[l*3+2]=h[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const a=n*i;return r[0]=e[a],r[1]=e[a+1],r[2]=i===3&&e[a+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function SI(t){return Array.isArray(t[0])}const wq=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Sq=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,AO=[0,0,0,255],Tq={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:AO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Zb={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class q_ extends Nu{constructor(...e){super(...e),J(this,"state",void 0)}getShaders(){return super.getShaders({vs:wq,fs:Sq,modules:[P2,C2]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Zb,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Zb,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Zb,defaultValue:AO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:a})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,a)}}),this.setState({pathTesselator:new bq({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,m=n.data.attributes||{};l.updateGeometry({data:n.data,geometryBuffer:m.getPath,buffers:m,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var h;const{gl:l}=this.context;(h=this.state.model)===null||h===void 0||h.delete(),this.state.model=this._getModel(l),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:a,widthUnits:h,widthScale:l,widthMinPixels:m,widthMaxPixels:_}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:dm[h],widthScale:l,miterLimit:a,widthMinPixels:m,widthMaxPixels:_}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new _m(e,{...this.getShaders(),id:this.props.id,geometry:new x2({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}J(q_,"defaultProps",Tq);J(q_,"layerName","PathLayer");var z2={exports:{}};z2.exports=Z_;z2.exports.default=Z_;function Z_(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,a=IO(t,0,i,n,!0),h=[];if(!a||a.next===a.prev)return h;var l,m,_,S,P,C,L;if(r&&(a=Iq(t,e,a,n)),t.length>80*n){l=_=t[0],m=S=t[1];for(var R=n;R<i;R+=n)P=t[R],C=t[R+1],P<l&&(l=P),C<m&&(m=C),P>_&&(_=P),C>S&&(S=C);L=Math.max(_-l,S-m),L=L!==0?32767/L:0}return xm(a,h,n,l,m,L,0),h}function IO(t,e,n,r,i){var a,h;if(i===Uw(t,e,n,r)>0)for(a=e;a<n;a+=r)h=TI(a,t[a],t[a+1],h);else for(a=n-r;a>=e;a-=r)h=TI(a,t[a],t[a+1],h);return h&&X_(h,h.next)&&(wm(h),h=h.next),h}function Mu(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(X_(n,n.next)||Fr(n.prev,n,n.next)===0)){if(wm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function xm(t,e,n,r,i,a,h){if(t){!h&&a&&Oq(t,r,i,a);for(var l=t,m,_;t.prev!==t.next;){if(m=t.prev,_=t.next,a?Pq(t,r,i,a):Eq(t)){e.push(m.i/n|0),e.push(t.i/n|0),e.push(_.i/n|0),wm(t),t=_.next,l=_.next;continue}if(t=_,t===l){h?h===1?(t=Cq(Mu(t),e,n),xm(t,e,n,r,i,a,2)):h===2&&Aq(t,e,n,r,i,a):xm(Mu(t),e,n,r,i,a,1);break}}}}function Eq(t){var e=t.prev,n=t,r=t.next;if(Fr(e,n,r)>=0)return!1;for(var i=e.x,a=n.x,h=r.x,l=e.y,m=n.y,_=r.y,S=i<a?i<h?i:h:a<h?a:h,P=l<m?l<_?l:_:m<_?m:_,C=i>a?i>h?i:h:a>h?a:h,L=l>m?l>_?l:_:m>_?m:_,R=r.next;R!==e;){if(R.x>=S&&R.x<=C&&R.y>=P&&R.y<=L&&td(i,l,a,m,h,_,R.x,R.y)&&Fr(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function Pq(t,e,n,r){var i=t.prev,a=t,h=t.next;if(Fr(i,a,h)>=0)return!1;for(var l=i.x,m=a.x,_=h.x,S=i.y,P=a.y,C=h.y,L=l<m?l<_?l:_:m<_?m:_,R=S<P?S<C?S:C:P<C?P:C,D=l>m?l>_?l:_:m>_?m:_,W=S>P?S>C?S:C:P>C?P:C,z=jw(L,R,e,n,r),N=jw(D,W,e,n,r),F=t.prevZ,$=t.nextZ;F&&F.z>=z&&$&&$.z<=N;){if(F.x>=L&&F.x<=D&&F.y>=R&&F.y<=W&&F!==i&&F!==h&&td(l,S,m,P,_,C,F.x,F.y)&&Fr(F.prev,F,F.next)>=0||(F=F.prevZ,$.x>=L&&$.x<=D&&$.y>=R&&$.y<=W&&$!==i&&$!==h&&td(l,S,m,P,_,C,$.x,$.y)&&Fr($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;F&&F.z>=z;){if(F.x>=L&&F.x<=D&&F.y>=R&&F.y<=W&&F!==i&&F!==h&&td(l,S,m,P,_,C,F.x,F.y)&&Fr(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;$&&$.z<=N;){if($.x>=L&&$.x<=D&&$.y>=R&&$.y<=W&&$!==i&&$!==h&&td(l,S,m,P,_,C,$.x,$.y)&&Fr($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function Cq(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!X_(i,a)&&kO(i,r,r.next,a)&&bm(i,a)&&bm(a,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),wm(r),wm(r.next),r=t=a),r=r.next}while(r!==t);return Mu(r)}function Aq(t,e,n,r,i,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&Fq(h,l)){var m=MO(h,l);h=Mu(h,h.next),m=Mu(m,m.next),xm(h,e,n,r,i,a,0),xm(m,e,n,r,i,a,0);return}l=l.next}h=h.next}while(h!==t)}function Iq(t,e,n,r){var i=[],a,h,l,m,_;for(a=0,h=e.length;a<h;a++)l=e[a]*r,m=a<h-1?e[a+1]*r:t.length,_=IO(t,l,m,r,!1),_===_.next&&(_.steiner=!0),i.push(Dq(_));for(i.sort(kq),a=0;a<i.length;a++)n=Mq(i[a],n);return n}function kq(t,e){return t.x-e.x}function Mq(t,e){var n=Lq(t,e);if(!n)return e;var r=MO(n,t);return Mu(r,r.next),Mu(n,n.next)}function Lq(t,e){var n=e,r=t.x,i=t.y,a=-1/0,h;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=r&&l>a&&(a=l,h=n.x<n.next.x?n:n.next,l===r))return h}n=n.next}while(n!==e);if(!h)return null;var m=h,_=h.x,S=h.y,P=1/0,C;n=h;do r>=n.x&&n.x>=_&&r!==n.x&&td(i<S?r:a,i,_,S,i<S?a:r,i,n.x,n.y)&&(C=Math.abs(i-n.y)/(r-n.x),bm(n,t)&&(C<P||C===P&&(n.x>h.x||n.x===h.x&&Rq(h,n)))&&(h=n,P=C)),n=n.next;while(n!==m);return h}function Rq(t,e){return Fr(t.prev,t,e.prev)<0&&Fr(e.next,t,t.next)<0}function Oq(t,e,n,r){var i=t;do i.z===0&&(i.z=jw(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,zq(i)}function zq(t){var e,n,r,i,a,h,l,m,_=1;do{for(n=t,t=null,a=null,h=0;n;){for(h++,r=n,l=0,e=0;e<_&&(l++,r=r.nextZ,!!r);e++);for(m=_;l>0||m>0&&r;)l!==0&&(m===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,m--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,_*=2}while(h>1);return t}function jw(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Dq(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function td(t,e,n,r,i,a,h,l){return(i-h)*(e-l)>=(t-h)*(a-l)&&(t-h)*(r-l)>=(n-h)*(e-l)&&(n-h)*(a-l)>=(i-h)*(r-l)}function Fq(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Nq(t,e)&&(bm(t,e)&&bm(e,t)&&Bq(t,e)&&(Fr(t.prev,t,e.prev)||Fr(t,e.prev,e))||X_(t,e)&&Fr(t.prev,t,t.next)>0&&Fr(e.prev,e,e.next)>0)}function Fr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function X_(t,e){return t.x===e.x&&t.y===e.y}function kO(t,e,n,r){var i=Ny(Fr(t,e,n)),a=Ny(Fr(t,e,r)),h=Ny(Fr(n,r,t)),l=Ny(Fr(n,r,e));return!!(i!==a&&h!==l||i===0&&Fy(t,n,e)||a===0&&Fy(t,r,e)||h===0&&Fy(n,t,r)||l===0&&Fy(n,e,r))}function Fy(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ny(t){return t>0?1:t<0?-1:0}function Nq(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&kO(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function bm(t,e){return Fr(t.prev,t,t.next)<0?Fr(t,e,t.next)>=0&&Fr(t,t.prev,e)>=0:Fr(t,e,t.prev)<0||Fr(t,t.next,e)<0}function Bq(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function MO(t,e){var n=new Vw(t.i,t.x,t.y),r=new Vw(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function TI(t,e,n,r){var i=new Vw(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function wm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Vw(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Z_.deviation=function(t,e,n,r){var i=e&&e.length,a=i?e[0]*n:t.length,h=Math.abs(Uw(t,0,a,n));if(i)for(var l=0,m=e.length;l<m;l++){var _=e[l]*n,S=l<m-1?e[l+1]*n:t.length;h-=Math.abs(Uw(t,_,S,n))}var P=0;for(l=0;l<r.length;l+=3){var C=r[l]*n,L=r[l+1]*n,R=r[l+2]*n;P+=Math.abs((t[C]-t[R])*(t[L+1]-t[C+1])-(t[C]-t[L])*(t[R+1]-t[C+1]))}return h===0&&P===0?0:Math.abs((P-h)/h)};function Uw(t,e,n,r){for(var i=0,a=e,h=n-r;a<n;a+=r)i+=(t[h]-t[a])*(t[a+1]+t[h+1]),h=a;return i}Z_.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var h=0;h<e;h++)n.vertices.push(t[i][a][h]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var jq=z2.exports;const Vq=Mm(jq),By=bO.CLOCKWISE,EI=bO.COUNTER_CLOCKWISE,lc={isClosed:!0};function Uq(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Ip(t){return"positions"in t?t.positions:t}function w0(t){return"holeIndices"in t?t.holeIndices:null}function $q(t){return Array.isArray(t[0])}function Gq(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Wq(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Hq(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function PI(t,e,n,r,i){let a=e;const h=n.length;for(let l=0;l<h;l++)for(let m=0;m<r;m++)t[a++]=n[l][m]||0;if(!Wq(n))for(let l=0;l<r;l++)t[a++]=n[0][l]||0;return lc.start=e,lc.end=a,lc.size=r,wO(t,i,lc),a}function CI(t,e,n,r,i=0,a,h){a=a||n.length;const l=a-i;if(l<=0)return e;let m=e;for(let _=0;_<l;_++)t[m++]=n[i+_];if(!Hq(n,r,i,a))for(let _=0;_<r;_++)t[m++]=n[i+_];return lc.start=e,lc.end=m,lc.size=r,wO(t,h,lc),m}function LO(t,e){Uq(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:a}=t;if(a){let h=0;for(let l=0;l<=a.length;l++)h=CI(n,h,i,e,a[l-1],a[l],l===0?By:EI),r.push(h);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!$q(t))return CI(n,0,t,e,0,n.length,By),n;if(!Gq(t)){let i=0;for(const[a,h]of t.entries())i=PI(n,i,h,e,a===0?By:EI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return PI(n,0,t,e,By),n}function Xb(t,e,n){const r=t.length/3;let i=0;for(let a=0;a<r;a++){const h=(a+1)%r;i+=t[a*3+e]*t[h*3+n],i-=t[h*3+e]*t[a*3+n]}return Math.abs(i/2)}function AI(t,e,n,r){const i=t.length/3;for(let a=0;a<i;a++){const h=a*3,l=t[h+0],m=t[h+1],_=t[h+2];t[h+e]=l,t[h+n]=m,t[h+r]=_}}function qq(t,e,n,r){let i=w0(t);i&&(i=i.map(l=>l/e));let a=Ip(t);const h=r&&e===3;if(n){const l=a.length;a=a.slice();const m=[];for(let _=0;_<l;_+=e){m[0]=a[_],m[1]=a[_+1],h&&(m[2]=a[_+2]);const S=n(m);a[_]=S[0],a[_+1]=S[1],h&&(a[_+2]=S[2])}}if(h){const l=Xb(a,0,1),m=Xb(a,0,2),_=Xb(a,1,2);if(!l&&!m&&!_)return[];l>m&&l>_||(m>_?(n||(a=a.slice()),AI(a,0,2,1)):(n||(a=a.slice()),AI(a,2,0,1)))}return Vq(a,i,e)}class Zq extends mO{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=LO(e,this.positionSize);return this.opts.resolution?TO(Ip(n),w0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?mq(Ip(n),w0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(II(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Ip(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&II(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:a,indexStarts:h,typedArrayManager:l}=this;let m=a.indices;if(!m||!e)return;let _=i;const S=qq(e,this.positionSize,this.opts.preproject,this.opts.full3d);m=l.allocate(m,i+S.length,{copy:!0});for(let P=0;P<S.length;P++)m[_++]=S[P]+r;h[n+1]=i+S.length,a.indices=m}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:a}=this;if(!i||!e)return;const h=Ip(e);for(let l=n,m=0;m<r;l++,m++){const _=h[m*a],S=h[m*a+1],P=a>2?h[m*a+2]:0;i[l*3]=_,i[l*3+1]=S,i[l*3+2]=P}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,a=this.attributes.vertexValid,h=e&&w0(e);if(e&&e.edgeTypes?a.set(e.edgeTypes,n):a.fill(1,n,n+r),h)for(let l=0;l<h.length;l++)a[n+h[l]/i-1]=0;a[n+r-1]=0}}function II(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const RO=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Xq=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(RO,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),Yq=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(RO,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Kq=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,h_=[0,0,0,255],Jq={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:h_},getLineColor:{type:"accessor",value:h_},material:!0},jy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class D2 extends Nu{constructor(...e){super(...e),J(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?Xq:Yq,fs:Kq,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[P2,t9,C2]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===qn.DEFAULT&&(r=qn.LNGLAT);let a;r===qn.LNGLAT&&(i?a=n.projectPosition.bind(n):a=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Zq({preproject:a,fp64:this.use64bitPositions(),IndexType:!e||p2(e,Tr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const h=this.getAttributeManager(),l=!0;h.remove(["instancePickingColors"]),h.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:jy,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,transition:jy,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:jy,accessor:"getFillColor",defaultValue:h_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:jy,accessor:"getLineColor",defaultValue:h_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(m,{index:_,target:S})=>this.encodePickingColor(m&&m.__source?m.__source.index:_,S),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:a}=this.props,{topModel:h,sideModel:l,polygonTesselator:m}=this.state,_={...e,extruded:!!n,elevationScale:a};l&&(l.setInstanceCount(m.instanceCount-1),l.setUniforms(_),i&&(l.setDrawMode(3),l.setUniforms({isWireframe:!0}).draw()),r&&(l.setDrawMode(6),l.setUniforms({isWireframe:!1}).draw())),h&&(h.setVertexCount(m.vertexCount),h.setUniforms(_).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,a=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var l;(l=this.state.models)===null||l===void 0||l.forEach(m=>m.delete()),this.setState(this._getModels(this.context.gl)),a.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:a}=this.state,h=e.data.attributes||{};a.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:h.getPolygon,buffers:h,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let a,h;if(r){const l=this.getShaders("top");l.defines.NON_INSTANCED_MODEL=1,a=new _m(e,{...l,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(h=new _m(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new x2({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),h.userData.excludeAttributes={indices:!0}),{models:[h,a].filter(Boolean),topModel:a,sideModel:h}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}J(D2,"defaultProps",Jq);J(D2,"layerName","SolidPolygonLayer");function Qq({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:a=1/0}=n,h=t.length;let l=h,m=h;for(let C=0;C<h;C++){const L=e(t[C]);if(l>C&&L>=i&&(l=C),L>=a){m=C;break}}let _=l;const P=m-l!==r.length?t.slice(m):void 0;for(let C=0;C<r.length;C++)t[_++]=r[C];if(P){for(let C=0;C<P.length;C++)t[_++]=P[C];t.length=_}return{startRow:l,endRow:l+r.length}}const OO=[0,0,0,255],eZ=[0,0,0,255],tZ={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:eZ},getLineColor:{type:"accessor",value:OO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class F2 extends pO{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&hr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(a=>Qq({data:r,getIndex:h=>h.__source.index,dataRange:a,replace:this._getPaths(a)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:a}=this.props,h=[],l=i==="XY"?2:3,{startRow:m,endRow:_}=e,{iterable:S,objectInfo:P}=I2(n,m,_);for(const C of S){P.index++;let L=r(C,P);a&&(L=LO(L,l));const{holeIndices:R}=L,D=L.positions||L;if(R)for(let W=0;W<=R.length;W++){const z=D.slice(R[W-1]||0,R[W]||D.length);h.push(this.getSubLayerRow({path:z},C,P.index))}else h.push(this.getSubLayerRow({path:D},C,P.index))}return h}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:a,wireframe:h,_normalize:l,_windingOrder:m,elevationScale:_,transitions:S,positionFormat:P}=this.props,{lineWidthUnits:C,lineWidthScale:L,lineWidthMinPixels:R,lineWidthMaxPixels:D,lineJointRounded:W,lineMiterLimit:z,lineDashJustified:N}=this.props,{getFillColor:F,getLineColor:$,getLineWidth:K,getLineDashArray:ne,getElevation:se,getPolygon:xe,updateTriggers:Se,material:_e}=this.props,{paths:Re,pathsDiff:De}=this.state,Ve=this.getSubLayerClass("fill",D2),je=this.getSubLayerClass("stroke",q_),We=this.shouldRenderSubLayer("fill",Re)&&new Ve({_dataDiff:n,extruded:a,elevationScale:_,filled:i,wireframe:h,_normalize:l,_windingOrder:m,getElevation:se,getFillColor:F,getLineColor:a&&h?$:OO,material:_e,transitions:S},this.getSubLayerProps({id:"fill",updateTriggers:Se&&{getPolygon:Se.getPolygon,getElevation:Se.getElevation,getFillColor:Se.getFillColor,lineColors:a&&h,getLineColor:Se.getLineColor}}),{data:e,positionFormat:P,getPolygon:xe}),Ze=!a&&r&&this.shouldRenderSubLayer("stroke",Re)&&new je({_dataDiff:De&&(()=>De),widthUnits:C,widthScale:L,widthMinPixels:R,widthMaxPixels:D,jointRounded:W,miterLimit:z,dashJustified:N,_pathType:"loop",transitions:S&&{getWidth:S.getLineWidth,getColor:S.getLineColor,getPath:S.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(K),getDashArray:this.getSubLayerAccessor(ne)},this.getSubLayerProps({id:"stroke",updateTriggers:Se&&{getWidth:Se.getLineWidth,getColor:Se.getLineColor,getDashArray:Se.getLineDashArray}}),{data:Re,positionFormat:P,getPath:Ye=>Ye.path});return[!a&&We,Ze,a&&We]}}J(F2,"layerName","PolygonLayer");J(F2,"defaultProps",tZ);const nZ={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class N2 extends q_{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}J(N2,"layerName","TripsLayer");J(N2,"defaultProps",nZ);function zO(t,e,n=64){const r={latitude:t[1],longitude:t[0]},i=e,a=[],h=i/(111.32*Math.cos(r.latitude*Math.PI/180)),l=i/110.574;let m,_,S;for(var P=0;P<n;P++)m=P/n*(2*Math.PI),_=h*Math.cos(m),S=l*Math.sin(m),a.push([r.longitude+_,r.latitude+S]);return a.push(a[0]),a}function Ih(t){const e=t.match(/\d+(\.\d)?/g).map(Number);return e[3]&&(e[3]*=255),e}function kh(t){if(!t)return"rgb(0, 0, 0)";const e=[...t];return e[3]&&(e[3]/=255),`rgb${t.length>=4?"a":""}(${e.join(", ")})`}const rZ=["footway","street_lamp","steps","pedestrian","track","path"];function DO(t){const n=`
    [out:json];(
        way[highway]${rZ.map(r=>`[highway!="${r}"]`).join("")}[footway!="*"]
        (${t[0].latitude},${t[0].longitude},${t[1].latitude},${t[1].longitude});
        node(w);
    );
    out skel;`;return fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:n})}class iZ{constructor(e,n){this.node1=e,this.node2=n,this.visited=!1}getOtherNode(e){return e===this.node1?this.node2:this.node1}get weight(){return Math.hypot(this.node1.latitude-this.node2.latitude,this.node1.longitude-this.node2.longitude)}}class sZ{constructor(e,n,r){this.edges=[],this.reset(),this.id=e,this.latitude=n,this.longitude=r,this.visited=!1}get totalDistance(){return this.distanceFromStart+this.distanceToEnd}get neighbors(){return this.edges.map(e=>({edge:e,node:e.getOtherNode(this)}))}connectTo(e){const n=new iZ(this,e);this.edges.push(n),e.edges.push(n)}reset(){this.visited=!1,this.distanceFromStart=0,this.distanceToEnd=0,this.parent=null,this.referer=null;for(const e of this.neighbors)e.edge.visited=!1}}class oZ{constructor(){this.startNode=null,this.nodes=new Map}getNode(e){return this.nodes.get(e)}addNode(e,n,r){const i=new sZ(e,n,r);return this.nodes.set(i.id,i),i}}async function kI(t,e){const n=zO([e,t],.15),r=FO(n),a=await(await DO(r)).json();let h;for(const l of a.elements){if(l.type!=="node")continue;if(!h){h=l;continue}const m=Math.sqrt(Math.pow(l.lat-t,2)+Math.pow(l.lon-e,2)),_=Math.sqrt(Math.pow(h.lat-t,2)+Math.pow(h.lon-e,2));m<_&&(h=l)}return h}async function aZ(t,e){const i=(await(await DO(t)).json()).elements,a=new oZ;for(const h of i)if(h.type==="node"){const l=a.addNode(h.id,h.lat,h.lon);l.id===e&&(a.startNode=l)}else if(h.type==="way"){if(!h.nodes||h.nodes.length<2)continue;for(let l=0;l<h.nodes.length-1;l++){const m=a.getNode(h.nodes[l]),_=a.getNode(h.nodes[l+1]);!m||!_||m.connectTo(_)}}if(!a.startNode)throw new Error("Start node was not found.");return a}function FO(t){const e={minLat:Number.MAX_VALUE,maxLat:-Number.MAX_VALUE,minLon:Number.MAX_VALUE,maxLon:-Number.MAX_VALUE};for(const r of t)r[0]<e.minLon&&(e.minLon=r[0]),r[0]>e.maxLon&&(e.maxLon=r[0]),r[1]<e.minLat&&(e.minLat=r[1]),r[1]>e.maxLat&&(e.maxLat=r[1]);return[{latitude:e.minLat,longitude:e.minLon},{latitude:e.maxLat,longitude:e.maxLon}]}class Xm{constructor(){this.finished=!1}start(e,n){this.finished=!1,this.startNode=e,this.endNode=n}nextStep(){return[]}}class MI extends Xm{constructor(){super(),this.openList=[],this.closedList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.closedList=[],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,a)=>a.totalDistance<i.totalDistance?a:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge,l=n.distanceFromStart+Math.hypot(a.longitude-n.longitude,a.latitude-n.latitude);if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),this.openList.includes(a)){if(a.distanceFromStart<=l)continue}else if(this.closedList.includes(a)){if(a.distanceFromStart<=l)continue;this.closedList.splice(this.closedList.indexOf(a),1),this.openList.push(a)}else this.openList.push(a),a.distanceToEnd=Math.hypot(a.longitude-this.endNode.longitude,a.latitude-this.endNode.latitude);a.distanceFromStart=l,a.referer=n,a.parent=n}return this.closedList.push(n),[...e,n]}}class lZ extends Xm{constructor(){super(),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(this.startNode),this.openSetEnd.add(this.endNode),this.closedSetStart=new Set,this.closedSetEnd=new Set}start(e,n){super.start(e,n),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(e),this.openSetEnd.add(n),this.closedSetStart=new Set,this.closedSetEnd=new Set}nextStep(){if(this.finished)return[];const e=[],n=this.getNextFromOpenSet(this.openSetStart,this.closedSetStart);if(n){n.visited=!0,this.closedSetStart.add(n);const i=n.edges.find(a=>a.getOtherNode(n)===n.referer);if(i&&(i.visited=!0),this.openSetEnd.has(n))return this.finished=!0,console.log("found from start"),[n];e.push(n),e.push(...this.updateNeighbors(n,this.openSetStart,this.closedSetStart))}const r=this.getNextFromOpenSet(this.openSetEnd,this.closedSetEnd);if(r){r.visited=!0,this.closedSetEnd.add(r);const i=r.edges.find(a=>a.getOtherNode(r)===r.referer);if(i&&(i.visited=!0),this.openSetStart.has(r))return console.log("found from end"),this.finished=!0,[r];e.push(r),e.push(...this.updateNeighbors(r,this.openSetEnd,this.closedSetEnd))}return e}updateNeighbors(e,n,r){const i=[];for(const a of e.neighbors){const h=a.node,l=a.edge;h.visited&&!l.visited&&(l.visited=!0,h.referer=e,i.push(h)),!r.has(h)&&!h.visited&&(n.add(h),h.prevParent=h.parent,h.parent=e,h.referer=e)}return i}getNextFromOpenSet(e,n){let r=null;for(const i of e)(!r||i.totalDistance<r.totalDistance)&&(n.has(i)||(r=i));return r&&e.delete(r),r}}class cZ extends Xm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[e]}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.shift();n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge;if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),a.visited)continue;const l=n.distanceFromStart+h.weight;if(this.openList.includes(a)){if(l>=a.distanceFromStart)continue}else this.openList.push(a);a.distanceFromStart=l,a.parent=n,a.referer=n}return[...e,n]}}class uZ extends Xm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,a)=>a.distanceToEnd<i.distanceToEnd?a:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge;a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),!a.visited&&(a.distanceToEnd=Math.hypot(a.longitude-this.endNode.longitude,a.latitude-this.endNode.latitude),this.openList.includes(a)||this.openList.push(a),a.referer=n,a.parent=n)}return[...e,n]}}var md;const rd=class rd{constructor(){return $x(rd,md)||(this.endNode=null,this.graph=null,this.finished=!1,this.algorithm=new Xm,cP(rd,md,this)),$x(rd,md)}get startNode(){return this.graph.startNode}getNode(e){var n;return(n=this.graph)==null?void 0:n.getNode(e)}reset(){if(this.finished=!1,!!this.graph)for(const e of this.graph.nodes.keys())this.graph.nodes.get(e).reset()}start(e){switch(this.reset(),e){case"astar":this.algorithm=new MI;break;case"greedy":this.algorithm=new uZ;break;case"dijkstra":this.algorithm=new cZ;break;case"bidirectional":this.algorithm=new lZ;break;default:this.algorithm=new MI;break}this.algorithm.start(this.startNode,this.endNode)}nextStep(){const e=this.algorithm.nextStep();return(this.algorithm.finished||e.length===0)&&(this.finished=!0),e}};md=new WeakMap,lP(rd,md,void 0);let $w=rd;const hZ={black:"#000",white:"#fff"},Sm=hZ,dZ={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Mh=dZ,fZ={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Lh=fZ,pZ={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Rh=pZ,mZ={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Oh=mZ,gZ={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},zh=gZ,yZ={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},pp=yZ,_Z={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},vZ=_Z;function _l(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const xZ=Object.freeze(Object.defineProperty({__proto__:null,default:_l},Symbol.toStringTag,{value:"Module"})),zd="$$material";function re(){return re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},re.apply(null,arguments)}function Gt(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function NO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var bZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,wZ=NO(function(t){return bZ.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),SZ=!1;function TZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function EZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var PZ=function(){function t(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!SZ:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(EZ(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=TZ(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},t}(),rs="-ms-",d_="-moz-",Yn="-webkit-",BO="comm",B2="rule",j2="decl",CZ="@import",jO="@keyframes",AZ="@layer",IZ=Math.abs,Y_=String.fromCharCode,kZ=Object.assign;function MZ(t,e){return Bi(t,0)^45?(((e<<2^Bi(t,0))<<2^Bi(t,1))<<2^Bi(t,2))<<2^Bi(t,3):0}function VO(t){return t.trim()}function LZ(t,e){return(t=e.exec(t))?t[0]:t}function Kn(t,e,n){return t.replace(e,n)}function Gw(t,e){return t.indexOf(e)}function Bi(t,e){return t.charCodeAt(e)|0}function Tm(t,e,n){return t.slice(e,n)}function Pa(t){return t.length}function V2(t){return t.length}function Vy(t,e){return e.push(t),t}function RZ(t,e){return t.map(e).join("")}var K_=1,Dd=1,UO=0,Vs=0,ui=0,qd="";function J_(t,e,n,r,i,a,h){return{value:t,root:e,parent:n,type:r,props:i,children:a,line:K_,column:Dd,length:h,return:""}}function mp(t,e){return kZ(J_("",null,null,"",null,null,0),t,{length:-t.length},e)}function OZ(){return ui}function zZ(){return ui=Vs>0?Bi(qd,--Vs):0,Dd--,ui===10&&(Dd=1,K_--),ui}function so(){return ui=Vs<UO?Bi(qd,Vs++):0,Dd++,ui===10&&(Dd=1,K_++),ui}function Oa(){return Bi(qd,Vs)}function S0(){return Vs}function Ym(t,e){return Tm(qd,t,e)}function Em(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $O(t){return K_=Dd=1,UO=Pa(qd=t),Vs=0,[]}function GO(t){return qd="",t}function T0(t){return VO(Ym(Vs-1,Ww(t===91?t+2:t===40?t+1:t)))}function DZ(t){for(;(ui=Oa())&&ui<33;)so();return Em(t)>2||Em(ui)>3?"":" "}function FZ(t,e){for(;--e&&so()&&!(ui<48||ui>102||ui>57&&ui<65||ui>70&&ui<97););return Ym(t,S0()+(e<6&&Oa()==32&&so()==32))}function Ww(t){for(;so();)switch(ui){case t:return Vs;case 34:case 39:t!==34&&t!==39&&Ww(ui);break;case 40:t===41&&Ww(t);break;case 92:so();break}return Vs}function NZ(t,e){for(;so()&&t+ui!==47+10;)if(t+ui===42+42&&Oa()===47)break;return"/*"+Ym(e,Vs-1)+"*"+Y_(t===47?t:so())}function BZ(t){for(;!Em(Oa());)so();return Ym(t,Vs)}function jZ(t){return GO(E0("",null,null,null,[""],t=$O(t),0,[0],t))}function E0(t,e,n,r,i,a,h,l,m){for(var _=0,S=0,P=h,C=0,L=0,R=0,D=1,W=1,z=1,N=0,F="",$=i,K=a,ne=r,se=F;W;)switch(R=N,N=so()){case 40:if(R!=108&&Bi(se,P-1)==58){Gw(se+=Kn(T0(N),"&","&\f"),"&\f")!=-1&&(z=-1);break}case 34:case 39:case 91:se+=T0(N);break;case 9:case 10:case 13:case 32:se+=DZ(R);break;case 92:se+=FZ(S0()-1,7);continue;case 47:switch(Oa()){case 42:case 47:Vy(VZ(NZ(so(),S0()),e,n),m);break;default:se+="/"}break;case 123*D:l[_++]=Pa(se)*z;case 125*D:case 59:case 0:switch(N){case 0:case 125:W=0;case 59+S:z==-1&&(se=Kn(se,/\f/g,"")),L>0&&Pa(se)-P&&Vy(L>32?RI(se+";",r,n,P-1):RI(Kn(se," ","")+";",r,n,P-2),m);break;case 59:se+=";";default:if(Vy(ne=LI(se,e,n,_,S,i,l,F,$=[],K=[],P),a),N===123)if(S===0)E0(se,e,ne,ne,$,a,P,l,K);else switch(C===99&&Bi(se,3)===110?100:C){case 100:case 108:case 109:case 115:E0(t,ne,ne,r&&Vy(LI(t,ne,ne,0,0,i,l,F,i,$=[],P),K),i,K,P,l,r?$:K);break;default:E0(se,ne,ne,ne,[""],K,0,l,K)}}_=S=L=0,D=z=1,F=se="",P=h;break;case 58:P=1+Pa(se),L=R;default:if(D<1){if(N==123)--D;else if(N==125&&D++==0&&zZ()==125)continue}switch(se+=Y_(N),N*D){case 38:z=S>0?1:(se+="\f",-1);break;case 44:l[_++]=(Pa(se)-1)*z,z=1;break;case 64:Oa()===45&&(se+=T0(so())),C=Oa(),S=P=Pa(F=se+=BZ(S0())),N++;break;case 45:R===45&&Pa(se)==2&&(D=0)}}return a}function LI(t,e,n,r,i,a,h,l,m,_,S){for(var P=i-1,C=i===0?a:[""],L=V2(C),R=0,D=0,W=0;R<r;++R)for(var z=0,N=Tm(t,P+1,P=IZ(D=h[R])),F=t;z<L;++z)(F=VO(D>0?C[z]+" "+N:Kn(N,/&\f/g,C[z])))&&(m[W++]=F);return J_(t,e,n,i===0?B2:l,m,_,S)}function VZ(t,e,n){return J_(t,e,n,BO,Y_(OZ()),Tm(t,2,-2),0)}function RI(t,e,n,r){return J_(t,e,n,j2,Tm(t,0,r),Tm(t,r+1,-1),r)}function dd(t,e){for(var n="",r=V2(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function UZ(t,e,n,r){switch(t.type){case AZ:if(t.children.length)break;case CZ:case j2:return t.return=t.return||t.value;case BO:return"";case jO:return t.return=t.value+"{"+dd(t.children,r)+"}";case B2:t.value=t.props.join(",")}return Pa(n=dd(t.children,r))?t.return=t.value+"{"+n+"}":""}function $Z(t){var e=V2(t);return function(n,r,i,a){for(var h="",l=0;l<e;l++)h+=t[l](n,r,i,a)||"";return h}}function GZ(t){return function(e){e.root||(e=e.return)&&t(e)}}var WZ=function(e,n,r){for(var i=0,a=0;i=a,a=Oa(),i===38&&a===12&&(n[r]=1),!Em(a);)so();return Ym(e,Vs)},HZ=function(e,n){var r=-1,i=44;do switch(Em(i)){case 0:i===38&&Oa()===12&&(n[r]=1),e[r]+=WZ(Vs-1,n,r);break;case 2:e[r]+=T0(i);break;case 4:if(i===44){e[++r]=Oa()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=Y_(i)}while(i=so());return e},qZ=function(e,n){return GO(HZ($O(e),n))},OI=new WeakMap,ZZ=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!OI.get(r))&&!i){OI.set(e,!0);for(var a=[],h=qZ(n,a),l=r.props,m=0,_=0;m<h.length;m++)for(var S=0;S<l.length;S++,_++)e.props[_]=a[m]?h[m].replace(/&\f/g,l[S]):l[S]+" "+h[m]}}},XZ=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function WO(t,e){switch(MZ(t,e)){case 5103:return Yn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Yn+t+d_+t+rs+t+t;case 6828:case 4268:return Yn+t+rs+t+t;case 6165:return Yn+t+rs+"flex-"+t+t;case 5187:return Yn+t+Kn(t,/(\w+).+(:[^]+)/,Yn+"box-$1$2"+rs+"flex-$1$2")+t;case 5443:return Yn+t+rs+"flex-item-"+Kn(t,/flex-|-self/,"")+t;case 4675:return Yn+t+rs+"flex-line-pack"+Kn(t,/align-content|flex-|-self/,"")+t;case 5548:return Yn+t+rs+Kn(t,"shrink","negative")+t;case 5292:return Yn+t+rs+Kn(t,"basis","preferred-size")+t;case 6060:return Yn+"box-"+Kn(t,"-grow","")+Yn+t+rs+Kn(t,"grow","positive")+t;case 4554:return Yn+Kn(t,/([^-])(transform)/g,"$1"+Yn+"$2")+t;case 6187:return Kn(Kn(Kn(t,/(zoom-|grab)/,Yn+"$1"),/(image-set)/,Yn+"$1"),t,"")+t;case 5495:case 3959:return Kn(t,/(image-set\([^]*)/,Yn+"$1$`$1");case 4968:return Kn(Kn(t,/(.+:)(flex-)?(.*)/,Yn+"box-pack:$3"+rs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yn+t+t;case 4095:case 3583:case 4068:case 2532:return Kn(t,/(.+)-inline(.+)/,Yn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Pa(t)-1-e>6)switch(Bi(t,e+1)){case 109:if(Bi(t,e+4)!==45)break;case 102:return Kn(t,/(.+:)(.+)-([^]+)/,"$1"+Yn+"$2-$3$1"+d_+(Bi(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Gw(t,"stretch")?WO(Kn(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Bi(t,e+1)!==115)break;case 6444:switch(Bi(t,Pa(t)-3-(~Gw(t,"!important")&&10))){case 107:return Kn(t,":",":"+Yn)+t;case 101:return Kn(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yn+(Bi(t,14)===45?"inline-":"")+"box$3$1"+Yn+"$2$3$1"+rs+"$2box$3")+t}break;case 5936:switch(Bi(t,e+11)){case 114:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Yn+t+rs+t+t}return t}var YZ=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case j2:e.return=WO(e.value,e.length);break;case jO:return dd([mp(e,{value:Kn(e.value,"@","@"+Yn)})],i);case B2:if(e.length)return RZ(e.props,function(a){switch(LZ(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return dd([mp(e,{props:[Kn(a,/:(read-\w+)/,":"+d_+"$1")]})],i);case"::placeholder":return dd([mp(e,{props:[Kn(a,/:(plac\w+)/,":"+Yn+"input-$1")]}),mp(e,{props:[Kn(a,/:(plac\w+)/,":"+d_+"$1")]}),mp(e,{props:[Kn(a,/:(plac\w+)/,rs+"input-$1")]})],i)}return""})}},KZ=[YZ],HO=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var W=D.getAttribute("data-emotion");W.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||KZ,a={},h,l=[];h=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var W=D.getAttribute("data-emotion").split(" "),z=1;z<W.length;z++)a[W[z]]=!0;l.push(D)});var m,_=[ZZ,XZ];{var S,P=[UZ,GZ(function(D){S.insert(D)})],C=$Z(_.concat(i,P)),L=function(W){return dd(jZ(W),C)};m=function(W,z,N,F){S=N,L(W?W+"{"+z.styles+"}":z.styles),F&&(R.inserted[z.name]=!0)}}var R={key:n,sheet:new PZ({key:n,container:h,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:m};return R.sheet.hydrate(l),R},qO={exports:{}},nr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ii=typeof Symbol=="function"&&Symbol.for,U2=Ii?Symbol.for("react.element"):60103,$2=Ii?Symbol.for("react.portal"):60106,Q_=Ii?Symbol.for("react.fragment"):60107,ev=Ii?Symbol.for("react.strict_mode"):60108,tv=Ii?Symbol.for("react.profiler"):60114,nv=Ii?Symbol.for("react.provider"):60109,rv=Ii?Symbol.for("react.context"):60110,G2=Ii?Symbol.for("react.async_mode"):60111,iv=Ii?Symbol.for("react.concurrent_mode"):60111,sv=Ii?Symbol.for("react.forward_ref"):60112,ov=Ii?Symbol.for("react.suspense"):60113,JZ=Ii?Symbol.for("react.suspense_list"):60120,av=Ii?Symbol.for("react.memo"):60115,lv=Ii?Symbol.for("react.lazy"):60116,QZ=Ii?Symbol.for("react.block"):60121,eX=Ii?Symbol.for("react.fundamental"):60117,tX=Ii?Symbol.for("react.responder"):60118,nX=Ii?Symbol.for("react.scope"):60119;function ho(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case U2:switch(t=t.type,t){case G2:case iv:case Q_:case tv:case ev:case ov:return t;default:switch(t=t&&t.$$typeof,t){case rv:case sv:case lv:case av:case nv:return t;default:return e}}case $2:return e}}}function ZO(t){return ho(t)===iv}nr.AsyncMode=G2;nr.ConcurrentMode=iv;nr.ContextConsumer=rv;nr.ContextProvider=nv;nr.Element=U2;nr.ForwardRef=sv;nr.Fragment=Q_;nr.Lazy=lv;nr.Memo=av;nr.Portal=$2;nr.Profiler=tv;nr.StrictMode=ev;nr.Suspense=ov;nr.isAsyncMode=function(t){return ZO(t)||ho(t)===G2};nr.isConcurrentMode=ZO;nr.isContextConsumer=function(t){return ho(t)===rv};nr.isContextProvider=function(t){return ho(t)===nv};nr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===U2};nr.isForwardRef=function(t){return ho(t)===sv};nr.isFragment=function(t){return ho(t)===Q_};nr.isLazy=function(t){return ho(t)===lv};nr.isMemo=function(t){return ho(t)===av};nr.isPortal=function(t){return ho(t)===$2};nr.isProfiler=function(t){return ho(t)===tv};nr.isStrictMode=function(t){return ho(t)===ev};nr.isSuspense=function(t){return ho(t)===ov};nr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Q_||t===iv||t===tv||t===ev||t===ov||t===JZ||typeof t=="object"&&t!==null&&(t.$$typeof===lv||t.$$typeof===av||t.$$typeof===nv||t.$$typeof===rv||t.$$typeof===sv||t.$$typeof===eX||t.$$typeof===tX||t.$$typeof===nX||t.$$typeof===QZ)};nr.typeOf=ho;qO.exports=nr;var rX=qO.exports,XO=rX,iX={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},sX={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},YO={};YO[XO.ForwardRef]=iX;YO[XO.Memo]=sX;var oX=!0;function aX(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(r+=i+" ")}),r}var KO=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||oX===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},JO=function(e,n,r){KO(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var a=n;do e.insert(n===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function lX(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var cX={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},uX=!1,hX=/[A-Z]|^ms/g,dX=/_EMO_([^_]+?)_([^]*?)_EMO_/g,QO=function(e){return e.charCodeAt(1)===45},zI=function(e){return e!=null&&typeof e!="boolean"},Yb=NO(function(t){return QO(t)?t:t.replace(hX,"-$&").toLowerCase()}),DI=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(dX,function(r,i,a){return Ca={name:i,styles:a,next:Ca},i})}return cX[e]!==1&&!QO(e)&&typeof n=="number"&&n!==0?n+"px":n},fX="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Pm(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return Ca={name:i.name,styles:i.styles,next:Ca},i.name;var a=n;if(a.styles!==void 0){var h=a.next;if(h!==void 0)for(;h!==void 0;)Ca={name:h.name,styles:h.styles,next:Ca},h=h.next;var l=a.styles+";";return l}return pX(t,e,n)}case"function":{if(t!==void 0){var m=Ca,_=n(t);return Ca=m,Pm(t,e,_)}break}}var S=n;if(e==null)return S;var P=e[S];return P!==void 0?P:S}function pX(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Pm(t,e,n[i])+";";else for(var a in n){var h=n[a];if(typeof h!="object"){var l=h;e!=null&&e[l]!==void 0?r+=a+"{"+e[l]+"}":zI(l)&&(r+=Yb(a)+":"+DI(a,l)+";")}else{if(a==="NO_COMPONENT_SELECTOR"&&uX)throw new Error(fX);if(Array.isArray(h)&&typeof h[0]=="string"&&(e==null||e[h[0]]===void 0))for(var m=0;m<h.length;m++)zI(h[m])&&(r+=Yb(a)+":"+DI(a,h[m])+";");else{var _=Pm(t,e,h);switch(a){case"animation":case"animationName":{r+=Yb(a)+":"+_+";";break}default:r+=a+"{"+_+"}"}}}}return r}var FI=/label:\s*([^\s;{]+)\s*(;|$)/g,Ca;function W2(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,i="";Ca=void 0;var a=t[0];if(a==null||a.raw===void 0)r=!1,i+=Pm(n,e,a);else{var h=a;i+=h[0]}for(var l=1;l<t.length;l++)if(i+=Pm(n,e,t[l]),r){var m=a;i+=m[l]}FI.lastIndex=0;for(var _="",S;(S=FI.exec(i))!==null;)_+="-"+S[1];var P=lX(i)+_;return{name:P,styles:i,next:Ca}}var mX=function(e){return e()},ez=m1["useInsertionEffect"]?m1["useInsertionEffect"]:!1,gX=ez||mX,NI=ez||q.useLayoutEffect,tz=q.createContext(typeof HTMLElement<"u"?HO({key:"css"}):null),yX=tz.Provider,nz=function(e){return q.forwardRef(function(n,r){var i=q.useContext(tz);return e(n,i,r)})},Km=q.createContext({}),Kb={exports:{}},BI;function rz(){return BI||(BI=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var a in i)({}).hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Kb)),Kb.exports}rz();var _X=nz(function(t,e){var n=t.styles,r=W2([n],void 0,q.useContext(Km)),i=q.useRef();return NI(function(){var a=e.key+"-global",h=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),l=!1,m=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return e.sheet.tags.length&&(h.before=e.sheet.tags[0]),m!==null&&(l=!0,m.setAttribute("data-emotion",a),h.hydrate([m])),i.current=[h,l],function(){h.flush()}},[e]),NI(function(){var a=i.current,h=a[0],l=a[1];if(l){a[1]=!1;return}if(r.next!==void 0&&JO(e,r.next,!0),h.tags.length){var m=h.tags[h.tags.length-1].nextElementSibling;h.before=m,h.flush()}e.insert("",r,h,!1)},[e,r.name]),null});function cv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return W2(e)}var Zd=function(){var e=cv.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},vX=wZ,xX=function(e){return e!=="theme"},jI=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?vX:xX},VI=function(e,n,r){var i;if(n){var a=n.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(h){return e.__emotion_forwardProp(h)&&a(h)}:a}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},bX=!1,wX=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return KO(n,r,i),gX(function(){return JO(n,r,i)}),null},SX=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,a,h;n!==void 0&&(a=n.label,h=n.target);var l=VI(e,n,r),m=l||jI(i),_=!m("as");return function(){var S=arguments,P=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&P.push("label:"+a+";"),S[0]==null||S[0].raw===void 0)P.push.apply(P,S);else{P.push(S[0][0]);for(var C=S.length,L=1;L<C;L++)P.push(S[L],S[0][L])}var R=nz(function(D,W,z){var N=_&&D.as||i,F="",$=[],K=D;if(D.theme==null){K={};for(var ne in D)K[ne]=D[ne];K.theme=q.useContext(Km)}typeof D.className=="string"?F=aX(W.registered,$,D.className):D.className!=null&&(F=D.className+" ");var se=W2(P.concat($),W.registered,K);F+=W.key+"-"+se.name,h!==void 0&&(F+=" "+h);var xe=_&&l===void 0?jI(N):m,Se={};for(var _e in D)_&&_e==="as"||xe(_e)&&(Se[_e]=D[_e]);return Se.className=F,z&&(Se.ref=z),q.createElement(q.Fragment,null,q.createElement(wX,{cache:W,serialized:se,isStringTag:typeof N=="string"}),q.createElement(N,Se))});return R.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",R.defaultProps=e.defaultProps,R.__emotion_real=R,R.__emotion_base=i,R.__emotion_styles=P,R.__emotion_forwardProp=l,Object.defineProperty(R,"toString",{value:function(){return h===void 0&&bX?"NO_COMPONENT_SELECTOR":"."+h}}),R.withComponent=function(D,W){return t(D,re({},n,W,{shouldForwardProp:VI(R,W,!0)})).apply(void 0,P)},R}},TX=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Hw=SX.bind();TX.forEach(function(t){Hw[t]=Hw(t)});let qw;typeof document=="object"&&(qw=HO({key:"css",prepend:!0}));function EX(t){const{injectFirst:e,children:n}=t;return e&&qw?te.jsx(yX,{value:qw,children:n}):n}function PX(t){return t==null||Object.keys(t).length===0}function iz(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?i=>e(PX(i)?n:i):e;return te.jsx(_X,{styles:r})}/**
 * @mui/styled-engine v5.16.8
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function sz(t,e){return Hw(t,e)}const CX=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},AX=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:iz,StyledEngineProvider:EX,ThemeContext:Km,css:cv,default:sz,internal_processStyles:CX,keyframes:Zd},Symbol.toStringTag,{value:"Module"}));function rc(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function oz(t){if(q.isValidElement(t)||!rc(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=oz(t[n])}),e}function oo(t,e,n={clone:!0}){const r=n.clone?re({},t):t;return rc(t)&&rc(e)&&Object.keys(e).forEach(i=>{q.isValidElement(e[i])?r[i]=e[i]:rc(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&rc(t[i])?r[i]=oo(t[i],e[i],n):n.clone?r[i]=rc(e[i])?oz(e[i]):e[i]:r[i]=e[i]}),r}const IX=Object.freeze(Object.defineProperty({__proto__:null,default:oo,isPlainObject:rc},Symbol.toStringTag,{value:"Module"})),kX=["values","unit","step"],MX=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>re({},n,{[r.key]:r.val}),{})};function az(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=Gt(t,kX),a=MX(e),h=Object.keys(a);function l(C){return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n})`}function m(C){return`@media (max-width:${(typeof e[C]=="number"?e[C]:C)-r/100}${n})`}function _(C,L){const R=h.indexOf(L);return`@media (min-width:${typeof e[C]=="number"?e[C]:C}${n}) and (max-width:${(R!==-1&&typeof e[h[R]]=="number"?e[h[R]]:L)-r/100}${n})`}function S(C){return h.indexOf(C)+1<h.length?_(C,h[h.indexOf(C)+1]):l(C)}function P(C){const L=h.indexOf(C);return L===0?l(h[1]):L===h.length-1?m(h[L]):_(C,h[h.indexOf(C)+1]).replace("@media","@media not all and")}return re({keys:h,values:a,up:l,down:m,between:_,only:S,not:P,unit:n},i)}const LX={borderRadius:4},RX=LX;function $p(t,e){return e?oo(t,e,{clone:!1}):t}const H2={xs:0,sm:600,md:900,lg:1200,xl:1536},UI={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${H2[t]}px)`};function vl(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const a=r.breakpoints||UI;return e.reduce((h,l,m)=>(h[a.up(a.keys[m])]=n(e[m]),h),{})}if(typeof e=="object"){const a=r.breakpoints||UI;return Object.keys(e).reduce((h,l)=>{if(Object.keys(a.values||H2).indexOf(l)!==-1){const m=a.up(l);h[m]=n(e[l],l)}else{const m=l;h[m]=e[m]}return h},{})}return n(e)}function OX(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const a=t.up(i);return r[a]={},r},{}))||{}}function zX(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function $t(t){if(typeof t!="string")throw new Error(_l(7));return t.charAt(0).toUpperCase()+t.slice(1)}const DX=Object.freeze(Object.defineProperty({__proto__:null,default:$t},Symbol.toStringTag,{value:"Module"}));function uv(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function f_(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=uv(t,n)||r,e&&(i=e(i,r,t)),i}function ai(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,a=h=>{if(h[e]==null)return null;const l=h[e],m=h.theme,_=uv(m,r)||{};return vl(h,l,P=>{let C=f_(_,i,P);return P===C&&typeof P=="string"&&(C=f_(_,i,`${e}${P==="default"?"":$t(P)}`,P)),n===!1?C:{[n]:C}})};return a.propTypes={},a.filterProps=[e],a}function FX(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const NX={m:"margin",p:"padding"},BX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},$I={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},jX=FX(t=>{if(t.length>2)if($I[t])t=$I[t];else return[t];const[e,n]=t.split(""),r=NX[e],i=BX[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),q2=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Z2=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...q2,...Z2];function Jm(t,e,n,r){var i;const a=(i=uv(t,e,!1))!=null?i:n;return typeof a=="number"?h=>typeof h=="string"?h:a*h:Array.isArray(a)?h=>typeof h=="string"?h:a[h]:typeof a=="function"?a:()=>{}}function lz(t){return Jm(t,"spacing",8)}function Qm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function VX(t,e){return n=>t.reduce((r,i)=>(r[i]=Qm(e,n),r),{})}function UX(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=jX(n),a=VX(i,r),h=t[n];return vl(t,h,a)}function cz(t,e){const n=lz(t.theme);return Object.keys(t).map(r=>UX(t,e,r,n)).reduce($p,{})}function Hr(t){return cz(t,q2)}Hr.propTypes={};Hr.filterProps=q2;function qr(t){return cz(t,Z2)}qr.propTypes={};qr.filterProps=Z2;function $X(t=8){if(t.mui)return t;const e=lz({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(a=>{const h=e(a);return typeof h=="number"?`${h}px`:h}).join(" ");return n.mui=!0,n}function hv(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>e[a]?$p(i,e[a](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Io(t){return typeof t!="number"?t:`${t}px solid`}function jo(t,e){return ai({prop:t,themeKey:"borders",transform:e})}const GX=jo("border",Io),WX=jo("borderTop",Io),HX=jo("borderRight",Io),qX=jo("borderBottom",Io),ZX=jo("borderLeft",Io),XX=jo("borderColor"),YX=jo("borderTopColor"),KX=jo("borderRightColor"),JX=jo("borderBottomColor"),QX=jo("borderLeftColor"),eY=jo("outline",Io),tY=jo("outlineColor"),dv=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Jm(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Qm(e,r)});return vl(t,t.borderRadius,n)}return null};dv.propTypes={};dv.filterProps=["borderRadius"];hv(GX,WX,HX,qX,ZX,XX,YX,KX,JX,QX,dv,eY,tY);const fv=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Jm(t.theme,"spacing",8),n=r=>({gap:Qm(e,r)});return vl(t,t.gap,n)}return null};fv.propTypes={};fv.filterProps=["gap"];const pv=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Jm(t.theme,"spacing",8),n=r=>({columnGap:Qm(e,r)});return vl(t,t.columnGap,n)}return null};pv.propTypes={};pv.filterProps=["columnGap"];const mv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Jm(t.theme,"spacing",8),n=r=>({rowGap:Qm(e,r)});return vl(t,t.rowGap,n)}return null};mv.propTypes={};mv.filterProps=["rowGap"];const nY=ai({prop:"gridColumn"}),rY=ai({prop:"gridRow"}),iY=ai({prop:"gridAutoFlow"}),sY=ai({prop:"gridAutoColumns"}),oY=ai({prop:"gridAutoRows"}),aY=ai({prop:"gridTemplateColumns"}),lY=ai({prop:"gridTemplateRows"}),cY=ai({prop:"gridTemplateAreas"}),uY=ai({prop:"gridArea"});hv(fv,pv,mv,nY,rY,iY,sY,oY,aY,lY,cY,uY);function fd(t,e){return e==="grey"?e:t}const hY=ai({prop:"color",themeKey:"palette",transform:fd}),dY=ai({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:fd}),fY=ai({prop:"backgroundColor",themeKey:"palette",transform:fd});hv(hY,dY,fY);function eo(t){return t<=1&&t!==0?`${t*100}%`:t}const pY=ai({prop:"width",transform:eo}),X2=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i;const a=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||H2[n];return a?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${a}${t.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:eo(n)}};return vl(t,t.maxWidth,e)}return null};X2.filterProps=["maxWidth"];const mY=ai({prop:"minWidth",transform:eo}),gY=ai({prop:"height",transform:eo}),yY=ai({prop:"maxHeight",transform:eo}),_Y=ai({prop:"minHeight",transform:eo});ai({prop:"size",cssProperty:"width",transform:eo});ai({prop:"size",cssProperty:"height",transform:eo});const vY=ai({prop:"boxSizing"});hv(pY,X2,mY,gY,yY,_Y,vY);const xY={border:{themeKey:"borders",transform:Io},borderTop:{themeKey:"borders",transform:Io},borderRight:{themeKey:"borders",transform:Io},borderBottom:{themeKey:"borders",transform:Io},borderLeft:{themeKey:"borders",transform:Io},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Io},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:dv},color:{themeKey:"palette",transform:fd},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:fd},backgroundColor:{themeKey:"palette",transform:fd},p:{style:qr},pt:{style:qr},pr:{style:qr},pb:{style:qr},pl:{style:qr},px:{style:qr},py:{style:qr},padding:{style:qr},paddingTop:{style:qr},paddingRight:{style:qr},paddingBottom:{style:qr},paddingLeft:{style:qr},paddingX:{style:qr},paddingY:{style:qr},paddingInline:{style:qr},paddingInlineStart:{style:qr},paddingInlineEnd:{style:qr},paddingBlock:{style:qr},paddingBlockStart:{style:qr},paddingBlockEnd:{style:qr},m:{style:Hr},mt:{style:Hr},mr:{style:Hr},mb:{style:Hr},ml:{style:Hr},mx:{style:Hr},my:{style:Hr},margin:{style:Hr},marginTop:{style:Hr},marginRight:{style:Hr},marginBottom:{style:Hr},marginLeft:{style:Hr},marginX:{style:Hr},marginY:{style:Hr},marginInline:{style:Hr},marginInlineStart:{style:Hr},marginInlineEnd:{style:Hr},marginBlock:{style:Hr},marginBlockStart:{style:Hr},marginBlockEnd:{style:Hr},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:fv},rowGap:{style:mv},columnGap:{style:pv},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:eo},maxWidth:{style:X2},minWidth:{transform:eo},height:{transform:eo},maxHeight:{transform:eo},minHeight:{transform:eo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},eg=xY;function bY(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function wY(t,e){return typeof t=="function"?t(e):t}function uz(){function t(n,r,i,a){const h={[n]:r,theme:i},l=a[n];if(!l)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:S,style:P}=l;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const C=uv(i,_)||{};return P?P(h):vl(h,r,R=>{let D=f_(C,S,R);return R===D&&typeof R=="string"&&(D=f_(C,S,`${n}${R==="default"?"":$t(R)}`,R)),m===!1?D:{[m]:D}})}function e(n){var r;const{sx:i,theme:a={}}=n||{};if(!i)return null;const h=(r=a.unstable_sxConfig)!=null?r:eg;function l(m){let _=m;if(typeof m=="function")_=m(a);else if(typeof m!="object")return m;if(!_)return null;const S=OX(a.breakpoints),P=Object.keys(S);let C=S;return Object.keys(_).forEach(L=>{const R=wY(_[L],a);if(R!=null)if(typeof R=="object")if(h[L])C=$p(C,t(L,R,a,h));else{const D=vl({theme:a},R,W=>({[L]:W}));bY(D,R)?C[L]=e({sx:R,theme:a}):C=$p(C,D)}else C=$p(C,t(L,R,a,h))}),zX(P,C)}return Array.isArray(i)?i.map(l):l(i)}return e}const hz=uz();hz.filterProps=["sx"];const gv=hz;function dz(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const SY=["breakpoints","palette","spacing","shape"];function Y2(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:a={}}=t,h=Gt(t,SY),l=az(n),m=$X(i);let _=oo({breakpoints:l,direction:"ltr",components:{},palette:re({mode:"light"},r),spacing:m,shape:re({},RX,a)},h);return _.applyStyles=dz,_=e.reduce((S,P)=>oo(S,P),_),_.unstable_sxConfig=re({},eg,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(P){return gv({sx:P,theme:this})},_}const TY=Object.freeze(Object.defineProperty({__proto__:null,default:Y2,private_createBreakpoints:az,unstable_applyStyles:dz},Symbol.toStringTag,{value:"Module"}));function EY(t){return Object.keys(t).length===0}function fz(t=null){const e=q.useContext(Km);return!e||EY(e)?t:e}const PY=Y2();function K2(t=PY){return fz(t)}function CY({styles:t,themeId:e,defaultTheme:n={}}){const r=K2(n),i=typeof t=="function"?t(e&&r[e]||r):t;return te.jsx(iz,{styles:i})}const AY=["sx"],IY=t=>{var e,n;const r={systemProps:{},otherProps:{}},i=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:eg;return Object.keys(t).forEach(a=>{i[a]?r.systemProps[a]=t[a]:r.otherProps[a]=t[a]}),r};function J2(t){const{sx:e}=t,n=Gt(t,AY),{systemProps:r,otherProps:i}=IY(n);let a;return Array.isArray(e)?a=[r,...e]:typeof e=="function"?a=(...h)=>{const l=e(...h);return rc(l)?re({},r,l):r}:a=re({},r,e),re({},i,{sx:a})}const kY=Object.freeze(Object.defineProperty({__proto__:null,default:gv,extendSxProp:J2,unstable_createStyleFunctionSx:uz,unstable_defaultSxConfig:eg},Symbol.toStringTag,{value:"Module"})),GI=t=>t,MY=()=>{let t=GI;return{configure(e){t=e},generate(e){return t(e)},reset(){t=GI}}},LY=MY(),pz=LY;function mz(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=mz(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Qt(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=mz(t))&&(r&&(r+=" "),r+=e);return r}const RY=["className","component"];function OY(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,a=sz("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(gv);return q.forwardRef(function(m,_){const S=K2(n),P=J2(m),{className:C,component:L="div"}=P,R=Gt(P,RY);return te.jsx(a,re({as:L,ref:_,className:Qt(C,i?i(r):r),theme:e&&S[e]||S},R))})}const zY={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Fn(t,e,n="Mui"){const r=zY[e];return r?`${n}-${r}`:`${pz.generate(t)}-${e}`}function In(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=Fn(t,i,n)}),r}var gz={exports:{}},rr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q2=Symbol.for("react.element"),eT=Symbol.for("react.portal"),yv=Symbol.for("react.fragment"),_v=Symbol.for("react.strict_mode"),vv=Symbol.for("react.profiler"),xv=Symbol.for("react.provider"),bv=Symbol.for("react.context"),DY=Symbol.for("react.server_context"),wv=Symbol.for("react.forward_ref"),Sv=Symbol.for("react.suspense"),Tv=Symbol.for("react.suspense_list"),Ev=Symbol.for("react.memo"),Pv=Symbol.for("react.lazy"),FY=Symbol.for("react.offscreen"),yz;yz=Symbol.for("react.module.reference");function Vo(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Q2:switch(t=t.type,t){case yv:case vv:case _v:case Sv:case Tv:return t;default:switch(t=t&&t.$$typeof,t){case DY:case bv:case wv:case Pv:case Ev:case xv:return t;default:return e}}case eT:return e}}}rr.ContextConsumer=bv;rr.ContextProvider=xv;rr.Element=Q2;rr.ForwardRef=wv;rr.Fragment=yv;rr.Lazy=Pv;rr.Memo=Ev;rr.Portal=eT;rr.Profiler=vv;rr.StrictMode=_v;rr.Suspense=Sv;rr.SuspenseList=Tv;rr.isAsyncMode=function(){return!1};rr.isConcurrentMode=function(){return!1};rr.isContextConsumer=function(t){return Vo(t)===bv};rr.isContextProvider=function(t){return Vo(t)===xv};rr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Q2};rr.isForwardRef=function(t){return Vo(t)===wv};rr.isFragment=function(t){return Vo(t)===yv};rr.isLazy=function(t){return Vo(t)===Pv};rr.isMemo=function(t){return Vo(t)===Ev};rr.isPortal=function(t){return Vo(t)===eT};rr.isProfiler=function(t){return Vo(t)===vv};rr.isStrictMode=function(t){return Vo(t)===_v};rr.isSuspense=function(t){return Vo(t)===Sv};rr.isSuspenseList=function(t){return Vo(t)===Tv};rr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===yv||t===vv||t===_v||t===Sv||t===Tv||t===FY||typeof t=="object"&&t!==null&&(t.$$typeof===Pv||t.$$typeof===Ev||t.$$typeof===xv||t.$$typeof===bv||t.$$typeof===wv||t.$$typeof===yz||t.getModuleId!==void 0)};rr.typeOf=Vo;gz.exports=rr;var WI=gz.exports;const NY=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function _z(t){const e=`${t}`.match(NY);return e&&e[1]||""}function vz(t,e=""){return t.displayName||t.name||_z(t)||e}function HI(t,e,n){const r=vz(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function BY(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return vz(t,"Component");if(typeof t=="object")switch(t.$$typeof){case WI.ForwardRef:return HI(t,t.render,"ForwardRef");case WI.Memo:return HI(t,t.type,"memo");default:return}}}const jY=Object.freeze(Object.defineProperty({__proto__:null,default:BY,getFunctionName:_z},Symbol.toStringTag,{value:"Module"}));function p_(t,e){const n=re({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=re({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},a=e[r];n[r]={},!a||!Object.keys(a)?n[r]=i:!i||!Object.keys(i)?n[r]=a:(n[r]=re({},a),Object.keys(i).forEach(h=>{n[r][h]=p_(i[h],a[h])}))}else n[r]===void 0&&(n[r]=t[r])}),n}const VY=typeof window<"u"?q.useLayoutEffect:q.useEffect,fa=VY;function hu(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const UY=Object.freeze(Object.defineProperty({__proto__:null,default:hu},Symbol.toStringTag,{value:"Module"}));function $Y(t,e=0,n=1){return hu(t,e,n)}function GY(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function xz(t){if(t.type)return t;if(t.charAt(0)==="#")return xz(GY(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(_l(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(_l(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}function WY(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,a)=>a<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function qI(t,e){return t=xz(t),e=$Y(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,WY(t)}function ZI(...t){return t.reduce((e,n)=>n==null?e:function(...i){e.apply(this,i),n.apply(this,i)},()=>{})}function tT(t,e=166){let n;function r(...i){const a=()=>{t.apply(this,i)};clearTimeout(n),n=setTimeout(a,e)}return r.clear=()=>{clearTimeout(n)},r}function Jb(t,e){var n,r;return q.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Xr(t){return t&&t.ownerDocument||document}function xl(t){return Xr(t).defaultView||window}function Zw(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let XI=0;function HY(t){const[e,n]=q.useState(t),r=t||e;return q.useEffect(()=>{e==null&&(XI+=1,n(`mui-${XI}`))},[e]),r}const YI=m1["useId".toString()];function nT(t){if(YI!==void 0){const e=YI();return t??e}return HY(t)}function m_({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=q.useRef(t!==void 0),[a,h]=q.useState(e),l=i?t:a,m=q.useCallback(_=>{i||h(_)},[]);return[l,m]}function zs(t){const e=q.useRef(t);return fa(()=>{e.current=t}),q.useRef((...n)=>(0,e.current)(...n)).current}function jr(...t){return q.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Zw(n,e)})},t)}const KI={};function qY(t,e){const n=q.useRef(KI);return n.current===KI&&(n.current=t(e)),n}const ZY=[];function XY(t){q.useEffect(t,ZY)}class tg{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new tg}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function gu(){const t=qY(tg.create).current;return XY(t.disposeEffect),t}let Cv=!0,Xw=!1;const YY=new tg,KY={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function JY(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&KY[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function QY(t){t.metaKey||t.altKey||t.ctrlKey||(Cv=!0)}function Qb(){Cv=!1}function eK(){this.visibilityState==="hidden"&&Xw&&(Cv=!0)}function tK(t){t.addEventListener("keydown",QY,!0),t.addEventListener("mousedown",Qb,!0),t.addEventListener("pointerdown",Qb,!0),t.addEventListener("touchstart",Qb,!0),t.addEventListener("visibilitychange",eK,!0)}function nK(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return Cv||JY(e)}function rT(){const t=q.useCallback(i=>{i!=null&&tK(i.ownerDocument)},[]),e=q.useRef(!1);function n(){return e.current?(Xw=!0,YY.start(100,()=>{Xw=!1}),e.current=!1,!0):!1}function r(i){return nK(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function bz(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const rK={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},iK=rK;function jn(t,e,n=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((a,h)=>{if(h){const l=e(h);l!==""&&a.push(l),n&&n[h]&&a.push(n[h])}return a},[]).join(" ")}),r}function wc(t){return typeof t=="string"}function nd(t,e,n){return t===void 0||wc(t)?e:re({},e,{ownerState:re({},e.ownerState,n)})}function wu(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function JI(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function wz(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:a}=t;if(!e){const L=Qt(n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),R=re({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),D=re({},n,i,r);return L.length>0&&(D.className=L),Object.keys(R).length>0&&(D.style=R),{props:D,internalRef:void 0}}const h=wu(re({},i,r)),l=JI(r),m=JI(i),_=e(h),S=Qt(_==null?void 0:_.className,n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),P=re({},_==null?void 0:_.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),C=re({},_,n,m,l);return S.length>0&&(C.className=S),Object.keys(P).length>0&&(C.style=P),{props:C,internalRef:_.ref}}function Sz(t,e,n){return typeof t=="function"?t(e,n):t}const sK=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function is(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:a=!1}=t,h=Gt(t,sK),l=a?{}:Sz(r,i),{props:m,internalRef:_}=wz(re({},h,{externalSlotProps:l})),S=jr(_,l==null?void 0:l.ref,(e=t.additionalProps)==null?void 0:e.ref);return nd(n,re({},m,{ref:S}),i)}function kc(t){if(parseInt(q.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return(t==null?void 0:t.ref)||null}const oK=q.createContext(null),Tz=oK;function Ez(){return q.useContext(Tz)}const aK=typeof Symbol=="function"&&Symbol.for,lK=aK?Symbol.for("mui.nested"):"__THEME_NESTED__";function cK(t,e){return typeof e=="function"?e(t):re({},t,e)}function uK(t){const{children:e,theme:n}=t,r=Ez(),i=q.useMemo(()=>{const a=r===null?n:cK(r,n);return a!=null&&(a[lK]=r!==null),a},[n,r]);return te.jsx(Tz.Provider,{value:i,children:e})}const hK=["value"],Pz=q.createContext();function dK(t){let{value:e}=t,n=Gt(t,hK);return te.jsx(Pz.Provider,re({value:e??!0},n))}const Av=()=>{const t=q.useContext(Pz);return t??!1},Cz=q.createContext(void 0);function fK({value:t,children:e}){return te.jsx(Cz.Provider,{value:t,children:e})}function pK(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const i=e.components[n];return i.defaultProps?p_(i.defaultProps,r):!i.styleOverrides&&!i.variants?p_(i,r):r}function mK({props:t,name:e}){const n=q.useContext(Cz);return pK({props:t,name:e,theme:{components:n}})}const QI={};function ek(t,e,n,r=!1){return q.useMemo(()=>{const i=t&&e[t]||e;if(typeof n=="function"){const a=n(i),h=t?re({},e,{[t]:a}):a;return r?()=>h:h}return t?re({},e,{[t]:n}):re({},e,n)},[t,e,n,r])}function gK(t){const{children:e,theme:n,themeId:r}=t,i=fz(QI),a=Ez()||QI,h=ek(r,i,n),l=ek(r,a,n,!0),m=h.direction==="rtl";return te.jsx(uK,{theme:l,children:te.jsx(Km.Provider,{value:h,children:te.jsx(dK,{value:m,children:te.jsx(fK,{value:h==null?void 0:h.components,children:e})})})})}function yK(t,e){return re({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var li={},Az={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Az);var Iz=Az.exports;const _K=Pc(xZ),vK=Pc(UY);var kz=Iz;Object.defineProperty(li,"__esModule",{value:!0});var as=li.alpha=Oz;li.blend=MK;li.colorChannel=void 0;var Cm=li.darken=sT;li.decomposeColor=Fo;var xK=li.emphasize=zz,bK=li.getContrastRatio=PK;li.getLuminance=g_;li.hexToRgb=Mz;li.hslToRgb=Rz;var Am=li.lighten=oT;li.private_safeAlpha=CK;li.private_safeColorChannel=void 0;li.private_safeDarken=AK;li.private_safeEmphasize=kK;li.private_safeLighten=IK;li.recomposeColor=Xd;li.rgbToHex=EK;var tk=kz(_K),wK=kz(vK);function iT(t,e=0,n=1){return(0,wK.default)(t,e,n)}function Mz(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function SK(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function Fo(t){if(t.type)return t;if(t.charAt(0)==="#")return Fo(Mz(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,tk.default)(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error((0,tk.default)(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const Lz=t=>{const e=Fo(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};li.colorChannel=Lz;const TK=(t,e)=>{try{return Lz(t)}catch{return t}};li.private_safeColorChannel=TK;function Xd(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,a)=>a<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function EK(t){if(t.indexOf("#")===0)return t;const{values:e}=Fo(t);return`#${e.map((n,r)=>SK(r===3?Math.round(255*n):n)).join("")}`}function Rz(t){t=Fo(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,a=r*Math.min(i,1-i),h=(_,S=(_+n/30)%12)=>i-a*Math.max(Math.min(S-3,9-S,1),-1);let l="rgb";const m=[Math.round(h(0)*255),Math.round(h(8)*255),Math.round(h(4)*255)];return t.type==="hsla"&&(l+="a",m.push(e[3])),Xd({type:l,values:m})}function g_(t){t=Fo(t);let e=t.type==="hsl"||t.type==="hsla"?Fo(Rz(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function PK(t,e){const n=g_(t),r=g_(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Oz(t,e){return t=Fo(t),e=iT(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Xd(t)}function CK(t,e,n){try{return Oz(t,e)}catch{return t}}function sT(t,e){if(t=Fo(t),e=iT(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Xd(t)}function AK(t,e,n){try{return sT(t,e)}catch{return t}}function oT(t,e){if(t=Fo(t),e=iT(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Xd(t)}function IK(t,e,n){try{return oT(t,e)}catch{return t}}function zz(t,e=.15){return g_(t)>.5?sT(t,e):oT(t,e)}function kK(t,e,n){try{return zz(t,e)}catch{return t}}function MK(t,e,n,r=1){const i=(m,_)=>Math.round((m**(1/r)*(1-n)+_**(1/r)*n)**r),a=Fo(t),h=Fo(e),l=[i(a.values[0],h.values[0]),i(a.values[1],h.values[1]),i(a.values[2],h.values[2])];return Xd({type:"rgb",values:l})}const LK=["mode","contrastThreshold","tonalOffset"],nk={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Sm.white,default:Sm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},e1={text:{primary:Sm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Sm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function rk(t,e,n,r){const i=r.light||r,a=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=Am(t.main,i):e==="dark"&&(t.dark=Cm(t.main,a)))}function RK(t="light"){return t==="dark"?{main:Rh[200],light:Rh[50],dark:Rh[400]}:{main:Rh[700],light:Rh[400],dark:Rh[800]}}function OK(t="light"){return t==="dark"?{main:Lh[200],light:Lh[50],dark:Lh[400]}:{main:Lh[500],light:Lh[300],dark:Lh[700]}}function zK(t="light"){return t==="dark"?{main:Mh[500],light:Mh[300],dark:Mh[700]}:{main:Mh[700],light:Mh[400],dark:Mh[800]}}function DK(t="light"){return t==="dark"?{main:Oh[400],light:Oh[300],dark:Oh[700]}:{main:Oh[700],light:Oh[500],dark:Oh[900]}}function FK(t="light"){return t==="dark"?{main:zh[400],light:zh[300],dark:zh[700]}:{main:zh[800],light:zh[500],dark:zh[900]}}function NK(t="light"){return t==="dark"?{main:pp[400],light:pp[300],dark:pp[700]}:{main:"#ed6c02",light:pp[500],dark:pp[900]}}function BK(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=Gt(t,LK),a=t.primary||RK(e),h=t.secondary||OK(e),l=t.error||zK(e),m=t.info||DK(e),_=t.success||FK(e),S=t.warning||NK(e);function P(D){return bK(D,e1.text.primary)>=n?e1.text.primary:nk.text.primary}const C=({color:D,name:W,mainShade:z=500,lightShade:N=300,darkShade:F=700})=>{if(D=re({},D),!D.main&&D[z]&&(D.main=D[z]),!D.hasOwnProperty("main"))throw new Error(_l(11,W?` (${W})`:"",z));if(typeof D.main!="string")throw new Error(_l(12,W?` (${W})`:"",JSON.stringify(D.main)));return rk(D,"light",N,r),rk(D,"dark",F,r),D.contrastText||(D.contrastText=P(D.main)),D},L={dark:e1,light:nk};return oo(re({common:re({},Sm),mode:e,primary:C({color:a,name:"primary"}),secondary:C({color:h,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:C({color:l,name:"error"}),warning:C({color:S,name:"warning"}),info:C({color:m,name:"info"}),success:C({color:_,name:"success"}),grey:vZ,contrastThreshold:n,getContrastText:P,augmentColor:C,tonalOffset:r},L[e]),i)}const jK=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function VK(t){return Math.round(t*1e5)/1e5}const ik={textTransform:"uppercase"},sk='"Roboto", "Helvetica", "Arial", sans-serif';function UK(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=sk,fontSize:i=14,fontWeightLight:a=300,fontWeightRegular:h=400,fontWeightMedium:l=500,fontWeightBold:m=700,htmlFontSize:_=16,allVariants:S,pxToRem:P}=n,C=Gt(n,jK),L=i/14,R=P||(z=>`${z/_*L}rem`),D=(z,N,F,$,K)=>re({fontFamily:r,fontWeight:z,fontSize:R(N),lineHeight:F},r===sk?{letterSpacing:`${VK($/N)}em`}:{},K,S),W={h1:D(a,96,1.167,-1.5),h2:D(a,60,1.2,-.5),h3:D(h,48,1.167,0),h4:D(h,34,1.235,.25),h5:D(h,24,1.334,0),h6:D(l,20,1.6,.15),subtitle1:D(h,16,1.75,.15),subtitle2:D(l,14,1.57,.1),body1:D(h,16,1.5,.15),body2:D(h,14,1.43,.15),button:D(l,14,1.75,.4,ik),caption:D(h,12,1.66,.4),overline:D(h,12,2.66,1,ik),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return oo(re({htmlFontSize:_,pxToRem:R,fontFamily:r,fontSize:i,fontWeightLight:a,fontWeightRegular:h,fontWeightMedium:l,fontWeightBold:m},W),C,{clone:!1})}const $K=.2,GK=.14,WK=.12;function Mr(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${$K})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${GK})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${WK})`].join(",")}const HK=["none",Mr(0,2,1,-1,0,1,1,0,0,1,3,0),Mr(0,3,1,-2,0,2,2,0,0,1,5,0),Mr(0,3,3,-2,0,3,4,0,0,1,8,0),Mr(0,2,4,-1,0,4,5,0,0,1,10,0),Mr(0,3,5,-1,0,5,8,0,0,1,14,0),Mr(0,3,5,-1,0,6,10,0,0,1,18,0),Mr(0,4,5,-2,0,7,10,1,0,2,16,1),Mr(0,5,5,-3,0,8,10,1,0,3,14,2),Mr(0,5,6,-3,0,9,12,1,0,3,16,2),Mr(0,6,6,-3,0,10,14,1,0,4,18,3),Mr(0,6,7,-4,0,11,15,1,0,4,20,3),Mr(0,7,8,-4,0,12,17,2,0,5,22,4),Mr(0,7,8,-4,0,13,19,2,0,5,24,4),Mr(0,7,9,-4,0,14,21,2,0,5,26,4),Mr(0,8,9,-5,0,15,22,2,0,6,28,5),Mr(0,8,10,-5,0,16,24,2,0,6,30,5),Mr(0,8,11,-5,0,17,26,2,0,6,32,5),Mr(0,9,11,-5,0,18,28,2,0,7,34,6),Mr(0,9,12,-6,0,19,29,2,0,7,36,6),Mr(0,10,13,-6,0,20,31,3,0,8,38,7),Mr(0,10,13,-6,0,21,33,3,0,8,40,7),Mr(0,10,14,-6,0,22,35,3,0,8,42,7),Mr(0,11,14,-7,0,23,36,3,0,9,44,8),Mr(0,11,15,-7,0,24,38,3,0,9,46,8)],qK=HK,ZK=["duration","easing","delay"],XK={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},YK={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function ok(t){return`${Math.round(t)}ms`}function KK(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function JK(t){const e=re({},XK,t.easing),n=re({},YK,t.duration);return re({getAutoHeightDuration:KK,create:(i=["all"],a={})=>{const{duration:h=n.standard,easing:l=e.easeInOut,delay:m=0}=a;return Gt(a,ZK),(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof h=="string"?h:ok(h)} ${l} ${typeof m=="string"?m:ok(m)}`).join(",")}},t,{easing:e,duration:n})}const QK={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},eJ=QK,tJ=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function aT(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:a={}}=t,h=Gt(t,tJ);if(t.vars)throw new Error(_l(18));const l=BK(r),m=Y2(t);let _=oo(m,{mixins:yK(m.breakpoints,n),palette:l,shadows:qK.slice(),typography:UK(l,a),transitions:JK(i),zIndex:re({},eJ)});return _=oo(_,h),_=e.reduce((S,P)=>oo(S,P),_),_.unstable_sxConfig=re({},eg,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(P){return gv({sx:P,theme:this})},_}const nJ=aT(),lT=nJ;function Yd(){const t=K2(lT);return t[zd]||t}var ng={},t1={exports:{}},ak;function rJ(){return ak||(ak=1,function(t){function e(n,r){if(n==null)return{};var i={};for(var a in n)if({}.hasOwnProperty.call(n,a)){if(r.includes(a))continue;i[a]=n[a]}return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(t1)),t1.exports}const Dz=Pc(AX),iJ=Pc(IX),sJ=Pc(DX),oJ=Pc(jY),aJ=Pc(TY),lJ=Pc(kY);var Kd=Iz;Object.defineProperty(ng,"__esModule",{value:!0});var cJ=ng.default=wJ;ng.shouldForwardProp=P0;ng.systemDefaultTheme=void 0;var To=Kd(rz()),Yw=Kd(rJ()),lk=gJ(Dz),uJ=iJ;Kd(sJ);Kd(oJ);var hJ=Kd(aJ),dJ=Kd(lJ);const fJ=["ownerState"],pJ=["variants"],mJ=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Fz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Fz=function(r){return r?n:e})(t)}function gJ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Fz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var h=i?Object.getOwnPropertyDescriptor(t,a):null;h&&(h.get||h.set)?Object.defineProperty(r,a,h):r[a]=t[a]}return r.default=t,n&&n.set(t,r),r}function yJ(t){return Object.keys(t).length===0}function _J(t){return typeof t=="string"&&t.charCodeAt(0)>96}function P0(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const vJ=ng.systemDefaultTheme=(0,hJ.default)(),xJ=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Uy({defaultTheme:t,theme:e,themeId:n}){return yJ(e)?t:e[n]||e}function bJ(t){return t?(e,n)=>n[t]:null}function C0(t,e){let{ownerState:n}=e,r=(0,Yw.default)(e,fJ);const i=typeof t=="function"?t((0,To.default)({ownerState:n},r)):t;if(Array.isArray(i))return i.flatMap(a=>C0(a,(0,To.default)({ownerState:n},r)));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let l=(0,Yw.default)(i,pJ);return a.forEach(m=>{let _=!0;typeof m.props=="function"?_=m.props((0,To.default)({ownerState:n},r,n)):Object.keys(m.props).forEach(S=>{(n==null?void 0:n[S])!==m.props[S]&&r[S]!==m.props[S]&&(_=!1)}),_&&(Array.isArray(l)||(l=[l]),l.push(typeof m.style=="function"?m.style((0,To.default)({ownerState:n},r,n)):m.style))}),l}return i}function wJ(t={}){const{themeId:e,defaultTheme:n=vJ,rootShouldForwardProp:r=P0,slotShouldForwardProp:i=P0}=t,a=h=>(0,dJ.default)((0,To.default)({},h,{theme:Uy((0,To.default)({},h,{defaultTheme:n,themeId:e}))}));return a.__mui_systemSx=!0,(h,l={})=>{(0,lk.internal_processStyles)(h,K=>K.filter(ne=>!(ne!=null&&ne.__mui_systemSx)));const{name:m,slot:_,skipVariantsResolver:S,skipSx:P,overridesResolver:C=bJ(xJ(_))}=l,L=(0,Yw.default)(l,mJ),R=S!==void 0?S:_&&_!=="Root"&&_!=="root"||!1,D=P||!1;let W,z=P0;_==="Root"||_==="root"?z=r:_?z=i:_J(h)&&(z=void 0);const N=(0,lk.default)(h,(0,To.default)({shouldForwardProp:z,label:W},L)),F=K=>typeof K=="function"&&K.__emotion_real!==K||(0,uJ.isPlainObject)(K)?ne=>C0(K,(0,To.default)({},ne,{theme:Uy({theme:ne.theme,defaultTheme:n,themeId:e})})):K,$=(K,...ne)=>{let se=F(K);const xe=ne?ne.map(F):[];m&&C&&xe.push(Re=>{const De=Uy((0,To.default)({},Re,{defaultTheme:n,themeId:e}));if(!De.components||!De.components[m]||!De.components[m].styleOverrides)return null;const Ve=De.components[m].styleOverrides,je={};return Object.entries(Ve).forEach(([We,Ze])=>{je[We]=C0(Ze,(0,To.default)({},Re,{theme:De}))}),C(Re,je)}),m&&!R&&xe.push(Re=>{var De;const Ve=Uy((0,To.default)({},Re,{defaultTheme:n,themeId:e})),je=Ve==null||(De=Ve.components)==null||(De=De[m])==null?void 0:De.variants;return C0({variants:je},(0,To.default)({},Re,{theme:Ve}))}),D||xe.push(a);const Se=xe.length-ne.length;if(Array.isArray(K)&&Se>0){const Re=new Array(Se).fill("");se=[...K,...Re],se.raw=[...K.raw,...Re]}const _e=N(se,...xe);return h.muiName&&(_e.muiName=h.muiName),_e};return N.withConfig&&($.withConfig=N.withConfig),$}}function Iv(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const SJ=t=>Iv(t)&&t!=="classes",fo=SJ,TJ=cJ({themeId:zd,defaultTheme:lT,rootShouldForwardProp:fo}),_t=TJ,EJ=["theme"];function PJ(t){let{theme:e}=t,n=Gt(t,EJ);const r=e[zd];return te.jsx(gK,re({},n,{themeId:r?zd:void 0,theme:r||e}))}const CJ=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},ck=CJ;function Nn(t){return mK(t)}function AJ(t){return Fn("MuiSvgIcon",t)}In("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const IJ=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],kJ=t=>{const{color:e,fontSize:n,classes:r}=t,i={root:["root",e!=="inherit"&&`color${$t(e)}`,`fontSize${$t(n)}`]};return jn(i,AJ,r)},MJ=_t("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${$t(n.color)}`],e[`fontSize${$t(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,i,a,h,l,m,_,S,P,C,L,R;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(i=t.transitions)==null||(i=i.duration)==null?void 0:i.shorter}),fontSize:{inherit:"inherit",small:((a=t.typography)==null||(h=a.pxToRem)==null?void 0:h.call(a,20))||"1.25rem",medium:((l=t.typography)==null||(m=l.pxToRem)==null?void 0:m.call(l,24))||"1.5rem",large:((_=t.typography)==null||(S=_.pxToRem)==null?void 0:S.call(_,35))||"2.1875rem"}[e.fontSize],color:(P=(C=(t.vars||t).palette)==null||(C=C[e.color])==null?void 0:C.main)!=null?P:{action:(L=(t.vars||t).palette)==null||(L=L.action)==null?void 0:L.active,disabled:(R=(t.vars||t).palette)==null||(R=R.action)==null?void 0:R.disabled,inherit:void 0}[e.color]}}),Nz=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:h="inherit",component:l="svg",fontSize:m="medium",htmlColor:_,inheritViewBox:S=!1,titleAccess:P,viewBox:C="0 0 24 24"}=r,L=Gt(r,IJ),R=q.isValidElement(i)&&i.type==="svg",D=re({},r,{color:h,component:l,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:S,viewBox:C,hasSvgAsChild:R}),W={};S||(W.viewBox=C);const z=kJ(D);return te.jsxs(MJ,re({as:l,className:Qt(z.root,a),focusable:"false",color:_,"aria-hidden":P?void 0:!0,role:P?"img":void 0,ref:n},W,L,R&&i.props,{ownerState:D,children:[R?i.props.children:i,P?te.jsx("title",{children:P}):null]}))});Nz.muiName="SvgIcon";const Kw=Nz;function Uo(t,e){function n(r,i){return te.jsx(Kw,re({"data-testid":`${e}Icon`,ref:i},r,{children:t}))}return n.muiName=Kw.muiName,q.memo(q.forwardRef(n))}function Jw(t,e){return Jw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Jw(t,e)}function Bz(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Jw(t,e)}const uk={disabled:!1},y_=cr.createContext(null);var LJ=function(e){return e.scrollTop},kp="unmounted",au="exited",lu="entering",jh="entered",Qw="exiting",El=function(t){Bz(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=i,l=h&&!h.isMounting?r.enter:r.appear,m;return a.appearStatus=null,r.in?l?(m=au,a.appearStatus=lu):m=jh:r.unmountOnExit||r.mountOnEnter?m=kp:m=au,a.state={status:m},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var h=i.in;return h&&a.status===kp?{status:au}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var a=null;if(i!==this.props){var h=this.state.status;this.props.in?h!==lu&&h!==jh&&(a=lu):(h===lu||h===jh)&&(a=Qw)}this.updateStatus(!1,a)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,a,h,l;return a=h=l=i,i!=null&&typeof i!="number"&&(a=i.exit,h=i.enter,l=i.appear!==void 0?i.appear:h),{exit:a,enter:h,appear:l}},n.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===lu){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:Ty.findDOMNode(this);h&&LJ(h)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===au&&this.setState({status:kp})},n.performEnter=function(i){var a=this,h=this.props.enter,l=this.context?this.context.isMounting:i,m=this.props.nodeRef?[l]:[Ty.findDOMNode(this),l],_=m[0],S=m[1],P=this.getTimeouts(),C=l?P.appear:P.enter;if(!i&&!h||uk.disabled){this.safeSetState({status:jh},function(){a.props.onEntered(_)});return}this.props.onEnter(_,S),this.safeSetState({status:lu},function(){a.props.onEntering(_,S),a.onTransitionEnd(C,function(){a.safeSetState({status:jh},function(){a.props.onEntered(_,S)})})})},n.performExit=function(){var i=this,a=this.props.exit,h=this.getTimeouts(),l=this.props.nodeRef?void 0:Ty.findDOMNode(this);if(!a||uk.disabled){this.safeSetState({status:au},function(){i.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:Qw},function(){i.props.onExiting(l),i.onTransitionEnd(h.exit,function(){i.safeSetState({status:au},function(){i.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},n.setNextCallback=function(i){var a=this,h=!0;return this.nextCallback=function(l){h&&(h=!1,a.nextCallback=null,i(l))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},n.onTransitionEnd=function(i,a){this.setNextCallback(a);var h=this.props.nodeRef?this.props.nodeRef.current:Ty.findDOMNode(this),l=i==null&&!this.props.addEndListener;if(!h||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],_=m[0],S=m[1];this.props.addEndListener(_,S)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===kp)return null;var a=this.props,h=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var l=Gt(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return cr.createElement(y_.Provider,{value:null},typeof h=="function"?h(i,l):cr.cloneElement(cr.Children.only(h),l))},e}(cr.Component);El.contextType=y_;El.propTypes={};function Dh(){}El.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Dh,onEntering:Dh,onEntered:Dh,onExit:Dh,onExiting:Dh,onExited:Dh};El.UNMOUNTED=kp;El.EXITED=au;El.ENTERING=lu;El.ENTERED=jh;El.EXITING=Qw;const cT=El;function RJ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uT(t,e){var n=function(a){return e&&q.isValidElement(a)?e(a):a},r=Object.create(null);return t&&q.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function OJ(t,e){t=t||{},e=e||{};function n(S){return S in e?e[S]:t[S]}var r=Object.create(null),i=[];for(var a in t)a in e?i.length&&(r[a]=i,i=[]):i.push(a);var h,l={};for(var m in e){if(r[m])for(h=0;h<r[m].length;h++){var _=r[m][h];l[r[m][h]]=n(_)}l[m]=n(m)}for(h=0;h<i.length;h++)l[i[h]]=n(i[h]);return l}function yu(t,e,n){return n[e]!=null?n[e]:t.props[e]}function zJ(t,e){return uT(t.children,function(n){return q.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:yu(n,"appear",t),enter:yu(n,"enter",t),exit:yu(n,"exit",t)})})}function DJ(t,e,n){var r=uT(t.children),i=OJ(e,r);return Object.keys(i).forEach(function(a){var h=i[a];if(q.isValidElement(h)){var l=a in e,m=a in r,_=e[a],S=q.isValidElement(_)&&!_.props.in;m&&(!l||S)?i[a]=q.cloneElement(h,{onExited:n.bind(null,h),in:!0,exit:yu(h,"exit",t),enter:yu(h,"enter",t)}):!m&&l&&!S?i[a]=q.cloneElement(h,{in:!1}):m&&l&&q.isValidElement(_)&&(i[a]=q.cloneElement(h,{onExited:n.bind(null,h),in:_.props.in,exit:yu(h,"exit",t),enter:yu(h,"enter",t)}))}}),i}var FJ=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},NJ={component:"div",childFactory:function(e){return e}},hT=function(t){Bz(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=a.handleExited.bind(RJ(a));return a.state={contextValue:{isMounting:!0},handleExited:h,firstRender:!0},a}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var h=a.children,l=a.handleExited,m=a.firstRender;return{children:m?zJ(i,l):DJ(i,h,l),firstRender:!1}},n.handleExited=function(i,a){var h=uT(this.props.children);i.key in h||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(l){var m=re({},l.children);return delete m[i.key],{children:m}}))},n.render=function(){var i=this.props,a=i.component,h=i.childFactory,l=Gt(i,["component","childFactory"]),m=this.state.contextValue,_=FJ(this.state.children).map(h);return delete l.appear,delete l.enter,delete l.exit,a===null?cr.createElement(y_.Provider,{value:m},_):cr.createElement(y_.Provider,{value:m},cr.createElement(a,l,_))},e}(cr.Component);hT.propTypes={};hT.defaultProps=NJ;const BJ=hT,dT=t=>t.scrollTop;function Fd(t,e){var n,r;const{timeout:i,easing:a,style:h={}}=t;return{duration:(n=h.transitionDuration)!=null?n:typeof i=="number"?i:i[e.mode]||0,easing:(r=h.transitionTimingFunction)!=null?r:typeof a=="object"?a[e.mode]:a,delay:h.transitionDelay}}function jJ(t){return Fn("MuiPaper",t)}In("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const VJ=["className","component","elevation","square","variant"],UJ=t=>{const{square:e,elevation:n,variant:r,classes:i}=t,a={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return jn(a,jJ,i)},$J=_t("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return re({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&re({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${as("#fff",ck(e.elevation))}, ${as("#fff",ck(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),GJ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiPaper"}),{className:i,component:a="div",elevation:h=1,square:l=!1,variant:m="elevation"}=r,_=Gt(r,VJ),S=re({},r,{component:a,elevation:h,square:l,variant:m}),P=UJ(S);return te.jsx($J,re({as:a,ownerState:S,className:Qt(P.root,i),ref:n},_))}),kv=GJ,WJ=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],HJ=["component","slots","slotProps"],qJ=["component"];function hk(t,e){const{className:n,elementType:r,ownerState:i,externalForwardedProps:a,getSlotOwnerState:h,internalForwardedProps:l}=e,m=Gt(e,WJ),{component:_,slots:S={[t]:void 0},slotProps:P={[t]:void 0}}=a,C=Gt(a,HJ),L=S[t]||r,R=Sz(P[t],i),D=wz(re({className:n},m,{externalForwardedProps:t==="root"?C:void 0,externalSlotProps:R})),{props:{component:W},internalRef:z}=D,N=Gt(D.props,qJ),F=jr(z,R==null?void 0:R.ref,e.ref),$=h?h(N):{},K=re({},i,$),ne=t==="root"?W||_:W,se=nd(L,re({},t==="root"&&!_&&!S[t]&&l,t!=="root"&&!S[t]&&l,N,ne&&{as:ne},{ref:F}),K);return Object.keys($).forEach(xe=>{delete se[xe]}),[L,se]}function ZJ(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:a,rippleSize:h,in:l,onExited:m,timeout:_}=t,[S,P]=q.useState(!1),C=Qt(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),L={width:h,height:h,top:-(h/2)+a,left:-(h/2)+i},R=Qt(n.child,S&&n.childLeaving,r&&n.childPulsate);return!l&&!S&&P(!0),q.useEffect(()=>{if(!l&&m!=null){const D=setTimeout(m,_);return()=>{clearTimeout(D)}}},[m,l,_]),te.jsx("span",{className:C,style:L,children:te.jsx("span",{className:R})})}const XJ=In("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Po=XJ,YJ=["center","classes","className"];let Mv=t=>t,dk,fk,pk,mk;const eS=550,KJ=80,JJ=Zd(dk||(dk=Mv`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),QJ=Zd(fk||(fk=Mv`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),eQ=Zd(pk||(pk=Mv`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),tQ=_t("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),nQ=_t(ZJ,{name:"MuiTouchRipple",slot:"Ripple"})(mk||(mk=Mv`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Po.rippleVisible,JJ,eS,({theme:t})=>t.transitions.easing.easeInOut,Po.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Po.child,Po.childLeaving,QJ,eS,({theme:t})=>t.transitions.easing.easeInOut,Po.childPulsate,eQ,({theme:t})=>t.transitions.easing.easeInOut),rQ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:h}=r,l=Gt(r,YJ),[m,_]=q.useState([]),S=q.useRef(0),P=q.useRef(null);q.useEffect(()=>{P.current&&(P.current(),P.current=null)},[m]);const C=q.useRef(!1),L=gu(),R=q.useRef(null),D=q.useRef(null),W=q.useCallback($=>{const{pulsate:K,rippleX:ne,rippleY:se,rippleSize:xe,cb:Se}=$;_(_e=>[..._e,te.jsx(nQ,{classes:{ripple:Qt(a.ripple,Po.ripple),rippleVisible:Qt(a.rippleVisible,Po.rippleVisible),ripplePulsate:Qt(a.ripplePulsate,Po.ripplePulsate),child:Qt(a.child,Po.child),childLeaving:Qt(a.childLeaving,Po.childLeaving),childPulsate:Qt(a.childPulsate,Po.childPulsate)},timeout:eS,pulsate:K,rippleX:ne,rippleY:se,rippleSize:xe},S.current)]),S.current+=1,P.current=Se},[a]),z=q.useCallback(($={},K={},ne=()=>{})=>{const{pulsate:se=!1,center:xe=i||K.pulsate,fakeElement:Se=!1}=K;if(($==null?void 0:$.type)==="mousedown"&&C.current){C.current=!1;return}($==null?void 0:$.type)==="touchstart"&&(C.current=!0);const _e=Se?null:D.current,Re=_e?_e.getBoundingClientRect():{width:0,height:0,left:0,top:0};let De,Ve,je;if(xe||$===void 0||$.clientX===0&&$.clientY===0||!$.clientX&&!$.touches)De=Math.round(Re.width/2),Ve=Math.round(Re.height/2);else{const{clientX:We,clientY:Ze}=$.touches&&$.touches.length>0?$.touches[0]:$;De=Math.round(We-Re.left),Ve=Math.round(Ze-Re.top)}if(xe)je=Math.sqrt((2*Re.width**2+Re.height**2)/3),je%2===0&&(je+=1);else{const We=Math.max(Math.abs((_e?_e.clientWidth:0)-De),De)*2+2,Ze=Math.max(Math.abs((_e?_e.clientHeight:0)-Ve),Ve)*2+2;je=Math.sqrt(We**2+Ze**2)}$!=null&&$.touches?R.current===null&&(R.current=()=>{W({pulsate:se,rippleX:De,rippleY:Ve,rippleSize:je,cb:ne})},L.start(KJ,()=>{R.current&&(R.current(),R.current=null)})):W({pulsate:se,rippleX:De,rippleY:Ve,rippleSize:je,cb:ne})},[i,W,L]),N=q.useCallback(()=>{z({},{pulsate:!0})},[z]),F=q.useCallback(($,K)=>{if(L.clear(),($==null?void 0:$.type)==="touchend"&&R.current){R.current(),R.current=null,L.start(0,()=>{F($,K)});return}R.current=null,_(ne=>ne.length>0?ne.slice(1):ne),P.current=K},[L]);return q.useImperativeHandle(n,()=>({pulsate:N,start:z,stop:F}),[N,z,F]),te.jsx(tQ,re({className:Qt(Po.root,a.root,h),ref:D},l,{children:te.jsx(BJ,{component:null,exit:!0,children:m})}))}),iQ=rQ;function sQ(t){return Fn("MuiButtonBase",t)}const oQ=In("MuiButtonBase",["root","disabled","focusVisible"]),aQ=oQ,lQ=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],cQ=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,h=jn({root:["root",e&&"disabled",n&&"focusVisible"]},sQ,i);return n&&r&&(h.root+=` ${r}`),h},uQ=_t("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${aQ.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),hQ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:h,className:l,component:m="button",disabled:_=!1,disableRipple:S=!1,disableTouchRipple:P=!1,focusRipple:C=!1,LinkComponent:L="a",onBlur:R,onClick:D,onContextMenu:W,onDragLeave:z,onFocus:N,onFocusVisible:F,onKeyDown:$,onKeyUp:K,onMouseDown:ne,onMouseLeave:se,onMouseUp:xe,onTouchEnd:Se,onTouchMove:_e,onTouchStart:Re,tabIndex:De=0,TouchRippleProps:Ve,touchRippleRef:je,type:We}=r,Ze=Gt(r,lQ),Ye=q.useRef(null),Ce=q.useRef(null),Xe=jr(Ce,je),{isFocusVisibleRef:lt,onFocus:Dt,onBlur:mt,ref:ht}=rT(),[ot,xt]=q.useState(!1);_&&ot&&xt(!1),q.useImperativeHandle(i,()=>({focusVisible:()=>{xt(!0),Ye.current.focus()}}),[]);const[bt,Wt]=q.useState(!1);q.useEffect(()=>{Wt(!0)},[]);const nt=bt&&!S&&!_;q.useEffect(()=>{ot&&C&&!S&&bt&&Ce.current.pulsate()},[S,C,ot,bt]);function Et(qe,vt,hn=P){return zs($e=>(vt&&vt($e),!hn&&Ce.current&&Ce.current[qe]($e),!0))}const cn=Et("start",ne),en=Et("stop",W),mn=Et("stop",z),Ht=Et("stop",xe),It=Et("stop",qe=>{ot&&qe.preventDefault(),se&&se(qe)}),Rt=Et("start",Re),yn=Et("stop",Se),vn=Et("stop",_e),ut=Et("stop",qe=>{mt(qe),lt.current===!1&&xt(!1),R&&R(qe)},!1),un=zs(qe=>{Ye.current||(Ye.current=qe.currentTarget),Dt(qe),lt.current===!0&&(xt(!0),F&&F(qe)),N&&N(qe)}),Ae=()=>{const qe=Ye.current;return m&&m!=="button"&&!(qe.tagName==="A"&&qe.href)},Ct=q.useRef(!1),bn=zs(qe=>{C&&!Ct.current&&ot&&Ce.current&&qe.key===" "&&(Ct.current=!0,Ce.current.stop(qe,()=>{Ce.current.start(qe)})),qe.target===qe.currentTarget&&Ae()&&qe.key===" "&&qe.preventDefault(),$&&$(qe),qe.target===qe.currentTarget&&Ae()&&qe.key==="Enter"&&!_&&(qe.preventDefault(),D&&D(qe))}),Yt=zs(qe=>{C&&qe.key===" "&&Ce.current&&ot&&!qe.defaultPrevented&&(Ct.current=!1,Ce.current.stop(qe,()=>{Ce.current.pulsate(qe)})),K&&K(qe),D&&qe.target===qe.currentTarget&&Ae()&&qe.key===" "&&!qe.defaultPrevented&&D(qe)});let kt=m;kt==="button"&&(Ze.href||Ze.to)&&(kt=L);const Ln={};kt==="button"?(Ln.type=We===void 0?"button":We,Ln.disabled=_):(!Ze.href&&!Ze.to&&(Ln.role="button"),_&&(Ln["aria-disabled"]=_));const Un=jr(n,ht,Ye),zn=re({},r,{centerRipple:a,component:m,disabled:_,disableRipple:S,disableTouchRipple:P,focusRipple:C,tabIndex:De,focusVisible:ot}),Qe=cQ(zn);return te.jsxs(uQ,re({as:kt,className:Qt(Qe.root,l),ownerState:zn,onBlur:ut,onClick:D,onContextMenu:en,onFocus:un,onKeyDown:bn,onKeyUp:Yt,onMouseDown:cn,onMouseLeave:It,onMouseUp:Ht,onDragLeave:mn,onTouchEnd:yn,onTouchMove:vn,onTouchStart:Rt,ref:Un,tabIndex:_?-1:De,type:We},Ln,Ze,{children:[h,nt?te.jsx(iQ,re({ref:Xe,center:a},Ve)):null]}))}),fT=hQ;function dQ(t){return Fn("MuiAlert",t)}const fQ=In("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),gk=fQ;function pQ(t){return Fn("MuiIconButton",t)}const mQ=In("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),gQ=mQ,yQ=["edge","children","className","color","disabled","disableFocusRipple","size"],_Q=t=>{const{classes:e,disabled:n,color:r,edge:i,size:a}=t,h={root:["root",n&&"disabled",r!=="default"&&`color${$t(r)}`,i&&`edge${$t(i)}`,`size${$t(a)}`]};return jn(h,pQ,e)},vQ=_t(fT,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${$t(n.color)}`],n.edge&&e[`edge${$t(n.edge)}`],e[`size${$t(n.size)}`]]}})(({theme:t,ownerState:e})=>re({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return re({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&re({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":re({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${gQ.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),xQ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:h,color:l="default",disabled:m=!1,disableFocusRipple:_=!1,size:S="medium"}=r,P=Gt(r,yQ),C=re({},r,{edge:i,color:l,disabled:m,disableFocusRipple:_,size:S}),L=_Q(C);return te.jsx(vQ,re({className:Qt(L.root,h),centerRipple:!0,focusRipple:!_,disabled:m,ref:n},P,{ownerState:C,children:a}))}),rl=xQ,bQ=Uo(te.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),wQ=Uo(te.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),SQ=Uo(te.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),TQ=Uo(te.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),EQ=Uo(te.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),PQ=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],CQ=t=>{const{variant:e,color:n,severity:r,classes:i}=t,a={root:["root",`color${$t(n||r)}`,`${e}${$t(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return jn(a,dQ,i)},AQ=_t(kv,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${$t(n.color||n.severity)}`]]}})(({theme:t})=>{const e=t.palette.mode==="light"?Cm:Am,n=t.palette.mode==="light"?Am:Cm;return re({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${r}StandardBg`]:n(t.palette[r].light,.9),[`& .${gk.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),border:`1px solid ${(t.vars||t).palette[r].light}`,[`& .${gk.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:re({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${r}FilledColor`],backgroundColor:t.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[r].dark:t.palette[r].main,color:t.palette.getContrastText(t.palette[r].main)})}))]})}),IQ=_t("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),kQ=_t("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),yk=_t("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),_k={success:te.jsx(bQ,{fontSize:"inherit"}),warning:te.jsx(wQ,{fontSize:"inherit"}),error:te.jsx(SQ,{fontSize:"inherit"}),info:te.jsx(TQ,{fontSize:"inherit"})},MQ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiAlert"}),{action:i,children:a,className:h,closeText:l="Close",color:m,components:_={},componentsProps:S={},icon:P,iconMapping:C=_k,onClose:L,role:R="alert",severity:D="success",slotProps:W={},slots:z={},variant:N="standard"}=r,F=Gt(r,PQ),$=re({},r,{color:m,severity:D,variant:N,colorSeverity:m||D}),K=CQ($),ne={slots:re({closeButton:_.CloseButton,closeIcon:_.CloseIcon},z),slotProps:re({},S,W)},[se,xe]=hk("closeButton",{elementType:rl,externalForwardedProps:ne,ownerState:$}),[Se,_e]=hk("closeIcon",{elementType:EQ,externalForwardedProps:ne,ownerState:$});return te.jsxs(AQ,re({role:R,elevation:0,ownerState:$,className:Qt(K.root,h),ref:n},F,{children:[P!==!1?te.jsx(IQ,{ownerState:$,className:K.icon,children:P||C[D]||_k[D]}):null,te.jsx(kQ,{ownerState:$,className:K.message,children:a}),i!=null?te.jsx(yk,{ownerState:$,className:K.action,children:i}):null,i==null&&L?te.jsx(yk,{ownerState:$,className:K.action,children:te.jsx(se,re({size:"small","aria-label":l,title:l,color:"inherit",onClick:L},xe,{children:te.jsx(Se,re({fontSize:"small"},_e))}))}):null]}))}),LQ=MQ;function RQ(t){return Fn("MuiTypography",t)}In("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const OQ=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],zQ=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:i,variant:a,classes:h}=t,l={root:["root",a,t.align!=="inherit"&&`align${$t(e)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]};return jn(l,RQ,h)},DQ=_t("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${$t(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>re({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),vk={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},FQ={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},NQ=t=>FQ[t]||t,BQ=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiTypography"}),i=NQ(r.color),a=J2(re({},r,{color:i})),{align:h="inherit",className:l,component:m,gutterBottom:_=!1,noWrap:S=!1,paragraph:P=!1,variant:C="body1",variantMapping:L=vk}=a,R=Gt(a,OQ),D=re({},a,{align:h,color:i,className:l,component:m,gutterBottom:_,noWrap:S,paragraph:P,variant:C,variantMapping:L}),W=m||(P?"p":L[C]||vk[C])||"span",z=zQ(D);return te.jsx(DQ,re({as:W,ref:n,ownerState:D,className:Qt(z.root,l)},R))}),xs=BQ;var pT={};Object.defineProperty(pT,"__esModule",{value:!0});var jz=pT.default=void 0,jQ=UQ(q),VQ=Dz;function Vz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Vz=function(r){return r?n:e})(t)}function UQ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Vz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var h=i?Object.getOwnPropertyDescriptor(t,a):null;h&&(h.get||h.set)?Object.defineProperty(r,a,h):r[a]=t[a]}return r.default=t,n&&n.set(t,r),r}function $Q(t){return Object.keys(t).length===0}function GQ(t=null){const e=jQ.useContext(VQ.ThemeContext);return!e||$Q(e)?t:e}jz=pT.default=GQ;var Bs="top",No="bottom",Bo="right",js="left",mT="auto",rg=[Bs,No,Bo,js],Nd="start",Im="end",WQ="clippingParents",Uz="viewport",gp="popper",HQ="reference",xk=rg.reduce(function(t,e){return t.concat([e+"-"+Nd,e+"-"+Im])},[]),$z=[].concat(rg,[mT]).reduce(function(t,e){return t.concat([e,e+"-"+Nd,e+"-"+Im])},[]),qQ="beforeRead",ZQ="read",XQ="afterRead",YQ="beforeMain",KQ="main",JQ="afterMain",QQ="beforeWrite",eee="write",tee="afterWrite",nee=[qQ,ZQ,XQ,YQ,KQ,JQ,QQ,eee,tee];function Na(t){return t?(t.nodeName||"").toLowerCase():null}function lo(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Lu(t){var e=lo(t).Element;return t instanceof e||t instanceof Element}function Oo(t){var e=lo(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function gT(t){if(typeof ShadowRoot>"u")return!1;var e=lo(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function ree(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},a=e.elements[n];!Oo(a)||!Na(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(h){var l=i[h];l===!1?a.removeAttribute(h):a.setAttribute(h,l===!0?"":l)}))})}function iee(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},h=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=h.reduce(function(m,_){return m[_]="",m},{});!Oo(i)||!Na(i)||(Object.assign(i.style,l),Object.keys(a).forEach(function(m){i.removeAttribute(m)}))})}}const see={name:"applyStyles",enabled:!0,phase:"write",fn:ree,effect:iee,requires:["computeStyles"]};function za(t){return t.split("-")[0]}var Su=Math.max,__=Math.min,Bd=Math.round;function tS(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Gz(){return!/^((?!chrome|android).)*safari/i.test(tS())}function jd(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,a=1;e&&Oo(t)&&(i=t.offsetWidth>0&&Bd(r.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Bd(r.height)/t.offsetHeight||1);var h=Lu(t)?lo(t):window,l=h.visualViewport,m=!Gz()&&n,_=(r.left+(m&&l?l.offsetLeft:0))/i,S=(r.top+(m&&l?l.offsetTop:0))/a,P=r.width/i,C=r.height/a;return{width:P,height:C,top:S,right:_+P,bottom:S+C,left:_,x:_,y:S}}function yT(t){var e=jd(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Wz(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&gT(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function bl(t){return lo(t).getComputedStyle(t)}function oee(t){return["table","td","th"].indexOf(Na(t))>=0}function Mc(t){return((Lu(t)?t.ownerDocument:t.document)||window.document).documentElement}function Lv(t){return Na(t)==="html"?t:t.assignedSlot||t.parentNode||(gT(t)?t.host:null)||Mc(t)}function bk(t){return!Oo(t)||bl(t).position==="fixed"?null:t.offsetParent}function aee(t){var e=/firefox/i.test(tS()),n=/Trident/i.test(tS());if(n&&Oo(t)){var r=bl(t);if(r.position==="fixed")return null}var i=Lv(t);for(gT(i)&&(i=i.host);Oo(i)&&["html","body"].indexOf(Na(i))<0;){var a=bl(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function ig(t){for(var e=lo(t),n=bk(t);n&&oee(n)&&bl(n).position==="static";)n=bk(n);return n&&(Na(n)==="html"||Na(n)==="body"&&bl(n).position==="static")?e:n||aee(t)||e}function _T(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Gp(t,e,n){return Su(t,__(e,n))}function lee(t,e,n){var r=Gp(t,e,n);return r>n?n:r}function Hz(){return{top:0,right:0,bottom:0,left:0}}function qz(t){return Object.assign({},Hz(),t)}function Zz(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var cee=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,qz(typeof e!="number"?e:Zz(e,rg))};function uee(t){var e,n=t.state,r=t.name,i=t.options,a=n.elements.arrow,h=n.modifiersData.popperOffsets,l=za(n.placement),m=_T(l),_=[js,Bo].indexOf(l)>=0,S=_?"height":"width";if(!(!a||!h)){var P=cee(i.padding,n),C=yT(a),L=m==="y"?Bs:js,R=m==="y"?No:Bo,D=n.rects.reference[S]+n.rects.reference[m]-h[m]-n.rects.popper[S],W=h[m]-n.rects.reference[m],z=ig(a),N=z?m==="y"?z.clientHeight||0:z.clientWidth||0:0,F=D/2-W/2,$=P[L],K=N-C[S]-P[R],ne=N/2-C[S]/2+F,se=Gp($,ne,K),xe=m;n.modifiersData[r]=(e={},e[xe]=se,e.centerOffset=se-ne,e)}}function hee(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Wz(e.elements.popper,i)&&(e.elements.arrow=i))}const dee={name:"arrow",enabled:!0,phase:"main",fn:uee,effect:hee,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Vd(t){return t.split("-")[1]}var fee={top:"auto",right:"auto",bottom:"auto",left:"auto"};function pee(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Bd(n*i)/i||0,y:Bd(r*i)/i||0}}function wk(t){var e,n=t.popper,r=t.popperRect,i=t.placement,a=t.variation,h=t.offsets,l=t.position,m=t.gpuAcceleration,_=t.adaptive,S=t.roundOffsets,P=t.isFixed,C=h.x,L=C===void 0?0:C,R=h.y,D=R===void 0?0:R,W=typeof S=="function"?S({x:L,y:D}):{x:L,y:D};L=W.x,D=W.y;var z=h.hasOwnProperty("x"),N=h.hasOwnProperty("y"),F=js,$=Bs,K=window;if(_){var ne=ig(n),se="clientHeight",xe="clientWidth";if(ne===lo(n)&&(ne=Mc(n),bl(ne).position!=="static"&&l==="absolute"&&(se="scrollHeight",xe="scrollWidth")),ne=ne,i===Bs||(i===js||i===Bo)&&a===Im){$=No;var Se=P&&ne===K&&K.visualViewport?K.visualViewport.height:ne[se];D-=Se-r.height,D*=m?1:-1}if(i===js||(i===Bs||i===No)&&a===Im){F=Bo;var _e=P&&ne===K&&K.visualViewport?K.visualViewport.width:ne[xe];L-=_e-r.width,L*=m?1:-1}}var Re=Object.assign({position:l},_&&fee),De=S===!0?pee({x:L,y:D},lo(n)):{x:L,y:D};if(L=De.x,D=De.y,m){var Ve;return Object.assign({},Re,(Ve={},Ve[$]=N?"0":"",Ve[F]=z?"0":"",Ve.transform=(K.devicePixelRatio||1)<=1?"translate("+L+"px, "+D+"px)":"translate3d("+L+"px, "+D+"px, 0)",Ve))}return Object.assign({},Re,(e={},e[$]=N?D+"px":"",e[F]=z?L+"px":"",e.transform="",e))}function mee(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,h=a===void 0?!0:a,l=n.roundOffsets,m=l===void 0?!0:l,_={placement:za(e.placement),variation:Vd(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wk(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wk(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const gee={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:mee,data:{}};var $y={passive:!0};function yee(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,a=i===void 0?!0:i,h=r.resize,l=h===void 0?!0:h,m=lo(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&_.forEach(function(S){S.addEventListener("scroll",n.update,$y)}),l&&m.addEventListener("resize",n.update,$y),function(){a&&_.forEach(function(S){S.removeEventListener("scroll",n.update,$y)}),l&&m.removeEventListener("resize",n.update,$y)}}const _ee={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:yee,data:{}};var vee={left:"right",right:"left",bottom:"top",top:"bottom"};function A0(t){return t.replace(/left|right|bottom|top/g,function(e){return vee[e]})}var xee={start:"end",end:"start"};function Sk(t){return t.replace(/start|end/g,function(e){return xee[e]})}function vT(t){var e=lo(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function xT(t){return jd(Mc(t)).left+vT(t).scrollLeft}function bee(t,e){var n=lo(t),r=Mc(t),i=n.visualViewport,a=r.clientWidth,h=r.clientHeight,l=0,m=0;if(i){a=i.width,h=i.height;var _=Gz();(_||!_&&e==="fixed")&&(l=i.offsetLeft,m=i.offsetTop)}return{width:a,height:h,x:l+xT(t),y:m}}function wee(t){var e,n=Mc(t),r=vT(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=Su(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),h=Su(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+xT(t),m=-r.scrollTop;return bl(i||n).direction==="rtl"&&(l+=Su(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:h,x:l,y:m}}function bT(t){var e=bl(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Xz(t){return["html","body","#document"].indexOf(Na(t))>=0?t.ownerDocument.body:Oo(t)&&bT(t)?t:Xz(Lv(t))}function Wp(t,e){var n;e===void 0&&(e=[]);var r=Xz(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),a=lo(r),h=i?[a].concat(a.visualViewport||[],bT(r)?r:[]):r,l=e.concat(h);return i?l:l.concat(Wp(Lv(h)))}function nS(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function See(t,e){var n=jd(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function Tk(t,e,n){return e===Uz?nS(bee(t,n)):Lu(e)?See(e,n):nS(wee(Mc(t)))}function Tee(t){var e=Wp(Lv(t)),n=["absolute","fixed"].indexOf(bl(t).position)>=0,r=n&&Oo(t)?ig(t):t;return Lu(r)?e.filter(function(i){return Lu(i)&&Wz(i,r)&&Na(i)!=="body"}):[]}function Eee(t,e,n,r){var i=e==="clippingParents"?Tee(t):[].concat(e),a=[].concat(i,[n]),h=a[0],l=a.reduce(function(m,_){var S=Tk(t,_,r);return m.top=Su(S.top,m.top),m.right=__(S.right,m.right),m.bottom=__(S.bottom,m.bottom),m.left=Su(S.left,m.left),m},Tk(t,h,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Yz(t){var e=t.reference,n=t.element,r=t.placement,i=r?za(r):null,a=r?Vd(r):null,h=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,m;switch(i){case Bs:m={x:h,y:e.y-n.height};break;case No:m={x:h,y:e.y+e.height};break;case Bo:m={x:e.x+e.width,y:l};break;case js:m={x:e.x-n.width,y:l};break;default:m={x:e.x,y:e.y}}var _=i?_T(i):null;if(_!=null){var S=_==="y"?"height":"width";switch(a){case Nd:m[_]=m[_]-(e[S]/2-n[S]/2);break;case Im:m[_]=m[_]+(e[S]/2-n[S]/2);break}}return m}function km(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,a=n.strategy,h=a===void 0?t.strategy:a,l=n.boundary,m=l===void 0?WQ:l,_=n.rootBoundary,S=_===void 0?Uz:_,P=n.elementContext,C=P===void 0?gp:P,L=n.altBoundary,R=L===void 0?!1:L,D=n.padding,W=D===void 0?0:D,z=qz(typeof W!="number"?W:Zz(W,rg)),N=C===gp?HQ:gp,F=t.rects.popper,$=t.elements[R?N:C],K=Eee(Lu($)?$:$.contextElement||Mc(t.elements.popper),m,S,h),ne=jd(t.elements.reference),se=Yz({reference:ne,element:F,strategy:"absolute",placement:i}),xe=nS(Object.assign({},F,se)),Se=C===gp?xe:ne,_e={top:K.top-Se.top+z.top,bottom:Se.bottom-K.bottom+z.bottom,left:K.left-Se.left+z.left,right:Se.right-K.right+z.right},Re=t.modifiersData.offset;if(C===gp&&Re){var De=Re[i];Object.keys(_e).forEach(function(Ve){var je=[Bo,No].indexOf(Ve)>=0?1:-1,We=[Bs,No].indexOf(Ve)>=0?"y":"x";_e[Ve]+=De[We]*je})}return _e}function Pee(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,a=n.rootBoundary,h=n.padding,l=n.flipVariations,m=n.allowedAutoPlacements,_=m===void 0?$z:m,S=Vd(r),P=S?l?xk:xk.filter(function(R){return Vd(R)===S}):rg,C=P.filter(function(R){return _.indexOf(R)>=0});C.length===0&&(C=P);var L=C.reduce(function(R,D){return R[D]=km(t,{placement:D,boundary:i,rootBoundary:a,padding:h})[za(D)],R},{});return Object.keys(L).sort(function(R,D){return L[R]-L[D]})}function Cee(t){if(za(t)===mT)return[];var e=A0(t);return[Sk(t),e,Sk(e)]}function Aee(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!0:h,m=n.fallbackPlacements,_=n.padding,S=n.boundary,P=n.rootBoundary,C=n.altBoundary,L=n.flipVariations,R=L===void 0?!0:L,D=n.allowedAutoPlacements,W=e.options.placement,z=za(W),N=z===W,F=m||(N||!R?[A0(W)]:Cee(W)),$=[W].concat(F).reduce(function(ot,xt){return ot.concat(za(xt)===mT?Pee(e,{placement:xt,boundary:S,rootBoundary:P,padding:_,flipVariations:R,allowedAutoPlacements:D}):xt)},[]),K=e.rects.reference,ne=e.rects.popper,se=new Map,xe=!0,Se=$[0],_e=0;_e<$.length;_e++){var Re=$[_e],De=za(Re),Ve=Vd(Re)===Nd,je=[Bs,No].indexOf(De)>=0,We=je?"width":"height",Ze=km(e,{placement:Re,boundary:S,rootBoundary:P,altBoundary:C,padding:_}),Ye=je?Ve?Bo:js:Ve?No:Bs;K[We]>ne[We]&&(Ye=A0(Ye));var Ce=A0(Ye),Xe=[];if(a&&Xe.push(Ze[De]<=0),l&&Xe.push(Ze[Ye]<=0,Ze[Ce]<=0),Xe.every(function(ot){return ot})){Se=Re,xe=!1;break}se.set(Re,Xe)}if(xe)for(var lt=R?3:1,Dt=function(xt){var bt=$.find(function(Wt){var nt=se.get(Wt);if(nt)return nt.slice(0,xt).every(function(Et){return Et})});if(bt)return Se=bt,"break"},mt=lt;mt>0;mt--){var ht=Dt(mt);if(ht==="break")break}e.placement!==Se&&(e.modifiersData[r]._skip=!0,e.placement=Se,e.reset=!0)}}const Iee={name:"flip",enabled:!0,phase:"main",fn:Aee,requiresIfExists:["offset"],data:{_skip:!1}};function Ek(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Pk(t){return[Bs,Bo,No,js].some(function(e){return t[e]>=0})}function kee(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,h=km(e,{elementContext:"reference"}),l=km(e,{altBoundary:!0}),m=Ek(h,r),_=Ek(l,i,a),S=Pk(m),P=Pk(_);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:S,hasPopperEscaped:P},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":S,"data-popper-escaped":P})}const Mee={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:kee};function Lee(t,e,n){var r=za(t),i=[js,Bs].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,h=a[0],l=a[1];return h=h||0,l=(l||0)*i,[js,Bo].indexOf(r)>=0?{x:l,y:h}:{x:h,y:l}}function Ree(t){var e=t.state,n=t.options,r=t.name,i=n.offset,a=i===void 0?[0,0]:i,h=$z.reduce(function(S,P){return S[P]=Lee(P,e.rects,a),S},{}),l=h[e.placement],m=l.x,_=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=_),e.modifiersData[r]=h}const Oee={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Ree};function zee(t){var e=t.state,n=t.name;e.modifiersData[n]=Yz({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Dee={name:"popperOffsets",enabled:!0,phase:"read",fn:zee,data:{}};function Fee(t){return t==="x"?"y":"x"}function Nee(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!1:h,m=n.boundary,_=n.rootBoundary,S=n.altBoundary,P=n.padding,C=n.tether,L=C===void 0?!0:C,R=n.tetherOffset,D=R===void 0?0:R,W=km(e,{boundary:m,rootBoundary:_,padding:P,altBoundary:S}),z=za(e.placement),N=Vd(e.placement),F=!N,$=_T(z),K=Fee($),ne=e.modifiersData.popperOffsets,se=e.rects.reference,xe=e.rects.popper,Se=typeof D=="function"?D(Object.assign({},e.rects,{placement:e.placement})):D,_e=typeof Se=="number"?{mainAxis:Se,altAxis:Se}:Object.assign({mainAxis:0,altAxis:0},Se),Re=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,De={x:0,y:0};if(ne){if(a){var Ve,je=$==="y"?Bs:js,We=$==="y"?No:Bo,Ze=$==="y"?"height":"width",Ye=ne[$],Ce=Ye+W[je],Xe=Ye-W[We],lt=L?-xe[Ze]/2:0,Dt=N===Nd?se[Ze]:xe[Ze],mt=N===Nd?-xe[Ze]:-se[Ze],ht=e.elements.arrow,ot=L&&ht?yT(ht):{width:0,height:0},xt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Hz(),bt=xt[je],Wt=xt[We],nt=Gp(0,se[Ze],ot[Ze]),Et=F?se[Ze]/2-lt-nt-bt-_e.mainAxis:Dt-nt-bt-_e.mainAxis,cn=F?-se[Ze]/2+lt+nt+Wt+_e.mainAxis:mt+nt+Wt+_e.mainAxis,en=e.elements.arrow&&ig(e.elements.arrow),mn=en?$==="y"?en.clientTop||0:en.clientLeft||0:0,Ht=(Ve=Re==null?void 0:Re[$])!=null?Ve:0,It=Ye+Et-Ht-mn,Rt=Ye+cn-Ht,yn=Gp(L?__(Ce,It):Ce,Ye,L?Su(Xe,Rt):Xe);ne[$]=yn,De[$]=yn-Ye}if(l){var vn,ut=$==="x"?Bs:js,un=$==="x"?No:Bo,Ae=ne[K],Ct=K==="y"?"height":"width",bn=Ae+W[ut],Yt=Ae-W[un],kt=[Bs,js].indexOf(z)!==-1,Ln=(vn=Re==null?void 0:Re[K])!=null?vn:0,Un=kt?bn:Ae-se[Ct]-xe[Ct]-Ln+_e.altAxis,zn=kt?Ae+se[Ct]+xe[Ct]-Ln-_e.altAxis:Yt,Qe=L&&kt?lee(Un,Ae,zn):Gp(L?Un:bn,Ae,L?zn:Yt);ne[K]=Qe,De[K]=Qe-Ae}e.modifiersData[r]=De}}const Bee={name:"preventOverflow",enabled:!0,phase:"main",fn:Nee,requiresIfExists:["offset"]};function jee(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Vee(t){return t===lo(t)||!Oo(t)?vT(t):jee(t)}function Uee(t){var e=t.getBoundingClientRect(),n=Bd(e.width)/t.offsetWidth||1,r=Bd(e.height)/t.offsetHeight||1;return n!==1||r!==1}function $ee(t,e,n){n===void 0&&(n=!1);var r=Oo(e),i=Oo(e)&&Uee(e),a=Mc(e),h=jd(t,i,n),l={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((Na(e)!=="body"||bT(a))&&(l=Vee(e)),Oo(e)?(m=jd(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):a&&(m.x=xT(a))),{x:h.left+l.scrollLeft-m.x,y:h.top+l.scrollTop-m.y,width:h.width,height:h.height}}function Gee(t){var e=new Map,n=new Set,r=[];t.forEach(function(a){e.set(a.name,a)});function i(a){n.add(a.name);var h=[].concat(a.requires||[],a.requiresIfExists||[]);h.forEach(function(l){if(!n.has(l)){var m=e.get(l);m&&i(m)}}),r.push(a)}return t.forEach(function(a){n.has(a.name)||i(a)}),r}function Wee(t){var e=Gee(t);return nee.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function Hee(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function qee(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var Ck={placement:"bottom",modifiers:[],strategy:"absolute"};function Ak(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Zee(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,a=i===void 0?Ck:i;return function(l,m,_){_===void 0&&(_=a);var S={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ck,a),modifiersData:{},elements:{reference:l,popper:m},attributes:{},styles:{}},P=[],C=!1,L={state:S,setOptions:function(z){var N=typeof z=="function"?z(S.options):z;D(),S.options=Object.assign({},a,S.options,N),S.scrollParents={reference:Lu(l)?Wp(l):l.contextElement?Wp(l.contextElement):[],popper:Wp(m)};var F=Wee(qee([].concat(r,S.options.modifiers)));return S.orderedModifiers=F.filter(function($){return $.enabled}),R(),L.update()},forceUpdate:function(){if(!C){var z=S.elements,N=z.reference,F=z.popper;if(Ak(N,F)){S.rects={reference:$ee(N,ig(F),S.options.strategy==="fixed"),popper:yT(F)},S.reset=!1,S.placement=S.options.placement,S.orderedModifiers.forEach(function(_e){return S.modifiersData[_e.name]=Object.assign({},_e.data)});for(var $=0;$<S.orderedModifiers.length;$++){if(S.reset===!0){S.reset=!1,$=-1;continue}var K=S.orderedModifiers[$],ne=K.fn,se=K.options,xe=se===void 0?{}:se,Se=K.name;typeof ne=="function"&&(S=ne({state:S,options:xe,name:Se,instance:L})||S)}}}},update:Hee(function(){return new Promise(function(W){L.forceUpdate(),W(S)})}),destroy:function(){D(),C=!0}};if(!Ak(l,m))return L;L.setOptions(_).then(function(W){!C&&_.onFirstUpdate&&_.onFirstUpdate(W)});function R(){S.orderedModifiers.forEach(function(W){var z=W.name,N=W.options,F=N===void 0?{}:N,$=W.effect;if(typeof $=="function"){var K=$({state:S,name:z,instance:L,options:F}),ne=function(){};P.push(K||ne)}})}function D(){P.forEach(function(W){return W()}),P=[]}return L}}var Xee=[_ee,Dee,gee,see,Oee,Iee,Bee,dee,Mee],Yee=Zee({defaultModifiers:Xee});function Kee(t){return typeof t=="function"?t():t}const Jee=q.forwardRef(function(e,n){const{children:r,container:i,disablePortal:a=!1}=e,[h,l]=q.useState(null),m=jr(q.isValidElement(r)?kc(r):null,n);if(fa(()=>{a||l(Kee(i)||document.body)},[i,a]),fa(()=>{if(h&&!a)return Zw(n,h),()=>{Zw(n,null)}},[n,h,a]),a){if(q.isValidElement(r)){const _={ref:m};return q.cloneElement(r,_)}return te.jsx(q.Fragment,{children:r})}return te.jsx(q.Fragment,{children:h&&Fm.createPortal(r,h)})}),Kz=Jee;function Qee(t){return Fn("MuiPopper",t)}In("MuiPopper",["root"]);const ete=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],tte=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function nte(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function rS(t){return typeof t=="function"?t():t}function rte(t){return t.nodeType!==void 0}const ite=t=>{const{classes:e}=t;return jn({root:["root"]},Qee,e)},ste={},ote=q.forwardRef(function(e,n){var r;const{anchorEl:i,children:a,direction:h,disablePortal:l,modifiers:m,open:_,placement:S,popperOptions:P,popperRef:C,slotProps:L={},slots:R={},TransitionProps:D}=e,W=Gt(e,ete),z=q.useRef(null),N=jr(z,n),F=q.useRef(null),$=jr(F,C),K=q.useRef($);fa(()=>{K.current=$},[$]),q.useImperativeHandle(C,()=>F.current,[]);const ne=nte(S,h),[se,xe]=q.useState(ne),[Se,_e]=q.useState(rS(i));q.useEffect(()=>{F.current&&F.current.forceUpdate()}),q.useEffect(()=>{i&&_e(rS(i))},[i]),fa(()=>{if(!Se||!_)return;const We=Ce=>{xe(Ce.placement)};let Ze=[{name:"preventOverflow",options:{altBoundary:l}},{name:"flip",options:{altBoundary:l}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ce})=>{We(Ce)}}];m!=null&&(Ze=Ze.concat(m)),P&&P.modifiers!=null&&(Ze=Ze.concat(P.modifiers));const Ye=Yee(Se,z.current,re({placement:ne},P,{modifiers:Ze}));return K.current(Ye),()=>{Ye.destroy(),K.current(null)}},[Se,l,m,_,P,ne]);const Re={placement:se};D!==null&&(Re.TransitionProps=D);const De=ite(e),Ve=(r=R.root)!=null?r:"div",je=is({elementType:Ve,externalSlotProps:L.root,externalForwardedProps:W,additionalProps:{role:"tooltip",ref:N},ownerState:e,className:De.root});return te.jsx(Ve,re({},je,{children:typeof a=="function"?a(Re):a}))}),ate=q.forwardRef(function(e,n){const{anchorEl:r,children:i,container:a,direction:h="ltr",disablePortal:l=!1,keepMounted:m=!1,modifiers:_,open:S,placement:P="bottom",popperOptions:C=ste,popperRef:L,style:R,transition:D=!1,slotProps:W={},slots:z={}}=e,N=Gt(e,tte),[F,$]=q.useState(!0),K=()=>{$(!1)},ne=()=>{$(!0)};if(!m&&!S&&(!D||F))return null;let se;if(a)se=a;else if(r){const _e=rS(r);se=_e&&rte(_e)?Xr(_e).body:Xr(null).body}const xe=!S&&m&&(!D||F)?"none":void 0,Se=D?{in:S,onEnter:K,onExited:ne}:void 0;return te.jsx(Kz,{disablePortal:l,container:se,children:te.jsx(ote,re({anchorEl:r,direction:h,disablePortal:l,modifiers:_,ref:n,open:D?!F:S,placement:P,popperOptions:C,popperRef:L,slotProps:W,slots:z},N,{style:re({position:"fixed",top:0,left:0,display:xe},R),TransitionProps:Se,children:i}))})}),lte=ate,cte=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],ute=_t(lte,{name:"MuiPopper",slot:"Root",overridesResolver:(t,e)=>e.root})({}),hte=q.forwardRef(function(e,n){var r;const i=jz(),a=Nn({props:e,name:"MuiPopper"}),{anchorEl:h,component:l,components:m,componentsProps:_,container:S,disablePortal:P,keepMounted:C,modifiers:L,open:R,placement:D,popperOptions:W,popperRef:z,transition:N,slots:F,slotProps:$}=a,K=Gt(a,cte),ne=(r=F==null?void 0:F.root)!=null?r:m==null?void 0:m.Root,se=re({anchorEl:h,container:S,disablePortal:P,keepMounted:C,modifiers:L,open:R,placement:D,popperOptions:W,popperRef:z,transition:N},K);return te.jsx(ute,re({as:l,direction:i==null?void 0:i.direction,slots:{root:ne},slotProps:$??_},se,{ref:n}))}),Jz=hte,dte=["onChange","maxRows","minRows","style","value"];function Gy(t){return parseInt(t,10)||0}const fte={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function pte(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflowing}const mte=q.forwardRef(function(e,n){const{onChange:r,maxRows:i,minRows:a=1,style:h,value:l}=e,m=Gt(e,dte),{current:_}=q.useRef(l!=null),S=q.useRef(null),P=jr(n,S),C=q.useRef(null),L=q.useRef(null),R=q.useCallback(()=>{const z=S.current,F=xl(z).getComputedStyle(z);if(F.width==="0px")return{outerHeightStyle:0,overflowing:!1};const $=L.current;$.style.width=F.width,$.value=z.value||e.placeholder||"x",$.value.slice(-1)===`
`&&($.value+=" ");const K=F.boxSizing,ne=Gy(F.paddingBottom)+Gy(F.paddingTop),se=Gy(F.borderBottomWidth)+Gy(F.borderTopWidth),xe=$.scrollHeight;$.value="x";const Se=$.scrollHeight;let _e=xe;a&&(_e=Math.max(Number(a)*Se,_e)),i&&(_e=Math.min(Number(i)*Se,_e)),_e=Math.max(_e,Se);const Re=_e+(K==="border-box"?ne+se:0),De=Math.abs(_e-xe)<=1;return{outerHeightStyle:Re,overflowing:De}},[i,a,e.placeholder]),D=q.useCallback(()=>{const z=R();if(pte(z))return;const N=z.outerHeightStyle,F=S.current;C.current!==N&&(C.current=N,F.style.height=`${N}px`),F.style.overflow=z.overflowing?"hidden":""},[R]);fa(()=>{const z=()=>{D()};let N;const F=tT(z),$=S.current,K=xl($);K.addEventListener("resize",F);let ne;return typeof ResizeObserver<"u"&&(ne=new ResizeObserver(z),ne.observe($)),()=>{F.clear(),cancelAnimationFrame(N),K.removeEventListener("resize",F),ne&&ne.disconnect()}},[R,D]),fa(()=>{D()});const W=z=>{_||D(),r&&r(z)};return te.jsxs(q.Fragment,{children:[te.jsx("textarea",re({value:l,onChange:W,ref:P,rows:a,style:h},m)),te.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:L,tabIndex:-1,style:re({},fte.shadow,h,{paddingTop:0,paddingBottom:0})})]})}),gte=mte;function Jd({props:t,states:e,muiFormControl:n}){return e.reduce((r,i)=>(r[i]=t[i],n&&typeof t[i]>"u"&&(r[i]=n[i]),r),{})}const yte=q.createContext(void 0),Rv=yte;function ju(){return q.useContext(Rv)}function Qz(t){return te.jsx(CY,re({},t,{defaultTheme:lT,themeId:zd}))}function Ik(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function v_(t,e=!1){return t&&(Ik(t.value)&&t.value!==""||e&&Ik(t.defaultValue)&&t.defaultValue!=="")}function _te(t){return t.startAdornment}function vte(t){return Fn("MuiInputBase",t)}const xte=In("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Ud=xte,bte=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],Ov=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${$t(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},zv=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},wte=t=>{const{classes:e,color:n,disabled:r,error:i,endAdornment:a,focused:h,formControl:l,fullWidth:m,hiddenLabel:_,multiline:S,readOnly:P,size:C,startAdornment:L,type:R}=t,D={root:["root",`color${$t(n)}`,r&&"disabled",i&&"error",m&&"fullWidth",h&&"focused",l&&"formControl",C&&C!=="medium"&&`size${$t(C)}`,S&&"multiline",L&&"adornedStart",a&&"adornedEnd",_&&"hiddenLabel",P&&"readOnly"],input:["input",r&&"disabled",R==="search"&&"inputTypeSearch",S&&"inputMultiline",C==="small"&&"inputSizeSmall",_&&"inputHiddenLabel",L&&"inputAdornedStart",a&&"inputAdornedEnd",P&&"readOnly"]};return jn(D,vte,e)},Dv=_t("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Ov})(({theme:t,ownerState:e})=>re({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Ud.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&re({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),Fv=_t("input",{name:"MuiInputBase",slot:"Input",overridesResolver:zv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=re({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),i={opacity:"0 !important"},a=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return re({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Ud.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":a,"&:focus::-moz-placeholder":a,"&:focus:-ms-input-placeholder":a,"&:focus::-ms-input-placeholder":a},[`&.${Ud.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),Ste=te.jsx(Qz,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Tte=q.forwardRef(function(e,n){var r;const i=Nn({props:e,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:h,autoFocus:l,className:m,components:_={},componentsProps:S={},defaultValue:P,disabled:C,disableInjectingGlobalStyles:L,endAdornment:R,fullWidth:D=!1,id:W,inputComponent:z="input",inputProps:N={},inputRef:F,maxRows:$,minRows:K,multiline:ne=!1,name:se,onBlur:xe,onChange:Se,onClick:_e,onFocus:Re,onKeyDown:De,onKeyUp:Ve,placeholder:je,readOnly:We,renderSuffix:Ze,rows:Ye,slotProps:Ce={},slots:Xe={},startAdornment:lt,type:Dt="text",value:mt}=i,ht=Gt(i,bte),ot=N.value!=null?N.value:mt,{current:xt}=q.useRef(ot!=null),bt=q.useRef(),Wt=q.useCallback(Qe=>{},[]),nt=jr(bt,F,N.ref,Wt),[Et,cn]=q.useState(!1),en=ju(),mn=Jd({props:i,muiFormControl:en,states:["color","disabled","error","hiddenLabel","size","required","filled"]});mn.focused=en?en.focused:Et,q.useEffect(()=>{!en&&C&&Et&&(cn(!1),xe&&xe())},[en,C,Et,xe]);const Ht=en&&en.onFilled,It=en&&en.onEmpty,Rt=q.useCallback(Qe=>{v_(Qe)?Ht&&Ht():It&&It()},[Ht,It]);fa(()=>{xt&&Rt({value:ot})},[ot,Rt,xt]);const yn=Qe=>{if(mn.disabled){Qe.stopPropagation();return}Re&&Re(Qe),N.onFocus&&N.onFocus(Qe),en&&en.onFocus?en.onFocus(Qe):cn(!0)},vn=Qe=>{xe&&xe(Qe),N.onBlur&&N.onBlur(Qe),en&&en.onBlur?en.onBlur(Qe):cn(!1)},ut=(Qe,...qe)=>{if(!xt){const vt=Qe.target||bt.current;if(vt==null)throw new Error(_l(1));Rt({value:vt.value})}N.onChange&&N.onChange(Qe,...qe),Se&&Se(Qe,...qe)};q.useEffect(()=>{Rt(bt.current)},[]);const un=Qe=>{bt.current&&Qe.currentTarget===Qe.target&&bt.current.focus(),_e&&_e(Qe)};let Ae=z,Ct=N;ne&&Ae==="input"&&(Ye?Ct=re({type:void 0,minRows:Ye,maxRows:Ye},Ct):Ct=re({type:void 0,maxRows:$,minRows:K},Ct),Ae=gte);const bn=Qe=>{Rt(Qe.animationName==="mui-auto-fill-cancel"?bt.current:{value:"x"})};q.useEffect(()=>{en&&en.setAdornedStart(!!lt)},[en,lt]);const Yt=re({},i,{color:mn.color||"primary",disabled:mn.disabled,endAdornment:R,error:mn.error,focused:mn.focused,formControl:en,fullWidth:D,hiddenLabel:mn.hiddenLabel,multiline:ne,size:mn.size,startAdornment:lt,type:Dt}),kt=wte(Yt),Ln=Xe.root||_.Root||Dv,Un=Ce.root||S.root||{},zn=Xe.input||_.Input||Fv;return Ct=re({},Ct,(r=Ce.input)!=null?r:S.input),te.jsxs(q.Fragment,{children:[!L&&Ste,te.jsxs(Ln,re({},Un,!wc(Ln)&&{ownerState:re({},Yt,Un.ownerState)},{ref:n,onClick:un},ht,{className:Qt(kt.root,Un.className,m,We&&"MuiInputBase-readOnly"),children:[lt,te.jsx(Rv.Provider,{value:null,children:te.jsx(zn,re({ownerState:Yt,"aria-invalid":mn.error,"aria-describedby":a,autoComplete:h,autoFocus:l,defaultValue:P,disabled:mn.disabled,id:W,onAnimationStart:bn,name:se,placeholder:je,readOnly:We,required:mn.required,rows:Ye,value:ot,onKeyDown:De,onKeyUp:Ve,type:Dt},Ct,!wc(zn)&&{as:Ae,ownerState:re({},Yt,Ct.ownerState)},{ref:nt,className:Qt(kt.input,Ct.className,We&&"MuiInputBase-readOnly"),onBlur:vn,onChange:ut,onFocus:yn}))}),R,Ze?Ze(re({},mn,{startAdornment:lt})):null]}))]})}),wT=Tte;function Ete(t){return Fn("MuiInput",t)}const Pte=re({},Ud,In("MuiInput",["root","underline","input"])),yp=Pte;function Cte(t){return Fn("MuiOutlinedInput",t)}const Ate=re({},Ud,In("MuiOutlinedInput",["root","notchedOutline","input"])),Kl=Ate;function Ite(t){return Fn("MuiFilledInput",t)}const kte=re({},Ud,In("MuiFilledInput",["root","underline","input"])),ru=kte,Mte=Uo(te.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Lte=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Rte={entering:{opacity:1},entered:{opacity:1}},Ote=q.forwardRef(function(e,n){const r=Yd(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:h=!0,children:l,easing:m,in:_,onEnter:S,onEntered:P,onEntering:C,onExit:L,onExited:R,onExiting:D,style:W,timeout:z=i,TransitionComponent:N=cT}=e,F=Gt(e,Lte),$=q.useRef(null),K=jr($,kc(l),n),ne=je=>We=>{if(je){const Ze=$.current;We===void 0?je(Ze):je(Ze,We)}},se=ne(C),xe=ne((je,We)=>{dT(je);const Ze=Fd({style:W,timeout:z,easing:m},{mode:"enter"});je.style.webkitTransition=r.transitions.create("opacity",Ze),je.style.transition=r.transitions.create("opacity",Ze),S&&S(je,We)}),Se=ne(P),_e=ne(D),Re=ne(je=>{const We=Fd({style:W,timeout:z,easing:m},{mode:"exit"});je.style.webkitTransition=r.transitions.create("opacity",We),je.style.transition=r.transitions.create("opacity",We),L&&L(je)}),De=ne(R),Ve=je=>{a&&a($.current,je)};return te.jsx(N,re({appear:h,in:_,nodeRef:$,onEnter:xe,onEntered:Se,onEntering:se,onExit:Re,onExited:De,onExiting:_e,addEndListener:Ve,timeout:z},F,{children:(je,We)=>q.cloneElement(l,re({style:re({opacity:0,visibility:je==="exited"&&!_?"hidden":void 0},Rte[je],W,l.props.style),ref:K},We))}))}),eD=Ote;function zte(t){return Fn("MuiBackdrop",t)}In("MuiBackdrop",["root","invisible"]);const Dte=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Fte=t=>{const{classes:e,invisible:n}=t;return jn({root:["root",n&&"invisible"]},zte,e)},Nte=_t("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>re({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Bte=q.forwardRef(function(e,n){var r,i,a;const h=Nn({props:e,name:"MuiBackdrop"}),{children:l,className:m,component:_="div",components:S={},componentsProps:P={},invisible:C=!1,open:L,slotProps:R={},slots:D={},TransitionComponent:W=eD,transitionDuration:z}=h,N=Gt(h,Dte),F=re({},h,{component:_,invisible:C}),$=Fte(F),K=(r=R.root)!=null?r:P.root;return te.jsx(W,re({in:L,timeout:z},N,{children:te.jsx(Nte,re({"aria-hidden":!0},K,{as:(i=(a=D.root)!=null?a:S.Root)!=null?i:_,className:Qt($.root,m,K==null?void 0:K.className),ownerState:re({},F,K==null?void 0:K.ownerState),classes:$,ref:n,children:l}))}))}),tD=Bte,jte=In("MuiBox",["root"]),Vte=jte,Ute=aT(),$te=OY({themeId:zd,defaultTheme:Ute,defaultClassName:Vte.root,generateClassName:pz.generate}),n1=$te;function Gte(t){return Fn("MuiButton",t)}const Wte=In("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Wy=Wte,Hte=q.createContext({}),qte=Hte,Zte=q.createContext(void 0),Xte=Zte,Yte=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Kte=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:a,classes:h}=t,l={root:["root",a,`${a}${$t(e)}`,`size${$t(i)}`,`${a}Size${$t(i)}`,`color${$t(e)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${$t(i)}`],endIcon:["icon","endIcon",`iconSize${$t(i)}`]},m=jn(l,Gte,h);return re({},h,m)},nD=t=>re({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Jte=_t(fT,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${$t(n.color)}`],e[`size${$t(n.size)}`],e[`${n.variant}Size${$t(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const i=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],a=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return re({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":re({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:a,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":re({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${Wy.focusVisible}`]:re({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${Wy.disabled}`]:re({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${as(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:i,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Wy.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Wy.disabled}`]:{boxShadow:"none"}}),Qte=_t("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${$t(n.size)}`]]}})(({ownerState:t})=>re({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},nD(t))),ene=_t("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${$t(n.size)}`]]}})(({ownerState:t})=>re({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},nD(t))),tne=q.forwardRef(function(e,n){const r=q.useContext(qte),i=q.useContext(Xte),a=p_(r,e),h=Nn({props:a,name:"MuiButton"}),{children:l,color:m="primary",component:_="button",className:S,disabled:P=!1,disableElevation:C=!1,disableFocusRipple:L=!1,endIcon:R,focusVisibleClassName:D,fullWidth:W=!1,size:z="medium",startIcon:N,type:F,variant:$="text"}=h,K=Gt(h,Yte),ne=re({},h,{color:m,component:_,disabled:P,disableElevation:C,disableFocusRipple:L,fullWidth:W,size:z,type:F,variant:$}),se=Kte(ne),xe=N&&te.jsx(Qte,{className:se.startIcon,ownerState:ne,children:N}),Se=R&&te.jsx(ene,{className:se.endIcon,ownerState:ne,children:R}),_e=i||"";return te.jsxs(Jte,re({ownerState:ne,className:Qt(r.className,se.root,S,_e),component:_,disabled:P,focusRipple:!L,focusVisibleClassName:Qt(se.focusVisible,D),ref:n,type:F},K,{classes:se,children:[xe,l,Se]}))}),cu=tne;function nne(t){return Fn("MuiCircularProgress",t)}In("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const rne=["className","color","disableShrink","size","style","thickness","value","variant"];let Nv=t=>t,kk,Mk,Lk,Rk;const Jl=44,ine=Zd(kk||(kk=Nv`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),sne=Zd(Mk||(Mk=Nv`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),one=t=>{const{classes:e,variant:n,color:r,disableShrink:i}=t,a={root:["root",n,`color${$t(r)}`],svg:["svg"],circle:["circle",`circle${$t(n)}`,i&&"circleDisableShrink"]};return jn(a,nne,e)},ane=_t("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${$t(n.color)}`]]}})(({ownerState:t,theme:e})=>re({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&cv(Lk||(Lk=Nv`
      animation: ${0} 1.4s linear infinite;
    `),ine)),lne=_t("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),cne=_t("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${$t(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>re({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&cv(Rk||(Rk=Nv`
      animation: ${0} 1.4s ease-in-out infinite;
    `),sne)),une=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:h=!1,size:l=40,style:m,thickness:_=3.6,value:S=0,variant:P="indeterminate"}=r,C=Gt(r,rne),L=re({},r,{color:a,disableShrink:h,size:l,thickness:_,value:S,variant:P}),R=one(L),D={},W={},z={};if(P==="determinate"){const N=2*Math.PI*((Jl-_)/2);D.strokeDasharray=N.toFixed(3),z["aria-valuenow"]=Math.round(S),D.strokeDashoffset=`${((100-S)/100*N).toFixed(3)}px`,W.transform="rotate(-90deg)"}return te.jsx(ane,re({className:Qt(R.root,i),style:re({width:l,height:l},W,m),ownerState:L,ref:n,role:"progressbar"},z,C,{children:te.jsx(lne,{className:R.svg,ownerState:L,viewBox:`${Jl/2} ${Jl/2} ${Jl} ${Jl}`,children:te.jsx(cne,{className:R.circle,style:D,ownerState:L,cx:Jl,cy:Jl,r:(Jl-_)/2,fill:"none",strokeWidth:_})})}))}),hne=une;function Ok(t){return t.substring(2).toLowerCase()}function dne(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function fne(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,h=q.useRef(!1),l=q.useRef(null),m=q.useRef(!1),_=q.useRef(!1);q.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const S=jr(kc(e),l),P=zs(R=>{const D=_.current;_.current=!1;const W=Xr(l.current);if(!m.current||!l.current||"clientX"in R&&dne(R,W))return;if(h.current){h.current=!1;return}let z;R.composedPath?z=R.composedPath().indexOf(l.current)>-1:z=!W.documentElement.contains(R.target)||l.current.contains(R.target),!z&&(n||!D)&&i(R)}),C=R=>D=>{_.current=!0;const W=e.props[R];W&&W(D)},L={ref:S};return a!==!1&&(L[a]=C(a)),q.useEffect(()=>{if(a!==!1){const R=Ok(a),D=Xr(l.current),W=()=>{h.current=!0};return D.addEventListener(R,P),D.addEventListener("touchmove",W),()=>{D.removeEventListener(R,P),D.removeEventListener("touchmove",W)}}},[P,a]),r!==!1&&(L[r]=C(r)),q.useEffect(()=>{if(r!==!1){const R=Ok(r),D=Xr(l.current);return D.addEventListener(R,P),()=>{D.removeEventListener(R,P)}}},[P,r]),te.jsx(q.Fragment,{children:q.cloneElement(e,L)})}const pne=(t,e)=>re({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),mne=t=>re({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),gne=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([h,l])=>{var m;r[t.getColorSchemeSelector(h).replace(/\s*&/,"")]={colorScheme:(m=l.palette)==null?void 0:m.mode}});let i=re({html:pne(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:re({margin:0},mne(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const a=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return a&&(i=[i,a]),i};function yne(t){const e=Nn({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return te.jsxs(q.Fragment,{children:[te.jsx(Qz,{styles:i=>gne(i,r)}),n]})}function _ne(t){const e=Xr(t);return e.body===t?xl(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Hp(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function zk(t){return parseInt(xl(t).getComputedStyle(t).paddingRight,10)||0}function vne(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function Dk(t,e,n,r,i){const a=[e,n,...r];[].forEach.call(t.children,h=>{const l=a.indexOf(h)===-1,m=!vne(h);l&&m&&Hp(h,i)})}function r1(t,e){let n=-1;return t.some((r,i)=>e(r)?(n=i,!0):!1),n}function xne(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(_ne(r)){const h=bz(Xr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${zk(r)+h}px`;const l=Xr(r).querySelectorAll(".mui-fixed");[].forEach.call(l,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${zk(m)+h}px`})}let a;if(r.parentNode instanceof DocumentFragment)a=Xr(r).body;else{const h=r.parentElement,l=xl(r);a=(h==null?void 0:h.nodeName)==="HTML"&&l.getComputedStyle(h).overflowY==="scroll"?h:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{n.forEach(({value:a,el:h,property:l})=>{a?h.style.setProperty(l,a):h.style.removeProperty(l)})}}function bne(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class wne{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&Hp(e.modalRef,!1);const i=bne(n);Dk(n,e.mount,e.modalRef,i,!0);const a=r1(this.containers,h=>h.container===n);return a!==-1?(this.containers[a].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:i}),r)}mount(e,n){const r=r1(this.containers,a=>a.modals.indexOf(e)!==-1),i=this.containers[r];i.restore||(i.restore=xne(i,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const i=r1(this.containers,h=>h.modals.indexOf(e)!==-1),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(r,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&Hp(e.modalRef,n),Dk(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const h=a.modals[a.modals.length-1];h.modalRef&&Hp(h.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const Sne=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Tne(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function Ene(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function Pne(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||Ene(t))}function Cne(t){const e=[],n=[];return Array.from(t.querySelectorAll(Sne)).forEach((r,i)=>{const a=Tne(r);a===-1||!Pne(r)||(a===0?e.push(r):n.push({documentOrder:i,tabIndex:a,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(e)}function Ane(){return!0}function Ine(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:a=Cne,isEnabled:h=Ane,open:l}=t,m=q.useRef(!1),_=q.useRef(null),S=q.useRef(null),P=q.useRef(null),C=q.useRef(null),L=q.useRef(!1),R=q.useRef(null),D=jr(kc(e),R),W=q.useRef(null);q.useEffect(()=>{!l||!R.current||(L.current=!n)},[n,l]),q.useEffect(()=>{if(!l||!R.current)return;const F=Xr(R.current);return R.current.contains(F.activeElement)||(R.current.hasAttribute("tabIndex")||R.current.setAttribute("tabIndex","-1"),L.current&&R.current.focus()),()=>{i||(P.current&&P.current.focus&&(m.current=!0,P.current.focus()),P.current=null)}},[l]),q.useEffect(()=>{if(!l||!R.current)return;const F=Xr(R.current),$=se=>{W.current=se,!(r||!h()||se.key!=="Tab")&&F.activeElement===R.current&&se.shiftKey&&(m.current=!0,S.current&&S.current.focus())},K=()=>{const se=R.current;if(se===null)return;if(!F.hasFocus()||!h()||m.current){m.current=!1;return}if(se.contains(F.activeElement)||r&&F.activeElement!==_.current&&F.activeElement!==S.current)return;if(F.activeElement!==C.current)C.current=null;else if(C.current!==null)return;if(!L.current)return;let xe=[];if((F.activeElement===_.current||F.activeElement===S.current)&&(xe=a(R.current)),xe.length>0){var Se,_e;const Re=!!((Se=W.current)!=null&&Se.shiftKey&&((_e=W.current)==null?void 0:_e.key)==="Tab"),De=xe[0],Ve=xe[xe.length-1];typeof De!="string"&&typeof Ve!="string"&&(Re?Ve.focus():De.focus())}else se.focus()};F.addEventListener("focusin",K),F.addEventListener("keydown",$,!0);const ne=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&K()},50);return()=>{clearInterval(ne),F.removeEventListener("focusin",K),F.removeEventListener("keydown",$,!0)}},[n,r,i,h,l,a]);const z=F=>{P.current===null&&(P.current=F.relatedTarget),L.current=!0,C.current=F.target;const $=e.props.onFocus;$&&$(F)},N=F=>{P.current===null&&(P.current=F.relatedTarget),L.current=!0};return te.jsxs(q.Fragment,{children:[te.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:_,"data-testid":"sentinelStart"}),q.cloneElement(e,{ref:D,onFocus:z}),te.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:S,"data-testid":"sentinelEnd"})]})}function kne(t){return typeof t=="function"?t():t}function Mne(t){return t?t.props.hasOwnProperty("in"):!1}const Lne=new wne;function Rne(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=Lne,closeAfterTransition:a=!1,onTransitionEnter:h,onTransitionExited:l,children:m,onClose:_,open:S,rootRef:P}=t,C=q.useRef({}),L=q.useRef(null),R=q.useRef(null),D=jr(R,P),[W,z]=q.useState(!S),N=Mne(m);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const $=()=>Xr(L.current),K=()=>(C.current.modalRef=R.current,C.current.mount=L.current,C.current),ne=()=>{i.mount(K(),{disableScrollLock:r}),R.current&&(R.current.scrollTop=0)},se=zs(()=>{const Ze=kne(e)||$().body;i.add(K(),Ze),R.current&&ne()}),xe=q.useCallback(()=>i.isTopModal(K()),[i]),Se=zs(Ze=>{L.current=Ze,Ze&&(S&&xe()?ne():R.current&&Hp(R.current,F))}),_e=q.useCallback(()=>{i.remove(K(),F)},[F,i]);q.useEffect(()=>()=>{_e()},[_e]),q.useEffect(()=>{S?se():(!N||!a)&&_e()},[S,_e,N,a,se]);const Re=Ze=>Ye=>{var Ce;(Ce=Ze.onKeyDown)==null||Ce.call(Ze,Ye),!(Ye.key!=="Escape"||Ye.which===229||!xe())&&(n||(Ye.stopPropagation(),_&&_(Ye,"escapeKeyDown")))},De=Ze=>Ye=>{var Ce;(Ce=Ze.onClick)==null||Ce.call(Ze,Ye),Ye.target===Ye.currentTarget&&_&&_(Ye,"backdropClick")};return{getRootProps:(Ze={})=>{const Ye=wu(t);delete Ye.onTransitionEnter,delete Ye.onTransitionExited;const Ce=re({},Ye,Ze);return re({role:"presentation"},Ce,{onKeyDown:Re(Ce),ref:D})},getBackdropProps:(Ze={})=>{const Ye=Ze;return re({"aria-hidden":!0},Ye,{onClick:De(Ye),open:S})},getTransitionProps:()=>{const Ze=()=>{z(!1),h&&h()},Ye=()=>{z(!0),l&&l(),a&&_e()};return{onEnter:ZI(Ze,m==null?void 0:m.props.onEnter),onExited:ZI(Ye,m==null?void 0:m.props.onExited)}},rootRef:D,portalRef:Se,isTopModal:xe,exited:W,hasTransition:N}}function One(t){return Fn("MuiModal",t)}In("MuiModal",["root","hidden","backdrop"]);const zne=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Dne=t=>{const{open:e,exited:n,classes:r}=t;return jn({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},One,r)},Fne=_t("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>re({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Nne=_t(tD,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),Bne=q.forwardRef(function(e,n){var r,i,a,h,l,m;const _=Nn({name:"MuiModal",props:e}),{BackdropComponent:S=Nne,BackdropProps:P,className:C,closeAfterTransition:L=!1,children:R,container:D,component:W,components:z={},componentsProps:N={},disableAutoFocus:F=!1,disableEnforceFocus:$=!1,disableEscapeKeyDown:K=!1,disablePortal:ne=!1,disableRestoreFocus:se=!1,disableScrollLock:xe=!1,hideBackdrop:Se=!1,keepMounted:_e=!1,onBackdropClick:Re,open:De,slotProps:Ve,slots:je}=_,We=Gt(_,zne),Ze=re({},_,{closeAfterTransition:L,disableAutoFocus:F,disableEnforceFocus:$,disableEscapeKeyDown:K,disablePortal:ne,disableRestoreFocus:se,disableScrollLock:xe,hideBackdrop:Se,keepMounted:_e}),{getRootProps:Ye,getBackdropProps:Ce,getTransitionProps:Xe,portalRef:lt,isTopModal:Dt,exited:mt,hasTransition:ht}=Rne(re({},Ze,{rootRef:n})),ot=re({},Ze,{exited:mt}),xt=Dne(ot),bt={};if(R.props.tabIndex===void 0&&(bt.tabIndex="-1"),ht){const{onEnter:Ht,onExited:It}=Xe();bt.onEnter=Ht,bt.onExited=It}const Wt=(r=(i=je==null?void 0:je.root)!=null?i:z.Root)!=null?r:Fne,nt=(a=(h=je==null?void 0:je.backdrop)!=null?h:z.Backdrop)!=null?a:S,Et=(l=Ve==null?void 0:Ve.root)!=null?l:N.root,cn=(m=Ve==null?void 0:Ve.backdrop)!=null?m:N.backdrop,en=is({elementType:Wt,externalSlotProps:Et,externalForwardedProps:We,getSlotProps:Ye,additionalProps:{ref:n,as:W},ownerState:ot,className:Qt(C,Et==null?void 0:Et.className,xt==null?void 0:xt.root,!ot.open&&ot.exited&&(xt==null?void 0:xt.hidden))}),mn=is({elementType:nt,externalSlotProps:cn,additionalProps:P,getSlotProps:Ht=>Ce(re({},Ht,{onClick:It=>{Re&&Re(It),Ht!=null&&Ht.onClick&&Ht.onClick(It)}})),className:Qt(cn==null?void 0:cn.className,P==null?void 0:P.className,xt==null?void 0:xt.backdrop),ownerState:ot});return!_e&&!De&&(!ht||mt)?null:te.jsx(Kz,{ref:lt,container:D,disablePortal:ne,children:te.jsxs(Wt,re({},en,{children:[!Se&&S?te.jsx(nt,re({},mn)):null,te.jsx(Ine,{disableEnforceFocus:$,disableAutoFocus:F,disableRestoreFocus:se,isEnabled:Dt,open:De,children:q.cloneElement(R,bt)})]}))})}),rD=Bne,jne=In("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Fk=jne,Vne=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Une(t,e,n){const r=e.getBoundingClientRect(),i=n&&n.getBoundingClientRect(),a=xl(e);let h;if(e.fakeTransform)h=e.fakeTransform;else{const _=a.getComputedStyle(e);h=_.getPropertyValue("-webkit-transform")||_.getPropertyValue("transform")}let l=0,m=0;if(h&&h!=="none"&&typeof h=="string"){const _=h.split("(")[1].split(")")[0].split(",");l=parseInt(_[4],10),m=parseInt(_[5],10)}return t==="left"?i?`translateX(${i.right+l-r.left}px)`:`translateX(${a.innerWidth+l-r.left}px)`:t==="right"?i?`translateX(-${r.right-i.left-l}px)`:`translateX(-${r.left+r.width-l}px)`:t==="up"?i?`translateY(${i.bottom+m-r.top}px)`:`translateY(${a.innerHeight+m-r.top}px)`:i?`translateY(-${r.top-i.top+r.height-m}px)`:`translateY(-${r.top+r.height-m}px)`}function $ne(t){return typeof t=="function"?t():t}function Hy(t,e,n){const r=$ne(n),i=Une(t,e,r);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Gne=q.forwardRef(function(e,n){const r=Yd(),i={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},a={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:h,appear:l=!0,children:m,container:_,direction:S="down",easing:P=i,in:C,onEnter:L,onEntered:R,onEntering:D,onExit:W,onExited:z,onExiting:N,style:F,timeout:$=a,TransitionComponent:K=cT}=e,ne=Gt(e,Vne),se=q.useRef(null),xe=jr(kc(m),se,n),Se=Ce=>Xe=>{Ce&&(Xe===void 0?Ce(se.current):Ce(se.current,Xe))},_e=Se((Ce,Xe)=>{Hy(S,Ce,_),dT(Ce),L&&L(Ce,Xe)}),Re=Se((Ce,Xe)=>{const lt=Fd({timeout:$,style:F,easing:P},{mode:"enter"});Ce.style.webkitTransition=r.transitions.create("-webkit-transform",re({},lt)),Ce.style.transition=r.transitions.create("transform",re({},lt)),Ce.style.webkitTransform="none",Ce.style.transform="none",D&&D(Ce,Xe)}),De=Se(R),Ve=Se(N),je=Se(Ce=>{const Xe=Fd({timeout:$,style:F,easing:P},{mode:"exit"});Ce.style.webkitTransition=r.transitions.create("-webkit-transform",Xe),Ce.style.transition=r.transitions.create("transform",Xe),Hy(S,Ce,_),W&&W(Ce)}),We=Se(Ce=>{Ce.style.webkitTransition="",Ce.style.transition="",z&&z(Ce)}),Ze=Ce=>{h&&h(se.current,Ce)},Ye=q.useCallback(()=>{se.current&&Hy(S,se.current,_)},[S,_]);return q.useEffect(()=>{if(C||S==="down"||S==="right")return;const Ce=tT(()=>{se.current&&Hy(S,se.current,_)}),Xe=xl(se.current);return Xe.addEventListener("resize",Ce),()=>{Ce.clear(),Xe.removeEventListener("resize",Ce)}},[S,C,_]),q.useEffect(()=>{C||Ye()},[C,Ye]),te.jsx(K,re({nodeRef:se,onEnter:_e,onEntered:De,onEntering:Re,onExit:je,onExited:We,onExiting:Ve,addEndListener:Ze,appear:l,in:C,timeout:$},ne,{children:(Ce,Xe)=>q.cloneElement(m,re({ref:xe,style:re({visibility:Ce==="exited"&&!C?"hidden":void 0},F,m.props.style)},Xe))}))}),Wne=Gne;function Hne(t){return Fn("MuiDrawer",t)}In("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const qne=["BackdropProps"],Zne=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],iD=(t,e)=>{const{ownerState:n}=t;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},Xne=t=>{const{classes:e,anchor:n,variant:r}=t,i={root:["root"],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${$t(n)}`,r!=="temporary"&&`paperAnchorDocked${$t(n)}`]};return jn(i,Hne,e)},Yne=_t(rD,{name:"MuiDrawer",slot:"Root",overridesResolver:iD})(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer})),Nk=_t("div",{shouldForwardProp:fo,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:iD})({flex:"0 0 auto"}),Kne=_t(kv,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`paperAnchor${$t(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${$t(n.anchor)}`]]}})(({theme:t,ownerState:e})=>re({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},e.anchor==="left"&&{left:0},e.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="right"&&{right:0},e.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="left"&&e.variant!=="temporary"&&{borderRight:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="top"&&e.variant!=="temporary"&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="right"&&e.variant!=="temporary"&&{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="bottom"&&e.variant!=="temporary"&&{borderTop:`1px solid ${(t.vars||t).palette.divider}`})),sD={left:"right",right:"left",top:"down",bottom:"up"};function Jne(t){return["left","right"].indexOf(t)!==-1}function Qne({direction:t},e){return t==="rtl"&&Jne(e)?sD[e]:e}const ere=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiDrawer"}),i=Yd(),a=Av(),h={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:l="left",BackdropProps:m,children:_,className:S,elevation:P=16,hideBackdrop:C=!1,ModalProps:{BackdropProps:L}={},onClose:R,open:D=!1,PaperProps:W={},SlideProps:z,TransitionComponent:N=Wne,transitionDuration:F=h,variant:$="temporary"}=r,K=Gt(r.ModalProps,qne),ne=Gt(r,Zne),se=q.useRef(!1);q.useEffect(()=>{se.current=!0},[]);const xe=Qne({direction:a?"rtl":"ltr"},l),_e=re({},r,{anchor:l,elevation:P,open:D,variant:$},ne),Re=Xne(_e),De=te.jsx(Kne,re({elevation:$==="temporary"?P:0,square:!0},W,{className:Qt(Re.paper,W.className),ownerState:_e,children:_}));if($==="permanent")return te.jsx(Nk,re({className:Qt(Re.root,Re.docked,S),ownerState:_e,ref:n},ne,{children:De}));const Ve=te.jsx(N,re({in:D,direction:sD[xe],timeout:F,appear:se.current},z,{children:De}));return $==="persistent"?te.jsx(Nk,re({className:Qt(Re.root,Re.docked,S),ownerState:_e,ref:n},ne,{children:Ve})):te.jsx(Yne,re({BackdropProps:re({},m,L,{transitionDuration:F}),className:Qt(Re.root,Re.modal,S),open:D,ownerState:_e,onClose:R,hideBackdrop:C,ref:n},ne,K,{children:Ve}))}),tre=ere,nre=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],rre=t=>{const{classes:e,disableUnderline:n}=t,i=jn({root:["root",!n&&"underline"],input:["input"]},Ite,e);return re({},e,i)},ire=_t(Dv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Ov(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",i=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",h=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return re({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:h,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${ru.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${ru.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${ru.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${ru.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${ru.disabled}, .${ru.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${ru.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&re({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),sre=_t(Fv,{name:"MuiFilledInput",slot:"Input",overridesResolver:zv})(({theme:t,ownerState:e})=>re({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),oD=q.forwardRef(function(e,n){var r,i,a,h;const l=Nn({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:_,fullWidth:S=!1,inputComponent:P="input",multiline:C=!1,slotProps:L,slots:R={},type:D="text"}=l,W=Gt(l,nre),z=re({},l,{fullWidth:S,inputComponent:P,multiline:C,type:D}),N=rre(l),F={root:{ownerState:z},input:{ownerState:z}},$=L??_?oo(F,L??_):F,K=(r=(i=R.root)!=null?i:m.Root)!=null?r:ire,ne=(a=(h=R.input)!=null?h:m.Input)!=null?a:sre;return te.jsx(wT,re({slots:{root:K,input:ne},componentsProps:$,fullWidth:S,inputComponent:P,multiline:C,ref:n,type:D},W,{classes:N}))});oD.muiName="Input";const aD=oD;function ore(t){return Fn("MuiFormControl",t)}In("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const are=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],lre=t=>{const{classes:e,margin:n,fullWidth:r}=t,i={root:["root",n!=="none"&&`margin${$t(n)}`,r&&"fullWidth"]};return jn(i,ore,e)},cre=_t("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>re({},e.root,e[`margin${$t(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>re({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),ure=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiFormControl"}),{children:i,className:a,color:h="primary",component:l="div",disabled:m=!1,error:_=!1,focused:S,fullWidth:P=!1,hiddenLabel:C=!1,margin:L="none",required:R=!1,size:D="medium",variant:W="outlined"}=r,z=Gt(r,are),N=re({},r,{color:h,component:l,disabled:m,error:_,fullWidth:P,hiddenLabel:C,margin:L,required:R,size:D,variant:W}),F=lre(N),[$,K]=q.useState(()=>{let Ve=!1;return i&&q.Children.forEach(i,je=>{if(!Jb(je,["Input","Select"]))return;const We=Jb(je,["Select"])?je.props.input:je;We&&_te(We.props)&&(Ve=!0)}),Ve}),[ne,se]=q.useState(()=>{let Ve=!1;return i&&q.Children.forEach(i,je=>{Jb(je,["Input","Select"])&&(v_(je.props,!0)||v_(je.props.inputProps,!0))&&(Ve=!0)}),Ve}),[xe,Se]=q.useState(!1);m&&xe&&Se(!1);const _e=S!==void 0&&!m?S:xe;let Re;const De=q.useMemo(()=>({adornedStart:$,setAdornedStart:K,color:h,disabled:m,error:_,filled:ne,focused:_e,fullWidth:P,hiddenLabel:C,size:D,onBlur:()=>{Se(!1)},onEmpty:()=>{se(!1)},onFilled:()=>{se(!0)},onFocus:()=>{Se(!0)},registerEffect:Re,required:R,variant:W}),[$,h,m,_,ne,_e,P,C,Re,R,D,W]);return te.jsx(Rv.Provider,{value:De,children:te.jsx(cre,re({as:l,ownerState:N,className:Qt(F.root,a),ref:n},z,{children:i}))})}),lD=ure;function hre(t){return Fn("MuiFormHelperText",t)}const dre=In("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),Bk=dre;var jk;const fre=["children","className","component","disabled","error","filled","focused","margin","required","variant"],pre=t=>{const{classes:e,contained:n,size:r,disabled:i,error:a,filled:h,focused:l,required:m}=t,_={root:["root",i&&"disabled",a&&"error",r&&`size${$t(r)}`,n&&"contained",l&&"focused",h&&"filled",m&&"required"]};return jn(_,hre,e)},mre=_t("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${$t(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>re({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${Bk.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Bk.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),gre=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:h="p"}=r,l=Gt(r,fre),m=ju(),_=Jd({props:r,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),S=re({},r,{component:h,contained:_.variant==="filled"||_.variant==="outlined",variant:_.variant,size:_.size,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),P=pre(S);return te.jsx(mre,re({as:h,ownerState:S,className:Qt(P.root,a),ref:n},l,{children:i===" "?jk||(jk=te.jsx("span",{className:"notranslate",children:""})):i}))}),yre=gre;function _re(t){return Fn("MuiFormLabel",t)}const vre=In("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),qp=vre,xre=["children","className","color","component","disabled","error","filled","focused","required"],bre=t=>{const{classes:e,color:n,focused:r,disabled:i,error:a,filled:h,required:l}=t,m={root:["root",`color${$t(n)}`,i&&"disabled",a&&"error",h&&"filled",r&&"focused",l&&"required"],asterisk:["asterisk",a&&"error"]};return jn(m,_re,e)},wre=_t("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>re({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>re({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${qp.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${qp.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${qp.error}`]:{color:(t.vars||t).palette.error.main}})),Sre=_t("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${qp.error}`]:{color:(t.vars||t).palette.error.main}})),Tre=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiFormLabel"}),{children:i,className:a,component:h="label"}=r,l=Gt(r,xre),m=ju(),_=Jd({props:r,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),S=re({},r,{color:_.color||"primary",component:h,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),P=bre(S);return te.jsxs(wre,re({as:h,ownerState:S,className:Qt(P.root,a),ref:n},l,{children:[i,_.required&&te.jsxs(Sre,{ownerState:S,"aria-hidden":!0,className:P.asterisk,children:["","*"]})]}))}),Ere=Tre,Pre=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function iS(t){return`scale(${t}, ${t**2})`}const Cre={entering:{opacity:1,transform:iS(1)},entered:{opacity:1,transform:"none"}},i1=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),cD=q.forwardRef(function(e,n){const{addEndListener:r,appear:i=!0,children:a,easing:h,in:l,onEnter:m,onEntered:_,onEntering:S,onExit:P,onExited:C,onExiting:L,style:R,timeout:D="auto",TransitionComponent:W=cT}=e,z=Gt(e,Pre),N=gu(),F=q.useRef(),$=Yd(),K=q.useRef(null),ne=jr(K,kc(a),n),se=We=>Ze=>{if(We){const Ye=K.current;Ze===void 0?We(Ye):We(Ye,Ze)}},xe=se(S),Se=se((We,Ze)=>{dT(We);const{duration:Ye,delay:Ce,easing:Xe}=Fd({style:R,timeout:D,easing:h},{mode:"enter"});let lt;D==="auto"?(lt=$.transitions.getAutoHeightDuration(We.clientHeight),F.current=lt):lt=Ye,We.style.transition=[$.transitions.create("opacity",{duration:lt,delay:Ce}),$.transitions.create("transform",{duration:i1?lt:lt*.666,delay:Ce,easing:Xe})].join(","),m&&m(We,Ze)}),_e=se(_),Re=se(L),De=se(We=>{const{duration:Ze,delay:Ye,easing:Ce}=Fd({style:R,timeout:D,easing:h},{mode:"exit"});let Xe;D==="auto"?(Xe=$.transitions.getAutoHeightDuration(We.clientHeight),F.current=Xe):Xe=Ze,We.style.transition=[$.transitions.create("opacity",{duration:Xe,delay:Ye}),$.transitions.create("transform",{duration:i1?Xe:Xe*.666,delay:i1?Ye:Ye||Xe*.333,easing:Ce})].join(","),We.style.opacity=0,We.style.transform=iS(.75),P&&P(We)}),Ve=se(C),je=We=>{D==="auto"&&N.start(F.current||0,We),r&&r(K.current,We)};return te.jsx(W,re({appear:i,in:l,nodeRef:K,onEnter:Se,onEntered:_e,onEntering:xe,onExit:De,onExited:Ve,onExiting:Re,addEndListener:je,timeout:D==="auto"?null:D},z,{children:(We,Ze)=>q.cloneElement(a,re({style:re({opacity:0,transform:iS(.75),visibility:We==="exited"&&!l?"hidden":void 0},Cre[We],R,a.props.style),ref:ne},Ze))}))});cD.muiSupportAuto=!0;const x_=cD,Are=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Ire=t=>{const{classes:e,disableUnderline:n}=t,i=jn({root:["root",!n&&"underline"],input:["input"]},Ete,e);return re({},e,i)},kre=_t(Dv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Ov(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),re({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${yp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${yp.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${yp.disabled}, .${yp.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${yp.disabled}:before`]:{borderBottomStyle:"dotted"}})}),Mre=_t(Fv,{name:"MuiInput",slot:"Input",overridesResolver:zv})({}),uD=q.forwardRef(function(e,n){var r,i,a,h;const l=Nn({props:e,name:"MuiInput"}),{disableUnderline:m,components:_={},componentsProps:S,fullWidth:P=!1,inputComponent:C="input",multiline:L=!1,slotProps:R,slots:D={},type:W="text"}=l,z=Gt(l,Are),N=Ire(l),$={root:{ownerState:{disableUnderline:m}}},K=R??S?oo(R??S,$):$,ne=(r=(i=D.root)!=null?i:_.Root)!=null?r:kre,se=(a=(h=D.input)!=null?h:_.Input)!=null?a:Mre;return te.jsx(wT,re({slots:{root:ne,input:se},slotProps:K,fullWidth:P,inputComponent:C,multiline:L,ref:n,type:W},z,{classes:N}))});uD.muiName="Input";const hD=uD;function Lre(t){return Fn("MuiInputAdornment",t)}const Rre=In("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),Vk=Rre;var Uk;const Ore=["children","className","component","disablePointerEvents","disableTypography","position","variant"],zre=(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${$t(n.position)}`],n.disablePointerEvents===!0&&e.disablePointerEvents,e[n.variant]]},Dre=t=>{const{classes:e,disablePointerEvents:n,hiddenLabel:r,position:i,size:a,variant:h}=t,l={root:["root",n&&"disablePointerEvents",i&&`position${$t(i)}`,h,r&&"hiddenLabel",a&&`size${$t(a)}`]};return jn(l,Lre,e)},Fre=_t("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:zre})(({theme:t,ownerState:e})=>re({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},e.variant==="filled"&&{[`&.${Vk.positionStart}&:not(.${Vk.hiddenLabel})`]:{marginTop:16}},e.position==="start"&&{marginRight:8},e.position==="end"&&{marginLeft:8},e.disablePointerEvents===!0&&{pointerEvents:"none"})),Nre=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiInputAdornment"}),{children:i,className:a,component:h="div",disablePointerEvents:l=!1,disableTypography:m=!1,position:_,variant:S}=r,P=Gt(r,Ore),C=ju()||{};let L=S;S&&C.variant,C&&!L&&(L=C.variant);const R=re({},r,{hiddenLabel:C.hiddenLabel,size:C.size,disablePointerEvents:l,position:_,variant:L}),D=Dre(R);return te.jsx(Rv.Provider,{value:null,children:te.jsx(Fre,re({as:h,ownerState:R,className:Qt(D.root,a),ref:n},P,{children:typeof i=="string"&&!m?te.jsx(xs,{color:"text.secondary",children:i}):te.jsxs(q.Fragment,{children:[_==="start"?Uk||(Uk=te.jsx("span",{className:"notranslate",children:""})):null,i]})}))})}),Bre=Nre;function jre(t){return Fn("MuiInputLabel",t)}In("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Vre=["disableAnimation","margin","shrink","variant","className"],Ure=t=>{const{classes:e,formControl:n,size:r,shrink:i,disableAnimation:a,variant:h,required:l}=t,m={root:["root",n&&"formControl",!a&&"animated",i&&"shrink",r&&r!=="normal"&&`size${$t(r)}`,h],asterisk:[l&&"asterisk"]},_=jn(m,jre,e);return re({},e,_)},$re=_t(Ere,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${qp.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>re({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&re({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&re({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&re({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Gre=q.forwardRef(function(e,n){const r=Nn({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:a,className:h}=r,l=Gt(r,Vre),m=ju();let _=a;typeof _>"u"&&m&&(_=m.filled||m.focused||m.adornedStart);const S=Jd({props:r,muiFormControl:m,states:["size","variant","required","focused"]}),P=re({},r,{disableAnimation:i,formControl:m,shrink:_,size:S.size,variant:S.variant,required:S.required,focused:S.focused}),C=Ure(P);return te.jsx($re,re({"data-shrink":_,ownerState:P,ref:n,className:Qt(C.root,h)},l,{classes:C}))}),dD=Gre,Wre=q.createContext({}),sS=Wre;function Hre(t){return Fn("MuiList",t)}In("MuiList",["root","padding","dense","subheader"]);const qre=["children","className","component","dense","disablePadding","subheader"],Zre=t=>{const{classes:e,disablePadding:n,dense:r,subheader:i}=t;return jn({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},Hre,e)},Xre=_t("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>re({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),Yre=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiList"}),{children:i,className:a,component:h="ul",dense:l=!1,disablePadding:m=!1,subheader:_}=r,S=Gt(r,qre),P=q.useMemo(()=>({dense:l}),[l]),C=re({},r,{component:h,dense:l,disablePadding:m}),L=Zre(C);return te.jsx(sS.Provider,{value:P,children:te.jsxs(Xre,re({as:h,className:Qt(L.root,a),ref:n,ownerState:C},S,{children:[_,i]}))})}),Kre=Yre,Jre=In("MuiListItemIcon",["root","alignItemsFlexStart"]),$k=Jre,Qre=In("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Gk=Qre,eie=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function s1(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function Wk(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function fD(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function _p(t,e,n,r,i,a){let h=!1,l=i(t,e,e?n:!1);for(;l;){if(l===t.firstChild){if(h)return!1;h=!0}const m=r?!1:l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||!fD(l,a)||m)l=i(t,l,n);else return l.focus(),!0}return!1}const tie=q.forwardRef(function(e,n){const{actions:r,autoFocus:i=!1,autoFocusItem:a=!1,children:h,className:l,disabledItemsFocusable:m=!1,disableListWrap:_=!1,onKeyDown:S,variant:P="selectedMenu"}=e,C=Gt(e,eie),L=q.useRef(null),R=q.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});fa(()=>{i&&L.current.focus()},[i]),q.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(F,{direction:$})=>{const K=!L.current.style.width;if(F.clientHeight<L.current.clientHeight&&K){const ne=`${bz(Xr(F))}px`;L.current.style[$==="rtl"?"paddingLeft":"paddingRight"]=ne,L.current.style.width=`calc(100% + ${ne})`}return L.current}}),[]);const D=F=>{const $=L.current,K=F.key,ne=Xr($).activeElement;if(K==="ArrowDown")F.preventDefault(),_p($,ne,_,m,s1);else if(K==="ArrowUp")F.preventDefault(),_p($,ne,_,m,Wk);else if(K==="Home")F.preventDefault(),_p($,null,_,m,s1);else if(K==="End")F.preventDefault(),_p($,null,_,m,Wk);else if(K.length===1){const se=R.current,xe=K.toLowerCase(),Se=performance.now();se.keys.length>0&&(Se-se.lastTime>500?(se.keys=[],se.repeating=!0,se.previousKeyMatched=!0):se.repeating&&xe!==se.keys[0]&&(se.repeating=!1)),se.lastTime=Se,se.keys.push(xe);const _e=ne&&!se.repeating&&fD(ne,se);se.previousKeyMatched&&(_e||_p($,ne,!1,m,s1,se))?F.preventDefault():se.previousKeyMatched=!1}S&&S(F)},W=jr(L,n);let z=-1;q.Children.forEach(h,(F,$)=>{if(!q.isValidElement(F)){z===$&&(z+=1,z>=h.length&&(z=-1));return}F.props.disabled||(P==="selectedMenu"&&F.props.selected||z===-1)&&(z=$),z===$&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(z+=1,z>=h.length&&(z=-1))});const N=q.Children.map(h,(F,$)=>{if($===z){const K={};return a&&(K.autoFocus=!0),F.props.tabIndex===void 0&&P==="selectedMenu"&&(K.tabIndex=0),q.cloneElement(F,K)}return F});return te.jsx(Kre,re({role:"menu",ref:W,className:l,onKeyDown:D,tabIndex:i?0:-1},C,{children:N}))}),nie=tie;function rie(t){return Fn("MuiPopover",t)}In("MuiPopover",["root","paper"]);const iie=["onEntering"],sie=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],oie=["slotProps"];function Hk(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function qk(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function Zk(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function o1(t){return typeof t=="function"?t():t}const aie=t=>{const{classes:e}=t;return jn({root:["root"],paper:["paper"]},rie,e)},lie=_t(rD,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),pD=_t(kv,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),cie=q.forwardRef(function(e,n){var r,i,a;const h=Nn({props:e,name:"MuiPopover"}),{action:l,anchorEl:m,anchorOrigin:_={vertical:"top",horizontal:"left"},anchorPosition:S,anchorReference:P="anchorEl",children:C,className:L,container:R,elevation:D=8,marginThreshold:W=16,open:z,PaperProps:N={},slots:F,slotProps:$,transformOrigin:K={vertical:"top",horizontal:"left"},TransitionComponent:ne=x_,transitionDuration:se="auto",TransitionProps:{onEntering:xe}={},disableScrollLock:Se=!1}=h,_e=Gt(h.TransitionProps,iie),Re=Gt(h,sie),De=(r=$==null?void 0:$.paper)!=null?r:N,Ve=q.useRef(),je=jr(Ve,De.ref),We=re({},h,{anchorOrigin:_,anchorReference:P,elevation:D,marginThreshold:W,externalPaperSlotProps:De,transformOrigin:K,TransitionComponent:ne,transitionDuration:se,TransitionProps:_e}),Ze=aie(We),Ye=q.useCallback(()=>{if(P==="anchorPosition")return S;const Ht=o1(m),Rt=(Ht&&Ht.nodeType===1?Ht:Xr(Ve.current).body).getBoundingClientRect();return{top:Rt.top+Hk(Rt,_.vertical),left:Rt.left+qk(Rt,_.horizontal)}},[m,_.horizontal,_.vertical,S,P]),Ce=q.useCallback(Ht=>({vertical:Hk(Ht,K.vertical),horizontal:qk(Ht,K.horizontal)}),[K.horizontal,K.vertical]),Xe=q.useCallback(Ht=>{const It={width:Ht.offsetWidth,height:Ht.offsetHeight},Rt=Ce(It);if(P==="none")return{top:null,left:null,transformOrigin:Zk(Rt)};const yn=Ye();let vn=yn.top-Rt.vertical,ut=yn.left-Rt.horizontal;const un=vn+It.height,Ae=ut+It.width,Ct=xl(o1(m)),bn=Ct.innerHeight-W,Yt=Ct.innerWidth-W;if(W!==null&&vn<W){const kt=vn-W;vn-=kt,Rt.vertical+=kt}else if(W!==null&&un>bn){const kt=un-bn;vn-=kt,Rt.vertical+=kt}if(W!==null&&ut<W){const kt=ut-W;ut-=kt,Rt.horizontal+=kt}else if(Ae>Yt){const kt=Ae-Yt;ut-=kt,Rt.horizontal+=kt}return{top:`${Math.round(vn)}px`,left:`${Math.round(ut)}px`,transformOrigin:Zk(Rt)}},[m,P,Ye,Ce,W]),[lt,Dt]=q.useState(z),mt=q.useCallback(()=>{const Ht=Ve.current;if(!Ht)return;const It=Xe(Ht);It.top!==null&&(Ht.style.top=It.top),It.left!==null&&(Ht.style.left=It.left),Ht.style.transformOrigin=It.transformOrigin,Dt(!0)},[Xe]);q.useEffect(()=>(Se&&window.addEventListener("scroll",mt),()=>window.removeEventListener("scroll",mt)),[m,Se,mt]);const ht=(Ht,It)=>{xe&&xe(Ht,It),mt()},ot=()=>{Dt(!1)};q.useEffect(()=>{z&&mt()}),q.useImperativeHandle(l,()=>z?{updatePosition:()=>{mt()}}:null,[z,mt]),q.useEffect(()=>{if(!z)return;const Ht=tT(()=>{mt()}),It=xl(m);return It.addEventListener("resize",Ht),()=>{Ht.clear(),It.removeEventListener("resize",Ht)}},[m,z,mt]);let xt=se;se==="auto"&&!ne.muiSupportAuto&&(xt=void 0);const bt=R||(m?Xr(o1(m)).body:void 0),Wt=(i=F==null?void 0:F.root)!=null?i:lie,nt=(a=F==null?void 0:F.paper)!=null?a:pD,Et=is({elementType:nt,externalSlotProps:re({},De,{style:lt?De.style:re({},De.style,{opacity:0})}),additionalProps:{elevation:D,ref:je},ownerState:We,className:Qt(Ze.paper,De==null?void 0:De.className)}),cn=is({elementType:Wt,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:Re,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:bt,open:z},ownerState:We,className:Qt(Ze.root,L)}),{slotProps:en}=cn,mn=Gt(cn,oie);return te.jsx(Wt,re({},mn,!wc(Wt)&&{slotProps:en,disableScrollLock:Se},{children:te.jsx(ne,re({appear:!0,in:z,onEntering:ht,onExited:ot,timeout:xt},_e,{children:te.jsx(nt,re({},Et,{children:C}))}))}))}),mD=cie;function uie(t){return Fn("MuiMenu",t)}In("MuiMenu",["root","paper","list"]);const hie=["onEntering"],die=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],fie={vertical:"top",horizontal:"right"},pie={vertical:"top",horizontal:"left"},mie=t=>{const{classes:e}=t;return jn({root:["root"],paper:["paper"],list:["list"]},uie,e)},gie=_t(mD,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),yie=_t(pD,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),_ie=_t(nie,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),vie=q.forwardRef(function(e,n){var r,i;const a=Nn({props:e,name:"MuiMenu"}),{autoFocus:h=!0,children:l,className:m,disableAutoFocusItem:_=!1,MenuListProps:S={},onClose:P,open:C,PaperProps:L={},PopoverClasses:R,transitionDuration:D="auto",TransitionProps:{onEntering:W}={},variant:z="selectedMenu",slots:N={},slotProps:F={}}=a,$=Gt(a.TransitionProps,hie),K=Gt(a,die),ne=Av(),se=re({},a,{autoFocus:h,disableAutoFocusItem:_,MenuListProps:S,onEntering:W,PaperProps:L,transitionDuration:D,TransitionProps:$,variant:z}),xe=mie(se),Se=h&&!_&&C,_e=q.useRef(null),Re=(Ce,Xe)=>{_e.current&&_e.current.adjustStyleForScrollbar(Ce,{direction:ne?"rtl":"ltr"}),W&&W(Ce,Xe)},De=Ce=>{Ce.key==="Tab"&&(Ce.preventDefault(),P&&P(Ce,"tabKeyDown"))};let Ve=-1;q.Children.map(l,(Ce,Xe)=>{q.isValidElement(Ce)&&(Ce.props.disabled||(z==="selectedMenu"&&Ce.props.selected||Ve===-1)&&(Ve=Xe))});const je=(r=N.paper)!=null?r:yie,We=(i=F.paper)!=null?i:L,Ze=is({elementType:N.root,externalSlotProps:F.root,ownerState:se,className:[xe.root,m]}),Ye=is({elementType:je,externalSlotProps:We,ownerState:se,className:xe.paper});return te.jsx(gie,re({onClose:P,anchorOrigin:{vertical:"bottom",horizontal:ne?"right":"left"},transformOrigin:ne?fie:pie,slots:{paper:je,root:N.root},slotProps:{root:Ze,paper:Ye},open:C,ref:n,transitionDuration:D,TransitionProps:re({onEntering:Re},$),ownerState:se},K,{classes:R,children:te.jsx(_ie,re({onKeyDown:De,actions:_e,autoFocus:h&&(Ve===-1||_),autoFocusItem:Se,variant:z},S,{className:Qt(xe.list,S.className),children:l}))}))}),gD=vie;function xie(t){return Fn("MuiMenuItem",t)}const bie=In("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),vp=bie,wie=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Sie=(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]},Tie=t=>{const{disabled:e,dense:n,divider:r,disableGutters:i,selected:a,classes:h}=t,m=jn({root:["root",n&&"dense",e&&"disabled",!i&&"gutters",r&&"divider",a&&"selected"]},xie,h);return re({},h,m)},Eie=_t(fT,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Sie})(({theme:t,ownerState:e})=>re({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${vp.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:as(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${vp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:as(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${vp.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:as(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:as(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${vp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${vp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${Fk.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${Fk.inset}`]:{marginLeft:52},[`& .${Gk.root}`]:{marginTop:0,marginBottom:0},[`& .${Gk.inset}`]:{paddingLeft:36},[`& .${$k.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&re({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${$k.root} svg`]:{fontSize:"1.25rem"}}))),Pie=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:h=!1,divider:l=!1,disableGutters:m=!1,focusVisibleClassName:_,role:S="menuitem",tabIndex:P,className:C}=r,L=Gt(r,wie),R=q.useContext(sS),D=q.useMemo(()=>({dense:h||R.dense||!1,disableGutters:m}),[R.dense,h,m]),W=q.useRef(null);fa(()=>{i&&W.current&&W.current.focus()},[i]);const z=re({},r,{dense:D.dense,divider:l,disableGutters:m}),N=Tie(r),F=jr(W,n);let $;return r.disabled||($=P!==void 0?P:-1),te.jsx(sS.Provider,{value:D,children:te.jsx(Eie,re({ref:F,role:S,tabIndex:$,component:a,focusVisibleClassName:Qt(N.focusVisible,_),className:Qt(N.root,C)},L,{ownerState:z,classes:N}))})}),xp=Pie;function Cie(t){return Fn("MuiNativeSelect",t)}const Aie=In("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),ST=Aie,Iie=["className","disabled","error","IconComponent","inputRef","variant"],kie=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${$t(n)}`,a&&"iconOpen",r&&"disabled"]};return jn(l,Cie,e)},yD=({ownerState:t,theme:e})=>re({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":re({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${ST.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Mie=_t("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:fo,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${ST.multiple}`]:e.multiple}]}})(yD),_D=({ownerState:t,theme:e})=>re({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${ST.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),Lie=_t("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${$t(n.variant)}`],n.open&&e.iconOpen]}})(_D),Rie=q.forwardRef(function(e,n){const{className:r,disabled:i,error:a,IconComponent:h,inputRef:l,variant:m="standard"}=e,_=Gt(e,Iie),S=re({},e,{disabled:i,variant:m,error:a}),P=kie(S);return te.jsxs(q.Fragment,{children:[te.jsx(Mie,re({ownerState:S,className:Qt(P.select,r),disabled:i,ref:l||n},_)),e.multiple?null:te.jsx(Lie,{as:h,ownerState:S,className:P.icon})]})}),Oie=Rie;var Xk;const zie=["children","classes","className","label","notched"],Die=_t("fieldset",{shouldForwardProp:fo})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Fie=_t("legend",{shouldForwardProp:fo})(({ownerState:t,theme:e})=>re({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&re({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function Nie(t){const{className:e,label:n,notched:r}=t,i=Gt(t,zie),a=n!=null&&n!=="",h=re({},t,{notched:r,withLabel:a});return te.jsx(Die,re({"aria-hidden":!0,className:e,ownerState:h},i,{children:te.jsx(Fie,{ownerState:h,children:a?te.jsx("span",{children:n}):Xk||(Xk=te.jsx("span",{className:"notranslate",children:""}))})}))}const Bie=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],jie=t=>{const{classes:e}=t,r=jn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Cte,e);return re({},e,r)},Vie=_t(Dv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Ov})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return re({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Kl.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Kl.focused} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Kl.error} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Kl.disabled} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&re({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Uie=_t(Nie,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),$ie=_t(Fv,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:zv})(({theme:t,ownerState:e})=>re({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),vD=q.forwardRef(function(e,n){var r,i,a,h,l;const m=Nn({props:e,name:"MuiOutlinedInput"}),{components:_={},fullWidth:S=!1,inputComponent:P="input",label:C,multiline:L=!1,notched:R,slots:D={},type:W="text"}=m,z=Gt(m,Bie),N=jie(m),F=ju(),$=Jd({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),K=re({},m,{color:$.color||"primary",disabled:$.disabled,error:$.error,focused:$.focused,formControl:F,fullWidth:S,hiddenLabel:$.hiddenLabel,multiline:L,size:$.size,type:W}),ne=(r=(i=D.root)!=null?i:_.Root)!=null?r:Vie,se=(a=(h=D.input)!=null?h:_.Input)!=null?a:$ie;return te.jsx(wT,re({slots:{root:ne,input:se},renderSuffix:xe=>te.jsx(Uie,{ownerState:K,className:N.notchedOutline,label:C!=null&&C!==""&&$.required?l||(l=te.jsxs(q.Fragment,{children:[C,"","*"]})):C,notched:typeof R<"u"?R:!!(xe.startAdornment||xe.filled||xe.focused)}),fullWidth:S,inputComponent:P,multiline:L,ref:n,type:W},z,{classes:re({},N,{notchedOutline:null})}))});vD.muiName="Input";const xD=vD;function Gie(t){return Fn("MuiSelect",t)}const Wie=In("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),bp=Wie;var Yk;const Hie=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],qie=_t("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${bp.select}`]:e.select},{[`&.${bp.select}`]:e[n.variant]},{[`&.${bp.error}`]:e.error},{[`&.${bp.multiple}`]:e.multiple}]}})(yD,{[`&.${bp.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Zie=_t("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${$t(n.variant)}`],n.open&&e.iconOpen]}})(_D),Xie=_t("input",{shouldForwardProp:t=>Iv(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Kk(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Yie(t){return t==null||typeof t=="string"&&!t.trim()}const Kie=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${$t(n)}`,a&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return jn(l,Gie,e)},Jie=q.forwardRef(function(e,n){var r;const{"aria-describedby":i,"aria-label":a,autoFocus:h,autoWidth:l,children:m,className:_,defaultOpen:S,defaultValue:P,disabled:C,displayEmpty:L,error:R=!1,IconComponent:D,inputRef:W,labelId:z,MenuProps:N={},multiple:F,name:$,onBlur:K,onChange:ne,onClose:se,onFocus:xe,onOpen:Se,open:_e,readOnly:Re,renderValue:De,SelectDisplayProps:Ve={},tabIndex:je,value:We,variant:Ze="standard"}=e,Ye=Gt(e,Hie),[Ce,Xe]=m_({controlled:We,default:P,name:"Select"}),[lt,Dt]=m_({controlled:_e,default:S,name:"Select"}),mt=q.useRef(null),ht=q.useRef(null),[ot,xt]=q.useState(null),{current:bt}=q.useRef(_e!=null),[Wt,nt]=q.useState(),Et=jr(n,W),cn=q.useCallback(st=>{ht.current=st,st&&xt(st)},[]),en=ot==null?void 0:ot.parentNode;q.useImperativeHandle(Et,()=>({focus:()=>{ht.current.focus()},node:mt.current,value:Ce}),[Ce]),q.useEffect(()=>{S&&lt&&ot&&!bt&&(nt(l?null:en.clientWidth),ht.current.focus())},[ot,l]),q.useEffect(()=>{h&&ht.current.focus()},[h]),q.useEffect(()=>{if(!z)return;const st=Xr(ht.current).getElementById(z);if(st){const qt=()=>{getSelection().isCollapsed&&ht.current.focus()};return st.addEventListener("click",qt),()=>{st.removeEventListener("click",qt)}}},[z]);const mn=(st,qt)=>{st?Se&&Se(qt):se&&se(qt),bt||(nt(l?null:en.clientWidth),Dt(st))},Ht=st=>{st.button===0&&(st.preventDefault(),ht.current.focus(),mn(!0,st))},It=st=>{mn(!1,st)},Rt=q.Children.toArray(m),yn=st=>{const qt=Rt.find(wn=>wn.props.value===st.target.value);qt!==void 0&&(Xe(qt.props.value),ne&&ne(st,qt))},vn=st=>qt=>{let wn;if(qt.currentTarget.hasAttribute("tabindex")){if(F){wn=Array.isArray(Ce)?Ce.slice():[];const pn=Ce.indexOf(st.props.value);pn===-1?wn.push(st.props.value):wn.splice(pn,1)}else wn=st.props.value;if(st.props.onClick&&st.props.onClick(qt),Ce!==wn&&(Xe(wn),ne)){const pn=qt.nativeEvent||qt,tt=new pn.constructor(pn.type,pn);Object.defineProperty(tt,"target",{writable:!0,value:{value:wn,name:$}}),ne(tt,st)}F||mn(!1,qt)}},ut=st=>{Re||[" ","ArrowUp","ArrowDown","Enter"].indexOf(st.key)!==-1&&(st.preventDefault(),mn(!0,st))},un=ot!==null&&lt,Ae=st=>{!un&&K&&(Object.defineProperty(st,"target",{writable:!0,value:{value:Ce,name:$}}),K(st))};delete Ye["aria-invalid"];let Ct,bn;const Yt=[];let kt=!1;(v_({value:Ce})||L)&&(De?Ct=De(Ce):kt=!0);const Ln=Rt.map(st=>{if(!q.isValidElement(st))return null;let qt;if(F){if(!Array.isArray(Ce))throw new Error(_l(2));qt=Ce.some(wn=>Kk(wn,st.props.value)),qt&&kt&&Yt.push(st.props.children)}else qt=Kk(Ce,st.props.value),qt&&kt&&(bn=st.props.children);return q.cloneElement(st,{"aria-selected":qt?"true":"false",onClick:vn(st),onKeyUp:wn=>{wn.key===" "&&wn.preventDefault(),st.props.onKeyUp&&st.props.onKeyUp(wn)},role:"option",selected:qt,value:void 0,"data-value":st.props.value})});kt&&(F?Yt.length===0?Ct=null:Ct=Yt.reduce((st,qt,wn)=>(st.push(qt),wn<Yt.length-1&&st.push(", "),st),[]):Ct=bn);let Un=Wt;!l&&bt&&ot&&(Un=en.clientWidth);let zn;typeof je<"u"?zn=je:zn=C?null:0;const Qe=Ve.id||($?`mui-component-select-${$}`:void 0),qe=re({},e,{variant:Ze,value:Ce,open:un,error:R}),vt=Kie(qe),hn=re({},N.PaperProps,(r=N.slotProps)==null?void 0:r.paper),$e=nT();return te.jsxs(q.Fragment,{children:[te.jsx(qie,re({ref:cn,tabIndex:zn,role:"combobox","aria-controls":$e,"aria-disabled":C?"true":void 0,"aria-expanded":un?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[z,Qe].filter(Boolean).join(" ")||void 0,"aria-describedby":i,onKeyDown:ut,onMouseDown:C||Re?null:Ht,onBlur:Ae,onFocus:xe},Ve,{ownerState:qe,className:Qt(Ve.className,vt.select,_),id:Qe,children:Yie(Ct)?Yk||(Yk=te.jsx("span",{className:"notranslate",children:""})):Ct})),te.jsx(Xie,re({"aria-invalid":R,value:Array.isArray(Ce)?Ce.join(","):Ce,name:$,ref:mt,"aria-hidden":!0,onChange:yn,tabIndex:-1,disabled:C,className:vt.nativeInput,autoFocus:h,ownerState:qe},Ye)),te.jsx(Zie,{as:D,className:vt.icon,ownerState:qe}),te.jsx(gD,re({id:`menu-${$||""}`,anchorEl:en,open:un,onClose:It,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},N,{MenuListProps:re({"aria-labelledby":z,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:$e},N.MenuListProps),slotProps:re({},N.slotProps,{paper:re({},hn,{style:re({minWidth:Un},hn!=null?hn.style:null)})}),children:Ln}))]})}),Qie=Jie,ese=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],tse=["root"],nse=t=>{const{classes:e}=t;return e},TT={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>fo(t)&&t!=="variant",slot:"Root"},rse=_t(hD,TT)(""),ise=_t(xD,TT)(""),sse=_t(aD,TT)(""),bD=q.forwardRef(function(e,n){const r=Nn({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:h={},className:l,defaultOpen:m=!1,displayEmpty:_=!1,IconComponent:S=Mte,id:P,input:C,inputProps:L,label:R,labelId:D,MenuProps:W,multiple:z=!1,native:N=!1,onClose:F,onOpen:$,open:K,renderValue:ne,SelectDisplayProps:se,variant:xe="outlined"}=r,Se=Gt(r,ese),_e=N?Oie:Qie,Re=ju(),De=Jd({props:r,muiFormControl:Re,states:["variant","error"]}),Ve=De.variant||xe,je=re({},r,{variant:Ve,classes:h}),We=nse(je),Ze=Gt(We,tse),Ye=C||{standard:te.jsx(rse,{ownerState:je}),outlined:te.jsx(ise,{label:R,ownerState:je}),filled:te.jsx(sse,{ownerState:je})}[Ve],Ce=jr(n,kc(Ye));return te.jsx(q.Fragment,{children:q.cloneElement(Ye,re({inputComponent:_e,inputProps:re({children:a,error:De.error,IconComponent:S,variant:Ve,type:void 0,multiple:z},N?{id:P}:{autoWidth:i,defaultOpen:m,displayEmpty:_,labelId:D,MenuProps:W,onClose:F,onOpen:$,open:K,renderValue:ne,SelectDisplayProps:re({id:P},se)},L,{classes:L?oo(Ze,L.classes):Ze},C?C.props.inputProps:{})},(z&&N||_)&&Ve==="outlined"?{notched:!0}:{},{ref:Ce,className:Qt(Ye.props.className,l,We.root)},!C&&{variant:Ve},Se))})});bD.muiName="Select";const wD=bD;function ose(t,e,n=(r,i)=>r===i){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}const ase=2;function SD(t,e){return t-e}function Jk(t,e){var n;const{index:r}=(n=t.reduce((i,a,h)=>{const l=Math.abs(e-a);return i===null||l<i.distance||l===i.distance?{distance:l,index:h}:i},null))!=null?n:{};return r}function qy(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function b_(t,e,n){return(t-e)*100/(n-e)}function lse(t,e,n){return(n-e)*t+e}function cse(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function use(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(cse(e)))}function Qk({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(SD)}function Zy({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const a=Xr(t.current);if(!((r=t.current)!=null&&r.contains(a.activeElement))||Number(a==null||(i=a.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var h;(h=t.current)==null||h.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}function Xy(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?ose(t,e):!1}const hse={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},dse=t=>t;let Yy;function eM(){return Yy===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Yy=CSS.supports("touch-action","none"):Yy=!0),Yy}function fse(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:a=!1,marks:h=!1,max:l=100,min:m=0,name:_,onChange:S,onChangeCommitted:P,orientation:C="horizontal",rootRef:L,scale:R=dse,step:D=1,shiftStep:W=10,tabIndex:z,value:N}=t,F=q.useRef(void 0),[$,K]=q.useState(-1),[ne,se]=q.useState(-1),[xe,Se]=q.useState(!1),_e=q.useRef(0),[Re,De]=m_({controlled:N,default:n??m,name:"Slider"}),Ve=S&&((Qe,qe,vt)=>{const hn=Qe.nativeEvent||Qe,$e=new hn.constructor(hn.type,hn);Object.defineProperty($e,"target",{writable:!0,value:{value:qe,name:_}}),S($e,qe,vt)}),je=Array.isArray(Re);let We=je?Re.slice().sort(SD):[Re];We=We.map(Qe=>Qe==null?m:hu(Qe,m,l));const Ze=h===!0&&D!==null?[...Array(Math.floor((l-m)/D)+1)].map((Qe,qe)=>({value:m+D*qe})):h||[],Ye=Ze.map(Qe=>Qe.value),{isFocusVisibleRef:Ce,onBlur:Xe,onFocus:lt,ref:Dt}=rT(),[mt,ht]=q.useState(-1),ot=q.useRef(null),xt=jr(Dt,ot),bt=jr(L,xt),Wt=Qe=>qe=>{var vt;const hn=Number(qe.currentTarget.getAttribute("data-index"));lt(qe),Ce.current===!0&&ht(hn),se(hn),Qe==null||(vt=Qe.onFocus)==null||vt.call(Qe,qe)},nt=Qe=>qe=>{var vt;Xe(qe),Ce.current===!1&&ht(-1),se(-1),Qe==null||(vt=Qe.onBlur)==null||vt.call(Qe,qe)},Et=(Qe,qe)=>{const vt=Number(Qe.currentTarget.getAttribute("data-index")),hn=We[vt],$e=Ye.indexOf(hn);let st=qe;if(Ze&&D==null){const qt=Ye[Ye.length-1];st>qt?st=qt:st<Ye[0]?st=Ye[0]:st=st<hn?Ye[$e-1]:Ye[$e+1]}if(st=hu(st,m,l),je){i&&(st=hu(st,We[vt-1]||-1/0,We[vt+1]||1/0));const qt=st;st=Qk({values:We,newValue:st,index:vt});let wn=vt;i||(wn=st.indexOf(qt)),Zy({sliderRef:ot,activeIndex:wn})}De(st),ht(vt),Ve&&!Xy(st,Re)&&Ve(Qe,st,vt),P&&P(Qe,st)},cn=Qe=>qe=>{var vt;if(D!==null){const hn=Number(qe.currentTarget.getAttribute("data-index")),$e=We[hn];let st=null;(qe.key==="ArrowLeft"||qe.key==="ArrowDown")&&qe.shiftKey||qe.key==="PageDown"?st=Math.max($e-W,m):((qe.key==="ArrowRight"||qe.key==="ArrowUp")&&qe.shiftKey||qe.key==="PageUp")&&(st=Math.min($e+W,l)),st!==null&&(Et(qe,st),qe.preventDefault())}Qe==null||(vt=Qe.onKeyDown)==null||vt.call(Qe,qe)};fa(()=>{if(r&&ot.current.contains(document.activeElement)){var Qe;(Qe=document.activeElement)==null||Qe.blur()}},[r]),r&&$!==-1&&K(-1),r&&mt!==-1&&ht(-1);const en=Qe=>qe=>{var vt;(vt=Qe.onChange)==null||vt.call(Qe,qe),Et(qe,qe.target.valueAsNumber)},mn=q.useRef(void 0);let Ht=C;a&&C==="horizontal"&&(Ht+="-reverse");const It=({finger:Qe,move:qe=!1})=>{const{current:vt}=ot,{width:hn,height:$e,bottom:st,left:qt}=vt.getBoundingClientRect();let wn;Ht.indexOf("vertical")===0?wn=(st-Qe.y)/$e:wn=(Qe.x-qt)/hn,Ht.indexOf("-reverse")!==-1&&(wn=1-wn);let pn;if(pn=lse(wn,m,l),D)pn=use(pn,D,m);else{const tn=Jk(Ye,pn);pn=Ye[tn]}pn=hu(pn,m,l);let tt=0;if(je){qe?tt=mn.current:tt=Jk(We,pn),i&&(pn=hu(pn,We[tt-1]||-1/0,We[tt+1]||1/0));const tn=pn;pn=Qk({values:We,newValue:pn,index:tt}),i&&qe||(tt=pn.indexOf(tn),mn.current=tt)}return{newValue:pn,activeIndex:tt}},Rt=zs(Qe=>{const qe=qy(Qe,F);if(!qe)return;if(_e.current+=1,Qe.type==="mousemove"&&Qe.buttons===0){yn(Qe);return}const{newValue:vt,activeIndex:hn}=It({finger:qe,move:!0});Zy({sliderRef:ot,activeIndex:hn,setActive:K}),De(vt),!xe&&_e.current>ase&&Se(!0),Ve&&!Xy(vt,Re)&&Ve(Qe,vt,hn)}),yn=zs(Qe=>{const qe=qy(Qe,F);if(Se(!1),!qe)return;const{newValue:vt}=It({finger:qe,move:!0});K(-1),Qe.type==="touchend"&&se(-1),P&&P(Qe,vt),F.current=void 0,ut()}),vn=zs(Qe=>{if(r)return;eM()||Qe.preventDefault();const qe=Qe.changedTouches[0];qe!=null&&(F.current=qe.identifier);const vt=qy(Qe,F);if(vt!==!1){const{newValue:$e,activeIndex:st}=It({finger:vt});Zy({sliderRef:ot,activeIndex:st,setActive:K}),De($e),Ve&&!Xy($e,Re)&&Ve(Qe,$e,st)}_e.current=0;const hn=Xr(ot.current);hn.addEventListener("touchmove",Rt,{passive:!0}),hn.addEventListener("touchend",yn,{passive:!0})}),ut=q.useCallback(()=>{const Qe=Xr(ot.current);Qe.removeEventListener("mousemove",Rt),Qe.removeEventListener("mouseup",yn),Qe.removeEventListener("touchmove",Rt),Qe.removeEventListener("touchend",yn)},[yn,Rt]);q.useEffect(()=>{const{current:Qe}=ot;return Qe.addEventListener("touchstart",vn,{passive:eM()}),()=>{Qe.removeEventListener("touchstart",vn),ut()}},[ut,vn]),q.useEffect(()=>{r&&ut()},[r,ut]);const un=Qe=>qe=>{var vt;if((vt=Qe.onMouseDown)==null||vt.call(Qe,qe),r||qe.defaultPrevented||qe.button!==0)return;qe.preventDefault();const hn=qy(qe,F);if(hn!==!1){const{newValue:st,activeIndex:qt}=It({finger:hn});Zy({sliderRef:ot,activeIndex:qt,setActive:K}),De(st),Ve&&!Xy(st,Re)&&Ve(qe,st,qt)}_e.current=0;const $e=Xr(ot.current);$e.addEventListener("mousemove",Rt,{passive:!0}),$e.addEventListener("mouseup",yn)},Ae=b_(je?We[0]:m,m,l),Ct=b_(We[We.length-1],m,l)-Ae,bn=(Qe={})=>{const qe=wu(Qe),vt={onMouseDown:un(qe||{})},hn=re({},qe,vt);return re({},Qe,{ref:bt},hn)},Yt=Qe=>qe=>{var vt;(vt=Qe.onMouseOver)==null||vt.call(Qe,qe);const hn=Number(qe.currentTarget.getAttribute("data-index"));se(hn)},kt=Qe=>qe=>{var vt;(vt=Qe.onMouseLeave)==null||vt.call(Qe,qe),se(-1)};return{active:$,axis:Ht,axisProps:hse,dragging:xe,focusedThumbIndex:mt,getHiddenInputProps:(Qe={})=>{var qe;const vt=wu(Qe),hn={onChange:en(vt||{}),onFocus:Wt(vt||{}),onBlur:nt(vt||{}),onKeyDown:cn(vt||{})},$e=re({},vt,hn);return re({tabIndex:z,"aria-labelledby":e,"aria-orientation":C,"aria-valuemax":R(l),"aria-valuemin":R(m),name:_,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":(qe=t.step)!=null?qe:void 0,disabled:r},Qe,$e,{style:re({},iK,{direction:a?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:bn,getThumbProps:(Qe={})=>{const qe=wu(Qe),vt={onMouseOver:Yt(qe||{}),onMouseLeave:kt(qe||{})};return re({},Qe,qe,vt)},marks:Ze,open:ne,range:je,rootRef:bt,trackLeap:Ct,trackOffset:Ae,values:We,getThumbStyle:Qe=>({pointerEvents:$!==-1&&$!==Qe?"none":void 0})}}const pse=t=>!t||!wc(t),mse=pse;function gse(t){return Fn("MuiSlider",t)}const yse=In("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Mo=yse,_se=t=>{const{open:e}=t;return{offset:Qt(e&&Mo.valueLabelOpen),circle:Mo.valueLabelCircle,label:Mo.valueLabelLabel}};function vse(t){const{children:e,className:n,value:r}=t,i=_se(t);return e?q.cloneElement(e,{className:Qt(e.props.className)},te.jsxs(q.Fragment,{children:[e.props.children,te.jsx("span",{className:Qt(i.offset,n),"aria-hidden":!0,children:te.jsx("span",{className:i.circle,children:te.jsx("span",{className:i.label,children:r})})})]})):null}const xse=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function tM(t){return t}const bse=_t("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${$t(n.color)}`],n.size!=="medium"&&e[`size${$t(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t})=>{var e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Mo.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Mo.dragging}`]:{[`& .${Mo.thumb}, & .${Mo.track}`]:{transition:"none"}},variants:[...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}),wse=_t("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),Sse=_t("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t})=>{var e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n,track:"inverted"},style:re({},t.vars?{backgroundColor:t.vars.palette.Slider[`${n}Track`],borderColor:t.vars.palette.Slider[`${n}Track`]}:re({backgroundColor:Am(t.palette[n].main,.62),borderColor:Am(t.palette[n].main,.62)},t.applyStyles("dark",{backgroundColor:Cm(t.palette[n].main,.5)}),t.applyStyles("dark",{borderColor:Cm(t.palette[n].main,.5)})))}))]}}),Tse=_t("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${$t(n.color)}`],n.size!=="medium"&&e[`thumbSize${$t(n.size)}`]]}})(({theme:t})=>{var e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Mo.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n},style:{[`&:hover, &.${Mo.focusVisible}`]:re({},t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${as(t.palette[n].main,.16)}`},{"@media (hover: none)":{boxShadow:"none"}}),[`&.${Mo.active}`]:re({},t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${as(t.palette[n].main,.16)}`})}}))]}}),Ese=_t(vse,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t})=>re({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Mo.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Mo.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})),Pse=_t("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>Iv(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]})),Cse=_t("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>Iv(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t})=>re({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})),Ase=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:a,classes:h,color:l,size:m}=t,_={root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",l&&`color${$t(l)}`,m&&`size${$t(m)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",m&&`thumbSize${$t(m)}`,l&&`thumbColor${$t(l)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return jn(_,gse,h)},Ise=({children:t})=>t,kse=q.forwardRef(function(e,n){var r,i,a,h,l,m,_,S,P,C,L,R,D,W,z,N,F,$,K,ne,se,xe,Se,_e;const Re=Nn({props:e,name:"MuiSlider"}),De=Av(),{"aria-label":Ve,"aria-valuetext":je,"aria-labelledby":We,component:Ze="span",components:Ye={},componentsProps:Ce={},color:Xe="primary",classes:lt,className:Dt,disableSwap:mt=!1,disabled:ht=!1,getAriaLabel:ot,getAriaValueText:xt,marks:bt=!1,max:Wt=100,min:nt=0,orientation:Et="horizontal",shiftStep:cn=10,size:en="medium",step:mn=1,scale:Ht=tM,slotProps:It,slots:Rt,track:yn="normal",valueLabelDisplay:vn="off",valueLabelFormat:ut=tM}=Re,un=Gt(Re,xse),Ae=re({},Re,{isRtl:De,max:Wt,min:nt,classes:lt,disabled:ht,disableSwap:mt,orientation:Et,marks:bt,color:Xe,size:en,step:mn,shiftStep:cn,scale:Ht,track:yn,valueLabelDisplay:vn,valueLabelFormat:ut}),{axisProps:Ct,getRootProps:bn,getHiddenInputProps:Yt,getThumbProps:kt,open:Ln,active:Un,axis:zn,focusedThumbIndex:Qe,range:qe,dragging:vt,marks:hn,values:$e,trackOffset:st,trackLeap:qt,getThumbStyle:wn}=fse(re({},Ae,{rootRef:n}));Ae.marked=hn.length>0&&hn.some(At=>At.label),Ae.dragging=vt,Ae.focusedThumbIndex=Qe;const pn=Ase(Ae),tt=(r=(i=Rt==null?void 0:Rt.root)!=null?i:Ye.Root)!=null?r:bse,tn=(a=(h=Rt==null?void 0:Rt.rail)!=null?h:Ye.Rail)!=null?a:wse,on=(l=(m=Rt==null?void 0:Rt.track)!=null?m:Ye.Track)!=null?l:Sse,Pr=(_=(S=Rt==null?void 0:Rt.thumb)!=null?S:Ye.Thumb)!=null?_:Tse,ci=(P=(C=Rt==null?void 0:Rt.valueLabel)!=null?C:Ye.ValueLabel)!=null?P:Ese,an=(L=(R=Rt==null?void 0:Rt.mark)!=null?R:Ye.Mark)!=null?L:Pse,Vr=(D=(W=Rt==null?void 0:Rt.markLabel)!=null?W:Ye.MarkLabel)!=null?D:Cse,he=(z=(N=Rt==null?void 0:Rt.input)!=null?N:Ye.Input)!=null?z:"input",G=(F=It==null?void 0:It.root)!=null?F:Ce.root,Z=($=It==null?void 0:It.rail)!=null?$:Ce.rail,ie=(K=It==null?void 0:It.track)!=null?K:Ce.track,de=(ne=It==null?void 0:It.thumb)!=null?ne:Ce.thumb,pe=(se=It==null?void 0:It.valueLabel)!=null?se:Ce.valueLabel,Me=(xe=It==null?void 0:It.mark)!=null?xe:Ce.mark,be=(Se=It==null?void 0:It.markLabel)!=null?Se:Ce.markLabel,ye=(_e=It==null?void 0:It.input)!=null?_e:Ce.input,Ee=is({elementType:tt,getSlotProps:bn,externalSlotProps:G,externalForwardedProps:un,additionalProps:re({},mse(tt)&&{as:Ze}),ownerState:re({},Ae,G==null?void 0:G.ownerState),className:[pn.root,Dt]}),Ue=is({elementType:tn,externalSlotProps:Z,ownerState:Ae,className:pn.rail}),Ge=is({elementType:on,externalSlotProps:ie,additionalProps:{style:re({},Ct[zn].offset(st),Ct[zn].leap(qt))},ownerState:re({},Ae,ie==null?void 0:ie.ownerState),className:pn.track}),He=is({elementType:Pr,getSlotProps:kt,externalSlotProps:de,ownerState:re({},Ae,de==null?void 0:de.ownerState),className:pn.thumb}),Ot=is({elementType:ci,externalSlotProps:pe,ownerState:re({},Ae,pe==null?void 0:pe.ownerState),className:pn.valueLabel}),Kt=is({elementType:an,externalSlotProps:Me,ownerState:Ae,className:pn.mark}),Pt=is({elementType:Vr,externalSlotProps:be,ownerState:Ae,className:pn.markLabel}),Bt=is({elementType:he,getSlotProps:Yt,externalSlotProps:ye,ownerState:Ae});return te.jsxs(tt,re({},Ee,{children:[te.jsx(tn,re({},Ue)),te.jsx(on,re({},Ge)),hn.filter(At=>At.value>=nt&&At.value<=Wt).map((At,dn)=>{const kn=b_(At.value,nt,Wt),gn=Ct[zn].offset(kn);let fn;return yn===!1?fn=$e.indexOf(At.value)!==-1:fn=yn==="normal"&&(qe?At.value>=$e[0]&&At.value<=$e[$e.length-1]:At.value<=$e[0])||yn==="inverted"&&(qe?At.value<=$e[0]||At.value>=$e[$e.length-1]:At.value>=$e[0]),te.jsxs(q.Fragment,{children:[te.jsx(an,re({"data-index":dn},Kt,!wc(an)&&{markActive:fn},{style:re({},gn,Kt.style),className:Qt(Kt.className,fn&&pn.markActive)})),At.label!=null?te.jsx(Vr,re({"aria-hidden":!0,"data-index":dn},Pt,!wc(Vr)&&{markLabelActive:fn},{style:re({},gn,Pt.style),className:Qt(pn.markLabel,Pt.className,fn&&pn.markLabelActive),children:At.label})):null]},dn)}),$e.map((At,dn)=>{const kn=b_(At,nt,Wt),gn=Ct[zn].offset(kn),fn=vn==="off"?Ise:ci;return te.jsx(fn,re({},!wc(fn)&&{valueLabelFormat:ut,valueLabelDisplay:vn,value:typeof ut=="function"?ut(Ht(At),dn):ut,index:dn,open:Ln===dn||Un===dn||vn==="on",disabled:ht},Ot,{children:te.jsx(Pr,re({"data-index":dn},He,{className:Qt(pn.thumb,He.className,Un===dn&&pn.active,Qe===dn&&pn.focusVisible),style:re({},gn,wn(dn),He.style),children:te.jsx(he,re({"data-index":dn,"aria-label":ot?ot(dn):Ve,"aria-valuenow":Ht(At),"aria-labelledby":We,"aria-valuetext":xt?xt(Ht(At),dn):je,value:$e[dn]},Bt))}))}),dn)})]}))}),ET=kse;function Mse(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:a}=t,h=gu();q.useEffect(()=>{if(!i)return;function z(N){N.defaultPrevented||(N.key==="Escape"||N.key==="Esc")&&(r==null||r(N,"escapeKeyDown"))}return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[i,r]);const l=zs((z,N)=>{r==null||r(z,N)}),m=zs(z=>{!r||z==null||h.start(z,()=>{l(null,"timeout")})});q.useEffect(()=>(i&&m(e),h.clear),[i,e,m,h]);const _=z=>{r==null||r(z,"clickaway")},S=h.clear,P=q.useCallback(()=>{e!=null&&m(a??e*.5)},[e,a,m]),C=z=>N=>{const F=z.onBlur;F==null||F(N),P()},L=z=>N=>{const F=z.onFocus;F==null||F(N),S()},R=z=>N=>{const F=z.onMouseEnter;F==null||F(N),S()},D=z=>N=>{const F=z.onMouseLeave;F==null||F(N),P()};return q.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",P),window.addEventListener("blur",S),()=>{window.removeEventListener("focus",P),window.removeEventListener("blur",S)}},[n,i,P,S]),{getRootProps:(z={})=>{const N=re({},wu(t),wu(z));return re({role:"presentation"},z,N,{onBlur:C(N),onFocus:L(N),onMouseEnter:R(N),onMouseLeave:D(N)})},onClickAway:_}}function Lse(t){return Fn("MuiSnackbarContent",t)}In("MuiSnackbarContent",["root","message","action"]);const Rse=["action","className","message","role"],Ose=t=>{const{classes:e}=t;return jn({root:["root"],action:["action"],message:["message"]},Lse,e)},zse=_t(kv,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,n=xK(t.palette.background.default,e);return re({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(n),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),Dse=_t("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),Fse=_t("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Nse=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:h,role:l="alert"}=r,m=Gt(r,Rse),_=r,S=Ose(_);return te.jsxs(zse,re({role:l,square:!0,elevation:6,className:Qt(S.root,a),ownerState:_,ref:n},m,{children:[te.jsx(Dse,{className:S.message,ownerState:_,children:h}),i?te.jsx(Fse,{className:S.action,ownerState:_,children:i}):null]}))}),Bse=Nse;function jse(t){return Fn("MuiSnackbar",t)}In("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Vse=["onEnter","onExited"],Use=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],$se=t=>{const{classes:e,anchorOrigin:n}=t,r={root:["root",`anchorOrigin${$t(n.vertical)}${$t(n.horizontal)}`]};return jn(r,jse,e)},nM=_t("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`anchorOrigin${$t(n.anchorOrigin.vertical)}${$t(n.anchorOrigin.horizontal)}`]]}})(({theme:t,ownerState:e})=>{const n={left:"50%",right:"auto",transform:"translateX(-50%)"};return re({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:re({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&n,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),Gse=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiSnackbar"}),i=Yd(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:h,anchorOrigin:{vertical:l,horizontal:m}={vertical:"bottom",horizontal:"left"},autoHideDuration:_=null,children:S,className:P,ClickAwayListenerProps:C,ContentProps:L,disableWindowBlurListener:R=!1,message:D,open:W,TransitionComponent:z=x_,transitionDuration:N=a,TransitionProps:{onEnter:F,onExited:$}={}}=r,K=Gt(r.TransitionProps,Vse),ne=Gt(r,Use),se=re({},r,{anchorOrigin:{vertical:l,horizontal:m},autoHideDuration:_,disableWindowBlurListener:R,TransitionComponent:z,transitionDuration:N}),xe=$se(se),{getRootProps:Se,onClickAway:_e}=Mse(re({},se)),[Re,De]=q.useState(!0),Ve=is({elementType:nM,getSlotProps:Se,externalForwardedProps:ne,ownerState:se,additionalProps:{ref:n},className:[xe.root,P]}),je=Ze=>{De(!0),$&&$(Ze)},We=(Ze,Ye)=>{De(!1),F&&F(Ze,Ye)};return!W&&Re?null:te.jsx(fne,re({onClickAway:_e},C,{children:te.jsx(nM,re({},Ve,{children:te.jsx(z,re({appear:!0,in:W,timeout:N,direction:l==="top"?"down":"up",onEnter:We,onExited:je},K,{children:S||te.jsx(Bse,re({message:D,action:h},L))}))}))}))}),rM=Gse;function Wse(t){return Fn("MuiTooltip",t)}const Hse=In("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),cc=Hse,qse=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function Zse(t){return Math.round(t*1e5)/1e5}const Xse=t=>{const{classes:e,disableInteractive:n,arrow:r,touch:i,placement:a}=t,h={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${$t(a.split("-")[0])}`],arrow:["arrow"]};return jn(h,Wse,e)},Yse=_t(Jz,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(({theme:t,ownerState:e,open:n})=>re({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!n&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${cc.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${cc.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${cc.arrow}`]:re({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${cc.arrow}`]:re({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),Kse=_t("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${$t(n.placement.split("-")[0])}`]]}})(({theme:t,ownerState:e})=>re({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:as(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${Zse(16/14)}em`,fontWeight:t.typography.fontWeightRegular},{[`.${cc.popper}[data-popper-placement*="left"] &`]:re({transformOrigin:"right center"},e.isRtl?re({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):re({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${cc.popper}[data-popper-placement*="right"] &`]:re({transformOrigin:"left center"},e.isRtl?re({marginRight:"14px"},e.touch&&{marginRight:"24px"}):re({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${cc.popper}[data-popper-placement*="top"] &`]:re({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${cc.popper}[data-popper-placement*="bottom"] &`]:re({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),Jse=_t("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:as(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let Ky=!1;const iM=new tg;let wp={x:0,y:0};function Jy(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const Qse=q.forwardRef(function(e,n){var r,i,a,h,l,m,_,S,P,C,L,R,D,W,z,N,F,$,K;const ne=Nn({props:e,name:"MuiTooltip"}),{arrow:se=!1,children:xe,components:Se={},componentsProps:_e={},describeChild:Re=!1,disableFocusListener:De=!1,disableHoverListener:Ve=!1,disableInteractive:je=!1,disableTouchListener:We=!1,enterDelay:Ze=100,enterNextDelay:Ye=0,enterTouchDelay:Ce=700,followCursor:Xe=!1,id:lt,leaveDelay:Dt=0,leaveTouchDelay:mt=1500,onClose:ht,onOpen:ot,open:xt,placement:bt="bottom",PopperComponent:Wt,PopperProps:nt={},slotProps:Et={},slots:cn={},title:en,TransitionComponent:mn=x_,TransitionProps:Ht}=ne,It=Gt(ne,qse),Rt=q.isValidElement(xe)?xe:te.jsx("span",{children:xe}),yn=Yd(),vn=Av(),[ut,un]=q.useState(),[Ae,Ct]=q.useState(null),bn=q.useRef(!1),Yt=je||Xe,kt=gu(),Ln=gu(),Un=gu(),zn=gu(),[Qe,qe]=m_({controlled:xt,default:!1,name:"Tooltip",state:"open"});let vt=Qe;const hn=nT(lt),$e=q.useRef(),st=zs(()=>{$e.current!==void 0&&(document.body.style.WebkitUserSelect=$e.current,$e.current=void 0),zn.clear()});q.useEffect(()=>st,[st]);const qt=nn=>{iM.clear(),Ky=!0,qe(!0),ot&&!vt&&ot(nn)},wn=zs(nn=>{iM.start(800+Dt,()=>{Ky=!1}),qe(!1),ht&&vt&&ht(nn),kt.start(yn.transitions.duration.shortest,()=>{bn.current=!1})}),pn=nn=>{bn.current&&nn.type!=="touchstart"||(ut&&ut.removeAttribute("title"),Ln.clear(),Un.clear(),Ze||Ky&&Ye?Ln.start(Ky?Ye:Ze,()=>{qt(nn)}):qt(nn))},tt=nn=>{Ln.clear(),Un.start(Dt,()=>{wn(nn)})},{isFocusVisibleRef:tn,onBlur:on,onFocus:Pr,ref:ci}=rT(),[,an]=q.useState(!1),Vr=nn=>{on(nn),tn.current===!1&&(an(!1),tt(nn))},he=nn=>{ut||un(nn.currentTarget),Pr(nn),tn.current===!0&&(an(!0),pn(nn))},G=nn=>{bn.current=!0;const _n=Rt.props;_n.onTouchStart&&_n.onTouchStart(nn)},Z=nn=>{G(nn),Un.clear(),kt.clear(),st(),$e.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",zn.start(Ce,()=>{document.body.style.WebkitUserSelect=$e.current,pn(nn)})},ie=nn=>{Rt.props.onTouchEnd&&Rt.props.onTouchEnd(nn),st(),Un.start(mt,()=>{wn(nn)})};q.useEffect(()=>{if(!vt)return;function nn(_n){(_n.key==="Escape"||_n.key==="Esc")&&wn(_n)}return document.addEventListener("keydown",nn),()=>{document.removeEventListener("keydown",nn)}},[wn,vt]);const de=jr(kc(Rt),ci,un,n);!en&&en!==0&&(vt=!1);const pe=q.useRef(),Me=nn=>{const _n=Rt.props;_n.onMouseMove&&_n.onMouseMove(nn),wp={x:nn.clientX,y:nn.clientY},pe.current&&pe.current.update()},be={},ye=typeof en=="string";Re?(be.title=!vt&&ye&&!Ve?en:null,be["aria-describedby"]=vt?hn:null):(be["aria-label"]=ye?en:null,be["aria-labelledby"]=vt&&!ye?hn:null);const Ee=re({},be,It,Rt.props,{className:Qt(It.className,Rt.props.className),onTouchStart:G,ref:de},Xe?{onMouseMove:Me}:{}),Ue={};We||(Ee.onTouchStart=Z,Ee.onTouchEnd=ie),Ve||(Ee.onMouseOver=Jy(pn,Ee.onMouseOver),Ee.onMouseLeave=Jy(tt,Ee.onMouseLeave),Yt||(Ue.onMouseOver=pn,Ue.onMouseLeave=tt)),De||(Ee.onFocus=Jy(he,Ee.onFocus),Ee.onBlur=Jy(Vr,Ee.onBlur),Yt||(Ue.onFocus=he,Ue.onBlur=Vr));const Ge=q.useMemo(()=>{var nn;let _n=[{name:"arrow",enabled:!!Ae,options:{element:Ae,padding:4}}];return(nn=nt.popperOptions)!=null&&nn.modifiers&&(_n=_n.concat(nt.popperOptions.modifiers)),re({},nt.popperOptions,{modifiers:_n})},[Ae,nt]),He=re({},ne,{isRtl:vn,arrow:se,disableInteractive:Yt,placement:bt,PopperComponentProp:Wt,touch:bn.current}),Ot=Xse(He),Kt=(r=(i=cn.popper)!=null?i:Se.Popper)!=null?r:Yse,Pt=(a=(h=(l=cn.transition)!=null?l:Se.Transition)!=null?h:mn)!=null?a:x_,Bt=(m=(_=cn.tooltip)!=null?_:Se.Tooltip)!=null?m:Kse,At=(S=(P=cn.arrow)!=null?P:Se.Arrow)!=null?S:Jse,dn=nd(Kt,re({},nt,(C=Et.popper)!=null?C:_e.popper,{className:Qt(Ot.popper,nt==null?void 0:nt.className,(L=(R=Et.popper)!=null?R:_e.popper)==null?void 0:L.className)}),He),kn=nd(Pt,re({},Ht,(D=Et.transition)!=null?D:_e.transition),He),gn=nd(Bt,re({},(W=Et.tooltip)!=null?W:_e.tooltip,{className:Qt(Ot.tooltip,(z=(N=Et.tooltip)!=null?N:_e.tooltip)==null?void 0:z.className)}),He),fn=nd(At,re({},(F=Et.arrow)!=null?F:_e.arrow,{className:Qt(Ot.arrow,($=(K=Et.arrow)!=null?K:_e.arrow)==null?void 0:$.className)}),He);return te.jsxs(q.Fragment,{children:[q.cloneElement(Rt,Ee),te.jsx(Kt,re({as:Wt??Jz,placement:bt,anchorEl:Xe?{getBoundingClientRect:()=>({top:wp.y,left:wp.x,right:wp.x,bottom:wp.y,width:0,height:0})}:ut,popperRef:pe,open:ut?vt:!1,id:hn,transition:!0},Ue,dn,{popperOptions:Ge,children:({TransitionProps:nn})=>te.jsx(Pt,re({timeout:yn.transitions.duration.shorter},nn,kn,{children:te.jsxs(Bt,re({},gn,{children:[en,se?te.jsx(At,re({},fn,{ref:Ct})):null]}))}))}))]})}),eoe=Qse,toe=q.createContext({}),Bv=toe,noe=q.createContext({}),PT=noe;function roe(t){return Fn("MuiStep",t)}In("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const ioe=["active","children","className","component","completed","disabled","expanded","index","last"],soe=t=>{const{classes:e,orientation:n,alternativeLabel:r,completed:i}=t;return jn({root:["root",n,r&&"alternativeLabel",i&&"completed"]},roe,e)},ooe=_t("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel,n.completed&&e.completed]}})(({ownerState:t})=>re({},t.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})),aoe=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiStep"}),{active:i,children:a,className:h,component:l="div",completed:m,disabled:_,expanded:S=!1,index:P,last:C}=r,L=Gt(r,ioe),{activeStep:R,connector:D,alternativeLabel:W,orientation:z,nonLinear:N}=q.useContext(Bv);let[F=!1,$=!1,K=!1]=[i,m,_];R===P?F=i!==void 0?i:!0:!N&&R>P?$=m!==void 0?m:!0:!N&&R<P&&(K=_!==void 0?_:!0);const ne=q.useMemo(()=>({index:P,last:C,expanded:S,icon:P+1,active:F,completed:$,disabled:K}),[P,C,S,F,$,K]),se=re({},r,{active:F,orientation:z,alternativeLabel:W,completed:$,disabled:K,expanded:S,component:l}),xe=soe(se),Se=te.jsxs(ooe,re({as:l,className:Qt(xe.root,h),ref:n,ownerState:se},L,{children:[D&&W&&P!==0?D:null,a]}));return te.jsx(PT.Provider,{value:ne,children:D&&!W&&P!==0?te.jsxs(q.Fragment,{children:[D,Se]}):Se})}),a1=aoe,loe=Uo(te.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),coe=Uo(te.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function uoe(t){return Fn("MuiStepIcon",t)}const hoe=In("MuiStepIcon",["root","active","completed","error","text"]),l1=hoe;var sM;const doe=["active","className","completed","error","icon"],foe=t=>{const{classes:e,active:n,completed:r,error:i}=t;return jn({root:["root",n&&"active",r&&"completed",i&&"error"],text:["text"]},uoe,e)},c1=_t(Kw,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${l1.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${l1.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${l1.error}`]:{color:(t.vars||t).palette.error.main}})),poe=_t("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,e)=>e.text})(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily})),moe=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiStepIcon"}),{active:i=!1,className:a,completed:h=!1,error:l=!1,icon:m}=r,_=Gt(r,doe),S=re({},r,{active:i,completed:h,error:l}),P=foe(S);if(typeof m=="number"||typeof m=="string"){const C=Qt(a,P.root);return l?te.jsx(c1,re({as:coe,className:C,ref:n,ownerState:S},_)):h?te.jsx(c1,re({as:loe,className:C,ref:n,ownerState:S},_)):te.jsxs(c1,re({className:C,ref:n,ownerState:S},_,{children:[sM||(sM=te.jsx("circle",{cx:"12",cy:"12",r:"12"})),te.jsx(poe,{className:P.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:S,children:m})]}))}return m}),goe=moe;function yoe(t){return Fn("MuiStepLabel",t)}const _oe=In("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),uc=_oe,voe=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],xoe=t=>{const{classes:e,orientation:n,active:r,completed:i,error:a,disabled:h,alternativeLabel:l}=t;return jn({root:["root",n,a&&"error",h&&"disabled",l&&"alternativeLabel"],label:["label",r&&"active",i&&"completed",a&&"error",h&&"disabled",l&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",i&&"completed",a&&"error",h&&"disabled",l&&"alternativeLabel"],labelContainer:["labelContainer",l&&"alternativeLabel"]},yoe,e)},boe=_t("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation]]}})(({ownerState:t})=>re({display:"flex",alignItems:"center",[`&.${uc.alternativeLabel}`]:{flexDirection:"column"},[`&.${uc.disabled}`]:{cursor:"default"}},t.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),woe=_t("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,e)=>e.label})(({theme:t})=>re({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${uc.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${uc.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${uc.alternativeLabel}`]:{marginTop:16},[`&.${uc.error}`]:{color:(t.vars||t).palette.error.main}})),Soe=_t("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,e)=>e.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${uc.alternativeLabel}`]:{paddingRight:0}})),Toe=_t("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,e)=>e.labelContainer})(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${uc.alternativeLabel}`]:{textAlign:"center"}})),TD=q.forwardRef(function(e,n){var r;const i=Nn({props:e,name:"MuiStepLabel"}),{children:a,className:h,componentsProps:l={},error:m=!1,icon:_,optional:S,slotProps:P={},StepIconComponent:C,StepIconProps:L}=i,R=Gt(i,voe),{alternativeLabel:D,orientation:W}=q.useContext(Bv),{active:z,disabled:N,completed:F,icon:$}=q.useContext(PT),K=_||$;let ne=C;K&&!ne&&(ne=goe);const se=re({},i,{active:z,alternativeLabel:D,completed:F,disabled:N,error:m,orientation:W}),xe=xoe(se),Se=(r=P.label)!=null?r:l.label;return te.jsxs(boe,re({className:Qt(xe.root,h),ref:n,ownerState:se},R,{children:[K||ne?te.jsx(Soe,{className:xe.iconContainer,ownerState:se,children:te.jsx(ne,re({completed:F,active:z,error:m,icon:K},L))}):null,te.jsxs(Toe,{className:xe.labelContainer,ownerState:se,children:[a?te.jsx(woe,re({ownerState:se},Se,{className:Qt(xe.label,Se==null?void 0:Se.className),children:a})):null,S]})]}))});TD.muiName="StepLabel";const u1=TD;function Eoe(t){return Fn("MuiStepConnector",t)}In("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Poe=["className"],Coe=t=>{const{classes:e,orientation:n,alternativeLabel:r,active:i,completed:a,disabled:h}=t,l={root:["root",n,r&&"alternativeLabel",i&&"active",a&&"completed",h&&"disabled"],line:["line",`line${$t(n)}`]};return jn(l,Eoe,e)},Aoe=_t("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel,n.completed&&e.completed]}})(({ownerState:t})=>re({flex:"1 1 auto"},t.orientation==="vertical"&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:8+4,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),Ioe=_t("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.line,e[`line${$t(n.orientation)}`]]}})(({ownerState:t,theme:e})=>{const n=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return re({display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:n},t.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},t.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),koe=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiStepConnector"}),{className:i}=r,a=Gt(r,Poe),{alternativeLabel:h,orientation:l="horizontal"}=q.useContext(Bv),{active:m,disabled:_,completed:S}=q.useContext(PT),P=re({},r,{alternativeLabel:h,orientation:l,active:m,completed:S,disabled:_}),C=Coe(P);return te.jsx(Aoe,re({className:Qt(C.root,i),ref:n,ownerState:P},a,{children:te.jsx(Ioe,{className:C.line,ownerState:P})}))}),Moe=koe;function Loe(t){return Fn("MuiStepper",t)}In("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const Roe=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],Ooe=t=>{const{orientation:e,nonLinear:n,alternativeLabel:r,classes:i}=t;return jn({root:["root",e,n&&"nonLinear",r&&"alternativeLabel"]},Loe,i)},zoe=_t("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel,n.nonLinear&&e.nonLinear]}})(({ownerState:t})=>re({display:"flex"},t.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},t.orientation==="vertical"&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})),Doe=te.jsx(Moe,{}),Foe=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiStepper"}),{activeStep:i=0,alternativeLabel:a=!1,children:h,className:l,component:m="div",connector:_=Doe,nonLinear:S=!1,orientation:P="horizontal"}=r,C=Gt(r,Roe),L=re({},r,{nonLinear:S,alternativeLabel:a,orientation:P,component:m}),R=Ooe(L),D=q.Children.toArray(h).filter(Boolean),W=D.map((N,F)=>q.cloneElement(N,re({index:F,last:F+1===D.length},N.props))),z=q.useMemo(()=>({activeStep:i,alternativeLabel:a,connector:_,nonLinear:S,orientation:P}),[i,a,_,S,P]);return te.jsx(Bv.Provider,{value:z,children:te.jsx(zoe,re({as:m,ownerState:L,className:Qt(R.root,l),ref:n},C,{children:W}))})}),Noe=Foe;function Boe(t){return Fn("MuiTextField",t)}In("MuiTextField",["root"]);const joe=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Voe={standard:hD,filled:aD,outlined:xD},Uoe=t=>{const{classes:e}=t;return jn({root:["root"]},Boe,e)},$oe=_t(lD,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Goe=q.forwardRef(function(e,n){const r=Nn({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:h,className:l,color:m="primary",defaultValue:_,disabled:S=!1,error:P=!1,FormHelperTextProps:C,fullWidth:L=!1,helperText:R,id:D,InputLabelProps:W,inputProps:z,InputProps:N,inputRef:F,label:$,maxRows:K,minRows:ne,multiline:se=!1,name:xe,onBlur:Se,onChange:_e,onFocus:Re,placeholder:De,required:Ve=!1,rows:je,select:We=!1,SelectProps:Ze,type:Ye,value:Ce,variant:Xe="outlined"}=r,lt=Gt(r,joe),Dt=re({},r,{autoFocus:a,color:m,disabled:S,error:P,fullWidth:L,multiline:se,required:Ve,select:We,variant:Xe}),mt=Uoe(Dt),ht={};Xe==="outlined"&&(W&&typeof W.shrink<"u"&&(ht.notched=W.shrink),ht.label=$),We&&((!Ze||!Ze.native)&&(ht.id=void 0),ht["aria-describedby"]=void 0);const ot=nT(D),xt=R&&ot?`${ot}-helper-text`:void 0,bt=$&&ot?`${ot}-label`:void 0,Wt=Voe[Xe],nt=te.jsx(Wt,re({"aria-describedby":xt,autoComplete:i,autoFocus:a,defaultValue:_,fullWidth:L,multiline:se,name:xe,rows:je,maxRows:K,minRows:ne,type:Ye,value:Ce,id:ot,inputRef:F,onBlur:Se,onChange:_e,onFocus:Re,placeholder:De,inputProps:z},ht,N));return te.jsxs($oe,re({className:Qt(mt.root,l),disabled:S,error:P,fullWidth:L,ref:n,required:Ve,color:m,variant:Xe,ownerState:Dt},lt,{children:[$!=null&&$!==""&&te.jsx(dD,re({htmlFor:ot,id:bt},W,{children:$})),We?te.jsx(wD,re({"aria-describedby":xt,id:ot,labelId:bt,value:Ce,input:nt},Ze,{children:h})):nt,R&&te.jsx(yre,re({id:xt},C,{children:R}))]}))}),Woe=Goe,Hoe="linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(135deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(135deg, transparent 75%, #ccc 75%) /*! @noflip */",qoe="linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, transparent) /*! @noflip */",Zoe={Button:_t(cu)(()=>({backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 0, 4px -4px, 0px 4px",transition:"none",boxShadow:"0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08)",border:0,borderRadius:4,width:"24px",aspectRatio:"1 / 1",height:"24px",minWidth:0}))},Xoe=t=>{const{bgColor:e,className:n,disablePopover:r,isBgColorValid:i,...a}=t;return te.jsx(Zoe.Button,{disableTouchRipple:!0,style:{backgroundColor:i?e:void 0,backgroundImage:i?void 0:Hoe,cursor:r?"default":void 0},className:`MuiColorInput-Button ${n||""}`,...a})},Yoe={Container:_t("div")(()=>({width:300,padding:8}))},Koe=({children:t,className:e,position:n="start",...r})=>te.jsx(mD,{className:`MuiColorInput-Popover ${e||""}`,anchorOrigin:{vertical:"bottom",horizontal:n==="start"?"left":"right"},transformOrigin:{vertical:"top",horizontal:n==="start"?"left":"right"},...r,children:te.jsx(Yoe.Container,{children:t})}),Joe={Slider:_t(ET,{shouldForwardProp:t=>t!=="$rgbaFrom"&&t!=="$rgbaTo"})(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 0) 0%, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 1) 100%)"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},Qoe=t=>{const{rgbColor:e,style:n,className:r,...i}=t,a={"--rgb-r":e.r,"--rgb-g":e.g,"--rgb-b":e.b,...n};return te.jsx(Joe.Slider,{className:`MuiColorInput-AlphaSlider ${r||""}`,style:a,...i})},Qy={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},eae={ArrowUp:{type:"hsvV",value:1},ArrowDown:{type:"hsvV",value:-1},ArrowLeft:{type:"hsvS",value:-1},ArrowRight:{type:"hsvS",value:1}};function tae(t){return t===Qy.up||t===Qy.down||t===Qy.left||t===Qy.right}function w_(t,e,n){return Math.max(e,Math.min(t,n))}function oM(t){return typeof t=="number"}function aM(t,e,n){const r=t.toLocaleString("en",{useGrouping:!1,minimumFractionDigits:e,maximumFractionDigits:n});return Number(r)}function nae(t,e,n){const r=t.getBoundingClientRect(),i=e-r.left,a=n-r.top;return{x:w_(i/r.width,0,1),y:w_(1-a/r.height,0,1)}}function rae(t){const e=cr.useRef();return e.current=t,cr.useCallback((...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}const lM={Space:_t("div")(()=>({width:"100%",height:"180px",boxSizing:"border-box",outline:0,position:"relative",backgroundImage:qoe})),Thumb:_t("div")(()=>({position:"absolute",border:"3px solid #ffffff",borderRadius:"50%",width:"20px",height:"20px",marginLeft:"-10px /*! @noflip */",marginBottom:"-10px /*! @noflip */",outline:0,boxSizing:"border-box",willChange:"left, bottom",transition:"box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:hover":{boxShadow:"0px 0px 0px 4px rgba(255 255 255 / 0.16)"},"&.MuiColorInput-Thumb-active":{boxShadow:"0px 0px 0px 8px rgba(255 255 255 / 0.16)"},"@media (hover: none)":{boxShadow:"none"}}))},iae=t=>{const{hsv:e,onChange:n,currentHue:r}=t,i=cr.useRef(!1),a=cr.useRef(null),[h,l]=cr.useState(!1),m=rae((D,W)=>{if(!a.current)return;const{x:z,y:N}=nae(a.current,D,W);n({s:z,v:N}),a.current&&document.activeElement!==a.current&&a.current.focus()}),_=cr.useCallback(()=>{i.current&&(i.current=!1,l(!1))},[]),S=cr.useCallback(D=>{i.current&&m(D.clientX,D.clientY)},[]);cr.useEffect(()=>(document.addEventListener("pointermove",S,!1),document.addEventListener("pointerup",_,!1),()=>{document.removeEventListener("pointermove",S,!1),document.removeEventListener("pointerup",_,!1)}),[_,S]);const P=D=>{D.preventDefault(),i.current=!0,m(D.clientX,D.clientY),l(!0)},C=D=>{if(tae(D.key)){D.preventDefault();const{type:W,value:z}=eae[D.key],N=D.shiftKey?10:1,F=W==="hsvS"?e.s:e.v,$=w_(F+z*N*.01,0,1);l(!0),n({s:W==="hsvS"?$:e.s,v:W==="hsvV"?$:e.v})}},L=e.s*100,R=e.v*100;return te.jsx(lM.Space,{onPointerDown:P,ref:a,className:"MuiColorInput-ColorSpace",style:{backgroundColor:`hsl(${r} 100% 50%)`,touchAction:"none"},role:"slider","aria-valuetext":`Saturation ${aM(L,0,0)}%, Brightness ${aM(R,0,0)}%`,onKeyDown:C,tabIndex:0,children:te.jsx(lM.Thumb,{"aria-label":"Color space thumb",className:h?"MuiColorInput-Thumb-active":"",style:{left:`${L}%`,bottom:`${R}%`}})})},sae={Slider:_t(ET)(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%) /*! @noflip */"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},oae=t=>{const{className:e,...n}=t;return te.jsx(sae.Slider,{className:`MuiColorInput-HueSlider ${e||""}`,...n})};function aae(t){return typeof t=="string"}function Vi(t,e){lae(t)&&(t="100%");const n=cae(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function e0(t){return Math.min(1,Math.max(0,t))}function lae(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function cae(t){return typeof t=="string"&&t.indexOf("%")!==-1}function ED(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function t0(t){return Number(t)<=1?`${Number(t)*100}%`:t}function _u(t){return t.length===1?"0"+t:String(t)}function uae(t,e,n){return{r:Vi(t,255)*255,g:Vi(e,255)*255,b:Vi(n,255)*255}}function cM(t,e,n){t=Vi(t,255),e=Vi(e,255),n=Vi(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0,h=0;const l=(r+i)/2;if(r===i)h=0,a=0;else{const m=r-i;switch(h=l>.5?m/(2-r-i):m/(r+i),r){case t:a=(e-n)/m+(e<n?6:0);break;case e:a=(n-t)/m+2;break;case n:a=(t-e)/m+4;break}a/=6}return{h:a,s:h,l}}function h1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function hae(t,e,n){let r,i,a;if(t=Vi(t,360),e=Vi(e,100),n=Vi(n,100),e===0)i=n,a=n,r=n;else{const h=n<.5?n*(1+e):n+e-n*e,l=2*n-h;r=h1(l,h,t+1/3),i=h1(l,h,t),a=h1(l,h,t-1/3)}return{r:r*255,g:i*255,b:a*255}}function uM(t,e,n){t=Vi(t,255),e=Vi(e,255),n=Vi(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0;const h=r,l=r-i,m=r===0?0:l/r;if(r===i)a=0;else{switch(r){case t:a=(e-n)/l+(e<n?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4;break}a/=6}return{h:a,s:m,v:h}}function dae(t,e,n){t=Vi(t,360)*6,e=Vi(e,100),n=Vi(n,100);const r=Math.floor(t),i=t-r,a=n*(1-e),h=n*(1-i*e),l=n*(1-(1-i)*e),m=r%6,_=[n,h,a,a,l,n][m],S=[l,n,n,h,a,a][m],P=[a,a,l,n,n,h][m];return{r:_*255,g:S*255,b:P*255}}function hM(t,e,n,r){const i=[_u(Math.round(t).toString(16)),_u(Math.round(e).toString(16)),_u(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function fae(t,e,n,r,i){const a=[_u(Math.round(t).toString(16)),_u(Math.round(e).toString(16)),_u(Math.round(n).toString(16)),_u(pae(r))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function pae(t){return Math.round(parseFloat(t)*255).toString(16)}function dM(t){return Xs(t)/255}function Xs(t){return parseInt(t,16)}function mae(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}const oS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function gae(t){let e={r:0,g:0,b:0},n=1,r=null,i=null,a=null,h=!1,l=!1;return typeof t=="string"&&(t=vae(t)),typeof t=="object"&&(nl(t.r)&&nl(t.g)&&nl(t.b)?(e=uae(t.r,t.g,t.b),h=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):nl(t.h)&&nl(t.s)&&nl(t.v)?(r=t0(t.s),i=t0(t.v),e=dae(t.h,r,i),h=!0,l="hsv"):nl(t.h)&&nl(t.s)&&nl(t.l)&&(r=t0(t.s),a=t0(t.l),e=hae(t.h,r,a),h=!0,l="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=ED(n),{ok:h,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}const yae="[-\\+]?\\d+%?",_ae="[-\\+]?\\d*\\.\\d+%?",hc="(?:"+_ae+")|(?:"+yae+")",d1="[\\s|\\(]+("+hc+")[,|\\s]+("+hc+")[,|\\s]+("+hc+")\\s*\\)?",f1="[\\s|\\(]+("+hc+")[,|\\s]+("+hc+")[,|\\s]+("+hc+")[,|\\s]+("+hc+")\\s*\\)?",na={CSS_UNIT:new RegExp(hc),rgb:new RegExp("rgb"+d1),rgba:new RegExp("rgba"+f1),hsl:new RegExp("hsl"+d1),hsla:new RegExp("hsla"+f1),hsv:new RegExp("hsv"+d1),hsva:new RegExp("hsva"+f1),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function vae(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;let e=!1;if(oS[t])t=oS[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let n=na.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=na.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=na.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=na.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=na.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=na.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=na.hex8.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),a:dM(n[4]),format:e?"name":"hex8"}:(n=na.hex6.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),format:e?"name":"hex"}:(n=na.hex4.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),a:dM(n[4]+n[4]),format:e?"name":"hex8"}:(n=na.hex3.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function nl(t){return!!na.CSS_UNIT.exec(String(t))}class lr{constructor(e="",n={}){if(e instanceof lr)return e;typeof e=="number"&&(e=mae(e)),this.originalInput=e;const r=gae(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=n.format??r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){const e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3}getLuminance(){const e=this.toRgb();let n,r,i;const a=e.r/255,h=e.g/255,l=e.b/255;return a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),h<=.03928?r=h/12.92:r=Math.pow((h+.055)/1.055,2.4),l<=.03928?i=l/12.92:i=Math.pow((l+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i}getAlpha(){return this.a}setAlpha(e){return this.a=ED(e),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){const{s:e}=this.toHsl();return e===0}toHsv(){const e=uM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){const e=uM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?`hsv(${n}, ${r}%, ${i}%)`:`hsva(${n}, ${r}%, ${i}%, ${this.roundA})`}toHsl(){const e=cM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){const e=cM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?`hsl(${n}, ${r}%, ${i}%)`:`hsla(${n}, ${r}%, ${i}%, ${this.roundA})`}toHex(e=!1){return hM(this.r,this.g,this.b,e)}toHexString(e=!1){return"#"+this.toHex(e)}toHex8(e=!1){return fae(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return"#"+this.toHex8(e)}toHexShortString(e=!1){return this.a===1?this.toHexString(e):this.toHex8String(e)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?`rgb(${e}, ${n}, ${r})`:`rgba(${e}, ${n}, ${r}, ${this.roundA})`}toPercentageRgb(){const e=n=>`${Math.round(Vi(n,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){const e=n=>Math.round(Vi(n,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const e="#"+hM(this.r,this.g,this.b,!1);for(const[n,r]of Object.entries(oS))if(e===r)return n;return!1}toString(e){const n=!!e;e=e??this.format;let r=!1;const i=this.a<1&&this.a>=0;return!n&&i&&(e.startsWith("hex")||e==="name")?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new lr(this.toString())}lighten(e=10){const n=this.toHsl();return n.l+=e/100,n.l=e0(n.l),new lr(n)}brighten(e=10){const n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new lr(n)}darken(e=10){const n=this.toHsl();return n.l-=e/100,n.l=e0(n.l),new lr(n)}tint(e=10){return this.mix("white",e)}shade(e=10){return this.mix("black",e)}desaturate(e=10){const n=this.toHsl();return n.s-=e/100,n.s=e0(n.s),new lr(n)}saturate(e=10){const n=this.toHsl();return n.s+=e/100,n.s=e0(n.s),new lr(n)}greyscale(){return this.desaturate(100)}spin(e){const n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new lr(n)}mix(e,n=50){const r=this.toRgb(),i=new lr(e).toRgb(),a=n/100,h={r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a};return new lr(h)}analogous(e=6,n=30){const r=this.toHsl(),i=360/n,a=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(new lr(r));return a}complement(){const e=this.toHsl();return e.h=(e.h+180)%360,new lr(e)}monochromatic(e=6){const n=this.toHsv(),{h:r}=n,{s:i}=n;let{v:a}=n;const h=[],l=1/e;for(;e--;)h.push(new lr({h:r,s:i,v:a})),a=(a+l)%1;return h}splitcomplement(){const e=this.toHsl(),{h:n}=e;return[this,new lr({h:(n+72)%360,s:e.s,l:e.l}),new lr({h:(n+216)%360,s:e.s,l:e.l})]}onBackground(e){const n=this.toRgb(),r=new lr(e).toRgb(),i=n.a+r.a*(1-n.a);return new lr({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(e){const n=this.toHsl(),{h:r}=n,i=[this],a=360/e;for(let h=1;h<e;h++)i.push(new lr({h:(r+h*a)%360,s:n.s,l:n.l}));return i}equals(e){return this.toRgbString()===new lr(e).toRgbString()}}function pd(t,e){return t.toString(e)}function fM(t,e,n){return new lr(t,n)}function xae(t){return aae(t)?t:new lr(t).toString()}const bae=t=>{const{currentColor:e,format:n,onChange:r,isAlphaHidden:i}=t,[a,h]=cr.useState(e.toHsv()),l=(S,P)=>{if(!oM(P))return;const C=w_(360*P/100,0,359);h(R=>({...R,h:C}));const L=new lr({...a,a:e.toHsv().a,h:C});r==null||r(pd(L,n))},m=(S,P)=>{if(!oM(P))return;const C=e.clone().setAlpha(P);r==null||r(pd(C,n))},_=({s:S,v:P})=>{const C=new lr({h:a.h,a:e.toHsv().a,s:S,v:P});h(L=>({...L,s:S,v:P})),r==null||r(pd(C,n))};return te.jsxs(n1,{className:"MuiColorInput-PopoverBody",children:[te.jsx(iae,{currentHue:a.h,hsv:a,onChange:_}),te.jsx(n1,{mt:"10px",px:"3px",children:te.jsx(oae,{min:0,max:100,step:1,onChange:l,"aria-label":"hue",value:a.h*100/360})}),i?null:te.jsx(n1,{mt:"10px",px:"3px",children:te.jsx(Qoe,{min:0,max:1,step:.01,"aria-label":"alpha",rgbColor:e.toRgb(),onChange:m,value:e.getAlpha()})})]})},wae=cr.forwardRef((t,e)=>{const{className:n,...r}=t;return te.jsx(Woe,{className:`MuiColorInput-TextField ${n||""}`,ref:e,...r})}),Sae="black",Tae="rgb";function Eae(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function pM(t,e){typeof e=="function"?e(t):e&&Eae(e)&&"current"in e&&(e.current=t)}const Fh=cr.forwardRef((t,e)=>{const{value:n,format:r,onChange:i,adornmentPosition:a="start",PopoverProps:h,Adornment:l=Xoe,fallbackValue:m,isAlphaHidden:_,disablePopover:S,...P}=t,{onBlur:C,InputProps:L,...R}=P,{onClose:D,...W}=h||{},z=m||Sae,N=R.disabled||(L==null?void 0:L.disabled)||!1,F=cr.useRef(null),$=cr.useRef(null),[K,ne]=cr.useState(null),se=r||Tae,xe=fM(n,z,{format:se}),[Se,_e]=cr.useState(n),[Re,De]=cr.useState(n),Ve=xt=>{xt.preventDefault(),xt.stopPropagation(),!N&&!S&&ne(F.current)},je=xt=>{const bt=new lr(xt);i==null||i(xt,{hex:bt.isValid?bt.toHexString():"",hsv:bt.isValid?bt.toHsvString():"",hsl:bt.isValid?bt.toHslString():"",rgb:bt.isValid?bt.toRgbString():"",hex8:bt.isValid?bt.toHex8String():""})},We=xt=>{const bt=xt.target.value;if(_e(bt),bt==="")De(""),je("");else{const Wt=new lr(bt),nt=pd(Wt,se);De(nt),je(nt)}},Ze=(...xt)=>{D==null||D(...xt),ne(null),queueMicrotask(()=>{var bt;(bt=$.current)==null||bt.focus()})},Ye=xt=>{C==null||C(xt);const bt=new lr(Se);if(bt.isValid)bt.format!==se&&_e(pd(bt,se));else{if(Se==="")return;const Wt=new lr(z),nt=pd(Wt,se);_e(nt),De(nt),je(nt)}};cr.useEffect(()=>{if(n!==Re){const xt=fM(n).originalInput;De(xt),_e(xt)}},[n,Re,z]);const Ce=xt=>{_e(xt),De(xt),je(xt)},Xe=xt=>{F.current=xt,e&&pM(xt,e)},lt=xt=>{$.current=xt,$&&pM(xt,$)},Dt=!!K,mt=Dt?"color-popover":void 0,ht=te.jsx(Bre,{position:a,children:te.jsx(l,{disabled:N,"aria-describedby":mt,disablePopover:S||!1,component:S?"span":void 0,bgColor:xe.toString(),isBgColorValid:!!(Se!==""&&xe.isValid),onClick:S?void 0:Ve})}),ot=a==="start"?{startAdornment:ht}:{endAdornment:ht};return te.jsxs(te.Fragment,{children:[te.jsx(wae,{ref:Xe,spellCheck:"false",type:"text",autoComplete:"off",onChange:We,value:xae(Se),onBlur:Ye,inputRef:lt,disabled:N,InputProps:{...ot,...L},...R}),S?null:te.jsx(Koe,{id:mt,open:Dt,position:a,anchorEl:K,onClose:Ze,...W,children:te.jsx(bae,{onChange:Ce,currentColor:xe,format:se,isAlphaHidden:_})})]})}),Pae=Uo(te.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),Cae=Uo(te.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),Nh=Uo(te.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay"),Aae=Uo(te.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings"),Iae=_t(ET)(()=>({color:"#46B780","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:`0px 0px 0px 8px ${qI("#46B780",.16)}`},"&.Mui-active":{boxShadow:`0px 0px 0px 14px ${qI("#46B780",.16)}`}},"& .MuiSlider-rail":{color:"#A8AFB3",opacity:1}}));function p1({disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChange:h,onChangeCommited:l,defaultValue:m,marks:_,style:S}){return te.jsx(Iae,{disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChangeCommitted:l,onChange:h,defaultValue:m,marks:_,style:S})}const kae="./map_style.json",Mae={longitude:-16.504,latitude:-68.131,zoom:13,pitch:0,bearing:0},uu={startNodeFill:[70,183,128],startNodeBorder:[255,255,255],endNodeFill:[152,4,12],endNodeBorder:[0,0,0],path:[70,183,128],route:[165,13,32]},Lae=[{name:"La Paz",latitude:-16.504,longitude:-68.131},{name:"Viacha",latitude:-16.65,longitude:-68.297},{name:"Sta. Cruz",latitude:-17.783,longitude:-63.182}],PD=q.forwardRef(({canStart:t,started:e,animationEnded:n,playbackOn:r,time:i,maxTime:a,settings:h,colors:l,loading:m,timeChanged:_,cinematic:S,placeEnd:P,changeRadius:C,changeAlgorithm:L,setPlaceEnd:R,setCinematic:D,setSettings:W,setColors:z,startPathfinding:N,toggleAnimation:F,clearPath:$,changeLocation:K},ne)=>{const[se,xe]=q.useState(!1),[Se,_e]=q.useState({open:!1,message:"",type:"error"}),[Re,De]=q.useState(!1),[Ve,je]=q.useState(0),[We,Ze]=q.useState(!1),[Ye,Ce]=q.useState(null),Xe=!!Ye,lt=q.useRef(4800),Dt=q.useRef(!1),mt=q.useRef(!1);q.useImperativeHandle(ne,()=>({showSnack(nt,Et="error"){_e({open:!0,message:nt,type:Et})}}));function ht(){_e({...Se,open:!1})}function ot(){Ze(!1)}function xt(nt){if(Ve>=2&&nt>0){De(!1);return}je(Math.max(Ve+nt,0))}function bt(){if(t){if(!e&&i===0){N();return}F()}}function Wt(){Ce(null)}return window.onkeydown=nt=>{nt.code==="ArrowRight"&&!Dt.current&&!mt.current&&(!e||n)?(Dt.current=!0,F(!1,1)):nt.code==="ArrowLeft"&&!mt.current&&!Dt.current&&n&&(mt.current=!0,F(!1,-1))},window.onkeyup=nt=>{nt.code==="Escape"?D(!1):nt.code==="Space"?(nt.preventDefault(),bt()):nt.code==="ArrowRight"&&Dt.current?(Dt.current=!1,F(!1,1)):nt.code==="ArrowLeft"&&n&&mt.current?(mt.current=!1,F(!1,1)):nt.code==="KeyR"&&(n||!e)&&$()},q.useEffect(()=>{S&&(Ze(!0),setTimeout(()=>{lt.current=2500},200))},[S]),q.useEffect(()=>{localStorage.getItem("path_sawtutorial")||(De(!0),localStorage.setItem("path_sawtutorial",!0))},[]),te.jsxs(te.Fragment,{children:[te.jsxs("div",{className:`nav-top ${S?"cinematic":""}`,children:[te.jsxs("div",{className:"side slider-container",children:[te.jsx(xs,{id:"playback-slider",gutterBottom:!0,children:"Animacion"}),te.jsx(p1,{disabled:!n,value:n?i:a,min:n?0:-1,max:a,onChange:nt=>{_(Number(nt.target.value))},className:"slider","aria-labelledby":"playback-slider"})]}),te.jsx(rl,{disabled:!t,onClick:bt,style:{backgroundColor:"#46B780",width:60,height:60},size:"large",children:!e||n&&!r?te.jsx(Cae,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"}):te.jsx(Pae,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"})}),te.jsx("div",{className:"side",children:te.jsx(cu,{disabled:!n&&e,onClick:$,style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:"Limpiar"})})]}),te.jsx("div",{className:`nav-right ${S?"cinematic":""}`,children:te.jsx(eoe,{title:"Open settings",children:te.jsx(rl,{onClick:()=>{xe(!0)},style:{backgroundColor:"#2A2B37",width:36,height:36},size:"large",children:te.jsx(Aae,{style:{color:"#fff",width:24,height:24},fontSize:"inherit"})})})}),te.jsx("div",{className:"loader-container",children:te.jsx(eD,{in:m,style:{transitionDelay:m?"50ms":"0ms"},unmountOnExit:!0,children:te.jsx(hne,{color:"inherit"})})}),te.jsx(rM,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:Se.open,autoHideDuration:4e3,onClose:ht,children:te.jsx(LQ,{onClose:ht,severity:Se.type,style:{width:"100%",color:"#fff"},children:Se.message})}),te.jsx(rM,{anchorOrigin:{vertical:"top",horizontal:"center"},open:We,autoHideDuration:lt.current,onClose:ot,children:te.jsxs("div",{className:"cinematic-alert",children:[te.jsx(xs,{fontSize:"18px",children:te.jsx("b",{children:"Cinematic mode"})}),te.jsx(xs,{children:"Use keyboard shortcuts to control animation"}),te.jsxs(xs,{children:["Press ",te.jsx("b",{children:"Escape"})," to exit"]})]})}),te.jsx("div",{className:"mobile-controls",children:te.jsx(cu,{onClick:()=>{R(!P)},style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:P?"Nodo final":"Nodo inicial"})}),te.jsx(tD,{open:Re,onClick:nt=>{nt.target.classList.contains("backdrop")&&De(!1)},className:"backdrop",children:te.jsxs("div",{className:"tutorial-container",children:[te.jsxs(Noe,{activeStep:Ve,children:[te.jsx(a1,{children:te.jsx(u1,{children:"Basic controls"})}),te.jsx(a1,{children:te.jsx(u1,{children:"Playback controls"})}),te.jsx(a1,{children:te.jsx(u1,{children:"Changing settings"})})]}),te.jsxs("div",{className:"content",children:[te.jsx("h1",{children:"Map Pathfinding Visualizer"}),Ve===0&&te.jsxs("div",{children:[te.jsxs("p",{children:[te.jsx("b",{children:"Controls:"})," ",te.jsx("br",{}),te.jsx("b",{children:"Left button:"})," Place start node ",te.jsx("br",{}),te.jsx("b",{children:"Right button:"})," Place end node ",te.jsx("br",{})]}),te.jsx("p",{children:"The end node must be placed within the shown radius."}),te.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:te.jsx("source",{src:"./videos/tutorial1.mp4",type:"video/mp4"})})]}),Ve===1&&te.jsxs("div",{children:[te.jsxs("p",{children:["To start the visualization, press the ",te.jsx("b",{children:"Start Button"})," or press ",te.jsx("b",{children:"Space"}),".",te.jsx("br",{}),"A playback feature is available after the algorithm ends."]}),te.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:te.jsx("source",{src:"./videos/tutorial2.mp4",type:"video/mp4"})})]}),Ve===2&&te.jsxs("div",{children:[te.jsxs("p",{children:["You can customize the settings of the animation in the ",te.jsx("b",{children:"Settings Sidebar"}),". ",te.jsx("br",{}),"Try to keep the area radius only as large as you need it to be. ",te.jsx("br",{}),"Anything above ",te.jsx("b",{children:"10km"})," is considered experimental, if you run into performance issues, stop the animation and clear the path."]}),te.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:te.jsx("source",{src:"./videos/tutorial3.mp4",type:"video/mp4"})})]})]}),te.jsxs("div",{className:"controls",children:[te.jsx(cu,{onClick:()=>{De(!1)},className:"close",variant:"outlined",style:{borderColor:"#9f9f9f",color:"#9f9f9f",paddingInline:15},children:"Close"}),te.jsx(cu,{onClick:()=>{xt(-1)},variant:"outlined",style:{borderColor:"#9f9f9f",color:"#9f9f9f",paddingInline:18},children:"Back"}),te.jsx(cu,{onClick:()=>{xt(1)},variant:"contained",style:{backgroundColor:"#46B780",color:"#fff",paddingInline:30,fontWeight:"bold"},children:Ve>=2?"Finish":"Next"})]})]})}),te.jsx(tre,{className:`side-drawer ${S?"cinematic":""}`,anchor:"left",open:se,onClose:()=>{xe(!1)},children:te.jsxs("div",{className:"sidebar-container",children:[te.jsxs(lD,{variant:"filled",children:[te.jsx(dD,{style:{fontSize:14},id:"algo-select",children:"Algoritmo"}),te.jsxs(wD,{labelId:"algo-select",value:h.algorithm,onChange:nt=>{L(nt.target.value)},required:!0,style:{backgroundColor:"#404156",color:"#fff",width:"100%",paddingLeft:1},inputProps:{MenuProps:{MenuListProps:{sx:{backgroundColor:"#404156"}}}},size:"small",disabled:!n&&e,children:[te.jsx(xp,{value:"astar",children:"A *"}),te.jsx(xp,{value:"greedy",children:"Greedy"}),te.jsx(xp,{value:"dijkstra",children:"Dijkstra"}),te.jsx(xp,{value:"bidirectional",children:"Busqueda bidireccional"})]})]}),te.jsxs("div",{children:[te.jsx(cu,{id:"locations-button","aria-controls":Xe?"locations-menu":void 0,"aria-haspopup":"true","aria-expanded":Xe?"true":void 0,onClick:nt=>{Ce(nt.currentTarget)},variant:"contained",disableElevation:!0,style:{backgroundColor:"#404156",color:"#fff",textTransform:"none",fontSize:16,paddingBlock:8,justifyContent:"start"},children:"Localizaciones"}),te.jsx(gD,{id:"locations-menu",anchorEl:Ye,open:Xe,onClose:()=>{Ce(null)},MenuListProps:{"aria-labelledby":"locations-button",sx:{backgroundColor:"#404156"}},anchorOrigin:{vertical:"top",horizontal:"right"},children:Lae.map(nt=>te.jsx(xp,{onClick:()=>{Wt(),K(nt)},children:nt.name},nt.name))})]}),te.jsxs("div",{className:"side slider-container",children:[te.jsxs(xs,{id:"area-slider",children:["Radio del Area: ",h.radius,"km (",(h.radius/1.609).toFixed(1),"mi)"]}),te.jsx(p1,{disabled:e&&!n,min:2,max:20,step:1,value:h.radius,onChangeCommited:()=>{C(h.radius)},onChange:nt=>{W({...h,radius:Number(nt.target.value)})},className:"slider","aria-labelledby":"area-slider",style:{marginBottom:1},marks:[{value:2,label:"2km"},{value:20,label:"20km"}]})]}),te.jsxs("div",{className:"side slider-container",children:[te.jsx(xs,{id:"speed-slider",children:"Velocidad de animacion"}),te.jsx(p1,{min:1,max:30,value:h.speed,onChange:nt=>{W({...h,speed:Number(nt.target.value)})},className:"slider","aria-labelledby":"speed-slider",style:{marginBottom:1}})]}),te.jsxs("div",{className:"styles-container",children:[te.jsx(xs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Styles"}),te.jsxs("div",{children:[te.jsx(xs,{id:"start-fill-label",children:"Nodo inicial"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.startNodeFill),onChange:nt=>{z({...l,startNodeFill:Ih(nt)})},"aria-labelledby":"start-fill-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,startNodeFill:uu.startNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),te.jsxs("div",{children:[te.jsx(xs,{id:"start-border-label",children:"Borde del nodo inicial"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.startNodeBorder),onChange:nt=>{z({...l,startNodeBorder:Ih(nt)})},"aria-labelledby":"start-border-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,startNodeBorder:uu.startNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),te.jsxs("div",{children:[te.jsx(xs,{id:"end-fill-label",children:"Nodo final"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.endNodeFill),onChange:nt=>{z({...l,endNodeFill:Ih(nt)})},"aria-labelledby":"end-fill-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,endNodeFill:uu.endNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),te.jsxs("div",{children:[te.jsx(xs,{id:"end-border-label",children:"Borde del nodo final"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.endNodeBorder),onChange:nt=>{z({...l,endNodeBorder:Ih(nt)})},"aria-labelledby":"end-border-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,endNodeBorder:uu.endNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),te.jsxs("div",{children:[te.jsx(xs,{id:"path-label",children:"Rutas"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.path),onChange:nt=>{z({...l,path:Ih(nt)})},"aria-labelledby":"path-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,path:uu.path})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),te.jsxs("div",{children:[te.jsx(xs,{id:"route-label",children:"Ruta mas corta"}),te.jsxs("div",{className:"color-container",children:[te.jsx(Fh,{value:kh(l.route),onChange:nt=>{z({...l,route:Ih(nt)})},"aria-labelledby":"route-label",style:{backgroundColor:"#404156"}}),te.jsx(rl,{onClick:()=>{z({...l,route:uu.route})},style:{backgroundColor:"transparent"},size:"small",children:te.jsx(Nh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]})]}),te.jsxs("div",{className:"shortcuts-container",children:[te.jsx(xs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Atajos"}),te.jsxs("div",{className:"shortcut",children:[te.jsx("p",{children:"Espacio"}),te.jsx("p",{children:"Iniciar/Parar animacion"})]}),te.jsxs("div",{className:"shortcut",children:[te.jsx("p",{children:"R"}),te.jsx("p",{children:"Limpiar"})]}),te.jsxs("div",{className:"shortcut",children:[te.jsx("p",{children:"Flechas"}),te.jsx("p",{children:"Animacion"})]})]})]})})]})});PD.displayName="Interface";function Rae(t,e,n,r,i,a){const[h,l]=q.useState(t),m=Date.now(),_=q.useRef();return q.useEffect(()=>{function S(){const C=Date.now()-m;if(C<r){const L=C/r,R=a?n+L*(e-n):e+L*(n-e);l(R),_.current=requestAnimationFrame(S)}else l(a?e:n)}if(i)return _.current=requestAnimationFrame(S),()=>{cancelAnimationFrame(_.current)}},[e,n,r,i,a]),h}function Oae(){const[t,e]=q.useState(null),[n,r]=q.useState(null),[i,a]=q.useState([]),[h,l]=q.useState([]),[m,_]=q.useState(),[S,P]=q.useState(0),[C,L]=q.useState(!1),[R,D]=q.useState(!1),[W,z]=q.useState(1),[N,F]=q.useState(!1),[$,K]=q.useState(!1),[ne,se]=q.useState(!1),[xe,Se]=q.useState(!1),[_e,Re]=q.useState({algorithm:"astar",radius:4,speed:5}),[De,Ve]=q.useState(uu),[je,We]=q.useState(Mae),Ze=q.useRef(),Ye=q.useRef(),Ce=q.useRef(),Xe=q.useRef(),lt=q.useRef(0),Dt=q.useRef([]),mt=q.useRef(new $w),ht=q.useRef(null),ot=q.useRef(null),xt=Rae(0,0,1,400,Ye.current,N);async function bt(ut,un,Ae=null){var kt;if(m&&!C)return;if(F(!1),Ye.current=!0,Et(),un.rightButton||ne){if(((kt=ut.layer)==null?void 0:kt.id)!=="selection-radius"){Ze.current.showSnack("Seleccione un punto dentro del radio","info");return}if(xe){Ze.current.showSnack("Espere un momento","info");return}const Ln=setTimeout(()=>{Se(!0)},300),Un=await kI(ut.coordinate[1],ut.coordinate[0]);if(!Un){Ze.current.showSnack("Error. No se encontraron rutas"),clearTimeout(Ln),Se(!1);return}const zn=mt.current.getNode(Un.id);if(r(Un),clearTimeout(Ln),Se(!1),!zn){Ze.current.showSnack("Intente de nuevo porfavor.");return}mt.current.endNode=zn;return}const Ct=setTimeout(()=>{Se(!0)},300),bn=await kI(ut.coordinate[1],ut.coordinate[0]);if(!bn){Ze.current.showSnack("Error. No se encontraron rutas"),clearTimeout(Ct),Se(!1);return}e(bn),r(null);const Yt=zO([bn.lon,bn.lat],Ae??_e.radius);a([{contour:Yt}]),aZ(FO(Yt),bn.id).then(Ln=>{mt.current.graph=Ln,Et(),clearTimeout(Ct),Se(!1)})}function Wt(){F(!0),setTimeout(()=>{Et(),mt.current.start(_e.algorithm),_(!0)},400)}function nt(ut=!0,un=1){if(!(S===0&&!C)){if(z(un),C){ut&&S>=lt.current&&P(0),_(!0),D(!R);return}_(!m),m&&(Xe.current=null)}}function Et(){_(!1),l([]),P(0),mt.current.reset(),Dt.current=[],lt.current=0,Xe.current=null,ht.current=null,ot.current=null,L(!1)}function cn(ut){const un=mt.current.nextStep();for(const Ae of un)mn(Ae,Ae.referer);if(mt.current.finished&&!C)if(_e.algorithm==="bidirectional"){ht.current||(ht.current=un[0]);const Ae=ht.current.parent;mn(Ae,ht.current,"route",Math.max(Math.log2(_e.speed),1)),ht.current=Ae??ht.current,ot.current||(ot.current=un[0],ot.current.parent=ot.current.prevParent);const Ct=ot.current.parent;mn(Ct,ot.current,"route",Math.max(Math.log2(_e.speed),1)),ot.current=Ct??ot.current,L(S>=lt.current&&Ae==null&&Ct==null)}else{ht.current||(ht.current=mt.current.endNode);const Ae=ht.current.parent;mn(Ae,ht.current,"route",Math.max(Math.log2(_e.speed),1)),ht.current=Ae??ht.current,L(S>=lt.current&&Ae==null)}if(Xe.current!=null&&!C){const Ae=ut-Xe.current;P(Ct=>Ct+Ae*W)}if(Xe.current!=null&&C&&R){const Ae=ut-Xe.current;S>=lt.current&&W!==-1&&D(!1),P(Ct=>Math.max(Math.min(Ct+Ae*2*W,lt.current),0))}}function en(ut){for(let un=0;un<_e.speed;un++)cn(ut);Xe.current=ut,Ce.current=requestAnimationFrame(en)}function mn(ut,un,Ae="path",Ct=1){if(!ut||!un)return;const Yt=Math.hypot(ut.longitude-un.longitude,ut.latitude-un.latitude)*5e4*Ct;Dt.current=[...Dt.current,{path:[[un.longitude,un.latitude],[ut.longitude,ut.latitude]],timestamps:[lt.current,lt.current+Yt],color:Ae}],lt.current+=Yt,l(()=>Dt.current)}function Ht(ut){We({...je,longitude:ut.longitude,latitude:ut.latitude,zoom:13,transitionDuration:1,transitionInterpolator:new mH})}function It(ut){Re(ut);const un={settings:ut,colors:De};localStorage.setItem("path_settings",JSON.stringify(un))}function Rt(ut){Ve(ut);const un={settings:_e,colors:ut};localStorage.setItem("path_settings",JSON.stringify(un))}function yn(ut){Et(),It({..._e,algorithm:ut})}function vn(ut){It({..._e,radius:ut}),t&&bt({coordinate:[t.lon,t.lat]},{},ut)}return q.useEffect(()=>{if(m)return Ce.current=requestAnimationFrame(en),()=>cancelAnimationFrame(Ce.current)},[m,S,C,R]),q.useEffect(()=>{navigator.geolocation.getCurrentPosition(Ae=>{Ht(Ae.coords)});const ut=localStorage.getItem("path_settings");if(!ut)return;const un=JSON.parse(ut);Re(un.settings),Ve(un.colors)},[]),te.jsxs(te.Fragment,{children:[te.jsx("div",{onContextMenu:ut=>{ut.preventDefault()},children:te.jsxs(AH,{initialViewState:je,controller:{doubleClickZoom:!1,keyboard:!1},onClick:bt,children:[te.jsx(F2,{id:"selection-radius",data:i,pickable:!0,stroked:!0,getPolygon:ut=>ut.contour,getFillColor:[80,210,0,10],getLineColor:[9,142,46,175],getLineWidth:3,opacity:xt}),te.jsx(N2,{id:"pathfinding-layer",data:h,opacity:1,widthMinPixels:3,widthMaxPixels:5,fadeTrail:!1,currentTime:S,getColor:ut=>De[ut.color],updateTriggers:{getColor:[De.path,De.route]}}),te.jsx(O2,{id:"start-end-points",data:[...t?[{coordinates:[t.lon,t.lat],color:De.startNodeFill,lineColor:De.startNodeBorder}]:[],...n?[{coordinates:[n.lon,n.lat],color:De.endNodeFill,lineColor:De.endNodeBorder}]:[]],pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1,radiusMinPixels:7,radiusMaxPixels:20,lineWidthMinPixels:1,lineWidthMaxPixels:3,getPosition:ut=>ut.coordinates,getFillColor:ut=>ut.color,getLineColor:ut=>ut.lineColor}),te.jsx(tq,{reuseMaps:!0,mapLib:rq,mapStyle:kae,doubleClickZoom:!1})]})}),te.jsx(PD,{ref:Ze,canStart:t&&n,started:m,animationEnded:C,playbackOn:R,time:S,startPathfinding:Wt,toggleAnimation:nt,clearPath:Et,timeChanged:P,changeLocation:Ht,maxTime:lt.current,settings:_e,setSettings:It,changeAlgorithm:yn,colors:De,setColors:Rt,loading:xe,cinematic:$,setCinematic:K,placeEnd:ne,setPlaceEnd:se,changeRadius:vn})]})}const zae=aT({palette:{mode:"dark"}});function Dae(){return te.jsxs(PJ,{theme:zae,children:[te.jsx(yne,{}),te.jsx(Oae,{})]})}g1.createRoot(document.getElementById("root")).render(te.jsx(cr.StrictMode,{children:te.jsx(Dae,{})}));
