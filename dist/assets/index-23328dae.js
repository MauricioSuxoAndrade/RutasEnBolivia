var QE=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var Vx=(t,e,n)=>(QE(t,e,"read from private field"),n?n.call(t):e.get(t)),eP=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},tP=(t,e,n,r)=>(QE(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function aM(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var h5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Im(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ec(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var lM={exports:{}},w_={},cM={exports:{}},Dn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km=Symbol.for("react.element"),d5=Symbol.for("react.portal"),f5=Symbol.for("react.fragment"),p5=Symbol.for("react.strict_mode"),m5=Symbol.for("react.profiler"),g5=Symbol.for("react.provider"),y5=Symbol.for("react.context"),_5=Symbol.for("react.forward_ref"),v5=Symbol.for("react.suspense"),x5=Symbol.for("react.memo"),b5=Symbol.for("react.lazy"),nP=Symbol.iterator;function w5(t){return t===null||typeof t!="object"?null:(t=nP&&t[nP]||t["@@iterator"],typeof t=="function"?t:null)}var uM={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hM=Object.assign,dM={};function Vd(t,e,n){this.props=t,this.context=e,this.refs=dM,this.updater=n||uM}Vd.prototype.isReactComponent={};Vd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Vd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fM(){}fM.prototype=Vd.prototype;function eS(t,e,n){this.props=t,this.context=e,this.refs=dM,this.updater=n||uM}var tS=eS.prototype=new fM;tS.constructor=eS;hM(tS,Vd.prototype);tS.isPureReactComponent=!0;var rP=Array.isArray,pM=Object.prototype.hasOwnProperty,nS={current:null},mM={key:!0,ref:!0,__self:!0,__source:!0};function gM(t,e,n){var r,i={},a=null,h=null;if(e!=null)for(r in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(a=""+e.key),e)pM.call(e,r)&&!mM.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var m=Array(l),_=0;_<l;_++)m[_]=arguments[_+2];i.children=m}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:km,type:t,key:a,ref:h,props:i,_owner:nS.current}}function S5(t,e){return{$$typeof:km,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rS(t){return typeof t=="object"&&t!==null&&t.$$typeof===km}function T5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var iP=/\/+/g;function Ux(t,e){return typeof t=="object"&&t!==null&&t.key!=null?T5(""+t.key):e.toString(36)}function e0(t,e,n,r,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var h=!1;if(t===null)h=!0;else switch(a){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case km:case d5:h=!0}}if(h)return h=t,i=i(h),t=r===""?"."+Ux(h,0):r,rP(i)?(n="",t!=null&&(n=t.replace(iP,"$&/")+"/"),e0(i,e,n,"",function(_){return _})):i!=null&&(rS(i)&&(i=S5(i,n+(!i.key||h&&h.key===i.key?"":(""+i.key).replace(iP,"$&/")+"/")+t)),e.push(i)),1;if(h=0,r=r===""?".":r+":",rP(t))for(var l=0;l<t.length;l++){a=t[l];var m=r+Ux(a,l);h+=e0(a,e,n,m,i)}else if(m=w5(t),typeof m=="function")for(t=m.call(t),l=0;!(a=t.next()).done;)a=a.value,m=r+Ux(a,l++),h+=e0(a,e,n,m,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function sy(t,e,n){if(t==null)return t;var r=[],i=0;return e0(t,r,"","",function(a){return e.call(n,a,i++)}),r}function E5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Es={current:null},t0={transition:null},P5={ReactCurrentDispatcher:Es,ReactCurrentBatchConfig:t0,ReactCurrentOwner:nS};function yM(){throw Error("act(...) is not supported in production builds of React.")}Dn.Children={map:sy,forEach:function(t,e,n){sy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return sy(t,function(){e++}),e},toArray:function(t){return sy(t,function(e){return e})||[]},only:function(t){if(!rS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Dn.Component=Vd;Dn.Fragment=f5;Dn.Profiler=m5;Dn.PureComponent=eS;Dn.StrictMode=p5;Dn.Suspense=v5;Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P5;Dn.act=yM;Dn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=hM({},t.props),i=t.key,a=t.ref,h=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,h=nS.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(m in e)pM.call(e,m)&&!mM.hasOwnProperty(m)&&(r[m]=e[m]===void 0&&l!==void 0?l[m]:e[m])}var m=arguments.length-2;if(m===1)r.children=n;else if(1<m){l=Array(m);for(var _=0;_<m;_++)l[_]=arguments[_+2];r.children=l}return{$$typeof:km,type:t.type,key:i,ref:a,props:r,_owner:h}};Dn.createContext=function(t){return t={$$typeof:y5,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:g5,_context:t},t.Consumer=t};Dn.createElement=gM;Dn.createFactory=function(t){var e=gM.bind(null,t);return e.type=t,e};Dn.createRef=function(){return{current:null}};Dn.forwardRef=function(t){return{$$typeof:_5,render:t}};Dn.isValidElement=rS;Dn.lazy=function(t){return{$$typeof:b5,_payload:{_status:-1,_result:t},_init:E5}};Dn.memo=function(t,e){return{$$typeof:x5,type:t,compare:e===void 0?null:e}};Dn.startTransition=function(t){var e=t0.transition;t0.transition={};try{t()}finally{t0.transition=e}};Dn.unstable_act=yM;Dn.useCallback=function(t,e){return Es.current.useCallback(t,e)};Dn.useContext=function(t){return Es.current.useContext(t)};Dn.useDebugValue=function(){};Dn.useDeferredValue=function(t){return Es.current.useDeferredValue(t)};Dn.useEffect=function(t,e){return Es.current.useEffect(t,e)};Dn.useId=function(){return Es.current.useId()};Dn.useImperativeHandle=function(t,e,n){return Es.current.useImperativeHandle(t,e,n)};Dn.useInsertionEffect=function(t,e){return Es.current.useInsertionEffect(t,e)};Dn.useLayoutEffect=function(t,e){return Es.current.useLayoutEffect(t,e)};Dn.useMemo=function(t,e){return Es.current.useMemo(t,e)};Dn.useReducer=function(t,e,n){return Es.current.useReducer(t,e,n)};Dn.useRef=function(t){return Es.current.useRef(t)};Dn.useState=function(t){return Es.current.useState(t)};Dn.useSyncExternalStore=function(t,e,n){return Es.current.useSyncExternalStore(t,e,n)};Dn.useTransition=function(){return Es.current.useTransition()};Dn.version="18.3.1";cM.exports=Dn;var Z=cM.exports;const cr=Im(Z),c1=aM({__proto__:null,default:cr},[Z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C5=Z,A5=Symbol.for("react.element"),I5=Symbol.for("react.fragment"),k5=Object.prototype.hasOwnProperty,M5=C5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L5={key:!0,ref:!0,__self:!0,__source:!0};function _M(t,e,n){var r,i={},a=null,h=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(h=e.ref);for(r in e)k5.call(e,r)&&!L5.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:A5,type:t,key:a,ref:h,props:i,_owner:M5.current}}w_.Fragment=I5;w_.jsx=_M;w_.jsxs=_M;lM.exports=w_;var ue=lM.exports,u1={},vM={exports:{}},co={},xM={exports:{}},bM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ce,qe){var st=Ce.length;Ce.push(qe);e:for(;0<st;){var Vt=st-1>>>1,_t=Ce[Vt];if(0<i(_t,qe))Ce[Vt]=qe,Ce[st]=_t,st=Vt;else break e}}function n(Ce){return Ce.length===0?null:Ce[0]}function r(Ce){if(Ce.length===0)return null;var qe=Ce[0],st=Ce.pop();if(st!==qe){Ce[0]=st;e:for(var Vt=0,_t=Ce.length,ht=_t>>>1;Vt<ht;){var at=2*(Vt+1)-1,Qe=Ce[at],xt=at+1,Ht=Ce[xt];if(0>i(Qe,st))xt<_t&&0>i(Ht,Qe)?(Ce[Vt]=Ht,Ce[xt]=st,Vt=xt):(Ce[Vt]=Qe,Ce[at]=st,Vt=at);else if(xt<_t&&0>i(Ht,st))Ce[Vt]=Ht,Ce[xt]=st,Vt=xt;else break e}}return qe}function i(Ce,qe){var st=Ce.sortIndex-qe.sortIndex;return st!==0?st:Ce.id-qe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var h=Date,l=h.now();t.unstable_now=function(){return h.now()-l}}var m=[],_=[],S=1,P=null,A=3,L=!1,O=!1,D=!1,W=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(Ce){for(var qe=n(_);qe!==null;){if(qe.callback===null)r(_);else if(qe.startTime<=Ce)r(_),qe.sortIndex=qe.expirationTime,e(m,qe);else break;qe=n(_)}}function $(Ce){if(D=!1,F(Ce),!O)if(n(m)!==null)O=!0,Ze(Q);else{var qe=n(_);qe!==null&&Ye($,qe.startTime-Ce)}}function Q(Ce,qe){O=!1,D&&(D=!1,z(xe),xe=-1),L=!0;var st=A;try{for(F(qe),P=n(m);P!==null&&(!(P.expirationTime>qe)||Ce&&!Re());){var Vt=P.callback;if(typeof Vt=="function"){P.callback=null,A=P.priorityLevel;var _t=Vt(P.expirationTime<=qe);qe=t.unstable_now(),typeof _t=="function"?P.callback=_t:P===n(m)&&r(m),F(qe)}else r(m);P=n(m)}if(P!==null)var ht=!0;else{var at=n(_);at!==null&&Ye($,at.startTime-qe),ht=!1}return ht}finally{P=null,A=st,L=!1}}var te=!1,ie=null,xe=-1,Te=5,_e=-1;function Re(){return!(t.unstable_now()-_e<Te)}function Ne(){if(ie!==null){var Ce=t.unstable_now();_e=Ce;var qe=!0;try{qe=ie(!0,Ce)}finally{qe?Ve():(te=!1,ie=null)}}else te=!1}var Ve;if(typeof N=="function")Ve=function(){N(Ne)};else if(typeof MessageChannel<"u"){var je=new MessageChannel,Ge=je.port2;je.port1.onmessage=Ne,Ve=function(){Ge.postMessage(null)}}else Ve=function(){W(Ne,0)};function Ze(Ce){ie=Ce,te||(te=!0,Ve())}function Ye(Ce,qe){xe=W(function(){Ce(t.unstable_now())},qe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ce){Ce.callback=null},t.unstable_continueExecution=function(){O||L||(O=!0,Ze(Q))},t.unstable_forceFrameRate=function(Ce){0>Ce||125<Ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Te=0<Ce?Math.floor(1e3/Ce):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(Ce){switch(A){case 1:case 2:case 3:var qe=3;break;default:qe=A}var st=A;A=qe;try{return Ce()}finally{A=st}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ce,qe){switch(Ce){case 1:case 2:case 3:case 4:case 5:break;default:Ce=3}var st=A;A=Ce;try{return qe()}finally{A=st}},t.unstable_scheduleCallback=function(Ce,qe,st){var Vt=t.unstable_now();switch(typeof st=="object"&&st!==null?(st=st.delay,st=typeof st=="number"&&0<st?Vt+st:Vt):st=Vt,Ce){case 1:var _t=-1;break;case 2:_t=250;break;case 5:_t=1073741823;break;case 4:_t=1e4;break;default:_t=5e3}return _t=st+_t,Ce={id:S++,callback:qe,priorityLevel:Ce,startTime:st,expirationTime:_t,sortIndex:-1},st>Vt?(Ce.sortIndex=st,e(_,Ce),n(m)===null&&Ce===n(_)&&(D?(z(xe),xe=-1):D=!0,Ye($,st-Vt))):(Ce.sortIndex=_t,e(m,Ce),O||L||(O=!0,Ze(Q))),Ce},t.unstable_shouldYield=Re,t.unstable_wrapCallback=function(Ce){var qe=A;return function(){var st=A;A=qe;try{return Ce.apply(this,arguments)}finally{A=st}}}})(bM);xM.exports=bM;var R5=xM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O5=Z,ao=R5;function ft(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wM=new Set,Hp={};function Mu(t,e){pd(t,e),pd(t+"Capture",e)}function pd(t,e){for(Hp[t]=e,t=0;t<e.length;t++)wM.add(e[t])}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h1=Object.prototype.hasOwnProperty,z5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sP={},oP={};function D5(t){return h1.call(oP,t)?!0:h1.call(sP,t)?!1:z5.test(t)?oP[t]=!0:(sP[t]=!0,!1)}function F5(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function N5(t,e,n,r){if(e===null||typeof e>"u"||F5(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ps(t,e,n,r,i,a,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=h}var Ui={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ui[t]=new Ps(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ui[e]=new Ps(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ui[t]=new Ps(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ui[t]=new Ps(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ui[t]=new Ps(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ui[t]=new Ps(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ui[t]=new Ps(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ui[t]=new Ps(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ui[t]=new Ps(t,5,!1,t.toLowerCase(),null,!1,!1)});var iS=/[\-:]([a-z])/g;function sS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(iS,sS);Ui[e]=new Ps(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(iS,sS);Ui[e]=new Ps(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(iS,sS);Ui[e]=new Ps(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ui[t]=new Ps(t,1,!1,t.toLowerCase(),null,!1,!1)});Ui.xlinkHref=new Ps("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ui[t]=new Ps(t,1,!1,t.toLowerCase(),null,!0,!0)});function oS(t,e,n,r){var i=Ui.hasOwnProperty(e)?Ui[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(N5(e,n,i,r)&&(n=null),r||i===null?D5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wl=O5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oy=Symbol.for("react.element"),Bh=Symbol.for("react.portal"),jh=Symbol.for("react.fragment"),aS=Symbol.for("react.strict_mode"),d1=Symbol.for("react.profiler"),SM=Symbol.for("react.provider"),TM=Symbol.for("react.context"),lS=Symbol.for("react.forward_ref"),f1=Symbol.for("react.suspense"),p1=Symbol.for("react.suspense_list"),cS=Symbol.for("react.memo"),Ql=Symbol.for("react.lazy"),EM=Symbol.for("react.offscreen"),aP=Symbol.iterator;function Jf(t){return t===null||typeof t!="object"?null:(t=aP&&t[aP]||t["@@iterator"],typeof t=="function"?t:null)}var Br=Object.assign,$x;function bp(t){if($x===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$x=e&&e[1]||""}return`
`+$x+t}var Gx=!1;function Wx(t,e){if(!t||Gx)return"";Gx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var r=_}Reflect.construct(t,[],e)}else{try{e.call()}catch(_){r=_}t.call(e.prototype)}else{try{throw Error()}catch(_){r=_}t()}}catch(_){if(_&&r&&typeof _.stack=="string"){for(var i=_.stack.split(`
`),a=r.stack.split(`
`),h=i.length-1,l=a.length-1;1<=h&&0<=l&&i[h]!==a[l];)l--;for(;1<=h&&0<=l;h--,l--)if(i[h]!==a[l]){if(h!==1||l!==1)do if(h--,l--,0>l||i[h]!==a[l]){var m=`
`+i[h].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=h&&0<=l);break}}}finally{Gx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?bp(t):""}function B5(t){switch(t.tag){case 5:return bp(t.type);case 16:return bp("Lazy");case 13:return bp("Suspense");case 19:return bp("SuspenseList");case 0:case 2:case 15:return t=Wx(t.type,!1),t;case 11:return t=Wx(t.type.render,!1),t;case 1:return t=Wx(t.type,!0),t;default:return""}}function m1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jh:return"Fragment";case Bh:return"Portal";case d1:return"Profiler";case aS:return"StrictMode";case f1:return"Suspense";case p1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case TM:return(t.displayName||"Context")+".Consumer";case SM:return(t._context.displayName||"Context")+".Provider";case lS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cS:return e=t.displayName||null,e!==null?e:m1(t.type)||"Memo";case Ql:e=t._payload,t=t._init;try{return m1(t(e))}catch{}}return null}function j5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return m1(e);case 8:return e===aS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function PM(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function V5(t){var e=PM(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(h){r=""+h,a.call(this,h)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ay(t){t._valueTracker||(t._valueTracker=V5(t))}function CM(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=PM(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function A0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function g1(t,e){var n=e.checked;return Br({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function lP(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=wc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function AM(t,e){e=e.checked,e!=null&&oS(t,"checked",e,!1)}function y1(t,e){AM(t,e);var n=wc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_1(t,e.type,n):e.hasOwnProperty("defaultValue")&&_1(t,e.type,wc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _1(t,e,n){(e!=="number"||A0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var wp=Array.isArray;function nd(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+wc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function v1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ft(91));return Br({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function uP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ft(92));if(wp(n)){if(1<n.length)throw Error(ft(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:wc(n)}}function IM(t,e){var n=wc(e.value),r=wc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function hP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kM(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function x1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kM(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ly,MM=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ly=ly||document.createElement("div"),ly.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ly.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ip={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U5=["Webkit","ms","Moz","O"];Object.keys(Ip).forEach(function(t){U5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ip[e]=Ip[t]})});function LM(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ip.hasOwnProperty(t)&&Ip[t]?(""+e).trim():e+"px"}function RM(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=LM(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var $5=Br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function b1(t,e){if(e){if($5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ft(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ft(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ft(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ft(62))}}function w1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var S1=null;function uS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var T1=null,rd=null,id=null;function dP(t){if(t=Rm(t)){if(typeof T1!="function")throw Error(ft(280));var e=t.stateNode;e&&(e=C_(e),T1(t.stateNode,t.type,e))}}function OM(t){rd?id?id.push(t):id=[t]:rd=t}function zM(){if(rd){var t=rd,e=id;if(id=rd=null,dP(t),e)for(t=0;t<e.length;t++)dP(e[t])}}function DM(t,e){return t(e)}function FM(){}var Hx=!1;function NM(t,e,n){if(Hx)return t(e,n);Hx=!0;try{return DM(t,e,n)}finally{Hx=!1,(rd!==null||id!==null)&&(FM(),zM())}}function Zp(t,e){var n=t.stateNode;if(n===null)return null;var r=C_(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ft(231,e,typeof n));return n}var E1=!1;if(hl)try{var Qf={};Object.defineProperty(Qf,"passive",{get:function(){E1=!0}}),window.addEventListener("test",Qf,Qf),window.removeEventListener("test",Qf,Qf)}catch{E1=!1}function G5(t,e,n,r,i,a,h,l,m){var _=Array.prototype.slice.call(arguments,3);try{e.apply(n,_)}catch(S){this.onError(S)}}var kp=!1,I0=null,k0=!1,P1=null,W5={onError:function(t){kp=!0,I0=t}};function H5(t,e,n,r,i,a,h,l,m){kp=!1,I0=null,G5.apply(W5,arguments)}function q5(t,e,n,r,i,a,h,l,m){if(H5.apply(this,arguments),kp){if(kp){var _=I0;kp=!1,I0=null}else throw Error(ft(198));k0||(k0=!0,P1=_)}}function Lu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function BM(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fP(t){if(Lu(t)!==t)throw Error(ft(188))}function Z5(t){var e=t.alternate;if(!e){if(e=Lu(t),e===null)throw Error(ft(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return fP(i),t;if(a===r)return fP(i),e;a=a.sibling}throw Error(ft(188))}if(n.return!==r.return)n=i,r=a;else{for(var h=!1,l=i.child;l;){if(l===n){h=!0,n=i,r=a;break}if(l===r){h=!0,r=i,n=a;break}l=l.sibling}if(!h){for(l=a.child;l;){if(l===n){h=!0,n=a,r=i;break}if(l===r){h=!0,r=a,n=i;break}l=l.sibling}if(!h)throw Error(ft(189))}}if(n.alternate!==r)throw Error(ft(190))}if(n.tag!==3)throw Error(ft(188));return n.stateNode.current===n?t:e}function jM(t){return t=Z5(t),t!==null?VM(t):null}function VM(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=VM(t);if(e!==null)return e;t=t.sibling}return null}var UM=ao.unstable_scheduleCallback,pP=ao.unstable_cancelCallback,X5=ao.unstable_shouldYield,Y5=ao.unstable_requestPaint,oi=ao.unstable_now,K5=ao.unstable_getCurrentPriorityLevel,hS=ao.unstable_ImmediatePriority,$M=ao.unstable_UserBlockingPriority,M0=ao.unstable_NormalPriority,J5=ao.unstable_LowPriority,GM=ao.unstable_IdlePriority,S_=null,Ma=null;function Q5(t){if(Ma&&typeof Ma.onCommitFiberRoot=="function")try{Ma.onCommitFiberRoot(S_,t,void 0,(t.current.flags&128)===128)}catch{}}var aa=Math.clz32?Math.clz32:n4,e4=Math.log,t4=Math.LN2;function n4(t){return t>>>=0,t===0?32:31-(e4(t)/t4|0)|0}var cy=64,uy=4194304;function Sp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function L0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,h=n&268435455;if(h!==0){var l=h&~i;l!==0?r=Sp(l):(a&=h,a!==0&&(r=Sp(a)))}else h=n&~i,h!==0?r=Sp(h):a!==0&&(r=Sp(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-aa(e),i=1<<n,r|=t[n],e&=~i;return r}function r4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function i4(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var h=31-aa(a),l=1<<h,m=i[h];m===-1?(!(l&n)||l&r)&&(i[h]=r4(l,e)):m<=e&&(t.expiredLanes|=l),a&=~l}}function C1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function WM(){var t=cy;return cy<<=1,!(cy&4194240)&&(cy=64),t}function qx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Mm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-aa(e),t[e]=n}function s4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-aa(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}function dS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-aa(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var tr=0;function HM(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qM,fS,ZM,XM,YM,A1=!1,hy=[],hc=null,dc=null,fc=null,Xp=new Map,Yp=new Map,tc=[],o4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mP(t,e){switch(t){case"focusin":case"focusout":hc=null;break;case"dragenter":case"dragleave":dc=null;break;case"mouseover":case"mouseout":fc=null;break;case"pointerover":case"pointerout":Xp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yp.delete(e.pointerId)}}function ep(t,e,n,r,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Rm(e),e!==null&&fS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function a4(t,e,n,r,i){switch(e){case"focusin":return hc=ep(hc,t,e,n,r,i),!0;case"dragenter":return dc=ep(dc,t,e,n,r,i),!0;case"mouseover":return fc=ep(fc,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Xp.set(a,ep(Xp.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Yp.set(a,ep(Yp.get(a)||null,t,e,n,r,i)),!0}return!1}function KM(t){var e=uu(t.target);if(e!==null){var n=Lu(e);if(n!==null){if(e=n.tag,e===13){if(e=BM(n),e!==null){t.blockedOn=e,YM(t.priority,function(){ZM(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function n0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=I1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);S1=r,n.target.dispatchEvent(r),S1=null}else return e=Rm(n),e!==null&&fS(e),t.blockedOn=n,!1;e.shift()}return!0}function gP(t,e,n){n0(t)&&n.delete(e)}function l4(){A1=!1,hc!==null&&n0(hc)&&(hc=null),dc!==null&&n0(dc)&&(dc=null),fc!==null&&n0(fc)&&(fc=null),Xp.forEach(gP),Yp.forEach(gP)}function tp(t,e){t.blockedOn===e&&(t.blockedOn=null,A1||(A1=!0,ao.unstable_scheduleCallback(ao.unstable_NormalPriority,l4)))}function Kp(t){function e(i){return tp(i,t)}if(0<hy.length){tp(hy[0],t);for(var n=1;n<hy.length;n++){var r=hy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(hc!==null&&tp(hc,t),dc!==null&&tp(dc,t),fc!==null&&tp(fc,t),Xp.forEach(e),Yp.forEach(e),n=0;n<tc.length;n++)r=tc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<tc.length&&(n=tc[0],n.blockedOn===null);)KM(n),n.blockedOn===null&&tc.shift()}var sd=wl.ReactCurrentBatchConfig,R0=!0;function c4(t,e,n,r){var i=tr,a=sd.transition;sd.transition=null;try{tr=1,pS(t,e,n,r)}finally{tr=i,sd.transition=a}}function u4(t,e,n,r){var i=tr,a=sd.transition;sd.transition=null;try{tr=4,pS(t,e,n,r)}finally{tr=i,sd.transition=a}}function pS(t,e,n,r){if(R0){var i=I1(t,e,n,r);if(i===null)rb(t,e,r,O0,n),mP(t,r);else if(a4(i,t,e,n,r))r.stopPropagation();else if(mP(t,r),e&4&&-1<o4.indexOf(t)){for(;i!==null;){var a=Rm(i);if(a!==null&&qM(a),a=I1(t,e,n,r),a===null&&rb(t,e,r,O0,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else rb(t,e,r,null,n)}}var O0=null;function I1(t,e,n,r){if(O0=null,t=uS(r),t=uu(t),t!==null)if(e=Lu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=BM(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return O0=t,null}function JM(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(K5()){case hS:return 1;case $M:return 4;case M0:case J5:return 16;case GM:return 536870912;default:return 16}default:return 16}}var ic=null,mS=null,r0=null;function QM(){if(r0)return r0;var t,e=mS,n=e.length,r,i="value"in ic?ic.value:ic.textContent,a=i.length;for(t=0;t<n&&e[t]===i[t];t++);var h=n-t;for(r=1;r<=h&&e[n-r]===i[a-r];r++);return r0=i.slice(t,1<r?1-r:void 0)}function i0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function dy(){return!0}function yP(){return!1}function uo(t){function e(n,r,i,a,h){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=h,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?dy:yP,this.isPropagationStopped=yP,this}return Br(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=dy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=dy)},persist:function(){},isPersistent:dy}),e}var Ud={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gS=uo(Ud),Lm=Br({},Ud,{view:0,detail:0}),h4=uo(Lm),Zx,Xx,np,T_=Br({},Lm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==np&&(np&&t.type==="mousemove"?(Zx=t.screenX-np.screenX,Xx=t.screenY-np.screenY):Xx=Zx=0,np=t),Zx)},movementY:function(t){return"movementY"in t?t.movementY:Xx}}),_P=uo(T_),d4=Br({},T_,{dataTransfer:0}),f4=uo(d4),p4=Br({},Lm,{relatedTarget:0}),Yx=uo(p4),m4=Br({},Ud,{animationName:0,elapsedTime:0,pseudoElement:0}),g4=uo(m4),y4=Br({},Ud,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_4=uo(y4),v4=Br({},Ud,{data:0}),vP=uo(v4),x4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},b4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=w4[t])?!!e[t]:!1}function yS(){return S4}var T4=Br({},Lm,{key:function(t){if(t.key){var e=x4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=i0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?b4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yS,charCode:function(t){return t.type==="keypress"?i0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?i0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),E4=uo(T4),P4=Br({},T_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xP=uo(P4),C4=Br({},Lm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yS}),A4=uo(C4),I4=Br({},Ud,{propertyName:0,elapsedTime:0,pseudoElement:0}),k4=uo(I4),M4=Br({},T_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),L4=uo(M4),R4=[9,13,27,32],_S=hl&&"CompositionEvent"in window,Mp=null;hl&&"documentMode"in document&&(Mp=document.documentMode);var O4=hl&&"TextEvent"in window&&!Mp,eL=hl&&(!_S||Mp&&8<Mp&&11>=Mp),bP=String.fromCharCode(32),wP=!1;function tL(t,e){switch(t){case"keyup":return R4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vh=!1;function z4(t,e){switch(t){case"compositionend":return nL(e);case"keypress":return e.which!==32?null:(wP=!0,bP);case"textInput":return t=e.data,t===bP&&wP?null:t;default:return null}}function D4(t,e){if(Vh)return t==="compositionend"||!_S&&tL(t,e)?(t=QM(),r0=mS=ic=null,Vh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eL&&e.locale!=="ko"?null:e.data;default:return null}}var F4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!F4[t.type]:e==="textarea"}function rL(t,e,n,r){OM(r),e=z0(e,"onChange"),0<e.length&&(n=new gS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Lp=null,Jp=null;function N4(t){pL(t,0)}function E_(t){var e=Gh(t);if(CM(e))return t}function B4(t,e){if(t==="change")return e}var iL=!1;if(hl){var Kx;if(hl){var Jx="oninput"in document;if(!Jx){var TP=document.createElement("div");TP.setAttribute("oninput","return;"),Jx=typeof TP.oninput=="function"}Kx=Jx}else Kx=!1;iL=Kx&&(!document.documentMode||9<document.documentMode)}function EP(){Lp&&(Lp.detachEvent("onpropertychange",sL),Jp=Lp=null)}function sL(t){if(t.propertyName==="value"&&E_(Jp)){var e=[];rL(e,Jp,t,uS(t)),NM(N4,e)}}function j4(t,e,n){t==="focusin"?(EP(),Lp=e,Jp=n,Lp.attachEvent("onpropertychange",sL)):t==="focusout"&&EP()}function V4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return E_(Jp)}function U4(t,e){if(t==="click")return E_(e)}function $4(t,e){if(t==="input"||t==="change")return E_(e)}function G4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ua=typeof Object.is=="function"?Object.is:G4;function Qp(t,e){if(ua(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h1.call(e,i)||!ua(t[i],e[i]))return!1}return!0}function PP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function CP(t,e){var n=PP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=PP(n)}}function oL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aL(){for(var t=window,e=A0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=A0(t.document)}return e}function vS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function W4(t){var e=aL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oL(n.ownerDocument.documentElement,n)){if(r!==null&&vS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=CP(n,a);var h=CP(n,r);i&&h&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==h.node||t.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var H4=hl&&"documentMode"in document&&11>=document.documentMode,Uh=null,k1=null,Rp=null,M1=!1;function AP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;M1||Uh==null||Uh!==A0(r)||(r=Uh,"selectionStart"in r&&vS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rp&&Qp(Rp,r)||(Rp=r,r=z0(k1,"onSelect"),0<r.length&&(e=new gS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Uh)))}function fy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $h={animationend:fy("Animation","AnimationEnd"),animationiteration:fy("Animation","AnimationIteration"),animationstart:fy("Animation","AnimationStart"),transitionend:fy("Transition","TransitionEnd")},Qx={},lL={};hl&&(lL=document.createElement("div").style,"AnimationEvent"in window||(delete $h.animationend.animation,delete $h.animationiteration.animation,delete $h.animationstart.animation),"TransitionEvent"in window||delete $h.transitionend.transition);function P_(t){if(Qx[t])return Qx[t];if(!$h[t])return t;var e=$h[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lL)return Qx[t]=e[n];return t}var cL=P_("animationend"),uL=P_("animationiteration"),hL=P_("animationstart"),dL=P_("transitionend"),fL=new Map,IP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pc(t,e){fL.set(t,e),Mu(e,[t])}for(var eb=0;eb<IP.length;eb++){var tb=IP[eb],q4=tb.toLowerCase(),Z4=tb[0].toUpperCase()+tb.slice(1);Pc(q4,"on"+Z4)}Pc(cL,"onAnimationEnd");Pc(uL,"onAnimationIteration");Pc(hL,"onAnimationStart");Pc("dblclick","onDoubleClick");Pc("focusin","onFocus");Pc("focusout","onBlur");Pc(dL,"onTransitionEnd");pd("onMouseEnter",["mouseout","mouseover"]);pd("onMouseLeave",["mouseout","mouseover"]);pd("onPointerEnter",["pointerout","pointerover"]);pd("onPointerLeave",["pointerout","pointerover"]);Mu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tp));function kP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,q5(r,e,void 0,t),t.currentTarget=null}function pL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var h=r.length-1;0<=h;h--){var l=r[h],m=l.instance,_=l.currentTarget;if(l=l.listener,m!==a&&i.isPropagationStopped())break e;kP(i,l,_),a=m}else for(h=0;h<r.length;h++){if(l=r[h],m=l.instance,_=l.currentTarget,l=l.listener,m!==a&&i.isPropagationStopped())break e;kP(i,l,_),a=m}}}if(k0)throw t=P1,k0=!1,P1=null,t}function Sr(t,e){var n=e[D1];n===void 0&&(n=e[D1]=new Set);var r=t+"__bubble";n.has(r)||(mL(e,t,2,!1),n.add(r))}function nb(t,e,n){var r=0;e&&(r|=4),mL(n,t,r,e)}var py="_reactListening"+Math.random().toString(36).slice(2);function em(t){if(!t[py]){t[py]=!0,wM.forEach(function(n){n!=="selectionchange"&&(X4.has(n)||nb(n,!1,t),nb(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[py]||(e[py]=!0,nb("selectionchange",!1,e))}}function mL(t,e,n,r){switch(JM(e)){case 1:var i=c4;break;case 4:i=u4;break;default:i=pS}n=i.bind(null,e,n,t),i=void 0,!E1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function rb(t,e,n,r,i){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(h===4)for(h=r.return;h!==null;){var m=h.tag;if((m===3||m===4)&&(m=h.stateNode.containerInfo,m===i||m.nodeType===8&&m.parentNode===i))return;h=h.return}for(;l!==null;){if(h=uu(l),h===null)return;if(m=h.tag,m===5||m===6){r=a=h;continue e}l=l.parentNode}}r=r.return}NM(function(){var _=a,S=uS(n),P=[];e:{var A=fL.get(t);if(A!==void 0){var L=gS,O=t;switch(t){case"keypress":if(i0(n)===0)break e;case"keydown":case"keyup":L=E4;break;case"focusin":O="focus",L=Yx;break;case"focusout":O="blur",L=Yx;break;case"beforeblur":case"afterblur":L=Yx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=_P;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=f4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=A4;break;case cL:case uL:case hL:L=g4;break;case dL:L=k4;break;case"scroll":L=h4;break;case"wheel":L=L4;break;case"copy":case"cut":case"paste":L=_4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=xP}var D=(e&4)!==0,W=!D&&t==="scroll",z=D?A!==null?A+"Capture":null:A;D=[];for(var N=_,F;N!==null;){F=N;var $=F.stateNode;if(F.tag===5&&$!==null&&(F=$,z!==null&&($=Zp(N,z),$!=null&&D.push(tm(N,$,F)))),W)break;N=N.return}0<D.length&&(A=new L(A,O,null,n,S),P.push({event:A,listeners:D}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",L=t==="mouseout"||t==="pointerout",A&&n!==S1&&(O=n.relatedTarget||n.fromElement)&&(uu(O)||O[dl]))break e;if((L||A)&&(A=S.window===S?S:(A=S.ownerDocument)?A.defaultView||A.parentWindow:window,L?(O=n.relatedTarget||n.toElement,L=_,O=O?uu(O):null,O!==null&&(W=Lu(O),O!==W||O.tag!==5&&O.tag!==6)&&(O=null)):(L=null,O=_),L!==O)){if(D=_P,$="onMouseLeave",z="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(D=xP,$="onPointerLeave",z="onPointerEnter",N="pointer"),W=L==null?A:Gh(L),F=O==null?A:Gh(O),A=new D($,N+"leave",L,n,S),A.target=W,A.relatedTarget=F,$=null,uu(S)===_&&(D=new D(z,N+"enter",O,n,S),D.target=F,D.relatedTarget=W,$=D),W=$,L&&O)t:{for(D=L,z=O,N=0,F=D;F;F=xh(F))N++;for(F=0,$=z;$;$=xh($))F++;for(;0<N-F;)D=xh(D),N--;for(;0<F-N;)z=xh(z),F--;for(;N--;){if(D===z||z!==null&&D===z.alternate)break t;D=xh(D),z=xh(z)}D=null}else D=null;L!==null&&MP(P,A,L,D,!1),O!==null&&W!==null&&MP(P,W,O,D,!0)}}e:{if(A=_?Gh(_):window,L=A.nodeName&&A.nodeName.toLowerCase(),L==="select"||L==="input"&&A.type==="file")var Q=B4;else if(SP(A))if(iL)Q=$4;else{Q=V4;var te=j4}else(L=A.nodeName)&&L.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(Q=U4);if(Q&&(Q=Q(t,_))){rL(P,Q,n,S);break e}te&&te(t,A,_),t==="focusout"&&(te=A._wrapperState)&&te.controlled&&A.type==="number"&&_1(A,"number",A.value)}switch(te=_?Gh(_):window,t){case"focusin":(SP(te)||te.contentEditable==="true")&&(Uh=te,k1=_,Rp=null);break;case"focusout":Rp=k1=Uh=null;break;case"mousedown":M1=!0;break;case"contextmenu":case"mouseup":case"dragend":M1=!1,AP(P,n,S);break;case"selectionchange":if(H4)break;case"keydown":case"keyup":AP(P,n,S)}var ie;if(_S)e:{switch(t){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else Vh?tL(t,n)&&(xe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(xe="onCompositionStart");xe&&(eL&&n.locale!=="ko"&&(Vh||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&Vh&&(ie=QM()):(ic=S,mS="value"in ic?ic.value:ic.textContent,Vh=!0)),te=z0(_,xe),0<te.length&&(xe=new vP(xe,t,null,n,S),P.push({event:xe,listeners:te}),ie?xe.data=ie:(ie=nL(n),ie!==null&&(xe.data=ie)))),(ie=O4?z4(t,n):D4(t,n))&&(_=z0(_,"onBeforeInput"),0<_.length&&(S=new vP("onBeforeInput","beforeinput",null,n,S),P.push({event:S,listeners:_}),S.data=ie))}pL(P,e)})}function tm(t,e,n){return{instance:t,listener:e,currentTarget:n}}function z0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Zp(t,n),a!=null&&r.unshift(tm(t,a,i)),a=Zp(t,e),a!=null&&r.push(tm(t,a,i))),t=t.return}return r}function xh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function MP(t,e,n,r,i){for(var a=e._reactName,h=[];n!==null&&n!==r;){var l=n,m=l.alternate,_=l.stateNode;if(m!==null&&m===r)break;l.tag===5&&_!==null&&(l=_,i?(m=Zp(n,a),m!=null&&h.unshift(tm(n,m,l))):i||(m=Zp(n,a),m!=null&&h.push(tm(n,m,l)))),n=n.return}h.length!==0&&t.push({event:e,listeners:h})}var Y4=/\r\n?/g,K4=/\u0000|\uFFFD/g;function LP(t){return(typeof t=="string"?t:""+t).replace(Y4,`
`).replace(K4,"")}function my(t,e,n){if(e=LP(e),LP(t)!==e&&n)throw Error(ft(425))}function D0(){}var L1=null,R1=null;function O1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var z1=typeof setTimeout=="function"?setTimeout:void 0,J4=typeof clearTimeout=="function"?clearTimeout:void 0,RP=typeof Promise=="function"?Promise:void 0,Q4=typeof queueMicrotask=="function"?queueMicrotask:typeof RP<"u"?function(t){return RP.resolve(null).then(t).catch(eN)}:z1;function eN(t){setTimeout(function(){throw t})}function ib(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Kp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Kp(e)}function pc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function OP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var $d=Math.random().toString(36).slice(2),Ca="__reactFiber$"+$d,nm="__reactProps$"+$d,dl="__reactContainer$"+$d,D1="__reactEvents$"+$d,tN="__reactListeners$"+$d,nN="__reactHandles$"+$d;function uu(t){var e=t[Ca];if(e)return e;for(var n=t.parentNode;n;){if(e=n[dl]||n[Ca]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=OP(t);t!==null;){if(n=t[Ca])return n;t=OP(t)}return e}t=n,n=t.parentNode}return null}function Rm(t){return t=t[Ca]||t[dl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ft(33))}function C_(t){return t[nm]||null}var F1=[],Wh=-1;function Cc(t){return{current:t}}function Er(t){0>Wh||(t.current=F1[Wh],F1[Wh]=null,Wh--)}function vr(t,e){Wh++,F1[Wh]=t.current,t.current=e}var Sc={},ls=Cc(Sc),Ds=Cc(!1),wu=Sc;function md(t,e){var n=t.type.contextTypes;if(!n)return Sc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=e[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Fs(t){return t=t.childContextTypes,t!=null}function F0(){Er(Ds),Er(ls)}function zP(t,e,n){if(ls.current!==Sc)throw Error(ft(168));vr(ls,e),vr(Ds,n)}function gL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ft(108,j5(t)||"Unknown",i));return Br({},n,r)}function N0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Sc,wu=ls.current,vr(ls,t),vr(Ds,Ds.current),!0}function DP(t,e,n){var r=t.stateNode;if(!r)throw Error(ft(169));n?(t=gL(t,e,wu),r.__reactInternalMemoizedMergedChildContext=t,Er(Ds),Er(ls),vr(ls,t)):Er(Ds),vr(Ds,n)}var sl=null,A_=!1,sb=!1;function yL(t){sl===null?sl=[t]:sl.push(t)}function rN(t){A_=!0,yL(t)}function Ac(){if(!sb&&sl!==null){sb=!0;var t=0,e=tr;try{var n=sl;for(tr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}sl=null,A_=!1}catch(i){throw sl!==null&&(sl=sl.slice(t+1)),UM(hS,Ac),i}finally{tr=e,sb=!1}}return null}var Hh=[],qh=0,B0=null,j0=0,Co=[],Ao=0,Su=null,ll=1,cl="";function ru(t,e){Hh[qh++]=j0,Hh[qh++]=B0,B0=t,j0=e}function _L(t,e,n){Co[Ao++]=ll,Co[Ao++]=cl,Co[Ao++]=Su,Su=t;var r=ll;t=cl;var i=32-aa(r)-1;r&=~(1<<i),n+=1;var a=32-aa(e)+i;if(30<a){var h=i-i%5;a=(r&(1<<h)-1).toString(32),r>>=h,i-=h,ll=1<<32-aa(e)+i|n<<i|r,cl=a+t}else ll=1<<a|n<<i|r,cl=t}function xS(t){t.return!==null&&(ru(t,1),_L(t,1,0))}function bS(t){for(;t===B0;)B0=Hh[--qh],Hh[qh]=null,j0=Hh[--qh],Hh[qh]=null;for(;t===Su;)Su=Co[--Ao],Co[Ao]=null,cl=Co[--Ao],Co[Ao]=null,ll=Co[--Ao],Co[Ao]=null}var ro=null,to=null,Lr=!1,ia=null;function vL(t,e){var n=ko(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function FP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ro=t,to=pc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ro=t,to=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Su!==null?{id:ll,overflow:cl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ko(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ro=t,to=null,!0):!1;default:return!1}}function N1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function B1(t){if(Lr){var e=to;if(e){var n=e;if(!FP(t,e)){if(N1(t))throw Error(ft(418));e=pc(n.nextSibling);var r=ro;e&&FP(t,e)?vL(r,n):(t.flags=t.flags&-4097|2,Lr=!1,ro=t)}}else{if(N1(t))throw Error(ft(418));t.flags=t.flags&-4097|2,Lr=!1,ro=t}}}function NP(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ro=t}function gy(t){if(t!==ro)return!1;if(!Lr)return NP(t),Lr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!O1(t.type,t.memoizedProps)),e&&(e=to)){if(N1(t))throw xL(),Error(ft(418));for(;e;)vL(t,e),e=pc(e.nextSibling)}if(NP(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ft(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){to=pc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}to=null}}else to=ro?pc(t.stateNode.nextSibling):null;return!0}function xL(){for(var t=to;t;)t=pc(t.nextSibling)}function gd(){to=ro=null,Lr=!1}function wS(t){ia===null?ia=[t]:ia.push(t)}var iN=wl.ReactCurrentBatchConfig;function rp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ft(309));var r=n.stateNode}if(!r)throw Error(ft(147,t));var i=r,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(h){var l=i.refs;h===null?delete l[a]:l[a]=h},e._stringRef=a,e)}if(typeof t!="string")throw Error(ft(284));if(!n._owner)throw Error(ft(290,t))}return t}function yy(t,e){throw t=Object.prototype.toString.call(e),Error(ft(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function BP(t){var e=t._init;return e(t._payload)}function bL(t){function e(z,N){if(t){var F=z.deletions;F===null?(z.deletions=[N],z.flags|=16):F.push(N)}}function n(z,N){if(!t)return null;for(;N!==null;)e(z,N),N=N.sibling;return null}function r(z,N){for(z=new Map;N!==null;)N.key!==null?z.set(N.key,N):z.set(N.index,N),N=N.sibling;return z}function i(z,N){return z=_c(z,N),z.index=0,z.sibling=null,z}function a(z,N,F){return z.index=F,t?(F=z.alternate,F!==null?(F=F.index,F<N?(z.flags|=2,N):F):(z.flags|=2,N)):(z.flags|=1048576,N)}function h(z){return t&&z.alternate===null&&(z.flags|=2),z}function l(z,N,F,$){return N===null||N.tag!==6?(N=db(F,z.mode,$),N.return=z,N):(N=i(N,F),N.return=z,N)}function m(z,N,F,$){var Q=F.type;return Q===jh?S(z,N,F.props.children,$,F.key):N!==null&&(N.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Ql&&BP(Q)===N.type)?($=i(N,F.props),$.ref=rp(z,N,F),$.return=z,$):($=h0(F.type,F.key,F.props,null,z.mode,$),$.ref=rp(z,N,F),$.return=z,$)}function _(z,N,F,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=fb(F,z.mode,$),N.return=z,N):(N=i(N,F.children||[]),N.return=z,N)}function S(z,N,F,$,Q){return N===null||N.tag!==7?(N=_u(F,z.mode,$,Q),N.return=z,N):(N=i(N,F),N.return=z,N)}function P(z,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return N=db(""+N,z.mode,F),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case oy:return F=h0(N.type,N.key,N.props,null,z.mode,F),F.ref=rp(z,null,N),F.return=z,F;case Bh:return N=fb(N,z.mode,F),N.return=z,N;case Ql:var $=N._init;return P(z,$(N._payload),F)}if(wp(N)||Jf(N))return N=_u(N,z.mode,F,null),N.return=z,N;yy(z,N)}return null}function A(z,N,F,$){var Q=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return Q!==null?null:l(z,N,""+F,$);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case oy:return F.key===Q?m(z,N,F,$):null;case Bh:return F.key===Q?_(z,N,F,$):null;case Ql:return Q=F._init,A(z,N,Q(F._payload),$)}if(wp(F)||Jf(F))return Q!==null?null:S(z,N,F,$,null);yy(z,F)}return null}function L(z,N,F,$,Q){if(typeof $=="string"&&$!==""||typeof $=="number")return z=z.get(F)||null,l(N,z,""+$,Q);if(typeof $=="object"&&$!==null){switch($.$$typeof){case oy:return z=z.get($.key===null?F:$.key)||null,m(N,z,$,Q);case Bh:return z=z.get($.key===null?F:$.key)||null,_(N,z,$,Q);case Ql:var te=$._init;return L(z,N,F,te($._payload),Q)}if(wp($)||Jf($))return z=z.get(F)||null,S(N,z,$,Q,null);yy(N,$)}return null}function O(z,N,F,$){for(var Q=null,te=null,ie=N,xe=N=0,Te=null;ie!==null&&xe<F.length;xe++){ie.index>xe?(Te=ie,ie=null):Te=ie.sibling;var _e=A(z,ie,F[xe],$);if(_e===null){ie===null&&(ie=Te);break}t&&ie&&_e.alternate===null&&e(z,ie),N=a(_e,N,xe),te===null?Q=_e:te.sibling=_e,te=_e,ie=Te}if(xe===F.length)return n(z,ie),Lr&&ru(z,xe),Q;if(ie===null){for(;xe<F.length;xe++)ie=P(z,F[xe],$),ie!==null&&(N=a(ie,N,xe),te===null?Q=ie:te.sibling=ie,te=ie);return Lr&&ru(z,xe),Q}for(ie=r(z,ie);xe<F.length;xe++)Te=L(ie,z,xe,F[xe],$),Te!==null&&(t&&Te.alternate!==null&&ie.delete(Te.key===null?xe:Te.key),N=a(Te,N,xe),te===null?Q=Te:te.sibling=Te,te=Te);return t&&ie.forEach(function(Re){return e(z,Re)}),Lr&&ru(z,xe),Q}function D(z,N,F,$){var Q=Jf(F);if(typeof Q!="function")throw Error(ft(150));if(F=Q.call(F),F==null)throw Error(ft(151));for(var te=Q=null,ie=N,xe=N=0,Te=null,_e=F.next();ie!==null&&!_e.done;xe++,_e=F.next()){ie.index>xe?(Te=ie,ie=null):Te=ie.sibling;var Re=A(z,ie,_e.value,$);if(Re===null){ie===null&&(ie=Te);break}t&&ie&&Re.alternate===null&&e(z,ie),N=a(Re,N,xe),te===null?Q=Re:te.sibling=Re,te=Re,ie=Te}if(_e.done)return n(z,ie),Lr&&ru(z,xe),Q;if(ie===null){for(;!_e.done;xe++,_e=F.next())_e=P(z,_e.value,$),_e!==null&&(N=a(_e,N,xe),te===null?Q=_e:te.sibling=_e,te=_e);return Lr&&ru(z,xe),Q}for(ie=r(z,ie);!_e.done;xe++,_e=F.next())_e=L(ie,z,xe,_e.value,$),_e!==null&&(t&&_e.alternate!==null&&ie.delete(_e.key===null?xe:_e.key),N=a(_e,N,xe),te===null?Q=_e:te.sibling=_e,te=_e);return t&&ie.forEach(function(Ne){return e(z,Ne)}),Lr&&ru(z,xe),Q}function W(z,N,F,$){if(typeof F=="object"&&F!==null&&F.type===jh&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case oy:e:{for(var Q=F.key,te=N;te!==null;){if(te.key===Q){if(Q=F.type,Q===jh){if(te.tag===7){n(z,te.sibling),N=i(te,F.props.children),N.return=z,z=N;break e}}else if(te.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Ql&&BP(Q)===te.type){n(z,te.sibling),N=i(te,F.props),N.ref=rp(z,te,F),N.return=z,z=N;break e}n(z,te);break}else e(z,te);te=te.sibling}F.type===jh?(N=_u(F.props.children,z.mode,$,F.key),N.return=z,z=N):($=h0(F.type,F.key,F.props,null,z.mode,$),$.ref=rp(z,N,F),$.return=z,z=$)}return h(z);case Bh:e:{for(te=F.key;N!==null;){if(N.key===te)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){n(z,N.sibling),N=i(N,F.children||[]),N.return=z,z=N;break e}else{n(z,N);break}else e(z,N);N=N.sibling}N=fb(F,z.mode,$),N.return=z,z=N}return h(z);case Ql:return te=F._init,W(z,N,te(F._payload),$)}if(wp(F))return O(z,N,F,$);if(Jf(F))return D(z,N,F,$);yy(z,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,N!==null&&N.tag===6?(n(z,N.sibling),N=i(N,F),N.return=z,z=N):(n(z,N),N=db(F,z.mode,$),N.return=z,z=N),h(z)):n(z,N)}return W}var yd=bL(!0),wL=bL(!1),V0=Cc(null),U0=null,Zh=null,SS=null;function TS(){SS=Zh=U0=null}function ES(t){var e=V0.current;Er(V0),t._currentValue=e}function j1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function od(t,e){U0=t,SS=Zh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Os=!0),t.firstContext=null)}function zo(t){var e=t._currentValue;if(SS!==t)if(t={context:t,memoizedValue:e,next:null},Zh===null){if(U0===null)throw Error(ft(308));Zh=t,U0.dependencies={lanes:0,firstContext:t}}else Zh=Zh.next=t;return e}var hu=null;function PS(t){hu===null?hu=[t]:hu.push(t)}function SL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,PS(e)):(n.next=i.next,i.next=n),e.interleaved=n,fl(t,r)}function fl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ec=!1;function CS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ul(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function mc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Un&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fl(t,n)}return i=r.interleaved,i===null?(e.next=e,PS(r)):(e.next=i.next,i.next=e),r.interleaved=e,fl(t,n)}function s0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dS(t,n)}}function jP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=h:a=a.next=h,n=n.next}while(n!==null);a===null?i=a=e:a=a.next=e}else i=a=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $0(t,e,n,r){var i=t.updateQueue;ec=!1;var a=i.firstBaseUpdate,h=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var m=l,_=m.next;m.next=null,h===null?a=_:h.next=_,h=m;var S=t.alternate;S!==null&&(S=S.updateQueue,l=S.lastBaseUpdate,l!==h&&(l===null?S.firstBaseUpdate=_:l.next=_,S.lastBaseUpdate=m))}if(a!==null){var P=i.baseState;h=0,S=_=m=null,l=a;do{var A=l.lane,L=l.eventTime;if((r&A)===A){S!==null&&(S=S.next={eventTime:L,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var O=t,D=l;switch(A=e,L=n,D.tag){case 1:if(O=D.payload,typeof O=="function"){P=O.call(L,P,A);break e}P=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=D.payload,A=typeof O=="function"?O.call(L,P,A):O,A==null)break e;P=Br({},P,A);break e;case 2:ec=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=i.effects,A===null?i.effects=[l]:A.push(l))}else L={eventTime:L,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},S===null?(_=S=L,m=P):S=S.next=L,h|=A;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;A=l,l=A.next,A.next=null,i.lastBaseUpdate=A,i.shared.pending=null}}while(1);if(S===null&&(m=P),i.baseState=m,i.firstBaseUpdate=_,i.lastBaseUpdate=S,e=i.shared.interleaved,e!==null){i=e;do h|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Eu|=h,t.lanes=h,t.memoizedState=P}}function VP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ft(191,i));i.call(r)}}}var Om={},La=Cc(Om),rm=Cc(Om),im=Cc(Om);function du(t){if(t===Om)throw Error(ft(174));return t}function AS(t,e){switch(vr(im,e),vr(rm,t),vr(La,Om),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:x1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=x1(e,t)}Er(La),vr(La,e)}function _d(){Er(La),Er(rm),Er(im)}function EL(t){du(im.current);var e=du(La.current),n=x1(e,t.type);e!==n&&(vr(rm,t),vr(La,n))}function IS(t){rm.current===t&&(Er(La),Er(rm))}var Dr=Cc(0);function G0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ob=[];function kS(){for(var t=0;t<ob.length;t++)ob[t]._workInProgressVersionPrimary=null;ob.length=0}var o0=wl.ReactCurrentDispatcher,ab=wl.ReactCurrentBatchConfig,Tu=0,Nr=null,_i=null,Pi=null,W0=!1,Op=!1,sm=0,sN=0;function es(){throw Error(ft(321))}function MS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ua(t[n],e[n]))return!1;return!0}function LS(t,e,n,r,i,a){if(Tu=a,Nr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,o0.current=t===null||t.memoizedState===null?cN:uN,t=n(r,i),Op){a=0;do{if(Op=!1,sm=0,25<=a)throw Error(ft(301));a+=1,Pi=_i=null,e.updateQueue=null,o0.current=hN,t=n(r,i)}while(Op)}if(o0.current=H0,e=_i!==null&&_i.next!==null,Tu=0,Pi=_i=Nr=null,W0=!1,e)throw Error(ft(300));return t}function RS(){var t=sm!==0;return sm=0,t}function Ta(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pi===null?Nr.memoizedState=Pi=t:Pi=Pi.next=t,Pi}function Do(){if(_i===null){var t=Nr.alternate;t=t!==null?t.memoizedState:null}else t=_i.next;var e=Pi===null?Nr.memoizedState:Pi.next;if(e!==null)Pi=e,_i=t;else{if(t===null)throw Error(ft(310));_i=t,t={memoizedState:_i.memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},Pi===null?Nr.memoizedState=Pi=t:Pi=Pi.next=t}return Pi}function om(t,e){return typeof e=="function"?e(t):e}function lb(t){var e=Do(),n=e.queue;if(n===null)throw Error(ft(311));n.lastRenderedReducer=t;var r=_i,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var h=i.next;i.next=a.next,a.next=h}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=h=null,m=null,_=a;do{var S=_.lane;if((Tu&S)===S)m!==null&&(m=m.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),r=_.hasEagerState?_.eagerState:t(r,_.action);else{var P={lane:S,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};m===null?(l=m=P,h=r):m=m.next=P,Nr.lanes|=S,Eu|=S}_=_.next}while(_!==null&&_!==a);m===null?h=r:m.next=l,ua(r,e.memoizedState)||(Os=!0),e.memoizedState=r,e.baseState=h,e.baseQueue=m,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do a=i.lane,Nr.lanes|=a,Eu|=a,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cb(t){var e=Do(),n=e.queue;if(n===null)throw Error(ft(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,a=e.memoizedState;if(i!==null){n.pending=null;var h=i=i.next;do a=t(a,h.action),h=h.next;while(h!==i);ua(a,e.memoizedState)||(Os=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,r]}function PL(){}function CL(t,e){var n=Nr,r=Do(),i=e(),a=!ua(r.memoizedState,i);if(a&&(r.memoizedState=i,Os=!0),r=r.queue,OS(kL.bind(null,n,r,t),[t]),r.getSnapshot!==e||a||Pi!==null&&Pi.memoizedState.tag&1){if(n.flags|=2048,am(9,IL.bind(null,n,r,i,e),void 0,null),Ai===null)throw Error(ft(349));Tu&30||AL(n,e,i)}return i}function AL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function IL(t,e,n,r){e.value=n,e.getSnapshot=r,ML(e)&&LL(t)}function kL(t,e,n){return n(function(){ML(e)&&LL(t)})}function ML(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ua(t,n)}catch{return!0}}function LL(t){var e=fl(t,1);e!==null&&la(e,t,1,-1)}function UP(t){var e=Ta();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:om,lastRenderedState:t},e.queue=t,t=t.dispatch=lN.bind(null,Nr,t),[e.memoizedState,t]}function am(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Nr.updateQueue,e===null?(e={lastEffect:null,stores:null},Nr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RL(){return Do().memoizedState}function a0(t,e,n,r){var i=Ta();Nr.flags|=t,i.memoizedState=am(1|e,n,void 0,r===void 0?null:r)}function I_(t,e,n,r){var i=Do();r=r===void 0?null:r;var a=void 0;if(_i!==null){var h=_i.memoizedState;if(a=h.destroy,r!==null&&MS(r,h.deps)){i.memoizedState=am(e,n,a,r);return}}Nr.flags|=t,i.memoizedState=am(1|e,n,a,r)}function $P(t,e){return a0(8390656,8,t,e)}function OS(t,e){return I_(2048,8,t,e)}function OL(t,e){return I_(4,2,t,e)}function zL(t,e){return I_(4,4,t,e)}function DL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FL(t,e,n){return n=n!=null?n.concat([t]):null,I_(4,4,DL.bind(null,e,t),n)}function zS(){}function NL(t,e){var n=Do();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&MS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function BL(t,e){var n=Do();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&MS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function jL(t,e,n){return Tu&21?(ua(n,e)||(n=WM(),Nr.lanes|=n,Eu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Os=!0),t.memoizedState=n)}function oN(t,e){var n=tr;tr=n!==0&&4>n?n:4,t(!0);var r=ab.transition;ab.transition={};try{t(!1),e()}finally{tr=n,ab.transition=r}}function VL(){return Do().memoizedState}function aN(t,e,n){var r=yc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UL(t))$L(e,n);else if(n=SL(t,e,n,r),n!==null){var i=Ts();la(n,t,r,i),GL(n,e,r)}}function lN(t,e,n){var r=yc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UL(t))$L(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var h=e.lastRenderedState,l=a(h,n);if(i.hasEagerState=!0,i.eagerState=l,ua(l,h)){var m=e.interleaved;m===null?(i.next=i,PS(e)):(i.next=m.next,m.next=i),e.interleaved=i;return}}catch{}finally{}n=SL(t,e,i,r),n!==null&&(i=Ts(),la(n,t,r,i),GL(n,e,r))}}function UL(t){var e=t.alternate;return t===Nr||e!==null&&e===Nr}function $L(t,e){Op=W0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dS(t,n)}}var H0={readContext:zo,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},cN={readContext:zo,useCallback:function(t,e){return Ta().memoizedState=[t,e===void 0?null:e],t},useContext:zo,useEffect:$P,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,a0(4194308,4,DL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return a0(4194308,4,t,e)},useInsertionEffect:function(t,e){return a0(4,2,t,e)},useMemo:function(t,e){var n=Ta();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ta();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=aN.bind(null,Nr,t),[r.memoizedState,t]},useRef:function(t){var e=Ta();return t={current:t},e.memoizedState=t},useState:UP,useDebugValue:zS,useDeferredValue:function(t){return Ta().memoizedState=t},useTransition:function(){var t=UP(!1),e=t[0];return t=oN.bind(null,t[1]),Ta().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Nr,i=Ta();if(Lr){if(n===void 0)throw Error(ft(407));n=n()}else{if(n=e(),Ai===null)throw Error(ft(349));Tu&30||AL(r,e,n)}i.memoizedState=n;var a={value:n,getSnapshot:e};return i.queue=a,$P(kL.bind(null,r,a,t),[t]),r.flags|=2048,am(9,IL.bind(null,r,a,n,e),void 0,null),n},useId:function(){var t=Ta(),e=Ai.identifierPrefix;if(Lr){var n=cl,r=ll;n=(r&~(1<<32-aa(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=sm++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},uN={readContext:zo,useCallback:NL,useContext:zo,useEffect:OS,useImperativeHandle:FL,useInsertionEffect:OL,useLayoutEffect:zL,useMemo:BL,useReducer:lb,useRef:RL,useState:function(){return lb(om)},useDebugValue:zS,useDeferredValue:function(t){var e=Do();return jL(e,_i.memoizedState,t)},useTransition:function(){var t=lb(om)[0],e=Do().memoizedState;return[t,e]},useMutableSource:PL,useSyncExternalStore:CL,useId:VL,unstable_isNewReconciler:!1},hN={readContext:zo,useCallback:NL,useContext:zo,useEffect:OS,useImperativeHandle:FL,useInsertionEffect:OL,useLayoutEffect:zL,useMemo:BL,useReducer:cb,useRef:RL,useState:function(){return cb(om)},useDebugValue:zS,useDeferredValue:function(t){var e=Do();return _i===null?e.memoizedState=t:jL(e,_i.memoizedState,t)},useTransition:function(){var t=cb(om)[0],e=Do().memoizedState;return[t,e]},useMutableSource:PL,useSyncExternalStore:CL,useId:VL,unstable_isNewReconciler:!1};function na(t,e){if(t&&t.defaultProps){e=Br({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function V1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Br({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var k_={isMounted:function(t){return(t=t._reactInternals)?Lu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ts(),i=yc(t),a=ul(r,i);a.payload=e,n!=null&&(a.callback=n),e=mc(t,a,i),e!==null&&(la(e,t,i,r),s0(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ts(),i=yc(t),a=ul(r,i);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=mc(t,a,i),e!==null&&(la(e,t,i,r),s0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ts(),r=yc(t),i=ul(n,r);i.tag=2,e!=null&&(i.callback=e),e=mc(t,i,r),e!==null&&(la(e,t,r,n),s0(e,t,r))}};function GP(t,e,n,r,i,a,h){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,h):e.prototype&&e.prototype.isPureReactComponent?!Qp(n,r)||!Qp(i,a):!0}function WL(t,e,n){var r=!1,i=Sc,a=e.contextType;return typeof a=="object"&&a!==null?a=zo(a):(i=Fs(e)?wu:ls.current,r=e.contextTypes,a=(r=r!=null)?md(t,i):Sc),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=k_,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function WP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&k_.enqueueReplaceState(e,e.state,null)}function U1(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},CS(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=zo(a):(a=Fs(e)?wu:ls.current,i.context=md(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(V1(t,e,a,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&k_.enqueueReplaceState(i,i.state,null),$0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function vd(t,e){try{var n="",r=e;do n+=B5(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function ub(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var dN=typeof WeakMap=="function"?WeakMap:Map;function HL(t,e,n){n=ul(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Z0||(Z0=!0,Q1=r),$1(t,e)},n}function qL(t,e,n){n=ul(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$1(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){$1(t,e),typeof r!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),n}function HP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new dN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=PN.bind(null,t,e,n),e.then(t,t))}function qP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ZP(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ul(-1,1),e.tag=2,mc(n,e,1))),n.lanes|=1),t)}var fN=wl.ReactCurrentOwner,Os=!1;function bs(t,e,n,r){e.child=t===null?wL(e,null,n,r):yd(e,t.child,n,r)}function XP(t,e,n,r,i){n=n.render;var a=e.ref;return od(e,i),r=LS(t,e,n,r,a,i),n=RS(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pl(t,e,i)):(Lr&&n&&xS(e),e.flags|=1,bs(t,e,r,i),e.child)}function YP(t,e,n,r,i){if(t===null){var a=n.type;return typeof a=="function"&&!$S(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,ZL(t,e,a,r,i)):(t=h0(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var h=a.memoizedProps;if(n=n.compare,n=n!==null?n:Qp,n(h,r)&&t.ref===e.ref)return pl(t,e,i)}return e.flags|=1,t=_c(a,r),t.ref=e.ref,t.return=e,e.child=t}function ZL(t,e,n,r,i){if(t!==null){var a=t.memoizedProps;if(Qp(a,r)&&t.ref===e.ref)if(Os=!1,e.pendingProps=r=a,(t.lanes&i)!==0)t.flags&131072&&(Os=!0);else return e.lanes=t.lanes,pl(t,e,i)}return G1(t,e,n,r,i)}function XL(t,e,n){var r=e.pendingProps,i=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(Yh,Ks),Ks|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vr(Yh,Ks),Ks|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,vr(Yh,Ks),Ks|=r}else a!==null?(r=a.baseLanes|n,e.memoizedState=null):r=n,vr(Yh,Ks),Ks|=r;return bs(t,e,i,n),e.child}function YL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function G1(t,e,n,r,i){var a=Fs(n)?wu:ls.current;return a=md(e,a),od(e,i),n=LS(t,e,n,r,a,i),r=RS(),t!==null&&!Os?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,pl(t,e,i)):(Lr&&r&&xS(e),e.flags|=1,bs(t,e,n,i),e.child)}function KP(t,e,n,r,i){if(Fs(n)){var a=!0;N0(e)}else a=!1;if(od(e,i),e.stateNode===null)l0(t,e),WL(e,n,r),U1(e,n,r,i),r=!0;else if(t===null){var h=e.stateNode,l=e.memoizedProps;h.props=l;var m=h.context,_=n.contextType;typeof _=="object"&&_!==null?_=zo(_):(_=Fs(n)?wu:ls.current,_=md(e,_));var S=n.getDerivedStateFromProps,P=typeof S=="function"||typeof h.getSnapshotBeforeUpdate=="function";P||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==r||m!==_)&&WP(e,h,r,_),ec=!1;var A=e.memoizedState;h.state=A,$0(e,r,h,i),m=e.memoizedState,l!==r||A!==m||Ds.current||ec?(typeof S=="function"&&(V1(e,n,S,r),m=e.memoizedState),(l=ec||GP(e,n,l,r,A,m,_))?(P||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),h.props=r,h.state=m,h.context=_,r=l):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{h=e.stateNode,TL(t,e),l=e.memoizedProps,_=e.type===e.elementType?l:na(e.type,l),h.props=_,P=e.pendingProps,A=h.context,m=n.contextType,typeof m=="object"&&m!==null?m=zo(m):(m=Fs(n)?wu:ls.current,m=md(e,m));var L=n.getDerivedStateFromProps;(S=typeof L=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==P||A!==m)&&WP(e,h,r,m),ec=!1,A=e.memoizedState,h.state=A,$0(e,r,h,i);var O=e.memoizedState;l!==P||A!==O||Ds.current||ec?(typeof L=="function"&&(V1(e,n,L,r),O=e.memoizedState),(_=ec||GP(e,n,_,r,A,O,m)||!1)?(S||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,O,m),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,O,m)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=O),h.props=r,h.state=O,h.context=m,r=_):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),r=!1)}return W1(t,e,n,r,a,i)}function W1(t,e,n,r,i,a){YL(t,e);var h=(e.flags&128)!==0;if(!r&&!h)return i&&DP(e,n,!1),pl(t,e,a);r=e.stateNode,fN.current=e;var l=h&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&h?(e.child=yd(e,t.child,null,a),e.child=yd(e,null,l,a)):bs(t,e,l,a),e.memoizedState=r.state,i&&DP(e,n,!0),e.child}function KL(t){var e=t.stateNode;e.pendingContext?zP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zP(t,e.context,!1),AS(t,e.containerInfo)}function JP(t,e,n,r,i){return gd(),wS(i),e.flags|=256,bs(t,e,n,r),e.child}var H1={dehydrated:null,treeContext:null,retryLane:0};function q1(t){return{baseLanes:t,cachePool:null,transitions:null}}function JL(t,e,n){var r=e.pendingProps,i=Dr.current,a=!1,h=(e.flags&128)!==0,l;if((l=h)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vr(Dr,i&1),t===null)return B1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=r.children,t=r.fallback,a?(r=e.mode,a=e.child,h={mode:"hidden",children:h},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=h):a=R_(h,r,0,null),t=_u(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=q1(n),e.memoizedState=H1,t):DS(e,h));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return pN(t,e,h,r,l,i,n);if(a){a=r.fallback,h=e.mode,i=t.child,l=i.sibling;var m={mode:"hidden",children:r.children};return!(h&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=m,e.deletions=null):(r=_c(i,m),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=_c(l,a):(a=_u(a,h,n,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,h=t.child.memoizedState,h=h===null?q1(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},a.memoizedState=h,a.childLanes=t.childLanes&~n,e.memoizedState=H1,r}return a=t.child,t=a.sibling,r=_c(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function DS(t,e){return e=R_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _y(t,e,n,r){return r!==null&&wS(r),yd(e,t.child,null,n),t=DS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pN(t,e,n,r,i,a,h){if(n)return e.flags&256?(e.flags&=-257,r=ub(Error(ft(422))),_y(t,e,h,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=r.fallback,i=e.mode,r=R_({mode:"visible",children:r.children},i,0,null),a=_u(a,i,h,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&yd(e,t.child,null,h),e.child.memoizedState=q1(h),e.memoizedState=H1,a);if(!(e.mode&1))return _y(t,e,h,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(ft(419)),r=ub(a,r,void 0),_y(t,e,h,r)}if(l=(h&t.childLanes)!==0,Os||l){if(r=Ai,r!==null){switch(h&-h){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|h)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,fl(t,i),la(r,t,i,-1))}return US(),r=ub(Error(ft(421))),_y(t,e,h,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=CN.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,to=pc(i.nextSibling),ro=e,Lr=!0,ia=null,t!==null&&(Co[Ao++]=ll,Co[Ao++]=cl,Co[Ao++]=Su,ll=t.id,cl=t.overflow,Su=e),e=DS(e,r.children),e.flags|=4096,e)}function QP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),j1(t.return,e,n)}function hb(t,e,n,r,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function QL(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(bs(t,e,r.children,n),r=Dr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&QP(t,n,e);else if(t.tag===19)QP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vr(Dr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&G0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),hb(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&G0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}hb(e,!0,n,null,a);break;case"together":hb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function l0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function pl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Eu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ft(153));if(e.child!==null){for(t=e.child,n=_c(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_c(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function mN(t,e,n){switch(e.tag){case 3:KL(e),gd();break;case 5:EL(e);break;case 1:Fs(e.type)&&N0(e);break;case 4:AS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;vr(V0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vr(Dr,Dr.current&1),e.flags|=128,null):n&e.child.childLanes?JL(t,e,n):(vr(Dr,Dr.current&1),t=pl(t,e,n),t!==null?t.sibling:null);vr(Dr,Dr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return QL(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vr(Dr,Dr.current),r)break;return null;case 22:case 23:return e.lanes=0,XL(t,e,n)}return pl(t,e,n)}var eR,Z1,tR,nR;eR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Z1=function(){};tR=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,du(La.current);var a=null;switch(n){case"input":i=g1(t,i),r=g1(t,r),a=[];break;case"select":i=Br({},i,{value:void 0}),r=Br({},r,{value:void 0}),a=[];break;case"textarea":i=v1(t,i),r=v1(t,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=D0)}b1(n,r);var h;n=null;for(_ in i)if(!r.hasOwnProperty(_)&&i.hasOwnProperty(_)&&i[_]!=null)if(_==="style"){var l=i[_];for(h in l)l.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Hp.hasOwnProperty(_)?a||(a=[]):(a=a||[]).push(_,null));for(_ in r){var m=r[_];if(l=i!=null?i[_]:void 0,r.hasOwnProperty(_)&&m!==l&&(m!=null||l!=null))if(_==="style")if(l){for(h in l)!l.hasOwnProperty(h)||m&&m.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in m)m.hasOwnProperty(h)&&l[h]!==m[h]&&(n||(n={}),n[h]=m[h])}else n||(a||(a=[]),a.push(_,n)),n=m;else _==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,l=l?l.__html:void 0,m!=null&&l!==m&&(a=a||[]).push(_,m)):_==="children"?typeof m!="string"&&typeof m!="number"||(a=a||[]).push(_,""+m):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Hp.hasOwnProperty(_)?(m!=null&&_==="onScroll"&&Sr("scroll",t),a||l===m||(a=[])):(a=a||[]).push(_,m))}n&&(a=a||[]).push("style",n);var _=a;(e.updateQueue=_)&&(e.flags|=4)}};nR=function(t,e,n,r){n!==r&&(e.flags|=4)};function ip(t,e){if(!Lr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function gN(t,e,n){var r=e.pendingProps;switch(bS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return Fs(e.type)&&F0(),ts(e),null;case 3:return r=e.stateNode,_d(),Er(Ds),Er(ls),kS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(gy(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ia!==null&&(nw(ia),ia=null))),Z1(t,e),ts(e),null;case 5:IS(e);var i=du(im.current);if(n=e.type,t!==null&&e.stateNode!=null)tR(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ft(166));return ts(e),null}if(t=du(La.current),gy(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Ca]=e,r[nm]=a,t=(e.mode&1)!==0,n){case"dialog":Sr("cancel",r),Sr("close",r);break;case"iframe":case"object":case"embed":Sr("load",r);break;case"video":case"audio":for(i=0;i<Tp.length;i++)Sr(Tp[i],r);break;case"source":Sr("error",r);break;case"img":case"image":case"link":Sr("error",r),Sr("load",r);break;case"details":Sr("toggle",r);break;case"input":lP(r,a),Sr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Sr("invalid",r);break;case"textarea":uP(r,a),Sr("invalid",r)}b1(n,a),i=null;for(var h in a)if(a.hasOwnProperty(h)){var l=a[h];h==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&my(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&my(r.textContent,l,t),i=["children",""+l]):Hp.hasOwnProperty(h)&&l!=null&&h==="onScroll"&&Sr("scroll",r)}switch(n){case"input":ay(r),cP(r,a,!0);break;case"textarea":ay(r),hP(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=D0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{h=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kM(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=h.createElement(n,{is:r.is}):(t=h.createElement(n),n==="select"&&(h=t,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):t=h.createElementNS(t,n),t[Ca]=e,t[nm]=r,eR(t,e,!1,!1),e.stateNode=t;e:{switch(h=w1(n,r),n){case"dialog":Sr("cancel",t),Sr("close",t),i=r;break;case"iframe":case"object":case"embed":Sr("load",t),i=r;break;case"video":case"audio":for(i=0;i<Tp.length;i++)Sr(Tp[i],t);i=r;break;case"source":Sr("error",t),i=r;break;case"img":case"image":case"link":Sr("error",t),Sr("load",t),i=r;break;case"details":Sr("toggle",t),i=r;break;case"input":lP(t,r),i=g1(t,r),Sr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Br({},r,{value:void 0}),Sr("invalid",t);break;case"textarea":uP(t,r),i=v1(t,r),Sr("invalid",t);break;default:i=r}b1(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var m=l[a];a==="style"?RM(t,m):a==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&MM(t,m)):a==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&qp(t,m):typeof m=="number"&&qp(t,""+m):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Hp.hasOwnProperty(a)?m!=null&&a==="onScroll"&&Sr("scroll",t):m!=null&&oS(t,a,m,h))}switch(n){case"input":ay(t),cP(t,r,!1);break;case"textarea":ay(t),hP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+wc(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?nd(t,!!r.multiple,a,!1):r.defaultValue!=null&&nd(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=D0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)nR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ft(166));if(n=du(im.current),du(La.current),gy(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ca]=e,(a=r.nodeValue!==n)&&(t=ro,t!==null))switch(t.tag){case 3:my(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&my(r.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ca]=e,e.stateNode=r}return ts(e),null;case 13:if(Er(Dr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Lr&&to!==null&&e.mode&1&&!(e.flags&128))xL(),gd(),e.flags|=98560,a=!1;else if(a=gy(e),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(ft(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ft(317));a[Ca]=e}else gd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),a=!1}else ia!==null&&(nw(ia),ia=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Dr.current&1?vi===0&&(vi=3):US())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return _d(),Z1(t,e),t===null&&em(e.stateNode.containerInfo),ts(e),null;case 10:return ES(e.type._context),ts(e),null;case 17:return Fs(e.type)&&F0(),ts(e),null;case 19:if(Er(Dr),a=e.memoizedState,a===null)return ts(e),null;if(r=(e.flags&128)!==0,h=a.rendering,h===null)if(r)ip(a,!1);else{if(vi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(h=G0(t),h!==null){for(e.flags|=128,ip(a,!1),r=h.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)a=n,t=r,a.flags&=14680066,h=a.alternate,h===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,t=h.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vr(Dr,Dr.current&1|2),e.child}t=t.sibling}a.tail!==null&&oi()>xd&&(e.flags|=128,r=!0,ip(a,!1),e.lanes=4194304)}else{if(!r)if(t=G0(h),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ip(a,!0),a.tail===null&&a.tailMode==="hidden"&&!h.alternate&&!Lr)return ts(e),null}else 2*oi()-a.renderingStartTime>xd&&n!==1073741824&&(e.flags|=128,r=!0,ip(a,!1),e.lanes=4194304);a.isBackwards?(h.sibling=e.child,e.child=h):(n=a.last,n!==null?n.sibling=h:e.child=h,a.last=h)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=oi(),e.sibling=null,n=Dr.current,vr(Dr,r?n&1|2:n&1),e):(ts(e),null);case 22:case 23:return VS(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ks&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(ft(156,e.tag))}function yN(t,e){switch(bS(e),e.tag){case 1:return Fs(e.type)&&F0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _d(),Er(Ds),Er(ls),kS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return IS(e),null;case 13:if(Er(Dr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ft(340));gd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Er(Dr),null;case 4:return _d(),null;case 10:return ES(e.type._context),null;case 22:case 23:return VS(),null;case 24:return null;default:return null}}var vy=!1,os=!1,_N=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function Xh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zr(t,e,r)}else n.current=null}function X1(t,e,n){try{n()}catch(r){Zr(t,e,r)}}var eC=!1;function vN(t,e){if(L1=R0,t=aL(),vS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var h=0,l=-1,m=-1,_=0,S=0,P=t,A=null;t:for(;;){for(var L;P!==n||i!==0&&P.nodeType!==3||(l=h+i),P!==a||r!==0&&P.nodeType!==3||(m=h+r),P.nodeType===3&&(h+=P.nodeValue.length),(L=P.firstChild)!==null;)A=P,P=L;for(;;){if(P===t)break t;if(A===n&&++_===i&&(l=h),A===a&&++S===r&&(m=h),(L=P.nextSibling)!==null)break;P=A,A=P.parentNode}P=L}n=l===-1||m===-1?null:{start:l,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(R1={focusedElem:t,selectionRange:n},R0=!1,Zt=e;Zt!==null;)if(e=Zt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Zt=t;else for(;Zt!==null;){e=Zt;try{var O=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var D=O.memoizedProps,W=O.memoizedState,z=e.stateNode,N=z.getSnapshotBeforeUpdate(e.elementType===e.type?D:na(e.type,D),W);z.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch($){Zr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,Zt=t;break}Zt=e.return}return O=eC,eC=!1,O}function zp(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&X1(e,n,a)}i=i.next}while(i!==r)}}function M_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Y1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rR(t){var e=t.alternate;e!==null&&(t.alternate=null,rR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ca],delete e[nm],delete e[D1],delete e[tN],delete e[nN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iR(t){return t.tag===5||t.tag===3||t.tag===4}function tC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function K1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=D0));else if(r!==4&&(t=t.child,t!==null))for(K1(t,e,n),t=t.sibling;t!==null;)K1(t,e,n),t=t.sibling}function J1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(J1(t,e,n),t=t.sibling;t!==null;)J1(t,e,n),t=t.sibling}var Ni=null,ra=!1;function Wl(t,e,n){for(n=n.child;n!==null;)sR(t,e,n),n=n.sibling}function sR(t,e,n){if(Ma&&typeof Ma.onCommitFiberUnmount=="function")try{Ma.onCommitFiberUnmount(S_,n)}catch{}switch(n.tag){case 5:os||Xh(n,e);case 6:var r=Ni,i=ra;Ni=null,Wl(t,e,n),Ni=r,ra=i,Ni!==null&&(ra?(t=Ni,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ni.removeChild(n.stateNode));break;case 18:Ni!==null&&(ra?(t=Ni,n=n.stateNode,t.nodeType===8?ib(t.parentNode,n):t.nodeType===1&&ib(t,n),Kp(t)):ib(Ni,n.stateNode));break;case 4:r=Ni,i=ra,Ni=n.stateNode.containerInfo,ra=!0,Wl(t,e,n),Ni=r,ra=i;break;case 0:case 11:case 14:case 15:if(!os&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,h=a.destroy;a=a.tag,h!==void 0&&(a&2||a&4)&&X1(n,e,h),i=i.next}while(i!==r)}Wl(t,e,n);break;case 1:if(!os&&(Xh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Zr(n,e,l)}Wl(t,e,n);break;case 21:Wl(t,e,n);break;case 22:n.mode&1?(os=(r=os)||n.memoizedState!==null,Wl(t,e,n),os=r):Wl(t,e,n);break;default:Wl(t,e,n)}}function nC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new _N),e.forEach(function(r){var i=AN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ea(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=t,h=e,l=h;e:for(;l!==null;){switch(l.tag){case 5:Ni=l.stateNode,ra=!1;break e;case 3:Ni=l.stateNode.containerInfo,ra=!0;break e;case 4:Ni=l.stateNode.containerInfo,ra=!0;break e}l=l.return}if(Ni===null)throw Error(ft(160));sR(a,h,i),Ni=null,ra=!1;var m=i.alternate;m!==null&&(m.return=null),i.return=null}catch(_){Zr(i,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oR(e,t),e=e.sibling}function oR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ea(e,t),xa(t),r&4){try{zp(3,t,t.return),M_(3,t)}catch(D){Zr(t,t.return,D)}try{zp(5,t,t.return)}catch(D){Zr(t,t.return,D)}}break;case 1:ea(e,t),xa(t),r&512&&n!==null&&Xh(n,n.return);break;case 5:if(ea(e,t),xa(t),r&512&&n!==null&&Xh(n,n.return),t.flags&32){var i=t.stateNode;try{qp(i,"")}catch(D){Zr(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,h=n!==null?n.memoizedProps:a,l=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&AM(i,a),w1(l,h);var _=w1(l,a);for(h=0;h<m.length;h+=2){var S=m[h],P=m[h+1];S==="style"?RM(i,P):S==="dangerouslySetInnerHTML"?MM(i,P):S==="children"?qp(i,P):oS(i,S,P,_)}switch(l){case"input":y1(i,a);break;case"textarea":IM(i,a);break;case"select":var A=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var L=a.value;L!=null?nd(i,!!a.multiple,L,!1):A!==!!a.multiple&&(a.defaultValue!=null?nd(i,!!a.multiple,a.defaultValue,!0):nd(i,!!a.multiple,a.multiple?[]:"",!1))}i[nm]=a}catch(D){Zr(t,t.return,D)}}break;case 6:if(ea(e,t),xa(t),r&4){if(t.stateNode===null)throw Error(ft(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(D){Zr(t,t.return,D)}}break;case 3:if(ea(e,t),xa(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Kp(e.containerInfo)}catch(D){Zr(t,t.return,D)}break;case 4:ea(e,t),xa(t);break;case 13:ea(e,t),xa(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(BS=oi())),r&4&&nC(t);break;case 22:if(S=n!==null&&n.memoizedState!==null,t.mode&1?(os=(_=os)||S,ea(e,t),os=_):ea(e,t),xa(t),r&8192){if(_=t.memoizedState!==null,(t.stateNode.isHidden=_)&&!S&&t.mode&1)for(Zt=t,S=t.child;S!==null;){for(P=Zt=S;Zt!==null;){switch(A=Zt,L=A.child,A.tag){case 0:case 11:case 14:case 15:zp(4,A,A.return);break;case 1:Xh(A,A.return);var O=A.stateNode;if(typeof O.componentWillUnmount=="function"){r=A,n=A.return;try{e=r,O.props=e.memoizedProps,O.state=e.memoizedState,O.componentWillUnmount()}catch(D){Zr(r,n,D)}}break;case 5:Xh(A,A.return);break;case 22:if(A.memoizedState!==null){iC(P);continue}}L!==null?(L.return=A,Zt=L):iC(P)}S=S.sibling}e:for(S=null,P=t;;){if(P.tag===5){if(S===null){S=P;try{i=P.stateNode,_?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=P.stateNode,m=P.memoizedProps.style,h=m!=null&&m.hasOwnProperty("display")?m.display:null,l.style.display=LM("display",h))}catch(D){Zr(t,t.return,D)}}}else if(P.tag===6){if(S===null)try{P.stateNode.nodeValue=_?"":P.memoizedProps}catch(D){Zr(t,t.return,D)}}else if((P.tag!==22&&P.tag!==23||P.memoizedState===null||P===t)&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===t)break e;for(;P.sibling===null;){if(P.return===null||P.return===t)break e;S===P&&(S=null),P=P.return}S===P&&(S=null),P.sibling.return=P.return,P=P.sibling}}break;case 19:ea(e,t),xa(t),r&4&&nC(t);break;case 21:break;default:ea(e,t),xa(t)}}function xa(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iR(n)){var r=n;break e}n=n.return}throw Error(ft(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(qp(i,""),r.flags&=-33);var a=tC(t);J1(t,a,i);break;case 3:case 4:var h=r.stateNode.containerInfo,l=tC(t);K1(t,l,h);break;default:throw Error(ft(161))}}catch(m){Zr(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function xN(t,e,n){Zt=t,aR(t)}function aR(t,e,n){for(var r=(t.mode&1)!==0;Zt!==null;){var i=Zt,a=i.child;if(i.tag===22&&r){var h=i.memoizedState!==null||vy;if(!h){var l=i.alternate,m=l!==null&&l.memoizedState!==null||os;l=vy;var _=os;if(vy=h,(os=m)&&!_)for(Zt=i;Zt!==null;)h=Zt,m=h.child,h.tag===22&&h.memoizedState!==null?sC(i):m!==null?(m.return=h,Zt=m):sC(i);for(;a!==null;)Zt=a,aR(a),a=a.sibling;Zt=i,vy=l,os=_}rC(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Zt=a):rC(t)}}function rC(t){for(;Zt!==null;){var e=Zt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:os||M_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!os)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:na(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&VP(e,a,r);break;case 3:var h=e.updateQueue;if(h!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}VP(e,h,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var S=_.memoizedState;if(S!==null){var P=S.dehydrated;P!==null&&Kp(P)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}os||e.flags&512&&Y1(e)}catch(A){Zr(e,e.return,A)}}if(e===t){Zt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Zt=n;break}Zt=e.return}}function iC(t){for(;Zt!==null;){var e=Zt;if(e===t){Zt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Zt=n;break}Zt=e.return}}function sC(t){for(;Zt!==null;){var e=Zt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{M_(4,e)}catch(m){Zr(e,n,m)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(m){Zr(e,i,m)}}var a=e.return;try{Y1(e)}catch(m){Zr(e,a,m)}break;case 5:var h=e.return;try{Y1(e)}catch(m){Zr(e,h,m)}}}catch(m){Zr(e,e.return,m)}if(e===t){Zt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Zt=l;break}Zt=e.return}}var bN=Math.ceil,q0=wl.ReactCurrentDispatcher,FS=wl.ReactCurrentOwner,Lo=wl.ReactCurrentBatchConfig,Un=0,Ai=null,hi=null,ji=0,Ks=0,Yh=Cc(0),vi=0,lm=null,Eu=0,L_=0,NS=0,Dp=null,Rs=null,BS=0,xd=1/0,il=null,Z0=!1,Q1=null,gc=null,xy=!1,sc=null,X0=0,Fp=0,ew=null,c0=-1,u0=0;function Ts(){return Un&6?oi():c0!==-1?c0:c0=oi()}function yc(t){return t.mode&1?Un&2&&ji!==0?ji&-ji:iN.transition!==null?(u0===0&&(u0=WM()),u0):(t=tr,t!==0||(t=window.event,t=t===void 0?16:JM(t.type)),t):1}function la(t,e,n,r){if(50<Fp)throw Fp=0,ew=null,Error(ft(185));Mm(t,n,r),(!(Un&2)||t!==Ai)&&(t===Ai&&(!(Un&2)&&(L_|=n),vi===4&&nc(t,ji)),Ns(t,r),n===1&&Un===0&&!(e.mode&1)&&(xd=oi()+500,A_&&Ac()))}function Ns(t,e){var n=t.callbackNode;i4(t,e);var r=L0(t,t===Ai?ji:0);if(r===0)n!==null&&pP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&pP(n),e===1)t.tag===0?rN(oC.bind(null,t)):yL(oC.bind(null,t)),Q4(function(){!(Un&6)&&Ac()}),n=null;else{switch(HM(r)){case 1:n=hS;break;case 4:n=$M;break;case 16:n=M0;break;case 536870912:n=GM;break;default:n=M0}n=mR(n,lR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lR(t,e){if(c0=-1,u0=0,Un&6)throw Error(ft(327));var n=t.callbackNode;if(ad()&&t.callbackNode!==n)return null;var r=L0(t,t===Ai?ji:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Y0(t,r);else{e=r;var i=Un;Un|=2;var a=uR();(Ai!==t||ji!==e)&&(il=null,xd=oi()+500,yu(t,e));do try{TN();break}catch(l){cR(t,l)}while(1);TS(),q0.current=a,Un=i,hi!==null?e=0:(Ai=null,ji=0,e=vi)}if(e!==0){if(e===2&&(i=C1(t),i!==0&&(r=i,e=tw(t,i))),e===1)throw n=lm,yu(t,0),nc(t,r),Ns(t,oi()),n;if(e===6)nc(t,r);else{if(i=t.current.alternate,!(r&30)&&!wN(i)&&(e=Y0(t,r),e===2&&(a=C1(t),a!==0&&(r=a,e=tw(t,a))),e===1))throw n=lm,yu(t,0),nc(t,r),Ns(t,oi()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ft(345));case 2:iu(t,Rs,il);break;case 3:if(nc(t,r),(r&130023424)===r&&(e=BS+500-oi(),10<e)){if(L0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ts(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=z1(iu.bind(null,t,Rs,il),e);break}iu(t,Rs,il);break;case 4:if(nc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var h=31-aa(r);a=1<<h,h=e[h],h>i&&(i=h),r&=~a}if(r=i,r=oi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bN(r/1960))-r,10<r){t.timeoutHandle=z1(iu.bind(null,t,Rs,il),r);break}iu(t,Rs,il);break;case 5:iu(t,Rs,il);break;default:throw Error(ft(329))}}}return Ns(t,oi()),t.callbackNode===n?lR.bind(null,t):null}function tw(t,e){var n=Dp;return t.current.memoizedState.isDehydrated&&(yu(t,e).flags|=256),t=Y0(t,e),t!==2&&(e=Rs,Rs=n,e!==null&&nw(e)),t}function nw(t){Rs===null?Rs=t:Rs.push.apply(Rs,t)}function wN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ua(a(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function nc(t,e){for(e&=~NS,e&=~L_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-aa(e),r=1<<n;t[n]=-1,e&=~r}}function oC(t){if(Un&6)throw Error(ft(327));ad();var e=L0(t,0);if(!(e&1))return Ns(t,oi()),null;var n=Y0(t,e);if(t.tag!==0&&n===2){var r=C1(t);r!==0&&(e=r,n=tw(t,r))}if(n===1)throw n=lm,yu(t,0),nc(t,e),Ns(t,oi()),n;if(n===6)throw Error(ft(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,iu(t,Rs,il),Ns(t,oi()),null}function jS(t,e){var n=Un;Un|=1;try{return t(e)}finally{Un=n,Un===0&&(xd=oi()+500,A_&&Ac())}}function Pu(t){sc!==null&&sc.tag===0&&!(Un&6)&&ad();var e=Un;Un|=1;var n=Lo.transition,r=tr;try{if(Lo.transition=null,tr=1,t)return t()}finally{tr=r,Lo.transition=n,Un=e,!(Un&6)&&Ac()}}function VS(){Ks=Yh.current,Er(Yh)}function yu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,J4(n)),hi!==null)for(n=hi.return;n!==null;){var r=n;switch(bS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&F0();break;case 3:_d(),Er(Ds),Er(ls),kS();break;case 5:IS(r);break;case 4:_d();break;case 13:Er(Dr);break;case 19:Er(Dr);break;case 10:ES(r.type._context);break;case 22:case 23:VS()}n=n.return}if(Ai=t,hi=t=_c(t.current,null),ji=Ks=e,vi=0,lm=null,NS=L_=Eu=0,Rs=Dp=null,hu!==null){for(e=0;e<hu.length;e++)if(n=hu[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var h=a.next;a.next=i,r.next=h}n.pending=r}hu=null}return t}function cR(t,e){do{var n=hi;try{if(TS(),o0.current=H0,W0){for(var r=Nr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}W0=!1}if(Tu=0,Pi=_i=Nr=null,Op=!1,sm=0,FS.current=null,n===null||n.return===null){vi=1,lm=e,hi=null;break}e:{var a=t,h=n.return,l=n,m=e;if(e=ji,l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var _=m,S=l,P=S.tag;if(!(S.mode&1)&&(P===0||P===11||P===15)){var A=S.alternate;A?(S.updateQueue=A.updateQueue,S.memoizedState=A.memoizedState,S.lanes=A.lanes):(S.updateQueue=null,S.memoizedState=null)}var L=qP(h);if(L!==null){L.flags&=-257,ZP(L,h,l,a,e),L.mode&1&&HP(a,_,e),e=L,m=_;var O=e.updateQueue;if(O===null){var D=new Set;D.add(m),e.updateQueue=D}else O.add(m);break e}else{if(!(e&1)){HP(a,_,e),US();break e}m=Error(ft(426))}}else if(Lr&&l.mode&1){var W=qP(h);if(W!==null){!(W.flags&65536)&&(W.flags|=256),ZP(W,h,l,a,e),wS(vd(m,l));break e}}a=m=vd(m,l),vi!==4&&(vi=2),Dp===null?Dp=[a]:Dp.push(a),a=h;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var z=HL(a,m,e);jP(a,z);break e;case 1:l=m;var N=a.type,F=a.stateNode;if(!(a.flags&128)&&(typeof N.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(gc===null||!gc.has(F)))){a.flags|=65536,e&=-e,a.lanes|=e;var $=qL(a,l,e);jP(a,$);break e}}a=a.return}while(a!==null)}dR(n)}catch(Q){e=Q,hi===n&&n!==null&&(hi=n=n.return);continue}break}while(1)}function uR(){var t=q0.current;return q0.current=H0,t===null?H0:t}function US(){(vi===0||vi===3||vi===2)&&(vi=4),Ai===null||!(Eu&268435455)&&!(L_&268435455)||nc(Ai,ji)}function Y0(t,e){var n=Un;Un|=2;var r=uR();(Ai!==t||ji!==e)&&(il=null,yu(t,e));do try{SN();break}catch(i){cR(t,i)}while(1);if(TS(),Un=n,q0.current=r,hi!==null)throw Error(ft(261));return Ai=null,ji=0,vi}function SN(){for(;hi!==null;)hR(hi)}function TN(){for(;hi!==null&&!X5();)hR(hi)}function hR(t){var e=pR(t.alternate,t,Ks);t.memoizedProps=t.pendingProps,e===null?dR(t):hi=e,FS.current=null}function dR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yN(n,e),n!==null){n.flags&=32767,hi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vi=6,hi=null;return}}else if(n=gN(n,e,Ks),n!==null){hi=n;return}if(e=e.sibling,e!==null){hi=e;return}hi=e=t}while(e!==null);vi===0&&(vi=5)}function iu(t,e,n){var r=tr,i=Lo.transition;try{Lo.transition=null,tr=1,EN(t,e,n,r)}finally{Lo.transition=i,tr=r}return null}function EN(t,e,n,r){do ad();while(sc!==null);if(Un&6)throw Error(ft(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ft(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(s4(t,a),t===Ai&&(hi=Ai=null,ji=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xy||(xy=!0,mR(M0,function(){return ad(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Lo.transition,Lo.transition=null;var h=tr;tr=1;var l=Un;Un|=4,FS.current=null,vN(t,n),oR(n,t),W4(R1),R0=!!L1,R1=L1=null,t.current=n,xN(n),Y5(),Un=l,tr=h,Lo.transition=a}else t.current=n;if(xy&&(xy=!1,sc=t,X0=i),a=t.pendingLanes,a===0&&(gc=null),Q5(n.stateNode),Ns(t,oi()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Z0)throw Z0=!1,t=Q1,Q1=null,t;return X0&1&&t.tag!==0&&ad(),a=t.pendingLanes,a&1?t===ew?Fp++:(Fp=0,ew=t):Fp=0,Ac(),null}function ad(){if(sc!==null){var t=HM(X0),e=Lo.transition,n=tr;try{if(Lo.transition=null,tr=16>t?16:t,sc===null)var r=!1;else{if(t=sc,sc=null,X0=0,Un&6)throw Error(ft(331));var i=Un;for(Un|=4,Zt=t.current;Zt!==null;){var a=Zt,h=a.child;if(Zt.flags&16){var l=a.deletions;if(l!==null){for(var m=0;m<l.length;m++){var _=l[m];for(Zt=_;Zt!==null;){var S=Zt;switch(S.tag){case 0:case 11:case 15:zp(8,S,a)}var P=S.child;if(P!==null)P.return=S,Zt=P;else for(;Zt!==null;){S=Zt;var A=S.sibling,L=S.return;if(rR(S),S===_){Zt=null;break}if(A!==null){A.return=L,Zt=A;break}Zt=L}}}var O=a.alternate;if(O!==null){var D=O.child;if(D!==null){O.child=null;do{var W=D.sibling;D.sibling=null,D=W}while(D!==null)}}Zt=a}}if(a.subtreeFlags&2064&&h!==null)h.return=a,Zt=h;else e:for(;Zt!==null;){if(a=Zt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:zp(9,a,a.return)}var z=a.sibling;if(z!==null){z.return=a.return,Zt=z;break e}Zt=a.return}}var N=t.current;for(Zt=N;Zt!==null;){h=Zt;var F=h.child;if(h.subtreeFlags&2064&&F!==null)F.return=h,Zt=F;else e:for(h=N;Zt!==null;){if(l=Zt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:M_(9,l)}}catch(Q){Zr(l,l.return,Q)}if(l===h){Zt=null;break e}var $=l.sibling;if($!==null){$.return=l.return,Zt=$;break e}Zt=l.return}}if(Un=i,Ac(),Ma&&typeof Ma.onPostCommitFiberRoot=="function")try{Ma.onPostCommitFiberRoot(S_,t)}catch{}r=!0}return r}finally{tr=n,Lo.transition=e}}return!1}function aC(t,e,n){e=vd(n,e),e=HL(t,e,1),t=mc(t,e,1),e=Ts(),t!==null&&(Mm(t,1,e),Ns(t,e))}function Zr(t,e,n){if(t.tag===3)aC(t,t,n);else for(;e!==null;){if(e.tag===3){aC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gc===null||!gc.has(r))){t=vd(n,t),t=qL(e,t,1),e=mc(e,t,1),t=Ts(),e!==null&&(Mm(e,1,t),Ns(e,t));break}}e=e.return}}function PN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ts(),t.pingedLanes|=t.suspendedLanes&n,Ai===t&&(ji&n)===n&&(vi===4||vi===3&&(ji&130023424)===ji&&500>oi()-BS?yu(t,0):NS|=n),Ns(t,e)}function fR(t,e){e===0&&(t.mode&1?(e=uy,uy<<=1,!(uy&130023424)&&(uy=4194304)):e=1);var n=Ts();t=fl(t,e),t!==null&&(Mm(t,e,n),Ns(t,n))}function CN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fR(t,n)}function AN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ft(314))}r!==null&&r.delete(e),fR(t,n)}var pR;pR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ds.current)Os=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Os=!1,mN(t,e,n);Os=!!(t.flags&131072)}else Os=!1,Lr&&e.flags&1048576&&_L(e,j0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;l0(t,e),t=e.pendingProps;var i=md(e,ls.current);od(e,n),i=LS(null,e,r,t,i,n);var a=RS();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fs(r)?(a=!0,N0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,CS(e),i.updater=k_,e.stateNode=i,i._reactInternals=e,U1(e,r,t,n),e=W1(null,e,r,!0,a,n)):(e.tag=0,Lr&&a&&xS(e),bs(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(l0(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=kN(r),t=na(r,t),i){case 0:e=G1(null,e,r,t,n);break e;case 1:e=KP(null,e,r,t,n);break e;case 11:e=XP(null,e,r,t,n);break e;case 14:e=YP(null,e,r,na(r.type,t),n);break e}throw Error(ft(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),G1(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),KP(t,e,r,i,n);case 3:e:{if(KL(e),t===null)throw Error(ft(387));r=e.pendingProps,a=e.memoizedState,i=a.element,TL(t,e),$0(e,r,null,n);var h=e.memoizedState;if(r=h.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=vd(Error(ft(423)),e),e=JP(t,e,r,n,i);break e}else if(r!==i){i=vd(Error(ft(424)),e),e=JP(t,e,r,n,i);break e}else for(to=pc(e.stateNode.containerInfo.firstChild),ro=e,Lr=!0,ia=null,n=wL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(gd(),r===i){e=pl(t,e,n);break e}bs(t,e,r,n)}e=e.child}return e;case 5:return EL(e),t===null&&B1(e),r=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,h=i.children,O1(r,i)?h=null:a!==null&&O1(r,a)&&(e.flags|=32),YL(t,e),bs(t,e,h,n),e.child;case 6:return t===null&&B1(e),null;case 13:return JL(t,e,n);case 4:return AS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yd(e,null,r,n):bs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),XP(t,e,r,i,n);case 7:return bs(t,e,e.pendingProps,n),e.child;case 8:return bs(t,e,e.pendingProps.children,n),e.child;case 12:return bs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,a=e.memoizedProps,h=i.value,vr(V0,r._currentValue),r._currentValue=h,a!==null)if(ua(a.value,h)){if(a.children===i.children&&!Ds.current){e=pl(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){h=a.child;for(var m=l.firstContext;m!==null;){if(m.context===r){if(a.tag===1){m=ul(-1,n&-n),m.tag=2;var _=a.updateQueue;if(_!==null){_=_.shared;var S=_.pending;S===null?m.next=m:(m.next=S.next,S.next=m),_.pending=m}}a.lanes|=n,m=a.alternate,m!==null&&(m.lanes|=n),j1(a.return,n,e),l.lanes|=n;break}m=m.next}}else if(a.tag===10)h=a.type===e.type?null:a.child;else if(a.tag===18){if(h=a.return,h===null)throw Error(ft(341));h.lanes|=n,l=h.alternate,l!==null&&(l.lanes|=n),j1(h,n,e),h=a.sibling}else h=a.child;if(h!==null)h.return=a;else for(h=a;h!==null;){if(h===e){h=null;break}if(a=h.sibling,a!==null){a.return=h.return,h=a;break}h=h.return}a=h}bs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,od(e,n),i=zo(i),r=r(i),e.flags|=1,bs(t,e,r,n),e.child;case 14:return r=e.type,i=na(r,e.pendingProps),i=na(r.type,i),YP(t,e,r,i,n);case 15:return ZL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),l0(t,e),e.tag=1,Fs(r)?(t=!0,N0(e)):t=!1,od(e,n),WL(e,r,i),U1(e,r,i,n),W1(null,e,r,!0,t,n);case 19:return QL(t,e,n);case 22:return XL(t,e,n)}throw Error(ft(156,e.tag))};function mR(t,e){return UM(t,e)}function IN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ko(t,e,n,r){return new IN(t,e,n,r)}function $S(t){return t=t.prototype,!(!t||!t.isReactComponent)}function kN(t){if(typeof t=="function")return $S(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lS)return 11;if(t===cS)return 14}return 2}function _c(t,e){var n=t.alternate;return n===null?(n=ko(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function h0(t,e,n,r,i,a){var h=2;if(r=t,typeof t=="function")$S(t)&&(h=1);else if(typeof t=="string")h=5;else e:switch(t){case jh:return _u(n.children,i,a,e);case aS:h=8,i|=8;break;case d1:return t=ko(12,n,e,i|2),t.elementType=d1,t.lanes=a,t;case f1:return t=ko(13,n,e,i),t.elementType=f1,t.lanes=a,t;case p1:return t=ko(19,n,e,i),t.elementType=p1,t.lanes=a,t;case EM:return R_(n,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case SM:h=10;break e;case TM:h=9;break e;case lS:h=11;break e;case cS:h=14;break e;case Ql:h=16,r=null;break e}throw Error(ft(130,t==null?t:typeof t,""))}return e=ko(h,n,e,i),e.elementType=t,e.type=r,e.lanes=a,e}function _u(t,e,n,r){return t=ko(7,t,r,e),t.lanes=n,t}function R_(t,e,n,r){return t=ko(22,t,r,e),t.elementType=EM,t.lanes=n,t.stateNode={isHidden:!1},t}function db(t,e,n){return t=ko(6,t,null,e),t.lanes=n,t}function fb(t,e,n){return e=ko(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qx(0),this.expirationTimes=qx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function GS(t,e,n,r,i,a,h,l,m){return t=new MN(t,e,n,l,m),e===1?(e=1,a===!0&&(e|=8)):e=0,a=ko(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},CS(a),t}function LN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gR(t){if(!t)return Sc;t=t._reactInternals;e:{if(Lu(t)!==t||t.tag!==1)throw Error(ft(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ft(171))}if(t.tag===1){var n=t.type;if(Fs(n))return gL(t,n,e)}return e}function yR(t,e,n,r,i,a,h,l,m){return t=GS(n,r,!0,t,i,a,h,l,m),t.context=gR(null),n=t.current,r=Ts(),i=yc(n),a=ul(r,i),a.callback=e??null,mc(n,a,i),t.current.lanes=i,Mm(t,i,r),Ns(t,r),t}function O_(t,e,n,r){var i=e.current,a=Ts(),h=yc(i);return n=gR(n),e.context===null?e.context=n:e.pendingContext=n,e=ul(a,h),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=mc(i,e,h),t!==null&&(la(t,i,h,a),s0(t,i,h)),h}function K0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function lC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function WS(t,e){lC(t,e),(t=t.alternate)&&lC(t,e)}function RN(){return null}var _R=typeof reportError=="function"?reportError:function(t){console.error(t)};function HS(t){this._internalRoot=t}z_.prototype.render=HS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ft(409));O_(t,e,null,null)};z_.prototype.unmount=HS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pu(function(){O_(null,t,null,null)}),e[dl]=null}};function z_(t){this._internalRoot=t}z_.prototype.unstable_scheduleHydration=function(t){if(t){var e=XM();t={blockedOn:null,target:t,priority:e};for(var n=0;n<tc.length&&e!==0&&e<tc[n].priority;n++);tc.splice(n,0,t),n===0&&KM(t)}};function qS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function D_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cC(){}function ON(t,e,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var _=K0(h);a.call(_)}}var h=yR(e,r,t,0,null,!1,!1,"",cC);return t._reactRootContainer=h,t[dl]=h.current,em(t.nodeType===8?t.parentNode:t),Pu(),h}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var _=K0(m);l.call(_)}}var m=GS(t,0,!1,null,null,!1,!1,"",cC);return t._reactRootContainer=m,t[dl]=m.current,em(t.nodeType===8?t.parentNode:t),Pu(function(){O_(e,m,n,r)}),m}function F_(t,e,n,r,i){var a=n._reactRootContainer;if(a){var h=a;if(typeof i=="function"){var l=i;i=function(){var m=K0(h);l.call(m)}}O_(e,h,t,i)}else h=ON(n,e,t,i,r);return K0(h)}qM=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Sp(e.pendingLanes);n!==0&&(dS(e,n|1),Ns(e,oi()),!(Un&6)&&(xd=oi()+500,Ac()))}break;case 13:Pu(function(){var r=fl(t,1);if(r!==null){var i=Ts();la(r,t,1,i)}}),WS(t,1)}};fS=function(t){if(t.tag===13){var e=fl(t,134217728);if(e!==null){var n=Ts();la(e,t,134217728,n)}WS(t,134217728)}};ZM=function(t){if(t.tag===13){var e=yc(t),n=fl(t,e);if(n!==null){var r=Ts();la(n,t,e,r)}WS(t,e)}};XM=function(){return tr};YM=function(t,e){var n=tr;try{return tr=t,e()}finally{tr=n}};T1=function(t,e,n){switch(e){case"input":if(y1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=C_(r);if(!i)throw Error(ft(90));CM(r),y1(r,i)}}}break;case"textarea":IM(t,n);break;case"select":e=n.value,e!=null&&nd(t,!!n.multiple,e,!1)}};DM=jS;FM=Pu;var zN={usingClientEntryPoint:!1,Events:[Rm,Gh,C_,OM,zM,jS]},sp={findFiberByHostInstance:uu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DN={bundleType:sp.bundleType,version:sp.version,rendererPackageName:sp.rendererPackageName,rendererConfig:sp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=jM(t),t===null?null:t.stateNode},findFiberByHostInstance:sp.findFiberByHostInstance||RN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var by=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!by.isDisabled&&by.supportsFiber)try{S_=by.inject(DN),Ma=by}catch{}}co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zN;co.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qS(e))throw Error(ft(200));return LN(t,e,null,n)};co.createRoot=function(t,e){if(!qS(t))throw Error(ft(299));var n=!1,r="",i=_R;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=GS(t,1,!1,null,null,n,!1,r,i),t[dl]=e.current,em(t.nodeType===8?t.parentNode:t),new HS(e)};co.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ft(188)):(t=Object.keys(t).join(","),Error(ft(268,t)));return t=jM(e),t=t===null?null:t.stateNode,t};co.flushSync=function(t){return Pu(t)};co.hydrate=function(t,e,n){if(!D_(e))throw Error(ft(200));return F_(null,t,e,!0,n)};co.hydrateRoot=function(t,e,n){if(!qS(t))throw Error(ft(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",h=_R;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),e=yR(e,null,t,1,n??null,i,!1,a,h),t[dl]=e.current,em(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new z_(e)};co.render=function(t,e,n){if(!D_(e))throw Error(ft(200));return F_(null,t,e,!1,n)};co.unmountComponentAtNode=function(t){if(!D_(t))throw Error(ft(40));return t._reactRootContainer?(Pu(function(){F_(null,null,t,!1,function(){t._reactRootContainer=null,t[dl]=null})}),!0):!1};co.unstable_batchedUpdates=jS;co.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!D_(n))throw Error(ft(200));if(t==null||t._reactInternals===void 0)throw Error(ft(38));return F_(t,e,n,!1,r)};co.version="18.3.1-next-f1338f8080-20240426";function vR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vR)}catch(t){console.error(t)}}vR(),vM.exports=co;var zm=vM.exports;const wy=Im(zm);var uC=zm;u1.createRoot=uC.createRoot,u1.hydrateRoot=uC.hydrateRoot;function J0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const ZS=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),hC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);hC&&parseFloat(hC[1]);const FN="3.4.15";function ml(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const d0=typeof process!="object"||String(process)!=="[object process]"||process.browser,NN=typeof window<"u"&&typeof window.orientation<"u",dC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);dC&&parseFloat(dC[1]);function cm(t){"@babel/helpers - typeof";return cm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cm(t)}function BN(t,e){if(cm(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(cm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jN(t){var e=BN(t,"string");return cm(e)=="symbol"?e:e+""}function K(t,e,n){return(e=jN(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VN{constructor(e,n){K(this,"name",void 0),K(this,"workerThread",void 0),K(this,"isRunning",!0),K(this,"result",void 0),K(this,"_resolve",()=>{}),K(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ml(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ml(this.isRunning),this.isRunning=!1,this._reject(e)}}let pb=class{terminate(){}};const mb=new Map;function UN(t){ml(t.source&&!t.url||!t.source&&t.url);let e=mb.get(t.source||t.url);return e||(t.url&&(e=$N(t.url),mb.set(t.url,e)),t.source&&(e=xR(t.source),mb.set(t.source,e))),ml(e),e}function $N(t){if(!t.startsWith("http"))return t;const e=GN(t);return xR(e)}function xR(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function GN(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function bR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(fC(t))r.add(t);else if(fC(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)bR(t[i],e,r)}}return n===void 0?Array.from(r):[]}function fC(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const gb=()=>{};class rw{static isSupported(){return typeof Worker<"u"&&d0||typeof pb<"u"&&!d0}constructor(e){K(this,"name",void 0),K(this,"source",void 0),K(this,"url",void 0),K(this,"terminated",!1),K(this,"worker",void 0),K(this,"onMessage",void 0),K(this,"onError",void 0),K(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ml(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=gb,this.onError=a=>console.log(a),this.worker=d0?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=gb,this.onError=gb,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||bR(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=UN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new pb(r,{eval:!1})}else if(this.source)e=new pb(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class WN{static isSupported(){return rw.isSupported()}constructor(e){K(this,"name","unnamed"),K(this,"source",void 0),K(this,"url",void 0),K(this,"maxConcurrency",1),K(this,"maxMobileConcurrency",1),K(this,"onDebug",()=>{}),K(this,"reuseWorkers",!0),K(this,"props",{}),K(this,"jobQueue",[]),K(this,"idleQueue",[]),K(this,"count",0),K(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(a,h,l)=>a.done(l),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(a,h)=>a.error(h);const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new VN(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new rw({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return NN?this.maxMobileConcurrency:this.maxConcurrency}}const HN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ol{static isSupported(){return rw.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ol._workerFarm=ol._workerFarm||new ol({}),ol._workerFarm.setProps(e),ol._workerFarm}constructor(e){K(this,"props",void 0),K(this,"workerPools",new Map),this.props={...HN},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let a=this.workerPools.get(n);return a||(a=new WN({name:n,source:r,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}K(ol,"_workerFarm",void 0);const qN="latest";function ZN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let a=t.version;a==="latest"&&(a=qN);const h=a?"@".concat(a):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(h,"/dist/").concat(r)}return ml(i),i}function XN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FN;ml(t,"no worker provided");const n=t.version;return!(!e||!n)}function YN(t,e){return!ol.isSupported()||!d0&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function KN(t,e,n,r,i){const a=t.id,h=ZN(t,n),m=ol.getWorkerFarm(n).getWorkerPool({name:a,url:h});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const _=await m.startJob("process-on-worker",JN.bind(null,i));return _.postMessage("process",{input:e,options:n,context:r}),await(await _.result).result}async function JN(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:a,options:h}=r;try{const l=await t(a,h);e.postMessage("done",{id:i,result:l})}catch(l){const m=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:i,error:m})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function QN(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}function eB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),i=r.reduce((l,m)=>l+m.byteLength,0),a=new Uint8Array(i);let h=0;for(const l of r)a.set(l,h),h+=l.byteLength;return a.buffer}async function tB(t){const e=[];for await(const n of t)e.push(n);return eB(...e)}function pC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class mC{constructor(e,n){K(this,"name",void 0),K(this,"type",void 0),K(this,"sampleSize",1),K(this,"time",void 0),K(this,"count",void 0),K(this,"samples",void 0),K(this,"lastTiming",void 0),K(this,"lastSampleTime",void 0),K(this,"lastSampleCount",void 0),K(this,"_count",0),K(this,"_time",0),K(this,"_samples",0),K(this,"_startTime",0),K(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=pC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(pC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class XS{constructor(e){K(this,"id",void 0),K(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof mC?this.stats[n]=e:this.stats[n]=new mC(n,r)),this.stats[n]}}let nB="";const gC={};function rB(t){for(const e in gC)if(t.startsWith(e)){const n=gC[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(nB).concat(t)),t}function iB(t){return t&&typeof t=="object"&&t.isBuffer}function wR(t){if(iB(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function SR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function sB(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const oB=t=>typeof t=="boolean",Np=t=>typeof t=="function",Dm=t=>t!==null&&typeof t=="object",yC=t=>Dm(t)&&t.constructor==={}.constructor,aB=t=>t&&typeof t[Symbol.iterator]=="function",lB=t=>t&&typeof t[Symbol.asyncIterator]=="function",Ru=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ou=t=>typeof Blob<"u"&&t instanceof Blob,cB=t=>t&&typeof t=="object"&&t.isBuffer,uB=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Dm(t)&&Np(t.tee)&&Np(t.cancel)&&Np(t.getReader),hB=t=>Dm(t)&&Np(t.read)&&Np(t.pipe)&&oB(t.readable),TR=t=>uB(t)||hB(t),dB=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,fB=/^([-\w.]+\/[-\w.+]+)/;function pB(t){const e=fB.exec(t);return e?e[1]:t}function _C(t){const e=dB.exec(t);return e?e[1]:""}const ER=/\?.*/;function mB(t){const e=t.match(ER);return e&&e[0]}function YS(t){return t.replace(ER,"")}function N_(t){return Ru(t)?t.url:Ou(t)?t.name||"":typeof t=="string"?t:""}function KS(t){if(Ru(t)){const e=t,n=e.headers.get("content-type")||"",r=YS(e.url);return pB(n)||_C(r)}return Ou(t)?t.type||"":typeof t=="string"?_C(t):""}function gB(t){return Ru(t)?t.headers["content-length"]||-1:Ou(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function PR(t){if(Ru(t))return t;const e={},n=gB(t);n>=0&&(e["content-length"]=String(n));const r=N_(t),i=KS(t);i&&(e["content-type"]=i);const a=await vB(t);a&&(e["x-first-bytes"]=a),typeof t=="string"&&(t=new TextEncoder().encode(t));const h=new Response(t,{headers:e});return Object.defineProperty(h,"url",{value:r}),h}async function yB(t){if(!t.ok){const e=await _B(t);throw new Error(e)}}async function _B(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function vB(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=a=>{var h;return r(a==null||(h=a.target)===null||h===void 0?void 0:h.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=xB(n);return"data:base64,".concat(r)}return null}function xB(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function vC(t,e){if(typeof t=="string"){t=rB(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await PR(t)}function CR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Sl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||CR()}const f0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Sy=f0.window||f0.self||f0.global,op=f0.process||{},AR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Sl();const yb=globalThis;function IR(t){if(!t&&!Sl())return"Node";if(CR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":yb.chrome?"Chrome":yb.safari?"Safari":yb.mozInnerScreenX?"Firefox":"Unknown"}function bB(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class wB{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";K(this,"storage",void 0),K(this,"id",void 0),K(this,"config",void 0),this.storage=bB(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function SB(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function TB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function _b(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const a=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(a/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(a,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let Q0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Q0||(Q0={}));function xC(t){return typeof t=="string"?Q0[t.toUpperCase()]||Q0.WHITE:t}function EB(t,e,n){return!Sl&&typeof t=="string"&&(e&&(e=xC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=xC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function PB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(a=>i===a)||(t[i]=t[i].bind(t)))}function e_(t,e){if(!t)throw new Error(e||"Assertion failed")}function bh(){let t;if(Sl&&"performance"in Sy){var e,n;t=Sy==null||(e=Sy.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in op){var r;const i=op==null||(r=op.hrtime)===null||r===void 0?void 0:r.call(op);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const wh={debug:Sl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},CB={enabled:!0,level:0};function Eo(){}const bC={},wC={once:!0};class Fm{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};K(this,"id",void 0),K(this,"VERSION",AR),K(this,"_startTs",bh()),K(this,"_deltaTs",bh()),K(this,"_storage",void 0),K(this,"userData",{}),K(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new wB("__probe-".concat(this.id,"__"),CB),this.timeStamp("".concat(this.id," started")),PB(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((bh()-this._startTs).toPrecision(10))}getDelta(){return Number((bh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){e_(e,n)}warn(e){return this._getLogFunction(0,e,wh.warn,arguments,wC)}error(e){return this._getLogFunction(0,e,wh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,wh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,wh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return this._getLogFunction(e,n,wh.debug||wh.info,arguments,wC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Eo,r&&[r],{tag:MB(n)}):Eo}image(e){let{logLevel:n,priority:r,image:i,message:a="",scale:h=1}=e;return this._shouldLog(n||r)?Sl?kB({image:i,message:a,scale:h}):IB():Eo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Eo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=SC({logLevel:e,message:n,opts:r}),{collapsed:a}=r;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Eo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=kR(e)}_getLogFunction(e,n,r,i,a){if(this._shouldLog(e)){a=SC({logLevel:e,message:n,args:i,opts:a}),r=r||a.method,e_(r),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=bh();const h=a.tag||a.message;if(a.once)if(!bC[h])bC[h]=bh();else return Eo;return n=AB(this.id,a.message,a),r.bind(console,n,...a.args)}return Eo}}K(Fm,"VERSION",AR);function kR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return e_(Number.isFinite(e)&&e>=0),e}function SC(t){const{logLevel:e,message:n}=t;t.logLevel=kR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return e_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function AB(t,e,n){if(typeof e=="string"){const r=n.time?TB(SB(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=EB(e,n.color,n.background)}return e}function IB(t){return console.warn("removed"),Eo}function kB(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const a=new Image;return a.onload=()=>{const h=_b(a,n,r);console.log(...h)},a.src=e,Eo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(..._b(e,n,r)),Eo;if(i.toLowerCase()==="canvas"){const a=new Image;return a.onload=()=>console.log(..._b(a,n,r)),a.src=e.toDataURL(),Eo}return Eo}function MB(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const TC=new Fm({id:"loaders.gl"});class LB{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class RB{constructor(){K(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const MR={fetch:null,mimeType:void 0,nothrow:!1,log:new RB,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ZS,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},OB={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function LR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const RR=()=>{const t=LR();return t.globalOptions=t.globalOptions||{...MR},t.globalOptions};function zB(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],DB(t,n),NB(e,t,r)}function DB(t,e){EC(t,null,MR,OB,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},a=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};EC(r,n.id,i,a,e)}}function EC(t,e,n,r,i){const a=e||"Top level",h=e?"".concat(e,"."):"";for(const l in t){const m=!e&&Dm(t[l]),_=l==="baseUri"&&!e,S=l==="workerUrl"&&e;if(!(l in n)&&!_&&!S){if(l in r)TC.warn("".concat(a," loader option '").concat(h).concat(l,"' no longer supported, use '").concat(r[l],"'"))();else if(!m){const P=FB(l,i);TC.warn("".concat(a," loader option '").concat(h).concat(l,"' not recognized. ").concat(P))()}}}}function FB(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const a in i.options){if(t===a)return"Did you mean '".concat(i.id,".").concat(a,"'?");const h=a.toLowerCase();(n.startsWith(h)||h.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(a,"'?"))}return r}function NB(t,e,n){const i={...t.options||{}};return BB(i,n),i.log===null&&(i.log=new LB),PC(i,RR()),PC(i,e),i}function PC(t,e){for(const n in e)if(n in e){const r=e[n];yC(r)&&yC(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function BB(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function JS(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function QS(t){var e,n;J0(t,"null loader"),J0(JS(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const OR=()=>{const t=LR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function jB(t){const e=OR();t=Array.isArray(t)?t:[t];for(const n of t){const r=QS(n);e.find(i=>r===i)||e.unshift(r)}}function VB(){return OR()}const UB=new Fm({id:"loaders.gl"}),$B=/\.([^.]+)$/;async function GB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!zR(t))return null;let i=CC(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ou(t)&&(t=await t.slice(0,10).arrayBuffer(),i=CC(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(DR(t));return i}function CC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!zR(t))return null;if(e&&!Array.isArray(e))return QS(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...VB()),HB(i);const a=WB(t,i,n,r);if(!a&&!(n!=null&&n.nothrow))throw new Error(DR(t));return a}function WB(t,e,n,r){const i=N_(t),a=KS(t),h=YS(i)||(r==null?void 0:r.url);let l=null,m="";if(n!=null&&n.mimeType&&(l=vb(e,n==null?void 0:n.mimeType),m="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||qB(e,h),m=m||(l?"matched url ".concat(h):""),l=l||vb(e,a),m=m||(l?"matched MIME type ".concat(a):""),l=l||XB(e,t),m=m||(l?"matched initial data ".concat(FR(t)):""),l=l||vb(e,n==null?void 0:n.fallbackMimeType),m=m||(l?"matched fallback MIME type ".concat(a):""),m){var _;UB.log(1,"selectLoader selected ".concat((_=l)===null||_===void 0?void 0:_.name,": ").concat(m,"."))}return l}function zR(t){return!(t instanceof Response&&t.status===204)}function DR(t){const e=N_(t),n=KS(t);let r="No valid loader found (";r+=e?"".concat(SR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?FR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function HB(t){for(const e of t)QS(e)}function qB(t,e){const n=e&&$B.exec(e),r=n&&n[1];return r?ZB(t,r):null}function ZB(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function vb(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function XB(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(YB(e,n))return n}else if(ArrayBuffer.isView(e)){if(AC(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&AC(e,0,n))return n;return null}function YB(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function AC(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>KB(t,e,n,i))}function KB(t,e,n,r){if(r instanceof ArrayBuffer)return QN(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=iw(t,e,r.length);return r===i;default:return!1}}function FR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?iw(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?iw(t,0,e):""}function iw(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let a=0;a<n;a++)i+=String.fromCharCode(r.getUint8(e+a));return i}const JB=256*1024;function*QB(t,e){const n=(e==null?void 0:e.chunkSize)||JB;let r=0;const i=new TextEncoder;for(;r<t.length;){const a=Math.min(t.length-r,n),h=t.slice(r,r+a);r+=a,yield i.encode(h)}}const e6=256*1024;function t6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=e6}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),a=new ArrayBuffer(i),h=new Uint8Array(t,r,i);new Uint8Array(a).set(h),r+=i,yield a}}()}const n6=1024*1024;async function*r6(t,e){const n=(e==null?void 0:e.chunkSize)||n6;let r=0;for(;r<t.size;){const i=r+n,a=await t.slice(r,i).arrayBuffer();r=i,yield a}}function IC(t,e){return ZS?i6(t,e):s6(t)}async function*i6(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:a,value:h}=await i;if(a)return;yield wR(h)}}catch{n.releaseLock()}}async function*s6(t,e){for await(const n of t)yield wR(n)}function o6(t,e){if(typeof t=="string")return QB(t,e);if(t instanceof ArrayBuffer)return t6(t,e);if(Ou(t))return r6(t,e);if(TR(t))return IC(t,e);if(Ru(t))return IC(t.body,e);throw new Error("makeIterator")}const NR="Cannot convert supplied data type";function a6(t,e,n){if(e.text&&typeof t=="string")return t;if(cB(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(NR)}async function l6(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return a6(t,e);if(Ou(t)&&(t=await PR(t)),Ru(t)){const i=t;return await yB(i),e.binary?await i.arrayBuffer():await i.text()}if(TR(t)&&(t=o6(t,n)),aB(t)||lB(t))return tB(t);throw new Error(NR)}function BR(t,e){const n=RR(),r=t||n;return typeof r.fetch=="function"?r.fetch:Dm(r.fetch)?i=>vC(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:vC}function c6(t,e,n){if(n)return n;const r={fetch:BR(e,t),...t};if(r.url){const i=YS(r.url);r.baseUrl=i,r.queryString=mB(r.url),r.filename=SR(i),r.baseUrl=sB(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function u6(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function e2(t,e,n,r){ml(!r||typeof r=="object"),e&&!Array.isArray(e)&&!JS(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=N_(t),h=u6(e,r),l=await GB(t,h,n);return l?(n=zB(n,l,h,i),r=c6({url:i,parse:e2,loaders:h},n,r||null),await h6(l,t,n,r)):null}async function h6(t,e,n,r){if(XN(t),Ru(e)){const i=e,{ok:a,redirected:h,status:l,statusText:m,type:_,url:S}=i,P=Object.fromEntries(i.headers.entries());r.response={headers:P,ok:a,redirected:h,status:l,statusText:m,type:_,url:S}}if(e=await l6(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(YN(t,n))return await KN(t,e,n,r,e2);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ml(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function sw(t,e,n,r){!Array.isArray(e)&&!JS(e)&&(n=e,e=void 0);const i=BR(n);let a=t;return typeof t=="string"&&(a=await i(t)),Ou(t)&&(a=await i(t)),await e2(a,e,n)}const d6="3.4.15",{_parseImageNode:f6}=globalThis,ow=typeof Image<"u",aw=typeof ImageBitmap<"u",p6=!!f6,lw=ZS?!0:p6;function m6(t){switch(t){case"auto":return aw||ow||lw;case"imagebitmap":return aw;case"image":return ow;case"data":return lw;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function g6(){if(aw)return"imagebitmap";if(ow)return"image";if(lw)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function y6(t){const e=v6(t);if(!e)throw new Error("Not an image");return e}function _6(t){switch(y6(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function v6(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const x6=/^data:image\/svg\+xml/,b6=/\.svg((\?|#).*)?$/;function t2(t){return t&&(x6.test(t)||b6.test(t))}function w6(t,e){if(t2(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(a){throw new Error(a.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return jR(t,e)}function jR(t,e){if(t2(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function VR(t,e,n){const r=w6(t,n),i=self.URL||self.webkitURL,a=typeof r!="string"&&i.createObjectURL(r);try{return await S6(a||r,e)}finally{a&&i.revokeObjectURL(a)}}async function S6(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=a=>i(new Error("Could not load image ".concat(t,": ").concat(a)))}catch(a){i(a)}})}const T6={};let kC=!0;async function E6(t,e,n){let r;t2(n)?r=await VR(t,e,n):r=jR(t,n);const i=e&&e.imagebitmap;return await P6(r,i)}async function P6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((C6(e)||!kC)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),kC=!1}return await createImageBitmap(t)}function C6(t){for(const e in t||T6)return!1;return!0}function A6(t){return!L6(t,"ftyp",4)||!(t[8]&96)?null:I6(t)}function I6(t){switch(k6(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function k6(t,e,n){return String.fromCharCode(...t.slice(e,n))}function M6(t){return[...t].map(e=>e.charCodeAt(0))}function L6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=M6(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Aa=!1,Bp=!0;function UR(t){const e=Nm(t);return O6(e)||F6(e)||z6(e)||D6(e)||R6(e)}function R6(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=A6(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function O6(t){const e=Nm(t);return e.byteLength>=24&&e.getUint32(0,Aa)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Aa),height:e.getUint32(20,Aa)}:null}function z6(t){const e=Nm(t);return e.byteLength>=10&&e.getUint32(0,Aa)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Bp),height:e.getUint16(8,Bp)}:null}function D6(t){const e=Nm(t);return e.byteLength>=14&&e.getUint16(0,Aa)===16973&&e.getUint32(2,Bp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Bp),height:e.getUint32(22,Bp)}:null}function F6(t){const e=Nm(t);if(!(e.byteLength>=3&&e.getUint16(0,Aa)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=N6();let a=2;for(;a+9<e.byteLength;){const h=e.getUint16(a,Aa);if(i.has(h))return{mimeType:"image/jpeg",height:e.getUint16(a+5,Aa),width:e.getUint16(a+7,Aa)};if(!r.has(h))return null;a+=2,a+=e.getUint16(a,Aa)}return null}function N6(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Nm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function B6(t,e){const{mimeType:n}=UR(t)||{},r=globalThis._parseImageNode;return J0(r),await r(t,n)}async function j6(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=n||{},h=V6(i);let l;switch(h){case"imagebitmap":l=await E6(t,e,a);break;case"image":l=await VR(t,e,a);break;case"data":l=await B6(t);break;default:J0(!1)}return i==="data"&&(l=_6(l)),l}function V6(t){switch(t){case"auto":case"data":return g6();default:return m6(t),t}}const U6=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],$6=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],G6={image:{type:"auto",decode:!0}},W6={id:"image",module:"images",name:"Images",version:d6,mimeTypes:$6,extensions:U6,parse:j6,tests:[t=>!!UR(new DataView(t))],options:G6},hr=new Fm({id:"deck"});let cw={};function H6(t){cw=t}function ss(t,e,n,r){hr.level>0&&cw[t]&&cw[t].call(null,e,n,r)}function q6(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Z6={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:q6,parseTextSync:JSON.parse};function X6(){const t="8.9.36",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(hr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:hr,_registerLoggers:H6},jB([Z6,[W6,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const Y6=X6(),Hn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Hn,"IDENTITY",{get:()=>(hr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Ia={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},um={common:0,meters:1,pixels:2},MC={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},an=new Fm({id:"luma.gl"});function ws(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const K6="Invalid WebGLRenderingContext",J6="Requires WebGL2";function B_(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Nn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Q6(t){return Nn(t)?t:null}function j_(t){return ws(B_(t),K6),t}function Ss(t){return ws(Nn(t),J6),t}const Ep={};function ej(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function tj(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function nj(t,e){Ep[t]=!0,e!==void 0&&ej(e)}function rj(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Ep[r]=!0);while(r!==0);for(r in Ep)if(Ep[r])return delete Ep[r],parseInt(r,10);return 0}}const Bm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Bm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Bm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const zu=function(e){const n=this;this.gl=e,rj(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(a){return a===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(a){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,a);const l=h.attribs[a];return l.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(a,h){switch(a){case 34962:n.currentArrayBuffer=h;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=h;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(a,h){const m=n.currentVertexArrayObject.attribs[a];switch(h){case 34975:return m.buffer;case 34338:return m.enabled;case 34339:return m.size;case 34340:return m.stride;case 34341:return m.type;case 34922:return m.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(a,h,l,m,_,S){const P=n.currentVertexArrayObject;P.maxAttrib=Math.max(P.maxAttrib,a);const A=P.attribs[a];return A.buffer=n.currentArrayBuffer,A.size=h,A.type=l,A.normalized=m,A.stride=_,A.offset=S,A.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{tj("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};zu.prototype.VERTEX_ARRAY_BINDING_OES=34229;zu.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Bm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};zu.prototype.createVertexArrayOES=function(){const e=new Bm(this);return this.vertexArrayObjects.push(e),e};zu.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};zu.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Bm&&e.hasBeenBound&&e.ext===this)};zu.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){nj(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const a=this.currentVertexArrayObject;if(i===a)return;(!i||a.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,a.elementArrayBuffer);let h=this.currentArrayBuffer;const l=Math.max(i?i.maxAttrib:0,a.maxAttrib);for(let m=0;m<=l;m++){const _=a.attribs[m],S=i?i.attribs[m]:null;if((!i||_.enabled!==S.enabled)&&(_.enabled?r.enableVertexAttribArray.call(n,m):r.disableVertexAttribArray.call(n,m)),_.enabled){let P=!1;(!i||_.buffer!==S.buffer)&&(h!==_.buffer&&(r.bindBuffer.call(n,34962,_.buffer),h=_.buffer),P=!0),(P||_.cached!==S.cached)&&r.vertexAttribPointer.call(n,m,_.size,_.type,_.normalized,_.stride,_.offset)}}this.currentArrayBuffer!==h&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function ij(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const a=n.call(this,i);return a||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new zu(this)),this.__OESVertexArrayObject))}}const LC="OES_element_index",RC="WEBGL_draw_buffers",sj="EXT_disjoint_timer_query",oj="EXT_disjoint_timer_query_webgl2",aj="EXT_texture_filter_anisotropic",OC="WEBGL_debug_renderer_info",lj=35723,cj=4352,uj=36795,hj=34047,dj=37445,fj=37446,_r=t=>Nn(t)?void 0:0,pj={3074:t=>Nn(t)?void 0:36064,[lj]:t=>Nn(t)?void 0:cj,35977:_r,32937:_r,[uj]:(t,e)=>{const n=Nn(t)?t.getExtension(oj):t.getExtension(sj);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[dj]:(t,e)=>{const n=t.getExtension(OC);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[fj]:(t,e)=>{const n=t.getExtension(OC);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[hj]:(t,e)=>{const n=t.luma.extensions[aj];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:_r,35071:_r,37447:_r,36063:(t,e)=>{if(!Nn(t)){const n=t.getExtension(RC);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:_r,35374:_r,35377:_r,34852:t=>{if(!Nn(t)){const e=t.getExtension(RC);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(LC)?2147483647:65535,33001:t=>t.getExtension(LC)?16777216:65535,33e3:t=>16777216,37157:_r,35373:_r,35657:_r,36183:_r,37137:_r,34045:_r,35978:_r,35979:_r,35968:_r,35376:_r,35375:_r,35659:_r,37154:_r,35371:_r,35658:_r,35076:_r,35077:_r,35380:_r};function mj(t,e,n){const r=pj[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const gj="OES_vertex_array_object",$R="ANGLE_instanced_arrays",yj="WEBGL_draw_buffers",_j="EXT_disjoint_timer_query",vj="EXT_texture_filter_anisotropic",xj="VertexArray requires WebGL2 or OES_vertex_array_object extension";function bj(t,e){return{webgl2:Nn(t),ext:t.getExtension(e)}}const GR={[gj]:{meta:{suffix:"OES"},createVertexArray:()=>{ws(!1,xj)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[$R]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){ws(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yj]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ws(!1)}},[_j]:{meta:{suffix:"EXT"},createQuery:()=>{ws(!1)},deleteQuery:()=>{ws(!1)},beginQuery:()=>{ws(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},xb={readBuffer:(t,e,n)=>{Nn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:a}=bj(t,$R);let h;switch(r){case 35069:h=i?void 0:!1;break;case 35070:h=!i&&!a?0:void 0;break}return h!==void 0?h:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Nn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Nn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,a=i[vj];r=a&&a.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:mj,hint(t,e,n,r){return e(n,r)}};function wj(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(ij(t),Sj(t),Ej(t,GR),Tj(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=wj;function Sj(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Tj(t,e){let{target:n,target2:r}=e;Object.keys(xb).forEach(i=>{if(typeof xb[i]=="function"){const a=t[i]?t[i].bind(t):()=>{},h=xb[i].bind(null,t,a);n[i]=h,r[i]=h}})}function Ej(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Pj(t,{extension:n,target:t.luma,target2:t})}function Pj(t,e){let{extension:n,target:r,target2:i}=e;const a=GR[n];ws(a);const{meta:h={}}=a,{suffix:l=""}=h,m=t.getExtension(n);for(const _ of Object.keys(a)){const S="".concat(_).concat(l);let P=null;_==="meta"||typeof t[_]=="function"||(m&&typeof m[S]=="function"?P=function(){return m[S](...arguments)}:typeof a[_]=="function"&&(P=a[_].bind(r))),P&&(r[_]=P,i[_]=P)}}const n2={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Hl=(t,e,n)=>e?t.enable(n):t.disable(n),zC=(t,e,n)=>t.hint(n,e),qs=(t,e,n)=>t.pixelStorei(n,e),Cj=(t,e)=>{const n=Nn(t)?36009:36160;return t.bindFramebuffer(n,e)},Aj=(t,e)=>t.bindFramebuffer(36008,e);function ap(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Ij={3042:Hl,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Hl,2885:(t,e)=>t.cullFace(e),2929:Hl,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Hl,35723:zC,36006:Cj,2886:(t,e)=>t.frontFace(e),33170:zC,2849:(t,e)=>t.lineWidth(e),32823:Hl,32824:"polygonOffset",10752:"polygonOffset",35977:Hl,32938:"sampleCoverage",32939:"sampleCoverage",3089:Hl,3088:(t,e)=>t.scissor(...e),2960:Hl,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:qs,3317:qs,37440:qs,37441:qs,37443:qs,3330:qs,3332:qs,3331:qs,36010:Aj,3314:qs,32878:qs,3316:qs,3315:qs,32877:qs,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=ap(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=ap(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=ap(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=ap(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,a,h,l)},stencilOp:(t,e)=>{e=ap(e)&&e.length===3?[...e,...e]:e;const[n,r,i,a,h,l]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,a,h,l)},viewport:(t,e)=>t.viewport(...e)};function Wr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const kj={blendEquation:(t,e,n)=>t.blendEquationSeparate(Wr(32777,e,n),Wr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Wr(32969,e,n),Wr(32968,e,n),Wr(32971,e,n),Wr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Wr(32824,e,n),Wr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Wr(32938,e,n),Wr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Wr(2962,e,n),Wr(2967,e,n),Wr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Wr(34816,e,n),Wr(36003,e,n),Wr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Wr(2964,e,n),Wr(2965,e,n),Wr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Wr(34817,e,n),Wr(34818,e,n),Wr(34819,e,n))},DC={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},ba=(t,e)=>t.isEnabled(e),FC={3042:ba,2884:ba,2929:ba,3024:ba,32823:ba,32926:ba,32928:ba,3089:ba,2960:ba,35977:ba};function WR(t){for(const e in t)return!1;return!0}function Mj(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function NC(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Lj(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var a=arguments.length,h=new Array(a),l=0;l<a;l++)h[l]=arguments[l];const{valueChanged:m,oldValue:_}=n(t.state._updateCache,...h);return m&&r(...h),_},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Rj(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class Oj{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?Dj(e):Object.assign({},n2),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){ws(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];gl(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const a in e){ws(a!==void 0);const h=e[a],l=this.cache[a];Mj(h,l)||(n=!0,r=l,i&&!(a in i)&&(i[a]=l),this.cache[a]=h)}return{valueChanged:n,oldValue:r}}}function HR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(ws(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new Oj(t,{copyState:r}),Rj(t);for(const a in DC){const h=DC[a];Lj(t,a,h)}NC(t,"getParameter"),NC(t,"isEnabled")}return t.state.enable=n,t}function zj(t){t.state||HR(t,{copyState:!1}),t.state.push()}function BC(t){ws(t.state),t.state.pop()}function gl(t,e){if(ws(B_(t),"setParameters requires a WebGL context"),WR(e))return;const n={};for(const i in e){const a=Number(i),h=Ij[i];h&&(typeof h=="string"?n[h]=!0:h(t,e[i],a))}const r=t.state&&t.state.cache;if(r)for(const i in n){const a=kj[i];a(t,e,r)}}function Dj(t,e){if(e=e||n2,typeof e=="number"){const i=e,a=FC[i];return a?a(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const a=FC[i];r[i]=a?a(t,Number(i)):t.getParameter(Number(i))}return r}function Fj(t){gl(t,n2)}function ca(t,e,n){if(WR(e))return n(t);const{nocatch:r=!0}=e;zj(t),gl(t,e);let i;if(r)i=n(t),BC(t);else try{i=n(t)}finally{BC(t)}return i}function bd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function bb(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=bd(t),i=t.drawingBufferWidth,a=t.drawingBufferHeight;return Bj(e,r,i,a,n)}function Nj(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function Bj(t,e,n,r,i){const a=jC(t[0],e,n);let h=VC(t[1],e,r,i),l=jC(t[0]+1,e,n);const m=l===n-1?l:l-1;l=VC(t[1]+1,e,r,i);let _;return i?(l=l===0?l:l+1,_=h,h=l):_=l===r-1?l:l-1,{x:a,y:h,width:Math.max(m-a+1,1),height:Math.max(_-h+1,1)}}function jC(t,e,n){return Math.min(Math.round(t*e),n-1)}function VC(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const r2=Sl(),jj=r2&&typeof document<"u",qR={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function ZR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ws(r2,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},qR,t);const{width:e,height:n}=t;function r(l){if(t.throwOnError)throw new Error(l);return console.error(l),null}t.onError=r;let i;const{canvas:a}=t,h=Gj({canvas:a,width:e,height:n,onError:r});return i=$j(h,t),i?(i=i2(i,t),Wj(i),i):null}function i2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||Hj(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},qR,e);const{manageState:n,debug:r}=e;return n&&HR(t,{copyState:!1,log:function(){for(var i=arguments.length,a=new Array(i),h=0;h<i;h++)a[h]=arguments[h];return an.log(1,...a)()}}),r2&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),an.level=Math.max(an.level,1)):an.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function Vj(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),a=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:a||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function Uj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=Nj(e.useDevicePixels);qj(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function $j(t,e){const{onError:n}=e;let r=null;const i=m=>r=m.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:a=!0,webgl2:h=!0}=e;let l=null;return h&&(l=l||t.getContext("webgl2",e),l=l||t.getContext("experimental-webgl2",e)),a&&(l=l||t.getContext("webgl",e),l=l||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),l?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),l):n("Failed to create ".concat(h&&!a?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function Gj(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,a;return typeof e=="string"?(jj&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),a=document.getElementById(e)):e?a=e:(a=document.createElement("canvas"),a.id="lumagl-canvas",a.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",a.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(a,document.body.firstChild)),a}function Wj(t){const e=Nn(t)?"WebGL2":"WebGL1",n=Vj(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";an.info(1,"".concat(e).concat(i," context ").concat(r))()}function Hj(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function qj(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(an.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const a=t.luma.canvasSizeInfo;if(a.clientWidth!==r||a.clientHeight!==i||a.devicePixelRatio!==e){let h=e;const l=Math.floor(r*h),m=Math.floor(i*h);t.canvas.width=l,t.canvas.height=m,(t.drawingBufferWidth!==l||t.drawingBufferHeight!==m)&&(an.warn("Device pixel ratio clamped")(),h=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*h),t.canvas.height=Math.floor(i*h)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const jp="8.5.21",Zj="set luma.log.level=1 (or higher) to trace rendering";class Xj{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new XS({id:e})),this.stats.get(e)}}const fu=new Xj;if(globalThis.luma&&globalThis.luma.VERSION!==jp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(jp));globalThis.luma||(Sl()&&an.log(1,"luma.gl ".concat(jp," - ").concat(Zj))(),globalThis.luma=globalThis.luma||{VERSION:jp,version:jp,log:an,stats:fu,globals:{modules:{},nodeIO:{}}});function Yj(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function Kj(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Bt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function wb(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Bt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function vc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Sb={};function Tc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Sb[t]=Sb[t]||1;const e=Sb[t]++;return"".concat(t,"-").concat(e)}function UC(t){return Bt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function wd(t){let e=!0;for(const n in t){e=!1;break}return e}function XR(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),a=Object.getPrototypeOf(t);r.forEach(h=>{a.methodName||(a[h]=()=>{throw an.removed("Calling removed method ".concat(e,".").concat(h,": "),i)(),new Error(h)})})}const Sh="Resource subclass must define virtual methods";let Tl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j_(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Tc(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=wb(this.gl,e),Bt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Nn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const l=i.webgl1,m="webgl2"in i?i.webgl2:i.webgl1;return a?m:l}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},a=Nn(this.gl),h={},l=n||Object.keys(i);for(const m of l){const _=i[m];if(_&&(!("webgl2"in _)||a)&&(!("extension"in _)||this.gl.getExtension(_.extension))){const P=r?vc(this.gl,m):m;h[P]=this.getParameter(m,e),r&&_.type==="GLenum"&&(h[P]=vc(this.gl,h[P]))}}return h}setParameter(e,n){e=wb(this.gl,e),Bt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const a=Nn(this.gl);if(!((!("webgl2"in i)||a)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=wb(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return XR(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Sh)}_deleteHandle(){throw new Error(Sh)}_bindHandle(e){throw new Error(Sh)}_getOptsFromHandle(){throw new Error(Sh)}_getParameter(e,n){throw new Error(Sh)}_setParameter(e,n){throw new Error(Sh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=fu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];fu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=fu.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=fu.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const Jj="Failed to deduce GL constant from typed array";function uw(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Jj)}}function hm(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Qj(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:a}=t;const h=n*i;a=a||new Uint8Array(h);for(let l=0;l<r/2;++l){const m=l*h,_=(r-l-1)*h;a.set(e.subarray(m,m+h)),e.copyWithin(m,_,_+h),e.set(a,_)}}function eV(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),a=Math.round(r/2),h=new Uint8Array(i*a*4);for(let l=0;l<a;l++)for(let m=0;m<i;m++)for(let _=0;_<4;_++)h[(l*i+m)*4+_]=e[(l*2*n+m*2)*4+_];return{data:h,width:i,height:a}}function hw(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:a={}}=n;for(const l in r)if(l in e){const _=r[l]?"".concat(t,".").concat(r[l]):"N/A";an.removed("".concat(t,".").concat(l),_)()}for(const l in i)if(l in e){const m=i[l];an.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))()}let h=null;for(const l in a)if(l in e){const m=a[l];an.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))(),h=h||Object.assign({},e),h[m]=e[l],delete h[l]}return h||e}const tV={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},nV={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Qs{static getBytesPerElement(e){return hm(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Bt(e.size),hm(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Qs(tV,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Qs.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Qs.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=hw("Accessor",e,nV),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const $C=10,YR={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},rV={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:YR},iV={removedProps:YR};class ur extends Tl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=hw("Buffer",e,rV),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=hw("Buffer",e,iV),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Qs(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,a=e.byteLength||e.length;Bt(n);const h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),i!==0||a!==void 0?(Ss(this.gl),this.gl.bufferSubData(this.target,r,n,i,a)):this.gl.bufferSubData(h,r,n),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:a}=e;const{gl:h}=this;return Ss(h),h.bindBuffer(36662,n.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,r,i,a),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ss(this.gl);const a=hm(this.accessor.type||5126,{clamped:!1}),h=this._getAvailableElementCount(n),l=r;let m,_;e?(_=e.length,m=_-l):(m=Math.min(h,i||h),_=l+m);const S=Math.min(h,m);return i=i||S,Bt(i<=S),e=e||new a(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Bt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min($C,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Bt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,$C),this.bytesUsed=r,this._trackAllocatedMemory(r);const a=uw(e);return Bt(a),this.setAccessor(new Qs(this.accessor,{type:a})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Bt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=hm(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Qs(this.accessor,{type:uw(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return an.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return an.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return an.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return an.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Qs(this.accessor,e),this}}const s2={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},KR={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},JR={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function sV(t,e){const n=s2[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Nn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function oV(t,e){const n=s2[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const aV=[9729,9728],GC=globalThis.WebGLBuffer||function(){};class Sd extends Tl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let a=!0;return r&&(a=a&&sV(e,r),a=a&&(!i||oV(e,r))),a}constructor(e,n){const{id:r=Tc("texture"),handle:i,target:a}=n;super(e,{id:r,handle:i}),this.target=a,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(N=>this.initialize(Object.assign({},e,{pixels:N,data:N}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:a=6408,border:h=0,recreate:l=!1,parameters:m={},pixelStore:_={},textureUnit:S=void 0}=e;n||(n=i);let{width:P,height:A,dataFormat:L,type:O,compressed:D=!1,mipmaps:W=!0}=e;const{depth:z=0}=e;return{width:P,height:A,compressed:D,dataFormat:L,type:O}=this._deduceParameters({format:a,type:O,dataFormat:L,compressed:D,data:n,width:P,height:A}),this.width=P,this.height=A,this.depth=z,this.format=a,this.type=O,this.dataFormat=L,this.border=h,this.textureUnit=S,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),W&&this._isNPOT()&&(an.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),W=!1,this._updateForNPOT(m)),this.mipmaps=W,this.setImageData({data:n,width:P,height:A,depth:z,format:a,type:O,dataFormat:L,border:h,mipmaps:W,parameters:_,compressed:D}),W&&this.generateMipmap(),this.setParameters(m),l&&(this.data=n),r&&(this._video={video:n,parameters:m,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(an.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ca(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:a=this.format,border:h=this.border,offset:l=0,parameters:m={}}=e;let{data:_=null,type:S=this.type,width:P=this.width,height:A=this.height,dataFormat:L=this.dataFormat,compressed:O=!1}=e;_||(_=r),{type:S,dataFormat:L,compressed:O,width:P,height:A}=this._deduceParameters({format:a,type:S,dataFormat:L,compressed:O,data:_,width:P,height:A});const{gl:D}=this;D.bindTexture(this.target,this.handle);let W=null;({data:_,dataType:W}=this._getDataType({data:_,compressed:O}));let z,N=0;if(ca(this.gl,m,()=>{switch(W){case"null":D.texImage2D(n,i,a,P,A,h,L,S,_);break;case"typed-array":D.texImage2D(n,i,a,P,A,h,L,S,_,l);break;case"buffer":z=Ss(D),z.bindBuffer(35052,_.handle||_),z.texImage2D(n,i,a,P,A,h,L,S,l),z.bindBuffer(35052,null);break;case"browser-object":Nn(D)?D.texImage2D(n,i,a,P,A,h,L,S,_):D.texImage2D(n,i,a,L,S,_);break;case"compressed":for(const[F,$]of _.entries())D.compressedTexImage2D(n,F,$.format,$.width,$.height,h,$.data),N+=$.levelSize;break;default:Bt(!1,"Unknown image data type")}}),W==="compressed")this._trackAllocatedMemory(N,"Texture");else if(_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const F=KR[this.dataFormat]||4,$=JR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*F*$,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:a=0,y:h=0,width:l=this.width,height:m=this.height,level:_=0,format:S=this.format,type:P=this.type,dataFormat:A=this.dataFormat,compressed:L=!1,offset:O=0,border:D=this.border,parameters:W={}}=e;if({type:P,dataFormat:A,compressed:L,width:l,height:m}=this._deduceParameters({format:S,type:P,dataFormat:A,compressed:L,data:i,width:l,height:m}),Bt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const z=i;i=z.data,l=z.shape[0],m=z.shape[1]}i instanceof ur&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ca(this.gl,W,()=>{if(L)this.gl.compressedTexSubImage2D(n,_,a,h,l,m,S,i);else if(i===null)this.gl.texSubImage2D(n,_,a,h,l,m,A,P,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,_,a,h,l,m,A,P,i,O);else if(i instanceof GC){const z=Ss(this.gl);z.bindBuffer(35052,i),z.texSubImage2D(n,_,a,h,l,m,A,P,O),z.bindBuffer(35052,null)}else Nn(this.gl)?Ss(this.gl).texSubImage2D(n,_,a,h,l,m,A,P,i):this.gl.texSubImage2D(n,_,a,h,A,P,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return an.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ur?{data:n.handle,dataType:"buffer"}:n instanceof GC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:a,dataFormat:h,type:l,compressed:m}=e;const _=s2[n];return h=h||_&&_.dataFormat,l=l||_&&_.types[0],m=m||_&&_.compressed,{width:i,height:a}=this._deduceImageSize(r,i,a),{dataFormat:h,type:l,compressed:m,width:i,height:a,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Bt(i,"Could not deduced texture size"),Bt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Bt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Bt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Nn(this.gl)||!this.width||!this.height?!1:!UC(this.width)||!UC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:aV.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let lV="";function cV(t,e){return Bt(typeof t=="string"),t=lV+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class ha extends Sd{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Sd.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j_(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:cV(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const dw=[34069,34070,34071,34072,34073,34074];class QR extends Sd{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j_(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:a=0,mipmapLevel:h=0}=e;return this._subImage({target:n,data:r,x:i,y:a,mipmapLevel:h})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:a,border:h=0,format:l=6408,type:m=5121}=e;const{gl:_}=this,S=i||a,P=await Promise.all(dw.map(A=>{const L=S[A];return Promise.all(Array.isArray(L)?L:[L])}));this.bind(),dw.forEach((A,L)=>{P[L].length>1&&this.opts.mipmaps!==!1&&an.warn("".concat(this.id," has mipmap and multiple LODs."))(),P[L].forEach((O,D)=>{n&&r?_.texImage2D(A,D,l,n,r,h,l,m,O):_.texImage2D(A,D,l,l,m,O)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:a,data:h,border:l=0,format:m=6408,type:_=5121}=e,{gl:S}=this,P=a||h;return this.bind(),P instanceof Promise?P.then(A=>this.setImageDataForFace(Object.assign({},e,{face:n,data:A,pixels:A}))):this.width||this.height?S.texImage2D(n,0,m,r,i,l,m,_,P):S.texImage2D(n,0,m,m,_,P),this}}QR.FACES=dw;class uV extends Sd{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Nn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:a,depth:h=1,border:l=0,format:m,type:_=5121,offset:S=0,data:P,parameters:A={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ca(this.gl,A,()=>{ArrayBuffer.isView(P)&&this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,P),P instanceof ur&&(this.gl.bindBuffer(35052,P.handle),this.gl.texImage3D(this.target,n,r,i,a,h,l,m,_,S))}),P&&P.byteLength)this._trackAllocatedMemory(P.byteLength,"Texture");else{const L=KR[this.dataFormat]||4,O=JR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*L*O,"Texture")}return this.loaded=!0,this}}const Qc="EXT_color_buffer_float",WC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Qc,bpp:2},33327:{gl2:Qc,bpp:4},34842:{gl2:Qc,bpp:8},33326:{gl2:Qc,bpp:4},33328:{gl2:Qc,bpp:8},34836:{gl2:Qc,bpp:16},35898:{gl2:Qc,bpp:4}};function hV(t,e,n){const r=n[e];if(!r)return!1;const i=Nn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Kh extends Tl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||hV(e,n,WC)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:a=0}=e;return Bt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),a!==0&&Nn(this.gl)?this.gl.renderbufferStorageMultisample(36161,a,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=a,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*WC[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const dV=256,fV=1024,pV=16384,HC=6144,qC=6145,ZC=6146,XC=34041,e3="clear: bad arguments";function o2(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a={};e&&(a.framebuffer=e);let h=0;n&&(h|=pV,n!==!0&&(a.clearColor=n)),r&&(h|=dV,r!==!0&&(a.clearDepth=r)),i&&(h|=fV,r!==!0&&(a.clearStencil=r)),Bt(h!==0,e3),ca(t,a,()=>{t.clear(h)})}function mV(t){let{framebuffer:e=null,buffer:n=HC,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(t),ca(t,{framebuffer:e},()=>{switch(n){case HC:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case qC:t.clearBufferfv(qC,0,[i]);break;case ZC:t.clearBufferiv(ZC,0,[i]);break;case XC:const[a,h]=i;t.clearBufferfi(XC,0,a,h);break;default:Bt(!1,e3)}})}function gV(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Bt(!1),0}}function V_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:a=36064,target:h=null,sourceWidth:l,sourceHeight:m,sourceType:_}=e;const{framebuffer:S,deleteFramebuffer:P}=yV(t);Bt(S);const{gl:A,handle:L,attachments:O}=S;l=l||S.width,m=m||S.height,a===36064&&L===null&&(a=1028),Bt(O[a]),_=_||O[a].type,h=_V(h,_,i,l,m),_=_||uw(h);const D=A.bindFramebuffer(36160,L);return A.readPixels(n,r,l,m,i,_,h),A.bindFramebuffer(36160,D||null),P&&S.delete(),h}function YC(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=V_(t,{sourceAttachment:e}),{width:i,height:a}=t;for(;a>n;)({data:r,width:i,height:a}=eV({data:r,width:i,height:a}));Qj({data:r,width:i,height:a});const h=document.createElement("canvas");h.width=i,h.height=a;const l=h.getContext("2d"),m=l.createImageData(i,a);return m.data.set(r),l.putImageData(m,0,0),h.toDataURL()}function yV(t){return t instanceof xi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:AV(t),deleteFramebuffer:!0}}function _V(t,e,n,r,i){if(t)return t;e=e||5121;const a=hm(e,{clamped:!1}),h=gV(n);return new a(r*i*h)}const Tr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function vV(t){const e=new ha(t,{format:6408,type:5126,dataFormat:6408}),n=new xi(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const t3={[Tr.WEBGL2]:[!1,!0],[Tr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Tr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Tr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Tr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Tr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Tr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Tr.FLOAT_BLEND]:["EXT_float_blend"],[Tr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Tr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Tr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Tr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Tr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Tr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Tr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Tr.COLOR_ATTACHMENT_RGBA32F]:[vV,"EXT_color_buffer_float"],[Tr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Tr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Tr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Tr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Tr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Tr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},xV=2;function bV(t,e){return a2(t,e)}function a2(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>n3(t,n))}function wV(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in t3)t.luma.caps[e]===void 0&&(t.luma.caps[e]=n3(t,e));return t.luma.caps}function n3(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=SV(t,e)),t.luma.caps[e]||an.log(xV,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function SV(t,e){const n=t3[e];Bt(n,e);let r;const i=Nn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const a of i)r=r&&!!t.getExtension(a)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Bt(!1);return r}const KC="Multiple render targets not supported";class xi extends Tl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let a=!0;return r&&(a=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(a=a&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),a}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new xi(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ss(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ss(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:a=!0,depth:h=!0,stencil:l=!1,check:m=!0,readBuffer:_=void 0,drawBuffers:S=void 0}=e;if(Bt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const P in i){const A=i[P];(Array.isArray(A)?A[0]:A).resize({width:n,height:r})}else i=this._createDefaultAttachments(a,h,l,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:_,drawBuffers:S}),i&&m&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:a=!1,resizeAttachments:h=!0}=e;this.attach(n,{clearAttachments:a,resizeAttachments:h});const{gl:l}=this,m=l.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),l.bindFramebuffer(36160,m||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Bt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&an.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(h=>{i[h]=null}),Object.assign(i,e);const a=this.gl.bindFramebuffer(36160,this.handle);for(const h in i){Bt(h!==void 0,"Misspelled framebuffer binding point?");const l=Number(h),m=i[l];let _=m;if(!_)this._unattach(l);else if(_ instanceof Kh)this._attachRenderbuffer({attachment:l,renderbuffer:_});else if(Array.isArray(m)){const[S,P=0,A=0]=m;_=S,this._attachTexture({attachment:l,texture:S,layer:P,level:A})}else this._attachTexture({attachment:l,texture:_,layer:0,level:0});r&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,a||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(h=>!this.attachments[h]).forEach(h=>{delete this.attachments[h]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(EV(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:a=[]}=e,h=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&o2(this.gl,{color:n,depth:r,stencil:i}),a.forEach((l,m)=>{mV(this.gl,{drawBuffer:m,value:l})}),this.gl.bindFramebuffer(36160,h||null),this}readPixels(){return an.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return an.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return an.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return an.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return an.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return an.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:a,height:h}=e;const l=Ss(this.gl),m=l.bindFramebuffer(36008,this.handle);return r===0&&i===0&&a===void 0&&h===void 0?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,r,i,a,h),l.bindFramebuffer(36008,m),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=vc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const a of r){const h=n?vc(this.gl,a):a;i[h]=this.getAttachmentParameter(e,a,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const a=Number(i),h=e?vc(this.gl,a):a;r[h]=this.getAttachmentParameters(a,e)}return r}show(){return typeof window<"u"&&window.open(YC(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>an.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=YC(this,{targetMaxHeight:100});return an.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,a){let h=null;return e&&(h=h||{},h[36064]=new ha(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:a,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(h[36064])),n&&r?(h=h||{},h[33306]=new Kh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(h[33306])):n?(h=h||{},h[36096]=new Kh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:a}),this.ownResources.push(h[36096])):r&&Bt(!1),h}_unattach(e){const n=this.attachments[e];n&&(n instanceof Kh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:a}=e;const{gl:h}=this;switch(h.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Ss(h).framebufferTextureLayer(36160,n,r.target,a,i);break;case 34067:const m=TV(i);h.framebufferTexture2D(36160,n,m,r.handle,a);break;case 3553:h.framebufferTexture2D(36160,n,3553,r.handle,a);break;default:Bt(!1,"Illegal texture type")}h.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=Q6(this.gl);n?n.readBuffer(e):Bt(e===36064||e===1029,KC),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Ss(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Bt(e.length===1&&(e[0]===36064||e[0]===1029),KC)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=wV(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function TV(t){return t<34069?t+34069:t}function EV(t){return(xi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const PV=[36049,36048,33296,33298,33299,33300,33301,33302,33303];xi.ATTACHMENT_PARAMETERS=PV;function CV(t,e){Bt(t instanceof ha||t instanceof QR||t instanceof uV);const n=t.constructor,{gl:r,width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:S}=t,P=Object.assign({width:i,height:a,format:h,type:l,dataFormat:m,border:_,mipmaps:S},e);return new n(r,P)}function AV(t,e){const{gl:n,width:r,height:i,id:a}=t;return new xi(n,Object.assign({},e,{id:"framebuffer-for-".concat(a),width:r,height:i,attachments:{36064:t}}))}function p0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const IV=35632,kV=35633;function MV(t){switch(t){case IV:return"fragment";case kV:return"vertex";default:return"unknown type"}}function LV(t,e,n,r){const i=t.split(/\r?\n/),a={},h={},l=r||p0(e)||"(unnamed)",m="".concat(MV(n)," shader ").concat(l);for(let S=0;S<i.length;S++){const P=i[S];if(P.length<=1)continue;const A=P.split(":"),L=A[0],O=parseInt(A[2],10);if(isNaN(O))throw new Error("GLSL compilation error in ".concat(m,": ").concat(t));L!=="WARNING"?a[O]=P:h[O]=P}const _=RV(e);return{shaderName:m,errors:JC(a,_),warnings:JC(h,_)}}function JC(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const a=t[r+1],h=a.split(":",3),l=h[0],m=parseInt(h[1],10)||0,_=a.substring(h.join(":").length+1).trim();n+=r3("^^^ ".concat(l,": ").concat(_,`

`),m)}}return n}function RV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((a,h)=>{const l=String(h+e),m=l.length;return r3(l,i-m)+n+a})}function r3(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function i3(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const OV="Shader: GLSL source code must be a JavaScript string";class dm extends Tl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Bt(!1),"unknown"}}constructor(e,n){j_(e),Bt(typeof n.source=="string",OV);const r=p0(n.source,null)||n.id||Tc("unnamed ".concat(dm.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=p0(n,null);r&&(this.id=Tc(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(dm.getTypeName(this.shaderType),":").concat(this.id)}getName(){return p0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:a,warnings:h}=LV(r,this.source,this.shaderType,this.id);throw an.error("GLSL compilation errors in ".concat(i,`
`).concat(a))(),an.warn("GLSL compilation warnings in ".concat(i,`
`).concat(h))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Tb extends dm{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Eb extends dm{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const zV={5126:wr.bind(null,"uniform1fv",Zs,1,ns),35664:wr.bind(null,"uniform2fv",Zs,2,ns),35665:wr.bind(null,"uniform3fv",Zs,3,ns),35666:wr.bind(null,"uniform4fv",Zs,4,ns),5124:wr.bind(null,"uniform1iv",ql,1,ns),35667:wr.bind(null,"uniform2iv",ql,2,ns),35668:wr.bind(null,"uniform3iv",ql,3,ns),35669:wr.bind(null,"uniform4iv",ql,4,ns),35670:wr.bind(null,"uniform1iv",ql,1,ns),35671:wr.bind(null,"uniform2iv",ql,2,ns),35672:wr.bind(null,"uniform3iv",ql,3,ns),35673:wr.bind(null,"uniform4iv",ql,4,ns),35674:wr.bind(null,"uniformMatrix2fv",Zs,4,tl),35675:wr.bind(null,"uniformMatrix3fv",Zs,9,tl),35676:wr.bind(null,"uniformMatrix4fv",Zs,16,tl),35678:Fi,35680:Fi,5125:wr.bind(null,"uniform1uiv",Ty,1,ns),36294:wr.bind(null,"uniform2uiv",Ty,2,ns),36295:wr.bind(null,"uniform3uiv",Ty,3,ns),36296:wr.bind(null,"uniform4uiv",Ty,4,ns),35685:wr.bind(null,"uniformMatrix2x3fv",Zs,6,tl),35686:wr.bind(null,"uniformMatrix2x4fv",Zs,8,tl),35687:wr.bind(null,"uniformMatrix3x2fv",Zs,6,tl),35688:wr.bind(null,"uniformMatrix3x4fv",Zs,12,tl),35689:wr.bind(null,"uniformMatrix4x2fv",Zs,8,tl),35690:wr.bind(null,"uniformMatrix4x3fv",Zs,12,tl),35678:Fi,35680:Fi,35679:Fi,35682:Fi,36289:Fi,36292:Fi,36293:Fi,36298:Fi,36299:Fi,36300:Fi,36303:Fi,36306:Fi,36307:Fi,36308:Fi,36311:Fi},DV={},FV={},NV={},QC=[0];function l2(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(QC[0]=t,t=QC);const i=t.length;if(i%e&&an.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let a=r[i];a||(a=new n(i),r[i]=a);for(let h=0;h<i;h++)a[h]=t[h];return a}function Zs(t,e){return l2(t,e,Float32Array,DV)}function ql(t,e){return l2(t,e,Int32Array,FV)}function Ty(t,e){return l2(t,e,Uint32Array,NV)}function eA(t,e,n){const r=zV[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function BV(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function jV(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!VV(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function VV(t){return Array.isArray(t)||ArrayBuffer.isView(t)?$V(t):isFinite(t)||t===!0||t===!1||t instanceof Sd||t instanceof Kh?!0:t instanceof xi?!!t.texture:!1}function UV(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,a=n.length;i<a;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function $V(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Fi(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function wr(t,e,n,r){let i=null,a=null;return(h,l,m)=>{const _=e(m,n),S=_.length;let P=!1;if(i===null)i=new Float32Array(S),a=S,P=!0;else{Bt(a===S,"Uniform length cannot change.");for(let A=0;A<S;++A)if(_[A]!==i[A]){P=!0;break}}return P&&(r(h,t,l,_),i.set(_)),P}}function ns(t,e,n,r){t[e](n,r)}function tl(t,e,n,r){t[e](n,!1,r)}const GV=5120,WV=5121,HV=5122,qV=5123,tA=0,Ey=1,ZV=2,XV=3,Py=4,YV=5,KV=6,yi=5126,JV=35664,QV=35665,eU=35666,lp=5124,tU=35667,nU=35668,rU=35669,cp=5125,iU=36294,sU=36295,oU=36296,aU=35670,lU=35671,cU=35672,uU=35673,hU=35674,dU=35675,fU=35676,pU=35685,mU=35686,gU=35687,yU=35688,_U=35689,vU=35690,fw={[yi]:[yi,1,"float"],[JV]:[yi,2,"vec2"],[QV]:[yi,3,"vec3"],[eU]:[yi,4,"vec4"],[lp]:[lp,1,"int"],[tU]:[lp,2,"ivec2"],[nU]:[lp,3,"ivec3"],[rU]:[lp,4,"ivec4"],[cp]:[cp,1,"uint"],[iU]:[cp,2,"uvec2"],[sU]:[cp,3,"uvec3"],[oU]:[cp,4,"uvec4"],[aU]:[yi,1,"bool"],[lU]:[yi,2,"bvec2"],[cU]:[yi,3,"bvec3"],[uU]:[yi,4,"bvec4"],[hU]:[yi,8,"mat2"],[pU]:[yi,8,"mat2x3"],[mU]:[yi,8,"mat2x4"],[dU]:[yi,12,"mat3"],[gU]:[yi,12,"mat3x2"],[yU]:[yi,12,"mat3x4"],[fU]:[yi,16,"mat4"],[_U]:[yi,16,"mat4x2"],[vU]:[yi,16,"mat4x3"]};function xU(t){switch(t){case tA:return tA;case Ey:return Ey;case XV:return Ey;case ZV:return Ey;case Py:return Py;case YV:return Py;case KV:return Py;default:return Bt(!1),0}}function nA(t){const e=fw[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function s3(t,e){switch(t){case GV:case WV:case HV:case qV:t=yi;break}for(const n in fw){const[r,i,a]=fw[n];if(r===t&&i===e)return{glType:n,name:a}}return null}class bU{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getActiveAttrib(e.handle,i),m=n.getAttribLocation(e.handle,a);m>=0&&this._addAttribute(m,a,h,l)}this.attributeInfos.sort((i,a)=>i.location-a.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Nn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:a,type:h,size:l}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,a,h,l)}this.varyingInfos.sort((i,a)=>i.location-a.location)}_addAttribute(e,n,r,i){const{type:a,components:h}=nA(r),l={type:a,size:i*h};this._inferProperties(e,n,l);const m={location:e,name:n,accessor:new Qs(l)};this.attributeInfos.push(m),this.attributeInfosByLocation[e]=m,this.attributeInfosByName[m.name]=m}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:a,components:h}=nA(r),l=new Qs({type:a,size:i*h}),m={location:e,name:n,accessor:l};this.varyingInfos.push(m),this.varyingInfosByName[m.name]=m}}const rA=4,wU=35981,SU=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class o3 extends Tl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",SU),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:a,bufferMode:h=wU}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Tb(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Eb(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Bt(this.vs instanceof Tb),Bt(this.fs instanceof Eb),this.uniforms={},this._textureUniforms={},a&&a.length>0&&(Ss(this.gl),this.varyings=a,this.gl2.transformFeedbackVaryings(this.handle,a,h)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new bU(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:a=0,start:h,end:l,isIndexed:m=!1,indexType:_=5123,instanceCount:S=0,isInstanced:P=S>0,vertexArray:A=null,transformFeedback:L,framebuffer:O,parameters:D={},uniforms:W,samplers:z}=e;if((W||z)&&(an.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(W||{})),an.priority>=n){const N=O?O.id:"default",F="mode=".concat(vc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(S," indexType=").concat(vc(this.gl,_)," ")+"isInstanced=".concat(P," isIndexed=").concat(m," ")+"Framebuffer=".concat(N);an.log(n,F)()}return Bt(A),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||P&&S===0?!1:(A.bindForDraw(i,S,()=>{if(O!==void 0&&(D=Object.assign({},D,{framebuffer:O})),L){const N=xU(r);L.begin(N)}this._bindTextures(),ca(this.gl,D,()=>{m&&P?this.gl2.drawElementsInstanced(r,i,_,a,S):m&&Nn(this.gl)&&!isNaN(h)&&!isNaN(l)?this.gl2.drawRangeElements(r,h,l,i,_,a):m?this.gl.drawElements(r,i,_,a):P?this.gl2.drawArraysInstanced(r,a,i,S):this.gl.drawArrays(r,a,i)}),L&&L.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};an.priority>=2&&jV(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let a=r,h=!1;if(a instanceof xi&&(a=a.texture),a instanceof Sd)if(h=this.uniforms[n]!==r,h){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const l=a,{textureIndex:m}=i;l.bind(m),a=m,this._textureUniforms[n]=l}else a=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(a)||h)&&UV(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Tb({handle:i});break;case 35632:r.fs=new Eb({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Tc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),an.time(rA,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),an.timeEnd(rA,"linkProgram for ".concat(this._getName()))(),e.debug||an.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=BV(r.name);let a=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=eA(e,a,r),r.size>1)for(let h=0;h<r.size;h++)a=e.getUniformLocation(this.handle,"".concat(i,"[").concat(h,"]")),this._uniformSetters["".concat(i,"[").concat(h,"]")]=eA(e,a,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const TU=34918,EU=34919,PU=35007,CU=36795,AU=35976,IU=35887,kU=36202;class t_ extends Tl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Nn(e),i=a2(e,Tr.TIMER_QUERY);let a=r||i;for(const h of n)switch(h){case"queries":a=a&&r;break;case"timers":a=a&&i;break;default:Bt(!1)}return a}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(PU)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?kU:IU)}beginTransformFeedbackQuery(){return this.begin(AU)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,EU);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(CU)}getResult(){return this.gl2.getQueryParameter(this.handle,TU)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const a=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}_createHandle(){return t_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class a3 extends Tl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Nn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ss(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,wd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:a,byteOffset:h}=this._getBufferParams(n);return r<0?(this.unused[e]=i,an.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,h,a),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ur?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const a=n&&n.handle;return!a||i===void 0?this.gl.bindBufferBase(35982,e,a):this.gl.bindBufferRange(35982,e,a,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Cy=null;function MU(t){return(!Cy||Cy.byteLength<t)&&(Cy=new ArrayBuffer(t)),Cy}function LU(t,e){const n=MU(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function RU(t){let{target:e,source:n,start:r=0,count:i=1}=t;const a=n.length,h=i*a;let l=0;for(let m=r;l<a;l++)e[m++]=n[l];for(;l<h;)l<h-l?(e.copyWithin(r+l,r,r+l),l*=2):(e.copyWithin(r+l,r,r+h-l),l=h);return e}const OU="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ys extends Tl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Nn(e)||IR()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ys(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ys.MAX_ATTRIBUTES=Ys.MAX_ATTRIBUTES||e.getParameter(34921),Ys.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ys._setConstantFloatArray(e,n,r);break;case Int32Array:Ys._setConstantIntArray(e,n,r);break;case Uint32Array:Ys._setConstantUintArray(e,n,r);break;default:Bt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ys.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Bt(!e||e.target===34963,OU),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:a,stride:h,offset:l,normalized:m,integer:_,divisor:S}=r,{gl:P,gl2:A}=this;return e=Number(e),this.bind(()=>{P.bindBuffer(34962,n.handle),_?(Bt(Nn(P)),A.vertexAttribIPointer(e,i,a,h,l)):P.vertexAttribPointer(e,i,a,m,h,l),P.enableVertexAttribArray(e),A.vertexAttribDivisor(e,S||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ys.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,a=r.length*e;let h=!this.buffer;if(this.buffer=this.buffer||new ur(this.gl,i),h=h||this.buffer.reallocate(i),h=h||!this._compareConstantArrayValues(r,this.bufferValue),h){const l=LU(n.constructor,a);RU({target:l,source:r,start:0,count:a}),this.buffer.subData(l),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Bt(!1)}}static _setConstantIntArray(e,n,r){switch(Bt(Nn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Bt(!1)}}static _setConstantUintArray(e,n,r){switch(Bt(Nn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Bt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Bt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const zU="VertexArray: attributes must be Buffers or constants (i.e. typed array)",DU=/^(.+)__LOCATION_([0-9]+)$/,FU=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class NU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ys(e),XR(this,"VertexArray","v6.0",FU),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,a)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:a}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=a,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ur(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ur&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ur&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const a={location:-1,accessor:null},{location:h,name:l}=this._getAttributeIndex(e);if(!Number.isFinite(h)||h<0)return this.unused[e]=n,an.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),a;const m=this._getAttributeInfo(l||h);if(!m)return a;const _=this.accessors[h]||{},S=Qs.resolve(m.accessor,_,r,i),{size:P,type:A}=S;return Bt(Number.isFinite(P)&&Number.isFinite(A)),{location:h,accessor:S}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=DU.exec(e),i=r?r[1]:e,a=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+a,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ur)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ur){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ur){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(zU)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let a=1;a<this.vertexArrayObject.MAX_ATTRIBUTES;a++)i=this.values[a],ArrayBuffer.isView(i)&&this._setConstantAttribute(a,i)}_setConstantAttributeZero(e,n){if(Ys.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Ys.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:a}=i,h=a>0;if(e.isInstanced=e.isInstanced||h,r instanceof ur){const l=r;if(h){const m=l.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,m)}else{const m=l.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,m)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return an.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function BU(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let h=0;h<t.length&&h<n;++h)h>0&&(i+=",".concat(h%r===0?" ":"")),i+=fm(t[h],e);const a=t.length>n?"...":"]";return"".concat(i).concat(a)}function fm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return BU(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function iA(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Bt(n);const a=".*_.*",h=".*Matrix",l=n._uniformSetters,m={},_=Object.keys(l).sort();let S=0;for(const L of _)!L.match(a)&&!L.match(h)&&Pb({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;for(const L of _)L.match(h)&&Pb({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;for(const L of _)m[L]||Pb({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&S++;let P=0;const A={};if(!i)for(const L in r){const O=r[L];m[L]||(P++,A[L]={Type:"NOT USED: ".concat(O),[e]:fm(O)})}return{table:m,count:S,unusedTable:A,unusedCount:P}}function Pb(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:a}=t;const h=r[i],l=jU(h);return!a||!l?(e[i]={[n]:l?fm(h):"N/A","Uniform Type":l?h:"NOT PROVIDED"},!0):!1}function jU(t){return t!=null}function VU(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=sA(e,e.elements,null,n));const i=e.values;for(const a in i){const h=e._getAttributeInfo(a);if(h){let l="".concat(a,": ").concat(h.name);const m=e.accessors[h.location];m&&(l="".concat(a,": ").concat(UU(h.name,m))),r[l]=sA(e,i[a],m,n)}}return r}function sA(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let a="NOT PROVIDED",h=1,l=0,m=0,_,S,P;if(n&&(a=n.type,h=n.size,a=String(a).replace("Array",""),_=a.indexOf("nt")!==-1),e instanceof ur){const A=e,{data:L,changed:O}=A.getDebugData();S=O?"*":"",P=L,m=A.byteLength,l=m/L.BYTES_PER_ELEMENT/h;let D;if(n){const W=n.divisor>0;D="".concat(W?"I ":"P "," ").concat(l," (x").concat(h,"=").concat(m," bytes ").concat(vc(i,a),")")}else _=!0,D="".concat(m," bytes");return{[r]:"".concat(S).concat(fm(P,{size:h,isInteger:_})),"Format ":D}}return P=e,h=e.length,a=String(e.constructor.name).replace("Array",""),_=a.indexOf("nt")!==-1,{[r]:"".concat(fm(P,{size:h,isInteger:_})," (constant)"),"Format ":"".concat(h,"x").concat(a," (constant)")}}function UU(t,e){const{type:n,size:r}=e,i=s3(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function $U(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=oA(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=oA(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function oA(t){const{type:e,size:n}=t.accessor,r=s3(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const aA=Sl()&&typeof document<"u";let GU=0;class WU{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=W=>ZR(W),onAddHTML:r=null,onInitialize:i=()=>{},onRender:a=()=>{},onFinalize:h=()=>{},onError:l,gl:m=null,glOptions:_={},debug:S=!1,createFramebuffer:P=!1,autoResizeViewport:A=!0,autoResizeDrawingBuffer:L=!0,stats:O=fu.get("animation-loop-".concat(GU++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(an.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:a,onFinalize:h,onError:l,gl:m,glOptions:_,debug:S,createFramebuffer:P},this.gl=m,this.needsRedraw=null,this.timeline=null,this.stats=O,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:A,autoResizeDrawingBuffer:L,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Bt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=t_.isSupported(this.gl,["timers"])?new t_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return an.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=aA?new Promise((e,n)=>{if(aA&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):Kj(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):Yj(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?i2(this.props.gl,e):this.onCreateContext(e),!B_(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Fj(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Uj(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new xi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const jm="vs",c2="fs";function io(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Cb={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function HU(t){const e={};for(const n in t){const r=t[n],i=qU(r);e[n]=i}return e}function qU(t){let e=lA(t);return e==="object"?t?"type"in t?Object.assign({},t,Cb[t.type]):"value"in t?(e=lA(t.value),Object.assign({type:e},t,Cb[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Cb[e])}function lA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const ZU="vs",XU="fs";class cA{constructor(e){let{name:n,vs:r,fs:i,dependencies:a=[],uniforms:h,getUniforms:l,deprecations:m=[],defines:_={},inject:S={},vertexShader:P,fragmentShader:A}=e;io(typeof n=="string"),this.name=n,this.vs=r||P,this.fs=i||A,this.getModuleUniforms=l,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(m),this.defines=_,this.injections=YU(S),h&&(this.uniforms=HU(h))}getModuleSource(e){let n;switch(e){case ZU:n=this.vs||"";break;case XU:n=this.fs||"";break;default:io(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const a=r[i];i in e&&!a.private?(a.validate&&io(a.validate(e[i],a),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=a.value}return n}}function YU(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function KU(t){return JU(c3(t))}function JU(t){const e={},n={};return l3({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function l3(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)r[a.name]=a,(i[a.name]===void 0||i[a.name]<n)&&(i[a.name]=n);for(const a of e)a.dependencies&&l3({modules:a.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function c3(t,e){return t.map(n=>(n instanceof cA||(io(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),io(n.name,"shader module has no name"),n=new cA(n),n.dependencies=c3(n.dependencies)),n))}function QU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const e$=7936,t$=7937,n$=7938,r$=35724,u2={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},su={};Object.keys(u2).forEach(t=>{su[t]=t});function i$(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function s$(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||e$),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||t$);return{gpuVendor:o$(n,r),vendor:n,renderer:r,version:t.getParameter(n$),shadingLanguageVersion:t.getParameter(r$)}}function o$(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Ab={};function uA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=u2[e];if(io(r,e),!QU(n))return!0;if(e in Ab)return Ab[e];const i=r[0],a=n.behavior||"enable",h="#extension GL_".concat(i," : ").concat(a,`
void main(void) {}`),l=t.createShader(35633);t.shaderSource(l,h),t.compileShader(l);const m=t.getShaderParameter(l,35713);return t.deleteShader(l),Ab[e]=m,m}function a$(t,e){const n=u2[e];io(n,e);const r=i$(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return io(i===!1||i===!0),i}function Ay(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>a$(t,n))}function l$(t){switch(s$(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function c$(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Ay(t,su.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Ay(t,su.GLSL_DERIVATIVES)&&uA(t,su.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Ay(t,su.GLSL_FRAG_DATA)&&uA(t,su.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Ay(t,su.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const u$=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,h$=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,d$={[jm]:u$,[c2]:h$},m0="__LUMA_INJECT_DECLARATIONS__",hA=/void\s+main\s*\([^)]*\)\s*\{\n?/,dA=/}\n?[^{}]*$/,Ib=[];function fA(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===jm;for(const a in n){const h=n[a];h.sort((m,_)=>m.order-_.order),Ib.length=h.length;for(let m=0,_=h.length;m<_;++m)Ib[m]=h[m].injection;const l="".concat(Ib.join(`
`),`
`);switch(a){case"vs:#decl":i&&(t=t.replace(m0,l));break;case"vs:#main-start":i&&(t=t.replace(hA,m=>m+l));break;case"vs:#main-end":i&&(t=t.replace(dA,m=>l+m));break;case"fs:#decl":i||(t=t.replace(m0,l));break;case"fs:#main-start":i||(t=t.replace(hA,m=>m+l));break;case"fs:#main-end":i||(t=t.replace(dA,m=>l+m));break;default:t=t.replace(a,m=>m+l)}}return t=t.replace(m0,""),r&&(t=t.replace(/\}\s*$/,a=>a+d$[e])),t}function pw(t){const e={};return io(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function Td(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const u3=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],f$=[...u3,[Td("attribute"),"in $1"],[Td("varying"),"out $1"]],p$=[...u3,[Td("varying"),"in $1"]],h3=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],m$=[...h3,[Td("in"),"attribute $1"],[Td("out"),"varying $1"]],g$=[...h3,[Td("in"),"varying $1"]],mw="gl_FragColor",gw=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,y$=/void\s+main\s*\([^)]*\)\s*\{\n?/;function _$(t,e,n){switch(e){case 300:return n?n_(t,f$):v$(t);case 100:return n?n_(t,m$):x$(t);default:throw new Error("unknown GLSL version ".concat(e))}}function n_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function v$(t){t=n_(t,p$);const e=t.match(gw);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(mw,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(y$,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(mw,"\\b"),"g"),n)}return t}function x$(t){t=n_(t,g$);const e=t.match(gw);if(e){const n=e[1];t=t.replace(gw,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),mw)}return t}const b$=`

`.concat(m0,`

`),d3={[jm]:"vertex",[c2]:"fragment"},w$=`precision highp float;

`;function S$(t,e){const{vs:n,fs:r}=e,i=KU(e.modules||[]);return{gl:t,vs:pA(t,Object.assign({},e,{source:n,type:jm,modules:i})),fs:pA(t,Object.assign({},e,{source:r,type:c2,modules:i})),getUniforms:T$(i)}}function pA(t,e){let{id:n,source:r,type:i,modules:a,defines:h={},hookFunctions:l=[],inject:m={},transpileToGLSL100:_=!1,prologue:S=!0,log:P}=e;io(typeof r=="string","shader source must be a string");const A=i===jm,L=r.split(`
`);let O=100,D="",W=r;L[0].indexOf("#version ")===0?(O=300,D=L[0],W=L.slice(1).join(`
`)):D="#version ".concat(O);const z={};a.forEach(ie=>{Object.assign(z,ie.getDefines())}),Object.assign(z,h);let N=S?"".concat(D,`
`).concat(P$({id:n,source:r,type:i}),`
`).concat(E$({type:i}),`
`).concat(l$(t),`
`).concat(c$(t),`
`).concat(C$(z),`
`).concat(A?"":w$,`
`):"".concat(D,`
`);const F=I$(l),$={},Q={},te={};for(const ie in m){const xe=typeof m[ie]=="string"?{injection:m[ie],order:0}:m[ie],Te=ie.match(/^(v|f)s:(#)?([\w-]+)$/);if(Te){const _e=Te[2],Re=Te[3];_e?Re==="decl"?Q[ie]=[xe]:te[ie]=[xe]:$[ie]=[xe]}else te[ie]=[xe]}for(const ie of a){P&&ie.checkDeprecations(W,P);const xe=ie.getModuleSource(i,O);N+=xe;const Te=ie.injections[i];for(const _e in Te){const Re=_e.match(/^(v|f)s:#([\w-]+)$/);if(Re){const Ve=Re[2]==="decl"?Q:te;Ve[_e]=Ve[_e]||[],Ve[_e].push(Te[_e])}else $[_e]=$[_e]||[],$[_e].push(Te[_e])}}return N+=b$,N=fA(N,i,Q),N+=A$(F[i],$),N+=W,N=fA(N,i,te),N=_$(N,_?100:O,A),N}function T$(t){return function(n){const r={};for(const i of t){const a=i.getUniforms(n,r);Object.assign(r,a)}return r}}function E$(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(d3[e].toUpperCase(),`
`)}function P$(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(d3[r],`

`):""}function C$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function A$(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const a=e[r];a.sort((h,l)=>h.order-l.order);for(const h of a)n+="  ".concat(h.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function I$(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,a]=n.split(":"),h=n.replace(/\(.+/,"");e[i][h]=Object.assign(r,{signature:a})}),e}const k$="void main() {gl_FragColor = vec4(0);}",f3=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,M$=`#version 300 es
`.concat(f3);function p3(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,a]=n;if(!e.includes(r)||!i||!a)return null;const h=a.split(";")[0];return{qualifier:r,type:i,name:h}}function m3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?M$:e>300?"#version ".concat(e,`
`).concat(f3):k$;const a=O$(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(a,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(a,`;
}`)}function L$(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return io(!1),null}}function R$(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return io(!1),null}}function O$(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return io(!1),null}}const z$=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,D$={name:"fp32",vs:z$,fs:null};function mA(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const no={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function F$(t,{precision:e=no.precision}={}){return t=N$(t),"".concat(parseFloat(t.toPrecision(e)))}function Ed(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function oc(t,e,n){return j$(t,r=>Math.max(e,Math.min(n,r)))}function pm(t,e,n){return Ed(t)?t.map((r,i)=>pm(r,e[i],n)):n*e+(1-n)*t}function mm(t,e,n){const r=no.EPSILON;n&&(no.EPSILON=n);try{if(t===e)return!0;if(Ed(t)&&Ed(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!mm(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=no.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{no.EPSILON=r}}function N$(t){return Math.round(t/no.EPSILON)*no.EPSILON}function B$(t){return t.clone?t.clone():new Array(t.length)}function j$(t,e,n){if(Ed(t)){const r=t;n=n||B$(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function V$(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class g3 extends V$(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Ed(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(no)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+F$(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!mm(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const a=e[i];this[i]=a+r*(n[i]-a)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(no.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function U$(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Js(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function kb(t,e,n=""){if(no.debug&&!U$(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class $$ extends g3{get x(){return this[0]}set x(e){this[0]=Js(e)}get y(){return this[1]}set y(e){this[1]=Js(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Js(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Js(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return mA(e>=0&&e<this.ELEMENTS,"index is out of range"),Js(this[e])}setComponent(e,n){return mA(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var g0=1e-6,Pd=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function G$(){var t=new Pd(2);return Pd!=Float32Array&&(t[0]=0,t[1]=0),t}function yw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function W$(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function H$(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function q$(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Z$(t,e){return t[0]=-e[0],t[1]=-e[1],t}function y3(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t}function X$(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var Y$=W$;(function(){var t=G$();return function(e,n,r,i,a,h){var l,m;for(n||(n=2),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],a(t,t,h),e[l]=t[0],e[l+1]=t[1];return e}})();function K$(t,e,n){const r=e[0],i=e[1],a=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/a,t[1]=(n[1]*r+n[5]*i)/a,t}function _3(t,e,n){const r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a||1;return t[0]=(n[0]*r+n[4]*i+n[8]*a)/h,t[1]=(n[1]*r+n[5]*i+n[9]*a)/h,t[2]=(n[2]*r+n[6]*i+n[10]*a)/h,t}function J$(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Q$(){var t=new Pd(3);return Pd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function e8(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function t8(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function n8(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function r8(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[0],l=n[1],m=n[2];return t[0]=i*m-a*l,t[1]=a*h-r*m,t[2]=r*l-i*h,t}function v3(t,e,n){var r=e[0],i=e[1],a=e[2],h=n[3]*r+n[7]*i+n[11]*a+n[15];return h=h||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/h,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/h,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/h,t}function i8(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function s8(t,e,n){var r=n[0],i=n[1],a=n[2],h=n[3],l=e[0],m=e[1],_=e[2],S=i*_-a*m,P=a*l-r*_,A=r*m-i*l,L=i*A-a*P,O=a*S-r*A,D=r*P-i*S,W=h*2;return S*=W,P*=W,A*=W,L*=2,O*=2,D*=2,t[0]=l+S+L,t[1]=m+P+O,t[2]=_+A+D,t}function o8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function a8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function l8(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function c8(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],h=e[1],l=e[2],m=Math.sqrt(n*n+r*r+i*i),_=Math.sqrt(a*a+h*h+l*l),S=m*_,P=S&&n8(t,e)/S;return Math.acos(Math.min(Math.max(P,-1),1))}var u8=e8;(function(){var t=Q$();return function(e,n,r,i,a,h){var l,m;for(n||(n=3),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();const Mb=[0,0,0];let Iy;class za extends $${static get ZERO(){return Iy||(Iy=new za(0,0,0),Object.freeze(Iy)),Iy}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Ed(e)?this.copy(e):(no.debug&&(Js(e),Js(n),Js(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return no.debug&&(Js(e.x),Js(e.y),Js(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Js(e)}angle(e){return c8(this,e)}cross(e){return r8(this,this,e),this.check()}rotateX({radians:e,origin:n=Mb}){return o8(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Mb}){return a8(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Mb}){return l8(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return v3(this,this,e),this.check()}transformAsVector(e){return _3(this,this,e),this.check()}transformByMatrix3(e){return i8(this,this,e),this.check()}transformByMatrix2(e){return J$(this,this,e),this.check()}transformByQuaternion(e){return s8(this,this,e),this.check()}}class h8 extends g3{toString(){let e="[";if(no.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Js(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function d8(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function f8(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],h=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=h,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function _w(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=e[4],l=e[5],m=e[6],_=e[7],S=e[8],P=e[9],A=e[10],L=e[11],O=e[12],D=e[13],W=e[14],z=e[15],N=n*l-r*h,F=n*m-i*h,$=n*_-a*h,Q=r*m-i*l,te=r*_-a*l,ie=i*_-a*m,xe=S*D-P*O,Te=S*W-A*O,_e=S*z-L*O,Re=P*W-A*D,Ne=P*z-L*D,Ve=A*z-L*W,je=N*Ve-F*Ne+$*Re+Q*_e-te*Te+ie*xe;return je?(je=1/je,t[0]=(l*Ve-m*Ne+_*Re)*je,t[1]=(i*Ne-r*Ve-a*Re)*je,t[2]=(D*ie-W*te+z*Q)*je,t[3]=(A*te-P*ie-L*Q)*je,t[4]=(m*_e-h*Ve-_*Te)*je,t[5]=(n*Ve-i*_e+a*Te)*je,t[6]=(W*$-O*ie-z*F)*je,t[7]=(S*ie-A*$+L*F)*je,t[8]=(h*Ne-l*_e+_*xe)*je,t[9]=(r*_e-n*Ne-a*xe)*je,t[10]=(O*te-D*$+z*N)*je,t[11]=(P*$-S*te-L*N)*je,t[12]=(l*Te-h*Re-m*xe)*je,t[13]=(n*Re-r*Te+i*xe)*je,t[14]=(D*F-O*Q-W*N)*je,t[15]=(S*Q-P*F+A*N)*je,t):null}function p8(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],h=t[5],l=t[6],m=t[7],_=t[8],S=t[9],P=t[10],A=t[11],L=t[12],O=t[13],D=t[14],W=t[15],z=e*h-n*a,N=e*l-r*a,F=e*m-i*a,$=n*l-r*h,Q=n*m-i*h,te=r*m-i*l,ie=_*O-S*L,xe=_*D-P*L,Te=_*W-A*L,_e=S*D-P*O,Re=S*W-A*O,Ne=P*W-A*D;return z*Ne-N*Re+F*_e+$*Te-Q*xe+te*ie}function vu(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3],l=e[4],m=e[5],_=e[6],S=e[7],P=e[8],A=e[9],L=e[10],O=e[11],D=e[12],W=e[13],z=e[14],N=e[15],F=n[0],$=n[1],Q=n[2],te=n[3];return t[0]=F*r+$*l+Q*P+te*D,t[1]=F*i+$*m+Q*A+te*W,t[2]=F*a+$*_+Q*L+te*z,t[3]=F*h+$*S+Q*O+te*N,F=n[4],$=n[5],Q=n[6],te=n[7],t[4]=F*r+$*l+Q*P+te*D,t[5]=F*i+$*m+Q*A+te*W,t[6]=F*a+$*_+Q*L+te*z,t[7]=F*h+$*S+Q*O+te*N,F=n[8],$=n[9],Q=n[10],te=n[11],t[8]=F*r+$*l+Q*P+te*D,t[9]=F*i+$*m+Q*A+te*W,t[10]=F*a+$*_+Q*L+te*z,t[11]=F*h+$*S+Q*O+te*N,F=n[12],$=n[13],Q=n[14],te=n[15],t[12]=F*r+$*l+Q*P+te*D,t[13]=F*i+$*m+Q*A+te*W,t[14]=F*a+$*_+Q*L+te*z,t[15]=F*h+$*S+Q*O+te*N,t}function r_(t,e,n){var r=n[0],i=n[1],a=n[2],h,l,m,_,S,P,A,L,O,D,W,z;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(h=e[0],l=e[1],m=e[2],_=e[3],S=e[4],P=e[5],A=e[6],L=e[7],O=e[8],D=e[9],W=e[10],z=e[11],t[0]=h,t[1]=l,t[2]=m,t[3]=_,t[4]=S,t[5]=P,t[6]=A,t[7]=L,t[8]=O,t[9]=D,t[10]=W,t[11]=z,t[12]=h*r+S*i+O*a+e[12],t[13]=l*r+P*i+D*a+e[13],t[14]=m*r+A*i+W*a+e[14],t[15]=_*r+L*i+z*a+e[15]),t}function h2(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m8(t,e,n,r){var i=r[0],a=r[1],h=r[2],l=Math.hypot(i,a,h),m,_,S,P,A,L,O,D,W,z,N,F,$,Q,te,ie,xe,Te,_e,Re,Ne,Ve,je,Ge;return l<g0?null:(l=1/l,i*=l,a*=l,h*=l,m=Math.sin(n),_=Math.cos(n),S=1-_,P=e[0],A=e[1],L=e[2],O=e[3],D=e[4],W=e[5],z=e[6],N=e[7],F=e[8],$=e[9],Q=e[10],te=e[11],ie=i*i*S+_,xe=a*i*S+h*m,Te=h*i*S-a*m,_e=i*a*S-h*m,Re=a*a*S+_,Ne=h*a*S+i*m,Ve=i*h*S+a*m,je=a*h*S-i*m,Ge=h*h*S+_,t[0]=P*ie+D*xe+F*Te,t[1]=A*ie+W*xe+$*Te,t[2]=L*ie+z*xe+Q*Te,t[3]=O*ie+N*xe+te*Te,t[4]=P*_e+D*Re+F*Ne,t[5]=A*_e+W*Re+$*Ne,t[6]=L*_e+z*Re+Q*Ne,t[7]=O*_e+N*Re+te*Ne,t[8]=P*Ve+D*je+F*Ge,t[9]=A*Ve+W*je+$*Ge,t[10]=L*Ve+z*je+Q*Ge,t[11]=O*Ve+N*je+te*Ge,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function x3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],h=e[5],l=e[6],m=e[7],_=e[8],S=e[9],P=e[10],A=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+_*r,t[5]=h*i+S*r,t[6]=l*i+P*r,t[7]=m*i+A*r,t[8]=_*i-a*r,t[9]=S*i-h*r,t[10]=P*i-l*r,t[11]=A*i-m*r,t}function g8(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[8],S=e[9],P=e[10],A=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-_*r,t[1]=h*i-S*r,t[2]=l*i-P*r,t[3]=m*i-A*r,t[8]=a*r+_*i,t[9]=h*r+S*i,t[10]=l*r+P*i,t[11]=m*r+A*i,t}function b3(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],h=e[1],l=e[2],m=e[3],_=e[4],S=e[5],P=e[6],A=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+_*r,t[1]=h*i+S*r,t[2]=l*i+P*r,t[3]=m*i+A*r,t[4]=_*i-a*r,t[5]=S*i-h*r,t[6]=P*i-l*r,t[7]=A*i-m*r,t}function y8(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],h=n+n,l=r+r,m=i+i,_=n*h,S=r*h,P=r*l,A=i*h,L=i*l,O=i*m,D=a*h,W=a*l,z=a*m;return t[0]=1-P-O,t[1]=S+z,t[2]=A-W,t[3]=0,t[4]=S-z,t[5]=1-_-O,t[6]=L+D,t[7]=0,t[8]=A+W,t[9]=L-D,t[10]=1-_-P,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _8(t,e,n,r,i,a,h){var l=1/(n-e),m=1/(i-r),_=1/(a-h);return t[0]=a*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*m,t[6]=0,t[7]=0,t[8]=(n+e)*l,t[9]=(i+r)*m,t[10]=(h+a)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*a*2*_,t[15]=0,t}function v8(t,e,n,r,i){var a=1/Math.tan(e/2),h;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(h=1/(r-i),t[10]=(i+r)*h,t[14]=2*i*r*h):(t[10]=-1,t[14]=-2*r),t}var x8=v8;function b8(t,e,n,r,i,a,h){var l=1/(e-n),m=1/(r-i),_=1/(a-h);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+n)*l,t[13]=(i+r)*m,t[14]=(h+a)*_,t[15]=1,t}var w8=b8;function S8(t,e,n,r){var i,a,h,l,m,_,S,P,A,L,O=e[0],D=e[1],W=e[2],z=r[0],N=r[1],F=r[2],$=n[0],Q=n[1],te=n[2];return Math.abs(O-$)<g0&&Math.abs(D-Q)<g0&&Math.abs(W-te)<g0?d8(t):(S=O-$,P=D-Q,A=W-te,L=1/Math.hypot(S,P,A),S*=L,P*=L,A*=L,i=N*A-F*P,a=F*S-z*A,h=z*P-N*S,L=Math.hypot(i,a,h),L?(L=1/L,i*=L,a*=L,h*=L):(i=0,a=0,h=0),l=P*h-A*a,m=A*i-S*h,_=S*a-P*i,L=Math.hypot(l,m,_),L?(L=1/L,l*=L,m*=L,_*=L):(l=0,m=0,_=0),t[0]=i,t[1]=l,t[2]=S,t[3]=0,t[4]=a,t[5]=m,t[6]=P,t[7]=0,t[8]=h,t[9]=_,t[10]=A,t[11]=0,t[12]=-(i*O+a*D+h*W),t[13]=-(l*O+m*D+_*W),t[14]=-(S*O+P*D+A*W),t[15]=1,t)}function T8(){var t=new Pd(4);return Pd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function E8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Vm(t,e,n){var r=e[0],i=e[1],a=e[2],h=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*h,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*h,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*h,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*h,t}(function(){var t=T8();return function(e,n,r,i,a,h){var l,m;for(n||(n=4),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],a(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();var vw;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(vw||(vw={}));const P8=45*Math.PI/180,C8=1,Lb=.1,Rb=500,A8=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Da extends h8{static get IDENTITY(){return k8()}static get ZERO(){return I8()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return vw}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,a,h,l,m,_,S,P,A,L,O,D,W){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=a,this[5]=h,this[6]=l,this[7]=m,this[8]=_,this[9]=S,this[10]=P,this[11]=A,this[12]=L,this[13]=O,this[14]=D,this[15]=W,this.check()}setRowMajor(e,n,r,i,a,h,l,m,_,S,P,A,L,O,D,W){return this[0]=e,this[1]=a,this[2]=_,this[3]=L,this[4]=n,this[5]=h,this[6]=S,this[7]=O,this[8]=r,this[9]=l,this[10]=P,this[11]=D,this[12]=i,this[13]=m,this[14]=A,this[15]=W,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(A8)}fromObject(e){return this.check()}fromQuaternion(e){return y8(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:a,near:h=Lb,far:l=Rb}=e;return l===1/0?M8(this,n,r,i,a,h):_8(this,n,r,i,a,h,l),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return S8(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:a,near:h=Lb,far:l=Rb}=e;return w8(this,n,r,i,a,h,l),this.check()}orthographic(e){const{fovy:n=P8,aspect:r=C8,focalDistance:i=1,near:a=Lb,far:h=Rb}=e;gA(n);const l=n/2,m=i*Math.tan(l),_=m*r;return this.ortho({left:-_,right:_,bottom:-m,top:m,near:a,far:h})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:a=500}=e;return gA(n),x8(this,n,r,i,a),this.check()}determinant(){return p8(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*h,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],a=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*h,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*h,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*h,e}transpose(){return f8(this,this),this.check()}invert(){return _w(this,this),this.check()}multiplyLeft(e){return vu(this,e,this),this.check()}multiplyRight(e){return vu(this,this,e),this.check()}rotateX(e){return x3(this,this,e),this.check()}rotateY(e){return g8(this,this,e),this.check()}rotateZ(e){return b3(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return m8(this,this,e,n),this.check()}scale(e){return h2(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return r_(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Vm(n||[-0,-0,-0,-0],e,this),kb(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=X$(n||[-0,-0],e,this);break;case 3:i=v3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return kb(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=K$(n||[-0,-0],e,this);break;case 3:r=_3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return kb(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let ky,My;function I8(){return ky||(ky=new Da([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ky)),ky}function k8(){return My||(My=new Da,Object.freeze(My)),My}function gA(t){if(t>Math.PI*2)throw Error("expected radians")}function M8(t,e,n,r,i,a){const h=2*a/(n-e),l=2*a/(i-r),m=(n+e)/(n-e),_=(i+r)/(i-r),S=-1,P=-1,A=-2*a;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=m,t[9]=_,t[10]=S,t[11]=P,t[12]=0,t[13]=0,t[14]=A,t[15]=0,t}const yA=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,L8={lightSources:{}};function Ob(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function R8(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Ob(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((a,h)=>{i["lighting_uPointLight[".concat(h,"].color")]=Ob(a),i["lighting_uPointLight[".concat(h,"].position")]=a.position,i["lighting_uPointLight[".concat(h,"].attenuation")]=a.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((a,h)=>{i["lighting_uDirectionalLight[".concat(h,"].color")]=Ob(a),i["lighting_uDirectionalLight[".concat(h,"].direction")]=a.direction}),i.lighting_uDirectionalLightCount=r.length,i}function w3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L8;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},R8({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return w3({lightSources:e})}return{}}const O8={name:"lights",vs:yA,fs:yA,getUniforms:w3,defines:{MAX_LIGHTS:3}},z8=new Uint8Array([0,255,255,255]),D8={pickingSelectedColor:null,pickingHighlightColor:z8,pickingActive:!1,pickingAttribute:!1};function F8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D8;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const N8=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,B8=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,j8={name:"picking",vs:N8,fs:B8,getUniforms:F8},V8=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,U8={};function $8(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(a=>a/255)}}function G8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:U8;if(!("material"in t))return{};const{material:e}=t;return e?$8(e):{lighting_uEnabled:!1}}const W8={name:"gouraud-lighting",dependencies:[O8],vs:V8,defines:{LIGHTING_VERTEX:1},getUniforms:G8},H8=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,q8={name:"transform",vs:H8,fs:null};class Um{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Um(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:a={},varyings:h=[],bufferMode:l=35981,transpileToGLSL100:m=!1}=e,_=this._getModuleList(e.modules),S=this._getHash(n),P=this._getHash(r),A=_.map(F=>this._getHash(F.name)).sort(),L=h.map(F=>this._getHash(F)),O=Object.keys(i).sort(),D=Object.keys(a).sort(),W=[],z=[];for(const F of O)W.push(this._getHash(F)),W.push(this._getHash(i[F]));for(const F of D)z.push(this._getHash(F)),z.push(this._getHash(a[F]));const N="".concat(S,"/").concat(P,"D").concat(W.join("/"),"M").concat(A.join("/"),"I").concat(z.join("/"),"V").concat(L.join("/"),"H").concat(this.stateHash,"B").concat(l).concat(m?"T":"");if(!this._programCache[N]){const F=S$(this.gl,{vs:n,fs:r,modules:_,inject:a,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:m});this._programCache[N]=new o3(this.gl,{hash:N,vs:F.vs,fs:F.fs,varyings:h,bufferMode:l}),this._getUniforms[N]=F.getUniforms||($=>{}),this._useCounts[N]=0}return this._useCounts[N]++,this._programCache[N]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let a=0,h=this._defaultModules.length;a<h;++a){const l=this._defaultModules[a],m=l.name;n[i++]=l,r[m]=!0}for(let a=0,h=e.length;a<h;++a){const l=e[a],m=l.name;r[m]||(n[i++]=l,r[m]=!0)}return n.length=i,n}}const Z8={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function X8(t,e,n){const r={};let i=e.indices;for(const a in e.attributes){const h=e.attributes[a],l=Y8(a,n);if(a==="indices")i=h;else if(h.constant)r[l]=h.value;else{const m=h.value,_={...h};delete _.value,r[l]=[new ur(t,m),_],K8(a,_)}}if(i){const a=i.value||i;Bt(a instanceof Uint16Array||a instanceof Uint32Array,'attribute array for "indices" must be of integer type');const h={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ur(t,{data:a,target:34963}),h]}return r}function Y8(t,e){const{attributeMap:n=Z8}=e||{};return n&&n[t]||t}function K8(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Bt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Th=2,J8=1e4,Q8="Model needs drawMode and vertexCount",_A=()=>{},e9={};class gm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Tc("model")}=n;Bt(B_(e)),this.id=r,this.gl=e,this.id=n.id||Tc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Um.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Bt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Q8)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:a,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:S},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Bt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Bt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=X8(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return o2(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:a={},transformFeedback:h=this.transformFeedback,parameters:l={},vertexArray:m=this.vertexArray}=e;this.setAttributes(a),this.updateModuleSettings(n),this.setUniforms(i);let _;an.priority>=Th&&(_=this._logDrawCallStart(Th));const S=this.vertexArray.getDrawParams(),{isIndexed:P=S.isIndexed,indexType:A=S.indexType,indexOffset:L=S.indexOffset,vertexArrayInstanced:O=S.isInstanced}=this.props;O&&!this.isInstanced&&an.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:W}=this,{onBeforeRender:z=_A,onAfterRender:N=_A}=this.props;z(),this.program.setUniforms(this.uniforms);const F=this.program.draw(Object.assign(e9,e,{logPriority:_,uniforms:null,framebuffer:r,parameters:l,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:m,transformFeedback:h,isIndexed:P,indexType:A,isInstanced:D,instanceCount:W,offset:P?L:0}));return N(),an.priority>=Th&&this._logDrawCallEnd(_,m,r),F}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:a}=e;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,{35977:n})),i.forEach(h=>h.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:a}))}finally{i.forEach(h=>h.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return an.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:S}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:a,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:S}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Bt(n instanceof o3,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new NU(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ur&&n.delete()}}_setAnimationProps(e){this.animated&&Bt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new a3(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:J8;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),an.group(Th,">>> DRAWING MODEL ".concat(this.id),{collapsed:an.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const a=VU({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:h,unusedTable:l,unusedCount:m}=iA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:_,count:S}=iA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});S>0&&an.log("MISSING UNIFORMS",Object.keys(_))(),m>0&&an.log("UNUSED UNIFORMS",Object.keys(l))();const P=$U(this.vertexArray.configuration);an.table(e,a)(),an.table(e,h)(),an.table(e+1,P)(),i&&i.log({logLevel:Th,message:"Rendered to ".concat(i.id)}),an.groupEnd(Th)()}}class t9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ur?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Bt(Nn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const a=this.feedbackMap[i];i in n&&(r[a]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const a=r[i];if(typeof a=="string"){const h=n[a],{byteLength:l,usage:m,accessor:_}=h;r[i]=this._createNewBuffer(i,{byteLength:l,usage:m,accessor:_})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new a3(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const a=this.feedbackMap[i];n[i]=e.feedbackBuffers[a],r[a]=e.sourceBuffers[i],Bt(r[a]instanceof ur)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ur(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const n9="transform_uSampler_",i_="transform_uSize_",vA="transform_position";function r9(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,h=Object.keys(n).length,l=null;const m={};let _=e,S={};if(h>0||r){const P=_.split(`
`),A=P.slice();if(P.forEach((L,O,D)=>{if(h>0){const W=l9(L,n);if(W){const{updatedLine:z,inject:N}=W;A[O]=z,S=pw([S,N]),Object.assign(m,W.samplerTextureMap),h--}}r&&!l&&(l=a9(L,r))}),r){Bt(i);const L="".concat(i_).concat(r),O="uniform vec2 ".concat(L,`;
`),D="     vec2 ".concat(vA," = transform_getPos(").concat(L,`);
     gl_Position = vec4(`).concat(vA,`, 0, 1.);
`);S=pw([S,{"vs:#decl":O,"vs:#main-start":D}])}_=A.join(`
`)}return{vs:_,targetTextureType:l,inject:S,samplerTextureMap:m}}function i9(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let a,h;n&&({width:a,height:h}=r,i["".concat(i_).concat(n)]=[a,h]);for(const l in e)({width:a,height:h}=e[l]),i["".concat(i_).concat(l)]=[a,h];return i}function s9(t){return p3(t,["attribute","in"])}function o9(t){const e="".concat(n9).concat(t),n="".concat(i_).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function a9(t,e){const n=p3(t,["varying","out"]);return n&&n.name===e?n.type:null}function l9(t,e){const n={},r=s9(t);if(!r)return null;const{type:i,name:a}=r;if(a&&e[a]){const h="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:l,sizeName:m,uniformDeclerations:_}=o9(a),S=L$(i),P="  ".concat(i," ").concat(a," = transform_getInput(").concat(l,", ").concat(m,").").concat(S,`;
`);return n[l]=a,{updatedLine:h,inject:{"vs:#decl":_,"vs:#main-start":P},samplerTextureMap:n}}return null}const c9={10241:9728,10240:9728,10242:33071,10243:33071},u9="transform_output";class h9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:a}=this.bindings[this.currentIndex],h=Object.assign({},n,e.attributes),l=Object.assign({},e.uniforms),m=Object.assign({},e.parameters);let _=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){h.transform_elementID=this.elementIDBuffer;for(const P in this.samplerTextureMap){const A=this.samplerTextureMap[P];l[P]=r[A]}this._setSourceTextureParameters();const S=i9({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:a});Object.assign(l,S)}return this.hasTargetTexture&&(_=!1,m.viewport=[0,0,i.width,i.height]),{attributes:h,framebuffer:i,uniforms:l,discard:_,parameters:m}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=V_(n);if(!e)return r;const i=r.constructor,a=R$(this.targetTextureType),h=new i(r.length*a/4);let l=0;for(let m=0;m<r.length;m+=4)for(let _=0;_<a;_++)h[l++]=r[m+_];return h}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof ha)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,a=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:a}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,a)=>{a[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ur(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:a}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),a){e.targetTexture=a;const{width:h,height:l}=a,{framebuffer:m}=e;m?(m.update({attachments:{36064:a},resizeAttachments:!1}),m.resize({width:h,height:l})):e.framebuffer=new xi(this.gl,{id:"transform-framebuffer",width:h,height:l,attachments:{36064:a}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(c9)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=CV(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:a,targetTextureType:h,inject:l,samplerTextureMap:m}=r9({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),_=pw([e.inject||{},l]);this.targetTextureType=h,this.samplerTextureMap=m;const S=e._fs||m3({version:i3(i),input:this.targetTextureVarying,inputType:h,output:u9}),P=this.hasSourceTextures||this.targetTextureVarying?[q8].concat(e.modules||[]):e.modules;return{vs:i,fs:S,modules:P,uniforms:a,inject:_}}}class d2{static isSupported(e){return Nn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Bt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new gm(n,Object.assign({},e,{fs:e.fs||m3({version:i3(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){d9(n)&&(this.bufferTransform=new t9(e,n)),f9(n)&&(this.textureTransform=new h9(e,n)),Bt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function d9(t){return!!(!wd(t.feedbackBuffers)||!wd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function f9(t){return!!(!wd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const xA={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class f2{static get DRAW_MODE(){return xA}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Tc("geometry"),drawMode:r=xA.TRIANGLES,attributes:i={},indices:a=null,vertexCount:h=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,a),this.vertexCount=h||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Bt(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Bt(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const a=e[i],{value:h,size:l,constant:m}=a;!m&&h&&l>=1&&(r=Math.min(r,h.length/l))}return Bt(Number.isFinite(r)),r}}let p9=1,m9=1;class S3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,h=p9++,l={time:0,delay:n,duration:r,rate:i,repeat:a};return this._setChannelTime(l,this.time),this.channels.set(h,l),h}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:a,channel:h}=i;a.setTime(this.getTime(h))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=m9++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const g9=[255,255,255],y9=1;let _9=0;class v9{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","ambient");const{color:n=g9}=e,{intensity:r=y9}=e;this.id=e.id||"ambient-".concat(_9++),this.color=n,this.intensity=r}}const x9=[255,255,255],b9=1,w9=[0,0,-1];let S9=0;class bA{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","directional"),K(this,"direction",void 0),K(this,"shadow",void 0);const{color:n=x9}=e,{intensity:r=b9}=e,{direction:i=w9}=e,{_shadow:a=!1}=e;this.id=e.id||"directional-".concat(S9++),this.color=n,this.intensity=r,this.type="directional",this.direction=new za(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class T9{constructor(e,n={id:"pass"}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class p2 extends T9{constructor(...e){super(...e),K(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return gl(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:a,onViewportActive:h,clearStack:l=!0,clearCanvas:m=!0}=e;e.pass=e.pass||"unknown";const _=this.gl;m&&P9(_,n),l&&(this._lastRenderIndex=-1);const S=[];for(const P of i){const A=a&&a[P.id];h==null||h(P);const L=this._getDrawLayerParams(P,e),O=P.subViewports||[P];for(const D of O){const W=this._drawLayersInViewport(_,{target:n,moduleParameters:r,viewport:D,view:A,pass:e.pass,layers:e.layers},L);S.push(W)}}return S}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:a,cullRect:h,effects:l,moduleParameters:m},_=!1){const S=[],P=T3(this._lastRenderIndex+1),A={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:h},L={};for(let O=0;O<n.length;O++){const D=n[O],W=this._shouldDrawLayer(D,A,a,L),z={shouldDrawLayer:W};W&&!_&&(z.layerRenderIndex=P(D,W),z.moduleParameters=this._getModuleParameters(D,l,r,m),z.layerParameters=this.getLayerParameters(D,O,e)),S[O]=z}return S}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:a,viewport:h,view:l},m){const _=E9(e,{moduleParameters:r,target:a,viewport:h});if(l&&l.props.clear){const P=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;ca(e,{scissorTest:!0,scissor:_},()=>o2(e,P))}const S={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};gl(e,{viewport:_});for(let P=0;P<n.length;P++){const A=n[P],{shouldDrawLayer:L,layerRenderIndex:O,moduleParameters:D,layerParameters:W}=m[P];if(L&&A.props.pickable&&S.pickableCount++,A.isComposite)S.compositeCount++;else if(L){S.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,O),D.viewport=h;try{A._drawLayer({moduleParameters:D,uniforms:{layerIndex:O},parameters:W})}catch(z){A.raiseError(z,"drawing ".concat(A," to ").concat(i))}}}return S}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let h=e.parent;for(;h;){if(!h.props.visible||!h.filterSubLayer(n))return!1;n.layer=h,h=h.parent}if(r){const l=n.layer.id;if(l in i||(i[l]=r(n)),!i[l])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a;const h=Object.assign(Object.create(((a=e.internalState)===null||a===void 0?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:bd(this.gl)});if(n)for(const m of n){var l;Object.assign(h,(l=m.getModuleParameters)===null||l===void 0?void 0:l.call(m,e))}return Object.assign(h,this.getModuleParameters(e,n),i)}}function T3(t=0,e={}){const n={},r=(i,a)=>{const h=i.props._offset,l=i.id,m=i.parent&&i.parent.id;let _;if(m&&!(m in e)&&r(i.parent,!1),m in n){const S=n[m]=n[m]||T3(e[m],e);_=S(i,a),n[l]=S}else Number.isFinite(h)?(_=h+(e[m]||0),n[l]=null):_=t;return a&&_>=t&&(t=_+1),e[l]=_,_};return r}function E9(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",a=e&&e.devicePixelRatio||bd(t),h=i?n.height:t.drawingBufferHeight,l=r;return[l.x*a,h-(l.y+l.height)*a,l.width*a,l.height*a]}function P9(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;gl(t,{viewport:[0,0,n,r]}),t.clear(16640)}class C9 extends p2{constructor(e,n){super(e,n),K(this,"shadowMap",void 0),K(this,"depthBuffer",void 0),K(this,"fbo",void 0),this.shadowMap=new ha(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Kh(e,{format:33189,width:1,height:1}),this.fbo=new xi(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;ca(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=bd(this.gl),a=r.width*i,h=r.height*i;(a!==n.width||h!==n.height)&&n.resize({width:a,height:h}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const E3="#define SMOOTH_EDGE_RADIUS 0.5",A9=`
`.concat(E3,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),I9=`
`.concat(E3,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),k9={name:"geometry",vs:A9,fs:I9},M9=Object.keys(Hn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Hn[t],";")).join(""),L9=Object.keys(Ia).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Ia[t],";")).join(""),R9=Object.keys(um).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(um[t],";")).join(""),O9="".concat(M9,`
`).concat(L9,`
`).concat(R9,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function z9(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function $m(t){let e={},n;return r=>{for(const i in r)if(!z9(r[i],e[i])){n=t(r),e=r;break}return n}}const wA=[0,0,0,0],D9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],P3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],F9=[0,0,0],C3=[0,0,0],N9=$m(V9);function A3(t,e,n=C3){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,a=!0;switch(e===Hn.LNGLAT_OFFSETS||e===Hn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Ia.WEB_MERCATOR:(e===Hn.LNGLAT||e===Hn.CARTESIAN)&&(i=[0,0,0],a=!1);break;case Ia.WEB_MERCATOR_AUTO_OFFSET:e===Hn.LNGLAT?r=i:e===Hn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Ia.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Ia.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:a}}function B9(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:a,viewProjectionMatrix:h}=t,l=wA,m=wA,_=t.cameraPosition;const{geospatialOrigin:S,shaderCoordinateOrigin:P,offsetMode:A}=A3(t,e,n);return A&&(m=t.projectPosition(S||P),_=[_[0]-m[0],_[1]-m[1],_[2]-m[2]],m[3]=1,l=Vm([],m,h),a=r||a,h=vu([],i,a),h=vu([],h,D9)),{viewMatrix:a,viewProjectionMatrix:h,projectionCenter:l,originCommon:m,cameraPosCommon:_,shaderCoordinateOrigin:P,geospatialOrigin:S}}function j9({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Hn.DEFAULT,coordinateOrigin:i=C3,autoWrapLongitude:a=!1}){r===Hn.DEFAULT&&(r=t.isGeospatial?Hn.LNGLAT:Hn.CARTESIAN);const h=N9({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return h.project_uWrapLongitude=a,h.project_uModelMatrix=n||P3,h}function V9({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:h,cameraPosCommon:l,shaderCoordinateOrigin:m,geospatialOrigin:_}=B9(t,n,r),S=t.getDistanceScales(),P=[t.width*e,t.height*e],A=Vm([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,L={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:h.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:P,project_uDevicePixelRatio:e,project_uFocalDistance:A,project_uCommonUnitsPerMeter:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:F9,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:a,project_uModelMatrix:P3,project_uCameraPosition:l};if(_){const O=t.getDistanceScales(_);switch(n){case Hn.METER_OFFSETS:L.project_uCommonUnitsPerWorldUnit=O.unitsPerMeter,L.project_uCommonUnitsPerWorldUnit2=O.unitsPerMeter2;break;case Hn.LNGLAT:case Hn.LNGLAT_OFFSETS:t._pseudoMeters||(L.project_uCommonUnitsPerMeter=O.unitsPerMeter),L.project_uCommonUnitsPerWorldUnit=O.unitsPerDegree,L.project_uCommonUnitsPerWorldUnit2=O.unitsPerDegree2;break;case Hn.CARTESIAN:L.project_uCommonUnitsPerWorldUnit=[1,1,O.unitsPerMeter[2]],L.project_uCommonUnitsPerWorldUnit2=[0,0,O.unitsPerMeter2[2]];break}}return L}const U9={};function $9(t=U9){return"viewport"in t?j9(t):{}}const m2={name:"project",dependencies:[D$,k9],vs:O9,getUniforms:$9};function G9(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ld(t,e){const n=Vm([],e,t);return E8(n,n,1/n[3]),n}function SA(t,e){const n=t%e;return n<0?e+n:n}function W9(t,e,n){return n*e+(1-n)*t}function xw(t,e,n){return t<e?e:t>n?n:t}function H9(t){return Math.log(t)*Math.LOG2E}const g2=Math.log2||H9;function yl(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const sa=Math.PI,I3=sa/4,Ro=sa/180,bw=180/sa,Cd=512,s_=4003e4,Ly=85.051129,q9=1.5;function TA(t){return Math.pow(2,t)}function k3(t){return g2(t)}function Ad(t){const[e,n]=t;yl(Number.isFinite(e)),yl(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Ro,i=n*Ro,a=Cd*(r+sa)/(2*sa),h=Cd*(sa+Math.log(Math.tan(I3+i*.5)))/(2*sa);return[a,h]}function Cu(t){const[e,n]=t,r=e/Cd*(2*sa)-sa,i=2*(Math.atan(Math.exp(n/Cd*(2*sa)-sa))-I3);return[r*bw,i*bw]}function Z9(t){const{latitude:e}=t;yl(Number.isFinite(e));const n=Math.cos(e*Ro);return k3(s_*n)-9}function zb(t){const e=Math.cos(t*Ro);return Cd/s_/e}function ww(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;yl(Number.isFinite(e)&&Number.isFinite(n));const i=Cd,a=Math.cos(e*Ro),h=i/360,l=h/a,m=i/s_/a,_={unitsPerMeter:[m,m,m],metersPerUnit:[1/m,1/m,1/m],unitsPerDegree:[h,l,m],degreesPerUnit:[1/h,1/l,1/m]};if(r){const S=Ro*Math.tan(e*Ro)/a,P=h*S/2,A=i/s_*S,L=A/l*m;_.unitsPerDegree2=[0,P,A],_.unitsPerMeter2=[L,0,L]}return _}function M3(t,e){const[n,r,i]=t,[a,h,l]=e,{unitsPerMeter:m,unitsPerMeter2:_}=ww({longitude:n,latitude:r,highPrecision:!0}),S=Ad(t);S[0]+=a*(m[0]+_[0]*h),S[1]+=h*(m[1]+_[1]*h);const P=Cu(S),A=(i||0)+(l||0);return Number.isFinite(i)||Number.isFinite(l)?[P[0],P[1],A]:P}function X9(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:a,center:h}=t,l=G9();r_(l,l,[0,0,-i]),x3(l,l,-n*Ro),b3(l,l,r*Ro);const m=a/e;return h2(l,l,[m,m,m]),h&&r_(l,l,t8([],h)),l}function Y9(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:a,center:h,scale:l,nearZMultiplier:m=1,farZMultiplier:_=1}=t;let{fovy:S=o_(q9)}=t;r!==void 0&&(S=o_(r));const P=S*Ro,A=i*Ro,L=L3(S);let O=L;h&&(O+=h[2]*l/Math.cos(A)/n);const D=P*(.5+(a?a[1]:0)/n),W=Math.sin(D)*O/Math.sin(xw(Math.PI/2-A-D,.01,Math.PI-.01)),z=Math.sin(A)*W+O,N=O*10,F=Math.min(z*_,N);return{fov:P,aspect:e/n,focalDistance:L,near:m,far:F}}function o_(t){return 2*Math.atan(.5/t)*bw}function L3(t){return .5/Math.tan(.5*t*Ro)}function R3(t,e){const[n,r,i=0]=t;return yl(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),ld(e,[n,r,i,1])}function y2(t,e,n=0){const[r,i,a]=t;if(yl(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return ld(e,[r,i,a,1]);const h=ld(e,[r,i,0,1]),l=ld(e,[r,i,1,1]),m=h[2],_=l[2],S=m===_?0:((n||0)-m)/(_-m);return y3([],h,l,S)}function K9(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:a=24,offset:h=[0,0]}=t,[[l,m],[_,S]]=r,P=J9(t.padding),A=Ad([l,xw(S,-Ly,Ly)]),L=Ad([_,xw(m,-Ly,Ly)]),O=[Math.max(Math.abs(L[0]-A[0]),i),Math.max(Math.abs(L[1]-A[1]),i)],D=[e-P.left-P.right-Math.abs(h[0])*2,n-P.top-P.bottom-Math.abs(h[1])*2];yl(D[0]>0&&D[1]>0);const W=D[0]/O[0],z=D[1]/O[1],N=(P.right-P.left)/2/W,F=(P.top-P.bottom)/2/z,$=[(L[0]+A[0])/2+N,(L[1]+A[1])/2+F],Q=Cu($),te=Math.min(a,g2(Math.abs(Math.min(W,z))));return yl(Number.isFinite(te)),{longitude:Q[0],latitude:Q[1],zoom:te}}function J9(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(yl(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const EA=Math.PI/180;function Q9(t,e=0){const{width:n,height:r,unproject:i}=t,a={targetZ:e},h=i([0,r],a),l=i([n,r],a);let m,_;const S=t.fovy?.5*t.fovy*EA:Math.atan(.5/t.altitude),P=(90-t.pitch)*EA;return S>P-.01?(m=PA(t,0,e),_=PA(t,n,e)):(m=i([0,0],a),_=i([n,0],a)),[h,l,_,m]}function PA(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=ld(r,[e,0,1,1]),a=ld(r,[e,t.height,1,1]),l=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),m=y3([],i,a,l),_=Cu(m);return _.push(n),_}const CA=512;function eG(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:a,zoom:h,bearing:l=0}=t;(i<-180||i>180)&&(i=SA(i+180,360)-180),(l<-180||l>180)&&(l=SA(l+180,360)-180);const m=g2(n/CA);if(h<=m)h=m,a=0;else{const _=n/2/Math.pow(2,h),S=Cu([0,_])[1];if(a<S)a=S;else{const P=Cu([0,CA-_])[1];a>P&&(a=P)}}return{width:e,height:n,longitude:i,latitude:a,zoom:h,pitch:r,bearing:l}}const O3=.01,tG=["longitude","latitude","zoom"],z3={curve:1.414,speed:1.2};function nG(t,e,n,r){const{startZoom:i,startCenterXY:a,uDelta:h,w0:l,u1:m,S:_,rho:S,rho2:P,r0:A}=D3(t,e,r);if(m<O3){const $={};for(const Q of tG){const te=t[Q],ie=e[Q];$[Q]=W9(te,ie,n)}return $}const L=n*_,O=Math.cosh(A)/Math.cosh(A+S*L),D=l*((Math.cosh(A)*Math.tanh(A+S*L)-Math.sinh(A))/P)/m,W=1/O,z=i+k3(W),N=H$([],h,D);yw(N,N,a);const F=Cu(N);return{longitude:F[0],latitude:F[1],zoom:z}}function rG(t,e,n){const r={...z3,...n},{screenSpeed:i,speed:a,maxDuration:h}=r,{S:l,rho:m}=D3(t,e,r),_=1e3*l;let S;return Number.isFinite(i)?S=_/(i/m):S=_/a,Number.isFinite(h)&&S>h?0:S}function D3(t,e,n){n=Object.assign({},z3,n);const r=n.curve,i=t.zoom,a=[t.longitude,t.latitude],h=TA(i),l=e.zoom,m=[e.longitude,e.latitude],_=TA(l-i),S=Ad(a),P=Ad(m),A=Y$([],P,S),L=Math.max(t.width,t.height),O=L/_,D=q$(A)*h,W=Math.max(D,O3),z=r*r,N=(O*O-L*L+z*z*W*W)/(2*L*z*W),F=(O*O-L*L-z*z*W*W)/(2*O*z*W),$=Math.log(Math.sqrt(N*N+1)-N),Q=Math.log(Math.sqrt(F*F+1)-F),te=(Q-$)/r;return{startZoom:i,startCenterXY:S,uDelta:A,w0:L,u1:D,S:te,rho:r,rho2:z,r0:$,r1:Q}}const iG=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,sG=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,oG=$m(hG),aG=$m(dG),lG=[0,0,0,1],cG=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function uG(t,e){const[n,r,i]=t,a=y2([n,r,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function hG({viewport:t,center:e}){return new Da(t.viewProjectionMatrix).invert().transform(e)}function dG({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(h=>uG(h,r));for(const h of e){const l=h.clone().translate(new za(t.center).negate()),m=a.map(S=>l.transform(S)),_=new Da().ortho({left:Math.min(...m.map(S=>S[0])),right:Math.max(...m.map(S=>S[0])),bottom:Math.min(...m.map(S=>S[1])),top:Math.max(...m.map(S=>S[1])),near:Math.min(...m.map(S=>-S[2])),far:Math.max(...m.map(S=>-S[2]))});n.push(_.multiplyRight(h))}return n}function fG(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||lG,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=oG({viewport:t.viewport,center:e.project_uCenter}),a=[],h=aG({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<t.shadowMatrices.length;l++){const m=h[l],_=m.clone().translate(new za(t.viewport.center).negate());e.project_uCoordinateSystem===Hn.LNGLAT&&e.project_uProjectionMode===Ia.WEB_MERCATOR?(h[l]=_,a[l]=i):(h[l]=m.clone().multiplyRight(cG),a[l]=_.transform(i))}for(let l=0;l<h.length;l++)r["shadow_uViewProjectionMatrices[".concat(l,"]")]=h[l],r["shadow_uProjectCenters[".concat(l,"]")]=a[l],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(l)]=t.shadowMaps[l]:r["shadow_uShadowMap".concat(l)]=t.dummyShadowMap;return r}const Db={name:"shadow",dependencies:[m2],vs:iG,fs:sG,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?fG(t,e):{}},pG={color:[255,255,255],intensity:1},AA=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],mG=[0,0,0,200/255];class F3{constructor(e={}){K(this,"id","lighting-effect"),K(this,"props",void 0),K(this,"shadowColor",mG),K(this,"shadow",void 0),K(this,"ambientLight",void 0),K(this,"directionalLights",void 0),K(this,"pointLights",void 0),K(this,"shadowPasses",[]),K(this,"shadowMaps",[]),K(this,"dummyShadowMap",null),K(this,"programManager",void 0),K(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Um.getDefaultProgramManager(e),Db&&this.programManager.addDefaultModule(Db)),this.dummyShadowMap||(this.dummyShadowMap=new ha(e,{width:1,height:1}));for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:n,layerFilter:r,viewports:i,onViewportActive:a,views:h,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Db),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Da().lookAt({eye:new za(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new C9(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new v9(pG),this.directionalLights.push(new bA(AA[0]),new bA(AA[1])))}}class gG{constructor(e={}){K(this,"_pool",[]),K(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:a=0,copy:h=!1,initialize:l=!1,maxCount:m}){const _=i||e&&e.constructor||Float32Array,S=n*r+a;if(ArrayBuffer.isView(e)){if(S<=e.length)return e;if(S*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new _(e.buffer,0,S)}let P=1/0;m&&(P=m*r+a);const A=this._allocate(_,S,l,P);return e&&h?A.set(e):l||A.fill(0,0,4),this._release(e),A}release(e){this._release(e)}_allocate(e,n,r,i){let a=Math.max(Math.ceil(n*this.opts.overAlloc),1);a>i&&(a=i);const h=this._pool,l=e.BYTES_PER_ELEMENT*a,m=h.findIndex(_=>_.byteLength>=l);if(m>=0){const _=new e(h.splice(m,1)[0],0,a);return r&&_.fill(0),_}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,a=n.findIndex(h=>h.byteLength>=i);a<0?n.push(r):(a>0||n.length<this.opts.poolSize)&&n.splice(a,0,r),n.length>this.opts.poolSize&&n.shift()}}const Id=new gG;function Pp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yG(t){return[t[12],t[13],t[14]]}function _G(t){return{left:Eh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Eh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Eh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Eh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Eh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Eh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const IA=new za;function Eh(t,e,n,r){IA.set(t,e,n);const i=IA.len();return{distance:r/i,normal:new za(-t/i,-e/i,-n/i)}}function vG(t){return t-Math.fround(t)}let up;function Fb(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,a=(i-r)/n;up=Id.allocate(up,a,{type:Float32Array,size:n*2});let h=r,l=0;for(;h<i;){for(let m=0;m<n;m++){const _=t[h++];up[l+m]=_,up[l+m+n]=vG(_)}l+=n*2}return up.subarray(0,a*n*2)}function xG(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const bG=Math.PI/180,wG=Pp(),kA=[0,0,0],SG={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function TG({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:a,near:h,far:l}){const m=t/e,_=n?new Da().orthographic({fovy:r,aspect:m,focalDistance:i,near:h,far:l}):new Da().perspective({fovy:r,aspect:m,near:h,far:l});if(a){const{left:S=0,right:P=0,top:A=0,bottom:L=0}=a,O=oc((S+t-P)/2,0,t)-t/2,D=oc((A+e-L)/2,0,e)-e/2;_[8]-=O*2/t,_[9]+=D*2/e}return _}class Gd{constructor(e={}){K(this,"id",void 0),K(this,"x",void 0),K(this,"y",void 0),K(this,"width",void 0),K(this,"height",void 0),K(this,"padding",void 0),K(this,"isGeospatial",void 0),K(this,"zoom",void 0),K(this,"focalDistance",void 0),K(this,"position",void 0),K(this,"modelMatrix",void 0),K(this,"distanceScales",void 0),K(this,"scale",void 0),K(this,"center",void 0),K(this,"cameraPosition",void 0),K(this,"projectionMatrix",void 0),K(this,"viewMatrix",void 0),K(this,"viewMatrixUncentered",void 0),K(this,"viewMatrixInverse",void 0),K(this,"viewProjectionMatrix",void 0),K(this,"pixelProjectionMatrix",void 0),K(this,"pixelUnprojectionMatrix",void 0),K(this,"resolution",void 0),K(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||SG,this.focalDistance=e.focalDistance||1,this.position=e.position||kA,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Ia.WEB_MERCATOR:Ia.WEB_MERCATOR_AUTO_OFFSET:Ia.IDENTITY}equals(e){return e instanceof Gd?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&mm(e.projectionMatrix,this.projectionMatrix)&&mm(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=R3(r,this.pixelProjectionMatrix),[a,h]=i,l=n?h:this.height-h;return e.length===2?[a,l]:[a,l,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,a,h]=e,l=n?a:this.height-a,m=r&&r*this.distanceScales.unitsPerMeter[2],_=y2([i,l,h],this.pixelUnprojectionMatrix,m),[S,P,A]=this.unprojectPosition(_);return Number.isFinite(h)?[S,P,A]:Number.isFinite(r)?[S,P,r]:[S,P]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Ad(e);return n[1]=oc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Cu(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),a=this.unproject([0,this.height],n),h=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],a[0],h[0]),Math.min(r[1],i[1],a[1],h[1]),Math.max(r[0],i[0],a[0],h[0]),Math.max(r[1],i[1],a[1],h[1])]}getDistanceScales(e){return e?ww({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,_G(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Z9({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||ww({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:h}=e;let l=kA;if(a&&(l=h?new Da(h).transformAsVector(a,[]):a),this.isGeospatial){const m=this.projectPosition([n,r,0]);this.center=new za(l).scale(this.distanceScales.unitsPerMeter).add(m)}else this.center=this.projectPosition(l)}_initMatrices(e){const{viewMatrix:n=wG,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:a,fovy:h=75,near:l=.1,far:m=1e3,padding:_=null,focalDistance:S=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Da().multiplyRight(n).translate(new za(this.center).negate()),this.projectionMatrix=r||TG({width:this.width,height:this.height,orthographic:i,fovyRadians:a||h*bG,focalDistance:S,padding:_,near:l,far:m});const P=Pp();vu(P,P,this.projectionMatrix),vu(P,P,this.viewMatrix),this.viewProjectionMatrix=P,this.viewMatrixInverse=_w([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=yG(this.viewMatrixInverse);const A=Pp(),L=Pp();h2(A,A,[this.width/2,-this.height/2,1]),r_(A,A,[1,-1,0]),vu(L,A,this.viewProjectionMatrix),this.pixelProjectionMatrix=L,this.pixelUnprojectionMatrix=_w(Pp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||hr.warn("Pixel project matrix not invertible")()}}K(Gd,"displayName","Viewport");class kd extends Gd{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:a=0,bearing:h=0,nearZMultiplier:l=.1,farZMultiplier:m=1.01,nearZ:_,farZ:S,orthographic:P=!1,projectionMatrix:A,repeat:L=!1,worldOffset:O=0,position:D,padding:W,legacyMeterSizes:z=!1}=e;let{width:N,height:F,altitude:$=1.5}=e;const Q=Math.pow(2,i);N=N||1,F=F||1;let te,ie=null;if(A)$=A[5]/2,te=o_($);else{e.fovy?(te=e.fovy,$=L3(te)):te=o_($);let Te;if(W){const{top:_e=0,bottom:Re=0}=W;Te=[0,oc((_e+F-Re)/2,0,F)-F/2]}ie=Y9({width:N,height:F,scale:Q,center:D&&[0,0,D[2]*zb(n)],offset:Te,pitch:a,fovy:te,nearZMultiplier:l,farZMultiplier:m}),Number.isFinite(_)&&(ie.near=_),Number.isFinite(S)&&(ie.far=S)}let xe=X9({height:F,pitch:a,bearing:h,scale:Q,altitude:$});O&&(xe=new Da().translate([512*O,0,0]).multiplyLeft(xe)),super({...e,width:N,height:F,viewMatrix:xe,longitude:r,latitude:n,zoom:i,...ie,fovy:te,focalDistance:$}),K(this,"longitude",void 0),K(this,"latitude",void 0),K(this,"pitch",void 0),K(this,"bearing",void 0),K(this,"altitude",void 0),K(this,"fovy",void 0),K(this,"orthographic",void 0),K(this,"_subViewports",void 0),K(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=a,this.bearing=h,this.altitude=$,this.fovy=te,this.orthographic=P,this._subViewports=L?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const a=i?new kd({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*zb(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/zb(r);return[n,r,i]}addMetersToLngLat(e,n){return M3(e,n)}panByPosition(e,n){const r=y2(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=yw([],i,Z$([],r)),h=yw([],this.center,a),[l,m]=this.unprojectFlat(h);return{longitude:l,latitude:m}}getBounds(e={}){const n=Q9(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:a,latitude:h,zoom:l}=K9({width:r,height:i,bounds:e,...n});return new kd({width:r,height:i,longitude:a,latitude:h,zoom:l})}}K(kd,"displayName","WebMercatorViewport");const MA=[0,0,0];function Nb(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof kd){const[i,a,h=0]=t,l=e.getDistanceScales([i,a]);r[2]=h*l.unitsPerMeter[2]}return r}function EG(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:h}=t;return i===Hn.DEFAULT&&(i=e.isGeospatial?Hn.LNGLAT:Hn.CARTESIAN),a===void 0&&(a=i),h===void 0&&(h=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:a,fromCoordinateOrigin:h}}function N3(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:a}){let[h,l,m=0]=t;switch(n&&([h,l,m]=Vm([],[h,l,m,1],n)),r){case Hn.LNGLAT:return Nb([h,l,m],e,a);case Hn.LNGLAT_OFFSETS:return Nb([h+i[0],l+i[1],m+(i[2]||0)],e,a);case Hn.METER_OFFSETS:return Nb(M3(i,[h,l,m]),e,a);case Hn.CARTESIAN:default:return e.isGeospatial?[h+i[0],l+i[1],m+i[2]]:e.projectPosition([h,l,m])}}function PG(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:h,fromCoordinateOrigin:l}=EG(e),{autoOffset:m=!0}=e,{geospatialOrigin:_=MA,shaderCoordinateOrigin:S=MA,offsetMode:P=!1}=m?A3(n,r,i):{},A=N3(t,{viewport:n,modelMatrix:a,coordinateSystem:h,coordinateOrigin:l,offsetMode:P});if(P){const L=n.projectPosition(_||S);u8(A,A,L)}return A}const LA={blendFunc:[1,0,32771,0],blendEquation:32774};class B3 extends p2{constructor(...e){super(...e),K(this,"pickZ",void 0),K(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,pickingFBO:h,deviceRect:{x:l,y:m,width:_,height:S},cullRect:P,effects:A,pass:L="picking",pickZ:O,moduleParameters:D}){const W=this.gl;this.pickZ=O;const z=this._resetColorEncoder(O),N=ca(W,{scissorTest:!0,scissor:[l,m,_,S],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...LA,blend:!O},()=>super.render({target:h,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:a,cullRect:P,effects:A==null?void 0:A.filter($=>$.useInPicking),pass:L,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:z&&AG.bind(null,z),stats:N}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:a,operation:h}=e.props;return this._colorEncoderState?a&&h.includes("draw")&&(Object.assign(i,LA),i.blend=!0,i.blendColor=CG(this._colorEncoderState,e,r)):i.blend=!1,h.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function CG(t,e,n){const{byLayer:r,byAlpha:i}=t;let a,h=r.get(e);return h?(h.viewports.push(n),a=h.a):(a=r.size+1,a<=255?(h={a,layer:e,viewports:[n]},r.set(e,h),i[a]=h):(hr.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function AG(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Fh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},a_=Symbol.for("component"),xc=Symbol.for("propTypes"),Bb=Symbol.for("deprecatedProps"),cd=Symbol.for("asyncPropDefaults"),Au=Symbol.for("asyncPropOriginal"),ac=Symbol.for("asyncPropResolved");function _2(t,e=()=>!0){return Array.isArray(t)?j3(t,e,[]):e(t)?[t]:[]}function j3(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?j3(i,e,n):e(i)&&n.push(i)}return n}function IG({target:t,source:e,start:n=0,count:r=1}){const i=e.length,a=r*i;let h=0;for(let l=n;h<i;h++)t[l++]=e[h];for(;h<a;)h<a-h?(t.copyWithin(n+h,n,n+h),h*=2):(t.copyWithin(n+h,n,n+a-h),h=a);return t}class kG{constructor(e,n,r){K(this,"id",void 0),K(this,"context",void 0),K(this,"isLoaded",void 0),K(this,"persistent",void 0),K(this,"_loadCount",0),K(this,"_subscribers",new Set),K(this,"_data",void 0),K(this,"_loader",void 0),K(this,"_error",void 0),K(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=sw(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class MG{constructor({gl:e,protocol:n}){K(this,"protocol",void 0),K(this,"_context",void 0),K(this,"_resources",void 0),K(this,"_consumers",void 0),K(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(n,r):(a=new kG(e,n,this._context),this._resources[e]=a),a.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:a,protocol:h}=this;e.startsWith(h)&&(e=e.replace(h,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const l=a[e];if(this._track(r,i,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const a=this._consumers,h=a[e]=a[e]||{},l=h[n]||{},m=l.resourceId&&this._resources[l.resourceId];m&&(m.unsubscribe(l),this.prune()),r&&(h[n]=l,l.onChange=i,l.resourceId=r.id,r.subscribe(l))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const LG=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,v2={name:"project32",dependencies:[m2],vs:LG},x2={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...j8},RG=[m2],OG=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function zG(t){const e=Um.getDefaultProgramManager(t);for(const n of RG)e.addDefaultModule(n);for(const n of OG)e.addShaderHook(n);return e}const DG="layerManager.setLayers",FG="layerManager.activateViewport";class NG{constructor(e,{deck:n,stats:r,viewport:i,timeline:a}={}){K(this,"layers",void 0),K(this,"context",void 0),K(this,"resourceManager",void 0),K(this,"_lastRenderedLayers",[]),K(this,"_needsRedraw",!1),K(this,"_needsUpdate",!1),K(this,"_nextLayers",null),K(this,"_debug",!1),K(this,"activateViewport",h=>{ss(FG,this,h),h&&(this.context.viewport=h)}),this.layers=[],this.resourceManager=new MG({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&zG(e),stats:r||new XS({id:"deck.gl"}),viewport:i||new Gd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:a||new S3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(DG,this,n,e),this._lastRenderedLayers=e;const r=_2(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const h of e)r[h.id]?hr.warn("Multiple old layers with same id ".concat(h.id))():r[h.id]=h;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let a=!1;for(const h of i)if(h.hasUniformTransition()){a="Uniform transition in ".concat(h);break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const a=n[i.id];a===null&&hr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let h=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),h=i.isComposite?i.getSubLayers():null}catch(l){this._handleError("matching",l,i)}h&&this._updateSublayersRecursively(h,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Fh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Fh.MATCHED,n!==e&&(e.lifecycle=Fh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Fh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Fh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function ka(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ka(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r)if(!e.hasOwnProperty(a)||!ka(t[a],e[a],n-1))return!1;return!0}return!1}class BG{constructor(e){K(this,"width",void 0),K(this,"height",void 0),K(this,"views",void 0),K(this,"viewState",void 0),K(this,"controllers",void 0),K(this,"timeline",void 0),K(this,"_viewports",void 0),K(this,"_viewportMap",void 0),K(this,"_isUpdating",void 0),K(this,"_needsRedraw",void 0),K(this,"_needsUpdate",void 0),K(this,"_eventManager",void 0),K(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let a=r.length-1;a>=0;--a){const h=r[a];if(h.containsPixel(i)){const l=e.slice();return l[0]-=h.x,l[1]-=h.y,h.unproject(l,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=_2(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!ka(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):hr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>{var h;return(h=this.getView(e.id))===null||h===void 0?void 0:h.makeViewport({viewState:a,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const a=e.controller;if(a&&r){const h={...n,...a,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,h)),i&&i.setProps(h),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const a=e[i],h=this.getViewState(a),l=a.makeViewport({viewState:h,width:this.width,height:this.height});let m=n[a.id];const _=!!a.controller;_&&!m&&(r=!0),(r||!_)&&m&&(m.finalize(),m=null),this.controllers[a.id]=this._updateController(a,h,l,m),l&&this._viewports.unshift(l)}for(const i in n){const a=n[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const jG=/([0-9]+\.?[0-9]*)(%|px)/;function Zl(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=jG.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Xl(t,e){return t.relative?Math.round(t.position*e):t.position}function Ci(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Md{constructor(e){K(this,"id",void 0),K(this,"viewportInstance",void 0),K(this,"_x",void 0),K(this,"_y",void 0),K(this,"_width",void 0),K(this,"_height",void 0),K(this,"_padding",void 0),K(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:a="100%",height:h="100%",padding:l=null,viewportInstance:m}=e||{};Ci(!m||m instanceof Gd),this.viewportInstance=m,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Zl(r),this._y=Zl(i),this._width=Zl(a),this._height=Zl(h),this._padding=l&&{left:Zl(l.left||0),right:Zl(l.right||0),top:Zl(l.top||0),bottom:Zl(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&ka(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Xl(this._x,e),y:Xl(this._y,n),width:Xl(this._width,e),height:Xl(this._height,n)};return this._padding&&(r.padding={left:Xl(this._padding.left,e),top:Xl(this._padding.top,n),right:Xl(this._padding.right,e),bottom:Xl(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Gm=class{constructor(e){K(this,"_inProgress",void 0),K(this,"_handle",void 0),K(this,"_timeline",void 0),K(this,"time",void 0),K(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const RA=()=>{},Sw={BREAK:1,SNAP_TO_END:2,IGNORE:3},VG=t=>t,UG=Sw.BREAK;class $G{constructor(e){K(this,"getControllerState",void 0),K(this,"props",void 0),K(this,"propsInTransition",void 0),K(this,"transition",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:a,endProps:h,duration:l,easing:m}}=n,_=m(r/l),S=i.interpolateProps(a,h,_);this.propsInTransition=this.getControllerState({...this.props,...S}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Gm(e.timeline),this.onViewStateChange=e.onViewStateChange||RA,this.onStateChange=e.onStateChange||RA}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:a,endProps:h}=this.transition.settings;i={...r,...a===Sw.SNAP_TO_END?h:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Sw.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),a=n.transitionInterpolator,h=a.getDuration?a.getDuration(e,n):n.transitionDuration;if(h===0)return;const l=a.initializeProps(e,i);this.propsInTransition={};const m={duration:h,easing:n.transitionEasing||VG,interpolator:a,interruption:n.transitionInterruption||UG,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(m),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class V3{constructor(e){K(this,"_propsToCompare",void 0),K(this,"_propsToExtract",void 0),K(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!mm(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const a of this._propsToExtract)(a in e||a in n)&&(r[a]=e[a],i[a]=n[a]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ci(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const GG=["longitude","latitude","zoom","bearing","pitch"],WG=["longitude","latitude","zoom"];class U3 extends V3{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:GG,required:WG},super(r.transitionProps),K(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:a}=this.opts;if(i&&a){const h=i(e),l=i(n),m=h.unproject(a);r.start.around=a,Object.assign(r.end,{around:l.project(m),aroundPosition:m,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const a of this._propsToExtract)i[a]=pm(e[a]||0,n[a]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...n,...i});Object.assign(i,a.panByPosition(n.aroundPosition,pm(e.around,n.around,r)))}return i}}const Yl={transitionDuration:0},HG=300,Ry=t=>1-(1-t)*(1-t),Ph={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},eu={};class qG{constructor(e){K(this,"props",void 0),K(this,"state",{}),K(this,"transitionManager",void 0),K(this,"eventManager",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"makeViewport",void 0),K(this,"_controllerState",void 0),K(this,"_events",{}),K(this,"_interactionState",{isDragging:!1}),K(this,"_customEvents",[]),K(this,"_eventStartBlocked",null),K(this,"_panMove",!1),K(this,"invertPan",!1),K(this,"dragMode","rotate"),K(this,"inertia",0),K(this,"scrollZoom",!0),K(this,"dragPan",!0),K(this,"dragRotate",!0),K(this,"doubleClickZoom",!0),K(this,"touchZoom",!0),K(this,"touchRotate",!1),K(this,"keyboard",!0),this.transitionManager=new $G({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const a=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return a&&n&&n.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?HG:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:h=!0,touchZoom:l=!0,touchRotate:m=!1,keyboard:_=!0}=e,S=!!this.onViewStateChange;this.toggleEvents(Ph.WHEEL,S&&r),this.toggleEvents(Ph.PAN,S),this.toggleEvents(Ph.PINCH,S&&(l||m)),this.toggleEvents(Ph.TRIPLE_PAN,S&&m),this.toggleEvents(Ph.DOUBLE_TAP,S&&h),this.toggleEvents(Ph.KEYBOARD,S&&_),this.scrollZoom=r,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=h,this.touchZoom=l,this.touchRotate=m,this.keyboard=_}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),a){const h=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:h})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Yl,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ry},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ry},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let h=2/(1+Math.exp(-Math.abs(a*r)));a<0&&h!==0&&(h=1/h);const l=this.controllerState.zoom({pos:n,scale:h});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Yl,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Yl,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Ry},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return eu._startPinchRotation=e.rotation,eu._lastPinchEvent=e,this.updateViewport(r,Yl,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:eu._startPinchRotation-r})}return this.updateViewport(n,Yl,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),eu._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=eu;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const h=Math.log2(e.scale),l=(h-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),m=Math.pow(2,h+l*n/2);a=a.zoom({pos:i,scale:m}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Ry},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return eu._startPinchRotation=null,eu._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:h}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let m;const _={};switch(e.srcEvent.code){case"Minus":m=n?l.zoomOut(r).zoomOut(r):l.zoomOut(r),_.isZooming=!0;break;case"Equal":m=n?l.zoomIn(r).zoomIn(r):l.zoomIn(r),_.isZooming=!0;break;case"ArrowLeft":n?(m=l.rotateLeft(a),_.isRotating=!0):(m=l.moveLeft(i),_.isPanning=!0);break;case"ArrowRight":n?(m=l.rotateRight(a),_.isRotating=!0):(m=l.moveRight(i),_.isPanning=!0);break;case"ArrowUp":n?(m=l.rotateUp(h),_.isRotating=!0):(m=l.moveUp(i),_.isPanning=!0);break;case"ArrowDown":n?(m=l.rotateDown(h),_.isRotating=!0):(m=l.moveDown(i),_.isPanning=!0);break;default:return!1}return this.updateViewport(m,this._getTransitionProps(),_),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Yl:e?{...n,transitionInterpolator:new U3({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class ZG{constructor(e,n){K(this,"_viewportProps",void 0),K(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const OA=5,XG=1.2;class YG extends ZG{constructor(e){const{width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l=0,pitch:m=0,altitude:_=1.5,position:S=[0,0,0],maxZoom:P=20,minZoom:A=0,maxPitch:L=60,minPitch:O=0,startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$,normalize:Q=!0}=e;Ci(Number.isFinite(a)),Ci(Number.isFinite(i)),Ci(Number.isFinite(h)),super({width:n,height:r,latitude:i,longitude:a,zoom:h,bearing:l,pitch:m,altitude:_,maxZoom:P,minZoom:A,maxPitch:L,minPitch:O,normalize:Q,position:S},{startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$}),K(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:a,startPitch:h}=this.getState();if(!i||a===void 0||h===void 0)return this;let l;return e?l=this._getNewRotation(e,i,h,a):l={bearing:a+n,pitch:h+r},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;const{maxZoom:h,minZoom:l}=this.getViewportProps();let m=i+Math.log2(r);m=oc(m,l,h);const _=this.makeViewport({...this.getViewportProps(),zoom:m});return this._getUpdatedState({zoom:m,..._.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:a}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(a-n.longitude)>180&&(r.longitude=a<0?a+360:a-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=oc(i,r,n);const{maxPitch:a,minPitch:h,pitch:l}=e;e.pitch=oc(l,h,a);const{normalize:m=!0}=e;return m&&Object.assign(e,eG(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const a=e[0]-n[0],h=e[1]-n[1],l=e[1],m=n[1],{width:_,height:S}=this.getViewportProps(),P=a/_;let A=0;h>0?Math.abs(S-m)>OA&&(A=h/(m-S)*XG):h<0&&m>OA&&(A=1-l/m),A=oc(A,-1,1);const{minPitch:L,maxPitch:O}=this.getViewportProps(),D=i+180*P;let W=r;return A>0?W=r+A*(O-r):A<0&&(W=r-A*(L-r)),{pitch:W,bearing:D}}}class KG extends qG{constructor(...e){super(...e),K(this,"ControllerState",YG),K(this,"transition",{transitionDuration:300,transitionInterpolator:new U3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),K(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class $3 extends Md{get ViewportType(){return kd}get ControllerType(){return KG}}K($3,"displayName","MapView");const JG=new F3;function QG(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,a=(r=e.order)!==null&&r!==void 0?r:1/0;return i-a}class e7{constructor(){K(this,"effects",void 0),K(this,"_resolvedEffects",[]),K(this,"_defaultEffects",[]),K(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>QG(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ka(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const a=n[i.id];a&&a!==i?a.setProps?(a.setProps(i.props),r.push(a)):(a.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof F3)||this._resolvedEffects.push(JG),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class t7 extends p2{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const n7="deckRenderer.renderLayers";class r7{constructor(e){K(this,"gl",void 0),K(this,"layerFilter",void 0),K(this,"drawPickingColors",void 0),K(this,"drawLayersPass",void 0),K(this,"pickLayersPass",void 0),K(this,"renderCount",void 0),K(this,"_needsRedraw",void 0),K(this,"renderBuffers",void 0),K(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new t7(e),this.pickLayersPass=new B3(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||xi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,a=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,ss(n7,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new xi(this.gl),new xi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const a of e)if(a.postRender){if(a.id===this.lastPostProcessEffect){i.target=n.target,a.postRender(this.gl,i);break}const h=a.postRender(this.gl,i);i.inputBuffer=h,i.swapBuffer=h===r[0]?r[1]:r[0]}}}const i7={pickedColor:null,pickedObjectIndex:-1};function s7({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:a}){const{x:h,y:l,width:m,height:_}=a;let S=i*i,P=-1,A=0;for(let L=0;L<_;L++){const O=L+l-r,D=O*O;if(D>S)A+=4*m;else for(let W=0;W<m;W++){if(t[A+3]-1>=0){const N=W+h-n,F=N*N+D;F<=S&&(S=F,P=A)}A+=4}}if(P>=0){const L=t.slice(P,P+4),O=e(L);if(O){const D=Math.floor(P/4/m),W=P/4-D*m;return{...O,pickedColor:L,pickedX:h+W,pickedY:l+D}}hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return i7}function o7({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const a=t.slice(r,r+4),h=a.join(",");if(!n.has(h)){const l=e(a);l?n.set(h,{...l,color:a}):hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function G3({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:a}){let h=e[0];e.length>1&&(h=l7((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let l;if(h){const m=[r-h.x,i-h.y];a!==void 0&&(m[2]=a),l=h.unproject(m)}return{color:null,layer:null,viewport:h,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:l,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function a7(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:a,pickedLayer:h,pickedObjectIndex:l}=e,m=h?[h]:[];if(r==="hover"){const P=n.index,A=n.layerId,L=h?h.props.id:null;if(L!==A||l!==P){if(L!==A){const O=i.find(D=>D.props.id===A);O&&m.unshift(O)}n.layerId=L,n.index=l,n.info=null}}const _=G3(t),S=new Map;return S.set(null,_),m.forEach(P=>{let A={..._};P===h&&(A.color=a,A.index=l,A.picked=!0),A=W3({layer:P,info:A,mode:r});const L=A.layer;P===h&&r==="hover"&&(n.info=A),S.set(L.id,A),r==="hover"&&L.updateAutoHighlight(A)}),S}function W3({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function l7(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class c7{constructor(e){K(this,"gl",void 0),K(this,"pickingFBO",void 0),K(this,"depthFBO",void 0),K(this,"pickLayersPass",void 0),K(this,"layerFilter",void 0),K(this,"lastPickedInfo",void 0),K(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new B3(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},a=this.lastPickedInfo.info){const h=a&&a.layer&&a.layer.id,l=a&&a.viewport&&a.viewport.id,m=h?r.find(A=>A.id===h):null,_=l&&i.find(A=>A.id===l)||i[0],S=_&&_.unproject([e-_.x,n-_.y]);return{...a,...{x:e,y:n,viewport:_,coordinate:S,layer:m}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new xi(r),xi.isSupported(r,{colorBufferFloat:!0}))){const i=new xi(r);i.attach({36064:new ha(r,{format:Nn(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:a,radius:h=0,depth:l=1,mode:m="query",unproject3D:_,onViewportActive:S,effects:P}){const A=this._getPickable(e),L=bd(this.gl);if(!A)return{result:[],emptyInfo:G3({viewports:r,x:i,y:a,pixelRatio:L})};this._resizeBuffer();const O=bb(this.gl,[i,a],!0),D=[O.x+Math.floor(O.width/2),O.y+Math.floor(O.height/2)],W=Math.round(h*L),{width:z,height:N}=this.pickingFBO,F=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceWidth:z,deviceHeight:N}),$={x:i-h,y:a-h,width:h*2+1,height:h*2+1};let Q;const te=[],ie=new Set;for(let xe=0;xe<l;xe++){let Te;if(F){const Re=this._drawAndSample({layers:A,views:n,viewports:r,onViewportActive:S,deviceRect:F,cullRect:$,effects:P,pass:"picking:".concat(m)});Te=s7({...Re,deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceRect:F})}else Te={pickedColor:null,pickedObjectIndex:-1};let _e;if(Te.pickedLayer&&_&&this.depthFBO){const{pickedColors:Re}=this._drawAndSample({layers:[Te.pickedLayer],views:n,viewports:r,onViewportActive:S,deviceRect:{x:Te.pickedX,y:Te.pickedY,width:1,height:1},cullRect:$,effects:P,pass:"picking:".concat(m,":z")},!0);Re[3]&&(_e=Re[0])}Te.pickedLayer&&xe+1<l&&(ie.add(Te.pickedLayer),Te.pickedLayer.disablePickingIndex(Te.pickedObjectIndex)),Q=a7({pickInfo:Te,lastPickedInfo:this.lastPickedInfo,mode:m,layers:A,viewports:r,x:i,y:a,z:_e,pixelRatio:L});for(const Re of Q.values())Re.layer&&te.push(Re);if(!Te.pickedColor)break}for(const xe of ie)xe.restorePickingColors();return{result:te,emptyInfo:Q.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:a,width:h=1,height:l=1,mode:m="query",maxObjects:_=null,onViewportActive:S,effects:P}){const A=this._getPickable(e);if(!A)return[];this._resizeBuffer();const L=bd(this.gl),O=bb(this.gl,[i,a],!0),D=O.x,W=O.y+O.height,z=bb(this.gl,[i+h,a+l],!0),N=z.x+z.width,F=z.y,$={x:D,y:F,width:N-D,height:W-F},Q=this._drawAndSample({layers:A,views:n,viewports:r,onViewportActive:S,deviceRect:$,cullRect:{x:i,y:a,width:h,height:l},effects:P,pass:"picking:".concat(m)}),te=o7(Q),ie=new Map,xe=Number.isFinite(_);for(let _e=0;_e<te.length;_e++){var Te;if(xe&&_&&ie.size>=_)break;const Re=te[_e];let Ne={color:Re.pickedColor,layer:null,index:Re.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:L};Ne=W3({layer:Re.pickedLayer,info:Ne,mode:m});const Ve=(Te=Ne.object)!==null&&Te!==void 0?Te:"".concat(Ne.layer.id,"[").concat(Ne.index,"]");ie.has(Ve)||ie.set(Ve,Ne)}return Array.from(ie.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:a,cullRect:h,effects:l,pass:m},_=!1){const S=_?this.depthFBO:this.pickingFBO,P={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:S,deviceRect:a,cullRect:h,effects:l,pass:m,pickZ:_,preRenderStats:{}};for(const N of l)N.useInPicking&&(P.preRenderStats[N.id]=N.preRender(this.gl,P));const{decodePickingColor:A}=this.pickLayersPass.render(P),{x:L,y:O,width:D,height:W}=a,z=new(_?Float32Array:Uint8Array)(D*W*4);return V_(S,{sourceX:L,sourceY:O,sourceWidth:D,sourceHeight:W,target:z}),{pickedColors:z,decodePickingColor:A}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:a}){const h=Math.max(0,e-r),l=Math.max(0,n-r),m=Math.min(i,e+r+1)-h,_=Math.min(a,n+r+1)-l;return m<=0||_<=0?null:{x:h,y:l,width:m,height:_}}}const u7={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let h7=class{constructor(e){K(this,"el",null),K(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,u7),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var H3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var a=["","webkit","Moz","MS","ms","o"],h=n.createElement("div"),l="function",m=Math.round,_=Math.abs,S=Date.now;function P(ee,re,we){return setTimeout(F(ee,we),re)}function A(ee,re,we){return Array.isArray(ee)?(L(ee,we[re],we),!0):!1}function L(ee,re,we){var Fe;if(ee)if(ee.forEach)ee.forEach(re,we);else if(ee.length!==i)for(Fe=0;Fe<ee.length;)re.call(we,ee[Fe],Fe,ee),Fe++;else for(Fe in ee)ee.hasOwnProperty(Fe)&&re.call(we,ee[Fe],Fe,ee)}function O(ee,re,we){var Fe="DEPRECATED METHOD: "+re+`
`+we+` AT 
`;return function(){var lt=new Error("get-stack-trace"),Ot=lt&&lt.stack?lt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Tn=e.console&&(e.console.warn||e.console.log);return Tn&&Tn.call(e.console,Fe,Ot),ee.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(re){if(re===i||re===null)throw new TypeError("Cannot convert undefined or null to object");for(var we=Object(re),Fe=1;Fe<arguments.length;Fe++){var lt=arguments[Fe];if(lt!==i&&lt!==null)for(var Ot in lt)lt.hasOwnProperty(Ot)&&(we[Ot]=lt[Ot])}return we}:D=Object.assign;var W=O(function(re,we,Fe){for(var lt=Object.keys(we),Ot=0;Ot<lt.length;)(!Fe||Fe&&re[lt[Ot]]===i)&&(re[lt[Ot]]=we[lt[Ot]]),Ot++;return re},"extend","Use `assign`."),z=O(function(re,we){return W(re,we,!0)},"merge","Use `assign`.");function N(ee,re,we){var Fe=re.prototype,lt;lt=ee.prototype=Object.create(Fe),lt.constructor=ee,lt._super=Fe,we&&D(lt,we)}function F(ee,re){return function(){return ee.apply(re,arguments)}}function $(ee,re){return typeof ee==l?ee.apply(re&&re[0]||i,re):ee}function Q(ee,re){return ee===i?re:ee}function te(ee,re,we){L(_e(re),function(Fe){ee.addEventListener(Fe,we,!1)})}function ie(ee,re,we){L(_e(re),function(Fe){ee.removeEventListener(Fe,we,!1)})}function xe(ee,re){for(;ee;){if(ee==re)return!0;ee=ee.parentNode}return!1}function Te(ee,re){return ee.indexOf(re)>-1}function _e(ee){return ee.trim().split(/\s+/g)}function Re(ee,re,we){if(ee.indexOf&&!we)return ee.indexOf(re);for(var Fe=0;Fe<ee.length;){if(we&&ee[Fe][we]==re||!we&&ee[Fe]===re)return Fe;Fe++}return-1}function Ne(ee){return Array.prototype.slice.call(ee,0)}function Ve(ee,re,we){for(var Fe=[],lt=[],Ot=0;Ot<ee.length;){var Tn=re?ee[Ot][re]:ee[Ot];Re(lt,Tn)<0&&Fe.push(ee[Ot]),lt[Ot]=Tn,Ot++}return we&&(re?Fe=Fe.sort(function(Ur,fi){return Ur[re]>fi[re]}):Fe=Fe.sort()),Fe}function je(ee,re){for(var we,Fe,lt=re[0].toUpperCase()+re.slice(1),Ot=0;Ot<a.length;){if(we=a[Ot],Fe=we?we+lt:re,Fe in ee)return Fe;Ot++}return i}var Ge=1;function Ze(){return Ge++}function Ye(ee){var re=ee.ownerDocument||ee;return re.defaultView||re.parentWindow||e}var Ce=/mobile|tablet|ip(ad|hone|od)|android/i,qe="ontouchstart"in e,st=je(e,"PointerEvent")!==i,Vt=qe&&Ce.test(navigator.userAgent),_t="touch",ht="pen",at="mouse",Qe="kinect",xt=25,Ht=1,qt=2,Et=4,ln=8,Qt=1,mn=2,Ut=4,At=8,Lt=16,yn=mn|Ut,vn=At|Lt,ut=yn|vn,cn=["x","y"],Ae=["clientX","clientY"];function Tt(ee,re){var we=this;this.manager=ee,this.callback=re,this.element=ee.element,this.target=ee.options.inputTarget,this.domHandler=function(Fe){$(ee.options.enable,[ee])&&we.handler(Fe)},this.init()}Tt.prototype={handler:function(){},init:function(){this.evEl&&te(this.element,this.evEl,this.domHandler),this.evTarget&&te(this.target,this.evTarget,this.domHandler),this.evWin&&te(Ye(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ie(this.element,this.evEl,this.domHandler),this.evTarget&&ie(this.target,this.evTarget,this.domHandler),this.evWin&&ie(Ye(this.element),this.evWin,this.domHandler)}};function bn(ee){var re,we=ee.options.inputClass;return we?re=we:st?re=Vr:Vt?re=be:qe?re=We:re=en,new re(ee,Xt)}function Xt(ee,re,we){var Fe=we.pointers.length,lt=we.changedPointers.length,Ot=re&Ht&&Fe-lt===0,Tn=re&(Et|ln)&&Fe-lt===0;we.isFirst=!!Ot,we.isFinal=!!Tn,Ot&&(ee.session={}),we.eventType=re,It(ee,we),ee.emit("hammer.input",we),ee.recognize(we),ee.session.prevInput=we}function It(ee,re){var we=ee.session,Fe=re.pointers,lt=Fe.length;we.firstInput||(we.firstInput=On(re)),lt>1&&!we.firstMultiple?we.firstMultiple=On(re):lt===1&&(we.firstMultiple=!1);var Ot=we.firstInput,Tn=we.firstMultiple,Cr=Tn?Tn.center:Ot.center,Ur=re.center=et(Fe);re.timeStamp=S(),re.deltaTime=re.timeStamp-Ot.timeStamp,re.angle=$e(Cr,Ur),re.distance=un(Cr,Ur),Mn(we,re),re.offsetDirection=yt(re.deltaX,re.deltaY);var fi=Xe(re.deltaTime,re.deltaX,re.deltaY);re.overallVelocityX=fi.x,re.overallVelocityY=fi.y,re.overallVelocity=_(fi.x)>_(fi.y)?fi.x:fi.y,re.scale=Tn?$t(Tn.pointers,Fe):1,re.rotation=Tn?ot(Tn.pointers,Fe):0,re.maxPointers=we.prevInput?re.pointers.length>we.prevInput.maxPointers?re.pointers.length:we.prevInput.maxPointers:re.pointers.length,Bn(we,re);var us=ee.element;xe(re.srcEvent.target,us)&&(us=re.srcEvent.target),re.target=us}function Mn(ee,re){var we=re.center,Fe=ee.offsetDelta||{},lt=ee.prevDelta||{},Ot=ee.prevInput||{};(re.eventType===Ht||Ot.eventType===Et)&&(lt=ee.prevDelta={x:Ot.deltaX||0,y:Ot.deltaY||0},Fe=ee.offsetDelta={x:we.x,y:we.y}),re.deltaX=lt.x+(we.x-Fe.x),re.deltaY=lt.y+(we.y-Fe.y)}function Bn(ee,re){var we=ee.lastInterval||re,Fe=re.timeStamp-we.timeStamp,lt,Ot,Tn,Cr;if(re.eventType!=ln&&(Fe>xt||we.velocity===i)){var Ur=re.deltaX-we.deltaX,fi=re.deltaY-we.deltaY,us=Xe(Fe,Ur,fi);Ot=us.x,Tn=us.y,lt=_(us.x)>_(us.y)?us.x:us.y,Cr=yt(Ur,fi),ee.lastInterval=re}else lt=we.velocity,Ot=we.velocityX,Tn=we.velocityY,Cr=we.direction;re.velocity=lt,re.velocityX=Ot,re.velocityY=Tn,re.direction=Cr}function On(ee){for(var re=[],we=0;we<ee.pointers.length;)re[we]={clientX:m(ee.pointers[we].clientX),clientY:m(ee.pointers[we].clientY)},we++;return{timeStamp:S(),pointers:re,center:et(re),deltaX:ee.deltaX,deltaY:ee.deltaY}}function et(ee){var re=ee.length;if(re===1)return{x:m(ee[0].clientX),y:m(ee[0].clientY)};for(var we=0,Fe=0,lt=0;lt<re;)we+=ee[lt].clientX,Fe+=ee[lt].clientY,lt++;return{x:m(we/re),y:m(Fe/re)}}function Xe(ee,re,we){return{x:re/ee||0,y:we/ee||0}}function yt(ee,re){return ee===re?Qt:_(ee)>=_(re)?ee<0?mn:Ut:re<0?At:Lt}function un(ee,re,we){we||(we=cn);var Fe=re[we[0]]-ee[we[0]],lt=re[we[1]]-ee[we[1]];return Math.sqrt(Fe*Fe+lt*lt)}function $e(ee,re,we){we||(we=cn);var Fe=re[we[0]]-ee[we[0]],lt=re[we[1]]-ee[we[1]];return Math.atan2(lt,Fe)*180/Math.PI}function ot(ee,re){return $e(re[1],re[0],Ae)+$e(ee[1],ee[0],Ae)}function $t(ee,re){return un(re[0],re[1],Ae)/un(ee[0],ee[1],Ae)}var wn={mousedown:Ht,mousemove:qt,mouseup:Et},pn="mousedown",nt="mousemove mouseup";function en(){this.evEl=pn,this.evWin=nt,this.pressed=!1,Tt.apply(this,arguments)}N(en,Tt,{handler:function(re){var we=wn[re.type];we&Ht&&re.button===0&&(this.pressed=!0),we&qt&&re.which!==1&&(we=Et),this.pressed&&(we&Et&&(this.pressed=!1),this.callback(this.manager,we,{pointers:[re],changedPointers:[re],pointerType:at,srcEvent:re}))}});var sn={pointerdown:Ht,pointermove:qt,pointerup:Et,pointercancel:ln,pointerout:ln},Pr={2:_t,3:ht,4:at,5:Qe},ci="pointerdown",on="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(ci="MSPointerDown",on="MSPointerMove MSPointerUp MSPointerCancel");function Vr(){this.evEl=ci,this.evWin=on,Tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(Vr,Tt,{handler:function(re){var we=this.store,Fe=!1,lt=re.type.toLowerCase().replace("ms",""),Ot=sn[lt],Tn=Pr[re.pointerType]||re.pointerType,Cr=Tn==_t,Ur=Re(we,re.pointerId,"pointerId");Ot&Ht&&(re.button===0||Cr)?Ur<0&&(we.push(re),Ur=we.length-1):Ot&(Et|ln)&&(Fe=!0),!(Ur<0)&&(we[Ur]=re,this.callback(this.manager,Ot,{pointers:we,changedPointers:[re],pointerType:Tn,srcEvent:re}),Fe&&we.splice(Ur,1))}});var he={touchstart:Ht,touchmove:qt,touchend:Et,touchcancel:ln},G="touchstart",q="touchstart touchmove touchend touchcancel";function ne(){this.evTarget=G,this.evWin=q,this.started=!1,Tt.apply(this,arguments)}N(ne,Tt,{handler:function(re){var we=he[re.type];if(we===Ht&&(this.started=!0),!!this.started){var Fe=de.call(this,re,we);we&(Et|ln)&&Fe[0].length-Fe[1].length===0&&(this.started=!1),this.callback(this.manager,we,{pointers:Fe[0],changedPointers:Fe[1],pointerType:_t,srcEvent:re})}}});function de(ee,re){var we=Ne(ee.touches),Fe=Ne(ee.changedTouches);return re&(Et|ln)&&(we=Ve(we.concat(Fe),"identifier",!0)),[we,Fe]}var pe={touchstart:Ht,touchmove:qt,touchend:Et,touchcancel:ln},Me="touchstart touchmove touchend touchcancel";function be(){this.evTarget=Me,this.targetIds={},Tt.apply(this,arguments)}N(be,Tt,{handler:function(re){var we=pe[re.type],Fe=ye.call(this,re,we);Fe&&this.callback(this.manager,we,{pointers:Fe[0],changedPointers:Fe[1],pointerType:_t,srcEvent:re})}});function ye(ee,re){var we=Ne(ee.touches),Fe=this.targetIds;if(re&(Ht|qt)&&we.length===1)return Fe[we[0].identifier]=!0,[we,we];var lt,Ot,Tn=Ne(ee.changedTouches),Cr=[],Ur=this.target;if(Ot=we.filter(function(fi){return xe(fi.target,Ur)}),re===Ht)for(lt=0;lt<Ot.length;)Fe[Ot[lt].identifier]=!0,lt++;for(lt=0;lt<Tn.length;)Fe[Tn[lt].identifier]&&Cr.push(Tn[lt]),re&(Et|ln)&&delete Fe[Tn[lt].identifier],lt++;if(Cr.length)return[Ve(Ot.concat(Cr),"identifier",!0),Cr]}var Ee=2500,Ue=25;function We(){Tt.apply(this,arguments);var ee=F(this.handler,this);this.touch=new be(this.manager,ee),this.mouse=new en(this.manager,ee),this.primaryTouch=null,this.lastTouches=[]}N(We,Tt,{handler:function(re,we,Fe){var lt=Fe.pointerType==_t,Ot=Fe.pointerType==at;if(!(Ot&&Fe.sourceCapabilities&&Fe.sourceCapabilities.firesTouchEvents)){if(lt)He.call(this,we,Fe);else if(Ot&&Kt.call(this,Fe))return;this.callback(re,we,Fe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function He(ee,re){ee&Ht?(this.primaryTouch=re.changedPointers[0].identifier,Rt.call(this,re)):ee&(Et|ln)&&Rt.call(this,re)}function Rt(ee){var re=ee.changedPointers[0];if(re.identifier===this.primaryTouch){var we={x:re.clientX,y:re.clientY};this.lastTouches.push(we);var Fe=this.lastTouches,lt=function(){var Ot=Fe.indexOf(we);Ot>-1&&Fe.splice(Ot,1)};setTimeout(lt,Ee)}}function Kt(ee){for(var re=ee.srcEvent.clientX,we=ee.srcEvent.clientY,Fe=0;Fe<this.lastTouches.length;Fe++){var lt=this.lastTouches[Fe],Ot=Math.abs(re-lt.x),Tn=Math.abs(we-lt.y);if(Ot<=Ue&&Tn<=Ue)return!0}return!1}var St=je(h.style,"touchAction"),Ft=St!==i,Pt="compute",hn="auto",In="manipulation",gn="none",dn="pan-x",tn="pan-y",_n=$i();function pr(ee,re){this.manager=ee,this.set(re)}pr.prototype={set:function(ee){ee==Pt&&(ee=this.compute()),Ft&&this.manager.element.style&&_n[ee]&&(this.manager.element.style[St]=ee),this.actions=ee.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ee=[];return L(this.manager.recognizers,function(re){$(re.options.enable,[re])&&(ee=ee.concat(re.getTouchAction()))}),Yr(ee.join(" "))},preventDefaults:function(ee){var re=ee.srcEvent,we=ee.offsetDirection;if(this.manager.session.prevented){re.preventDefault();return}var Fe=this.actions,lt=Te(Fe,gn)&&!_n[gn],Ot=Te(Fe,tn)&&!_n[tn],Tn=Te(Fe,dn)&&!_n[dn];if(lt){var Cr=ee.pointers.length===1,Ur=ee.distance<2,fi=ee.deltaTime<250;if(Cr&&Ur&&fi)return}if(!(Tn&&Ot)&&(lt||Ot&&we&yn||Tn&&we&vn))return this.preventSrc(re)},preventSrc:function(ee){this.manager.session.prevented=!0,ee.preventDefault()}};function Yr(ee){if(Te(ee,gn))return gn;var re=Te(ee,dn),we=Te(ee,tn);return re&&we?gn:re||we?re?dn:tn:Te(ee,In)?In:hn}function $i(){if(!Ft)return!1;var ee={},re=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(we){ee[we]=re?e.CSS.supports("touch-action",we):!0}),ee}var Ba=1,Kr=2,cs=4,po=8,Pn=po,Uo=16,ki=32;function ir(ee){this.options=D({},this.defaults,ee||{}),this.id=Ze(),this.manager=null,this.options.enable=Q(this.options.enable,!0),this.state=Ba,this.simultaneous={},this.requireFail=[]}ir.prototype={defaults:{},set:function(ee){return D(this.options,ee),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ee){if(A(ee,"recognizeWith",this))return this;var re=this.simultaneous;return ee=di(ee,this),re[ee.id]||(re[ee.id]=ee,ee.recognizeWith(this)),this},dropRecognizeWith:function(ee){return A(ee,"dropRecognizeWith",this)?this:(ee=di(ee,this),delete this.simultaneous[ee.id],this)},requireFailure:function(ee){if(A(ee,"requireFailure",this))return this;var re=this.requireFail;return ee=di(ee,this),Re(re,ee)===-1&&(re.push(ee),ee.requireFailure(this)),this},dropRequireFailure:function(ee){if(A(ee,"dropRequireFailure",this))return this;ee=di(ee,this);var re=Re(this.requireFail,ee);return re>-1&&this.requireFail.splice(re,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ee){return!!this.simultaneous[ee.id]},emit:function(ee){var re=this,we=this.state;function Fe(lt){re.manager.emit(lt,ee)}we<po&&Fe(re.options.event+bi(we)),Fe(re.options.event),ee.additionalEvent&&Fe(ee.additionalEvent),we>=po&&Fe(re.options.event+bi(we))},tryEmit:function(ee){if(this.canEmit())return this.emit(ee);this.state=ki},canEmit:function(){for(var ee=0;ee<this.requireFail.length;){if(!(this.requireFail[ee].state&(ki|Ba)))return!1;ee++}return!0},recognize:function(ee){var re=D({},ee);if(!$(this.options.enable,[this,re])){this.reset(),this.state=ki;return}this.state&(Pn|Uo|ki)&&(this.state=Ba),this.state=this.process(re),this.state&(Kr|cs|po|Uo)&&this.tryEmit(re)},process:function(ee){},getTouchAction:function(){},reset:function(){}};function bi(ee){return ee&Uo?"cancel":ee&po?"end":ee&cs?"move":ee&Kr?"start":""}function Bu(ee){return ee==Lt?"down":ee==At?"up":ee==mn?"left":ee==Ut?"right":""}function di(ee,re){var we=re.manager;return we?we.get(ee):ee}function Zn(){ir.apply(this,arguments)}N(Zn,ir,{defaults:{pointers:1},attrTest:function(ee){var re=this.options.pointers;return re===0||ee.pointers.length===re},process:function(ee){var re=this.state,we=ee.eventType,Fe=re&(Kr|cs),lt=this.attrTest(ee);return Fe&&(we&ln||!lt)?re|Uo:Fe||lt?we&Et?re|po:re&Kr?re|cs:Kr:ki}});function $o(){Zn.apply(this,arguments),this.pX=null,this.pY=null}N($o,Zn,{defaults:{event:"pan",threshold:10,pointers:1,direction:ut},getTouchAction:function(){var ee=this.options.direction,re=[];return ee&yn&&re.push(tn),ee&vn&&re.push(dn),re},directionTest:function(ee){var re=this.options,we=!0,Fe=ee.distance,lt=ee.direction,Ot=ee.deltaX,Tn=ee.deltaY;return lt&re.direction||(re.direction&yn?(lt=Ot===0?Qt:Ot<0?mn:Ut,we=Ot!=this.pX,Fe=Math.abs(ee.deltaX)):(lt=Tn===0?Qt:Tn<0?At:Lt,we=Tn!=this.pY,Fe=Math.abs(ee.deltaY))),ee.direction=lt,we&&Fe>re.threshold&&lt&re.direction},attrTest:function(ee){return Zn.prototype.attrTest.call(this,ee)&&(this.state&Kr||!(this.state&Kr)&&this.directionTest(ee))},emit:function(ee){this.pX=ee.deltaX,this.pY=ee.deltaY;var re=Bu(ee.direction);re&&(ee.additionalEvent=this.options.event+re),this._super.emit.call(this,ee)}});function mo(){Zn.apply(this,arguments)}N(mo,Zn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[gn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.scale-1)>this.options.threshold||this.state&Kr)},emit:function(ee){if(ee.scale!==1){var re=ee.scale<1?"in":"out";ee.additionalEvent=this.options.event+re}this._super.emit.call(this,ee)}});function Jn(){ir.apply(this,arguments),this._timer=null,this._input=null}N(Jn,ir,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hn]},process:function(ee){var re=this.options,we=ee.pointers.length===re.pointers,Fe=ee.distance<re.threshold,lt=ee.deltaTime>re.time;if(this._input=ee,!Fe||!we||ee.eventType&(Et|ln)&&!lt)this.reset();else if(ee.eventType&Ht)this.reset(),this._timer=P(function(){this.state=Pn,this.tryEmit()},re.time,this);else if(ee.eventType&Et)return Pn;return ki},reset:function(){clearTimeout(this._timer)},emit:function(ee){this.state===Pn&&(ee&&ee.eventType&Et?this.manager.emit(this.options.event+"up",ee):(this._input.timeStamp=S(),this.manager.emit(this.options.event,this._input)))}});function zn(){Zn.apply(this,arguments)}N(zn,Zn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[gn]},attrTest:function(ee){return this._super.attrTest.call(this,ee)&&(Math.abs(ee.rotation)>this.options.threshold||this.state&Kr)}});function Us(){Zn.apply(this,arguments)}N(Us,Zn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yn|vn,pointers:1},getTouchAction:function(){return $o.prototype.getTouchAction.call(this)},attrTest:function(ee){var re=this.options.direction,we;return re&(yn|vn)?we=ee.overallVelocity:re&yn?we=ee.overallVelocityX:re&vn&&(we=ee.overallVelocityY),this._super.attrTest.call(this,ee)&&re&ee.offsetDirection&&ee.distance>this.options.threshold&&ee.maxPointers==this.options.pointers&&_(we)>this.options.velocity&&ee.eventType&Et},emit:function(ee){var re=Bu(ee.offsetDirection);re&&this.manager.emit(this.options.event+re,ee),this.manager.emit(this.options.event,ee)}});function Qn(){ir.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(Qn,ir,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[In]},process:function(ee){var re=this.options,we=ee.pointers.length===re.pointers,Fe=ee.distance<re.threshold,lt=ee.deltaTime<re.time;if(this.reset(),ee.eventType&Ht&&this.count===0)return this.failTimeout();if(Fe&&lt&&we){if(ee.eventType!=Et)return this.failTimeout();var Ot=this.pTime?ee.timeStamp-this.pTime<re.interval:!0,Tn=!this.pCenter||un(this.pCenter,ee.center)<re.posThreshold;this.pTime=ee.timeStamp,this.pCenter=ee.center,!Tn||!Ot?this.count=1:this.count+=1,this._input=ee;var Cr=this.count%re.taps;if(Cr===0)return this.hasRequireFailures()?(this._timer=P(function(){this.state=Pn,this.tryEmit()},re.interval,this),Kr):Pn}return ki},failTimeout:function(){return this._timer=P(function(){this.state=ki},this.options.interval,this),ki},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Pn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Gi(ee,re){return re=re||{},re.recognizers=Q(re.recognizers,Gi.defaults.preset),new Cs(ee,re)}Gi.VERSION="2.0.7",Gi.defaults={domEvents:!1,touchAction:Pt,enable:!0,inputTarget:null,inputClass:null,preset:[[zn,{enable:!1}],[mo,{enable:!1},["rotate"]],[Us,{direction:yn}],[$o,{direction:yn},["swipe"]],[Qn],[Qn,{event:"doubletap",taps:2},["tap"]],[Jn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Wi=1,Pl=2;function Cs(ee,re){this.options=D({},Gi.defaults,re||{}),this.options.inputTarget=this.options.inputTarget||ee,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ee,this.input=bn(this),this.touchAction=new pr(this,this.options.touchAction),Mc(this,!0),L(this.options.recognizers,function(we){var Fe=this.add(new we[0](we[1]));we[2]&&Fe.recognizeWith(we[2]),we[3]&&Fe.requireFailure(we[3])},this)}Cs.prototype={set:function(ee){return D(this.options,ee),ee.touchAction&&this.touchAction.update(),ee.inputTarget&&(this.input.destroy(),this.input.target=ee.inputTarget,this.input.init()),this},stop:function(ee){this.session.stopped=ee?Pl:Wi},recognize:function(ee){var re=this.session;if(!re.stopped){this.touchAction.preventDefaults(ee);var we,Fe=this.recognizers,lt=re.curRecognizer;(!lt||lt&&lt.state&Pn)&&(lt=re.curRecognizer=null);for(var Ot=0;Ot<Fe.length;)we=Fe[Ot],re.stopped!==Pl&&(!lt||we==lt||we.canRecognizeWith(lt))?we.recognize(ee):we.reset(),!lt&&we.state&(Kr|cs|po)&&(lt=re.curRecognizer=we),Ot++}},get:function(ee){if(ee instanceof ir)return ee;for(var re=this.recognizers,we=0;we<re.length;we++)if(re[we].options.event==ee)return re[we];return null},add:function(ee){if(A(ee,"add",this))return this;var re=this.get(ee.options.event);return re&&this.remove(re),this.recognizers.push(ee),ee.manager=this,this.touchAction.update(),ee},remove:function(ee){if(A(ee,"remove",this))return this;if(ee=this.get(ee),ee){var re=this.recognizers,we=Re(re,ee);we!==-1&&(re.splice(we,1),this.touchAction.update())}return this},on:function(ee,re){if(ee!==i&&re!==i){var we=this.handlers;return L(_e(ee),function(Fe){we[Fe]=we[Fe]||[],we[Fe].push(re)}),this}},off:function(ee,re){if(ee!==i){var we=this.handlers;return L(_e(ee),function(Fe){re?we[Fe]&&we[Fe].splice(Re(we[Fe],re),1):delete we[Fe]}),this}},emit:function(ee,re){this.options.domEvents&&Lc(ee,re);var we=this.handlers[ee]&&this.handlers[ee].slice();if(!(!we||!we.length)){re.type=ee,re.preventDefault=function(){re.srcEvent.preventDefault()};for(var Fe=0;Fe<we.length;)we[Fe](re),Fe++}},destroy:function(){this.element&&Mc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Mc(ee,re){var we=ee.element;if(we.style){var Fe;L(ee.options.cssProps,function(lt,Ot){Fe=je(we.style,Ot),re?(ee.oldCssProps[Fe]=we.style[Fe],we.style[Fe]=lt):we.style[Fe]=ee.oldCssProps[Fe]||""}),re||(ee.oldCssProps={})}}function Lc(ee,re){var we=n.createEvent("Event");we.initEvent(ee,!0,!0),we.gesture=re,re.target.dispatchEvent(we)}D(Gi,{INPUT_START:Ht,INPUT_MOVE:qt,INPUT_END:Et,INPUT_CANCEL:ln,STATE_POSSIBLE:Ba,STATE_BEGAN:Kr,STATE_CHANGED:cs,STATE_ENDED:po,STATE_RECOGNIZED:Pn,STATE_CANCELLED:Uo,STATE_FAILED:ki,DIRECTION_NONE:Qt,DIRECTION_LEFT:mn,DIRECTION_RIGHT:Ut,DIRECTION_UP:At,DIRECTION_DOWN:Lt,DIRECTION_HORIZONTAL:yn,DIRECTION_VERTICAL:vn,DIRECTION_ALL:ut,Manager:Cs,Input:Tt,TouchAction:pr,TouchInput:be,MouseInput:en,PointerEventInput:Vr,TouchMouseInput:We,SingleTouchInput:ne,Recognizer:ir,AttrRecognizer:Zn,Tap:Qn,Pan:$o,Swipe:Us,Pinch:mo,Rotate:zn,Press:Jn,on:te,off:ie,each:L,merge:z,extend:W,assign:D,inherit:N,bindFn:F,prefixed:je});var Cl=typeof e<"u"?e:typeof self<"u"?self:{};Cl.Hammer=Gi,typeof i=="function"&&i.amd?i(function(){return Gi}):t.exports?t.exports=Gi:e[r]=Gi})(window,document,"Hammer")})(H3);var Wm=H3.exports;const d7=Im(Wm),wa=aM({__proto__:null,default:d7},[Wm]),q3=1,Z3=2,Tw=4,f7={mousedown:q3,mousemove:Z3,mouseup:Tw};function p7(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function m7(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(p7(i,a=>a.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function g7(t){t.prototype.handler=function(n){let r=f7[n.type];r&q3&&n.button>=0&&(this.pressed=!0),r&Z3&&n.buttons===0&&(r=Tw),this.pressed&&(r&Tw&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}m7(Wm.PointerEventInput);g7(Wm.MouseInput);const y7=Wm.Manager;let U_=class{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}};const _7=wa?[[wa.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[wa.Rotate,{enable:!1}],[wa.Pinch,{enable:!1}],[wa.Swipe,{enable:!1}],[wa.Pan,{threshold:0,enable:!1}],[wa.Press,{enable:!1}],[wa.Tap,{event:"doubletap",taps:2,enable:!1}],[wa.Tap,{event:"anytap",enable:!1}],[wa.Tap,{enable:!1}]]:null,zA={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},v7={doubletap:["tap"]},x7={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},b2={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},b7={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},DA={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},w7=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Jh=typeof window<"u"?window:global;let Ew=!1;try{const t={get passive(){return Ew=!0,!0}};Jh.addEventListener("test",null,t),Jh.removeEventListener("test",null)}catch{Ew=!1}const S7=w7.indexOf("firefox")!==-1,{WHEEL_EVENTS:T7}=b2,FA="wheel",NA=4.000244140625,E7=40,P7=.25;class C7 extends U_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;Jh.WheelEvent&&(S7&&i.deltaMode===Jh.WheelEvent.DOM_DELTA_PIXEL&&(a/=Jh.devicePixelRatio),i.deltaMode===Jh.WheelEvent.DOM_DELTA_LINE&&(a*=E7)),a!==0&&a%NA===0&&(a=Math.floor(a/NA)),i.shiftKey&&a&&(a=a*P7),this.callback({type:FA,center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(T7),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Ew?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===FA&&(this.options.enable=n)}}const{MOUSE_EVENTS:A7}=b2,BA="pointermove",jA="pointerover",VA="pointerout",UA="pointerenter",$A="pointerleave";class I7 extends U_{constructor(e,n,r){super(e,n,r),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(A7),this.events.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===BA&&(this.enableMoveEvent=n),e===jA&&(this.enableOverEvent=n),e===VA&&(this.enableOutEvent=n),e===UA&&(this.enableEnterEvent=n),e===$A&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(jA,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(VA,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(UA,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit($A,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(BA,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:k7}=b2,GA="keydown",WA="keyup";class M7 extends U_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:GA,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:WA,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(k7),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===GA&&(this.enableDownEvent=n),e===WA&&(this.enableUpEvent=n)}}const HA="contextmenu";class L7 extends U_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:HA,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===HA&&(this.options.enable=n)}}const qA=1,Pw=2,ZA=4,R7={pointerdown:qA,pointermove:Pw,pointerup:ZA,mousedown:qA,mousemove:Pw,mouseup:ZA},O7=0,z7=1,D7=2,F7=1,N7=2,B7=4;function j7(t){const e=R7[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,a=!1,h=!1;return e===Pw?(i=!!(n&F7),a=!!(n&B7),h=!!(n&N7)):(i=r===O7,a=r===z7,h=r===D7),{leftButton:i,middleButton:a,rightButton:h}}function V7(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,a=r.height/e.offsetHeight||1,h={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/a};return{center:n,offsetCenter:h}}const jb={srcElement:"root",priority:0};class U7{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,a=!1){const{handlers:h,handlersByElement:l}=this;let m=jb;typeof r=="string"||r&&r.addEventListener?m={...jb,srcElement:r}:r&&(m={...jb,...r});let _=l.get(m.srcElement);_||(_=[],l.set(m.srcElement,_));const S={type:e,handler:n,srcElement:m.srcElement,priority:m.priority};i&&(S.once=!0),a&&(S.passive=!0),h.push(S),this._active=this._active||!S.passive;let P=_.length-1;for(;P>=0&&!(_[P].priority>=S.priority);)P--;_.splice(P+1,0,S)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let a=r.length-1;a>=0;a--){const h=r[a];if(h.type===e&&h.handler===n){r.splice(a,1);const l=i.get(h.srcElement);l.splice(l.indexOf(h),1),l.length===0&&i.delete(h.srcElement)}}this._active=r.some(a=>!a.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const a=()=>{e.handled=!0},h=()=>{e.handled=!0,i=!0},l=[];for(let m=0;m<r.length;m++){const{type:_,handler:S,once:P}=r[m];if(S({...e,type:_,stopPropagation:a,stopImmediatePropagation:h}),P&&l.push(r[m]),i)break}for(let m=0;m<l.length;m++){const{type:_,handler:S}=l[m];this.remove(_,S)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...j7(e),...V7(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const $7={events:null,recognizers:null,recognizerOptions:{},Manager:y7,touchAction:"none",tabIndex:0};class G7{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:a}=i,h=x7[a.type];h&&this.manager.emit(h,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...$7,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||_7}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(zA).forEach(i=>{const a=this.manager.get(i);a&&zA[i].forEach(h=>{a.recognizeWith(h)})});for(const i in n.recognizerOptions){const a=this.manager.get(i);if(a){const h=n.recognizerOptions[i];delete h.enable,a.set(h)}}this.wheelInput=new C7(e,this._onOtherEvent,{enable:!1}),this.moveInput=new I7(e,this._onOtherEvent,{enable:!1}),this.keyInput=new M7(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new L7(e,this._onOtherEvent,{enable:!1});for(const[i,a]of this.events)a.isEmpty()||(this._toggleRecognizer(a.recognizerName,!0),this.manager.on(i,a.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const a=v7[e];a&&!this.options.recognizers&&a.forEach(h=>{const l=r.get(h);n?(l.requireFailure(e),i.dropRequireFailure(h)):l.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,a){if(typeof e!="string"){r=n;for(const S in e)this._addEventHandler(S,e[S],r,i,a);return}const{manager:h,events:l}=this,m=DA[e]||e;let _=l.get(m);_||(_=new U7(this),l.set(m,_),_.recognizerName=b7[m]||m,h&&h.on(m,_.handleEvent)),_.add(e,n,r,i,a),_.isEmpty()||this._toggleRecognizer(_.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const h in e)this._removeEventHandler(h,e[h]);return}const{events:r}=this,i=DA[e]||e,a=r.get(i);if(a&&(a.remove(e,n),a.isEmpty())){const{recognizerName:h}=a;let l=!1;for(const m of r.values())if(m.recognizerName===h&&!m.isEmpty()){l=!0;break}l||this._toggleRecognizer(h,!1)}}}function tu(){}const W7=({isDragging:t})=>t?"grabbing":"grab",X3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:tu,onResize:tu,onViewStateChange:tu,onInteractionStateChange:tu,onBeforeRender:tu,onAfterRender:tu,onLoad:tu,onError:t=>hr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:W7,getTooltip:null,debug:!1,drawPickingColors:!1};class $_{constructor(e){K(this,"props",void 0),K(this,"width",0),K(this,"height",0),K(this,"userData",{}),K(this,"canvas",null),K(this,"viewManager",null),K(this,"layerManager",null),K(this,"effectManager",null),K(this,"deckRenderer",null),K(this,"deckPicker",null),K(this,"eventManager",null),K(this,"tooltip",null),K(this,"metrics",void 0),K(this,"animationLoop",void 0),K(this,"stats",void 0),K(this,"viewState",void 0),K(this,"cursorState",void 0),K(this,"_needsRedraw",void 0),K(this,"_pickRequest",void 0),K(this,"_lastPointerDownInfo",null),K(this,"_metricsCounter",void 0),K(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),K(this,"_onEvent",n=>{const r=MC[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const a=this.layerManager.getLayers(),h=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:a,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:l}=h,m=l&&(l[r.handler]||l.props[r.handler]),_=this.props[r.handler];let S=!1;m&&(S=m.call(l,h,n)),!S&&_&&_(h,n)}),K(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...X3,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&hr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),IR()==="IE"&&hr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new XS({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Id.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,a,h,l,m;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(a=this.deckRenderer)===null||a===void 0||a.finalize(),this.deckRenderer=null,(h=this.deckPicker)===null||h===void 0||h.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(m=this.tooltip)===null||m===void 0||m.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var _;(_=this.canvas.parentElement)===null||_===void 0||_.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&hr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&hr.removed("onLayerClick","onClick")(),e.initialViewState&&!ka(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),h=this.deckRenderer.needsRedraw(e);return n=n||r||i||a||h,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ci(this.viewManager),this.viewManager.views}getViewports(e){return Ci(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ci(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),a}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ci(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const a=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=a}if(r||r===0){var i;const a=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=a}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,a=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||a!==this.height){var h,l;this.width=i,this.height=a,(h=this.viewManager)===null||h===void 0||h.setProps({width:i,height:a}),(l=this.layerManager)===null||l===void 0||l.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:a})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:a,debug:h,onError:l,onBeforeRender:m,onAfterRender:_,useDevicePixels:S}=e;return new WU({width:n,height:r,useDevicePixels:S,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:P=>ZR({...a,...P,canvas:this.canvas,debug:h,onContextLost:()=>this._onContextLost()}),onInitialize:P=>this._setGLContext(P.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:m,onAfterRender:_,onError:l})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new $3({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let a=i,h=!1;for(const l of r){var n;a=l,h=((n=l.layer)===null||n===void 0?void 0:n.onHover(l,e.event))||h}if(!h&&this.props.onHover&&this.props.onHover(a,e.event),this.props.getTooltip&&this.tooltip){const l=this.props.getTooltip(a);this.tooltip.setTooltip(l,a.x,a.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,i2(e,{enable:!0,copyState:!0})),this.tooltip=new h7(this.canvas),gl(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new S3;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new G7(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in MC)this.eventManager.on(i,this._onEvent);this.viewManager=new BG({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new NG(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new e7,this.deckRenderer=new r7(e),this.deckPicker=new c7(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;gl(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),hr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=fu.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}K($_,"defaultProps",X3);K($_,"VERSION",Y6);class Vb{constructor(e,n){K(this,"opts",void 0),K(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let a=r;if(r&&r.length!==i){a=new Float32Array(i);const h=n.elementOffset||0;for(let l=0;l<i;++l)a[l]=r[h+l]}return a}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function H7(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function y0(t){return t.stride||t.size*t.bytesPerElement}function Y3(t,e){e.offset&&hr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=y0(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,a=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:a,stride:n}}function q7(t,e){const n=Y3(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Z7{constructor(e,n,r){K(this,"gl",void 0),K(this,"id",void 0),K(this,"size",void 0),K(this,"settings",void 0),K(this,"value",void 0),K(this,"doublePrecision",void 0),K(this,"_buffer",void 0),K(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,a=i===5130;let{defaultValue:h}=n;h=Number.isFinite(h)?[h]:h||new Array(this.size).fill(0);let l;a?l=5126:!i&&n.isIndexed?l=e&&bV(e,Tr.ELEMENT_INDEX_UINT32)?5125:5123:l=i||5126;let m=H7(i||l||5126);this.doublePrecision=a,a&&n.fp64===!1&&(m=Float32Array),this.value=null,this.settings={...n,defaultType:m,defaultValue:h,logicalType:i,type:l,size:this.size,bytesPerElement:m.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ur(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*y0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Id.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,a=q7(this.getAccessor(),n||{});return r[e]=new Vb(this,a.high),r["".concat(e,"64Low")]=i?new Vb(this,a.low):new Float32Array(this.size),r}if(n){const r=Y3(this.getAccessor(),n);return{[e]:new Vb(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,a=r*i;if(n&&a&&n.length>=a){const h=new Array(i).fill(1/0),l=new Array(i).fill(-1/0);for(let m=0;m<a;)for(let _=0;_<i;_++){const S=n[m++];S<h[_]&&(h[_]=S),S>l[_]&&(l[_]=S)}e=[h,l]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ur?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let a=r.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!n.constant||!this._areValuesEqual(a,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=a}else if(r.buffer){const a=r.buffer;n.externalBuffer=a,n.constant=!1,this.value=r.value||null;const h=r.value instanceof Float64Array;i.type=r.type||a.accessor.type,i.bytesPerElement=a.accessor.BYTES_PER_ELEMENT*(h?2:1),i.stride=y0(i)}else if(r.value){this._checkExternalBuffer(r);let a=r.value;n.externalBuffer=null,n.constant=!1,this.value=a,i.bytesPerElement=a.BYTES_PER_ELEMENT,i.stride=y0(i);const{buffer:h,byteOffset:l}=this;this.doublePrecision&&a instanceof Float64Array&&(a=Fb(a,i));const m=a.byteLength+l+i.stride*2;h.byteLength<m&&h.reallocate(m),h.setAccessor(null),h.subData({data:a,offset:l}),i.type=r.type||h.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Fb(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,a=Id.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=a;const{buffer:h,byteOffset:l}=this;return h.byteLength<a.byteLength+l&&(h.reallocate(a.byteLength+l),n&&i&&h.subData({data:i instanceof Float64Array?Fb(i,this):i,offset:l})),r.allocatedValue=a,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&hr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let h=a;for(;--h>=0;)n[r+h]=i[h];return n}switch(a){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let h=a;for(;--h>=0;)n[r+h]=Number.isFinite(e[h])?e[h]:i[h]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const XA=[],YA=[];function w2(t,e=0,n=1/0){let r=XA;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(YA.length=t.length,r=YA):r=XA,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function K3(t){return t&&t[Symbol.asyncIterator]}function J3(t,e){const{size:n,stride:r,offset:i,startIndices:a,nested:h}=e,l=t.BYTES_PER_ELEMENT,m=r?r/l:n,_=i?i/l:0,S=Math.floor((t.length-_)/m);return(P,{index:A,target:L})=>{if(!a){const z=A*m+_;for(let N=0;N<n;N++)L[N]=t[z+N];return L}const O=a[A],D=a[A+1]||S;let W;if(h){W=new Array(D-O);for(let z=O;z<D;z++){const N=z*m+_;L=new Array(n);for(let F=0;F<n;F++)L[F]=t[N+F];W[z-O]=L}}else if(m===n)W=t.subarray(O*n+_,D*n+_);else{W=new t.constructor((D-O)*n);let z=0;for(let N=O;N<D;N++){const F=N*m+_;for(let $=0;$<n;$++)W[z++]=t[F+$]}}return W}}const X7=[],_0=[[0,1/0]];function Y7(t,e){if(t===_0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let a=0;a<r;a++){const h=t[a];h[1]<e[0]?(n.push(h),i=a+1):h[0]>e[1]?n.push(h):e=[Math.min(h[0],e[0]),Math.max(h[1],e[1])]}return n.splice(i,0,e),n}function Ub(t){const{source:e,target:n,start:r=0,size:i,getData:a}=t,h=t.end||n.length,l=e.length,m=h-r;if(l>m){n.set(e.subarray(0,m),r);return}if(n.set(e,r),!a)return;let _=l;for(;_<m;){const S=a(_,e);for(let P=0;P<i;P++)n[r+_]=S[P]||0,_++}}function K7({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:a}){if(!Array.isArray(a))return Ub({source:t,target:e,size:n,getData:r}),e;let h=0,l=0;const m=r&&((S,P)=>r(S+l,P)),_=Math.min(i.length,a.length);for(let S=1;S<_;S++){const P=i[S]*n,A=a[S]*n;Ub({source:t.subarray(h,P),target:e,start:l,end:A,size:n,getData:m}),h=P,l=A}return l<e.length&&Ub({source:[],target:e,start:l,size:n,getData:m}),e}const J7={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Q3(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...J7[n],...e,...t,type:n}}function eO(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function tO(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function nO(t){t.push(t.shift())}function S2(t,e){const{doublePrecision:n,settings:r,value:i,size:a}=t,h=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*a)*h}function rO({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:a=h=>h}){const h=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*h,m=n.byteOffset,_=n.startIndices,S=i&&_,P=S2(n,e),A=n.isConstant;if(!S&&r>=P)return;const L=A?n.value:n.getBuffer().getData({srcByteOffset:m});if(n.settings.normalized&&!A){const z=a;a=(N,F)=>n.normalizeConstant(z(N,F))}const O=A?(z,N)=>a(L,N):(z,N)=>a(L.subarray(z,z+l),N),D=t.getData({length:r}),W=new Float32Array(P);K7({source:D,target:W,sourceStartIndices:i,targetStartIndices:_,size:l,getData:O}),t.byteLength<W.byteLength+m&&t.reallocate(W.byteLength+m),t.subData({data:W,offset:m})}class T2 extends Z7{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:_0}),K(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(a=>e[a])]:e[n];return Q3(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=Y7(this.state.updateRanges,[r,i])}else this.state.updateRanges=_0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=X7}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==_0),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:h,noAlloc:l}}=this;let m=!0;if(h){for(const[_,S]of a)h.call(i,this,{data:n,startRow:_,endRow:S,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,S]of a){const P=Number.isFinite(_)?this.getVertexOffset(_):0,A=Number.isFinite(S)?this.getVertexOffset(S):l||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:P,endOffset:A})}this._checkAttributeArray()}else m=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),m}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const h=e;Ci(ArrayBuffer.isView(h.value),"invalid ".concat(i.accessor));const l=!!h.size&&h.size!==this.size;return r.binaryAccessor=J3(h.value,{size:h.size||this.size,stride:h.stride,offset:h.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:a,numInstances:h}){if(e.constant)return;const{settings:l,state:m,value:_,size:S,startIndices:P}=e,{accessor:A,transform:L}=l,O=m.binaryAccessor||(typeof A=="function"?A:a[A]);Ci(typeof O=="function",'accessor "'.concat(A,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:W,objectInfo:z}=w2(n,r,i);for(const N of W){z.index++;let F=O(N,z);if(L&&(F=L.call(this,F)),P){const $=(z.index<P.length-1?P[z.index+1]:h)-P[z.index];if(F&&Array.isArray(F[0])){let Q=D;for(const te of F)e._normalizeValue(te,_,Q),Q+=S}else F&&F.length>S?_.set(F,D):(e._normalizeValue(F,z.target,0),IG({target:_,source:z.target,start:D,count:$}));D+=$*S}else e._normalizeValue(F,_,D),D+=S}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class Q7{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","interpolation"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.transition=new Gm(r),this.attribute=n,this.attributeInTransition=new T2(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=tW(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:a}=this;nO(i);const h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)rO({buffer:l,...h});this.currentStartIndices=a.startIndices,this.currentLength=S2(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aFrom:i[0],aTo:eO(r,a)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let a=i/n;r&&(a=r(a)),this.transform.run({uniforms:{time:a}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const eW=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function tW(t,e){const n=tO(e.size);return new d2(t,{vs:eW,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class nW{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","spring"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"texture",void 0),K(this,"framebuffer",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Gm(r),this.attribute=n,this.attributeInTransition=new T2(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=iW(e),this.framebuffer=sW(e,this.texture),this.transform=rW(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:a}=this,h={numInstances:n,attribute:a,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)rO({buffer:l,...h});this.settings=e,this.currentStartIndices=a.startIndices,this.currentLength=S2(a,n),this.attributeInTransition.setData({buffer:i[1],value:a.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/a.size),sourceBuffers:{aTo:eO(r,a)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const h=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:h.stiffness,damping:h.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),nO(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),V_(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function rW(t,e,n){const r=tO(e.size);return new d2(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function iW(t){return new ha(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function sW(t,e){return new xi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const oW={interpolation:Q7,spring:nW};class aW{constructor(e,{id:n,timeline:r}){K(this,"id",void 0),K(this,"isSupported",void 0),K(this,"gl",void 0),K(this,"timeline",void 0),K(this,"transitions",void 0),K(this,"needsRedraw",void 0),K(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=d2.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const a=e[i],h=a.getTransitionSetting(n);h&&this._updateAttribute(i,a,h)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let a=!i||i.type!==r.type;if(a){if(!this.isSupported){hr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const h=oW[r.type];h?this.transitions[e]=new h({attribute:n,timeline:this.timeline,gl:this.gl}):(hr.error("unsupported transition type '".concat(r.type,"'"))(),a=!1)}(a||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const KA="attributeManager.invalidate",lW="attributeManager.updateStart",cW="attributeManager.updateEnd",uW="attribute.updateStart",hW="attribute.allocate",dW="attribute.updateEnd";class fW{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"attributes",void 0),K(this,"updateTriggers",void 0),K(this,"needsRedraw",void 0),K(this,"userData",void 0),K(this,"stats",void 0),K(this,"attributeTransitionManager",void 0),K(this,"mergeBoundsMemoized",$m(xG)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new aW(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);ss(KA,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(KA,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:a={},buffers:h={},context:l={}}){let m=!1;ss(lW,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const S=this.attributes[_],P=S.settings.accessor;S.startIndices=r,S.numInstances=n,a[_]&&hr.removed("props.".concat(_),"data.attributes.".concat(_))(),S.setExternalBuffer(h[_])||S.setBinaryValue(typeof P=="string"?h[P]:void 0,e.startIndices)||typeof P=="string"&&!h[P]&&S.setConstantValue(a[P])||S.needsUpdate()&&(m=!0,this._updateAttribute({attribute:S,numInstances:n,data:e,props:a,context:l})),this.needsRedraw=this.needsRedraw||S.needsRedraw()}m&&ss(cW,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const a in n){const h=n[a];h.needsRedraw(e)&&!r.hasAttribute(a)&&(i[a]=h)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new T2(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,a=i[e];return a&&a.forEach(h=>{const l=r[h];l&&l.setNeedsUpdate(l.id,n)}),a}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(ss(uW,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&ss(hW,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(dW,n,r))}}class pW extends Gm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:a}}=this,h=a(e/i);this._value=pm(n,r,h)}}const JA=1e-5;function QA(t,e,n,r,i){const a=e-t,l=(n-e)*i,m=-a*r;return l+m+a+e}function mW(t,e,n,r,i){if(Array.isArray(n)){const a=[];for(let h=0;h<n.length;h++)a[h]=QA(t[h],e[h],n[h],r,i);return a}return QA(t,e,n,r,i)}function eI(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class gW extends Gm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:h=e}=this;let l=mW(a,h,n,r,i);const m=eI(l,n),_=eI(l,h);m<JA&&_<JA&&(l=n,this.end()),this._prevValue=h,this._currValue=l}}const yW={interpolation:pW,spring:gW};class _W{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:a}=this;if(a.has(e)){const m=a.get(e),{value:_=m.settings.fromValue}=m;n=_,this.remove(e)}if(i=Q3(i),!i)return;const h=yW[i.type];if(!h){hr.error("unsupported transition type '".concat(i.type,"'"))();return}const l=new h(this.timeline);l.start({...i,fromValue:n,toValue:r}),a.set(e,l)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function vW(t){const e=t[xc];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function xW(t,e){const n=iO({newProps:t,oldProps:e,propTypes:t[xc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=wW(t,e);let i=!1;return r||(i=SW(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:TW(t,e),transitionsChanged:bW(t,e)}}function bW(t,e){if(!t.transitions)return!1;const n={},r=t[xc];let i=!1;for(const a in t.transitions){const h=r[a],l=h&&h.type;(l==="number"||l==="color"||l==="array")&&Cw(t[a],e[a],h)&&(n[a]=!0,i=!0)}return i?n:!1}function iO({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const a of Object.keys(t))if(!(a in n)){if(!(a in e))return"".concat(i,".").concat(a," added");const h=Cw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}for(const a of Object.keys(e))if(!(a in n)){if(!(a in t))return"".concat(i,".").concat(a," dropped");if(!Object.hasOwnProperty.call(t,a)){const h=Cw(t[a],e[a],r[a]);if(h)return"".concat(i,".").concat(a," ").concat(h)}}return!1}function Cw(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function wW(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function SW(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&tI(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&tI(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function TW(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function tI(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},iO({oldProps:i,newProps:r,triggerName:n})}const EW="count(): argument not an object",PW="count(): argument not a container";function CW(t){if(!IW(t))throw new Error(EW);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(AW(t))return Object.keys(t).length;throw new Error(PW)}function AW(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function IW(t){return t!==null&&typeof t=="object"}function kW(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const MW={10241:9987,10240:9729,10242:33071,10243:33071},Aw={};function LW(t,e,n,r){if(n instanceof ha)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const a=new ha(e,{...n,parameters:{...MW,...i,...r}});return Aw[a.id]=t,a}function RW(t,e){!e||!(e instanceof ha)||Aw[e.id]===t&&(e.delete(),delete Aw[e.id])}const OW={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Iw(t)&&(t.length===3||t.length===4)},equal(t,e,n){return ka(t,e,1)}},accessor:{validate(t,e){const n=l_(t);return n==="function"||n===l_(e.value)},equal(t,e,n){return typeof e=="function"?!0:ka(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Iw(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ka(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ka(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:LW(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{RW(n.id,t)}}};function zW(t){const e={},n={},r={};for(const[i,a]of Object.entries(t)){const h=a==null?void 0:a.deprecatedFor;if(h)r[i]=Array.isArray(h)?h:[h];else{const l=DW(i,a);e[i]=l,n[i]=l.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function DW(t,e){switch(l_(e)){case"object":return hp(t,e);case"array":return hp(t,{type:"array",value:e,compare:!1});case"boolean":return hp(t,{type:"boolean",value:e});case"number":return hp(t,{type:"number",value:e});case"function":return hp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function hp(t,e){return"type"in e?{name:t,...OW[e.type],...e}:"value"in e?{name:t,type:l_(e.value),...e}:{name:t,type:"object",value:e}}function Iw(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function l_(t){return Iw(t)?"array":t===null?"null":typeof t}function FW(t,e){let n;for(let a=e.length-1;a>=0;a--){const h=e[a];"extensions"in h&&(n=h.extensions)}const r=kw(t.constructor,n),i=Object.create(r);i[a_]=t,i[Au]={},i[ac]={};for(let a=0;a<e.length;++a){const h=e[a];for(const l in h)i[l]=h[l]}return Object.freeze(i),i}const NW="_mergedDefaultProps";function kw(t,e){let n=NW;if(e)for(const i of e){const a=i.constructor;a&&(n+=":".concat(a.extensionName||a.name))}const r=sO(t,n);return r||(t[n]=BW(t,e||[]))}function BW(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=kw(r),a=sO(t,"defaultProps")||{},h=zW(a),l=Object.assign(Object.create(null),i,h.defaultProps),m=Object.assign(Object.create(null),i==null?void 0:i[xc],h.propTypes),_=Object.assign(Object.create(null),i==null?void 0:i[Bb],h.deprecatedProps);for(const S of e){const P=kw(S.constructor);P&&(Object.assign(l,P),Object.assign(m,P[xc]),Object.assign(_,P[Bb]))}return jW(l,t),UW(l,m),VW(l,_),l[xc]=m,l[Bb]=_,e.length===0&&!E2(t,"_propTypes")&&(t._propTypes=m),l}function jW(t,e){const n=GW(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function VW(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const a of e[n])E2(this,a)||(this[a]=r);hr.deprecated(i,e[n].join("/"))()}})}function UW(t,e){const n={},r={};for(const i in e){const a=e[i],{name:h,value:l}=a;a.async&&(n[h]=l,r[h]=$W(h))}t[cd]=n,t[Au]={},Object.defineProperties(t,r)}function $W(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||K3(e)?this[Au][t]=e:this[ac][t]=e},get(){if(this[ac]){if(t in this[ac])return this[ac][t]||this[cd][t];if(t in this[Au]){const e=this[a_]&&this[a_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[cd][t]}}return this[cd][t]}}}function E2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function sO(t,e){return E2(t,e)&&t[e]}function GW(t){const e=t.componentName;return e||hr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let WW=0;class P2{constructor(...e){K(this,"id",void 0),K(this,"props",void 0),K(this,"count",void 0),this.props=FW(this,e),this.id=this.props.id,this.count=WW++}clone(e){const{props:n}=this,r={};for(const i in n[cd])i in n[ac]?r[i]=n[ac][i]:i in n[Au]&&(r[i]=n[Au][i]);return new this.constructor({...n,...r,...e})}}K(P2,"componentName","Component");K(P2,"defaultProps",{});const HW=Object.freeze({});class qW{constructor(e){K(this,"component",void 0),K(this,"onAsyncPropUpdated",void 0),K(this,"asyncProps",void 0),K(this,"oldProps",void 0),K(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||HW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[a_]||this.component;const n=e[ac]||{},r=e[Au]||e,i=e[cd]||{};for(const a in n){const h=n[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h),n[a]=this.getAsyncProp(a)}for(const a in r){const h=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,h)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(K3(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(a=>{this.component&&(a=this._postProcessValue(r,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let a=[],h=0;for await(const l of n){if(!this.component)return;const{dataTransform:m}=this.component.props;m?a=m(l,a):a=a.concat(l),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:h,endRow:a.length}]}),h=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[xc];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class ZW extends qW{constructor({attributeManager:e,layer:n}){super(n),K(this,"attributeManager",void 0),K(this,"needsRedraw",void 0),K(this,"needsUpdate",void 0),K(this,"subLayers",void 0),K(this,"usesPickingColorCache",void 0),K(this,"hasPickingBuffer",void 0),K(this,"changeFlags",void 0),K(this,"viewport",void 0),K(this,"uniformTransitions",void 0),K(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const XW="layer.changeFlag",YW="layer.initialize",KW="layer.update",JW="layer.finalize",QW="layer.matched",nI=2**24-1,eH=Object.freeze([]),tH=$m(({oldViewport:t,viewport:e})=>t.equals(e));let Sa=new Uint8ClampedArray(0);const nH={data:{type:"data",value:eH,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:a})=>{const{resourceManager:h}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,a){var l;i={...i,fetch:{...(l=i)===null||l===void 0?void 0:l.fetch,signal:a}}}let m=h.contains(t);return!m&&!i&&(h.add({resourceId:t,data:sw(t,r),persistent:!1}),m=!0),m?h.subscribe({resourceId:t,onChange:_=>{var S;return(S=n.internalState)===null||S===void 0?void 0:S.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):sw(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Hn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Du extends P2{constructor(...e){super(...e),K(this,"internalState",null),K(this,"lifecycle",Fh.NO_STATE),K(this,"context",void 0),K(this,"state",void 0),K(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ci(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=N3(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,h]=R3(r,n.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,h]}unproject(e){return Ci(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ci(this.internalState);const r=this.internalState.viewport||this.context.viewport;return PG(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Hn.DEFAULT||e===Hn.LNGLAT||e===Hn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ci(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:CW(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=kW(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,a=this.internalState.hasPickingBuffer,h=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(a!==h){this.internalState.hasPickingBuffer=h;const{pickingColors:l,instancePickingColors:m}=n.attributes,_=l||m;_&&(h&&_.constant&&(_.constant=!1,n.invalidate(_.id)),!_.value&&!h&&(_.constant=!0,_.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var a,h;(a=this.context)===null||a===void 0||(h=a.onError)===null||h===void 0||h.call(a,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!tH({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Sa.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>nI&&hr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Sa=Id.allocate(Sa,n,{size:3,copy:!0,maxCount:Math.max(n,nI)});const i=Math.floor(Sa.length/3),a=[];for(let h=r;h<i;h++)this.encodePickingColor(h,a),Sa[h*3+0]=a[0],Sa[h*3+1]=a[1],Sa[h*3+2]=a[2]}e.value=Sa.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},a=r.getShaderAttributes(n,i);e.setAttributes(a)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,a=r||i,h=a&&n.attributes&&n.attributes[a.id];if(h&&h.value){const l=h.value,m=this.encodePickingColor(e);for(let _=0;_<n.length;_++){const S=a.getVertexOffset(_);l[S]===m[0]&&l[S+1]===m[1]&&l[S+2]===m[2]&&this._disablePickingIndex(_)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const a=i.getVertexOffset(e),h=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(h-a),offset:a})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Sa.buffer&&(r.value=Sa.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ci(!this.internalState),Ci(Number.isFinite(this.props.coordinateSystem)),ss(YW,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new ZW({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(hr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new _W(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(QW,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ss(KW,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,a=r.viewport,h=this._updateUniformTransition();i.propsInTransition=h,r.viewport=i.viewport||a,this.props=h;try{const l=this._getUpdateParams(),m=this.getModels();if(r.gl)this.updateState(l);else try{this.updateState(l)}catch{}for(const S of this.props.extensions)S.updateState.call(this,l,S);const _=this.getModels()[0]!==m[0];this._postUpdate(l,_)}finally{r.viewport=a,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ss(JW,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,a=this.context;this.props=this.internalState.propsInTransition||i;const h=this.props.opacity;n.opacity=Math.pow(h,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:l}=this.props,m=l&&l(n)||[0,0];gl(a.gl,{polygonOffset:m}),ca(a.gl,r,()=>{const _={moduleParameters:e,uniforms:n,parameters:r,context:a};for(const S of this.props.extensions)S.draw.call(this,_,S);this.draw(_)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const h=e[i],l=n[i];h&&Array.isArray(l)&&(n.dataChanged=Array.isArray(h)?l.concat(h):h,a=!0);default:n[i]||(n[i]=e[i],a=!0)}a&&ss(XW,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=xW(e,n);if(r.updateTriggersChanged)for(const a in r.updateTriggersChanged)r.updateTriggersChanged[a]&&this.invalidateAttribute(a);if(r.transitionsChanged)for(const a in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(a,n[a],e[a],(i=e.transitions)===null||i===void 0?void 0:i[a])}return this.setChangeFlags(r)}validateProps(){vW(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new fW(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:a}=this.state;a==null||a.setInstanceCount(this.getNumInstances());const{autoHighlight:h,highlightedObjectIndex:l,highlightColor:m}=r;if(n||i.autoHighlight!==h||i.highlightedObjectIndex!==l||i.highlightColor!==m){const _={};h||(_.pickingSelectedColor=null),Array.isArray(m)&&(_.pickingHighlightColor=m),(n||l!==i.highlightedObjectIndex)&&(_.pickingSelectedColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setModuleParameters(_)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}K(Du,"defaultProps",nH);K(Du,"layerName","Layer");const rH="compositeLayer.renderLayers";class oO extends Du{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:S,coordinateSystem:P,coordinateOrigin:A,wrapLongitude:L,positionFormat:O,modelMatrix:D,extensions:W,fetch:z,operation:N,_subLayerProps:F}=this.props,$={id:"",updateTriggers:{},opacity:r,pickable:i,visible:a,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:S,coordinateSystem:P,coordinateOrigin:A,wrapLongitude:L,positionFormat:O,modelMatrix:D,extensions:W,fetch:z,operation:N},Q=F&&e.id&&F[e.id],te=Q&&Q.updateTriggers,ie=e.id||"sublayer";if(Q){const xe=this.props[xc],Te=e.type?e.type._propTypes:{};for(const _e in Q){const Re=Te[_e]||xe[_e];Re&&Re.type==="accessor"&&(Q[_e]=this.getSubLayerAccessor(Q[_e]))}}Object.assign($,e,Q),$.id="".concat(this.props.id,"-").concat(ie),$.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...te};for(const xe of W){const Te=xe.getSubLayerProps.call(this,xe);Te&&Object.assign($,Te,{updateTriggers:Object.assign($.updateTriggers,Te.updateTriggers)})}return $}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const a=this.renderLayers();r=_2(a,Boolean),this.internalState.subLayers=r}ss(rH,this,i,r);for(const a of r)a.parent=this}}K(oO,"layerName","CompositeLayer");const $b={bearing:0,pitch:0,position:[0,0,0]},iH={speed:1.2,curve:1.414};class sH extends V3{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),K(this,"opts",void 0),this.opts={...iH,...e}}interpolateProps(e,n,r){const i=nG(e,n,r,this.opts);for(const a in $b)i[a]=pm(e[a]||$b[a],n[a]||$b[a],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=rG(e,n,this.opts)),r}}class aO{constructor(e){K(this,"opts",void 0),K(this,"typedArrayManager",void 0),K(this,"indexStarts",[0]),K(this,"vertexStarts",[0]),K(this,"vertexCount",0),K(this,"instanceCount",0),K(this,"attributes",void 0),K(this,"_attributeDefs",void 0),K(this,"data",void 0),K(this,"getGeometry",void 0),K(this,"geometryBuffer",void 0),K(this,"buffers",void 0),K(this,"positionSize",void 0),K(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Id,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:a,positionFormat:h,dataChanged:l,normalize:m=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=a&&a.size||(h==="XY"?2:3),this.buffers=r,this.normalize=m,a&&(Ci(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(a),m||(r.positions=a)),this.geometryBuffer=r.positions,Array.isArray(l))for(const _ of l)this._rebuildGeometry(_);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?J3(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:a,typedArrayManager:h}=this;for(const l in a)if(l in i)h.release(r[l]),r[l]=null;else{const m=a[l];m.copy=n,r[l]=h.allocate(r[l],e,m)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:a}=this,{iterable:h,objectInfo:l}=w2(i,n,r);for(const m of h){l.index++;const _=a?a(m,l):null;e(_,l.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:a,geometryBuffer:h}=this,{startRow:l=0,endRow:m=1/0}=e||{},_={};if(e||(n=[0],r=[0]),this.normalize||!h)this._forEachGeometry((P,A)=>{const L=P&&this.normalizeGeometry(P);_[A]=L,r[A+1]=r[A]+(L?this.getGeometrySize(L):0)},l,m),i=r[r.length-1];else if(r=a.startIndices,i=r[a.length]||0,ArrayBuffer.isView(h))i=i||h.length/this.positionSize;else if(h instanceof ur){const P=h.accessor.stride||this.positionSize*4;i=i||h.byteLength/P}else if(h.buffer){const P=h.stride||this.positionSize*4;i=i||h.buffer.byteLength/P}else if(h.value){const P=h.value,A=h.stride/P.BYTES_PER_ELEMENT||this.positionSize;i=i||P.length/A}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const S={};this._forEachGeometry((P,A)=>{const L=_[A]||P;S.vertexStart=r[A],S.indexStart=n[A];const O=A<r.length-1?r[A+1]:i;S.geometrySize=O-r[A],S.geometryIndex=A,this.updateGeometryAttributes(L,S)},l,m),this.vertexCount=n[n.length-1]}}const oH=typeof window<"u"?Z.useLayoutEffect:Z.useEffect,aH=oH;function c_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const lH={position:"absolute",zIndex:-1};function lO(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>lO(n,e));if(G_(t)){if(cH(t))return e.style=lH,Z.cloneElement(t,e);if(uH(t))return Z.cloneElement(t,e)}return t}function G_(t){return t&&typeof t=="object"&&"type"in t||!1}function cH(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function uH(t){const e=t.type;return e&&e.deckGLViewProps}function Mw(t){if(typeof t=="function")return Z.createElement(Md,{},t);if(Array.isArray(t))return t.map(Mw);if(G_(t)){if(t.type===Z.Fragment)return Mw(t.props.children);if(c_(t.type,Md))return t}return t}function hH({children:t,layers:e=[],views:n=null}){const r=[],i=[],a={};return Z.Children.forEach(Mw(t),h=>{if(G_(h)){const l=h.type;if(c_(l,Du)){const m=dH(l,h.props);i.push(m)}else r.push(h);if(c_(l,Md)&&l!==Md&&h.props.id){const m=new l(h.props);a[m.id]=m}}else h&&r.push(h)}),Object.keys(a).length>0&&(Array.isArray(n)?n.forEach(h=>{a[h.id]=h}):n&&(a[n.id]=n),n=Object.values(a)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function dH(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function fH({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},a=r.views[0].id;for(const h of t){let l=a,m=h;G_(h)&&c_(h.type,Md)&&(l=h.props.id||a,m=h.props.children);const _=r.getViewport(l),S=r.getViewState(l);if(_){S.padding=_.padding;const{x:P,y:A,width:L,height:O}=_;m=lO(m,{x:P,y:A,width:L,height:O,viewport:_,viewState:S}),i[l]||(i[l]={viewport:_,children:[]}),i[l].children.push(m)}}return Object.keys(i).map(h=>{const{viewport:l,children:m}=i[h],{x:_,y:S,width:P,height:A}=l,L={position:"absolute",left:_,top:S,width:P,height:A},O="view-".concat(h),D=Z.createElement("div",{key:O,id:O,style:L},...m);if(n){const W={viewport:l,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:z=>{z.viewId=h,e._onViewStateChange(z)}};return Z.createElement(n,{key:O,value:W},D)}return D})}const pH={mixBlendMode:null};function mH({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const a in n)a in pH?i[a]=n[a]:r[a]=n[a];return{containerStyle:r,canvasStyle:i}}function gH(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function cO(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function yH(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const a=r.getViewports();t.lastRenderedViewports!==a?t.forceUpdate():cO(t)}});return r}const uO=Z.forwardRef((t,e)=>{const[n,r]=Z.useState(0),a=Z.useRef({control:null,version:n,forceUpdate:()=>r(Q=>Q+1)}).current,h=Z.useRef(null),l=Z.useRef(null),m=Z.useMemo(()=>hH(t),[t.layers,t.views,t.children]);let _=!0;const S=Q=>{var te;return _&&t.viewState?(a.viewStateUpdateRequested=Q,null):(a.viewStateUpdateRequested=null,(te=t.onViewStateChange)===null||te===void 0?void 0:te.call(t,Q))},P=Q=>{if(_)a.interactionStateUpdateRequested=Q;else{var te;a.interactionStateUpdateRequested=null,(te=t.onInteractionStateChange)===null||te===void 0||te.call(t,Q)}},A=Z.useMemo(()=>{const Q={...t,style:null,width:"100%",height:"100%",parent:h.current,canvas:l.current,layers:m.layers,views:m.views,onViewStateChange:S,onInteractionStateChange:P};return delete Q._customRender,a.deck&&a.deck.setProps(Q),Q},[t]);Z.useEffect(()=>{const Q=t.Deck||$_;return a.deck=yH(a,Q,{...A,parent:h.current,canvas:l.current}),()=>{var te;return(te=a.deck)===null||te===void 0?void 0:te.finalize()}},[]),aH(()=>{cO(a);const{viewStateUpdateRequested:Q,interactionStateUpdateRequested:te}=a;Q&&S(Q),te&&P(te)}),Z.useImperativeHandle(e,()=>gH(a),[]);const L=a.deck&&a.deck.isInitialized?a.deck.getViewports():void 0,{ContextProvider:O,width:D,height:W,id:z,style:N}=t,{containerStyle:F,canvasStyle:$}=Z.useMemo(()=>mH({width:D,height:W,style:N}),[D,W,N]);if(!a.viewStateUpdateRequested&&a.lastRenderedViewports===L||a.version!==n){a.lastRenderedViewports=L,a.version=n;const Q=fH({children:m.children,deck:a.deck,ContextProvider:O}),te=Z.createElement("canvas",{key:"canvas",id:z||"deckgl-overlay",ref:l,style:$});a.control=Z.createElement("div",{id:"".concat(z||"deckgl","-wrapper"),ref:h,style:F},[te,Q])}return _=!1,a.control});uO.defaultProps=$_.defaultProps;const _H=uO,vH="modulepreload",xH=function(t){return"/RutasEnBolivia/"+t},rI={},bH=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=xH(a),a in rI)return;rI[a]=!0;const h=a.endsWith(".css"),l=h?'[rel="stylesheet"]':"";if(!!r)for(let S=i.length-1;S>=0;S--){const P=i[S];if(P.href===a&&(!h||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":vH,h||(_.as="script",_.crossOrigin=""),_.href=a,document.head.appendChild(_),h)return new Promise((S,P)=>{_.addEventListener("load",S),_.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=a,window.dispatchEvent(h),!h.defaultPrevented)throw a})},wH=Z.createContext(null);function SH(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===a}function al(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!al(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!al(t[i],e[i]))return!1;return!0}return!1}function TH(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function iI(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();al(n,r)||e.setProjection(n)}function sI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function oI(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const EH=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function aI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=e[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const h of EH)h in a&&(i[h]=a[h])}return i||r});return{...t,layers:n}}const lI={version:8,sources:{},layers:[]},cI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Gb={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},uI={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},PH=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],CH=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Ld{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const a=this.props[uI[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[cI[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const a=this.props[Gb[i.type]];a&&a(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Ld.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);i._container=n;const h=i._resizeObserver;h&&(h.disconnect(),h.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=lI}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||AH()||null,container:e,style:aI(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const S=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=S,n.gl)}const h=new this._MapClass(i);a.padding&&h.setPadding(a.padding),n.cursor&&(h.getCanvas().style.cursor=n.cursor),this._createShadowTransform(h);const l=h._render;h._render=S=>{this._inRender=!0,l.call(h,S),this._inRender=!1};const m=h._renderTaskQueue.run;h._renderTaskQueue.run=S=>{m.call(h._renderTaskQueue,S),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const _=h.fire;h.fire=this._fireEvent.bind(this,_),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),iI(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const S in cI)h.on(S,this._onPointerEvent);for(const S in Gb)h.on(S,this._onCameraEvent);for(const S in uI)h.on(S,this._onEvent);this._map=h}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Ld.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=TH(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:a,pitch:h,bearing:l}=i,m=r.isMoving();m&&(i.cameraElevationReference="sea");const _=oI(i,{...sI(r.transform),...e});if(m&&(i.cameraElevationReference="ground"),_&&n){const S=this._deferredEvents;S.move=!0,S.zoom||(S.zoom=a!==i.zoom),S.rotate||(S.rotate=l!==i.bearing),S.pitch||(S.pitch=h!==i.pitch)}return m||oI(r.transform,e),_}_updateSettings(e,n){const r=this._map;let i=!1;for(const a of PH)if(a in e&&!al(e[a],n[a])){i=!0;const h=r[`set${a[0].toUpperCase()}${a.slice(1)}`];h==null||h.call(r,e[a])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=lI,styleDiffing:i=!0}=e,a={diff:i};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(aI(r),a),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!al(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!al(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!al(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const a=this._map;let h=!1;for(const l of CH){const m=(r=e[l])!==null&&r!==void 0?r:!0,_=(i=n[l])!==null&&i!==void 0?i:!0;al(m,_)||(h=!0,m?a[l].enable(m):a[l].disable())}return h}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const a=e.type,h=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,l=this._queryRenderedFeatures(e.point),m=l.length>0;!m&&h&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,m&&!h&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,a=i.transform,h=typeof n=="string"?n:n.type;return h==="move"&&this._updateViewState(this.props,!1),h in Gb&&(typeof n=="object"&&(n.viewState=sI(a)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=a,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{iI(this._renderTransform,n),e.transform=n}}}Ld.savedMaps=[];function AH(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const IH=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function kH(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const a=e.project(r);return e.transform=i,a},unproject:r=>{const i=e.transform;e.transform=t.transform;const a=e.unproject(r);return e.transform=i,a},queryTerrainElevation:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryTerrainElevation(r,i);return e.transform=a,h},queryRenderedFeatures:(r,i)=>{const a=e.transform;e.transform=t.transform;const h=e.queryRenderedFeatures(r,i);return e.transform=a,h}};for(const r of MH(e))!(r in n)&&!IH.includes(r)&&(n[r]=e[r].bind(e));return n}function MH(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const LH=typeof document<"u"?Z.useLayoutEffect:Z.useEffect,RH=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function OH(t,e){for(const r of RH)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const W_=Z.createContext(null);function zH(t,e,n){const r=Z.useContext(wH),[i,a]=Z.useState(null),h=Z.useRef(),{current:l}=Z.useRef({mapLib:null,map:null});Z.useEffect(()=>{const S=t.mapLib;let P=!0,A;return Promise.resolve(S||n).then(L=>{if(!P)return;if(!L)throw new Error("Invalid mapLib");const O="Map"in L?L:L.default;if(!O.Map)throw new Error("Invalid mapLib");if(OH(O,t),!O.supported||O.supported(t))t.reuseMaps&&(A=Ld.reuse(t,h.current)),A||(A=new Ld(O.Map,t,h.current)),l.map=kH(A),l.mapLib=O,a(A),r==null||r.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(L=>{const{onError:O}=t;O?O({type:"error",target:null,originalEvent:null,error:L}):console.error(L)}),()=>{P=!1,A&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?A.recycle():A.destroy())}},[]),LH(()=>{i&&i.setProps(t)}),Z.useImperativeHandle(e,()=>l.map,[i]);const m=Z.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),_={height:"100%"};return Z.createElement("div",{id:t.id,ref:h,style:m},i&&Z.createElement(W_.Provider,{value:l},Z.createElement("div",{"mapboxgl-children":"",style:_},t.children)))}const DH=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Fu(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!DH.test(r)?n[r]=`${i}px`:n[r]=i}}function FH(t,e){const{map:n,mapLib:r}=Z.useContext(W_),i=Z.useRef({props:t});i.current.props=t;const a=Z.useMemo(()=>{let D=!1;Z.Children.forEach(t.children,N=>{N&&(D=!0)});const W={...t,element:D?document.createElement("div"):null},z=new r.Marker(W);return z.setLngLat([t.longitude,t.latitude]),z.getElement().addEventListener("click",N=>{var F,$;($=(F=i.current.props).onClick)===null||$===void 0||$.call(F,{type:"click",target:z,originalEvent:N})}),z.on("dragstart",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDragStart)===null||$===void 0||$.call(F,Q)}),z.on("drag",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDrag)===null||$===void 0||$.call(F,Q)}),z.on("dragend",N=>{var F,$;const Q=N;Q.lngLat=a.getLngLat(),($=(F=i.current.props).onDragEnd)===null||$===void 0||$.call(F,Q)}),z},[]);Z.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:h,latitude:l,offset:m,style:_,draggable:S=!1,popup:P=null,rotation:A=0,rotationAlignment:L="auto",pitchAlignment:O="auto"}=t;return Z.useEffect(()=>{Fu(a.getElement(),_)},[_]),Z.useImperativeHandle(e,()=>a,[]),(a.getLngLat().lng!==h||a.getLngLat().lat!==l)&&a.setLngLat([h,l]),m&&!SH(a.getOffset(),m)&&a.setOffset(m),a.isDraggable()!==S&&a.setDraggable(S),a.getRotation()!==A&&a.setRotation(A),a.getRotationAlignment()!==L&&a.setRotationAlignment(L),a.getPitchAlignment()!==O&&a.setPitchAlignment(O),a.getPopup()!==P&&a.setPopup(P),zm.createPortal(t.children,a.getElement())}Z.memo(Z.forwardRef(FH));function hI(t){return new Set(t?t.trim().split(/\s+/):[])}function NH(t,e){const{map:n,mapLib:r}=Z.useContext(W_),i=Z.useMemo(()=>document.createElement("div"),[]),a=Z.useRef({props:t});a.current.props=t;const h=Z.useMemo(()=>{const l={...t},m=new r.Popup(l);return m.setLngLat([t.longitude,t.latitude]),m.once("open",_=>{var S,P;(P=(S=a.current.props).onOpen)===null||P===void 0||P.call(S,_)}),m},[]);if(Z.useEffect(()=>{const l=m=>{var _,S;(S=(_=a.current.props).onClose)===null||S===void 0||S.call(_,m)};return h.on("close",l),h.setDOMContent(i).addTo(n.getMap()),()=>{h.off("close",l),h.isOpen()&&h.remove()}},[]),Z.useEffect(()=>{Fu(h.getElement(),t.style)},[t.style]),Z.useImperativeHandle(e,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==t.longitude||h.getLngLat().lat!==t.latitude)&&h.setLngLat([t.longitude,t.latitude]),t.offset&&!al(h.options.offset,t.offset)&&h.setOffset(t.offset),(h.options.anchor!==t.anchor||h.options.maxWidth!==t.maxWidth)&&(h.options.anchor=t.anchor,h.setMaxWidth(t.maxWidth)),h.options.className!==t.className)){const l=hI(h.options.className),m=hI(t.className);for(const _ of l)m.has(_)||h.removeClassName(_);for(const _ of m)l.has(_)||h.addClassName(_);h.options.className=t.className}return zm.createPortal(t.children,i)}Z.memo(Z.forwardRef(NH));function Hm(t,e,n,r){const i=Z.useContext(W_),a=Z.useMemo(()=>t(i),[]);return Z.useEffect(()=>{const h=r||n||e,l=typeof e=="function"&&typeof n=="function"?e:null,m=typeof n=="function"?n:typeof e=="function"?e:null,{map:_}=i;return _.hasControl(a)||(_.addControl(a,h==null?void 0:h.position),l&&l(i)),()=>{m&&m(i),_.hasControl(a)&&_.removeControl(a)}},[]),a}function BH(t){const e=Hm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Z.useEffect(()=>{Fu(e._container,t.style)},[t.style]),null}Z.memo(BH);function jH(t){const e=Hm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Z.useEffect(()=>{Fu(e._controlContainer,t.style)},[t.style]),null}Z.memo(jH);function VH(t,e){const n=Z.useRef({props:t}),r=Hm(({mapLib:i})=>{const a=new i.GeolocateControl(t),h=a._setupUI;return a._setupUI=l=>{a._container.hasChildNodes()||h(l)},a.on("geolocate",l=>{var m,_;(_=(m=n.current.props).onGeolocate)===null||_===void 0||_.call(m,l)}),a.on("error",l=>{var m,_;(_=(m=n.current.props).onError)===null||_===void 0||_.call(m,l)}),a.on("outofmaxbounds",l=>{var m,_;(_=(m=n.current.props).onOutOfMaxBounds)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationstart",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationStart)===null||_===void 0||_.call(m,l)}),a.on("trackuserlocationend",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationEnd)===null||_===void 0||_.call(m,l)}),a},{position:t.position});return n.current.props=t,Z.useImperativeHandle(e,()=>r,[]),Z.useEffect(()=>{Fu(r._container,t.style)},[t.style]),null}Z.memo(Z.forwardRef(VH));function UH(t){const e=Hm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Z.useEffect(()=>{Fu(e._container,t.style)},[t.style]),null}Z.memo(UH);function $H(t){const e=Hm(({mapLib:a})=>new a.ScaleControl(t),{position:t.position}),n=Z.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),Z.useEffect(()=>{Fu(e._container,i)},[i]),null}Z.memo($H);const GH=bH(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),WH=(()=>Z.forwardRef(function(e,n){return zH(e,n,GH)}))();var hO={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(h5,function(){var n,r,i;function a(l,m){if(!n)n=m;else if(!r)r=m;else{var _="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",S={};n(S),i=m(S),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}a(["exports"],function(l){function m(c,s,u,f){return new(u||(u=Promise))(function(g,x){function w(M){try{I(f.next(M))}catch(B){x(B)}}function T(M){try{I(f.throw(M))}catch(B){x(B)}}function I(M){var B;M.done?g(M.value):(B=M.value,B instanceof u?B:new u(function(U){U(B)})).then(w,T)}I((f=f.apply(c,s||[])).next())})}function _(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}typeof SuppressedError=="function"&&SuppressedError;var S=P;function P(c,s){this.x=c,this.y=s}P.prototype={clone:function(){return new P(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,u=c.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),u=Math.sin(c),f=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,s){var u=Math.cos(c),f=Math.sin(c),g=s.y+f*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-f*(this.y-s.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},P.convert=function(c){return c instanceof P?c:Array.isArray(c)?new P(c[0],c[1]):c};var A=_(S),L=O;function O(c,s,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=u,this.p2y=f}O.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var w=0,T=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<s));f++)c>g?w=u:T=u,u=.5*(T-w)+w;return u},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var D=_(L);let W,z;function N(){return W==null&&(W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),W}function F(){if(z==null&&(z=!1,N())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let f=0;f<5*5;f++){const g=4*f;s.fillStyle=`rgb(${g},${g+1},${g+2})`,s.fillRect(f%5,Math.floor(f/5),1,1)}const u=s.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&u[f]!==f){z=!0;break}}}return z||!1}function $(c,s,u,f){const g=new D(c,s,u,f);return function(x){return g.solve(x)}}const Q=$(.25,.1,.25,1);function te(c,s,u){return Math.min(u,Math.max(s,c))}function ie(c,s,u){const f=u-s,g=((c-s)%f+f)%f+s;return g===s?u:g}function xe(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}let Te=1;function _e(c,s,u){const f={};for(const g in c)f[g]=s.call(u||this,c[g],g,c);return f}function Re(c,s,u){const f={};for(const g in c)s.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function Ne(c){return Array.isArray(c)?c.map(Ne):typeof c=="object"&&c?_e(c,Ne):c}const Ve={};function je(c){Ve[c]||(typeof console<"u"&&console.warn(c),Ve[c]=!0)}function Ge(c,s,u){return(u.y-c.y)*(s.x-c.x)>(s.y-c.y)*(u.x-c.x)}function Ze(c){let s=0;for(let u,f,g=0,x=c.length,w=x-1;g<x;w=g++)u=c[g],f=c[w],s+=(f.x-u.x)*(u.y+f.y);return s}function Ye(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ce=null;function qe(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const st="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Vt(c,s,u,f,g){return m(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x==null?void 0:x.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const T=w.startsWith("BGR"),I=new Uint8ClampedArray(f*g*4);if(yield x.copyTo(I,function(M,B,U,H,Y){const J=4*Math.max(-B,0),ae=(Math.max(0,U)-U)*H*4+J,me=4*H,ve=Math.max(0,B),ke=Math.max(0,U);return{rect:{x:ve,y:ke,width:Math.min(M.width,B+H)-ve,height:Math.min(M.height,U+Y)-ke},layout:[{offset:ae,stride:me}]}}(c,s,u,f,g)),T)for(let M=0;M<I.length;M+=4){const B=I[M];I[M]=I[M+2],I[M+2]=B}return I}finally{x.close()}})}let _t,ht,at,Qe;const xt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const s=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(c,s=0){return this.getImageCanvasContext(c).getImageData(-s,-s,c.width+2*s,c.height+2*s)},getImageCanvasContext(c){const s=window.document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return s.width=c.width,s.height=c.height,u.drawImage(c,0,0,c.width,c.height),u},resolveURL:c=>(at||(at=document.createElement("a")),at.href=c,at.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Qe==null&&(Qe=matchMedia("(prefers-reduced-motion: reduce)")),Qe.matches)}},Ht={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class qt extends Error{constructor(s,u,f,g){super(`AJAXError: ${u} (${s}): ${f}`),this.status=s,this.statusText=u,this.url=f,this.body=g}}const Et=Ye()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,ln=c=>Ht.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))];function Qt(c,s){const u=new AbortController,f=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Et(),signal:u.signal});let g=!1,x=!1;return c.type==="json"&&f.headers.set("Accept","application/json"),x||fetch(f).then(w=>w.ok?(T=>{(c.type==="arrayBuffer"||c.type==="image"?T.arrayBuffer():c.type==="json"?T.json():T.text()).then(I=>{x||(g=!0,s(null,I,T.headers.get("Cache-Control"),T.headers.get("Expires")))}).catch(I=>{x||s(new Error(I.message))})})(w):w.blob().then(T=>s(new qt(w.status,w.statusText,c.url,T)))).catch(w=>{w.code!==20&&s(new Error(w.message))}),{cancel:()=>{x=!0,g||u.abort()}}}const mn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s);if(!Ye())return(ln(c.url)||Qt)(c,s)}if(!(/^file:/.test(u=c.url)||/^file:/.test(Et())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Qt(c,s);if(Ye()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var u;return function(f,g){const x=new XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(x.responseType="arraybuffer");for(const w in f.headers)x.setRequestHeader(w,f.headers[w]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(f.type==="json")try{w=JSON.parse(x.response)}catch(T){return g(T)}g(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else{const w=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new qt(x.status,x.statusText,f.url,w))}},x.send(f.body),{cancel:()=>x.abort()}}(c,s)},Ut=function(c,s){return mn(xe(c,{type:"arrayBuffer"}),s)};function At(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),u=window.location;return s.protocol===u.protocol&&s.host===u.host}function Lt(c,s,u){u[c]&&u[c].indexOf(s)!==-1||(u[c]=u[c]||[],u[c].push(s))}function yn(c,s,u){if(u&&u[c]){const f=u[c].indexOf(s);f!==-1&&u[c].splice(f,1)}}class vn{constructor(s,u={}){xe(this,u),this.type=s}}class ut extends vn{constructor(s,u={}){super("error",xe({error:s},u))}}class cn{on(s,u){return this._listeners=this._listeners||{},Lt(s,u,this._listeners),this}off(s,u){return yn(s,u,this._listeners),yn(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Lt(s,u,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,u){typeof s=="string"&&(s=new vn(s,u||{}));const f=s.type;if(this.listens(f)){s.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of g)T.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of x)yn(f,T,this._oneTimeListeners),T.call(this,s);const w=this._eventedParent;w&&(xe(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof ut&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Tt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bn(c,s){const u={};for(const f in c)f!=="ref"&&(u[f]=c[f]);return Tt.forEach(f=>{f in s&&(u[f]=s[f])}),u}function Xt(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let u=0;u<c.length;u++)if(!Xt(c[u],s[u]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const u in c)if(!Xt(c[u],s[u]))return!1;return!0}return c===s}const It={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Mn(c,s,u){u.push({command:It.addSource,args:[c,s[c]]})}function Bn(c,s,u){s.push({command:It.removeSource,args:[c]}),u[c]=!0}function On(c,s,u,f){Bn(c,u,f),Mn(c,s,u)}function et(c,s,u){let f;for(f in c[u])if(Object.prototype.hasOwnProperty.call(c[u],f)&&f!=="data"&&!Xt(c[u][f],s[u][f]))return!1;for(f in s[u])if(Object.prototype.hasOwnProperty.call(s[u],f)&&f!=="data"&&!Xt(c[u][f],s[u][f]))return!1;return!0}function Xe(c,s,u,f,g,x){let w;for(w in s=s||{},c=c||{})Object.prototype.hasOwnProperty.call(c,w)&&(Xt(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}));for(w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&(Xt(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}))}function yt(c){return c.id}function un(c,s){return c[s.id]=s,c}class $e{constructor(s,u,f,g){this.message=(s?`${s}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function ot(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}class $t extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class wn{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(s){return new wn(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const pn={kind:"null"},nt={kind:"number"},en={kind:"string"},sn={kind:"boolean"},Pr={kind:"color"},ci={kind:"object"},on={kind:"value"},Vr={kind:"collator"},he={kind:"formatted"},G={kind:"padding"},q={kind:"resolvedImage"},ne={kind:"variableAnchorOffsetCollection"};function de(c,s){return{kind:"array",itemType:c,N:s}}function pe(c){if(c.kind==="array"){const s=pe(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const Me=[pn,nt,en,sn,Pr,he,ci,de(on),G,q,ne];function be(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!be(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const u of Me)if(!be(u,s))return null}}return`Expected ${pe(c)} but found ${pe(s)} instead.`}function ye(c,s){return s.some(u=>u.kind===c.kind)}function Ee(c,s){return s.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}function Ue(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const We=.96422,He=.82521,Rt=4/29,Kt=6/29,St=3*Kt*Kt,Ft=Kt*Kt*Kt,Pt=Math.PI/180,hn=180/Math.PI;function In(c){return(c%=360)<0&&(c+=360),c}function gn([c,s,u,f]){let g,x;const w=tn((.2225045*(c=dn(c))+.7168786*(s=dn(s))+.0606169*(u=dn(u)))/1);c===s&&s===u?g=x=w:(g=tn((.4360747*c+.3850649*s+.1430804*u)/We),x=tn((.0139322*c+.0971045*s+.7141733*u)/He));const T=116*w-16;return[T<0?0:T,500*(g-w),200*(w-x),f]}function dn(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function tn(c){return c>Ft?Math.pow(c,1/3):c/St+Rt}function _n([c,s,u,f]){let g=(c+16)/116,x=isNaN(s)?g:g+s/500,w=isNaN(u)?g:g-u/200;return g=1*Yr(g),x=We*Yr(x),w=He*Yr(w),[pr(3.1338561*x-1.6168667*g-.4906146*w),pr(-.9787684*x+1.9161415*g+.033454*w),pr(.0719453*x-.2289914*g+1.4052427*w),f]}function pr(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function Yr(c){return c>Kt?c*c*c:St*(c-Rt)}function $i(c){return parseInt(c.padEnd(2,c),16)/255}function Ba(c,s){return Kr(s?c/100:c,0,1)}function Kr(c,s,u){return Math.min(Math.max(s,c),u)}function cs(c){return!c.some(Number.isNaN)}const po={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Pn{constructor(s,u,f,g=1,x=!0){this.r=s,this.g=u,this.b=f,this.a=g,x||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[s,u,f,g]))}static parse(s){if(s instanceof Pn)return s;if(typeof s!="string")return;const u=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=po[f];if(g){const[w,T,I]=g;return[w/255,T/255,I/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const w=f.length<6?1:2;let T=1;return[$i(f.slice(T,T+=w)),$i(f.slice(T,T+=w)),$i(f.slice(T,T+=w)),$i(f.slice(T,T+w)||"ff")]}if(f.startsWith("rgb")){const w=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[T,I,M,B,U,H,Y,J,ae,me,ve,ke]=w,Se=[B||" ",Y||" ",me].join("");if(Se==="  "||Se==="  /"||Se===",,"||Se===",,,"){const Le=[M,H,ae].join(""),ze=Le==="%%%"?100:Le===""?255:0;if(ze){const Je=[Kr(+I/ze,0,1),Kr(+U/ze,0,1),Kr(+J/ze,0,1),ve?Ba(+ve,ke):1];if(cs(Je))return Je}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,T,I,M,B,U,H,Y,J]=x,ae=[I||" ",B||" ",H].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const me=[+T,Kr(+M,0,100),Kr(+U,0,100),Y?Ba(+Y,J):1];if(cs(me))return function([ve,ke,Se,Le]){function ze(Je){const wt=(Je+ve/30)%12,Dt=ke*Math.min(Se,1-Se);return Se-Dt*Math.max(-1,Math.min(wt-3,9-wt,1))}return ve=In(ve),ke/=100,Se/=100,[ze(0),ze(8),ze(4),Le]}(me)}}}(s);return u?new Pn(...u,!1):void 0}get rgb(){const{r:s,g:u,b:f,a:g}=this,x=g||1/0;return this.overwriteGetter("rgb",[s/x,u/x,f/x,g])}get hcl(){return this.overwriteGetter("hcl",function(s){const[u,f,g,x]=gn(s),w=Math.sqrt(f*f+g*g);return[Math.round(1e4*w)?In(Math.atan2(g,f)*hn):NaN,w,u,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gn(this.rgb))}overwriteGetter(s,u){return Object.defineProperty(this,s,{value:u}),u}toString(){const[s,u,f,g]=this.rgb;return`rgba(${[s,u,f].map(x=>Math.round(255*x)).join(",")},${g})`}}Pn.black=new Pn(0,0,0,1),Pn.white=new Pn(1,1,1,1),Pn.transparent=new Pn(0,0,0,0),Pn.red=new Pn(1,0,0,1);class Uo{constructor(s,u,f){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ki{constructor(s,u,f,g,x){this.text=s,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class ir{constructor(s){this.sections=s}static fromString(s){return new ir([new ki(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof ir?s:ir.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class bi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof bi)return s;if(typeof s=="number")return new bi([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const u of s)if(typeof u!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new bi(s)}}toString(){return JSON.stringify(this.values)}}const Bu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class di{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof di)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let u=0;u<s.length;u+=2){const f=s[u],g=s[u+1];if(typeof f!="string"||!Bu.has(f)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new di(s)}}toString(){return JSON.stringify(this.values)}}class Zn{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Zn({name:s,available:!1}):null}}function $o(c,s,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,s,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,s,u,f]:[c,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function mo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Pn||c instanceof Uo||c instanceof ir||c instanceof bi||c instanceof di||c instanceof Zn)return!0;if(Array.isArray(c)){for(const s of c)if(!mo(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!mo(c[s]))return!1;return!0}return!1}function Jn(c){if(c===null)return pn;if(typeof c=="string")return en;if(typeof c=="boolean")return sn;if(typeof c=="number")return nt;if(c instanceof Pn)return Pr;if(c instanceof Uo)return Vr;if(c instanceof ir)return he;if(c instanceof bi)return G;if(c instanceof di)return ne;if(c instanceof Zn)return q;if(Array.isArray(c)){const s=c.length;let u;for(const f of c){const g=Jn(f);if(u){if(u===g)continue;u=on;break}u=g}return de(u||on,s)}return ci}function zn(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Pn||c instanceof ir||c instanceof bi||c instanceof di||c instanceof Zn?c.toString():JSON.stringify(c)}class Us{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!mo(s[1]))return u.error("invalid value");const f=s[1];let g=Jn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Us(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Qn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Gi={string:en,number:nt,boolean:sn,object:ci};class Wi{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=s[0];if(x==="array"){let T,I;if(s.length>2){const M=s[1];if(typeof M!="string"||!(M in Gi)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=Gi[M],g++}else T=on;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);I=s[2],g++}f=de(T,I)}else{if(!Gi[x])throw new Error(`Types doesn't contain name = ${x}`);f=Gi[x]}const w=[];for(;g<s.length;g++){const T=u.parse(s[g],g,on);if(!T)return null;w.push(T)}return new Wi(f,w)}evaluate(s){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(s);if(!be(this.type,Jn(f)))return f;if(u===this.args.length-1)throw new Qn(`Expected value to be of type ${pe(this.type)}, but found ${pe(Jn(f))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Pl={"to-boolean":sn,"to-color":Pr,"to-number":nt,"to-string":en};class Cs{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[0];if(!Pl[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&s.length!==2)return u.error("Expected one argument.");const g=Pl[f],x=[];for(let w=1;w<s.length;w++){const T=u.parse(s[w],w,on);if(!T)return null;x.push(T)}return new Cs(g,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let u,f;for(const g of this.args){if(u=g.evaluate(s),f=null,u instanceof Pn)return u;if(typeof u=="string"){const x=s.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:$o(u[0],u[1],u[2],u[3]),!f))return new Pn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Qn(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const f of this.args){u=f.evaluate(s);const g=bi.parse(u);if(g)return g}throw new Qn(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const f of this.args){u=f.evaluate(s);const g=di.parse(u);if(g)return g}throw new Qn(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const f of this.args){if(u=f.evaluate(s),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Qn(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return ir.fromString(zn(this.args[0].evaluate(s)));case"resolvedImage":return Zn.fromString(zn(this.args[0].evaluate(s)));default:return zn(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Mc=["Unknown","Point","LineString","Polygon"];class Lc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Mc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Pn.parse(s)),u}}class Cl{constructor(s,u,f=[],g,x=new wn,w=[]){this.registry=s,this.path=f,this.key=f.map(T=>`[${T}]`).join(""),this.scope=x,this.errors=w,this.expectedType=g,this._isConstant=u}parse(s,u,f,g,x={}){return u?this.concat(u,f,g)._parse(s,x):this._parse(s,x)}_parse(s,u){function f(g,x,w){return w==="assert"?new Wi(x,[g]):w==="coerce"?new Cs(x,[g]):g}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=s[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const T=this.expectedType,I=w.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||I.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(T.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(T.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(T,I))return null}else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"coerce");else w=f(w,T,u.typeAnnotation||"assert")}if(!(w instanceof Us)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const T=new Lc;try{w=new Us(w.type,w.evaluate(T))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,f){const g=typeof s=="number"?this.path.concat(s):this.path,x=f?this.scope.concat(f):this.scope;return new Cl(this.registry,this._isConstant,g,u||null,x,this.errors)}error(s,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new $t(f,s))}checkSubtype(s,u){const f=be(s,u);return f&&this.error(f),f}}class ee{constructor(s,u,f){this.type=Vr,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,sn);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,sn);if(!x)return null;let w=null;return f.locale&&(w=u.parse(f.locale,1,en),!w)?null:new ee(g,x,w)}evaluate(s){return new Uo(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const re=8192;function we(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Fe(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function lt(c,s){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,s.z);return[Math.round(u*g*re),Math.round(f*g*re)]}function Ot(c,s,u){const f=c[0]-s[0],g=c[1]-s[1],x=c[0]-u[0],w=c[1]-u[1];return f*w-x*g==0&&f*x<=0&&g*w<=0}function Tn(c,s){let u=!1;for(let w=0,T=s.length;w<T;w++){const I=s[w];for(let M=0,B=I.length;M<B-1;M++){if(Ot(c,I[M],I[M+1]))return!1;(g=I[M])[1]>(f=c)[1]!=(x=I[M+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function Cr(c,s){for(let u=0;u<s.length;u++)if(Tn(c,s[u]))return!0;return!1}function Ur(c,s,u,f){const g=f[0]-u[0],x=f[1]-u[1],w=(c[0]-u[0])*x-g*(c[1]-u[1]),T=(s[0]-u[0])*x-g*(s[1]-u[1]);return w>0&&T<0||w<0&&T>0}function fi(c,s,u){for(const M of u)for(let B=0;B<M.length-1;++B)if((T=[(w=M[B+1])[0]-(x=M[B])[0],w[1]-x[1]])[0]*(I=[(g=s)[0]-(f=c)[0],g[1]-f[1]])[1]-T[1]*I[0]!=0&&Ur(f,g,x,w)&&Ur(x,w,f,g))return!0;var f,g,x,w,T,I;return!1}function us(c,s){for(let u=0;u<c.length;++u)if(!Tn(c[u],s))return!1;for(let u=0;u<c.length-1;++u)if(fi(c[u],c[u+1],s))return!1;return!0}function rg(c,s){for(let u=0;u<s.length;u++)if(us(c,s[u]))return!0;return!1}function ju(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=[];for(let w=0;w<c[g].length;w++){const T=lt(c[g][w],u);we(s,T),x.push(T)}f.push(x)}return f}function ig(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=ju(c[g],s,u);f.push(x)}return f}function sg(c,s,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let x=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;x===0&&(x=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=x}we(s,c)}function Kd(c,s,u,f){const g=Math.pow(2,f.z)*re,x=[f.x*re,f.y*re],w=[];for(const T of c)for(const I of T){const M=[I.x+x[0],I.y+x[1]];sg(M,s,u,g),w.push(M)}return w}function Jd(c,s,u,f){const g=Math.pow(2,f.z)*re,x=[f.x*re,f.y*re],w=[];for(const I of c){const M=[];for(const B of I){const U=[B.x+x[0],B.y+x[1]];we(s,U),M.push(U)}w.push(M)}if(s[2]-s[0]<=g/2){(T=s)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const I of w)for(const M of I)sg(M,s,u,g)}var T;return w}class ja{constructor(s,u){this.type=sn,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(mo(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new ja(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new ja(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new ja(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=ju(f.coordinates,x,w),I=Kd(u.geometry(),g,x,w);if(!Fe(g,x))return!1;for(const M of I)if(!Tn(M,T))return!1}if(f.type==="MultiPolygon"){const T=ig(f.coordinates,x,w),I=Kd(u.geometry(),g,x,w);if(!Fe(g,x))return!1;for(const M of I)if(!Cr(M,T))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const T=ju(f.coordinates,x,w),I=Jd(u.geometry(),g,x,w);if(!Fe(g,x))return!1;for(const M of I)if(!us(M,T))return!1}if(f.type==="MultiPolygon"){const T=ig(f.coordinates,x,w),I=Jd(u.geometry(),g,x,w);if(!Fe(g,x))return!1;for(const M of I)if(!rg(M,T))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Vu{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=s[1];return u.scope.has(f)?new Vu(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class As{constructor(s,u,f,g){this.name=s,this.type=u,this._evaluate=f,this.args=g}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,u){const f=s[0],g=As.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=w.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let I=null;for(const[M,B]of T){I=new Cl(u.registry,Uu,u.path,null,u.scope);const U=[];let H=!1;for(let Y=1;Y<s.length;Y++){const J=s[Y],ae=Array.isArray(M)?M[Y-1]:M.type,me=I.parse(J,1+U.length,ae);if(!me){H=!0;break}U.push(me)}if(!H)if(Array.isArray(M)&&M.length!==U.length)I.error(`Expected ${M.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const J=Array.isArray(M)?M[Y]:M.type,ae=U[Y];I.concat(Y+1).checkSubtype(J,ae.type)}if(I.errors.length===0)return new As(f,x,B,U)}}if(T.length===1)u.errors.push(...I.errors);else{const M=(T.length?T:w).map(([U])=>{return H=U,Array.isArray(H)?`(${H.map(pe).join(", ")})`:`(${pe(H.type)}...)`;var H}).join(" | "),B=[];for(let U=1;U<s.length;U++){const H=u.parse(s[U],1+B.length);if(!H)return null;B.push(pe(H.type))}u.error(`Expected arguments of type ${M}, but found (${B.join(", ")}) instead.`)}return null}static register(s,u){As.definitions=u;for(const f in u)s[f]=As}}function Uu(c){if(c instanceof Vu)return Uu(c.boundExpression);if(c instanceof As&&c.name==="error"||c instanceof ee||c instanceof ja)return!1;const s=c instanceof Cs||c instanceof Wi;let u=!0;return c.eachChild(f=>{u=s?u&&Uu(f):u&&f instanceof Us}),!!u&&$u(c)&&Gu(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function $u(c){if(c instanceof As&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof ja)return!1;let s=!0;return c.eachChild(u=>{s&&!$u(u)&&(s=!1)}),s}function Rc(c){if(c instanceof As&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(u=>{s&&!Rc(u)&&(s=!1)}),s}function Gu(c,s){if(c instanceof As&&s.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!Gu(f,s)&&(u=!1)}),u}function Al(c,s){const u=c.length-1;let f,g,x=0,w=u,T=0;for(;x<=w;)if(T=Math.floor((x+w)/2),f=c[T],g=c[T+1],f<=s){if(T===u||s<g)return T;x=T+1}else{if(!(f>s))throw new Qn("Input is not a number.");w=T-1}return 0}class fa{constructor(s,u,f){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(s[1],1,nt);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let w=1;w<s.length;w+=2){const T=w===1?-1/0:s[w],I=s[w+1],M=w,B=w+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const U=u.parse(I,B,x);if(!U)return null;x=x||U.type,g.push([T,U])}return new fa(x,f,g)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(s):f[Al(u,g)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Ln(c,s,u){return c+u*(s-c)}function Wu(c,s,u){return c.map((f,g)=>Ln(f,s[g],u))}const hs={number:Ln,color:function(c,s,u,f="rgb"){switch(f){case"rgb":{const[g,x,w,T]=Wu(c.rgb,s.rgb,u);return new Pn(g,x,w,T,!1)}case"hcl":{const[g,x,w,T]=c.hcl,[I,M,B,U]=s.hcl;let H,Y;if(isNaN(g)||isNaN(I))isNaN(g)?isNaN(I)?H=NaN:(H=I,w!==1&&w!==0||(Y=M)):(H=g,B!==1&&B!==0||(Y=x));else{let ke=I-g;I>g&&ke>180?ke-=360:I<g&&g-I>180&&(ke+=360),H=g+u*ke}const[J,ae,me,ve]=function([ke,Se,Le,ze]){return ke=isNaN(ke)?0:ke*Pt,_n([Le,Math.cos(ke)*Se,Math.sin(ke)*Se,ze])}([H,Y??Ln(x,M,u),Ln(w,B,u),Ln(T,U,u)]);return new Pn(J,ae,me,ve,!1)}case"lab":{const[g,x,w,T]=_n(Wu(c.lab,s.lab,u));return new Pn(g,x,w,T,!1)}}},array:Wu,padding:function(c,s,u){return new bi(Wu(c.values,s.values,u))},variableAnchorOffsetCollection:function(c,s,u){const f=c.values,g=s.values;if(f.length!==g.length)throw new Qn(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${s.toString()}`);const x=[];for(let w=0;w<f.length;w+=2){if(f[w]!==g[w])throw new Qn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${g[w]}`);x.push(f[w]);const[T,I]=f[w+1],[M,B]=g[w+1];x.push([Ln(T,M,u),Ln(I,B,u)])}return new di(x)}};class ds{constructor(s,u,f,g,x){this.type=s,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[w,T]of x)this.labels.push(w),this.outputs.push(T)}static interpolationFactor(s,u,f,g){let x=0;if(s.name==="exponential")x=Qd(u,s.base,f,g);else if(s.name==="linear")x=Qd(u,1,f,g);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new D(w[0],w[1],w[2],w[3]).solve(Qd(u,1,f,g))}return x}static parse(s,u){let[f,g,x,...w]=s;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some(B=>typeof B!="number"||B<0||B>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,nt),!x)return null;const T=[];let I=null;f==="interpolate-hcl"||f==="interpolate-lab"?I=Pr:u.expectedType&&u.expectedType.kind!=="value"&&(I=u.expectedType);for(let M=0;M<w.length;M+=2){const B=w[M],U=w[M+1],H=M+3,Y=M+4;if(typeof B!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(T.length&&T[T.length-1][0]>=B)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const J=u.parse(U,Y,I);if(!J)return null;I=I||J.type,T.push([B,J])}return Ue(I,nt)||Ue(I,Pr)||Ue(I,G)||Ue(I,ne)||Ue(I,de(nt))?new ds(I,f,g,x,T):u.error(`Type ${pe(I)} is not interpolatable.`)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(s);const w=Al(u,g),T=ds.interpolationFactor(this.interpolation,g,u[w],u[w+1]),I=f[w].evaluate(s),M=f[w+1].evaluate(s);switch(this.operator){case"interpolate":return hs[this.type.kind](I,M,T);case"interpolate-hcl":return hs.color(I,M,T,"hcl");case"interpolate-lab":return hs.color(I,M,T,"lab")}}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Qd(c,s,u,f){const g=f-u,x=c-u;return g===0?0:s===1?x/g:(Math.pow(s,x)-1)/(Math.pow(s,g)-1)}class Hu{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const T of s.slice(1)){const I=u.parse(T,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!I)return null;f=f||I.type,x.push(I)}if(!f)throw new Error("No output type");const w=g&&x.some(T=>be(g,T.type));return new Hu(w?on:f,x)}evaluate(s){let u,f=null,g=0;for(const x of this.args)if(g++,f=x.evaluate(s),f&&f instanceof Zn&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class qu{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return u.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const T=u.parse(s[x+1],x+1);if(!T)return null;f.push([w,T])}const g=u.parse(s[s.length-1],s.length-1,u.expectedType,f);return g?new qu(f,g):null}outputDefined(){return this.result.outputDefined()}}class ef{constructor(s,u,f){this.type=s,this.index=u,this.input=f}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,nt),g=u.parse(s[2],2,de(u.expectedType||on));return f&&g?new ef(g.type.itemType,f,g):null}evaluate(s){const u=this.index.evaluate(s),f=this.input.evaluate(s);if(u<0)throw new Qn(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Qn(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Qn(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class tf{constructor(s,u){this.type=sn,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,on),g=u.parse(s[2],2,on);return f&&g?ye(f.type,[sn,en,nt,pn,on])?new tf(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pe(f.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!f)return!1;if(!Ee(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${pe(Jn(u))} instead.`);if(!Ee(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${pe(Jn(f))} instead.`);return f.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Zu{constructor(s,u,f){this.type=nt,this.needle=s,this.haystack=u,this.fromIndex=f}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,on),g=u.parse(s[2],2,on);if(!f||!g)return null;if(!ye(f.type,[sn,en,nt,pn,on]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pe(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,nt);return x?new Zu(f,g,x):null}return new Zu(f,g)}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!Ee(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${pe(Jn(u))} instead.`);if(!Ee(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${pe(Jn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(s);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class nf{constructor(s,u,f,g,x,w){this.inputType=s,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=w}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},w=[];for(let M=2;M<s.length-1;M+=2){let B=s[M];const U=s[M+1];Array.isArray(B)||(B=[B]);const H=u.concat(M);if(B.length===0)return H.error("Expected at least one branch label.");for(const J of B){if(typeof J!="number"&&typeof J!="string")return H.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return H.error("Numeric branch labels must be integer values.");if(f){if(H.checkSubtype(f,Jn(J)))return null}else f=Jn(J);if(x[String(J)]!==void 0)return H.error("Branch labels must be unique.");x[String(J)]=w.length}const Y=u.parse(U,M,g);if(!Y)return null;g=g||Y.type,w.push(Y)}const T=u.parse(s[1],1,on);if(!T)return null;const I=u.parse(s[s.length-1],s.length-1,g);return I?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new nf(f,g,T,x,w,I):null}evaluate(s){const u=this.input.evaluate(s);return(Jn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class rf{constructor(s,u,f){this.type=s,this.branches=u,this.otherwise=f}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let w=1;w<s.length-1;w+=2){const T=u.parse(s[w],w,sn);if(!T)return null;const I=u.parse(s[w+1],w+1,f);if(!I)return null;g.push([T,I]),f=f||I.type}const x=u.parse(s[s.length-1],s.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new rf(f,g,x)}evaluate(s){for(const[u,f]of this.branches)if(u.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,f]of this.branches)s(u),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Xu{constructor(s,u,f,g){this.type=s,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,on),g=u.parse(s[2],2,nt);if(!f||!g)return null;if(!ye(f.type,[de(on),en,on]))return u.error(`Expected first argument to be of type array or string, but found ${pe(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,nt);return x?new Xu(f.type,f,g,x):null}return new Xu(f.type,f,g)}evaluate(s){const u=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!Ee(u,["string","array"]))throw new Qn(`Expected first argument to be of type array or string, but found ${pe(Jn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(s);return u.slice(f,g)}return u.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function og(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function ag(c,s,u,f){return f.compare(s,u)===0}function Il(c,s,u){const f=c!=="=="&&c!=="!=";return class dO{constructor(x,w,T){this.type=sn,this.lhs=x,this.rhs=w,this.collator=T,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const T=x[0];let I=w.parse(x[1],1,on);if(!I)return null;if(!og(T,I.type))return w.concat(1).error(`"${T}" comparisons are not supported for type '${pe(I.type)}'.`);let M=w.parse(x[2],2,on);if(!M)return null;if(!og(T,M.type))return w.concat(2).error(`"${T}" comparisons are not supported for type '${pe(M.type)}'.`);if(I.type.kind!==M.type.kind&&I.type.kind!=="value"&&M.type.kind!=="value")return w.error(`Cannot compare types '${pe(I.type)}' and '${pe(M.type)}'.`);f&&(I.type.kind==="value"&&M.type.kind!=="value"?I=new Wi(M.type,[I]):I.type.kind!=="value"&&M.type.kind==="value"&&(M=new Wi(I.type,[M])));let B=null;if(x.length===4){if(I.type.kind!=="string"&&M.type.kind!=="string"&&I.type.kind!=="value"&&M.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(B=w.parse(x[3],3,Vr),!B)return null}return new dO(I,M,B)}evaluate(x){const w=this.lhs.evaluate(x),T=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const I=Jn(w),M=Jn(T);if(I.kind!==M.kind||I.kind!=="string"&&I.kind!=="number")throw new Qn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const I=Jn(w),M=Jn(T);if(I.kind!=="string"||M.kind!=="string")return s(x,w,T)}return this.collator?u(x,w,T,this.collator.evaluate(x)):s(x,w,T)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Nv=Il("==",function(c,s,u){return s===u},ag),Bv=Il("!=",function(c,s,u){return s!==u},function(c,s,u,f){return!ag(0,s,u,f)}),jv=Il("<",function(c,s,u){return s<u},function(c,s,u,f){return f.compare(s,u)<0}),Vv=Il(">",function(c,s,u){return s>u},function(c,s,u,f){return f.compare(s,u)>0}),Uv=Il("<=",function(c,s,u){return s<=u},function(c,s,u,f){return f.compare(s,u)<=0}),$v=Il(">=",function(c,s,u){return s>=u},function(c,s,u,f){return f.compare(s,u)>=0});class sf{constructor(s,u,f,g,x){this.type=en,this.number=s,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const f=u.parse(s[1],1,nt);if(!f)return null;const g=s[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,en),!x))return null;let w=null;if(g.currency&&(w=u.parse(g.currency,1,en),!w))return null;let T=null;if(g["min-fraction-digits"]&&(T=u.parse(g["min-fraction-digits"],1,nt),!T))return null;let I=null;return g["max-fraction-digits"]&&(I=u.parse(g["max-fraction-digits"],1,nt),!I)?null:new sf(f,x,w,T,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Yu{constructor(s){this.type=he,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let w=1;w<=s.length-1;++w){const T=s[w];if(x&&typeof T=="object"&&!Array.isArray(T)){x=!1;let I=null;if(T["font-scale"]&&(I=u.parse(T["font-scale"],1,nt),!I))return null;let M=null;if(T["text-font"]&&(M=u.parse(T["text-font"],1,de(en)),!M))return null;let B=null;if(T["text-color"]&&(B=u.parse(T["text-color"],1,Pr),!B))return null;const U=g[g.length-1];U.scale=I,U.font=M,U.textColor=B}else{const I=u.parse(s[w],1,on);if(!I)return null;const M=I.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new Yu(g)}evaluate(s){return new ir(this.sections.map(u=>{const f=u.content.evaluate(s);return Jn(f)===q?new ki("",f,null,null,null):new ki(zn(f),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}}class of{constructor(s){this.type=q,this.input=s}static parse(s,u){if(s.length!==2)return u.error("Expected two arguments.");const f=u.parse(s[1],1,en);return f?new of(f):u.error("No image name provided.")}evaluate(s){const u=this.input.evaluate(s),f=Zn.fromString(u);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(u)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}}class af{constructor(s){this.type=nt,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=u.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${pe(f.type)} instead.`):new af(f):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Qn(`Expected value to be of type string or array, but found ${pe(Jn(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const kl={"==":Nv,"!=":Bv,">":Vv,"<":jv,">=":$v,"<=":Uv,array:Wi,at:ef,boolean:Wi,case:rf,coalesce:Hu,collator:ee,format:Yu,image:of,in:tf,"index-of":Zu,interpolate:ds,"interpolate-hcl":ds,"interpolate-lab":ds,length:af,let:qu,literal:Us,match:nf,number:Wi,"number-format":sf,object:Wi,slice:Xu,step:fa,string:Wi,"to-boolean":Cs,"to-color":Cs,"to-number":Cs,"to-string":Cs,var:Vu,within:ja};function lg(c,[s,u,f,g]){s=s.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const x=g?g.evaluate(c):1,w=$o(s,u,f,x);if(w)throw new Qn(w);return new Pn(s/255,u/255,f/255,x,!1)}function cg(c,s){return c in s}function lf(c,s){const u=s[c];return u===void 0?null:u}function Va(c){return{type:c}}function ug(c){return{result:"success",value:c}}function pa(c){return{result:"error",value:c}}function Ml(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function hg(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function cf(c){return!!c.expression&&c.expression.interpolated}function jn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function mr(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Gv(c){return c}function Rn(c,s){const u=s.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),x=c.type||(cf(s)?"exponential":"interval");if(u||s.type==="padding"){const B=u?Pn.parse:bi.parse;(c=ot({},c)).stops&&(c.stops=c.stops.map(U=>[U[0],B(U[1])])),c.default=B(c.default?c.default:s.default)}if(c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;let T,I,M;if(x==="exponential")T=Oc;else if(x==="interval")T=dr;else if(x==="categorical"){T=gr,I=Object.create(null);for(const B of c.stops)I[B[0]]=B[1];M=typeof c.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);T=dg}if(f){const B={},U=[];for(let J=0;J<c.stops.length;J++){const ae=c.stops[J],me=ae[0].zoom;B[me]===void 0&&(B[me]={zoom:me,type:c.type,property:c.property,default:c.default,stops:[]},U.push(me)),B[me].stops.push([ae[0].value,ae[1]])}const H=[];for(const J of U)H.push([B[J].zoom,Rn(B[J],s)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:ds.interpolationFactor.bind(void 0,Y),zoomStops:H.map(J=>J[0]),evaluate:({zoom:J},ae)=>Oc({stops:H,base:c.base},s,J).evaluate(J,ae)}}if(g){const B=x==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:ds.interpolationFactor.bind(void 0,B),zoomStops:c.stops.map(U=>U[0]),evaluate:({zoom:U})=>T(c,s,U,I,M)}}return{kind:"source",evaluate(B,U){const H=U&&U.properties?U.properties[c.property]:void 0;return H===void 0?Ua(c.default,s.default):T(c,s,H,I,M)}}}function Ua(c,s,u){return c!==void 0?c:s!==void 0?s:u!==void 0?u:void 0}function gr(c,s,u,f,g){return Ua(typeof u===g?f[u]:void 0,c.default,s.default)}function dr(c,s,u){if(jn(u)!=="number")return Ua(c.default,s.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Al(c.stops.map(x=>x[0]),u);return c.stops[g][1]}function Oc(c,s,u){const f=c.base!==void 0?c.base:1;if(jn(u)!=="number")return Ua(c.default,s.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const x=Al(c.stops.map(B=>B[0]),u),w=function(B,U,H,Y){const J=Y-H,ae=B-H;return J===0?0:U===1?ae/J:(Math.pow(U,ae)-1)/(Math.pow(U,J)-1)}(u,f,c.stops[x][0],c.stops[x+1][0]),T=c.stops[x][1],I=c.stops[x+1][1],M=hs[s.type]||Gv;return typeof T.evaluate=="function"?{evaluate(...B){const U=T.evaluate.apply(void 0,B),H=I.evaluate.apply(void 0,B);if(U!==void 0&&H!==void 0)return M(U,H,w,c.colorSpace)}}:M(T,I,w,c.colorSpace)}function dg(c,s,u){switch(s.type){case"color":u=Pn.parse(u);break;case"formatted":u=ir.fromString(u.toString());break;case"resolvedImage":u=Zn.fromString(u.toString());break;case"padding":u=bi.parse(u);break;default:jn(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0)}return Ua(u,c.default,s.default)}As.register(kl,{error:[{kind:"error"},[en],(c,[s])=>{throw new Qn(s.evaluate(c))}],typeof:[en,[on],(c,[s])=>pe(Jn(s.evaluate(c)))],"to-rgba":[de(nt,4),[Pr],(c,[s])=>{const[u,f,g,x]=s.evaluate(c).rgb;return[255*u,255*f,255*g,x]}],rgb:[Pr,[nt,nt,nt],lg],rgba:[Pr,[nt,nt,nt,nt],lg],has:{type:sn,overloads:[[[en],(c,[s])=>cg(s.evaluate(c),c.properties())],[[en,ci],(c,[s,u])=>cg(s.evaluate(c),u.evaluate(c))]]},get:{type:on,overloads:[[[en],(c,[s])=>lf(s.evaluate(c),c.properties())],[[en,ci],(c,[s,u])=>lf(s.evaluate(c),u.evaluate(c))]]},"feature-state":[on,[en],(c,[s])=>lf(s.evaluate(c),c.featureState||{})],properties:[ci,[],c=>c.properties()],"geometry-type":[en,[],c=>c.geometryType()],id:[on,[],c=>c.id()],zoom:[nt,[],c=>c.globals.zoom],"heatmap-density":[nt,[],c=>c.globals.heatmapDensity||0],"line-progress":[nt,[],c=>c.globals.lineProgress||0],accumulated:[on,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[nt,Va(nt),(c,s)=>{let u=0;for(const f of s)u+=f.evaluate(c);return u}],"*":[nt,Va(nt),(c,s)=>{let u=1;for(const f of s)u*=f.evaluate(c);return u}],"-":{type:nt,overloads:[[[nt,nt],(c,[s,u])=>s.evaluate(c)-u.evaluate(c)],[[nt],(c,[s])=>-s.evaluate(c)]]},"/":[nt,[nt,nt],(c,[s,u])=>s.evaluate(c)/u.evaluate(c)],"%":[nt,[nt,nt],(c,[s,u])=>s.evaluate(c)%u.evaluate(c)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(c,[s,u])=>Math.pow(s.evaluate(c),u.evaluate(c))],sqrt:[nt,[nt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))],log2:[nt,[nt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[nt,[nt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[nt,[nt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[nt,[nt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[nt,[nt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[nt,[nt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[nt,[nt],(c,[s])=>Math.atan(s.evaluate(c))],min:[nt,Va(nt),(c,s)=>Math.min(...s.map(u=>u.evaluate(c)))],max:[nt,Va(nt),(c,s)=>Math.max(...s.map(u=>u.evaluate(c)))],abs:[nt,[nt],(c,[s])=>Math.abs(s.evaluate(c))],round:[nt,[nt],(c,[s])=>{const u=s.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[nt,[nt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[nt,[nt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[sn,[en,on],(c,[s,u])=>c.properties()[s.value]===u.value],"filter-id-==":[sn,[on],(c,[s])=>c.id()===s.value],"filter-type-==":[sn,[en],(c,[s])=>c.geometryType()===s.value],"filter-<":[sn,[en,on],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[sn,[on],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<f}],"filter->":[sn,[en,on],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[sn,[on],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>f}],"filter-<=":[sn,[en,on],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[sn,[on],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<=f}],"filter->=":[sn,[en,on],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[sn,[on],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>=f}],"filter-has":[sn,[on],(c,[s])=>s.value in c.properties()],"filter-has-id":[sn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[sn,[de(en)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[sn,[de(on)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[sn,[en,de(on)],(c,[s,u])=>u.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[sn,[en,de(on)],(c,[s,u])=>function(f,g,x,w){for(;x<=w;){const T=x+w>>1;if(g[T]===f)return!0;g[T]>f?w=T-1:x=T+1}return!1}(c.properties()[s.value],u.value,0,u.value.length-1)],all:{type:sn,overloads:[[[sn,sn],(c,[s,u])=>s.evaluate(c)&&u.evaluate(c)],[Va(sn),(c,s)=>{for(const u of s)if(!u.evaluate(c))return!1;return!0}]]},any:{type:sn,overloads:[[[sn,sn],(c,[s,u])=>s.evaluate(c)||u.evaluate(c)],[Va(sn),(c,s)=>{for(const u of s)if(u.evaluate(c))return!0;return!1}]]},"!":[sn,[sn],(c,[s])=>!s.evaluate(c)],"is-supported-script":[sn,[en],(c,[s])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(s.evaluate(c))}],upcase:[en,[en],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[en,[en],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[en,Va(on),(c,s)=>s.map(u=>zn(u.evaluate(c))).join("")],"resolved-locale":[en,[Vr],(c,[s])=>s.evaluate(c).resolvedLocale()]});class uf{constructor(s,u){var f;this.expression=s,this._warningHistory={},this._evaluator=new Lc,this._defaultValue=u?(f=u).type==="color"&&mr(f.default)?new Pn(0,0,0,0):f.type==="color"?Pn.parse(f.default)||null:f.type==="padding"?bi.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?di.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,u,f,g,x,w){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Ku(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in kl}function Ju(c,s){const u=new Cl(kl,Uu,[],s?function(g){const x={color:Pr,string:en,number:nt,enum:en,boolean:sn,formatted:he,padding:G,resolvedImage:q,variableAnchorOffsetCollection:ne};return g.type==="array"?de(x[g.value]||on,g.length):x[g.type]}(s):void 0),f=u.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?ug(new uf(f,s)):pa(u.errors)}class hf{constructor(s,u){this.kind=s,this._styleExpression=u,this.isStateDependent=s!=="constant"&&!Rc(u.expression)}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}}class Qu{constructor(s,u,f,g){this.kind=s,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!Rc(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}interpolationFactor(s,u,f){return this.interpolationType?ds.interpolationFactor(this.interpolationType,s,u,f):0}}function df(c,s){const u=Ju(c,s);if(u.result==="error")return u;const f=u.value.expression,g=$u(f);if(!g&&!Ml(s))return pa([new $t("","data expressions not supported")]);const x=Gu(f,["zoom"]);if(!x&&!hg(s))return pa([new $t("","zoom expressions not supported")]);const w=Dc(f);return w||x?w instanceof $t?pa([w]):w instanceof ds&&!cf(s)?pa([new $t("",'"interpolate" expressions cannot be used with this property')]):ug(w?new Qu(g?"camera":"composite",u.value,w.labels,w instanceof ds?w.interpolation:void 0):new hf(g?"constant":"source",u.value)):pa([new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class zc{constructor(s,u){this._parameters=s,this._specification=u,ot(this,Rn(this._parameters,this._specification))}static deserialize(s){return new zc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Dc(c){let s=null;if(c instanceof qu)s=Dc(c.result);else if(c instanceof Hu){for(const u of c.args)if(s=Dc(u),s)break}else(c instanceof fa||c instanceof ds)&&c.input instanceof As&&c.input.name==="zoom"&&(s=c);return s instanceof $t||c.eachChild(u=>{const f=Dc(u);f instanceof $t?s=f:!s&&f?s=new $t("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new $t("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function Fc(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!Fc(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const Wv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ff(c){if(c==null)return{filter:()=>!0,needGeometry:!1};Fc(c)||(c=eh(c));const s=Ju(c,Wv);if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,f,g)=>s.value.evaluate(u,f,{},g),needGeometry:fg(c)}}function Hv(c,s){return c<s?-1:c>s?1:0}function fg(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(fg(c[s]))return!0;return!1}function eh(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?pf(c[1],c[2],"=="):s==="!="?Nc(pf(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?pf(c[1],c[2],s):s==="any"?(u=c.slice(1),["any"].concat(u.map(eh))):s==="all"?["all"].concat(c.slice(1).map(eh)):s==="none"?["all"].concat(c.slice(1).map(eh).map(Nc)):s==="in"?pg(c[1],c.slice(2)):s==="!in"?Nc(pg(c[1],c.slice(2))):s==="has"?mg(c[1]):s==="!has"?Nc(mg(c[1])):s!=="within"||c;var u}function pf(c,s,u){switch(c){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,c,s]}}function pg(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",c,["literal",s.sort(Hv)]]:["filter-in-small",c,["literal",s]]}}function mg(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Nc(c){return["!",c]}function th(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let g="[";for(const x of c)g+=`${th(x)},`;return`${g}]`}const u=Object.keys(c).sort();let f="{";for(let g=0;g<u.length;g++)f+=`${JSON.stringify(u[g])}:${th(c[u[g]])},`;return`${f}}`}function nh(c){let s="";for(const u of Tt)s+=`/${th(c[u])}`;return s}function gg(c){const s=c.value;return s?[new $e(c.key,s,"constants have been deprecated as of v8")]:[]}function xr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function $a(c){if(Array.isArray(c))return c.map($a);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const u in c)s[u]=$a(c[u]);return s}return xr(c)}function Hi(c){const s=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},x=c.style,w=c.styleSpec,T=c.validateSpec;let I=[];const M=jn(u);if(M!=="object")return[new $e(s,u,`object expected, ${M} found`)];for(const B in u){const U=B.split(".")[0],H=f[U]||f["*"];let Y;if(g[U])Y=g[U];else if(f[U])Y=T;else if(g["*"])Y=g["*"];else{if(!f["*"]){I.push(new $e(s,u[B],`unknown property "${B}"`));continue}Y=T}I=I.concat(Y({key:(s&&`${s}.`)+B,value:u[B],valueSpec:H,style:x,styleSpec:w,object:u,objectKey:B,validateSpec:T},u))}for(const B in f)g[B]||f[B].required&&f[B].default===void 0&&u[B]===void 0&&I.push(new $e(s,u,`missing required property "${B}"`));return I}function Ll(c){const s=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if(jn(s)!=="array")return[new $e(x,s,`array expected, ${jn(s)} found`)];if(u.length&&s.length!==u.length)return[new $e(x,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new $e(x,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let T={type:u.value,values:u.values};g.$version<7&&(T.function=u.function),jn(u.value)==="object"&&(T=u.value);let I=[];for(let M=0;M<s.length;M++)I=I.concat(w({array:s,arrayIndex:M,value:s[M],valueSpec:T,validateSpec:c.validateSpec,style:f,styleSpec:g,key:`${x}[${M}]`}));return I}function Bc(c){const s=c.key,u=c.value,f=c.valueSpec;let g=jn(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new $e(s,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new $e(s,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new $e(s,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function rh(c){const s=c.valueSpec,u=xr(c.value.type);let f,g,x,w={};const T=u!=="categorical"&&c.value.property===void 0,I=!T,M=jn(c.value.stops)==="array"&&jn(c.value.stops[0])==="array"&&jn(c.value.stops[0][0])==="object",B=Hi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new $e(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const ae=Y.value;return J=J.concat(Ll({key:Y.key,value:ae,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:U})),jn(ae)==="array"&&ae.length===0&&J.push(new $e(Y.key,ae,"array must have at least one stop")),J},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&T&&B.push(new $e(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||B.push(new $e(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!cf(c.valueSpec)&&B.push(new $e(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Ml(c.valueSpec)?B.push(new $e(c.key,c.value,"property functions not supported")):T&&!hg(c.valueSpec)&&B.push(new $e(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!M||c.value.property!==void 0||B.push(new $e(c.key,c.value,'"property" property is required')),B;function U(Y){let J=[];const ae=Y.value,me=Y.key;if(jn(ae)!=="array")return[new $e(me,ae,`array expected, ${jn(ae)} found`)];if(ae.length!==2)return[new $e(me,ae,`array length 2 expected, length ${ae.length} found`)];if(M){if(jn(ae[0])!=="object")return[new $e(me,ae,`object expected, ${jn(ae[0])} found`)];if(ae[0].zoom===void 0)return[new $e(me,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new $e(me,ae,"object stop key must have value")];if(x&&x>xr(ae[0].zoom))return[new $e(me,ae[0].zoom,"stop zoom values must appear in ascending order")];xr(ae[0].zoom)!==x&&(x=xr(ae[0].zoom),g=void 0,w={}),J=J.concat(Hi({key:`${me}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Bc,value:H}}))}else J=J.concat(H({key:`${me}[0]`,value:ae[0],valueSpec:{},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},ae));return Ku($a(ae[1]))?J.concat([new $e(`${me}[1]`,ae[1],"expressions are not allowed in function stops.")]):J.concat(Y.validateSpec({key:`${me}[1]`,value:ae[1],valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function H(Y,J){const ae=jn(Y.value),me=xr(Y.value),ve=Y.value!==null?Y.value:J;if(f){if(ae!==f)return[new $e(Y.key,ve,`${ae} stop domain type must match previous stop domain type ${f}`)]}else f=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new $e(Y.key,ve,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&u!=="categorical"){let ke=`number expected, ${ae} found`;return Ml(s)&&u===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(Y.key,ve,ke)]}return u!=="categorical"||ae!=="number"||isFinite(me)&&Math.floor(me)===me?u!=="categorical"&&ae==="number"&&g!==void 0&&me<g?[new $e(Y.key,ve,"stop domain values must appear in ascending order")]:(g=me,u==="categorical"&&me in w?[new $e(Y.key,ve,"stop domain values must be unique")]:(w[me]=!0,[])):[new $e(Y.key,ve,`integer expected, found ${me}`)]}}function Ga(c){const s=(c.expressionContext==="property"?df:Ju)($a(c.value),c.valueSpec);if(s.result==="error")return s.value.map(f=>new $e(`${c.key}${f.key}`,c.value,f.message));const u=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new $e(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Rc(u))return[new $e(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!Rc(u))return[new $e(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Gu(u,["zoom","feature-state"]))return[new $e(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!$u(u))return[new $e(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function jc(c){const s=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(xr(u))===-1&&g.push(new $e(s,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(xr(u))===-1&&g.push(new $e(s,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function Rl(c){return Fc($a(c.value))?Ga(ot({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yg(c)}function yg(c){const s=c.value,u=c.key;if(jn(s)!=="array")return[new $e(u,s,`array expected, ${jn(s)} found`)];const f=c.styleSpec;let g,x=[];if(s.length<1)return[new $e(u,s,"filter array must have at least 1 element")];switch(x=x.concat(jc({key:`${u}[0]`,value:s[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),xr(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&xr(s[1])==="$type"&&x.push(new $e(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new $e(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(g=jn(s[1]),g!=="string"&&x.push(new $e(`${u}[1]`,s[1],`string expected, ${g} found`)));for(let w=2;w<s.length;w++)g=jn(s[w]),xr(s[1])==="$type"?x=x.concat(jc({key:`${u}[${w}]`,value:s[w],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new $e(`${u}[${w}]`,s[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(yg({key:`${u}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=jn(s[1]),s.length!==2?x.push(new $e(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new $e(`${u}[1]`,s[1],`string expected, ${g} found`));break;case"within":g=jn(s[1]),s.length!==2?x.push(new $e(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new $e(`${u}[1]`,s[1],`object expected, ${g} found`))}return x}function _g(c,s){const u=c.key,f=c.validateSpec,g=c.style,x=c.styleSpec,w=c.value,T=c.objectKey,I=x[`${s}_${c.layerType}`];if(!I)return[];const M=T.match(/^(.*)-transition$/);if(s==="paint"&&M&&I[M[1]]&&I[M[1]].transition)return f({key:u,value:w,valueSpec:x.transition,style:g,styleSpec:x});const B=c.valueSpec||I[T];if(!B)return[new $e(u,w,`unknown property "${T}"`)];let U;if(jn(w)==="string"&&Ml(B)&&!B.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new $e(u,w,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const H=[];return c.layerType==="symbol"&&(T==="text-field"&&g&&!g.glyphs&&H.push(new $e(u,w,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&mr($a(w))&&xr(w.type)==="identity"&&H.push(new $e(u,w,'"text-font" does not support identity functions'))),H.concat(f({key:c.key,value:w,valueSpec:B,style:g,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:T}))}function vg(c){return _g(c,"paint")}function xg(c){return _g(c,"layout")}function bg(c){let s=[];const u=c.value,f=c.key,g=c.style,x=c.styleSpec;u.type||u.ref||s.push(new $e(f,u,'either "type" or "ref" is required'));let w=xr(u.type);const T=xr(u.ref);if(u.id){const I=xr(u.id);for(let M=0;M<c.arrayIndex;M++){const B=g.layers[M];xr(B.id)===I&&s.push(new $e(f,u.id,`duplicate layer id "${u.id}", previously used at line ${B.id.__line__}`))}}if("ref"in u){let I;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&s.push(new $e(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{xr(M.id)===T&&(I=M)}),I?I.ref?s.push(new $e(f,u.ref,"ref cannot reference another ref layer")):w=xr(I.type):s.push(new $e(f,u.ref,`ref layer "${T}" not found`))}else if(w!=="background")if(u.source){const I=g.sources&&g.sources[u.source],M=I&&xr(I.type);I?M==="vector"&&w==="raster"?s.push(new $e(f,u.source,`layer "${u.id}" requires a raster source`)):M!=="raster-dem"&&w==="hillshade"?s.push(new $e(f,u.source,`layer "${u.id}" requires a raster-dem source`)):M==="raster"&&w!=="raster"?s.push(new $e(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&w!=="hillshade"?s.push(new $e(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!u.paint||!u.paint["line-gradient"]||M==="geojson"&&I.lineMetrics||s.push(new $e(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new $e(f,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new $e(f,u.source,`source "${u.source}" not found`))}else s.push(new $e(f,u,'missing required property "source"'));return s=s.concat(Hi({key:f,value:u,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:u,objectKey:"type"}),filter:Rl,layout:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>xg(ot({layerType:w},M))}}),paint:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":M=>vg(ot({layerType:w},M))}})}})),s}function go(c){const s=c.value,u=c.key,f=jn(s);return f!=="string"?[new $e(u,s,`string expected, ${f} found`)]:[]}const Vc={promoteId:function({key:c,value:s}){if(jn(s)==="string")return go({key:c,value:s});{const u=[];for(const f in s)u.push(...go({key:`${c}.${f}`,value:s[f]}));return u}}};function fs(c){const s=c.value,u=c.key,f=c.styleSpec,g=c.style,x=c.validateSpec;if(!s.type)return[new $e(u,s,'"type" is required')];const w=xr(s.type);let T;switch(w){case"vector":case"raster":return T=Hi({key:u,value:s,valueSpec:f[`source_${w.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:Vc,validateSpec:x}),T;case"raster-dem":return T=function(I){var M;const B=(M=I.sourceName)!==null&&M!==void 0?M:"",U=I.value,H=I.styleSpec,Y=H.source_raster_dem,J=I.style;let ae=[];const me=jn(U);if(U===void 0)return ae;if(me!=="object")return ae.push(new $e("source_raster_dem",U,`object expected, ${me} found`)),ae;const ve=xr(U.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],Se=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Le in U)!ve&&ke.includes(Le)?ae.push(new $e(Le,U[Le],`In "${B}": "${Le}" is only valid when "encoding" is set to "custom". ${Se} encoding found`)):Y[Le]?ae=ae.concat(I.validateSpec({key:Le,value:U[Le],valueSpec:Y[Le],validateSpec:I.validateSpec,style:J,styleSpec:H})):ae.push(new $e(Le,U[Le],`unknown property "${Le}"`));return ae}({sourceName:u,value:s,style:c.style,styleSpec:f,validateSpec:x}),T;case"geojson":if(T=Hi({key:u,value:s,valueSpec:f.source_geojson,style:g,styleSpec:f,validateSpec:x,objectElementValidators:Vc}),s.cluster)for(const I in s.clusterProperties){const[M,B]=s.clusterProperties[I],U=typeof M=="string"?[M,["accumulated"],["get",I]]:M;T.push(...Ga({key:`${u}.${I}.map`,value:B,validateSpec:x,expressionContext:"cluster-map"})),T.push(...Ga({key:`${u}.${I}.reduce`,value:U,validateSpec:x,expressionContext:"cluster-reduce"}))}return T;case"video":return Hi({key:u,value:s,valueSpec:f.source_video,style:g,validateSpec:x,styleSpec:f});case"image":return Hi({key:u,value:s,valueSpec:f.source_image,style:g,validateSpec:x,styleSpec:f});case"canvas":return[new $e(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return jc({key:`${u}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:x,styleSpec:f})}}function Uc(c){const s=c.value,u=c.styleSpec,f=u.light,g=c.style;let x=[];const w=jn(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new $e("light",s,`object expected, ${w} found`)]),x;for(const T in s){const I=T.match(/^(.*)-transition$/);x=x.concat(I&&f[I[1]]&&f[I[1]].transition?c.validateSpec({key:T,value:s[T],valueSpec:u.transition,validateSpec:c.validateSpec,style:g,styleSpec:u}):f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new $e(T,s[T],`unknown property "${T}"`)])}return x}function wg(c){const s=c.value,u=c.styleSpec,f=u.terrain,g=c.style;let x=[];const w=jn(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new $e("terrain",s,`object expected, ${w} found`)]),x;for(const T in s)x=x.concat(f[T]?c.validateSpec({key:T,value:s[T],valueSpec:f[T],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new $e(T,s[T],`unknown property "${T}"`)]);return x}function Sg(c){let s=[];const u=c.value,f=c.key;if(Array.isArray(u)){const g=[],x=[];for(const w in u)u[w].id&&g.includes(u[w].id)&&s.push(new $e(f,u,`all the sprites' ids must be unique, but ${u[w].id} is duplicated`)),g.push(u[w].id),u[w].url&&x.includes(u[w].url)&&s.push(new $e(f,u,`all the sprites' URLs must be unique, but ${u[w].url} is duplicated`)),x.push(u[w].url),s=s.concat(Hi({key:`${f}[${w}]`,value:u[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return go({key:f,value:u})}const Tg={"*":()=>[],array:Ll,boolean:function(c){const s=c.value,u=c.key,f=jn(s);return f!=="boolean"?[new $e(u,s,`boolean expected, ${f} found`)]:[]},number:Bc,color:function(c){const s=c.key,u=c.value,f=jn(u);return f!=="string"?[new $e(s,u,`color expected, ${f} found`)]:Pn.parse(String(u))?[]:[new $e(s,u,`color expected, "${u}" found`)]},constants:gg,enum:jc,filter:Rl,function:rh,layer:bg,object:Hi,source:fs,light:Uc,terrain:wg,string:go,formatted:function(c){return go(c).length===0?[]:Ga(c)},resolvedImage:function(c){return go(c).length===0?[]:Ga(c)},padding:function(c){const s=c.key,u=c.value;if(jn(u)==="array"){if(u.length<1||u.length>4)return[new $e(s,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let x=0;x<u.length;x++)g=g.concat(c.validateSpec({key:`${s}[${x}]`,value:u[x],validateSpec:c.validateSpec,valueSpec:f}));return g}return Bc({key:s,value:u,valueSpec:{}})},variableAnchorOffsetCollection:function(c){const s=c.key,u=c.value,f=jn(u),g=c.styleSpec;if(f!=="array"||u.length<1||u.length%2!=0)return[new $e(s,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<u.length;w+=2)x=x.concat(jc({key:`${s}[${w}]`,value:u[w],valueSpec:g.layout_symbol["text-anchor"]})),x=x.concat(Ll({key:`${s}[${w+1}]`,value:u[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:g}));return x},sprite:Sg};function Go(c){const s=c.value,u=c.valueSpec,f=c.styleSpec;return c.validateSpec=Go,u.expression&&mr(xr(s))?rh(c):u.expression&&Ku($a(s))?Ga(c):u.type&&Tg[u.type]?Tg[u.type](c):Hi(ot({},c,{valueSpec:u.type?f[u.type]:u}))}function Eg(c){const s=c.value,u=c.key,f=go(c);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new $e(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new $e(u,s,'"glyphs" url must include a "{range}" token'))),f}function Is(c,s=Ae){let u=[];return u=u.concat(Go({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:Go,objectElementValidators:{glyphs:Eg,"*":()=>[]}})),c.constants&&(u=u.concat(gg({key:"constants",value:c.constants,style:c,styleSpec:s,validateSpec:Go}))),ih(u)}function Wo(c){return function(s){return c({...s,validateSpec:Go})}}function ih(c){return[].concat(c).sort((s,u)=>s.line-u.line)}function Ho(c){return function(...s){return ih(c.apply(this,s))}}Is.source=Ho(Wo(fs)),Is.sprite=Ho(Wo(Sg)),Is.glyphs=Ho(Wo(Eg)),Is.light=Ho(Wo(Uc)),Is.terrain=Ho(Wo(wg)),Is.layer=Ho(Wo(bg)),Is.filter=Ho(Wo(Rl)),Is.paintProperty=Ho(Wo(vg)),Is.layoutProperty=Ho(Wo(xg));const qo=Is,qv=qo.light,mf=qo.paintProperty,Pg=qo.layoutProperty;function sh(c,s){let u=!1;if(s&&s.length)for(const f of s)c.fire(new ut(new Error(f.message))),u=!0;return u}class Ol{constructor(s,u,f){const g=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(u=w[1])+2*(f=w[2]);for(let I=0;I<this.d*this.d;I++){const M=w[3+I],B=w[3+I+1];g.push(M===B?null:w.subarray(M,B))}const T=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],T),this.bboxes=w.subarray(T),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=f,this.scale=u/s,this.uid=0;const x=f/u*s;this.min=-x,this.max=s+x}insert(s,u,f,g,x){this._forEachCell(u,f,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,u,f,g,x,w){this.cells[x].push(w)}query(s,u,f,g,x){const w=this.min,T=this.max;if(s<=w&&u<=w&&T<=f&&T<=g&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,u,f,g,this._queryCell,I,{},x),I}}_queryCell(s,u,f,g,x,w,T,I){const M=this.cells[x];if(M!==null){const B=this.keys,U=this.bboxes;for(let H=0;H<M.length;H++){const Y=M[H];if(T[Y]===void 0){const J=4*Y;(I?I(U[J+0],U[J+1],U[J+2],U[J+3]):s<=U[J+2]&&u<=U[J+3]&&f>=U[J+0]&&g>=U[J+1])?(T[Y]=!0,w.push(B[Y])):T[Y]=!1}}}}_forEachCell(s,u,f,g,x,w,T,I){const M=this._convertToCellCoord(s),B=this._convertToCellCoord(u),U=this._convertToCellCoord(f),H=this._convertToCellCoord(g);for(let Y=M;Y<=U;Y++)for(let J=B;J<=H;J++){const ae=this.d*J+Y;if((!I||I(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&x.call(this,s,u,f,g,ae,w,T,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,u=3+this.cells.length+1+1;let f=0;for(let w=0;w<this.cells.length;w++)f+=this.cells[w].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=u;for(let w=0;w<s.length;w++){const T=s[w];g[3+w]=x,g.set(T,x),x+=T.length}return g[3+s.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+s.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(s,u){const f=s.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(s){return new Ol(s.buffer)}}const Zo={};function kt(c,s,u={}){if(Zo[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Zo[c]={klass:s,omit:u.omit||[],shallow:u.shallow||[]}}kt("Object",Object),kt("TransferableGridIndex",Ol),kt("Color",Pn),kt("Error",Error),kt("AJAXError",qt),kt("ResolvedImage",Zn),kt("StylePropertyFunction",zc),kt("StyleExpression",uf,{omit:["_evaluator"]}),kt("ZoomDependentExpression",Qu),kt("ZoomConstantExpression",hf),kt("CompoundExpression",As,{omit:["_evaluate"]});for(const c in kl)kl[c]._classRegistryKey||kt(`Expression_${c}`,kl[c]);function oh(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function ma(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(oh(c)||qe(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return s&&s.push(u.buffer),u}if(c instanceof ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(ma(f,s));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");if(!Zo[f])throw new Error(`${f} is not registered.`);const g=u.serialize?u.serialize(c,s):{};if(u.serialize){if(s&&g===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||Zo[f].omit.indexOf(x)>=0)continue;const w=c[x];g[x]=Zo[f].shallow.indexOf(x)>=0?w:ma(w,s)}c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function zl(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||oh(c)||qe(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(zl);if(typeof c=="object"){const s=c.$name||"Object";if(!Zo[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:u}=Zo[s];if(!u)throw new Error(`can't deserialize unregistered class ${s}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c)){if(g==="$name")continue;const x=c[g];f[g]=Zo[s].shallow.indexOf(g)>=0?x:zl(x)}return f}throw new Error("can't deserialize object of type "+typeof c)}class Cg{constructor(){this.first=!0}update(s,u){const f=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=f,!0))}}const bt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function gf(c){for(const s of c)if(_f(s.charCodeAt(0)))return!0;return!1}function yf(c){for(const s of c)if(!Zv(s.charCodeAt(0)))return!1;return!0}function Zv(c){return!(bt.Arabic(c)||bt["Arabic Supplement"](c)||bt["Arabic Extended-A"](c)||bt["Arabic Presentation Forms-A"](c)||bt["Arabic Presentation Forms-B"](c))}function _f(c){return!(c!==746&&c!==747&&(c<4352||!(bt["Bopomofo Extended"](c)||bt.Bopomofo(c)||bt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||bt["CJK Compatibility Ideographs"](c)||bt["CJK Compatibility"](c)||bt["CJK Radicals Supplement"](c)||bt["CJK Strokes"](c)||!(!bt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||bt["CJK Unified Ideographs Extension A"](c)||bt["CJK Unified Ideographs"](c)||bt["Enclosed CJK Letters and Months"](c)||bt["Hangul Compatibility Jamo"](c)||bt["Hangul Jamo Extended-A"](c)||bt["Hangul Jamo Extended-B"](c)||bt["Hangul Jamo"](c)||bt["Hangul Syllables"](c)||bt.Hiragana(c)||bt["Ideographic Description Characters"](c)||bt.Kanbun(c)||bt["Kangxi Radicals"](c)||bt["Katakana Phonetic Extensions"](c)||bt.Katakana(c)&&c!==12540||!(!bt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!bt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||bt["Unified Canadian Aboriginal Syllabics"](c)||bt["Unified Canadian Aboriginal Syllabics Extended"](c)||bt["Vertical Forms"](c)||bt["Yijing Hexagram Symbols"](c)||bt["Yi Syllables"](c)||bt["Yi Radicals"](c))))}function Ag(c){return!(_f(c)||function(s){return!!(bt["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||bt["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||bt["Letterlike Symbols"](s)||bt["Number Forms"](s)||bt["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||bt["Control Pictures"](s)&&s!==9251||bt["Optical Character Recognition"](s)||bt["Enclosed Alphanumerics"](s)||bt["Geometric Shapes"](s)||bt["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||bt["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||bt["CJK Symbols and Punctuation"](s)||bt.Katakana(s)||bt["Private Use Area"](s)||bt["CJK Compatibility Forms"](s)||bt["Small Form Variants"](s)||bt["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function Ig(c){return c>=1424&&c<=2303||bt["Arabic Presentation Forms-A"](c)||bt["Arabic Presentation Forms-B"](c)}function kg(c,s){return!(!s&&Ig(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||bt.Khmer(c))}function Xv(c){for(const s of c)if(Ig(s.charCodeAt(0)))return!0;return!1}const vf="deferred",xf="loading",bf="loaded";let wf=null,qi="unavailable",ga=null;const $c=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(qi="error"),wf&&wf(c)};function Sf(){Gc.fire(new vn("pluginStateChange",{pluginStatus:qi,pluginURL:ga}))}const Gc=new cn,Tf=function(){return qi},Mg=function(){if(qi!==vf||!ga)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi=xf,Sf(),ga&&Ut({url:ga},c=>{c?$c(c):(qi=bf,Sf())})},ps={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qi===bf||ps.applyArabicShaping!=null,isLoading:()=>qi===xf,setState(c){if(!Ye())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qi=c.pluginStatus,ga=c.pluginURL},isParsed(){if(!Ye())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ps.applyArabicShaping!=null&&ps.processBidirectionalText!=null&&ps.processStyledBidirectionalText!=null},getPluginURL(){if(!Ye())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ga}};class sr{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cg,this.transition={})}isSupportedScript(s){return function(u,f){for(const g of u)if(!kg(g.charCodeAt(0),f))return!1;return!0}(s,ps.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,u=s-Math.floor(s),f=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}class ah{constructor(s,u){this.property=s,this.value=u,this.expression=function(f,g){if(mr(f))return new zc(f,g);if(Ku(f)){const x=df(f,g);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=f;return g.type==="color"&&typeof f=="string"?x=Pn.parse(f):g.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(x=di.parse(f)):x=bi.parse(f),{kind:"constant",evaluate:()=>x}}}(u===void 0?s.specification.default:u,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,f){return this.property.possiblyEvaluate(this,s,u,f)}}class Ef{constructor(s){this.property=s,this.value=new ah(s,void 0)}transitioned(s,u){return new Rg(this.property,this.value,u,xe({},s.transition,this.transition),s.now)}untransitioned(){return new Rg(this.property,this.value,null,{},0)}}class Lg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Ne(this._values[s].value.value)}setValue(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Ef(this._values[s].property)),this._values[s].value=new ah(this._values[s].property,u===null?void 0:Ne(u))}getTransition(s){return Ne(this._values[s].transition)}setTransition(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new Ef(this._values[s].property)),this._values[s].transition=Ne(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f);const g=this.getTransition(u);g!==void 0&&(s[`${u}-transition`]=g)}return s}transitioned(s,u){const f=new Og(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(s,u._values[g]);return f}untransitioned(){const s=new Og(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class Rg{constructor(s,u,f,g,x){this.property=s,this.value=u,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,s.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(s,u,f){const g=s.now||0,x=this.value.possiblyEvaluate(s,u,f),w=this.prior;if(w){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return w.possiblyEvaluate(s,u,f);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,u,f),x,function(I){if(I<=0)return 0;if(I>=1)return 1;const M=I*I,B=M*I;return 4*(I<.5?B:3*(I-M)+B-.75)}(T))}}return x}}class Og{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,f){const g=new lh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Yv{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return Ne(this._values[s].value)}setValue(s,u){this._values[s]=new ah(this._values[s].property,u===null?void 0:Ne(u))}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f)}return s}possiblyEvaluate(s,u,f){const g=new lh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}}class Mi{constructor(s,u,f){this.property=s,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,f,g){return this.property.evaluate(this.value,this.parameters,s,u,f,g)}}class lh{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Gt{constructor(s){this.specification=s}possiblyEvaluate(s,u){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(u)}interpolate(s,u,f){const g=hs[this.specification.type];return g?g(s,u,f):s}}class nn{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,f,g){return new Mi(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},f,g)}:s.expression,u)}interpolate(s,u,f){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new Mi(this,{kind:"constant",value:void 0},s.parameters);const g=hs[this.specification.type];if(g){const x=g(s.value.value,u.value.value,f);return new Mi(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,u,f,g,x,w){return s.kind==="constant"?s.value:s.evaluate(u,f,g,x,w)}}class Wc extends nn{possiblyEvaluate(s,u,f,g){if(s.value===void 0)return new Mi(this,{kind:"constant",value:void 0},u);if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,T=this._calculate(w,w,w,u);return new Mi(this,{kind:"constant",value:T},u)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:u.zoom-1}),s.expression.evaluate({zoom:u.zoom}),s.expression.evaluate({zoom:u.zoom+1}),u);return new Mi(this,{kind:"constant",value:x},u)}return new Mi(this,s.expression,u)}evaluate(s,u,f,g,x,w){if(s.kind==="source"){const T=s.evaluate(u,f,g,x,w);return this._calculate(T,T,T,u)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(u.zoom)-1},f,g),s.evaluate({zoom:Math.floor(u.zoom)},f,g),s.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):s.value}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class Pf{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g);return this._calculate(x,x,x,u)}return this._calculate(s.expression.evaluate(new sr(Math.floor(u.zoom-1),u)),s.expression.evaluate(new sr(Math.floor(u.zoom),u)),s.expression.evaluate(new sr(Math.floor(u.zoom+1),u)),u)}}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class Cf{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){return!!s.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Rr{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in s){const f=s[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new ah(f,void 0),x=this.defaultTransitionablePropertyValues[u]=new Ef(f);this.defaultTransitioningPropertyValues[u]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}kt("DataDrivenProperty",nn),kt("DataConstantProperty",Gt),kt("CrossFadedDataDrivenProperty",Wc),kt("CrossFadedProperty",Pf),kt("ColorRampProperty",Cf);const Af="-transition";class ks extends cn{constructor(s,u){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),u.layout&&(this._unevaluatedLayout=new Yv(u.layout)),u.paint)){this._transitionablePaint=new Lg(u.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lh(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u,f={}){u!=null&&this._validate(Pg,`layers.${this.id}.layout.${s}`,s,u,f)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,u):this.visibility=u)}getPaintProperty(s){return s.endsWith(Af)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u,f={}){if(u!=null&&this._validate(mf,`layers.${this.id}.paint.${s}`,s,u,f))return!1;if(s.endsWith(Af))return this._transitionablePaint.setTransition(s.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[s],x=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(s,u),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,T,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,u,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Re(s,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(s,u,f,g,x={}){return(!x||x.validate!==!1)&&sh(this,s.call(qo,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof Mi&&Ml(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const zg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Wa{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class br{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yr(c,s=1){let u=0,f=0;return{members:c.map(g=>{const x=zg[g.type].BYTES_PER_ELEMENT,w=u=Dl(u,Math.max(s,x)),T=g.components||1;return f=Math.max(f,x),u+=x*T,{name:g.name,type:g.type,components:T,offset:w}}),size:Dl(u,Math.max(f,s)),alignment:s}}function Dl(c,s){return Math.ceil(c/s)*s}class Hc extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.int16[g+0]=u,this.int16[g+1]=f,s}}Hc.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",Hc);class qc extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,s}}qc.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",qc);class Ha extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.int16[w+0]=u,this.int16[w+1]=f,this.int16[w+2]=g,this.int16[w+3]=x,s}}Ha.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",Ha);class If extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=T,s}}If.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",If);class kf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=4*s,M=8*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.uint8[M+4]=g,this.uint8[M+5]=x,this.uint8[M+6]=w,this.uint8[M+7]=T,s}}kf.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",kf);class Fl extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.float32[g+0]=u,this.float32[g+1]=f,s}}Fl.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",Fl);class Mf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B){const U=this.length;return this.resize(U+1),this.emplace(U,s,u,f,g,x,w,T,I,M,B)}emplace(s,u,f,g,x,w,T,I,M,B,U){const H=10*s;return this.uint16[H+0]=u,this.uint16[H+1]=f,this.uint16[H+2]=g,this.uint16[H+3]=x,this.uint16[H+4]=w,this.uint16[H+5]=T,this.uint16[H+6]=I,this.uint16[H+7]=M,this.uint16[H+8]=B,this.uint16[H+9]=U,s}}Mf.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",Mf);class Lf extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,u,f,g,x,w,T,I,M,B,U,H)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y){const J=12*s;return this.int16[J+0]=u,this.int16[J+1]=f,this.int16[J+2]=g,this.int16[J+3]=x,this.uint16[J+4]=w,this.uint16[J+5]=T,this.uint16[J+6]=I,this.uint16[J+7]=M,this.int16[J+8]=B,this.int16[J+9]=U,this.int16[J+10]=H,this.int16[J+11]=Y,s}}Lf.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",Lf);class Vn extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}Vn.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",Vn);class v extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}v.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",v);class o extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M){const B=this.length;return this.resize(B+1),this.emplace(B,s,u,f,g,x,w,T,I,M)}emplace(s,u,f,g,x,w,T,I,M,B){const U=10*s,H=5*s;return this.int16[U+0]=u,this.int16[U+1]=f,this.int16[U+2]=g,this.int16[U+3]=x,this.int16[U+4]=w,this.int16[U+5]=T,this.uint32[H+3]=I,this.uint16[U+8]=M,this.uint16[U+9]=B,s}}o.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",o);class d extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const T=this.length;return this.resize(T+1),this.emplace(T,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,T){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=T,s}}d.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",d);class p extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,u,f,g,x)}emplace(s,u,f,g,x,w){const T=4*s,I=8*s;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=g,this.int16[I+6]=x,this.int16[I+7]=w,s}}p.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",p);class y extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=12*s,T=3*s;return this.uint8[w+0]=u,this.uint8[w+1]=f,this.float32[T+1]=g,this.float32[T+2]=x,s}}y.prototype.bytesPerElement=12,kt("StructArrayLayout2ub2f12",y);class b extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,s}}b.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",b);class E extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve){const ke=this.length;return this.resize(ke+1),this.emplace(ke,s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve,ke){const Se=24*s,Le=12*s,ze=48*s;return this.int16[Se+0]=u,this.int16[Se+1]=f,this.uint16[Se+2]=g,this.uint16[Se+3]=x,this.uint32[Le+2]=w,this.uint32[Le+3]=T,this.uint32[Le+4]=I,this.uint16[Se+10]=M,this.uint16[Se+11]=B,this.uint16[Se+12]=U,this.float32[Le+7]=H,this.float32[Le+8]=Y,this.uint8[ze+36]=J,this.uint8[ze+37]=ae,this.uint8[ze+38]=me,this.uint32[Le+10]=ve,this.int16[Se+22]=ke,s}}E.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",E);class C extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve,ke,Se,Le,ze,Je,wt,Dt,vt,gt,dt,Mt){const pt=this.length;return this.resize(pt+1),this.emplace(pt,s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve,ke,Se,Le,ze,Je,wt,Dt,vt,gt,dt,Mt)}emplace(s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae,me,ve,ke,Se,Le,ze,Je,wt,Dt,vt,gt,dt,Mt,pt){const it=32*s,Jt=16*s;return this.int16[it+0]=u,this.int16[it+1]=f,this.int16[it+2]=g,this.int16[it+3]=x,this.int16[it+4]=w,this.int16[it+5]=T,this.int16[it+6]=I,this.int16[it+7]=M,this.uint16[it+8]=B,this.uint16[it+9]=U,this.uint16[it+10]=H,this.uint16[it+11]=Y,this.uint16[it+12]=J,this.uint16[it+13]=ae,this.uint16[it+14]=me,this.uint16[it+15]=ve,this.uint16[it+16]=ke,this.uint16[it+17]=Se,this.uint16[it+18]=Le,this.uint16[it+19]=ze,this.uint16[it+20]=Je,this.uint16[it+21]=wt,this.uint16[it+22]=Dt,this.uint32[Jt+12]=vt,this.float32[Jt+13]=gt,this.float32[Jt+14]=dt,this.uint16[it+30]=Mt,this.uint16[it+31]=pt,s}}C.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",C);class k extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}k.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",k);class R extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[6*s+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}R.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",R);class j extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=4*s;return this.uint32[2*s+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=g,s}}j.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",j);class V extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.uint16[g+0]=u,this.uint16[g+1]=f,s}}V.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",V);class X extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}X.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",X);class ce extends br{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.float32[w+0]=u,this.float32[w+1]=f,this.float32[w+2]=g,this.float32[w+3]=x,s}}ce.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",ce);class le extends Wa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new A(this.anchorPointX,this.anchorPointY)}}le.prototype.size=20;class fe extends o{get(s){return new le(this,s)}}kt("CollisionBoxArray",fe);class oe extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}oe.prototype.size=48;class Pe extends E{get(s){return new oe(this,s)}}kt("PlacedSymbolArray",Pe);class Oe extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Oe.prototype.size=64;class ge extends C{get(s){return new Oe(this,s)}}kt("SymbolInstanceArray",ge);class Ie extends k{getoffsetX(s){return this.float32[1*s+0]}}kt("GlyphOffsetArray",Ie);class De extends qc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}kt("SymbolLineVertexArray",De);class Be extends Wa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Be.prototype.size=12;class Ke extends R{get(s){return new Be(this,s)}}kt("TextAnchorOffsetArray",Ke);class rt extends Wa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rt.prototype.size=8;class tt extends j{get(s){return new rt(this,s)}}kt("FeatureIndexArray",tt);class ct extends Hc{}class zt extends Hc{}class Cn extends Hc{}class mt extends If{}class rn extends kf{}class Nt extends Fl{}class Wn extends Mf{}class En extends Lf{}class xn extends Vn{}class An extends v{}class Ar extends d{}class er extends y{}class pi extends b{}class Jr extends V{}const Or=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ms}=Or;class or{constructor(s=[]){this.segments=s}prepareSegment(s,u,f,g){let x=this.segments[this.segments.length-1];return s>or.MAX_VERTEX_ARRAY_LENGTH&&je(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!x||x.vertexLength+s>or.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,f,g){return new or([{vertexOffset:s,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function yo(c,s){return 256*(c=te(Math.floor(c),0,255))+te(Math.floor(s),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",or);const _o=yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ya={exports:{}},qa={exports:{}};qa.exports=function(c,s){var u,f,g,x,w,T,I,M;for(f=c.length-(u=3&c.length),g=s,w=3432918353,T=461845907,M=0;M<f;)I=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,g=27492+(65535&(x=5*(65535&(g=(g^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(I=0,u){case 3:I^=(255&c.charCodeAt(M+2))<<16;case 2:I^=(255&c.charCodeAt(M+1))<<8;case 1:g^=I=(65535&(I=(I=(65535&(I^=255&c.charCodeAt(M)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Nl=qa.exports,wi={exports:{}};wi.exports=function(c,s){for(var u,f=c.length,g=s^f,x=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(x)|(255&c.charCodeAt(++x))<<8|(255&c.charCodeAt(++x))<<16|(255&c.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&c.charCodeAt(x+2))<<16;case 2:g^=(255&c.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var mi=Nl,Li=wi.exports;ya.exports=mi,ya.exports.murmur3=mi,ya.exports.murmur2=Li;var Za=_(ya.exports);class Ir{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,u,f,g){this.ids.push(Qr(s)),this.positions.push(u,f,g)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=Qr(s);let f=0,g=this.ids.length-1;for(;f<g;){const w=f+g>>1;this.ids[w]>=u?g=w:f=w+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(s,u){const f=new Float64Array(s.ids),g=new Uint32Array(s.positions);return Zi(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(s){const u=new Ir;return u.ids=s.ids,u.positions=s.positions,u.indexed=!0,u}}function Qr(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Za(String(c))}function Zi(c,s,u,f){for(;u<f;){const g=c[u+f>>1];let x=u-1,w=f+1;for(;;){do x++;while(c[x]<g);do w--;while(c[w]>g);if(x>=w)break;kr(c,x,w),kr(s,3*x,3*w),kr(s,3*x+1,3*w+1),kr(s,3*x+2,3*w+2)}w-u<f-w?(Zi(c,s,u,w),u=w+1):(Zi(c,s,w+1,f),f=w)}}function kr(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}kt("FeaturePositionMap",Ir);class Xa{constructor(s,u){this.gl=s.gl,this.location=u}}class ch extends Xa{constructor(s,u){super(s,u),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class Dg extends Xa{constructor(s,u){super(s,u),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Fg extends Xa{constructor(s,u){super(s,u),this.current=Pn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Kv=new Float32Array(16);function Rf(c){return[yo(255*c.r,255*c.g),yo(255*c.b,255*c.a)]}class vo{constructor(s,u,f){this.value=s,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(s,u,f){s.set(f.constantOr(this.value))}getBinding(s,u,f){return this.type==="color"?new Fg(s,u):new ch(s,u)}}class Ya{constructor(s,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=s.tlbr}setUniform(s,u,f,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,u,f){return f.substr(0,9)==="u_pattern"?new Dg(s,u):new ch(s,u)}}class xo{constructor(s,u,f,g){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(s,u,f,g,x){const w=this.paintVertexArray.length,T=this.expression.evaluate(new sr(0),u,{},g,[],x);this.paintVertexArray.resize(s),this._setPaintValue(w,s,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:0},f,g);this._setPaintValue(s,u,x)}_setPaintValue(s,u,f){if(this.type==="color"){const g=Rf(f);for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=s;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ms{constructor(s,u,f,g,x,w){this.expression=s,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,u,f,g,x){const w=this.expression.evaluate(new sr(this.zoom),u,{},g,[],x),T=this.expression.evaluate(new sr(this.zoom+1),u,{},g,[],x),I=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(I,s,w,T)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:this.zoom},f,g),w=this.expression.evaluate({zoom:this.zoom+1},f,g);this._setPaintValue(s,u,x,w)}_setPaintValue(s,u,f,g){if(this.type==="color"){const x=Rf(f),w=Rf(g);for(let T=s;T<u;T++)this.paintVertexArray.emplace(T,x[0],x[1],w[0],w[1])}else{for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=te(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);s.set(g)}getBinding(s,u,f){return new ch(s,u)}}class bo{constructor(s,u,f,g,x,w){this.expression=s,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(g,s,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(s,u,f,g,x){this._setPaintValues(s,u,f.patterns&&f.patterns[this.layerId],x)}_setPaintValues(s,u,f,g){if(!g||!f)return;const{min:x,mid:w,max:T}=f,I=g[x],M=g[w],B=g[T];if(I&&M&&B)for(let U=s;U<u;U++)this.zoomInPaintVertexArray.emplace(U,M.tl[0],M.tl[1],M.br[0],M.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],M.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,M.tl[0],M.tl[1],M.br[0],M.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],M.pixelRatio,B.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,_o.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,_o.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Of{constructor(s,u,f){this.binders={},this._buffers=[];const g=[];for(const x in s.paint._values){if(!f(x))continue;const w=s.paint.get(x);if(!(w instanceof Mi&&Ml(w.property.specification)))continue;const T=yD(x,s.type),I=w.value,M=w.property.specification.type,B=w.property.useIntegerZoom,U=w.property.specification["property-type"],H=U==="cross-faded"||U==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=H?new Ya(I.value,T):new vo(I.value,T,M),g.push(`/u_${x}`);else if(I.kind==="source"||H){const Y=vT(x,M,"source");this.binders[x]=H?new bo(I,M,B,u,Y,s.id):new xo(I,T,M,Y),g.push(`/a_${x}`)}else{const Y=vT(x,M,"composite");this.binders[x]=new Ms(I,T,M,B,u,Y),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof xo||u instanceof Ms?u.maxValue:0}populatePaintArrays(s,u,f,g,x){for(const w in this.binders){const T=this.binders[w];(T instanceof xo||T instanceof Ms||T instanceof bo)&&T.populatePaintArray(s,u,f,g,x)}}setConstantPatternPositions(s,u){for(const f in this.binders){const g=this.binders[f];g instanceof Ya&&g.setConstantPatternPositions(s,u)}}updatePaintArrays(s,u,f,g,x){let w=!1;for(const T in s){const I=u.getPositions(T);for(const M of I){const B=f.feature(M.index);for(const U in this.binders){const H=this.binders[U];if((H instanceof xo||H instanceof Ms||H instanceof bo)&&H.expression.isStateDependent===!0){const Y=g.paint.get(U);H.expression=Y.value,H.updatePaintArray(M.start,M.end,B,s[T],x),w=!0}}}}return w}defines(){const s=[];for(const u in this.binders){const f=this.binders[u];(f instanceof vo||f instanceof Ya)&&s.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof xo||f instanceof Ms)for(let g=0;g<f.paintVertexAttributes.length;g++)s.push(f.paintVertexAttributes[g].name);else if(f instanceof bo)for(let g=0;g<_o.members.length;g++)s.push(_o.members[g].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof vo||f instanceof Ya||f instanceof Ms)for(const g of f.uniformNames)s.push(g)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,u){const f=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof vo||x instanceof Ya||x instanceof Ms){for(const w of x.uniformNames)if(u[w]){const T=x.getBinding(s,u[w],w);f.push({name:w,property:g,binding:T})}}}return f}setUniforms(s,u,f,g){for(const{name:x,property:w,binding:T}of u)this.binders[w].setUniform(T,g,f.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(s&&f instanceof bo){const g=s.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof xo||f instanceof Ms)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(s){for(const u in this.binders){const f=this.binders[u];(f instanceof xo||f instanceof Ms||f instanceof bo)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof xo||u instanceof Ms||u instanceof bo)&&u.destroy()}}}class Xo{constructor(s,u,f=()=>!0){this.programConfigurations={};for(const g of s)this.programConfigurations[g.id]=new Of(g,u,f);this.needsUpload=!1,this._featureMap=new Ir,this._bufferOffset=0}populatePaintArrays(s,u,f,g,x,w){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(s,u,g,x,w);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,f,g){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,u,x,g)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function yD(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function vT(c,s,u){const f={color:{source:Fl,composite:ce},number:{source:k,composite:Fl}},g=function(x){return{"line-pattern":{source:Wn,composite:Wn},"fill-pattern":{source:Wn,composite:Wn},"fill-extrusion-pattern":{source:Wn,composite:Wn}}[x]}(c);return g&&g[u]||f[s][u]}kt("ConstantBinder",vo),kt("CrossFadedConstantBinder",Ya),kt("SourceExpressionBinder",xo),kt("CrossFadedCompositeBinder",bo),kt("CompositeExpressionBinder",Ms),kt("ProgramConfiguration",Of,{omit:["_buffers"]}),kt("ProgramConfigurationSet",Xo);const $r=8192,Jv=Math.pow(2,14)-1,xT=-Jv-1;function Zc(c){const s=$r/c.extent,u=c.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let x=0;x<g.length;x++){const w=g[x],T=Math.round(w.x*s),I=Math.round(w.y*s);w.x=te(T,xT,Jv),w.y=te(I,xT,Jv),(T<w.x||T>w.x+1||I<w.y||I>w.y+1)&&je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function Xc(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Zc(c):[]}}function Ng(c,s,u,f,g){c.emplaceBack(2*s+(f+1)/2,2*u+(g+1)/2)}class Qv{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new zt,this.indexArray=new pi,this.segments=new or,this.programConfigurations=new Xo(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){const g=this.layers[0],x=[];let w=null,T=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),T=!w.isConstant());for(const{feature:I,id:M,index:B,sourceLayerIndex:U}of s){const H=this.layers[0]._featureFilter.needGeometry,Y=Xc(I,H);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),Y,f))continue;const J=T?w.evaluate(Y,{},f):void 0,ae={id:M,properties:I.properties,type:I.type,sourceLayerIndex:U,index:B,geometry:H?Y.geometry:Zc(I),patterns:{},sortKey:J};x.push(ae)}T&&x.sort((I,M)=>I.sortKey-M.sortKey);for(const I of x){const{geometry:M,index:B,sourceLayerIndex:U}=I,H=s[B].feature;this.addFeature(I,M,B,f),u.featureIndex.insert(H,M,B,U,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ms),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,f,g){for(const x of u)for(const w of x){const T=w.x,I=w.y;if(T<0||T>=$r||I<0||I>=$r)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),B=M.vertexLength;Ng(this.layoutVertexArray,T,I,-1,-1),Ng(this.layoutVertexArray,T,I,1,-1),Ng(this.layoutVertexArray,T,I,1,1),Ng(this.layoutVertexArray,T,I,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},g)}}function bT(c,s){for(let u=0;u<c.length;u++)if(uh(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(uh(c,s[u]))return!0;return!!ex(c,s)}function _D(c,s,u){return!!uh(c,s)||!!tx(s,c,u)}function wT(c,s){if(c.length===1)return TT(s,c[0]);for(let u=0;u<s.length;u++){const f=s[u];for(let g=0;g<f.length;g++)if(uh(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(TT(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(ex(c,s[u]))return!0;return!1}function vD(c,s,u){if(c.length>1){if(ex(c,s))return!0;for(let f=0;f<s.length;f++)if(tx(s[f],c,u))return!0}for(let f=0;f<c.length;f++)if(tx(c[f],s,u))return!0;return!1}function ex(c,s){if(c.length===0||s.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let x=0;x<s.length-1;x++)if(xD(f,g,s[x],s[x+1]))return!0}return!1}function xD(c,s,u,f){return Ge(c,u,f)!==Ge(s,u,f)&&Ge(c,s,u)!==Ge(c,s,f)}function tx(c,s,u){const f=u*u;if(s.length===1)return c.distSqr(s[0])<f;for(let g=1;g<s.length;g++)if(ST(c,s[g-1],s[g])<f)return!0;return!1}function ST(c,s,u){const f=s.distSqr(u);if(f===0)return c.distSqr(s);const g=((c.x-s.x)*(u.x-s.x)+(c.y-s.y)*(u.y-s.y))/f;return c.distSqr(g<0?s:g>1?u:u.sub(s)._mult(g)._add(s))}function TT(c,s){let u,f,g,x=!1;for(let w=0;w<c.length;w++){u=c[w];for(let T=0,I=u.length-1;T<u.length;I=T++)f=u[T],g=u[I],f.y>s.y!=g.y>s.y&&s.x<(g.x-f.x)*(s.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function uh(c,s){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const x=c[f],w=c[g];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(u=!u)}return u}function bD(c,s,u){const f=u[0],g=u[2];if(c.x<f.x&&s.x<f.x||c.x>g.x&&s.x>g.x||c.y<f.y&&s.y<f.y||c.y>g.y&&s.y>g.y)return!1;const x=Ge(c,s,u[0]);return x!==Ge(c,s,u[1])||x!==Ge(c,s,u[2])||x!==Ge(c,s,u[3])}function zf(c,s,u){const f=s.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(s.id).getMaxValue(c)}function Bg(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function jg(c,s,u,f,g){if(!s[0]&&!s[1])return c;const x=A.convert(s)._mult(g);u==="viewport"&&x._rotate(-f);const w=[];for(let T=0;T<c.length;T++)w.push(c[T].sub(x));return w}let ET,PT;kt("CircleBucket",Qv,{omit:["layers"]});var wD={get paint(){return PT=PT||new Rr({"circle-radius":new nn(Ae.paint_circle["circle-radius"]),"circle-color":new nn(Ae.paint_circle["circle-color"]),"circle-blur":new nn(Ae.paint_circle["circle-blur"]),"circle-opacity":new nn(Ae.paint_circle["circle-opacity"]),"circle-translate":new Gt(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nn(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nn(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nn(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return ET=ET||new Rr({"circle-sort-key":new nn(Ae.layout_circle["circle-sort-key"])})}},Xi=1e-6,hh=typeof Float32Array<"u"?Float32Array:Array;function nx(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function CT(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3],T=s[4],I=s[5],M=s[6],B=s[7],U=s[8],H=s[9],Y=s[10],J=s[11],ae=s[12],me=s[13],ve=s[14],ke=s[15],Se=u[0],Le=u[1],ze=u[2],Je=u[3];return c[0]=Se*f+Le*T+ze*U+Je*ae,c[1]=Se*g+Le*I+ze*H+Je*me,c[2]=Se*x+Le*M+ze*Y+Je*ve,c[3]=Se*w+Le*B+ze*J+Je*ke,c[4]=(Se=u[4])*f+(Le=u[5])*T+(ze=u[6])*U+(Je=u[7])*ae,c[5]=Se*g+Le*I+ze*H+Je*me,c[6]=Se*x+Le*M+ze*Y+Je*ve,c[7]=Se*w+Le*B+ze*J+Je*ke,c[8]=(Se=u[8])*f+(Le=u[9])*T+(ze=u[10])*U+(Je=u[11])*ae,c[9]=Se*g+Le*I+ze*H+Je*me,c[10]=Se*x+Le*M+ze*Y+Je*ve,c[11]=Se*w+Le*B+ze*J+Je*ke,c[12]=(Se=u[12])*f+(Le=u[13])*T+(ze=u[14])*U+(Je=u[15])*ae,c[13]=Se*g+Le*I+ze*H+Je*me,c[14]=Se*x+Le*M+ze*Y+Je*ve,c[15]=Se*w+Le*B+ze*J+Je*ke,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var Df,SD=CT;function Vg(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3];return c[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*w,c[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*w,c[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*w,c[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*w,c}Df=new hh(4),hh!=Float32Array&&(Df[0]=0,Df[1]=0,Df[2]=0,Df[3]=0);class TD extends ks{constructor(s){super(s,wD)}createBucket(s){return new Qv(s)}queryRadius(s){const u=s;return zf("circle-radius",this,u)+zf("circle-stroke-width",this,u)+Bg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T,I){const M=jg(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,T),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),U=this.paint.get("circle-pitch-alignment")==="map",H=U?M:function(J,ae){return J.map(me=>AT(me,ae))}(M,I),Y=U?B*T:B;for(const J of g)for(const ae of J){const me=U?ae:AT(ae,I);let ve=Y;const ke=Vg([],[ae.x,ae.y,0,1],I);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ve*=ke[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ve*=w.cameraToCenterDistance/ke[3]),_D(H,me,ve))return!0}return!1}}function AT(c,s){const u=Vg([],[c.x,c.y,0,1],s);return new A(u[0]/u[3],u[1]/u[3])}class IT extends Qv{}let kT;kt("HeatmapBucket",IT,{omit:["layers"]});var ED={get paint(){return kT=kT||new Rr({"heatmap-radius":new nn(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nn(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cf(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(Ae.paint_heatmap["heatmap-opacity"])})}};function rx(c,{width:s,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==s*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${s*u*f}`)}else g=new Uint8Array(s*u*f);return c.width=s,c.height=u,c.data=g,c}function MT(c,{width:s,height:u},f){if(s===c.width&&u===c.height)return;const g=rx({},{width:s,height:u},f);ix(c,g,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,u)},f),c.width=s,c.height=u,c.data=g.data}function ix(c,s,u,f,g,x){if(g.width===0||g.height===0)return s;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>s.width||g.height>s.height||f.x>s.width-g.width||f.y>s.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,T=s.data;if(w===T)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const M=((u.y+I)*c.width+u.x)*x,B=((f.y+I)*s.width+f.x)*x;for(let U=0;U<g.width*x;U++)T[B+U]=w[M+U]}return s}class Ff{constructor(s,u){rx(this,s,1,u)}resize(s){MT(this,s,1)}clone(){return new Ff({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){ix(s,u,f,g,x,1)}}class $s{constructor(s,u){rx(this,s,4,u)}resize(s){MT(this,s,4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new $s({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){ix(s,u,f,g,x,4)}}function LT(c){const s={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new $s({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const x=(w,T,I)=>{s[c.evaluationKey]=I;const M=c.expression.evaluate(s);g.data[w+T+0]=Math.floor(255*M.r/M.a),g.data[w+T+1]=Math.floor(255*M.g/M.a),g.data[w+T+2]=Math.floor(255*M.b/M.a),g.data[w+T+3]=Math.floor(255*M.a)};if(c.clips)for(let w=0,T=0;w<f;++w,T+=4*u)for(let I=0,M=0;I<u;I++,M+=4){const B=I/(u-1),{start:U,end:H}=c.clips[w];x(T,M,U*(1-B)+H*B)}else for(let w=0,T=0;w<u;w++,T+=4)x(0,T,w/(u-1));return g}kt("AlphaImage",Ff),kt("RGBAImage",$s);class PD extends ks{createBucket(s){return new IT(s)}constructor(s){super(s,ED),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=LT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let RT;var CD={get paint(){return RT=RT||new Rr({"hillshade-illumination-direction":new Gt(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(Ae.paint_hillshade["hillshade-accent-color"])})}};class AD extends ks{constructor(s){super(s,CD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ID=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:kD}=ID;var sx={exports:{}};function Ug(c,s,u){u=u||2;var f,g,x,w,T,I,M,B=s&&s.length,U=B?s[0]*u:c.length,H=OT(c,0,U,u,!0),Y=[];if(!H||H.next===H.prev)return Y;if(B&&(H=function(ae,me,ve,ke){var Se,Le,ze,Je=[];for(Se=0,Le=me.length;Se<Le;Se++)(ze=OT(ae,me[Se]*ke,Se<Le-1?me[Se+1]*ke:ae.length,ke,!1))===ze.next&&(ze.steiner=!0),Je.push(ND(ze));for(Je.sort(zD),Se=0;Se<Je.length;Se++)ve=DD(Je[Se],ve);return ve}(c,s,H,u)),c.length>80*u){f=x=c[0],g=w=c[1];for(var J=u;J<U;J+=u)(T=c[J])<f&&(f=T),(I=c[J+1])<g&&(g=I),T>x&&(x=T),I>w&&(w=I);M=(M=Math.max(x-f,w-g))!==0?32767/M:0}return Nf(H,Y,u,f,g,M,0),Y}function OT(c,s,u,f,g){var x,w;if(g===lx(c,s,u,f)>0)for(x=s;x<u;x+=f)w=FT(x,c[x],c[x+1],w);else for(x=u-f;x>=s;x-=f)w=FT(x,c[x],c[x+1],w);return w&&$g(w,w.next)&&(jf(w),w=w.next),w}function Yc(c,s){if(!c)return c;s||(s=c);var u,f=c;do if(u=!1,f.steiner||!$g(f,f.next)&&zr(f.prev,f,f.next)!==0)f=f.next;else{if(jf(f),(f=s=f.prev)===f.next)break;u=!0}while(u||f!==s);return s}function Nf(c,s,u,f,g,x,w){if(c){!w&&x&&function(B,U,H,Y){var J=B;do J.z===0&&(J.z=ox(J.x,J.y,U,H,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==B);J.prevZ.nextZ=null,J.prevZ=null,function(ae){var me,ve,ke,Se,Le,ze,Je,wt,Dt=1;do{for(ve=ae,ae=null,Le=null,ze=0;ve;){for(ze++,ke=ve,Je=0,me=0;me<Dt&&(Je++,ke=ke.nextZ);me++);for(wt=Dt;Je>0||wt>0&&ke;)Je!==0&&(wt===0||!ke||ve.z<=ke.z)?(Se=ve,ve=ve.nextZ,Je--):(Se=ke,ke=ke.nextZ,wt--),Le?Le.nextZ=Se:ae=Se,Se.prevZ=Le,Le=Se;ve=ke}Le.nextZ=null,Dt*=2}while(ze>1)}(J)}(c,f,g,x);for(var T,I,M=c;c.prev!==c.next;)if(T=c.prev,I=c.next,x?LD(c,f,g,x):MD(c))s.push(T.i/u|0),s.push(c.i/u|0),s.push(I.i/u|0),jf(c),c=I.next,M=I.next;else if((c=I)===M){w?w===1?Nf(c=RD(Yc(c),s,u),s,u,f,g,x,2):w===2&&OD(c,s,u,f,g,x):Nf(Yc(c),s,u,f,g,x,1);break}}}function MD(c){var s=c.prev,u=c,f=c.next;if(zr(s,u,f)>=0)return!1;for(var g=s.x,x=u.x,w=f.x,T=s.y,I=u.y,M=f.y,B=g<x?g<w?g:w:x<w?x:w,U=T<I?T<M?T:M:I<M?I:M,H=g>x?g>w?g:w:x>w?x:w,Y=T>I?T>M?T:M:I>M?I:M,J=f.next;J!==s;){if(J.x>=B&&J.x<=H&&J.y>=U&&J.y<=Y&&dh(g,T,x,I,w,M,J.x,J.y)&&zr(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function LD(c,s,u,f){var g=c.prev,x=c,w=c.next;if(zr(g,x,w)>=0)return!1;for(var T=g.x,I=x.x,M=w.x,B=g.y,U=x.y,H=w.y,Y=T<I?T<M?T:M:I<M?I:M,J=B<U?B<H?B:H:U<H?U:H,ae=T>I?T>M?T:M:I>M?I:M,me=B>U?B>H?B:H:U>H?U:H,ve=ox(Y,J,s,u,f),ke=ox(ae,me,s,u,f),Se=c.prevZ,Le=c.nextZ;Se&&Se.z>=ve&&Le&&Le.z<=ke;){if(Se.x>=Y&&Se.x<=ae&&Se.y>=J&&Se.y<=me&&Se!==g&&Se!==w&&dh(T,B,I,U,M,H,Se.x,Se.y)&&zr(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,Le.x>=Y&&Le.x<=ae&&Le.y>=J&&Le.y<=me&&Le!==g&&Le!==w&&dh(T,B,I,U,M,H,Le.x,Le.y)&&zr(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;Se&&Se.z>=ve;){if(Se.x>=Y&&Se.x<=ae&&Se.y>=J&&Se.y<=me&&Se!==g&&Se!==w&&dh(T,B,I,U,M,H,Se.x,Se.y)&&zr(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;Le&&Le.z<=ke;){if(Le.x>=Y&&Le.x<=ae&&Le.y>=J&&Le.y<=me&&Le!==g&&Le!==w&&dh(T,B,I,U,M,H,Le.x,Le.y)&&zr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function RD(c,s,u){var f=c;do{var g=f.prev,x=f.next.next;!$g(g,x)&&zT(g,f,f.next,x)&&Bf(g,x)&&Bf(x,g)&&(s.push(g.i/u|0),s.push(f.i/u|0),s.push(x.i/u|0),jf(f),jf(f.next),f=c=x),f=f.next}while(f!==c);return Yc(f)}function OD(c,s,u,f,g,x){var w=c;do{for(var T=w.next.next;T!==w.prev;){if(w.i!==T.i&&BD(w,T)){var I=DT(w,T);return w=Yc(w,w.next),I=Yc(I,I.next),Nf(w,s,u,f,g,x,0),void Nf(I,s,u,f,g,x,0)}T=T.next}w=w.next}while(w!==c)}function zD(c,s){return c.x-s.x}function DD(c,s){var u=function(g,x){var w,T=x,I=g.x,M=g.y,B=-1/0;do{if(M<=T.y&&M>=T.next.y&&T.next.y!==T.y){var U=T.x+(M-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(U<=I&&U>B&&(B=U,w=T.x<T.next.x?T:T.next,U===I))return w}T=T.next}while(T!==x);if(!w)return null;var H,Y=w,J=w.x,ae=w.y,me=1/0;T=w;do I>=T.x&&T.x>=J&&I!==T.x&&dh(M<ae?I:B,M,J,ae,M<ae?B:I,M,T.x,T.y)&&(H=Math.abs(M-T.y)/(I-T.x),Bf(T,g)&&(H<me||H===me&&(T.x>w.x||T.x===w.x&&FD(w,T)))&&(w=T,me=H)),T=T.next;while(T!==Y);return w}(c,s);if(!u)return s;var f=DT(u,c);return Yc(f,f.next),Yc(u,u.next)}function FD(c,s){return zr(c.prev,c,s.prev)<0&&zr(s.next,c,c.next)<0}function ox(c,s,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function ND(c){var s=c,u=c;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==c);return u}function dh(c,s,u,f,g,x,w,T){return(g-w)*(s-T)>=(c-w)*(x-T)&&(c-w)*(f-T)>=(u-w)*(s-T)&&(u-w)*(x-T)>=(g-w)*(f-T)}function BD(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&zT(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,s)&&(Bf(c,s)&&Bf(s,c)&&function(u,f){var g=u,x=!1,w=(u.x+f.x)/2,T=(u.y+f.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&w<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(c,s)&&(zr(c.prev,c,s.prev)||zr(c,s.prev,s))||$g(c,s)&&zr(c.prev,c,c.next)>0&&zr(s.prev,s,s.next)>0)}function zr(c,s,u){return(s.y-c.y)*(u.x-s.x)-(s.x-c.x)*(u.y-s.y)}function $g(c,s){return c.x===s.x&&c.y===s.y}function zT(c,s,u,f){var g=Wg(zr(c,s,u)),x=Wg(zr(c,s,f)),w=Wg(zr(u,f,c)),T=Wg(zr(u,f,s));return g!==x&&w!==T||!(g!==0||!Gg(c,u,s))||!(x!==0||!Gg(c,f,s))||!(w!==0||!Gg(u,c,f))||!(T!==0||!Gg(u,s,f))}function Gg(c,s,u){return s.x<=Math.max(c.x,u.x)&&s.x>=Math.min(c.x,u.x)&&s.y<=Math.max(c.y,u.y)&&s.y>=Math.min(c.y,u.y)}function Wg(c){return c>0?1:c<0?-1:0}function Bf(c,s){return zr(c.prev,c,c.next)<0?zr(c,s,c.next)>=0&&zr(c,c.prev,s)>=0:zr(c,s,c.prev)<0||zr(c,c.next,s)<0}function DT(c,s){var u=new ax(c.i,c.x,c.y),f=new ax(s.i,s.x,s.y),g=c.next,x=s.prev;return c.next=s,s.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function FT(c,s,u,f){var g=new ax(c,s,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function jf(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ax(c,s,u){this.i=c,this.x=s,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lx(c,s,u,f){for(var g=0,x=s,w=u-f;x<u;x+=f)g+=(c[w]-c[x])*(c[x+1]+c[w+1]),w=x;return g}sx.exports=Ug,sx.exports.default=Ug,Ug.deviation=function(c,s,u,f){var g=s&&s.length,x=Math.abs(lx(c,0,g?s[0]*u:c.length,u));if(g)for(var w=0,T=s.length;w<T;w++)x-=Math.abs(lx(c,s[w]*u,w<T-1?s[w+1]*u:c.length,u));var I=0;for(w=0;w<f.length;w+=3){var M=f[w]*u,B=f[w+1]*u,U=f[w+2]*u;I+=Math.abs((c[M]-c[U])*(c[B+1]-c[M+1])-(c[M]-c[B])*(c[U+1]-c[M+1]))}return x===0&&I===0?0:Math.abs((I-x)/x)},Ug.flatten=function(c){for(var s=c[0][0].length,u={vertices:[],holes:[],dimensions:s},f=0,g=0;g<c.length;g++){for(var x=0;x<c[g].length;x++)for(var w=0;w<s;w++)u.vertices.push(c[g][x][w]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var NT=_(sx.exports);function jD(c,s,u,f,g){BT(c,s,u||0,f||c.length-1,g||VD)}function BT(c,s,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,w=s-u+1,T=Math.log(x),I=.5*Math.exp(2*T/3),M=.5*Math.sqrt(T*I*(x-I)/x)*(w-x/2<0?-1:1);BT(c,s,Math.max(u,Math.floor(s-w*I/x+M)),Math.min(f,Math.floor(s+(x-w)*I/x+M)),g)}var B=c[s],U=u,H=f;for(Vf(c,u,s),g(c[f],B)>0&&Vf(c,u,f);U<H;){for(Vf(c,U,H),U++,H--;g(c[U],B)<0;)U++;for(;g(c[H],B)>0;)H--}g(c[u],B)===0?Vf(c,u,H):Vf(c,++H,f),H<=s&&(u=H+1),s<=H&&(f=H-1)}}function Vf(c,s,u){var f=c[s];c[s]=c[u],c[u]=f}function VD(c,s){return c<s?-1:c>s?1:0}function cx(c,s){const u=c.length;if(u<=1)return[c];const f=[];let g,x;for(let w=0;w<u;w++){const T=Ze(c[w]);T!==0&&(c[w].area=Math.abs(T),x===void 0&&(x=T<0),x===T<0?(g&&f.push(g),g=[c[w]]):g.push(c[w]))}if(g&&f.push(g),s>1)for(let w=0;w<f.length;w++)f[w].length<=s||(jD(f[w],s,1,f[w].length-1,UD),f[w]=f[w].slice(0,s));return f}function UD(c,s){return s.area-c.area}function ux(c,s,u){const f=u.patternDependencies;let g=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(g=!0);const T=w.constantOr(null);T&&(g=!0,f[T.to]=!0,f[T.from]=!0)}return g}function hx(c,s,u,f,g){const x=g.patternDependencies;for(const w of s){const T=w.paint.get(`${c}-pattern`).value;if(T.kind!=="constant"){let I=T.evaluate({zoom:f-1},u,{},g.availableImages),M=T.evaluate({zoom:f},u,{},g.availableImages),B=T.evaluate({zoom:f+1},u,{},g.availableImages);I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,B=B&&B.name?B.name:B,x[I]=!0,x[M]=!0,x[B]=!0,u.patterns[w.id]={min:I,mid:M,max:B}}}return u}class dx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Cn,this.indexArray=new pi,this.indexArray2=new Jr,this.programConfigurations=new Xo(s.layers,s.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=ux("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:I,index:M,sourceLayerIndex:B}of s){const U=this.layers[0]._featureFilter.needGeometry,H=Xc(T,U);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f,u.availableImages):void 0,J={id:I,properties:T.properties,type:T.type,sourceLayerIndex:B,index:M,geometry:U?H.geometry:Zc(T),patterns:{},sortKey:Y};w.push(J)}x&&w.sort((T,I)=>T.sortKey-I.sortKey);for(const T of w){const{geometry:I,index:M,sourceLayerIndex:B}=T;if(this.hasPattern){const U=hx("fill",this.layers,T,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(T,I,M,f,{});u.featureIndex.insert(s[M].feature,I,M,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,kD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,f,g,x){for(const w of cx(u,500)){let T=0;for(const Y of w)T+=Y.length;const I=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),M=I.vertexLength,B=[],U=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&U.push(B.length/2);const J=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),ae=J.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(ae+Y.length-1,ae),B.push(Y[0].x),B.push(Y[0].y);for(let me=1;me<Y.length;me++)this.layoutVertexArray.emplaceBack(Y[me].x,Y[me].y),this.indexArray2.emplaceBack(ae+me-1,ae+me),B.push(Y[me].x),B.push(Y[me].y);J.vertexLength+=Y.length,J.primitiveLength+=Y.length}const H=NT(B,U);for(let Y=0;Y<H.length;Y+=3)this.indexArray.emplaceBack(M+H[Y],M+H[Y+1],M+H[Y+2]);I.vertexLength+=T,I.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}let jT,VT;kt("FillBucket",dx,{omit:["layers","patternFeatures"]});var $D={get paint(){return VT=VT||new Rr({"fill-antialias":new Gt(Ae.paint_fill["fill-antialias"]),"fill-opacity":new nn(Ae.paint_fill["fill-opacity"]),"fill-color":new nn(Ae.paint_fill["fill-color"]),"fill-outline-color":new nn(Ae.paint_fill["fill-outline-color"]),"fill-translate":new Gt(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wc(Ae.paint_fill["fill-pattern"])})},get layout(){return jT=jT||new Rr({"fill-sort-key":new nn(Ae.layout_fill["fill-sort-key"])})}};class GD extends ks{constructor(s){super(s,$D)}recalculate(s,u){super.recalculate(s,u);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new dx(s)}queryRadius(){return Bg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){return wT(jg(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,T),g)}isTileClipped(){return!0}}const WD=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),HD=yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:qD}=WD;var Bl={},ZD=S,UT=fh;function fh(c,s,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(XD,this,s)}function XD(c,s,u){c==1?s.id=u.readVarint():c==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var w=g._keys[f.readVarint()],T=g._values[f.readVarint()];g.properties[w]=T}}(u,s):c==3?s.type=u.readVarint():c==4&&(s._geometry=u.pos)}function YD(c){for(var s,u,f=0,g=0,x=c.length,w=x-1;g<x;w=g++)f+=((u=c[w]).x-(s=c[g]).x)*(s.y+u.y);return f}fh.types=["Unknown","Point","LineString","Polygon"],fh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,u=c.readVarint()+c.pos,f=1,g=0,x=0,w=0,T=[];c.pos<u;){if(g<=0){var I=c.readVarint();f=7&I,g=I>>3}if(g--,f===1||f===2)x+=c.readSVarint(),w+=c.readSVarint(),f===1&&(s&&T.push(s),s=[]),s.push(new ZD(x,w));else{if(f!==7)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&T.push(s),T},fh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,u=1,f=0,g=0,x=0,w=1/0,T=-1/0,I=1/0,M=-1/0;c.pos<s;){if(f<=0){var B=c.readVarint();u=7&B,f=B>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<w&&(w=g),g>T&&(T=g),(x+=c.readSVarint())<I&&(I=x),x>M&&(M=x);else if(u!==7)throw new Error("unknown command "+u)}return[w,I,T,M]},fh.prototype.toGeoJSON=function(c,s,u){var f,g,x=this.extent*Math.pow(2,u),w=this.extent*c,T=this.extent*s,I=this.loadGeometry(),M=fh.types[this.type];function B(Y){for(var J=0;J<Y.length;J++){var ae=Y[J];Y[J]=[360*(ae.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+T)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(f=0;f<I.length;f++)U[f]=I[f][0];B(I=U);break;case 2:for(f=0;f<I.length;f++)B(I[f]);break;case 3:for(I=function(Y){var J=Y.length;if(J<=1)return[Y];for(var ae,me,ve=[],ke=0;ke<J;ke++){var Se=YD(Y[ke]);Se!==0&&(me===void 0&&(me=Se<0),me===Se<0?(ae&&ve.push(ae),ae=[Y[ke]]):ae.push(Y[ke]))}return ae&&ve.push(ae),ve}(I),f=0;f<I.length;f++)for(g=0;g<I[f].length;g++)B(I[f][g])}I.length===1?I=I[0]:M="Multi"+M;var H={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(H.id=this.id),H};var KD=UT,$T=GT;function GT(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(JD,this,s),this.length=this._features.length}function JD(c,s,u){c===15?s.version=u.readVarint():c===1?s.name=u.readString():c===5?s.extent=u.readVarint():c===2?s._features.push(u.pos):c===3?s._keys.push(u.readString()):c===4&&s._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var w=f.readVarint()>>3;g=w===1?f.readString():w===2?f.readFloat():w===3?f.readDouble():w===4?f.readVarint64():w===5?f.readVarint():w===6?f.readSVarint():w===7?f.readBoolean():null}return g}(u))}GT.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new KD(this._pbf,s,this.extent,this._keys,this._values)};var QD=$T;function eF(c,s,u){if(c===3){var f=new QD(u,u.readVarint()+u.pos);f.length&&(s[f.name]=f)}}Bl.VectorTile=function(c,s){this.layers=c.readFields(eF,{},s)},Bl.VectorTileFeature=UT,Bl.VectorTileLayer=$T;const tF=Bl.VectorTileFeature.types,fx=Math.pow(2,13);function Uf(c,s,u,f,g,x,w,T){c.emplaceBack(s,u,2*Math.floor(f*fx)+w,g*fx*2,x*fx*2,Math.round(T))}class px{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new mt,this.centroidVertexArray=new ct,this.indexArray=new pi,this.programConfigurations=new Xo(s.layers,s.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.features=[],this.hasPattern=ux("fill-extrusion",this.layers,u);for(const{feature:g,id:x,index:w,sourceLayerIndex:T}of s){const I=this.layers[0]._featureFilter.needGeometry,M=Xc(g,I);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),M,f))continue;const B={id:x,sourceLayerIndex:T,index:w,geometry:I?M.geometry:Zc(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(hx("fill-extrusion",this.layers,B,this.zoom,u)):this.addFeature(B,B.geometry,w,f,{}),u.featureIndex.insert(g,B.geometry,w,T,this.index,!0)}}addFeatures(s,u,f){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,u,f)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,qD),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,HD.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,u,f,g,x){const w={x:0,y:0,vertexCount:0};for(const T of cx(u,500)){let I=0;for(const J of T)I+=J.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const J of T){if(J.length===0||rF(J))continue;let ae=0;for(let me=0;me<J.length;me++){const ve=J[me];if(me>=1){const ke=J[me-1];if(!nF(ve,ke)){M.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Se=ve.sub(ke)._perp()._unit(),Le=ke.dist(ve);ae+Le>32768&&(ae=0),Uf(this.layoutVertexArray,ve.x,ve.y,Se.x,Se.y,0,0,ae),Uf(this.layoutVertexArray,ve.x,ve.y,Se.x,Se.y,0,1,ae),w.x+=2*ve.x,w.y+=2*ve.y,w.vertexCount+=2,ae+=Le,Uf(this.layoutVertexArray,ke.x,ke.y,Se.x,Se.y,0,0,ae),Uf(this.layoutVertexArray,ke.x,ke.y,Se.x,Se.y,0,1,ae),w.x+=2*ke.x,w.y+=2*ke.y,w.vertexCount+=2;const ze=M.vertexLength;this.indexArray.emplaceBack(ze,ze+2,ze+1),this.indexArray.emplaceBack(ze+1,ze+2,ze+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+I>or.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),tF[s.type]!=="Polygon")continue;const B=[],U=[],H=M.vertexLength;for(const J of T)if(J.length!==0){J!==T[0]&&U.push(B.length/2);for(let ae=0;ae<J.length;ae++){const me=J[ae];Uf(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),w.x+=me.x,w.y+=me.y,w.vertexCount+=1,B.push(me.x),B.push(me.y)}}const Y=NT(B,U);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack(H+Y[J],H+Y[J+2],H+Y[J+1]);M.primitiveLength+=Y.length/3,M.vertexLength+=I}for(let T=0;T<w.vertexCount;T++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}function nF(c,s){return c.x===s.x&&(c.x<0||c.x>$r)||c.y===s.y&&(c.y<0||c.y>$r)}function rF(c){return c.every(s=>s.x<0)||c.every(s=>s.x>$r)||c.every(s=>s.y<0)||c.every(s=>s.y>$r)}let WT;kt("FillExtrusionBucket",px,{omit:["layers","features"]});var iF={get paint(){return WT=WT||new Rr({"fill-extrusion-opacity":new Gt(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nn(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wc(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nn(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nn(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gt(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class sF extends ks{constructor(s){super(s,iF)}createBucket(s){return new px(s)}queryRadius(){return Bg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,u,f,g,x,w,T,I){const M=jg(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,T),B=this.paint.get("fill-extrusion-height").evaluate(u,f),U=this.paint.get("fill-extrusion-base").evaluate(u,f),H=function(J,ae,me,ve){const ke=[];for(const Se of J){const Le=[Se.x,Se.y,0,1];Vg(Le,Le,ae),ke.push(new A(Le[0]/Le[3],Le[1]/Le[3]))}return ke}(M,I),Y=function(J,ae,me,ve){const ke=[],Se=[],Le=ve[8]*ae,ze=ve[9]*ae,Je=ve[10]*ae,wt=ve[11]*ae,Dt=ve[8]*me,vt=ve[9]*me,gt=ve[10]*me,dt=ve[11]*me;for(const Mt of J){const pt=[],it=[];for(const Jt of Mt){const jt=Jt.x,Sn=Jt.y,ar=ve[0]*jt+ve[4]*Sn+ve[12],fr=ve[1]*jt+ve[5]*Sn+ve[13],ti=ve[2]*jt+ve[6]*Sn+ve[14],Ls=ve[3]*jt+ve[7]*Sn+ve[15],Yi=ti+Je,Gr=Ls+wt,gi=ar+Dt,Ti=fr+vt,Ki=ti+gt,Ji=Ls+dt,ni=new A((ar+Le)/Gr,(fr+ze)/Gr);ni.z=Yi/Gr,pt.push(ni);const ri=new A(gi/Ji,Ti/Ji);ri.z=Ki/Ji,it.push(ri)}ke.push(pt),Se.push(it)}return[ke,Se]}(g,U,B,I);return function(J,ae,me){let ve=1/0;wT(me,ae)&&(ve=HT(me,ae[0]));for(let ke=0;ke<ae.length;ke++){const Se=ae[ke],Le=J[ke];for(let ze=0;ze<Se.length-1;ze++){const Je=Se[ze],wt=[Je,Se[ze+1],Le[ze+1],Le[ze],Je];bT(me,wt)&&(ve=Math.min(ve,HT(me,wt)))}}return ve!==1/0&&ve}(Y[0],Y[1],H)}}function $f(c,s){return c.x*s.x+c.y*s.y}function HT(c,s){if(c.length===1){let u=0;const f=s[u++];let g;for(;!g||f.equals(g);)if(g=s[u++],!g)return 1/0;for(;u<s.length;u++){const x=s[u],w=c[0],T=g.sub(f),I=x.sub(f),M=w.sub(f),B=$f(T,T),U=$f(T,I),H=$f(I,I),Y=$f(M,T),J=$f(M,I),ae=B*H-U*U,me=(H*Y-U*J)/ae,ve=(B*J-U*Y)/ae,ke=f.z*(1-me-ve)+g.z*me+x.z*ve;if(isFinite(ke))return ke}return 1/0}{let u=1/0;for(const f of s)u=Math.min(u,f.z);return u}}const oF=yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:aF}=oF,lF=yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:cF}=lF,uF=Bl.VectorTileFeature.types,hF=Math.cos(Math.PI/180*37.5),qT=Math.pow(2,14)/.5;class mx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new rn,this.layoutVertexArray2=new Nt,this.indexArray=new pi,this.programConfigurations=new Xo(s.layers,s.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=ux("line",this.layers,u);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),w=[];for(const{feature:T,id:I,index:M,sourceLayerIndex:B}of s){const U=this.layers[0]._featureFilter.needGeometry,H=Xc(T,U);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f):void 0,J={id:I,properties:T.properties,type:T.type,sourceLayerIndex:B,index:M,geometry:U?H.geometry:Zc(T),patterns:{},sortKey:Y};w.push(J)}x&&w.sort((T,I)=>T.sortKey-I.sortKey);for(const T of w){const{geometry:I,index:M,sourceLayerIndex:B}=T;if(this.hasPattern){const U=hx("line",this.layers,T,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(T,I,M,f,{});u.featureIndex.insert(s[M].feature,I,M,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,cF)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,aF),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,f,g,x){const w=this.layers[0].layout,T=w.get("line-join").evaluate(s,{}),I=w.get("line-cap"),M=w.get("line-miter-limit"),B=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const U of u)this.addLine(U,s,T,I,M,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}addLine(s,u,f,g,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ve=0;ve<s.length-1;ve++)this.totalDistance+=s[ve].dist(s[ve+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=uF[u.type]==="Polygon";let I=s.length;for(;I>=2&&s[I-1].equals(s[I-2]);)I--;let M=0;for(;M<I-1&&s[M].equals(s[M+1]);)M++;if(I<(T?3:2))return;f==="bevel"&&(x=1.05);const B=this.overscaling<=16?15*$r/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let H,Y,J,ae,me;this.e1=this.e2=-1,T&&(H=s[I-2],me=s[M].sub(H)._unit()._perp());for(let ve=M;ve<I;ve++){if(J=ve===I-1?T?s[M+1]:void 0:s[ve+1],J&&s[ve].equals(J))continue;me&&(ae=me),H&&(Y=H),H=s[ve],me=J?J.sub(H)._unit()._perp():ae,ae=ae||me;let ke=ae.add(me);ke.x===0&&ke.y===0||ke._unit();const Se=ae.x*me.x+ae.y*me.y,Le=ke.x*me.x+ke.y*me.y,ze=Le!==0?1/Le:1/0,Je=2*Math.sqrt(2-2*Le),wt=Le<hF&&Y&&J,Dt=ae.x*me.y-ae.y*me.x>0;if(wt&&ve>M){const dt=H.dist(Y);if(dt>2*B){const Mt=H.sub(H.sub(Y)._mult(B/dt)._round());this.updateDistance(Y,Mt),this.addCurrentVertex(Mt,ae,0,0,U),Y=Mt}}const vt=Y&&J;let gt=vt?f:T?"butt":g;if(vt&&gt==="round"&&(ze<w?gt="miter":ze<=2&&(gt="fakeround")),gt==="miter"&&ze>x&&(gt="bevel"),gt==="bevel"&&(ze>2&&(gt="flipbevel"),ze<x&&(gt="miter")),Y&&this.updateDistance(Y,H),gt==="miter")ke._mult(ze),this.addCurrentVertex(H,ke,0,0,U);else if(gt==="flipbevel"){if(ze>100)ke=me.mult(-1);else{const dt=ze*ae.add(me).mag()/ae.sub(me).mag();ke._perp()._mult(dt*(Dt?-1:1))}this.addCurrentVertex(H,ke,0,0,U),this.addCurrentVertex(H,ke.mult(-1),0,0,U)}else if(gt==="bevel"||gt==="fakeround"){const dt=-Math.sqrt(ze*ze-1),Mt=Dt?dt:0,pt=Dt?0:dt;if(Y&&this.addCurrentVertex(H,ae,Mt,pt,U),gt==="fakeround"){const it=Math.round(180*Je/Math.PI/20);for(let Jt=1;Jt<it;Jt++){let jt=Jt/it;if(jt!==.5){const ar=jt-.5;jt+=jt*ar*(jt-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*ar*ar+(.848013+Se*(.215638*Se-1.06021)))}const Sn=me.sub(ae)._mult(jt)._add(ae)._unit()._mult(Dt?-1:1);this.addHalfVertex(H,Sn.x,Sn.y,!1,Dt,0,U)}}J&&this.addCurrentVertex(H,me,-Mt,-pt,U)}else if(gt==="butt")this.addCurrentVertex(H,ke,0,0,U);else if(gt==="square"){const dt=Y?1:-1;this.addCurrentVertex(H,ke,dt,dt,U)}else gt==="round"&&(Y&&(this.addCurrentVertex(H,ae,0,0,U),this.addCurrentVertex(H,ae,1,1,U,!0)),J&&(this.addCurrentVertex(H,me,-1,-1,U,!0),this.addCurrentVertex(H,me,0,0,U)));if(wt&&ve<I-1){const dt=H.dist(J);if(dt>2*B){const Mt=H.add(J.sub(H)._mult(B/dt)._round());this.updateDistance(H,Mt),this.addCurrentVertex(Mt,me,0,0,U),H=Mt}}}}addCurrentVertex(s,u,f,g,x,w=!1){const T=u.y*g-u.x,I=-u.y-u.x*g;this.addHalfVertex(s,u.x+u.y*f,u.y-u.x*f,w,!1,f,x),this.addHalfVertex(s,T,I,w,!0,-g,x),this.distance>qT/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,u,f,g,x,w))}addHalfVertex({x:s,y:u},f,g,x,w,T,I){const M=.5*(this.lineClips?this.scaledDistance*(qT-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(u<<1)+(w?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),I.primitiveLength++),w?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,u){this.distance+=s.dist(u),this.updateScaledDistance()}}let ZT,XT;kt("LineBucket",mx,{omit:["layers","patternFeatures"]});var YT={get paint(){return XT=XT||new Rr({"line-opacity":new nn(Ae.paint_line["line-opacity"]),"line-color":new nn(Ae.paint_line["line-color"]),"line-translate":new Gt(Ae.paint_line["line-translate"]),"line-translate-anchor":new Gt(Ae.paint_line["line-translate-anchor"]),"line-width":new nn(Ae.paint_line["line-width"]),"line-gap-width":new nn(Ae.paint_line["line-gap-width"]),"line-offset":new nn(Ae.paint_line["line-offset"]),"line-blur":new nn(Ae.paint_line["line-blur"]),"line-dasharray":new Pf(Ae.paint_line["line-dasharray"]),"line-pattern":new Wc(Ae.paint_line["line-pattern"]),"line-gradient":new Cf(Ae.paint_line["line-gradient"])})},get layout(){return ZT=ZT||new Rr({"line-cap":new Gt(Ae.layout_line["line-cap"]),"line-join":new nn(Ae.layout_line["line-join"]),"line-miter-limit":new Gt(Ae.layout_line["line-miter-limit"]),"line-round-limit":new Gt(Ae.layout_line["line-round-limit"]),"line-sort-key":new nn(Ae.layout_line["line-sort-key"])})}};class dF extends nn{possiblyEvaluate(s,u){return u=new sr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,f,g){return u=xe({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,f,g)}}let Hg;class fF extends ks{constructor(s){super(s,YT),this.gradientVersion=0,Hg||(Hg=new dF(YT.paint.properties["line-width"].specification),Hg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof fa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,u){super.recalculate(s,u),this.paint._values["line-floorwidth"]=Hg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new mx(s)}queryRadius(s){const u=s,f=KT(zf("line-width",this,u),zf("line-gap-width",this,u)),g=zf("line-offset",this,u);return f/2+Math.abs(g)+Bg(this.paint.get("line-translate"))}queryIntersectsFeature(s,u,f,g,x,w,T){const I=jg(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,T),M=T/2*KT(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(g=function(U,H){const Y=[];for(let J=0;J<U.length;J++){const ae=U[J],me=[];for(let ve=0;ve<ae.length;ve++){const ke=ae[ve-1],Se=ae[ve],Le=ae[ve+1],ze=ve===0?new A(0,0):Se.sub(ke)._unit()._perp(),Je=ve===ae.length-1?new A(0,0):Le.sub(Se)._unit()._perp(),wt=ze._add(Je)._unit(),Dt=wt.x*Je.x+wt.y*Je.y;Dt!==0&&wt._mult(1/Dt),me.push(wt._mult(H)._add(Se))}Y.push(me)}return Y}(g,B*T)),function(U,H,Y){for(let J=0;J<H.length;J++){const ae=H[J];if(U.length>=3){for(let me=0;me<ae.length;me++)if(uh(U,ae[me]))return!0}if(vD(U,ae,Y))return!0}return!1}(I,g,M)}isTileClipped(){return!0}}function KT(c,s){return s>0?s+2*c:c}const pF=yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mF=yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gF=yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const JT=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yF=yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function _F(c,s,u){return c.sections.forEach(f=>{f.text=function(g,x,w){const T=x.layout.get("text-transform").evaluate(w,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),ps.applyArabicShaping&&(g=ps.applyArabicShaping(g)),g}(f.text,s,u)}),c}yr([{name:"triangle",components:3,type:"Uint16"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),yr([{type:"Float32",name:"offsetX"}]),yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Gf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ei=24,QT=Xn,eE=function(c,s,u,f,g){var x,w,T=8*g-f-1,I=(1<<T)-1,M=I>>1,B=-7,U=u?g-1:0,H=u?-1:1,Y=c[s+U];for(U+=H,x=Y&(1<<-B)-1,Y>>=-B,B+=T;B>0;x=256*x+c[s+U],U+=H,B-=8);for(w=x&(1<<-B)-1,x>>=-B,B+=f;B>0;w=256*w+c[s+U],U+=H,B-=8);if(x===0)x=1-M;else{if(x===I)return w?NaN:1/0*(Y?-1:1);w+=Math.pow(2,f),x-=M}return(Y?-1:1)*w*Math.pow(2,x-f)},tE=function(c,s,u,f,g,x){var w,T,I,M=8*x-g-1,B=(1<<M)-1,U=B>>1,H=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,J=f?1:-1,ae=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(T=isNaN(s)?1:0,w=B):(w=Math.floor(Math.log(s)/Math.LN2),s*(I=Math.pow(2,-w))<1&&(w--,I*=2),(s+=w+U>=1?H/I:H*Math.pow(2,1-U))*I>=2&&(w++,I/=2),w+U>=B?(T=0,w=B):w+U>=1?(T=(s*I-1)*Math.pow(2,g),w+=U):(T=s*Math.pow(2,U-1)*Math.pow(2,g),w=0));g>=8;c[u+Y]=255&T,Y+=J,T/=256,g-=8);for(w=w<<g|T,M+=g;M>0;c[u+Y]=255&w,Y+=J,w/=256,M-=8);c[u+Y-J]|=128*ae};function Xn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var gx=4294967296,nE=1/gx,rE=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ka(c){return c.type===Xn.Bytes?c.readVarint()+c.pos:c.pos+1}function ph(c,s,u){return u?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function iE(c,s,u){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function vF(c,s){for(var u=0;u<c.length;u++)s.writeVarint(c[u])}function xF(c,s){for(var u=0;u<c.length;u++)s.writeSVarint(c[u])}function bF(c,s){for(var u=0;u<c.length;u++)s.writeFloat(c[u])}function wF(c,s){for(var u=0;u<c.length;u++)s.writeDouble(c[u])}function SF(c,s){for(var u=0;u<c.length;u++)s.writeBoolean(c[u])}function TF(c,s){for(var u=0;u<c.length;u++)s.writeFixed32(c[u])}function EF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed32(c[u])}function PF(c,s){for(var u=0;u<c.length;u++)s.writeFixed64(c[u])}function CF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed64(c[u])}function qg(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function mh(c,s,u){c[u]=s,c[u+1]=s>>>8,c[u+2]=s>>>16,c[u+3]=s>>>24}function sE(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}Xn.prototype={destroy:function(){this.buf=null},readFields:function(c,s,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,c(g,s,this),this.pos===x&&this.skip(f)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=qg(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=sE(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=qg(this.buf,this.pos)+qg(this.buf,this.pos+4)*gx;return this.pos+=8,c},readSFixed64:function(){var c=qg(this.buf,this.pos)+sE(this.buf,this.pos+4)*gx;return this.pos+=8,c},readFloat:function(){var c=eE(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=eE(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,u,f=this.buf;return s=127&(u=f[this.pos++]),u<128?s:(s|=(127&(u=f[this.pos++]))<<7,u<128?s:(s|=(127&(u=f[this.pos++]))<<14,u<128?s:(s|=(127&(u=f[this.pos++]))<<21,u<128?s:function(g,x,w){var T,I,M=w.buf;if(T=(112&(I=M[w.pos++]))>>4,I<128||(T|=(127&(I=M[w.pos++]))<<3,I<128)||(T|=(127&(I=M[w.pos++]))<<10,I<128)||(T|=(127&(I=M[w.pos++]))<<17,I<128)||(T|=(127&(I=M[w.pos++]))<<24,I<128)||(T|=(1&(I=M[w.pos++]))<<31,I<128))return ph(g,T,x);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&rE?function(u,f,g){return rE.decode(u.subarray(f,g))}(this.buf,s,c):function(u,f,g){for(var x="",w=f;w<g;){var T,I,M,B=u[w],U=null,H=B>239?4:B>223?3:B>191?2:1;if(w+H>g)break;H===1?B<128&&(U=B):H===2?(192&(T=u[w+1]))==128&&(U=(31&B)<<6|63&T)<=127&&(U=null):H===3?(I=u[w+2],(192&(T=u[w+1]))==128&&(192&I)==128&&((U=(15&B)<<12|(63&T)<<6|63&I)<=2047||U>=55296&&U<=57343)&&(U=null)):H===4&&(I=u[w+2],M=u[w+3],(192&(T=u[w+1]))==128&&(192&I)==128&&(192&M)==128&&((U=(15&B)<<18|(63&T)<<12|(63&I)<<6|63&M)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,H=1):U>65535&&(U-=65536,x+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),x+=String.fromCharCode(U),w+=H}return x}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Xn.Bytes)return c.push(this.readVarint(s));var u=Ka(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSVarint());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Xn.Bytes)return c.push(this.readBoolean());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFloat());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Xn.Bytes)return c.push(this.readDouble());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed32());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed32());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed64());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed64());var s=Ka(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Xn.Fixed32)this.pos+=4;else{if(s!==Xn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var u=new Uint8Array(s);u.set(this.buf),this.buf=u,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),mh(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),mh(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),mh(this.buf,-1&c,this.pos),mh(this.buf,Math.floor(c*nE),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),mh(this.buf,-1&c,this.pos),mh(this.buf,Math.floor(c*nE),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,u){var f,g;if(s>=0?(f=s%4294967296|0,g=s/4294967296|0):(g=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,g=g+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,w,T){T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,x>>>=7,T.buf[T.pos++]=127&x|128,T.buf[T.pos]=127&(x>>>=7)}(f,0,u),function(x,w){var T=(7&x)<<4;w.buf[w.pos++]|=T|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(f,g,x){for(var w,T,I=0;I<g.length;I++){if((w=g.charCodeAt(I))>55295&&w<57344){if(!T){w>56319||I+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):T=w;continue}if(w<56320){f[x++]=239,f[x++]=191,f[x++]=189,T=w;continue}w=T-55296<<10|w-56320|65536,T=null}else T&&(f[x++]=239,f[x++]=191,f[x++]=189,T=null);w<128?f[x++]=w:(w<2048?f[x++]=w>>6|192:(w<65536?f[x++]=w>>12|224:(f[x++]=w>>18|240,f[x++]=w>>12&63|128),f[x++]=w>>6&63|128),f[x++]=63&w|128)}return x}(this.buf,c,this.pos);var u=this.pos-s;u>=128&&iE(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),tE(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),tE(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var u=0;u<s;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,s){this.pos++;var u=this.pos;c(s,this);var f=this.pos-u;f>=128&&iE(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,s,u){this.writeTag(c,Xn.Bytes),this.writeRawMessage(s,u)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,vF,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,xF,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,SF,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,bF,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,wF,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,TF,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,EF,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,PF,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,CF,s)},writeBytesField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var yx=_(QT);const _x=3;function AF(c,s,u){c===1&&u.readMessage(IF,s)}function IF(c,s,u){if(c===3){const{id:f,bitmap:g,width:x,height:w,left:T,top:I,advance:M}=u.readMessage(kF,{});s.push({id:f,bitmap:new Ff({width:x+2*_x,height:w+2*_x},g),metrics:{width:x,height:w,left:T,top:I,advance:M}})}}function kF(c,s,u){c===1?s.id=u.readVarint():c===2?s.bitmap=u.readBytes():c===3?s.width=u.readVarint():c===4?s.height=u.readVarint():c===5?s.left=u.readSVarint():c===6?s.top=u.readSVarint():c===7&&(s.advance=u.readVarint())}const oE=_x;function aE(c){let s=0,u=0;for(const w of c)s+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,T)=>T.h-w.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let g=0,x=0;for(const w of c)for(let T=f.length-1;T>=0;T--){const I=f[T];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,x=Math.max(x,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===I.w&&w.h===I.h){const M=f.pop();T<f.length&&(f[T]=M)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(f.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:g,h:x,fill:s/(g*x)||0}}const gs=1;class vx{constructor(s,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:w}){this.paddedRect=s,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=w,this.version=f}get tl(){return[this.paddedRect.x+gs,this.paddedRect.y+gs]}get br(){return[this.paddedRect.x+this.paddedRect.w-gs,this.paddedRect.y+this.paddedRect.h-gs]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*gs)/this.pixelRatio,(this.paddedRect.h-2*gs)/this.pixelRatio]}}class lE{constructor(s,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,f,x),this.addImages(u,g,x);const{w,h:T}=aE(x),I=new $s({width:w||1,height:T||1});for(const M in s){const B=s[M],U=f[M].paddedRect;$s.copy(B.data,I,{x:0,y:0},{x:U.x+gs,y:U.y+gs},B.data)}for(const M in u){const B=u[M],U=g[M].paddedRect,H=U.x+gs,Y=U.y+gs,J=B.data.width,ae=B.data.height;$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y},B.data),$s.copy(B.data,I,{x:0,y:ae-1},{x:H,y:Y-1},{width:J,height:1}),$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y+ae},{width:J,height:1}),$s.copy(B.data,I,{x:J-1,y:0},{x:H-1,y:Y},{width:1,height:ae}),$s.copy(B.data,I,{x:0,y:0},{x:H+J,y:Y},{width:1,height:ae})}this.image=I,this.iconPositions=f,this.patternPositions=g}addImages(s,u,f){for(const g in s){const x=s[g],w={x:0,y:0,w:x.data.width+2*gs,h:x.data.height+2*gs};f.push(w),u[g]=new vx(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(s,u){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),u)}patchUpdatedImage(s,u,f){if(!s||!u||s.version===u.version)return;s.version=u.version;const[g,x]=s.tl;f.update(u.data,void 0,{x:g,y:x})}}var jl;kt("ImagePosition",vx),kt("ImageAtlas",lE),l.ai=void 0,(jl=l.ai||(l.ai={}))[jl.none=0]="none",jl[jl.horizontal=1]="horizontal",jl[jl.vertical=2]="vertical",jl[jl.horizontalOnly=3]="horizontalOnly";const Wf=-17;class Hf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,u){const f=new Hf;return f.scale=s||1,f.fontStack=u,f}static forImage(s){const u=new Hf;return u.imageName=s,u}}class gh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const f=new gh;for(let g=0;g<s.sections.length;g++){const x=s.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let u="";for(let f=0;f<s.length;f++){const g=s.charCodeAt(f+1)||null,x=s.charCodeAt(f-1)||null;u+=g&&Ag(g)&&!Gf[s[f+1]]||x&&Ag(x)&&!Gf[s[f-1]]||!Gf[s[f]]?s[f]:Gf[s[f]]}return u}(this.text)}trim(){let s=0;for(let f=0;f<this.text.length&&Xg[this.text.charCodeAt(f)];f++)s++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&Xg[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const f=new gh;return f.text=this.text.substring(s,u),f.sectionIndex=this.sectionIndex.slice(s,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(Hf.forText(s.scale,s.fontStack||u));const f=this.sections.length-1;for(let g=0;g<s.text.length;++g)this.sectionIndex.push(f)}addImageSection(s){const u=s.image?s.image.name:"";if(u.length===0)return void je("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Hf.forImage(u)),this.sectionIndex.push(this.sections.length-1)):je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Zg(c,s,u,f,g,x,w,T,I,M,B,U,H,Y,J,ae){const me=gh.fromFeature(c,g);let ve;U===l.ai.vertical&&me.verticalizePunctuation();const{processBidirectionalText:ke,processStyledBidirectionalText:Se}=ps;if(ke&&me.sections.length===1){ve=[];const Je=ke(me.toString(),xx(me,M,x,s,f,Y,J));for(const wt of Je){const Dt=new gh;Dt.text=wt,Dt.sections=me.sections;for(let vt=0;vt<wt.length;vt++)Dt.sectionIndex.push(0);ve.push(Dt)}}else if(Se){ve=[];const Je=Se(me.text,me.sectionIndex,xx(me,M,x,s,f,Y,J));for(const wt of Je){const Dt=new gh;Dt.text=wt[0],Dt.sectionIndex=wt[1],Dt.sections=me.sections,ve.push(Dt)}}else ve=function(Je,wt){const Dt=[],vt=Je.text;let gt=0;for(const dt of wt)Dt.push(Je.substring(gt,dt)),gt=dt;return gt<vt.length&&Dt.push(Je.substring(gt,vt.length)),Dt}(me,xx(me,M,x,s,f,Y,J));const Le=[],ze={positionedLines:Le,text:me.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(Je,wt,Dt,vt,gt,dt,Mt,pt,it,Jt,jt,Sn){let ar=0,fr=Wf,ti=0,Ls=0;const Yi=pt==="right"?1:pt==="left"?0:.5;let Gr=0;for(const ni of gt){ni.trim();const ri=ni.getMaxScale(),Ri=(ri-1)*ei,Qi={positionedGlyphs:[],lineOffset:0};Je.positionedLines[Gr]=Qi;const Oi=Qi.positionedGlyphs;let ys=0;if(!ni.length()){fr+=dt,++Gr;continue}for(let ii=0;ii<ni.length();ii++){const kn=ni.getSection(ii),zi=ni.getSectionIndex(ii),Ei=ni.getCharCode(ii);let si=0,wo=null,Yo=null,Ko=null,Ja=ei;const So=!(it===l.ai.horizontal||!jt&&!_f(Ei)||jt&&(Xg[Ei]||(gi=Ei,bt.Arabic(gi)||bt["Arabic Supplement"](gi)||bt["Arabic Extended-A"](gi)||bt["Arabic Presentation Forms-A"](gi)||bt["Arabic Presentation Forms-B"](gi))));if(kn.imageName){const Ws=vt[kn.imageName];if(!Ws)continue;Ko=kn.imageName,Je.iconsInText=Je.iconsInText||!0,Yo=Ws.paddedRect;const vs=Ws.displaySize;kn.scale=kn.scale*ei/Sn,wo={width:vs[0],height:vs[1],left:gs,top:-oE,advance:So?vs[1]:vs[0]},si=Ri+(ei-vs[1]*kn.scale),Ja=wo.advance;const Qa=So?vs[0]*kn.scale-ei*ri:vs[1]*kn.scale-ei*ri;Qa>0&&Qa>ys&&(ys=Qa)}else{const Ws=Dt[kn.fontStack],vs=Ws&&Ws[Ei];if(vs&&vs.rect)Yo=vs.rect,wo=vs.metrics;else{const Qa=wt[kn.fontStack],Kf=Qa&&Qa[Ei];if(!Kf)continue;wo=Kf.metrics}si=(ri-kn.scale)*ei}So?(Je.verticalizable=!0,Oi.push({glyph:Ei,imageName:Ko,x:ar,y:fr+si,vertical:So,scale:kn.scale,fontStack:kn.fontStack,sectionIndex:zi,metrics:wo,rect:Yo}),ar+=Ja*kn.scale+Jt):(Oi.push({glyph:Ei,imageName:Ko,x:ar,y:fr+si,vertical:So,scale:kn.scale,fontStack:kn.fontStack,sectionIndex:zi,metrics:wo,rect:Yo}),ar+=wo.advance*kn.scale+Jt)}Oi.length!==0&&(ti=Math.max(ar-Jt,ti),RF(Oi,0,Oi.length-1,Yi,ys)),ar=0;const _s=dt*ri+ys;Qi.lineOffset=Math.max(ys,Ri),fr+=_s,Ls=Math.max(_s,Ls),++Gr}var gi;const Ti=fr-Wf,{horizontalAlign:Ki,verticalAlign:Ji}=bx(Mt);(function(ni,ri,Ri,Qi,Oi,ys,_s,ii,kn){const zi=(ri-Ri)*Oi;let Ei=0;Ei=ys!==_s?-ii*Qi-Wf:(-Qi*kn+.5)*_s;for(const si of ni)for(const wo of si.positionedGlyphs)wo.x+=zi,wo.y+=Ei})(Je.positionedLines,Yi,Ki,Ji,ti,Ls,dt,Ti,gt.length),Je.top+=-Ji*Ti,Je.bottom=Je.top+Ti,Je.left+=-Ki*ti,Je.right=Je.left+ti}(ze,s,u,f,ve,w,T,I,U,M,H,ae),!function(Je){for(const wt of Je)if(wt.positionedGlyphs.length!==0)return!1;return!0}(Le)&&ze}const Xg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cE(c,s,u,f,g,x){if(s.imageName){const w=f[s.imageName];return w?w.displaySize[0]*s.scale*ei/x+g:0}{const w=u[s.fontStack],T=w&&w[c];return T?T.metrics.advance*s.scale+g:0}}function uE(c,s,u,f){const g=Math.pow(c-s,2);return f?c<s?g/2:2*g:g+Math.abs(u)*u}function LF(c,s,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function hE(c,s,u,f,g,x){let w=null,T=uE(s,u,g,x);for(const I of f){const M=uE(s-I.x,u,g,x)+I.badness;M<=T&&(w=I,T=M)}return{index:c,x:s,priorBreak:w,badness:T}}function dE(c){return c?dE(c.priorBreak).concat(c.index):[]}function xx(c,s,u,f,g,x,w){if(x!=="point")return[];if(!c)return[];const T=[],I=function(H,Y,J,ae,me,ve){let ke=0;for(let Se=0;Se<H.length();Se++){const Le=H.getSection(Se);ke+=cE(H.getCharCode(Se),Le,ae,me,Y,ve)}return ke/Math.max(1,Math.ceil(ke/J))}(c,s,u,f,g,w),M=c.text.indexOf("")>=0;let B=0;for(let H=0;H<c.length();H++){const Y=c.getSection(H),J=c.getCharCode(H);if(Xg[J]||(B+=cE(J,Y,f,g,s,w)),H<c.length()-1){const ae=!((U=J)<11904||!(bt["Bopomofo Extended"](U)||bt.Bopomofo(U)||bt["CJK Compatibility Forms"](U)||bt["CJK Compatibility Ideographs"](U)||bt["CJK Compatibility"](U)||bt["CJK Radicals Supplement"](U)||bt["CJK Strokes"](U)||bt["CJK Symbols and Punctuation"](U)||bt["CJK Unified Ideographs Extension A"](U)||bt["CJK Unified Ideographs"](U)||bt["Enclosed CJK Letters and Months"](U)||bt["Halfwidth and Fullwidth Forms"](U)||bt.Hiragana(U)||bt["Ideographic Description Characters"](U)||bt["Kangxi Radicals"](U)||bt["Katakana Phonetic Extensions"](U)||bt.Katakana(U)||bt["Vertical Forms"](U)||bt["Yi Radicals"](U)||bt["Yi Syllables"](U)));(MF[J]||ae||Y.imageName)&&T.push(hE(H+1,B,I,T,LF(J,c.getCharCode(H+1),ae&&M),!1))}}var U;return dE(hE(c.length(),B,I,T,0,!0))}function bx(c){let s=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function RF(c,s,u,f,g){if(!f&&!g)return;const x=c[u],w=(c[u].x+x.metrics.advance*x.scale)*f;for(let T=s;T<=u;T++)c[T].x-=w,c[T].y+=g}function OF(c,s,u){const{horizontalAlign:f,verticalAlign:g}=bx(u),x=s[0]-c.displaySize[0]*f,w=s[1]-c.displaySize[1]*g;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function fE(c,s,u,f,g,x){const w=c.image;let T;if(w.content){const me=w.content,ve=w.pixelRatio||1;T=[me[0]/ve,me[1]/ve,w.displaySize[0]-me[2]/ve,w.displaySize[1]-me[3]/ve]}const I=s.left*x,M=s.right*x;let B,U,H,Y;u==="width"||u==="both"?(Y=g[0]+I-f[3],U=g[0]+M+f[1]):(Y=g[0]+(I+M-w.displaySize[0])/2,U=Y+w.displaySize[0]);const J=s.top*x,ae=s.bottom*x;return u==="height"||u==="both"?(B=g[1]+J-f[0],H=g[1]+ae+f[2]):(B=g[1]+(J+ae-w.displaySize[1])/2,H=B+w.displaySize[1]),{image:w,top:B,right:U,bottom:H,left:Y,collisionPadding:T}}const qf=255,_a=128,Vl=qf*_a;function pE(c,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new sr(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<f.length&&f[w]<c+1;)w++;w=Math.min(f.length-1,w);const T=f[x],I=f[w];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:I,minSize:u.evaluate(new sr(T)),maxSize:u.evaluate(new sr(I)),interpolationType:g}}}function wx(c,s,u){let f="never";const g=c.get(s);return g?f=g:c.get(u)&&(f="always"),f}const zF=Bl.VectorTileFeature.types,DF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yg(c,s,u,f,g,x,w,T,I,M,B,U,H){const Y=T?Math.min(Vl,Math.round(T[0])):0,J=T?Math.min(Vl,Math.round(T[1])):0;c.emplaceBack(s,u,Math.round(32*f),Math.round(32*g),x,w,(Y<<1)+(I?1:0),J,16*M,16*B,256*U,256*H)}function Sx(c,s,u){c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u)}function FF(c){for(const s of c.sections)if(Xv(s.text))return!0;return!1}class Tx{constructor(s){this.layoutVertexArray=new En,this.indexArray=new pi,this.programConfigurations=s,this.segments=new or,this.dynamicLayoutVertexArray=new xn,this.opacityVertexArray=new An,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,pF.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,mF.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,DF,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",Tx);class Ex{constructor(s,u,f){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new f,this.segments=new or,this.collisionVertexArray=new er}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,gF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",Ex);class yh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=nx([]),this.placementViewportMatrix=nx([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pE(this.zoom,u["text-size"]),this.iconSizeData=pE(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=wx(f,"text-overlap","text-allow-overlap")!=="never"||wx(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(w=>l.ai[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID}createArrays(){this.text=new Tx(new Xo(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new Tx(new Xo(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ie,this.lineVertexArray=new De,this.symbolInstances=new ge,this.textAnchorOffsets=new Ke}calculateGlyphDependencies(s,u,f,g,x){for(let w=0;w<s.length;w++)if(u[s.charCodeAt(w)]=!0,(f||g)&&x){const T=Gf[s.charAt(w)];T&&(u[T.charCodeAt(0)]=!0)}}populate(s,u,f){const g=this.layers[0],x=g.layout,w=x.get("text-font"),T=x.get("text-field"),I=x.get("icon-image"),M=(T.value.kind!=="constant"||T.value.value instanceof ir&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),B=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,U=x.get("symbol-sort-key");if(this.features=[],!M&&!B)return;const H=u.iconDependencies,Y=u.glyphDependencies,J=u.availableImages,ae=new sr(this.zoom);for(const{feature:me,id:ve,index:ke,sourceLayerIndex:Se}of s){const Le=g._featureFilter.needGeometry,ze=Xc(me,Le);if(!g._featureFilter.filter(ae,ze,f))continue;let Je,wt;if(Le||(ze.geometry=Zc(me)),M){const vt=g.getValueAndResolveTokens("text-field",ze,f,J),gt=ir.factory(vt);FF(gt)&&(this.hasRTLText=!0),(!this.hasRTLText||Tf()==="unavailable"||this.hasRTLText&&ps.isParsed())&&(Je=_F(gt,g,ze))}if(B){const vt=g.getValueAndResolveTokens("icon-image",ze,f,J);wt=vt instanceof Zn?vt:Zn.fromString(vt)}if(!Je&&!wt)continue;const Dt=this.sortFeaturesByKey?U.evaluate(ze,{},f):void 0;if(this.features.push({id:ve,text:Je,icon:wt,index:ke,sourceLayerIndex:Se,geometry:ze.geometry,properties:me.properties,type:zF[me.type],sortKey:Dt}),wt&&(H[wt.name]=!0),Je){const vt=w.evaluate(ze,{},f).join(","),gt=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ai.vertical)>=0;for(const dt of Je.sections)if(dt.image)H[dt.image.name]=!0;else{const Mt=gf(Je.toString()),pt=dt.fontStack||vt,it=Y[pt]=Y[pt]||{};this.calculateGlyphDependencies(dt.text,it,gt,this.allowVerticalPlacement,Mt)}}}x.get("symbol-placement")==="line"&&(this.features=function(me){const ve={},ke={},Se=[];let Le=0;function ze(vt){Se.push(me[vt]),Le++}function Je(vt,gt,dt){const Mt=ke[vt];return delete ke[vt],ke[gt]=Mt,Se[Mt].geometry[0].pop(),Se[Mt].geometry[0]=Se[Mt].geometry[0].concat(dt[0]),Mt}function wt(vt,gt,dt){const Mt=ve[gt];return delete ve[gt],ve[vt]=Mt,Se[Mt].geometry[0].shift(),Se[Mt].geometry[0]=dt[0].concat(Se[Mt].geometry[0]),Mt}function Dt(vt,gt,dt){const Mt=dt?gt[0][gt[0].length-1]:gt[0][0];return`${vt}:${Mt.x}:${Mt.y}`}for(let vt=0;vt<me.length;vt++){const gt=me[vt],dt=gt.geometry,Mt=gt.text?gt.text.toString():null;if(!Mt){ze(vt);continue}const pt=Dt(Mt,dt),it=Dt(Mt,dt,!0);if(pt in ke&&it in ve&&ke[pt]!==ve[it]){const Jt=wt(pt,it,dt),jt=Je(pt,it,Se[Jt].geometry);delete ve[pt],delete ke[it],ke[Dt(Mt,Se[jt].geometry,!0)]=jt,Se[Jt].geometry=null}else pt in ke?Je(pt,it,dt):it in ve?wt(pt,it,dt):(ze(vt),ve[pt]=Le-1,ke[it]=Le-1)}return Se.filter(vt=>vt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,ve)=>me.sortKey-ve.sortKey)}update(s,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(s,u,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const f=this.lineVertexArray.length;if(s.segment!==void 0){let g=s.dist(u[s.segment+1]),x=s.dist(u[s.segment]);const w={};for(let T=s.segment+1;T<u.length;T++)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:g},T<u.length-1&&(g+=u[T+1].dist(u[T]));for(let T=s.segment||0;T>=0;T--)w[T]={x:u[T].x,y:u[T].y,tileUnitDistanceFromAnchor:x},T>0&&(x+=u[T-1].dist(u[T]));for(let T=0;T<u.length;T++){const I=w[T];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,u,f,g,x,w,T,I,M,B,U,H){const Y=s.indexArray,J=s.layoutVertexArray,ae=s.segments.prepareSegment(4*u.length,J,Y,this.canOverlap?w.sortKey:void 0),me=this.glyphOffsetArray.length,ve=ae.vertexLength,ke=this.allowVerticalPlacement&&T===l.ai.vertical?Math.PI/2:0,Se=w.text&&w.text.sections;for(let Le=0;Le<u.length;Le++){const{tl:ze,tr:Je,bl:wt,br:Dt,tex:vt,pixelOffsetTL:gt,pixelOffsetBR:dt,minFontScaleX:Mt,minFontScaleY:pt,glyphOffset:it,isSDF:Jt,sectionIndex:jt}=u[Le],Sn=ae.vertexLength,ar=it[1];Yg(J,I.x,I.y,ze.x,ar+ze.y,vt.x,vt.y,f,Jt,gt.x,gt.y,Mt,pt),Yg(J,I.x,I.y,Je.x,ar+Je.y,vt.x+vt.w,vt.y,f,Jt,dt.x,gt.y,Mt,pt),Yg(J,I.x,I.y,wt.x,ar+wt.y,vt.x,vt.y+vt.h,f,Jt,gt.x,dt.y,Mt,pt),Yg(J,I.x,I.y,Dt.x,ar+Dt.y,vt.x+vt.w,vt.y+vt.h,f,Jt,dt.x,dt.y,Mt,pt),Sx(s.dynamicLayoutVertexArray,I,ke),Y.emplaceBack(Sn,Sn+1,Sn+2),Y.emplaceBack(Sn+1,Sn+2,Sn+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),Le!==u.length-1&&jt===u[Le+1].sectionIndex||s.programConfigurations.populatePaintArrays(J.length,w,w.index,{},H,Se&&Se[jt])}s.placedSymbolArray.emplaceBack(I.x,I.y,me,this.glyphOffsetArray.length-me,ve,M,B,I.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],T,0,!1,0,U)}_addCollisionDebugVertex(s,u,f,g,x,w){return u.emplaceBack(0,0),s.emplaceBack(f.x,f.y,g,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,u,f,g,x,w,T){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),M=I.vertexLength,B=x.layoutVertexArray,U=x.collisionVertexArray,H=T.anchorX,Y=T.anchorY;this._addCollisionDebugVertex(B,U,w,H,Y,new A(s,u)),this._addCollisionDebugVertex(B,U,w,H,Y,new A(f,u)),this._addCollisionDebugVertex(B,U,w,H,Y,new A(f,g)),this._addCollisionDebugVertex(B,U,w,H,Y,new A(s,g)),I.vertexLength+=4;const J=x.indexArray;J.emplaceBack(M,M+1),J.emplaceBack(M+1,M+2),J.emplaceBack(M+2,M+3),J.emplaceBack(M+3,M),I.primitiveLength+=4}addDebugCollisionBoxes(s,u,f,g){for(let x=s;x<u;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ex(Ar,JT.members,Jr),this.iconCollisionBox=new Ex(Ar,JT.members,Jr);for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(s,u,f,g,x,w,T,I,M){const B={};for(let U=u;U<f;U++){const H=s.get(U);B.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.textFeatureIndex=H.featureIndex;break}for(let U=g;U<x;U++){const H=s.get(U);B.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalTextFeatureIndex=H.featureIndex;break}for(let U=w;U<T;U++){const H=s.get(U);B.iconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.iconFeatureIndex=H.featureIndex;break}for(let U=I;U<M;U++){const H=s.get(U);B.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalIconFeatureIndex=H.featureIndex;break}return B}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,u){const f=s.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)s.indexArray.emplaceBack(x,x+1,x+2),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),f=Math.cos(s),g=[],x=[],w=[];for(let T=0;T<this.symbolInstances.length;++T){w.push(T);const I=this.symbolInstances.get(T);g.push(0|Math.round(u*I.anchorX+f*I.anchorY)),x.push(I.featureIndex)}return w.sort((T,I)=>g[T]-g[I]||x[I]-x[T]),w}addToSortKeyRanges(s,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,x,w)=>{g>=0&&w.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let mE,gE;kt("SymbolBucket",yh,{omit:["layers","collisionBoxArray","features","compareText"]}),yh.MAX_GLYPHS=65535,yh.addDynamicAttributes=Sx;var Px={get paint(){return gE=gE||new Rr({"icon-opacity":new nn(Ae.paint_symbol["icon-opacity"]),"icon-color":new nn(Ae.paint_symbol["icon-color"]),"icon-halo-color":new nn(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new nn(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nn(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new nn(Ae.paint_symbol["text-opacity"]),"text-color":new nn(Ae.paint_symbol["text-color"],{runtimeType:Pr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new nn(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new nn(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new nn(Ae.paint_symbol["text-halo-blur"]),"text-translate":new Gt(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return mE=mE||new Rr({"symbol-placement":new Gt(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nn(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Gt(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Gt(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Gt(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new nn(Ae.layout_symbol["icon-size"]),"icon-text-fit":new Gt(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gt(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new nn(Ae.layout_symbol["icon-image"]),"icon-rotate":new nn(Ae.layout_symbol["icon-rotate"]),"icon-padding":new nn(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new nn(Ae.layout_symbol["icon-offset"]),"icon-anchor":new nn(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new nn(Ae.layout_symbol["text-field"]),"text-font":new nn(Ae.layout_symbol["text-font"]),"text-size":new nn(Ae.layout_symbol["text-size"]),"text-max-width":new nn(Ae.layout_symbol["text-max-width"]),"text-line-height":new Gt(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new nn(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new nn(Ae.layout_symbol["text-justify"]),"text-radial-offset":new nn(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new nn(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new nn(Ae.layout_symbol["text-anchor"]),"text-max-angle":new Gt(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new nn(Ae.layout_symbol["text-rotate"]),"text-padding":new Gt(Ae.layout_symbol["text-padding"]),"text-keep-upright":new Gt(Ae.layout_symbol["text-keep-upright"]),"text-transform":new nn(Ae.layout_symbol["text-transform"]),"text-offset":new nn(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Gt(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Gt(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(Ae.layout_symbol["text-optional"])})}};class yE{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:pn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",yE,{omit:["defaultValue"]});class Kg extends ks{constructor(s){super(s,Px)}recalculate(s,u){if(super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,u,f,g){const x=this.layout.get(s).evaluate(u,{},f,g),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Ku(w.value)||!x?x:function(T,I){return I.replace(/{([^{}]+)}/g,(M,B)=>T&&B in T?String(T[B]):"")}(u.properties,x)}createBucket(s){return new yh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Px.paint.overridableProperties){if(!Kg.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),f=new yE(u),g=new uf(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new hf("source",g):new Qu("composite",g,u.value.zoomStops),this.paint._values[s]=new Mi(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Kg.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const f=s.get("text-field"),g=Px.paint.properties[u];let x=!1;const w=T=>{for(const I of T)if(g.overrides&&g.overrides.hasOverride(I))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ir)w(f.value.value.sections);else if(f.value.kind==="source"){const T=M=>{x||(M instanceof Us&&Jn(M.value)===he?w(M.value.sections):M instanceof Yu?w(M.sections):M.eachChild(T))},I=f.value;I._styleExpression&&T(I._styleExpression.expression)}return x}}let _E;var NF={get paint(){return _E=_E||new Rr({"background-color":new Gt(Ae.paint_background["background-color"]),"background-pattern":new Pf(Ae.paint_background["background-pattern"]),"background-opacity":new Gt(Ae.paint_background["background-opacity"])})}};class BF extends ks{constructor(s){super(s,NF)}}let vE;var jF={get paint(){return vE=vE||new Rr({"raster-opacity":new Gt(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Gt(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(Ae.paint_raster["raster-saturation"]),"raster-contrast":new Gt(Ae.paint_raster["raster-contrast"]),"raster-resampling":new Gt(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(Ae.paint_raster["raster-fade-duration"])})}};class VF extends ks{constructor(s){super(s,jF)}}class UF extends ks{constructor(s){super(s,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class $F{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Cx=63710088e-1;class Ul{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ul(ie(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,f=this.lat*u,g=s.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((s.lng-this.lng)*u);return Cx*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof Ul)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Ul(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Ul(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const xE=2*Math.PI*Cx;function bE(c){return xE*Math.cos(c*Math.PI/180)}function wE(c){return(180+c)/360}function SE(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function TE(c,s){return c/bE(s)}function EE(c){return 360*c-180}function Ax(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class Jg{constructor(s,u,f=0){this.x=+s,this.y=+u,this.z=+f}static fromLngLat(s,u=0){const f=Ul.convert(s);return new Jg(wE(f.lng),SE(f.lat),TE(u,f.lat))}toLngLat(){return new Ul(EE(this.x),Ax(this.y))}toAltitude(){return this.z*bE(Ax(this.y))}meterInMercatorCoordinateUnits(){return 1/xE*(s=Ax(this.y),1/Math.cos(s*Math.PI/180));var s}}function PE(c,s,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class Ix{constructor(s,u,f){if(s<0||s>25||f<0||f>=Math.pow(2,s)||u<0||u>=Math.pow(2,s))throw new Error(`x=${u}, y=${f}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=u,this.y=f,this.key=Zf(0,s,s,u,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u,f){const g=(w=this.y,T=this.z,I=PE(256*(x=this.x),256*(w=Math.pow(2,T)-w-1),T),M=PE(256*(x+1),256*(w+1),T),I[0]+","+I[1]+","+M[0]+","+M[1]);var x,w,T,I,M;const B=function(U,H,Y){let J,ae="";for(let me=U;me>0;me--)J=1<<me-1,ae+=(H&J?1:0)+(Y&J?2:0);return ae}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,g)}isChildOf(s){const u=this.z-s.z;return u>0&&s.x===this.x>>u&&s.y===this.y>>u}getTilePoint(s){const u=Math.pow(2,this.z);return new A((s.x*u-this.x)*$r,(s.y*u-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class CE{constructor(s,u){this.wrap=s,this.canonical=u,this.key=Zf(s,u.z,u.z,u.x,u.y)}}class Gs{constructor(s,u,f,g,x){if(s<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${f}`);this.overscaledZ=s,this.wrap=u,this.canonical=new Ix(f,+g,+x),this.key=Zf(u,s,f,g,x)}clone(){return new Gs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-s;return s>this.canonical.z?new Gs(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gs(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-s;return s>this.canonical.z?Zf(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y):Zf(this.wrap*+u,s,s,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new Gs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new Gs(u,this.wrap,u,f,g),new Gs(u,this.wrap,u,f+1,g),new Gs(u,this.wrap,u,f,g+1),new Gs(u,this.wrap,u,f+1,g+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Gs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Gs(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new CE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new Jg(s.x-this.wrap,s.y))}}function Zf(c,s,u,f,g){(c*=2)<0&&(c=-1*c-1);const x=1<<u;return(x*x*c+x*g+f).toString(36)+u.toString(36)+s.toString(36)}kt("CanonicalTileID",Ix),kt("OverscaledTileID",Gs,{omit:["posMatrix"]});class AE{constructor(s,u,f,g=1,x=1,w=1,T=0){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void je(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const I=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=x,this.blueFactor=w,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<I;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(I,M)]=this.data[this._idx(I-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,I)]=this.data[this._idx(M,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<I;M++)for(let B=0;B<I;B++){const U=this.get(M,B);U>this.max&&(this.max=U),U<this.min&&(this.min=U)}}get(s,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(s,u);return this.unpack(f[g],f[g+1],f[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}unpack(s,u,f){return s*this.redFactor+u*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new $s({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,u,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,w=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:w=T-1;break;case 1:T=w+1}const I=-u*this.dim,M=-f*this.dim;for(let B=w;B<T;B++)for(let U=g;U<x;U++)this.data[this._idx(U,B)]=s.data[this._idx(U+I,B+M)]}}kt("DEMData",AE);class IE{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const f=s[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class kE{constructor(s,u,f,g,x){this.type="Feature",this._vectorTileFeature=s,s._z=u,s._x=f,s._y=g,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(s[u]=this[u]);return s}}class ME{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Ol($r,16,0),this.grid3D=new Ol($r,16,0),this.featureIndexArray=new tt,this.promoteId=u}insert(s,u,f,g,x,w){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x);const I=w?this.grid3D:this.grid;for(let M=0;M<u.length;M++){const B=u[M],U=[1/0,1/0,-1/0,-1/0];for(let H=0;H<B.length;H++){const Y=B[H];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}U[0]<$r&&U[1]<$r&&U[2]>=0&&U[3]>=0&&I.insert(T,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Bl.VectorTile(new yx(this.rawTileData)).layers,this.sourceLayerCoder=new IE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,u,f,g){this.loadVTLayers();const x=s.params||{},w=$r/s.tileSize/s.scale,T=ff(x.filter),I=s.queryGeometry,M=s.queryPadding*w,B=RE(I),U=this.grid.query(B.minX-M,B.minY-M,B.maxX+M,B.maxY+M),H=RE(s.cameraQueryGeometry),Y=this.grid3D.query(H.minX-M,H.minY-M,H.maxX+M,H.maxY+M,(me,ve,ke,Se)=>function(Le,ze,Je,wt,Dt){for(const gt of Le)if(ze<=gt.x&&Je<=gt.y&&wt>=gt.x&&Dt>=gt.y)return!0;const vt=[new A(ze,Je),new A(ze,Dt),new A(wt,Dt),new A(wt,Je)];if(Le.length>2){for(const gt of vt)if(uh(Le,gt))return!0}for(let gt=0;gt<Le.length-1;gt++)if(bD(Le[gt],Le[gt+1],vt))return!0;return!1}(s.cameraQueryGeometry,me-M,ve-M,ke+M,Se+M));for(const me of Y)U.push(me);U.sort(GF);const J={};let ae;for(let me=0;me<U.length;me++){const ve=U[me];if(ve===ae)continue;ae=ve;const ke=this.featureIndexArray.get(ve);let Se=null;this.loadMatchingFeature(J,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,T,x.layers,x.availableImages,u,f,g,(Le,ze,Je)=>(Se||(Se=Zc(Le)),ze.queryIntersectsFeature(I,Le,Je,Se,this.z,s.transform,w,s.pixelPosMatrix)))}return J}loadMatchingFeature(s,u,f,g,x,w,T,I,M,B,U){const H=this.bucketLayerIDs[u];if(w&&!function(me,ve){for(let ke=0;ke<me.length;ke++)if(ve.indexOf(me[ke])>=0)return!0;return!1}(w,H))return;const Y=this.sourceLayerCoder.decode(f),J=this.vtLayers[Y].feature(g);if(x.needGeometry){const me=Xc(J,!0);if(!x.filter(new sr(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!x.filter(new sr(this.tileID.overscaledZ),J))return;const ae=this.getId(J,Y);for(let me=0;me<H.length;me++){const ve=H[me];if(w&&w.indexOf(ve)<0)continue;const ke=I[ve];if(!ke)continue;let Se={};ae&&B&&(Se=B.getState(ke.sourceLayer||"_geojsonTileLayer",ae));const Le=xe({},M[ve]);Le.paint=LE(Le.paint,ke.paint,J,Se,T),Le.layout=LE(Le.layout,ke.layout,J,Se,T);const ze=!U||U(J,ke,Se);if(!ze)continue;const Je=new kE(J,this.z,this.x,this.y,ae);Je.layer=Le;let wt=s[ve];wt===void 0&&(wt=s[ve]=[]),wt.push({featureIndex:g,feature:Je,intersectionZ:ze})}}lookupSymbolFeatures(s,u,f,g,x,w,T,I){const M={};this.loadVTLayers();const B=ff(x);for(const U of s)this.loadMatchingFeature(M,f,g,U,B,w,T,I,u);return M}hasLayer(s){for(const u of this.bucketLayerIDs)for(const f of u)if(s===f)return!0;return!1}getId(s,u){let f=s.id;return this.promoteId&&(f=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof f=="boolean"&&(f=Number(f))),f}}function LE(c,s,u,f,g){return _e(c,(x,w)=>{const T=s instanceof lh?s.get(w):null;return T&&T.evaluate?T.evaluate(u,f,g):T})}function RE(c){let s=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of c)s=Math.min(s,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{minX:s,minY:u,maxX:f,maxY:g}}function GF(c,s){return s-c}function OE(c,s,u,f,g){const x=[];for(let w=0;w<c.length;w++){const T=c[w];let I;for(let M=0;M<T.length-1;M++){let B=T[M],U=T[M+1];B.x<s&&U.x<s||(B.x<s?B=new A(s,B.y+(s-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x<s&&(U=new A(s,B.y+(s-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y<u&&U.y<u||(B.y<u?B=new A(B.x+(u-B.y)/(U.y-B.y)*(U.x-B.x),u)._round():U.y<u&&(U=new A(B.x+(u-B.y)/(U.y-B.y)*(U.x-B.x),u)._round()),B.x>=f&&U.x>=f||(B.x>=f?B=new A(f,B.y+(f-B.x)/(U.x-B.x)*(U.y-B.y))._round():U.x>=f&&(U=new A(f,B.y+(f-B.x)/(U.x-B.x)*(U.y-B.y))._round()),B.y>=g&&U.y>=g||(B.y>=g?B=new A(B.x+(g-B.y)/(U.y-B.y)*(U.x-B.x),g)._round():U.y>=g&&(U=new A(B.x+(g-B.y)/(U.y-B.y)*(U.x-B.x),g)._round()),I&&B.equals(I[I.length-1])||(I=[B],x.push(I)),I.push(U)))))}}return x}kt("FeatureIndex",ME,{omit:["rawTileData","sourceLayerCoder"]});class $l extends A{constructor(s,u,f,g){super(s,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new $l(this.x,this.y,this.angle,this.segment)}}function zE(c,s,u,f,g){if(s.segment===void 0||u===0)return!0;let x=s,w=s.segment+1,T=0;for(;T>-u/2;){if(w--,w<0)return!1;T-=c[w].dist(x),x=c[w]}T+=c[w].dist(c[w+1]),w++;const I=[];let M=0;for(;T<u/2;){const B=c[w],U=c[w+1];if(!U)return!1;let H=c[w-1].angleTo(B)-B.angleTo(U);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:T,angleDelta:H}),M+=H;T-I[0].distance>f;)M-=I.shift().angleDelta;if(M>g)return!1;w++,T+=B.dist(U)}return!0}function DE(c){let s=0;for(let u=0;u<c.length-1;u++)s+=c[u].dist(c[u+1]);return s}function FE(c,s,u){return c?.6*s*u:0}function NE(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function WF(c,s,u,f,g,x){const w=FE(u,g,x),T=NE(u,f)*x;let I=0;const M=DE(c)/2;for(let B=0;B<c.length-1;B++){const U=c[B],H=c[B+1],Y=U.dist(H);if(I+Y>M){const J=(M-I)/Y,ae=hs.number(U.x,H.x,J),me=hs.number(U.y,H.y,J),ve=new $l(ae,me,H.angleTo(U),B);return ve._round(),!w||zE(c,ve,T,w,s)?ve:void 0}I+=Y}}function HF(c,s,u,f,g,x,w,T,I){const M=FE(f,x,w),B=NE(f,g),U=B*w,H=c[0].x===0||c[0].x===I||c[0].y===0||c[0].y===I;return s-U<s/4&&(s=U+s/4),BE(c,H?s/2*T%s:(B/2+2*x)*w*T%s,s,M,u,U,H,!1,I)}function BE(c,s,u,f,g,x,w,T,I){const M=x/2,B=DE(c);let U=0,H=s-u,Y=[];for(let J=0;J<c.length-1;J++){const ae=c[J],me=c[J+1],ve=ae.dist(me),ke=me.angleTo(ae);for(;H+u<U+ve;){H+=u;const Se=(H-U)/ve,Le=hs.number(ae.x,me.x,Se),ze=hs.number(ae.y,me.y,Se);if(Le>=0&&Le<I&&ze>=0&&ze<I&&H-M>=0&&H+M<=B){const Je=new $l(Le,ze,ke,J);Je._round(),f&&!zE(c,Je,x,f,g)||Y.push(Je)}}U+=ve}return T||Y.length||w||(Y=BE(c,U/2,u,f,g,x,w,!0,I)),Y}kt("Anchor",$l);const _h=gs;function jE(c,s,u,f){const g=[],x=c.image,w=x.pixelRatio,T=x.paddedRect.w-2*_h,I=x.paddedRect.h-2*_h,M=c.right-c.left,B=c.bottom-c.top,U=x.stretchX||[[0,T]],H=x.stretchY||[[0,I]],Y=(dt,Mt)=>dt+Mt[1]-Mt[0],J=U.reduce(Y,0),ae=H.reduce(Y,0),me=T-J,ve=I-ae;let ke=0,Se=J,Le=0,ze=ae,Je=0,wt=me,Dt=0,vt=ve;if(x.content&&f){const dt=x.content;ke=Qg(U,0,dt[0]),Le=Qg(H,0,dt[1]),Se=Qg(U,dt[0],dt[2]),ze=Qg(H,dt[1],dt[3]),Je=dt[0]-ke,Dt=dt[1]-Le,wt=dt[2]-dt[0]-Se,vt=dt[3]-dt[1]-ze}const gt=(dt,Mt,pt,it)=>{const Jt=ey(dt.stretch-ke,Se,M,c.left),jt=ty(dt.fixed-Je,wt,dt.stretch,J),Sn=ey(Mt.stretch-Le,ze,B,c.top),ar=ty(Mt.fixed-Dt,vt,Mt.stretch,ae),fr=ey(pt.stretch-ke,Se,M,c.left),ti=ty(pt.fixed-Je,wt,pt.stretch,J),Ls=ey(it.stretch-Le,ze,B,c.top),Yi=ty(it.fixed-Dt,vt,it.stretch,ae),Gr=new A(Jt,Sn),gi=new A(fr,Sn),Ti=new A(fr,Ls),Ki=new A(Jt,Ls),Ji=new A(jt/w,ar/w),ni=new A(ti/w,Yi/w),ri=s*Math.PI/180;if(ri){const Oi=Math.sin(ri),ys=Math.cos(ri),_s=[ys,-Oi,Oi,ys];Gr._matMult(_s),gi._matMult(_s),Ki._matMult(_s),Ti._matMult(_s)}const Ri=dt.stretch+dt.fixed,Qi=Mt.stretch+Mt.fixed;return{tl:Gr,tr:gi,bl:Ki,br:Ti,tex:{x:x.paddedRect.x+_h+Ri,y:x.paddedRect.y+_h+Qi,w:pt.stretch+pt.fixed-Ri,h:it.stretch+it.fixed-Qi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:ni,minFontScaleX:wt/w/M,minFontScaleY:vt/w/B,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const dt=VE(U,me,J),Mt=VE(H,ve,ae);for(let pt=0;pt<dt.length-1;pt++){const it=dt[pt],Jt=dt[pt+1];for(let jt=0;jt<Mt.length-1;jt++)g.push(gt(it,Mt[jt],Jt,Mt[jt+1]))}}else g.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:I+1}));return g}function Qg(c,s,u){let f=0;for(const g of c)f+=Math.max(s,Math.min(u,g[1]))-Math.max(s,Math.min(u,g[0]));return f}function VE(c,s,u){const f=[{fixed:-_h,stretch:0}];for(const[g,x]of c){const w=f[f.length-1];f.push({fixed:g-w.stretch,stretch:w.stretch}),f.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return f.push({fixed:s+_h,stretch:u}),f}function ey(c,s,u,f){return c/s*u+f}function ty(c,s,u,f){return c-s*u/f}class ny{constructor(s,u,f,g,x,w,T,I,M,B){if(this.boxStartIndex=s.length,M){let U=w.top,H=w.bottom;const Y=w.collisionPadding;Y&&(U-=Y[1],H+=Y[3]);let J=H-U;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{let U=w.top*T-I[0],H=w.bottom*T+I[2],Y=w.left*T-I[3],J=w.right*T+I[1];const ae=w.collisionPadding;if(ae&&(Y-=ae[0]*T,U-=ae[1]*T,J+=ae[2]*T,H+=ae[3]*T),B){const me=new A(Y,U),ve=new A(J,U),ke=new A(Y,H),Se=new A(J,H),Le=B*Math.PI/180;me._rotate(Le),ve._rotate(Le),ke._rotate(Le),Se._rotate(Le),Y=Math.min(me.x,ve.x,ke.x,Se.x),J=Math.max(me.x,ve.x,ke.x,Se.x),U=Math.min(me.y,ve.y,ke.y,Se.y),H=Math.max(me.y,ve.y,ke.y,Se.y)}s.emplaceBack(u.x,u.y,Y,U,J,H,f,g,x)}this.boxEndIndex=s.length}}class qF{constructor(s=[],u=ZF){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:f}=this,g=u[s];for(;s>0;){const x=s-1>>1,w=u[x];if(f(g,w)>=0)break;u[s]=w,s=x}u[s]=g}_down(s){const{data:u,compare:f}=this,g=this.length>>1,x=u[s];for(;s<g;){let w=1+(s<<1),T=u[w];const I=w+1;if(I<this.length&&f(u[I],T)<0&&(w=I,T=u[I]),f(T,x)>=0)break;u[s]=T,s=w}u[s]=x}}function ZF(c,s){return c<s?-1:c>s?1:0}function XF(c,s=1,u=!1){let f=1/0,g=1/0,x=-1/0,w=-1/0;const T=c[0];for(let Y=0;Y<T.length;Y++){const J=T[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<g)&&(g=J.y),(!Y||J.x>x)&&(x=J.x),(!Y||J.y>w)&&(w=J.y)}const I=Math.min(x-f,w-g);let M=I/2;const B=new qF([],YF);if(I===0)return new A(f,g);for(let Y=f;Y<x;Y+=I)for(let J=g;J<w;J+=I)B.push(new vh(Y+M,J+M,M,c));let U=function(Y){let J=0,ae=0,me=0;const ve=Y[0];for(let ke=0,Se=ve.length,Le=Se-1;ke<Se;Le=ke++){const ze=ve[ke],Je=ve[Le],wt=ze.x*Je.y-Je.x*ze.y;ae+=(ze.x+Je.x)*wt,me+=(ze.y+Je.y)*wt,J+=3*wt}return new vh(ae/J,me/J,0,Y)}(c),H=B.length;for(;B.length;){const Y=B.pop();(Y.d>U.d||!U.d)&&(U=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,H)),Y.max-U.d<=s||(M=Y.h/2,B.push(new vh(Y.p.x-M,Y.p.y-M,M,c)),B.push(new vh(Y.p.x+M,Y.p.y-M,M,c)),B.push(new vh(Y.p.x-M,Y.p.y+M,M,c)),B.push(new vh(Y.p.x+M,Y.p.y+M,M,c)),H+=4)}return u&&(console.log(`num probes: ${H}`),console.log(`best distance: ${U.d}`)),U.p}function YF(c,s){return s.max-c.max}function vh(c,s,u,f){this.p=new A(c,s),this.h=u,this.d=function(g,x){let w=!1,T=1/0;for(let I=0;I<x.length;I++){const M=x[I];for(let B=0,U=M.length,H=U-1;B<U;H=B++){const Y=M[B],J=M[H];Y.y>g.y!=J.y>g.y&&g.x<(J.x-Y.x)*(g.y-Y.y)/(J.y-Y.y)+Y.x&&(w=!w),T=Math.min(T,ST(g,Y,J))}}return(w?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Si;l.aq=void 0,(Si=l.aq||(l.aq={}))[Si.center=1]="center",Si[Si.left=2]="left",Si[Si.right=3]="right",Si[Si.top=4]="top",Si[Si.bottom=5]="bottom",Si[Si["top-left"]=6]="top-left",Si[Si["top-right"]=7]="top-right",Si[Si["bottom-left"]=8]="bottom-left",Si[Si["bottom-right"]=9]="bottom-right";const Gl=7,kx=Number.POSITIVE_INFINITY;function UE(c,s){return s[1]!==kx?function(u,f,g){let x=0,w=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":w=g-Gl;break;case"bottom-right":case"bottom-left":case"bottom":w=-g+Gl}switch(u){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,w]}(c,s[0],s[1]):function(u,f){let g=0,x=0;f<0&&(f=0);const w=f/Math.SQRT2;switch(u){case"top-right":case"top-left":x=w-Gl;break;case"bottom-right":case"bottom-left":x=-w+Gl;break;case"bottom":x=-f+Gl;break;case"top":x=f-Gl}switch(u){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=f;break;case"right":g=-f}return[g,x]}(c,s[0])}function $E(c,s,u){var f;const g=c.layout,x=(f=g.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(s,{},u);if(x){const T=x.values,I=[];for(let M=0;M<T.length;M+=2){const B=I[M]=T[M],U=T[M+1].map(H=>H*ei);B.startsWith("top")?U[1]-=Gl:B.startsWith("bottom")&&(U[1]+=Gl),I[M+1]=U}return new di(I)}const w=g.get("text-variable-anchor");if(w){let T;T=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(s,{},u)*ei,kx]:g.get("text-offset").evaluate(s,{},u).map(M=>M*ei);const I=[];for(const M of w)I.push(M,UE(M,T));return new di(I)}return null}function Mx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function KF(c,s,u,f,g,x,w,T,I,M,B){let U=x.textMaxSize.evaluate(s,{});U===void 0&&(U=w);const H=c.layers[0].layout,Y=H.get("icon-offset").evaluate(s,{},B),J=WE(u.horizontal),ae=w/24,me=c.tilePixelRatio*ae,ve=c.tilePixelRatio*U/24,ke=c.tilePixelRatio*T,Se=c.tilePixelRatio*H.get("symbol-spacing"),Le=H.get("text-padding")*c.tilePixelRatio,ze=function(it,Jt,jt,Sn=1){const ar=it.get("icon-padding").evaluate(Jt,{},jt),fr=ar&&ar.values;return[fr[0]*Sn,fr[1]*Sn,fr[2]*Sn,fr[3]*Sn]}(H,s,B,c.tilePixelRatio),Je=H.get("text-max-angle")/180*Math.PI,wt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Dt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",vt=H.get("symbol-placement"),gt=Se/2,dt=H.get("icon-text-fit");let Mt;f&&dt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(Mt=fE(f,u.vertical,dt,H.get("icon-text-fit-padding"),Y,ae)),J&&(f=fE(f,J,dt,H.get("icon-text-fit-padding"),Y,ae)));const pt=(it,Jt)=>{Jt.x<0||Jt.x>=$r||Jt.y<0||Jt.y>=$r||function(jt,Sn,ar,fr,ti,Ls,Yi,Gr,gi,Ti,Ki,Ji,ni,ri,Ri,Qi,Oi,ys,_s,ii,kn,zi,Ei,si,wo){const Yo=jt.addToLineVertexArray(Sn,ar);let Ko,Ja,So,Ws,vs=0,Qa=0,Kf=0,XE=0,Bx=-1,jx=-1;const el={};let YE=Za("");if(jt.allowVerticalPlacement&&fr.vertical){const Di=Gr.layout.get("text-rotate").evaluate(kn,{},si)+90;So=new ny(gi,Sn,Ti,Ki,Ji,fr.vertical,ni,ri,Ri,Di),Yi&&(Ws=new ny(gi,Sn,Ti,Ki,Ji,Yi,Oi,ys,Ri,Di))}if(ti){const Di=Gr.layout.get("icon-rotate").evaluate(kn,{}),Hs=Gr.layout.get("icon-text-fit")!=="none",Kc=jE(ti,Di,Ei,Hs),Qo=Yi?jE(Yi,Di,Ei,Hs):void 0;Ja=new ny(gi,Sn,Ti,Ki,Ji,ti,Oi,ys,!1,Di),vs=4*Kc.length;const Jc=jt.iconSizeData;let va=null;Jc.kind==="source"?(va=[_a*Gr.layout.get("icon-size").evaluate(kn,{})],va[0]>Vl&&je(`${jt.layerIds[0]}: Value for "icon-size" is >= ${qf}. Reduce your "icon-size".`)):Jc.kind==="composite"&&(va=[_a*zi.compositeIconSizes[0].evaluate(kn,{},si),_a*zi.compositeIconSizes[1].evaluate(kn,{},si)],(va[0]>Vl||va[1]>Vl)&&je(`${jt.layerIds[0]}: Value for "icon-size" is >= ${qf}. Reduce your "icon-size".`)),jt.addSymbols(jt.icon,Kc,va,ii,_s,kn,l.ai.none,Sn,Yo.lineStartIndex,Yo.lineLength,-1,si),Bx=jt.icon.placedSymbolArray.length-1,Qo&&(Qa=4*Qo.length,jt.addSymbols(jt.icon,Qo,va,ii,_s,kn,l.ai.vertical,Sn,Yo.lineStartIndex,Yo.lineLength,-1,si),jx=jt.icon.placedSymbolArray.length-1)}const KE=Object.keys(fr.horizontal);for(const Di of KE){const Hs=fr.horizontal[Di];if(!Ko){YE=Za(Hs.text);const Qo=Gr.layout.get("text-rotate").evaluate(kn,{},si);Ko=new ny(gi,Sn,Ti,Ki,Ji,Hs,ni,ri,Ri,Qo)}const Kc=Hs.positionedLines.length===1;if(Kf+=GE(jt,Sn,Hs,Ls,Gr,Ri,kn,Qi,Yo,fr.vertical?l.ai.horizontal:l.ai.horizontalOnly,Kc?KE:[Di],el,Bx,zi,si),Kc)break}fr.vertical&&(XE+=GE(jt,Sn,fr.vertical,Ls,Gr,Ri,kn,Qi,Yo,l.ai.vertical,["vertical"],el,jx,zi,si));const e5=Ko?Ko.boxStartIndex:jt.collisionBoxArray.length,t5=Ko?Ko.boxEndIndex:jt.collisionBoxArray.length,n5=So?So.boxStartIndex:jt.collisionBoxArray.length,r5=So?So.boxEndIndex:jt.collisionBoxArray.length,i5=Ja?Ja.boxStartIndex:jt.collisionBoxArray.length,s5=Ja?Ja.boxEndIndex:jt.collisionBoxArray.length,o5=Ws?Ws.boxStartIndex:jt.collisionBoxArray.length,a5=Ws?Ws.boxEndIndex:jt.collisionBoxArray.length;let Jo=-1;const iy=(Di,Hs)=>Di&&Di.circleDiameter?Math.max(Di.circleDiameter,Hs):Hs;Jo=iy(Ko,Jo),Jo=iy(So,Jo),Jo=iy(Ja,Jo),Jo=iy(Ws,Jo);const JE=Jo>-1?1:0;JE&&(Jo*=wo/ei),jt.glyphOffsetArray.length>=yh.MAX_GLYPHS&&je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),kn.sortKey!==void 0&&jt.addToSortKeyRanges(jt.symbolInstances.length,kn.sortKey);const l5=$E(Gr,kn,si),[c5,u5]=function(Di,Hs){const Kc=Di.length,Qo=Hs==null?void 0:Hs.values;if((Qo==null?void 0:Qo.length)>0)for(let Jc=0;Jc<Qo.length;Jc+=2){const va=Qo[Jc+1];Di.emplaceBack(l.aq[Qo[Jc]],va[0],va[1])}return[Kc,Di.length]}(jt.textAnchorOffsets,l5);jt.symbolInstances.emplaceBack(Sn.x,Sn.y,el.right>=0?el.right:-1,el.center>=0?el.center:-1,el.left>=0?el.left:-1,el.vertical||-1,Bx,jx,YE,e5,t5,n5,r5,i5,s5,o5,a5,Ti,Kf,XE,vs,Qa,JE,0,ni,Jo,c5,u5)}(c,Jt,it,u,f,g,Mt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,me,[Le,Le,Le,Le],wt,I,ke,ze,Dt,Y,s,x,M,B,w)};if(vt==="line")for(const it of OE(s.geometry,0,0,$r,$r)){const Jt=HF(it,Se,Je,u.vertical||J,f,24,ve,c.overscaling,$r);for(const jt of Jt)J&&JF(c,J.text,gt,jt)||pt(it,jt)}else if(vt==="line-center"){for(const it of s.geometry)if(it.length>1){const Jt=WF(it,Je,u.vertical||J,f,24,ve);Jt&&pt(it,Jt)}}else if(s.type==="Polygon")for(const it of cx(s.geometry,0)){const Jt=XF(it,16);pt(it[0],new $l(Jt.x,Jt.y,0))}else if(s.type==="LineString")for(const it of s.geometry)pt(it,new $l(it[0].x,it[0].y,0));else if(s.type==="Point")for(const it of s.geometry)for(const Jt of it)pt([Jt],new $l(Jt.x,Jt.y,0))}function GE(c,s,u,f,g,x,w,T,I,M,B,U,H,Y,J){const ae=function(ke,Se,Le,ze,Je,wt,Dt,vt){const gt=ze.layout.get("text-rotate").evaluate(wt,{})*Math.PI/180,dt=[];for(const Mt of Se.positionedLines)for(const pt of Mt.positionedGlyphs){if(!pt.rect)continue;const it=pt.rect||{};let Jt=oE+1,jt=!0,Sn=1,ar=0;const fr=(Je||vt)&&pt.vertical,ti=pt.metrics.advance*pt.scale/2;if(vt&&Se.verticalizable&&(ar=Mt.lineOffset/2-(pt.imageName?-(ei-pt.metrics.width*pt.scale)/2:(pt.scale-1)*ei)),pt.imageName){const ii=Dt[pt.imageName];jt=ii.sdf,Sn=ii.pixelRatio,Jt=gs/Sn}const Ls=Je?[pt.x+ti,pt.y]:[0,0];let Yi=Je?[0,0]:[pt.x+ti+Le[0],pt.y+Le[1]-ar],Gr=[0,0];fr&&(Gr=Yi,Yi=[0,0]);const gi=pt.metrics.isDoubleResolution?2:1,Ti=(pt.metrics.left-Jt)*pt.scale-ti+Yi[0],Ki=(-pt.metrics.top-Jt)*pt.scale+Yi[1],Ji=Ti+it.w/gi*pt.scale/Sn,ni=Ki+it.h/gi*pt.scale/Sn,ri=new A(Ti,Ki),Ri=new A(Ji,Ki),Qi=new A(Ti,ni),Oi=new A(Ji,ni);if(fr){const ii=new A(-ti,ti-Wf),kn=-Math.PI/2,zi=ei/2-ti,Ei=new A(5-Wf-zi,-(pt.imageName?zi:0)),si=new A(...Gr);ri._rotateAround(kn,ii)._add(Ei)._add(si),Ri._rotateAround(kn,ii)._add(Ei)._add(si),Qi._rotateAround(kn,ii)._add(Ei)._add(si),Oi._rotateAround(kn,ii)._add(Ei)._add(si)}if(gt){const ii=Math.sin(gt),kn=Math.cos(gt),zi=[kn,-ii,ii,kn];ri._matMult(zi),Ri._matMult(zi),Qi._matMult(zi),Oi._matMult(zi)}const ys=new A(0,0),_s=new A(0,0);dt.push({tl:ri,tr:Ri,bl:Qi,br:Oi,tex:it,writingMode:Se.writingMode,glyphOffset:Ls,sectionIndex:pt.sectionIndex,isSDF:jt,pixelOffsetTL:ys,pixelOffsetBR:_s,minFontScaleX:0,minFontScaleY:0})}return dt}(0,u,T,g,x,w,f,c.allowVerticalPlacement),me=c.textSizeData;let ve=null;me.kind==="source"?(ve=[_a*g.layout.get("text-size").evaluate(w,{})],ve[0]>Vl&&je(`${c.layerIds[0]}: Value for "text-size" is >= ${qf}. Reduce your "text-size".`)):me.kind==="composite"&&(ve=[_a*Y.compositeTextSizes[0].evaluate(w,{},J),_a*Y.compositeTextSizes[1].evaluate(w,{},J)],(ve[0]>Vl||ve[1]>Vl)&&je(`${c.layerIds[0]}: Value for "text-size" is >= ${qf}. Reduce your "text-size".`)),c.addSymbols(c.text,ae,ve,T,x,w,M,s,I.lineStartIndex,I.lineLength,H,J);for(const ke of B)U[ke]=c.text.placedSymbolArray.length-1;return 4*ae.length}function WE(c){for(const s in c)return c[s];return null}function JF(c,s,u,f){const g=c.compareText;if(s in g){const x=g[s];for(let w=x.length-1;w>=0;w--)if(f.dist(x[w])<u)return!0}else g[s]=[];return g[s].push(f),!1}const HE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lx{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=HE[15&f];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[T]=new Uint32Array(s,4,1);return new Lx(T,w,x,s)}constructor(s,u=64,f=Float64Array,g){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=HE.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,T=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-T%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+T+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=u,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Rx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:T}=this,I=[0,x.length-1,0],M=[];for(;I.length;){const B=I.pop()||0,U=I.pop()||0,H=I.pop()||0;if(U-H<=T){for(let me=H;me<=U;me++){const ve=w[2*me],ke=w[2*me+1];ve>=s&&ve<=f&&ke>=u&&ke<=g&&M.push(x[me])}continue}const Y=H+U>>1,J=w[2*Y],ae=w[2*Y+1];J>=s&&J<=f&&ae>=u&&ae<=g&&M.push(x[Y]),(B===0?s<=J:u<=ae)&&(I.push(H),I.push(Y-1),I.push(1-B)),(B===0?f>=J:g>=ae)&&(I.push(Y+1),I.push(U),I.push(1-B))}return M}within(s,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:w}=this,T=[0,g.length-1,0],I=[],M=f*f;for(;T.length;){const B=T.pop()||0,U=T.pop()||0,H=T.pop()||0;if(U-H<=w){for(let me=H;me<=U;me++)ZE(x[2*me],x[2*me+1],s,u)<=M&&I.push(g[me]);continue}const Y=H+U>>1,J=x[2*Y],ae=x[2*Y+1];ZE(J,ae,s,u)<=M&&I.push(g[Y]),(B===0?s-f<=J:u-f<=ae)&&(T.push(H),T.push(Y-1),T.push(1-B)),(B===0?s+f>=J:u+f>=ae)&&(T.push(Y+1),T.push(U),T.push(1-B))}return I}}function Rx(c,s,u,f,g,x){if(g-f<=u)return;const w=f+g>>1;qE(c,s,w,f,g,x),Rx(c,s,u,f,w-1,1-x),Rx(c,s,u,w+1,g,1-x)}function qE(c,s,u,f,g,x){for(;g>f;){if(g-f>600){const M=g-f+1,B=u-f+1,U=Math.log(M),H=.5*Math.exp(2*U/3),Y=.5*Math.sqrt(U*H*(M-H)/M)*(B-M/2<0?-1:1);qE(c,s,u,Math.max(f,Math.floor(u-B*H/M+Y)),Math.min(g,Math.floor(u+(M-B)*H/M+Y)),x)}const w=s[2*u+x];let T=f,I=g;for(Xf(c,s,f,u),s[2*g+x]>w&&Xf(c,s,f,g);T<I;){for(Xf(c,s,T,I),T++,I--;s[2*T+x]<w;)T++;for(;s[2*I+x]>w;)I--}s[2*f+x]===w?Xf(c,s,f,I):(I++,Xf(c,s,I,g)),I<=u&&(f=I+1),u<=I&&(g=I-1)}}function Xf(c,s,u,f){Ox(c,u,f),Ox(s,2*u,2*f),Ox(s,2*u+1,2*f+1)}function Ox(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}function ZE(c,s,u,f){const g=c-u,x=s-f;return g*g+x*x}var zx;l.bh=void 0,(zx=l.bh||(l.bh={})).create="create",zx.load="load",zx.fullLoad="fullLoad";let ry=null,Yf=[];const Dx=1e3/60,Fx="loadTime",Nx="fullLoadTime",QF={mark(c){performance.mark(c)},frame(c){const s=c;ry!=null&&Yf.push(s-ry),ry=s},clearMetrics(){ry=null,Yf=[],performance.clearMeasures(Fx),performance.clearMeasures(Nx);for(const c in l.bh)performance.clearMarks(l.bh[c])},getPerformanceMetrics(){performance.measure(Fx,l.bh.create,l.bh.load),performance.measure(Nx,l.bh.create,l.bh.fullLoad);const c=performance.getEntriesByName(Fx)[0].duration,s=performance.getEntriesByName(Nx)[0].duration,u=Yf.length,f=1/(Yf.reduce((x,w)=>x+w,0)/u/1e3),g=Yf.filter(x=>x>Dx).reduce((x,w)=>x+(w-Dx)/Dx,0);return{loadTime:c,fullLoadTime:s,fps:f,percentDroppedFrames:g/(u+g)*100,totalFrames:u}}};l.$=function(c,s,u){var f,g,x,w,T,I,M,B,U,H,Y,J,ae=u[0],me=u[1],ve=u[2];return s===c?(c[12]=s[0]*ae+s[4]*me+s[8]*ve+s[12],c[13]=s[1]*ae+s[5]*me+s[9]*ve+s[13],c[14]=s[2]*ae+s[6]*me+s[10]*ve+s[14],c[15]=s[3]*ae+s[7]*me+s[11]*ve+s[15]):(g=s[1],x=s[2],w=s[3],T=s[4],I=s[5],M=s[6],B=s[7],U=s[8],H=s[9],Y=s[10],J=s[11],c[0]=f=s[0],c[1]=g,c[2]=x,c[3]=w,c[4]=T,c[5]=I,c[6]=M,c[7]=B,c[8]=U,c[9]=H,c[10]=Y,c[11]=J,c[12]=f*ae+T*me+U*ve+s[12],c[13]=g*ae+I*me+H*ve+s[13],c[14]=x*ae+M*me+Y*ve+s[14],c[15]=w*ae+B*me+J*ve+s[15]),c},l.A=hh,l.B=hs,l.C=class{constructor(c,s,u){this.receive=f=>{const g=f.data,x=g.id;if(x&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[x];const w=this.cancelCallbacks[x];delete this.cancelCallbacks[x],w&&w()}else Ye()||g.mustQueue?(this.tasks[x]=g,this.taskQueue.push(x),this.invoker.trigger()):this.processTask(x,g)},this.process=()=>{if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),g=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(f,g)},this.target=c,this.parent=s,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new $F(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ye()?c:window}send(c,s,u,f,g=!1){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[x]=u);const w=[],T={id:x,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:ma(s,w)};return this.target.postMessage(T,{transfer:w}),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}processTask(c,s){if(s.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(s.error?u(zl(s.error)):u(null,zl(s.data)))}else{let u=!1;const f=[],g=s.hasCallback?(T,I)=>{u=!0,delete this.cancelCallbacks[c];const M={id:c,type:"<response>",sourceMapId:this.mapId,error:T?ma(T):null,data:ma(I,f)};this.target.postMessage(M,{transfer:f})}:T=>{u=!0};let x=null;const w=zl(s.data);if(this.parent[s.type])x=this.parent[s.type](s.sourceMapId,w,g);else if("getWorkerSource"in this.parent){const T=s.type.split(".");x=this.parent.getWorkerSource(s.sourceMapId,T[0],w.source)[T[1]](w,g)}else g(new Error(`Could not find function ${s.type}`));!u&&x&&x.cancel&&(this.cancelCallbacks[c]=x.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.D=Gt,l.E=cn,l.F=function(c,s){const u={};for(let f=0;f<s.length;f++){const g=s[f];g in c&&(u[g]=c[g])}return u},l.G=wE,l.H=SE,l.I=vx,l.J=N,l.K=F,l.L=Ul,l.M=Vt,l.N=$r,l.O=Gs,l.P=A,l.Q=yr,l.R=$s,l.S=or,l.T=Lg,l.U=Jg,l.V=class extends Ha{},l.W=Ix,l.X=function(c,s){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let f=0;f<c.length;f++){const g=window.document.createElement("source");At(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},l.Y=$e,l.Z=function(){var c=new hh(16);return hh!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},l._=m,l.a=qe,l.a$=class extends X{},l.a0=function(c,s,u){var f=u[0],g=u[1],x=u[2];return c[0]=s[0]*f,c[1]=s[1]*f,c[2]=s[2]*f,c[3]=s[3]*f,c[4]=s[4]*g,c[5]=s[5]*g,c[6]=s[6]*g,c[7]=s[7]*g,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.a1=CT,l.a2=function(){return Te++},l.a3=fe,l.a4=yh,l.a5=function(){ps.isLoading()||ps.isLoaded()||Tf()!=="deferred"||Mg()},l.a6=ff,l.a7=Xc,l.a8=sr,l.a9=kE,l.aA=$c,l.aB=function(c){c=c.slice();const s=Object.create(null);for(let u=0;u<c.length;u++)s[c[u].id]=c[u];for(let u=0;u<c.length;u++)"ref"in c[u]&&(c[u]=bn(c[u],s[c[u].ref]));return c},l.aC=function(c){if(c.type==="custom")return new UF(c);switch(c.type){case"background":return new BF(c);case"circle":return new TD(c);case"fill":return new GD(c);case"fill-extrusion":return new sF(c);case"heatmap":return new PD(c);case"hillshade":return new AD(c);case"line":return new fF(c);case"raster":return new VF(c);case"symbol":return new Kg(c)}},l.aD=Ne,l.aE=function(c,s){if(!c)return[{command:It.setStyle,args:[s]}];let u=[];try{if(!Xt(c.version,s.version))return[{command:It.setStyle,args:[s]}];Xt(c.center,s.center)||u.push({command:It.setCenter,args:[s.center]}),Xt(c.zoom,s.zoom)||u.push({command:It.setZoom,args:[s.zoom]}),Xt(c.bearing,s.bearing)||u.push({command:It.setBearing,args:[s.bearing]}),Xt(c.pitch,s.pitch)||u.push({command:It.setPitch,args:[s.pitch]}),Xt(c.sprite,s.sprite)||u.push({command:It.setSprite,args:[s.sprite]}),Xt(c.glyphs,s.glyphs)||u.push({command:It.setGlyphs,args:[s.glyphs]}),Xt(c.transition,s.transition)||u.push({command:It.setTransition,args:[s.transition]}),Xt(c.light,s.light)||u.push({command:It.setLight,args:[s.light]});const f={},g=[];(function(w,T,I,M){let B;for(B in T=T||{},w=w||{})Object.prototype.hasOwnProperty.call(w,B)&&(Object.prototype.hasOwnProperty.call(T,B)||Bn(B,I,M));for(B in T)Object.prototype.hasOwnProperty.call(T,B)&&(Object.prototype.hasOwnProperty.call(w,B)?Xt(w[B],T[B])||(w[B].type==="geojson"&&T[B].type==="geojson"&&et(w,T,B)?I.push({command:It.setGeoJSONSourceData,args:[B,T[B].data]}):On(B,T,I,M)):Mn(B,T,I))})(c.sources,s.sources,g,f);const x=[];c.layers&&c.layers.forEach(w=>{f[w.source]?u.push({command:It.removeLayer,args:[w.id]}):x.push(w)}),u=u.concat(g),function(w,T,I){T=T||[];const M=(w=w||[]).map(yt),B=T.map(yt),U=w.reduce(un,{}),H=T.reduce(un,{}),Y=M.slice(),J=Object.create(null);let ae,me,ve,ke,Se,Le,ze;for(ae=0,me=0;ae<M.length;ae++)ve=M[ae],Object.prototype.hasOwnProperty.call(H,ve)?me++:(I.push({command:It.removeLayer,args:[ve]}),Y.splice(Y.indexOf(ve,me),1));for(ae=0,me=0;ae<B.length;ae++)ve=B[B.length-1-ae],Y[Y.length-1-ae]!==ve&&(Object.prototype.hasOwnProperty.call(U,ve)?(I.push({command:It.removeLayer,args:[ve]}),Y.splice(Y.lastIndexOf(ve,Y.length-me),1)):me++,Le=Y[Y.length-ae],I.push({command:It.addLayer,args:[H[ve],Le]}),Y.splice(Y.length-ae,0,ve),J[ve]=!0);for(ae=0;ae<B.length;ae++)if(ve=B[ae],ke=U[ve],Se=H[ve],!J[ve]&&!Xt(ke,Se))if(Xt(ke.source,Se.source)&&Xt(ke["source-layer"],Se["source-layer"])&&Xt(ke.type,Se.type)){for(ze in Xe(ke.layout,Se.layout,I,ve,null,It.setLayoutProperty),Xe(ke.paint,Se.paint,I,ve,null,It.setPaintProperty),Xt(ke.filter,Se.filter)||I.push({command:It.setFilter,args:[ve,Se.filter]}),Xt(ke.minzoom,Se.minzoom)&&Xt(ke.maxzoom,Se.maxzoom)||I.push({command:It.setLayerZoomRange,args:[ve,Se.minzoom,Se.maxzoom]}),ke)Object.prototype.hasOwnProperty.call(ke,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Xe(ke[ze],Se[ze],I,ve,ze.slice(6),It.setPaintProperty):Xt(ke[ze],Se[ze])||I.push({command:It.setLayerProperty,args:[ve,ze,Se[ze]]}));for(ze in Se)Object.prototype.hasOwnProperty.call(Se,ze)&&!Object.prototype.hasOwnProperty.call(ke,ze)&&ze!=="layout"&&ze!=="paint"&&ze!=="filter"&&ze!=="metadata"&&ze!=="minzoom"&&ze!=="maxzoom"&&(ze.indexOf("paint.")===0?Xe(ke[ze],Se[ze],I,ve,ze.slice(6),It.setPaintProperty):Xt(ke[ze],Se[ze])||I.push({command:It.setLayerProperty,args:[ve,ze,Se[ze]]}))}else I.push({command:It.removeLayer,args:[ve]}),Le=Y[Y.lastIndexOf(ve)+1],I.push({command:It.addLayer,args:[Se,Le]})}(x,s.layers,u)}catch(f){console.warn("Unable to compute style diff:",f),u=[{command:It.setStyle,args:[s]}]}return u},l.aF=function(c){const s=[],u=c.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},l.aG=function c(s,u){if(Array.isArray(s)){if(!Array.isArray(u)||s.length!==u.length)return!1;for(let f=0;f<s.length;f++)if(!c(s[f],u[f]))return!1;return!0}if(typeof s=="object"&&s!==null&&u!==null){if(typeof u!="object"||Object.keys(s).length!==Object.keys(u).length)return!1;for(const f in s)if(!c(s[f],u[f]))return!1;return!0}return s===u},l.aH=_e,l.aI=Re,l.aJ=Gc,l.aK=function(c){return c({pluginStatus:qi,pluginURL:ga}),Gc.on("pluginStateChange",c),c},l.aL=class extends Xa{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},l.aM=ch,l.aN=class extends Xa{constructor(c,s){super(c,s),this.current=Kv}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},l.aO=Dg,l.aP=class extends Xa{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},l.aQ=class extends Xa{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},l.aR=Fg,l.aS=function(c,s,u,f,g,x,w){var T=1/(s-u),I=1/(f-g),M=1/(x-w);return c[0]=-2*T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(s+u)*T,c[13]=(g+f)*I,c[14]=(w+x)*M,c[15]=1,c},l.aT=Pn,l.aU=SD,l.aV=class extends p{},l.aW=yF,l.aX=class extends b{},l.aY=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},l.aZ=LT,l.a_=ct,l.aa=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const w=g||x;return s[f]=!w||w.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s},l.ab=function(c,s){const u=[];for(const f in c)f in s||u.push(f);return u},l.ac=function(c){if(Ce==null){const s=c.navigator?c.navigator.userAgent:null;Ce=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ce},l.ad=te,l.ae=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[0],w=s[1],T=s[2],I=s[3],M=s[4],B=s[5],U=s[6],H=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*g+M*f,c[1]=w*g+B*f,c[2]=T*g+U*f,c[3]=I*g+H*f,c[4]=M*g-x*f,c[5]=B*g-w*f,c[6]=U*g-T*f,c[7]=H*g-I*f,c},l.af=function(c){var s=new hh(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},l.ag=Vg,l.ah=function(c,s){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:w}=c,T=g?te(ds.interpolationFactor(g,s,x,w),0,1):0;c.kind==="camera"?f=hs.number(c.minSize,c.maxSize,T):u=T}return{uSizeT:u,uSize:f}},l.aj=function(c,{uSize:s,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/_a:c.kind==="composite"?hs.number(f/_a,g/_a,u):s},l.ak=Sx,l.al=function(c,s,u,f){const g=s.y-c.y,x=s.x-c.x,w=f.y-u.y,T=f.x-u.x,I=w*x-T*g;if(I===0)return null;const M=(T*(c.y-u.y)-w*(c.x-u.x))/I;return new A(c.x+M*x,c.y+M*g)},l.am=OE,l.an=bT,l.ao=nx,l.ap=ei,l.ar=wx,l.as=function(c,s){var u=s[0],f=s[1],g=s[2],x=s[3],w=s[4],T=s[5],I=s[6],M=s[7],B=s[8],U=s[9],H=s[10],Y=s[11],J=s[12],ae=s[13],me=s[14],ve=s[15],ke=u*T-f*w,Se=u*I-g*w,Le=u*M-x*w,ze=f*I-g*T,Je=f*M-x*T,wt=g*M-x*I,Dt=B*ae-U*J,vt=B*me-H*J,gt=B*ve-Y*J,dt=U*me-H*ae,Mt=U*ve-Y*ae,pt=H*ve-Y*me,it=ke*pt-Se*Mt+Le*dt+ze*gt-Je*vt+wt*Dt;return it?(c[0]=(T*pt-I*Mt+M*dt)*(it=1/it),c[1]=(g*Mt-f*pt-x*dt)*it,c[2]=(ae*wt-me*Je+ve*ze)*it,c[3]=(H*Je-U*wt-Y*ze)*it,c[4]=(I*gt-w*pt-M*vt)*it,c[5]=(u*pt-g*gt+x*vt)*it,c[6]=(me*Le-J*wt-ve*Se)*it,c[7]=(B*wt-H*Le+Y*Se)*it,c[8]=(w*Mt-T*gt+M*Dt)*it,c[9]=(f*gt-u*Mt-x*Dt)*it,c[10]=(J*Je-ae*Le+ve*ke)*it,c[11]=(U*Le-B*Je-Y*ke)*it,c[12]=(T*vt-w*dt-I*Dt)*it,c[13]=(u*dt-f*vt+g*Dt)*it,c[14]=(ae*Se-J*ze-me*ke)*it,c[15]=(B*ze-U*Se+H*ke)*it,c):null},l.at=Mx,l.au=bx,l.av=Lx,l.aw=function(){const c={},s=Ae.$version;for(const u in Ae.$root){const f=Ae.$root[u];if(f.required){let g=null;g=u==="version"?s:f.type==="array"?[]:{},g!=null&&(c[u]=g)}}return c},l.ax=It,l.ay=Cg,l.az=Et,l.b=function(c,s){const u=new Blob([new Uint8Array(c)],{type:"image/png"});createImageBitmap(u).then(f=>{s(null,f)}).catch(f=>{s(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.b0=pi,l.b1=function(c,s){var u=c[0],f=c[1],g=c[2],x=c[3],w=c[4],T=c[5],I=c[6],M=c[7],B=c[8],U=c[9],H=c[10],Y=c[11],J=c[12],ae=c[13],me=c[14],ve=c[15],ke=s[0],Se=s[1],Le=s[2],ze=s[3],Je=s[4],wt=s[5],Dt=s[6],vt=s[7],gt=s[8],dt=s[9],Mt=s[10],pt=s[11],it=s[12],Jt=s[13],jt=s[14],Sn=s[15];return Math.abs(u-ke)<=Xi*Math.max(1,Math.abs(u),Math.abs(ke))&&Math.abs(f-Se)<=Xi*Math.max(1,Math.abs(f),Math.abs(Se))&&Math.abs(g-Le)<=Xi*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(x-ze)<=Xi*Math.max(1,Math.abs(x),Math.abs(ze))&&Math.abs(w-Je)<=Xi*Math.max(1,Math.abs(w),Math.abs(Je))&&Math.abs(T-wt)<=Xi*Math.max(1,Math.abs(T),Math.abs(wt))&&Math.abs(I-Dt)<=Xi*Math.max(1,Math.abs(I),Math.abs(Dt))&&Math.abs(M-vt)<=Xi*Math.max(1,Math.abs(M),Math.abs(vt))&&Math.abs(B-gt)<=Xi*Math.max(1,Math.abs(B),Math.abs(gt))&&Math.abs(U-dt)<=Xi*Math.max(1,Math.abs(U),Math.abs(dt))&&Math.abs(H-Mt)<=Xi*Math.max(1,Math.abs(H),Math.abs(Mt))&&Math.abs(Y-pt)<=Xi*Math.max(1,Math.abs(Y),Math.abs(pt))&&Math.abs(J-it)<=Xi*Math.max(1,Math.abs(J),Math.abs(it))&&Math.abs(ae-Jt)<=Xi*Math.max(1,Math.abs(ae),Math.abs(Jt))&&Math.abs(me-jt)<=Xi*Math.max(1,Math.abs(me),Math.abs(jt))&&Math.abs(ve-Sn)<=Xi*Math.max(1,Math.abs(ve),Math.abs(Sn))},l.b2=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.b3=function(c,s,u){return c[0]=s[0]*u[0],c[1]=s[1]*u[1],c[2]=s[2]*u[2],c[3]=s[3]*u[3],c},l.b4=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},l.b5=ie,l.b6=CE,l.b7=TE,l.b8=function(c,s,u,f,g){var x,w=1/Math.tan(s/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(x=1/(f-g)),c[14]=2*g*f*x):(c[10]=-1,c[14]=-2*f),c},l.b9=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[4],w=s[5],T=s[6],I=s[7],M=s[8],B=s[9],U=s[10],H=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*g+M*f,c[5]=w*g+B*f,c[6]=T*g+U*f,c[7]=I*g+H*f,c[8]=M*g-x*f,c[9]=B*g-w*f,c[10]=U*g-T*f,c[11]=H*g-I*f,c},l.bA=S,l.bB=QT,l.bC=Ju,l.bD=ps,l.ba=$,l.bb=Q,l.bc=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},l.bd=class extends qc{},l.be=Cx,l.bf=EE,l.bg=QF,l.bi=qt,l.bj=function(c,s,u=!1){if(qi===vf||qi===xf||qi===bf)throw new Error("setRTLTextPlugin cannot be called multiple times.");ga=xt.resolveURL(c),qi=vf,wf=s,Sf(),u||Mg()},l.bk=Tf,l.bl=function(c,s){const u={};for(let g=0;g<c.length;g++){const x=s&&s[c[g].id]||nh(c[g]);s&&(s[c[g].id]=x);let w=u[x];w||(w=u[x]=[]),w.push(c[g])}const f=[];for(const g in u)f.push(u[g]);return f},l.bm=kt,l.bn=IE,l.bo=ME,l.bp=lE,l.bq=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=$r/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],u=s.layout,f=s._unevaluatedLayout._values,g={layoutIconSize:f["icon-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new sr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:B}=c.bucket.textSizeData;g.compositeTextSizes=[f["text-size"].possiblyEvaluate(new sr(M),c.canonical),f["text-size"].possiblyEvaluate(new sr(B),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:B}=c.bucket.iconSizeData;g.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new sr(M),c.canonical),f["icon-size"].possiblyEvaluate(new sr(B),c.canonical)]}const x=u.get("text-line-height")*ei,w=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",T=u.get("text-keep-upright"),I=u.get("text-size");for(const M of c.bucket.features){const B=u.get("text-font").evaluate(M,{},c.canonical).join(","),U=I.evaluate(M,{},c.canonical),H=g.layoutTextSize.evaluate(M,{},c.canonical),Y=g.layoutIconSize.evaluate(M,{},c.canonical),J={horizontal:{},vertical:void 0},ae=M.text;let me,ve=[0,0];if(ae){const Le=ae.toString(),ze=u.get("text-letter-spacing").evaluate(M,{},c.canonical)*ei,Je=yf(Le)?ze:0,wt=u.get("text-anchor").evaluate(M,{},c.canonical),Dt=$E(s,M,c.canonical);if(!Dt){const pt=u.get("text-radial-offset").evaluate(M,{},c.canonical);ve=pt?UE(wt,[pt*ei,kx]):u.get("text-offset").evaluate(M,{},c.canonical).map(it=>it*ei)}let vt=w?"center":u.get("text-justify").evaluate(M,{},c.canonical);const gt=u.get("symbol-placement"),dt=gt==="point"?u.get("text-max-width").evaluate(M,{},c.canonical)*ei:0,Mt=()=>{c.bucket.allowVerticalPlacement&&gf(Le)&&(J.vertical=Zg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,wt,"left",Je,ve,l.ai.vertical,!0,gt,H,U))};if(!w&&Dt){const pt=new Set;if(vt==="auto")for(let Jt=0;Jt<Dt.values.length;Jt+=2)pt.add(Mx(Dt.values[Jt]));else pt.add(vt);let it=!1;for(const Jt of pt)if(!J.horizontal[Jt])if(it)J.horizontal[Jt]=J.horizontal[0];else{const jt=Zg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,"center",Jt,Je,ve,l.ai.horizontal,!1,gt,H,U);jt&&(J.horizontal[Jt]=jt,it=jt.positionedLines.length===1)}Mt()}else{vt==="auto"&&(vt=Mx(wt));const pt=Zg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,wt,vt,Je,ve,l.ai.horizontal,!1,gt,H,U);pt&&(J.horizontal[vt]=pt),Mt(),gf(Le)&&w&&T&&(J.vertical=Zg(ae,c.glyphMap,c.glyphPositions,c.imagePositions,B,dt,x,wt,vt,Je,ve,l.ai.vertical,!1,gt,H,U))}}let ke=!1;if(M.icon&&M.icon.name){const Le=c.imageMap[M.icon.name];Le&&(me=OF(c.imagePositions[M.icon.name],u.get("icon-offset").evaluate(M,{},c.canonical),u.get("icon-anchor").evaluate(M,{},c.canonical)),ke=!!Le.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=ke:c.bucket.sdfIcons!==ke&&je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==c.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Se=WE(J.horizontal)||J.vertical;c.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||me)&&KF(c.bucket,M,J,me,c.imageMap,g,H,Y,ve,ke,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},l.br=mx,l.bs=dx,l.bt=px,l.bu=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},l.bv=yx,l.bw=Bl,l.bx=function(c,s,u,f,g){return m(this,void 0,void 0,function*(){if(F())try{return yield Vt(c,s,u,f,g)}catch{}return function(x,w,T,I,M){const B=x.width,U=x.height;_t&&ht||(_t=new OffscreenCanvas(B,U),ht=_t.getContext("2d",{willReadFrequently:!0})),_t.width=B,_t.height=U,ht.drawImage(x,0,0,B,U);const H=ht.getImageData(w,T,I,M);return ht.clearRect(0,0,B,U),H.data}(c,s,u,f,g)})},l.by=AE,l.bz=_,l.c=Ht,l.d=function(c,s){const u=new Image;u.onload=()=>{s(null,u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=st})},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(c)],{type:"image/png"});u.src=c.byteLength?URL.createObjectURL(f):st},l.e=xe,l.f=function(c,s){return mn(xe(c,{type:"json"}),s)},l.g=ln,l.h=xt,l.i=Ye,l.j=ut,l.k=vn,l.l=Ut,l.m=mn,l.n=function(c){return new yx(c).readFields(AF,[])},l.o=function(c,s,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let x=null;c.forEach((w,T)=>{s(w,(I,M)=>{I&&(x=I),g[T]=M,--f==0&&u(x,g)})})},l.p=aE,l.q=Ff,l.r=Rr,l.s=At,l.t=qv,l.u=bt,l.v=Ae,l.w=je,l.x=sh,l.y=qo,l.z=function([c,s,u]){return s+=90,s*=Math.PI/180,u*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(u),y:c*Math.sin(s)*Math.sin(u),z:c*Math.cos(u)}}}),a(["./shared"],function(l){class m{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G){this._layerConfigs={},this._layers={},this.update(G,[])}update(G,q){for(const de of G){this._layerConfigs[de.id]=de;const pe=this._layers[de.id]=l.aC(de);pe._featureFilter=l.a6(pe.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of q)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const ne=l.bl(Object.values(this._layerConfigs),this.keyCache);for(const de of ne){const pe=de.map(We=>this._layers[We.id]),Me=pe[0];if(Me.visibility==="none")continue;const be=Me.source||"";let ye=this.familiesBySource[be];ye||(ye=this.familiesBySource[be]={});const Ee=Me.sourceLayer||"_geojsonTileLayer";let Ue=ye[Ee];Ue||(Ue=ye[Ee]=[]),Ue.push(pe)}}}class _{constructor(G){const q={},ne=[];for(const be in G){const ye=G[be],Ee=q[be]={};for(const Ue in ye){const We=ye[+Ue];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const He={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};ne.push(He),Ee[Ue]={rect:He,metrics:We.metrics}}}const{w:de,h:pe}=l.p(ne),Me=new l.q({width:de||1,height:pe||1});for(const be in G){const ye=G[be];for(const Ee in ye){const Ue=ye[+Ee];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const We=q[be][Ee].rect;l.q.copy(Ue.bitmap,Me,{x:0,y:0},{x:We.x+1,y:We.y+1},Ue.bitmap)}}this.image=Me,this.positions=q}}l.bm("GlyphAtlas",_);class S{constructor(G){this.tileID=new l.O(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.uid=G.uid,this.zoom=G.zoom,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=G.showCollisionBoxes,this.collectResourceTiming=!!G.collectResourceTiming,this.returnDependencies=!!G.returnDependencies,this.promoteId=G.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(G,q,ne,de,pe){this.status="parsing",this.data=G,this.collisionBoxArray=new l.a3;const Me=new l.bn(Object.keys(G.layers).sort()),be=new l.bo(this.tileID,this.promoteId);be.bucketLayerIDs=[];const ye={},Ee={featureIndex:be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},Ue=q.familiesBySource[this.source];for(const gn in Ue){const dn=G.layers[gn];if(!dn)continue;dn.version===1&&l.w(`Vector tile source "${this.source}" layer "${gn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const tn=Me.encode(gn),_n=[];for(let pr=0;pr<dn.length;pr++){const Yr=dn.feature(pr),$i=be.getId(Yr,gn);_n.push({feature:Yr,id:$i,index:pr,sourceLayerIndex:tn})}for(const pr of Ue[gn]){const Yr=pr[0];Yr.source!==this.source&&l.w(`layer.source = ${Yr.source} does not equal this.source = ${this.source}`),Yr.minzoom&&this.zoom<Math.floor(Yr.minzoom)||Yr.maxzoom&&this.zoom>=Yr.maxzoom||Yr.visibility!=="none"&&(P(pr,this.zoom,ne),(ye[Yr.id]=Yr.createBucket({index:be.bucketLayerIDs.length,layers:pr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:tn,sourceID:this.source})).populate(_n,Ee,this.tileID.canonical),be.bucketLayerIDs.push(pr.map($i=>$i.id)))}}let We,He,Rt,Kt;const St=l.aH(Ee.glyphDependencies,gn=>Object.keys(gn).map(Number));this.inFlightDependencies.forEach(gn=>gn==null?void 0:gn.cancel()),this.inFlightDependencies=[];const Ft=++this.dependencySentinel;Object.keys(St).length?this.inFlightDependencies.push(de.send("getGlyphs",{uid:this.uid,stacks:St,source:this.source,tileID:this.tileID,type:"glyphs"},(gn,dn)=>{Ft===this.dependencySentinel&&(We||(We=gn,He=dn,In.call(this)))})):He={};const Pt=Object.keys(Ee.iconDependencies);Pt.length?this.inFlightDependencies.push(de.send("getImages",{icons:Pt,source:this.source,tileID:this.tileID,type:"icons"},(gn,dn)=>{Ft===this.dependencySentinel&&(We||(We=gn,Rt=dn,In.call(this)))})):Rt={};const hn=Object.keys(Ee.patternDependencies);function In(){if(We)return pe(We);if(He&&Rt&&Kt){const gn=new _(He),dn=new l.bp(Rt,Kt);for(const tn in ye){const _n=ye[tn];_n instanceof l.a4?(P(_n.layers,this.zoom,ne),l.bq({bucket:_n,glyphMap:He,glyphPositions:gn.positions,imageMap:Rt,imagePositions:dn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):_n.hasPattern&&(_n instanceof l.br||_n instanceof l.bs||_n instanceof l.bt)&&(P(_n.layers,this.zoom,ne),_n.addFeatures(Ee,this.tileID.canonical,dn.patternPositions))}this.status="done",pe(null,{buckets:Object.values(ye).filter(tn=>!tn.isEmpty()),featureIndex:be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:gn.image,imageAtlas:dn,glyphMap:this.returnDependencies?He:null,iconMap:this.returnDependencies?Rt:null,glyphPositions:this.returnDependencies?gn.positions:null})}}hn.length?this.inFlightDependencies.push(de.send("getImages",{icons:hn,source:this.source,tileID:this.tileID,type:"patterns"},(gn,dn)=>{Ft===this.dependencySentinel&&(We||(We=gn,Kt=dn,In.call(this)))})):Kt={},In.call(this)}}function P(he,G,q){const ne=new l.a8(G);for(const de of he)de.recalculate(ne,q)}function A(he,G){const q=l.l(he.request,(ne,de,pe,Me)=>{if(ne)G(ne);else if(de)try{const be=new l.bw.VectorTile(new l.bv(de));G(null,{vectorTile:be,rawData:de,cacheControl:pe,expires:Me})}catch(be){const ye=new Uint8Array(de);let Ee=`Unable to parse the tile at ${he.request.url}, `;Ee+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${be.messge}`,G(new Error(Ee))}});return()=>{q.cancel(),G()}}class L{constructor(G,q,ne,de){this.actor=G,this.layerIndex=q,this.availableImages=ne,this.loadVectorData=de||A,this.fetching={},this.loading={},this.loaded={}}loadTile(G,q){const ne=G.uid;this.loading||(this.loading={});const de=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.bu(G.request),pe=this.loading[ne]=new S(G);pe.abort=this.loadVectorData(G,(Me,be)=>{if(delete this.loading[ne],Me||!be)return pe.status="done",this.loaded[ne]=pe,q(Me);const ye=be.rawData,Ee={};be.expires&&(Ee.expires=be.expires),be.cacheControl&&(Ee.cacheControl=be.cacheControl);const Ue={};if(de){const We=de.finish();We&&(Ue.resourceTiming=JSON.parse(JSON.stringify(We)))}pe.vectorTile=be.vectorTile,pe.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,(We,He)=>{if(delete this.fetching[ne],We||!He)return q(We);q(null,l.e({rawTileData:ye.slice(0)},He,Ee,Ue))}),this.loaded=this.loaded||{},this.loaded[ne]=pe,this.fetching[ne]={rawTileData:ye,cacheControl:Ee,resourceTiming:Ue}})}reloadTile(G,q){const ne=this.loaded,de=G.uid;if(ne&&ne[de]){const pe=ne[de];pe.showCollisionBoxes=G.showCollisionBoxes,pe.status==="parsing"?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Me,be)=>{if(Me||!be)return q(Me,be);let ye;if(this.fetching[de]){const{rawTileData:Ee,cacheControl:Ue,resourceTiming:We}=this.fetching[de];delete this.fetching[de],ye=l.e({rawTileData:Ee.slice(0)},be,Ue,We)}else ye=be;q(null,ye)}):pe.status==="done"&&(pe.vectorTile?pe.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}}abortTile(G,q){const ne=this.loading,de=G.uid;ne&&ne[de]&&ne[de].abort&&(ne[de].abort(),delete ne[de]),q()}removeTile(G,q){const ne=this.loaded,de=G.uid;ne&&ne[de]&&delete ne[de],q()}}class O{constructor(){this.loaded={}}loadTile(G,q){return l._(this,void 0,void 0,function*(){const{uid:ne,encoding:de,rawImageData:pe,redFactor:Me,greenFactor:be,blueFactor:ye,baseShift:Ee}=G,Ue=pe.width+2,We=pe.height+2,He=l.a(pe)?new l.R({width:Ue,height:We},yield l.bx(pe,-1,-1,Ue,We)):pe,Rt=new l.by(ne,He,de,Me,be,ye,Ee);this.loaded=this.loaded||{},this.loaded[ne]=Rt,q(null,Rt)})}removeTile(G){const q=this.loaded,ne=G.uid;q&&q[ne]&&delete q[ne]}}function D(he,G){if(he.length!==0){W(he[0],G);for(var q=1;q<he.length;q++)W(he[q],!G)}}function W(he,G){for(var q=0,ne=0,de=0,pe=he.length,Me=pe-1;de<pe;Me=de++){var be=(he[de][0]-he[Me][0])*(he[Me][1]+he[de][1]),ye=q+be;ne+=Math.abs(q)>=Math.abs(be)?q-ye+be:be-ye+q,q=ye}q+ne>=0!=!!G&&he.reverse()}var z=l.bz(function he(G,q){var ne,de=G&&G.type;if(de==="FeatureCollection")for(ne=0;ne<G.features.length;ne++)he(G.features[ne],q);else if(de==="GeometryCollection")for(ne=0;ne<G.geometries.length;ne++)he(G.geometries[ne],q);else if(de==="Feature")he(G.geometry,q);else if(de==="Polygon")D(G.coordinates,q);else if(de==="MultiPolygon")for(ne=0;ne<G.coordinates.length;ne++)D(G.coordinates[ne],q);return G});const N=l.bw.VectorTileFeature.prototype.toGeoJSON;var F={exports:{}},$=l.bA,Q=l.bw.VectorTileFeature,te=ie;function ie(he,G){this.options=G||{},this.features=he,this.length=he.length}function xe(he,G){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=G||4096}ie.prototype.feature=function(he){return new xe(this.features[he],this.options.extent)},xe.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var G=0;G<he.length;G++){for(var q=he[G],ne=[],de=0;de<q.length;de++)ne.push(new $(q[de][0],q[de][1]));this.geometry.push(ne)}return this.geometry},xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,G=1/0,q=-1/0,ne=1/0,de=-1/0,pe=0;pe<he.length;pe++)for(var Me=he[pe],be=0;be<Me.length;be++){var ye=Me[be];G=Math.min(G,ye.x),q=Math.max(q,ye.x),ne=Math.min(ne,ye.y),de=Math.max(de,ye.y)}return[G,ne,q,de]},xe.prototype.toGeoJSON=Q.prototype.toGeoJSON;var Te=l.bB,_e=te;function Re(he){var G=new Te;return function(q,ne){for(var de in q.layers)ne.writeMessage(3,Ne,q.layers[de])}(he,G),G.finish()}function Ne(he,G){var q;G.writeVarintField(15,he.version||1),G.writeStringField(1,he.name||""),G.writeVarintField(5,he.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<he.length;q++)ne.feature=he.feature(q),G.writeMessage(2,Ve,ne);var de=ne.keys;for(q=0;q<de.length;q++)G.writeStringField(3,de[q]);var pe=ne.values;for(q=0;q<pe.length;q++)G.writeMessage(4,Ce,pe[q])}function Ve(he,G){var q=he.feature;q.id!==void 0&&G.writeVarintField(1,q.id),G.writeMessage(2,je,he),G.writeVarintField(3,q.type),G.writeMessage(4,Ye,q)}function je(he,G){var q=he.feature,ne=he.keys,de=he.values,pe=he.keycache,Me=he.valuecache;for(var be in q.properties){var ye=q.properties[be],Ee=pe[be];if(ye!==null){Ee===void 0&&(ne.push(be),pe[be]=Ee=ne.length-1),G.writeVarint(Ee);var Ue=typeof ye;Ue!=="string"&&Ue!=="boolean"&&Ue!=="number"&&(ye=JSON.stringify(ye));var We=Ue+":"+ye,He=Me[We];He===void 0&&(de.push(ye),Me[We]=He=de.length-1),G.writeVarint(He)}}}function Ge(he,G){return(G<<3)+(7&he)}function Ze(he){return he<<1^he>>31}function Ye(he,G){for(var q=he.loadGeometry(),ne=he.type,de=0,pe=0,Me=q.length,be=0;be<Me;be++){var ye=q[be],Ee=1;ne===1&&(Ee=ye.length),G.writeVarint(Ge(1,Ee));for(var Ue=ne===3?ye.length-1:ye.length,We=0;We<Ue;We++){We===1&&ne!==1&&G.writeVarint(Ge(2,Ue-1));var He=ye[We].x-de,Rt=ye[We].y-pe;G.writeVarint(Ze(He)),G.writeVarint(Ze(Rt)),de+=He,pe+=Rt}ne===3&&G.writeVarint(Ge(7,1))}}function Ce(he,G){var q=typeof he;q==="string"?G.writeStringField(1,he):q==="boolean"?G.writeBooleanField(7,he):q==="number"&&(he%1!=0?G.writeDoubleField(3,he):he<0?G.writeSVarintField(6,he):G.writeVarintField(5,he))}F.exports=Re,F.exports.fromVectorTileJs=Re,F.exports.fromGeojsonVt=function(he,G){G=G||{};var q={};for(var ne in he)q[ne]=new _e(he[ne].features,G),q[ne].name=ne,q[ne].version=G.version,q[ne].extent=G.extent;return Re({layers:q})},F.exports.GeoJSONWrapper=_e;var qe=l.bz(F.exports);const st={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},Vt=Math.fround||(_t=new Float32Array(1),he=>(_t[0]=+he,_t[0]));var _t;const ht=3,at=5,Qe=6;class xt{constructor(G){this.options=Object.assign(Object.create(st),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:q,minZoom:ne,maxZoom:de}=this.options;q&&console.time("total time");const pe=`prepare ${G.length} points`;q&&console.time(pe),this.points=G;const Me=[];for(let ye=0;ye<G.length;ye++){const Ee=G[ye];if(!Ee.geometry)continue;const[Ue,We]=Ee.geometry.coordinates,He=Vt(Et(Ue)),Rt=Vt(ln(We));Me.push(He,Rt,1/0,ye,-1,1),this.options.reduce&&Me.push(0)}let be=this.trees[de+1]=this._createTree(Me);q&&console.timeEnd(pe);for(let ye=de;ye>=ne;ye--){const Ee=+Date.now();be=this.trees[ye]=this._createTree(this._cluster(be,ye)),q&&console.log("z%d: %d clusters in %dms",ye,be.numItems,+Date.now()-Ee)}return q&&console.timeEnd("total time"),this}getClusters(G,q){let ne=((G[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,G[1]));let pe=G[2]===180?180:((G[2]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)ne=-180,pe=180;else if(ne>pe){const We=this.getClusters([ne,de,180,Me],q),He=this.getClusters([-180,de,pe,Me],q);return We.concat(He)}const be=this.trees[this._limitZoom(q)],ye=be.range(Et(ne),ln(Me),Et(pe),ln(de)),Ee=be.data,Ue=[];for(const We of ye){const He=this.stride*We;Ue.push(Ee[He+at]>1?Ht(Ee,He,this.clusterProps):this.points[Ee[He+ht]])}return Ue}getChildren(G){const q=this._getOriginId(G),ne=this._getOriginZoom(G),de="No cluster with the specified id.",pe=this.trees[ne];if(!pe)throw new Error(de);const Me=pe.data;if(q*this.stride>=Me.length)throw new Error(de);const be=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),ye=pe.within(Me[q*this.stride],Me[q*this.stride+1],be),Ee=[];for(const Ue of ye){const We=Ue*this.stride;Me[We+4]===G&&Ee.push(Me[We+at]>1?Ht(Me,We,this.clusterProps):this.points[Me[We+ht]])}if(Ee.length===0)throw new Error(de);return Ee}getLeaves(G,q,ne){const de=[];return this._appendLeaves(de,G,q=q||10,ne=ne||0,0),de}getTile(G,q,ne){const de=this.trees[this._limitZoom(G)],pe=Math.pow(2,G),{extent:Me,radius:be}=this.options,ye=be/Me,Ee=(ne-ye)/pe,Ue=(ne+1+ye)/pe,We={features:[]};return this._addTileFeatures(de.range((q-ye)/pe,Ee,(q+1+ye)/pe,Ue),de.data,q,ne,pe,We),q===0&&this._addTileFeatures(de.range(1-ye/pe,Ee,1,Ue),de.data,pe,ne,pe,We),q===pe-1&&this._addTileFeatures(de.range(0,Ee,ye/pe,Ue),de.data,-1,ne,pe,We),We.features.length?We:null}getClusterExpansionZoom(G){let q=this._getOriginZoom(G)-1;for(;q<=this.options.maxZoom;){const ne=this.getChildren(G);if(q++,ne.length!==1)break;G=ne[0].properties.cluster_id}return q}_appendLeaves(G,q,ne,de,pe){const Me=this.getChildren(q);for(const be of Me){const ye=be.properties;if(ye&&ye.cluster?pe+ye.point_count<=de?pe+=ye.point_count:pe=this._appendLeaves(G,ye.cluster_id,ne,de,pe):pe<de?pe++:G.push(be),G.length===ne)break}return pe}_createTree(G){const q=new l.av(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ne=0;ne<G.length;ne+=this.stride)q.add(G[ne],G[ne+1]);return q.finish(),q.data=G,q}_addTileFeatures(G,q,ne,de,pe,Me){for(const be of G){const ye=be*this.stride,Ee=q[ye+at]>1;let Ue,We,He;if(Ee)Ue=qt(q,ye,this.clusterProps),We=q[ye],He=q[ye+1];else{const St=this.points[q[ye+ht]];Ue=St.properties;const[Ft,Pt]=St.geometry.coordinates;We=Et(Ft),He=ln(Pt)}const Rt={type:1,geometry:[[Math.round(this.options.extent*(We*pe-ne)),Math.round(this.options.extent*(He*pe-de))]],tags:Ue};let Kt;Kt=Ee||this.options.generateId?q[ye+ht]:this.points[q[ye+ht]].id,Kt!==void 0&&(Rt.id=Kt),Me.features.push(Rt)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,q){const{radius:ne,extent:de,reduce:pe,minPoints:Me}=this.options,be=ne/(de*Math.pow(2,q)),ye=G.data,Ee=[],Ue=this.stride;for(let We=0;We<ye.length;We+=Ue){if(ye[We+2]<=q)continue;ye[We+2]=q;const He=ye[We],Rt=ye[We+1],Kt=G.within(ye[We],ye[We+1],be),St=ye[We+at];let Ft=St;for(const Pt of Kt){const hn=Pt*Ue;ye[hn+2]>q&&(Ft+=ye[hn+at])}if(Ft>St&&Ft>=Me){let Pt,hn=He*St,In=Rt*St,gn=-1;const dn=((We/Ue|0)<<5)+(q+1)+this.points.length;for(const tn of Kt){const _n=tn*Ue;if(ye[_n+2]<=q)continue;ye[_n+2]=q;const pr=ye[_n+at];hn+=ye[_n]*pr,In+=ye[_n+1]*pr,ye[_n+4]=dn,pe&&(Pt||(Pt=this._map(ye,We,!0),gn=this.clusterProps.length,this.clusterProps.push(Pt)),pe(Pt,this._map(ye,_n)))}ye[We+4]=dn,Ee.push(hn/Ft,In/Ft,1/0,dn,-1,Ft),pe&&Ee.push(gn)}else{for(let Pt=0;Pt<Ue;Pt++)Ee.push(ye[We+Pt]);if(Ft>1)for(const Pt of Kt){const hn=Pt*Ue;if(!(ye[hn+2]<=q)){ye[hn+2]=q;for(let In=0;In<Ue;In++)Ee.push(ye[hn+In])}}}}return Ee}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,q,ne){if(G[q+at]>1){const Me=this.clusterProps[G[q+Qe]];return ne?Object.assign({},Me):Me}const de=this.points[G[q+ht]].properties,pe=this.options.map(de);return ne&&pe===de?Object.assign({},pe):pe}}function Ht(he,G,q){return{type:"Feature",id:he[G+ht],properties:qt(he,G,q),geometry:{type:"Point",coordinates:[(ne=he[G],360*(ne-.5)),Qt(he[G+1])]}};var ne}function qt(he,G,q){const ne=he[G+at],de=ne>=1e4?`${Math.round(ne/1e3)}k`:ne>=1e3?Math.round(ne/100)/10+"k":ne,pe=he[G+Qe],Me=pe===-1?{}:Object.assign({},q[pe]);return Object.assign(Me,{cluster:!0,cluster_id:he[G+ht],point_count:ne,point_count_abbreviated:de})}function Et(he){return he/360+.5}function ln(he){const G=Math.sin(he*Math.PI/180),q=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return q<0?0:q>1?1:q}function Qt(he){const G=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function mn(he,G,q,ne){for(var de,pe=ne,Me=q-G>>1,be=q-G,ye=he[G],Ee=he[G+1],Ue=he[q],We=he[q+1],He=G+3;He<q;He+=3){var Rt=Ut(he[He],he[He+1],ye,Ee,Ue,We);if(Rt>pe)de=He,pe=Rt;else if(Rt===pe){var Kt=Math.abs(He-Me);Kt<be&&(de=He,be=Kt)}}pe>ne&&(de-G>3&&mn(he,G,de,ne),he[de+2]=pe,q-de>3&&mn(he,de,q,ne))}function Ut(he,G,q,ne,de,pe){var Me=de-q,be=pe-ne;if(Me!==0||be!==0){var ye=((he-q)*Me+(G-ne)*be)/(Me*Me+be*be);ye>1?(q=de,ne=pe):ye>0&&(q+=Me*ye,ne+=be*ye)}return(Me=he-q)*Me+(be=G-ne)*be}function At(he,G,q,ne){var de={id:he===void 0?null:he,type:G,geometry:q,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var Me=pe.geometry,be=pe.type;if(be==="Point"||be==="MultiPoint"||be==="LineString")Lt(pe,Me);else if(be==="Polygon"||be==="MultiLineString")for(var ye=0;ye<Me.length;ye++)Lt(pe,Me[ye]);else if(be==="MultiPolygon")for(ye=0;ye<Me.length;ye++)for(var Ee=0;Ee<Me[ye].length;Ee++)Lt(pe,Me[ye][Ee])}(de),de}function Lt(he,G){for(var q=0;q<G.length;q+=3)he.minX=Math.min(he.minX,G[q]),he.minY=Math.min(he.minY,G[q+1]),he.maxX=Math.max(he.maxX,G[q]),he.maxY=Math.max(he.maxY,G[q+1])}function yn(he,G,q,ne){if(G.geometry){var de=G.geometry.coordinates,pe=G.geometry.type,Me=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),be=[],ye=G.id;if(q.promoteId?ye=G.properties[q.promoteId]:q.generateId&&(ye=ne||0),pe==="Point")vn(de,be);else if(pe==="MultiPoint")for(var Ee=0;Ee<de.length;Ee++)vn(de[Ee],be);else if(pe==="LineString")ut(de,be,Me,!1);else if(pe==="MultiLineString"){if(q.lineMetrics){for(Ee=0;Ee<de.length;Ee++)ut(de[Ee],be=[],Me,!1),he.push(At(ye,"LineString",be,G.properties));return}cn(de,be,Me,!1)}else if(pe==="Polygon")cn(de,be,Me,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Ee=0;Ee<G.geometry.geometries.length;Ee++)yn(he,{id:ye,geometry:G.geometry.geometries[Ee],properties:G.properties},q,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ee=0;Ee<de.length;Ee++){var Ue=[];cn(de[Ee],Ue,Me,!0),be.push(Ue)}}he.push(At(ye,pe,be,G.properties))}}function vn(he,G){G.push(Ae(he[0])),G.push(Tt(he[1])),G.push(0)}function ut(he,G,q,ne){for(var de,pe,Me=0,be=0;be<he.length;be++){var ye=Ae(he[be][0]),Ee=Tt(he[be][1]);G.push(ye),G.push(Ee),G.push(0),be>0&&(Me+=ne?(de*Ee-ye*pe)/2:Math.sqrt(Math.pow(ye-de,2)+Math.pow(Ee-pe,2))),de=ye,pe=Ee}var Ue=G.length-3;G[2]=1,mn(G,0,Ue,q),G[Ue+2]=1,G.size=Math.abs(Me),G.start=0,G.end=G.size}function cn(he,G,q,ne){for(var de=0;de<he.length;de++){var pe=[];ut(he[de],pe,q,ne),G.push(pe)}}function Ae(he){return he/360+.5}function Tt(he){var G=Math.sin(he*Math.PI/180),q=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return q<0?0:q>1?1:q}function bn(he,G,q,ne,de,pe,Me,be){if(ne/=G,pe>=(q/=G)&&Me<ne)return he;if(Me<q||pe>=ne)return null;for(var ye=[],Ee=0;Ee<he.length;Ee++){var Ue=he[Ee],We=Ue.geometry,He=Ue.type,Rt=de===0?Ue.minX:Ue.minY,Kt=de===0?Ue.maxX:Ue.maxY;if(Rt>=q&&Kt<ne)ye.push(Ue);else if(!(Kt<q||Rt>=ne)){var St=[];if(He==="Point"||He==="MultiPoint")Xt(We,St,q,ne,de);else if(He==="LineString")It(We,St,q,ne,de,!1,be.lineMetrics);else if(He==="MultiLineString")Bn(We,St,q,ne,de,!1);else if(He==="Polygon")Bn(We,St,q,ne,de,!0);else if(He==="MultiPolygon")for(var Ft=0;Ft<We.length;Ft++){var Pt=[];Bn(We[Ft],Pt,q,ne,de,!0),Pt.length&&St.push(Pt)}if(St.length){if(be.lineMetrics&&He==="LineString"){for(Ft=0;Ft<St.length;Ft++)ye.push(At(Ue.id,He,St[Ft],Ue.tags));continue}He!=="LineString"&&He!=="MultiLineString"||(St.length===1?(He="LineString",St=St[0]):He="MultiLineString"),He!=="Point"&&He!=="MultiPoint"||(He=St.length===3?"Point":"MultiPoint"),ye.push(At(Ue.id,He,St,Ue.tags))}}}return ye.length?ye:null}function Xt(he,G,q,ne,de){for(var pe=0;pe<he.length;pe+=3){var Me=he[pe+de];Me>=q&&Me<=ne&&(G.push(he[pe]),G.push(he[pe+1]),G.push(he[pe+2]))}}function It(he,G,q,ne,de,pe,Me){for(var be,ye,Ee=Mn(he),Ue=de===0?et:Xe,We=he.start,He=0;He<he.length-3;He+=3){var Rt=he[He],Kt=he[He+1],St=he[He+2],Ft=he[He+3],Pt=he[He+4],hn=de===0?Rt:Kt,In=de===0?Ft:Pt,gn=!1;Me&&(be=Math.sqrt(Math.pow(Rt-Ft,2)+Math.pow(Kt-Pt,2))),hn<q?In>q&&(ye=Ue(Ee,Rt,Kt,Ft,Pt,q),Me&&(Ee.start=We+be*ye)):hn>ne?In<ne&&(ye=Ue(Ee,Rt,Kt,Ft,Pt,ne),Me&&(Ee.start=We+be*ye)):On(Ee,Rt,Kt,St),In<q&&hn>=q&&(ye=Ue(Ee,Rt,Kt,Ft,Pt,q),gn=!0),In>ne&&hn<=ne&&(ye=Ue(Ee,Rt,Kt,Ft,Pt,ne),gn=!0),!pe&&gn&&(Me&&(Ee.end=We+be*ye),G.push(Ee),Ee=Mn(he)),Me&&(We+=be)}var dn=he.length-3;Rt=he[dn],Kt=he[dn+1],St=he[dn+2],(hn=de===0?Rt:Kt)>=q&&hn<=ne&&On(Ee,Rt,Kt,St),dn=Ee.length-3,pe&&dn>=3&&(Ee[dn]!==Ee[0]||Ee[dn+1]!==Ee[1])&&On(Ee,Ee[0],Ee[1],Ee[2]),Ee.length&&G.push(Ee)}function Mn(he){var G=[];return G.size=he.size,G.start=he.start,G.end=he.end,G}function Bn(he,G,q,ne,de,pe){for(var Me=0;Me<he.length;Me++)It(he[Me],G,q,ne,de,pe,!1)}function On(he,G,q,ne){he.push(G),he.push(q),he.push(ne)}function et(he,G,q,ne,de,pe){var Me=(pe-G)/(ne-G);return he.push(pe),he.push(q+(de-q)*Me),he.push(1),Me}function Xe(he,G,q,ne,de,pe){var Me=(pe-q)/(de-q);return he.push(G+(ne-G)*Me),he.push(pe),he.push(1),Me}function yt(he,G){for(var q=[],ne=0;ne<he.length;ne++){var de,pe=he[ne],Me=pe.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")de=un(pe.geometry,G);else if(Me==="MultiLineString"||Me==="Polygon"){de=[];for(var be=0;be<pe.geometry.length;be++)de.push(un(pe.geometry[be],G))}else if(Me==="MultiPolygon")for(de=[],be=0;be<pe.geometry.length;be++){for(var ye=[],Ee=0;Ee<pe.geometry[be].length;Ee++)ye.push(un(pe.geometry[be][Ee],G));de.push(ye)}q.push(At(pe.id,Me,de,pe.tags))}return q}function un(he,G){var q=[];q.size=he.size,he.start!==void 0&&(q.start=he.start,q.end=he.end);for(var ne=0;ne<he.length;ne+=3)q.push(he[ne]+G,he[ne+1],he[ne+2]);return q}function $e(he,G){if(he.transformed)return he;var q,ne,de,pe=1<<he.z,Me=he.x,be=he.y;for(q=0;q<he.features.length;q++){var ye=he.features[q],Ee=ye.geometry,Ue=ye.type;if(ye.geometry=[],Ue===1)for(ne=0;ne<Ee.length;ne+=2)ye.geometry.push(ot(Ee[ne],Ee[ne+1],G,pe,Me,be));else for(ne=0;ne<Ee.length;ne++){var We=[];for(de=0;de<Ee[ne].length;de+=2)We.push(ot(Ee[ne][de],Ee[ne][de+1],G,pe,Me,be));ye.geometry.push(We)}}return he.transformed=!0,he}function ot(he,G,q,ne,de,pe){return[Math.round(q*(he*ne-de)),Math.round(q*(G*ne-pe))]}function $t(he,G,q,ne,de){for(var pe=G===de.maxZoom?0:de.tolerance/((1<<G)*de.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:ne,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},be=0;be<he.length;be++){Me.numFeatures++,wn(Me,he[be],pe,de);var ye=he[be].minX,Ee=he[be].minY,Ue=he[be].maxX,We=he[be].maxY;ye<Me.minX&&(Me.minX=ye),Ee<Me.minY&&(Me.minY=Ee),Ue>Me.maxX&&(Me.maxX=Ue),We>Me.maxY&&(Me.maxY=We)}return Me}function wn(he,G,q,ne){var de=G.geometry,pe=G.type,Me=[];if(pe==="Point"||pe==="MultiPoint")for(var be=0;be<de.length;be+=3)Me.push(de[be]),Me.push(de[be+1]),he.numPoints++,he.numSimplified++;else if(pe==="LineString")pn(Me,de,he,q,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(be=0;be<de.length;be++)pn(Me,de[be],he,q,pe==="Polygon",be===0);else if(pe==="MultiPolygon")for(var ye=0;ye<de.length;ye++){var Ee=de[ye];for(be=0;be<Ee.length;be++)pn(Me,Ee[be],he,q,!0,be===0)}if(Me.length){var Ue=G.tags||null;if(pe==="LineString"&&ne.lineMetrics){for(var We in Ue={},G.tags)Ue[We]=G.tags[We];Ue.mapbox_clip_start=de.start/de.size,Ue.mapbox_clip_end=de.end/de.size}var He={geometry:Me,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:Ue};G.id!==null&&(He.id=G.id),he.features.push(He)}}function pn(he,G,q,ne,de,pe){var Me=ne*ne;if(ne>0&&G.size<(de?Me:ne))q.numPoints+=G.length/3;else{for(var be=[],ye=0;ye<G.length;ye+=3)(ne===0||G[ye+2]>Me)&&(q.numSimplified++,be.push(G[ye]),be.push(G[ye+1])),q.numPoints++;de&&function(Ee,Ue){for(var We=0,He=0,Rt=Ee.length,Kt=Rt-2;He<Rt;Kt=He,He+=2)We+=(Ee[He]-Ee[Kt])*(Ee[He+1]+Ee[Kt+1]);if(We>0===Ue)for(He=0,Rt=Ee.length;He<Rt/2;He+=2){var St=Ee[He],Ft=Ee[He+1];Ee[He]=Ee[Rt-2-He],Ee[He+1]=Ee[Rt-1-He],Ee[Rt-2-He]=St,Ee[Rt-1-He]=Ft}}(be,pe),he.push(be)}}function nt(he,G){var q=(G=this.options=function(de,pe){for(var Me in pe)de[Me]=pe[Me];return de}(Object.create(this.options),G)).debug;if(q&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(de,pe){var Me=[];if(de.type==="FeatureCollection")for(var be=0;be<de.features.length;be++)yn(Me,de.features[be],pe,be);else yn(Me,de.type==="Feature"?de:{geometry:de},pe);return Me}(he,G);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(de,pe){var Me=pe.buffer/pe.extent,be=de,ye=bn(de,1,-1-Me,Me,0,-1,2,pe),Ee=bn(de,1,1-Me,2+Me,0,-1,2,pe);return(ye||Ee)&&(be=bn(de,1,-Me,1+Me,0,-1,2,pe)||[],ye&&(be=yt(ye,1).concat(be)),Ee&&(be=be.concat(yt(Ee,-1)))),be}(ne,G),ne.length&&this.splitTile(ne,0,0,0),q&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function en(he,G,q){return 32*((1<<he)*q+G)+he}function sn(he,G){return G?he.properties[G]:he.id}function Pr(he,G){if(he==null)return!0;if(he.type==="Feature")return sn(he,G)!=null;if(he.type==="FeatureCollection"){const q=new Set;for(const ne of he.features){const de=sn(ne,G);if(de==null||q.has(de))return!1;q.add(de)}return!0}return!1}function ci(he,G){const q=new Map;if(he!=null)if(he.type==="Feature")q.set(sn(he,G),he);else for(const ne of he.features)q.set(sn(ne,G),ne);return q}nt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},nt.prototype.splitTile=function(he,G,q,ne,de,pe,Me){for(var be=[he,G,q,ne],ye=this.options,Ee=ye.debug;be.length;){ne=be.pop(),q=be.pop(),G=be.pop(),he=be.pop();var Ue=1<<G,We=en(G,q,ne),He=this.tiles[We];if(!He&&(Ee>1&&console.time("creation"),He=this.tiles[We]=$t(he,G,q,ne,ye),this.tileCoords.push({z:G,x:q,y:ne}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,q,ne,He.numFeatures,He.numPoints,He.numSimplified),console.timeEnd("creation"));var Rt="z"+G;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(He.source=he,de){if(G===ye.maxZoom||G===de)continue;var Kt=1<<de-G;if(q!==Math.floor(pe/Kt)||ne!==Math.floor(Me/Kt))continue}else if(G===ye.indexMaxZoom||He.numPoints<=ye.indexMaxPoints)continue;if(He.source=null,he.length!==0){Ee>1&&console.time("clipping");var St,Ft,Pt,hn,In,gn,dn=.5*ye.buffer/ye.extent,tn=.5-dn,_n=.5+dn,pr=1+dn;St=Ft=Pt=hn=null,In=bn(he,Ue,q-dn,q+_n,0,He.minX,He.maxX,ye),gn=bn(he,Ue,q+tn,q+pr,0,He.minX,He.maxX,ye),he=null,In&&(St=bn(In,Ue,ne-dn,ne+_n,1,He.minY,He.maxY,ye),Ft=bn(In,Ue,ne+tn,ne+pr,1,He.minY,He.maxY,ye),In=null),gn&&(Pt=bn(gn,Ue,ne-dn,ne+_n,1,He.minY,He.maxY,ye),hn=bn(gn,Ue,ne+tn,ne+pr,1,He.minY,He.maxY,ye),gn=null),Ee>1&&console.timeEnd("clipping"),be.push(St||[],G+1,2*q,2*ne),be.push(Ft||[],G+1,2*q,2*ne+1),be.push(Pt||[],G+1,2*q+1,2*ne),be.push(hn||[],G+1,2*q+1,2*ne+1)}}},nt.prototype.getTile=function(he,G,q){var ne=this.options,de=ne.extent,pe=ne.debug;if(he<0||he>24)return null;var Me=1<<he,be=en(he,G=(G%Me+Me)%Me,q);if(this.tiles[be])return $e(this.tiles[be],de);pe>1&&console.log("drilling down to z%d-%d-%d",he,G,q);for(var ye,Ee=he,Ue=G,We=q;!ye&&Ee>0;)Ee--,Ue=Math.floor(Ue/2),We=Math.floor(We/2),ye=this.tiles[en(Ee,Ue,We)];return ye&&ye.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Ee,Ue,We),pe>1&&console.time("drilling down"),this.splitTile(ye.source,Ee,Ue,We,he,G,q),pe>1&&console.timeEnd("drilling down"),this.tiles[be]?$e(this.tiles[be],de):null):null};class on extends L{constructor(G,q,ne,de){super(G,q,ne),this._dataUpdateable=new Map,this.loadGeoJSON=(pe,Me)=>{const{promoteId:be}=pe;if(pe.request)return l.f(pe.request,(ye,Ee,Ue,We)=>{this._dataUpdateable=Pr(Ee,be)?ci(Ee,be):void 0,Me(ye,Ee,Ue,We)});if(typeof pe.data=="string")try{const ye=JSON.parse(pe.data);this._dataUpdateable=Pr(ye,be)?ci(ye,be):void 0,Me(null,ye)}catch{Me(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}else pe.dataDiff?this._dataUpdateable?(function(ye,Ee,Ue){var We,He,Rt,Kt;if(Ee.removeAll&&ye.clear(),Ee.remove)for(const St of Ee.remove)ye.delete(St);if(Ee.add)for(const St of Ee.add){const Ft=sn(St,Ue);Ft!=null&&ye.set(Ft,St)}if(Ee.update)for(const St of Ee.update){let Ft=ye.get(St.id);if(Ft==null)continue;const Pt=!St.removeAllProperties&&(((We=St.removeProperties)===null||We===void 0?void 0:We.length)>0||((He=St.addOrUpdateProperties)===null||He===void 0?void 0:He.length)>0);if((St.newGeometry||St.removeAllProperties||Pt)&&(Ft=Object.assign({},Ft),ye.set(St.id,Ft),Pt&&(Ft.properties=Object.assign({},Ft.properties))),St.newGeometry&&(Ft.geometry=St.newGeometry),St.removeAllProperties)Ft.properties={};else if(((Rt=St.removeProperties)===null||Rt===void 0?void 0:Rt.length)>0)for(const hn of St.removeProperties)Object.prototype.hasOwnProperty.call(Ft.properties,hn)&&delete Ft.properties[hn];if(((Kt=St.addOrUpdateProperties)===null||Kt===void 0?void 0:Kt.length)>0)for(const{key:hn,value:In}of St.addOrUpdateProperties)Ft.properties[hn]=In}}(this._dataUpdateable,pe.dataDiff,be),Me(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Me(new Error(`Cannot update existing geojson data in ${pe.source}`)):Me(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,de&&(this.loadGeoJSON=de)}loadGeoJSONTile(G,q){const ne=G.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);const de=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!de)return q(null,null);const pe=new class{constructor(be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.N,this.length=be.length,this._features=be}feature(be){return new class{constructor(ye){this._feature=ye,this.extent=l.N,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Ee of this._feature.geometry)ye.push([new l.P(Ee[0],Ee[1])]);return ye}{const ye=[];for(const Ee of this._feature.geometry){const Ue=[];for(const We of Ee)Ue.push(new l.P(We[0],We[1]));ye.push(Ue)}return ye}}toGeoJSON(ye,Ee,Ue){return N.call(this,ye,Ee,Ue)}}(this._features[be])}}(de.features);let Me=qe(pe);Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),q(null,{vectorTile:pe,rawData:Me.buffer})}loadData(G,q){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const de=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.bu(G.request);this._pendingCallback=q,this._pendingRequest=this.loadGeoJSON(G,(pe,Me)=>{if(delete this._pendingCallback,delete this._pendingRequest,pe||!Me)return q(pe);if(typeof Me!="object")return q(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{z(Me,!0);try{if(G.filter){const ye=l.bC(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Ue=>`${Ue.key}: ${Ue.message}`).join(", "));Me={type:"FeatureCollection",features:Me.features.filter(Ue=>ye.value.evaluate({zoom:0},Ue))}}this._geoJSONIndex=G.cluster?new xt(function({superclusterOptions:ye,clusterProperties:Ee}){if(!Ee||!ye)return ye;const Ue={},We={},He={accumulated:null,zoom:0},Rt={properties:null},Kt=Object.keys(Ee);for(const St of Kt){const[Ft,Pt]=Ee[St],hn=l.bC(Pt),In=l.bC(typeof Ft=="string"?[Ft,["accumulated"],["get",St]]:Ft);Ue[St]=hn.value,We[St]=In.value}return ye.map=St=>{Rt.properties=St;const Ft={};for(const Pt of Kt)Ft[Pt]=Ue[Pt].evaluate(He,Rt);return Ft},ye.reduce=(St,Ft)=>{Rt.properties=Ft;for(const Pt of Kt)He.accumulated=St[Pt],St[Pt]=We[Pt].evaluate(He,Rt)},ye}(G)).load(Me.features):function(ye,Ee){return new nt(ye,Ee)}(Me,G.geojsonVtOptions)}catch(ye){return q(ye)}this.loaded={};const be={};if(de){const ye=de.finish();ye&&(be.resourceTiming={},be.resourceTiming[G.source]=JSON.parse(JSON.stringify(ye)))}q(null,be)}})}reloadTile(G,q){const ne=this.loaded;return ne&&ne[G.uid]?super.reloadTile(G,q):this.loadTile(G,q)}removeSource(G,q){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),q()}getClusterExpansionZoom(G,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(ne){q(ne)}}getClusterChildren(G,q){try{q(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(ne){q(ne)}}getClusterLeaves(G,q){try{q(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(ne){q(ne)}}}class Vr{constructor(G){this.self=G,this.actor=new l.C(G,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:L,geojson:on},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,ne)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=ne},this.self.registerRTLTextPlugin=q=>{if(l.bD.isParsed())throw new Error("RTL text plugin already registered.");l.bD.applyArabicShaping=q.applyArabicShaping,l.bD.processBidirectionalText=q.processBidirectionalText,l.bD.processStyledBidirectionalText=q.processStyledBidirectionalText}}setReferrer(G,q){this.referrer=q}setImages(G,q,ne){this.availableImages[G]=q;for(const de in this.workerSources[G]){const pe=this.workerSources[G][de];for(const Me in pe)pe[Me].availableImages=q}ne()}setLayers(G,q,ne){this.getLayerIndex(G).replace(q),ne()}updateLayers(G,q,ne){this.getLayerIndex(G).update(q.layers,q.removedIds),ne()}loadTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).loadTile(q,ne)}loadDEMTile(G,q,ne){this.getDEMWorkerSource(G,q.source).loadTile(q,ne)}reloadTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).reloadTile(q,ne)}abortTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).abortTile(q,ne)}removeTile(G,q,ne){this.getWorkerSource(G,q.type,q.source).removeTile(q,ne)}removeDEMTile(G,q){this.getDEMWorkerSource(G,q.source).removeTile(q)}removeSource(G,q,ne){if(!this.workerSources[G]||!this.workerSources[G][q.type]||!this.workerSources[G][q.type][q.source])return;const de=this.workerSources[G][q.type][q.source];delete this.workerSources[G][q.type][q.source],de.removeSource!==void 0?de.removeSource(q,ne):ne()}loadWorkerSource(G,q,ne){try{this.self.importScripts(q.url),ne()}catch(de){ne(de.toString())}}syncRTLPluginState(G,q,ne){try{l.bD.setState(q);const de=l.bD.getPluginURL();if(l.bD.isLoaded()&&!l.bD.isParsed()&&de!=null){this.self.importScripts(de);const pe=l.bD.isParsed();ne(pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${de}`),pe)}}catch(de){ne(de.toString())}}getAvailableImages(G){let q=this.availableImages[G];return q||(q=[]),q}getLayerIndex(G){let q=this.layerIndexes[G];return q||(q=this.layerIndexes[G]=new m),q}getWorkerSource(G,q,ne){return this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][q]||(this.workerSources[G][q]={}),this.workerSources[G][q][ne]||(this.workerSources[G][q][ne]=new this.workerSourceTypes[q]({send:(de,pe,Me)=>{this.actor.send(de,pe,Me,G)}},this.getLayerIndex(G),this.getAvailableImages(G))),this.workerSources[G][q][ne]}getDEMWorkerSource(G,q){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][q]||(this.demWorkerSources[G][q]=new O),this.demWorkerSources[G][q]}}return l.i()&&(self.worker=new Vr(self)),Vr}),a(["./shared"],function(l){var m="3.6.2";class _{static testProp(o){if(!_.docStyle)return o[0];for(let d=0;d<o.length;d++)if(o[d]in _.docStyle)return o[d];return o[0]}static create(o,d,p){const y=window.document.createElement(o);return d!==void 0&&(y.className=d),p&&p.appendChild(y),y}static createNS(o,d){return window.document.createElementNS(o,d)}static disableDrag(){_.docStyle&&_.selectProp&&(_.userSelect=_.docStyle[_.selectProp],_.docStyle[_.selectProp]="none")}static enableDrag(){_.docStyle&&_.selectProp&&(_.docStyle[_.selectProp]=_.userSelect)}static setTransform(o,d){o.style[_.transformProp]=d}static addEventListener(o,d,p,y={}){o.addEventListener(d,p,"passive"in y?y:y.capture)}static removeEventListener(o,d,p,y={}){o.removeEventListener(d,p,"passive"in y?y:y.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",_.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_.suppressClickInternal,!0)},0)}static mousePos(o,d){const p=o.getBoundingClientRect();return new l.P(d.clientX-p.left-o.clientLeft,d.clientY-p.top-o.clientTop)}static touchPos(o,d){const p=o.getBoundingClientRect(),y=[];for(let b=0;b<d.length;b++)y.push(new l.P(d[b].clientX-p.left-o.clientLeft,d[b].clientY-p.top-o.clientTop));return y}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}_.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_.selectProp=_.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_.transformProp=_.testProp(["transform","WebkitTransform"]);const S={supported:!1,testSupport:function(v){!L&&A&&(O?D(v):P=v)}};let P,A,L=!1,O=!1;function D(v){const o=v.createTexture();v.bindTexture(v.TEXTURE_2D,o);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,A),v.isContextLost())return;S.supported=!0}catch{}v.deleteTexture(o),L=!0}var W,z;typeof document<"u"&&(A=document.createElement("img"),A.onload=function(){P&&D(P),P=null,O=!0},A.onerror=function(){L=!0,P=null},A.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let o,d,p,y;v.resetRequestQueue=()=>{o=[],d=0,p=0,y={}},v.addThrottleControl=R=>{const j=p++;return y[j]=R,j},v.removeThrottleControl=R=>{delete y[R],C()},v.getImage=(R,j,V=!0)=>{S.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*");const X={requestParameters:R,supportImageRefresh:V,callback:j,cancelled:!1,completed:!1,cancel:()=>{X.completed||X.cancelled||(X.cancelled=!0,X.innerRequest&&(X.innerRequest.cancel(),d--),C())}};return o.push(X),C(),X};const b=R=>{const{requestParameters:j,supportImageRefresh:V,callback:X}=R;return l.e(j,{type:"image"}),(V!==!1||l.i()||l.g(j.url)||j.headers&&!Object.keys(j.headers).reduce((ce,le)=>ce&&le==="accept",!0)?l.m:k)(j,(ce,le,fe,oe)=>{E(R,X,ce,le,fe,oe)})},E=(R,j,V,X,ce,le)=>{V?j(V):X instanceof HTMLImageElement||l.a(X)?j(null,X):X&&((fe,oe)=>{typeof createImageBitmap=="function"?l.b(fe,oe):l.d(fe,oe)})(X,(fe,oe)=>{fe!=null?j(fe):oe!=null&&j(null,oe,{cacheControl:ce,expires:le})}),R.cancelled||(R.completed=!0,d--,C())},C=()=>{const R=(()=>{const j=Object.keys(y);let V=!1;if(j.length>0){for(const X of j)if(V=y[X](),V)break}return V})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=d;j<R&&o.length>0;j++){const V=o.shift();if(V.cancelled){j--;continue}const X=b(V);d++,V.innerRequest=X}},k=(R,j)=>{const V=new Image,X=R.url;let ce=!1;const le=R.credentials;return le&&le==="include"?V.crossOrigin="use-credentials":(le&&le==="same-origin"||!l.s(X))&&(V.crossOrigin="anonymous"),V.fetchPriority="high",V.onload=()=>{j(null,V),V.onerror=V.onload=null},V.onerror=()=>{ce||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),V.onerror=V.onload=null},V.src=X,{cancel:()=>{ce=!0,V.src=""}}}}(W||(W={})),W.resetRequestQueue(),function(v){v.Glyphs="Glyphs",v.Image="Image",v.Source="Source",v.SpriteImage="SpriteImage",v.SpriteJSON="SpriteJSON",v.Style="Style",v.Tile="Tile",v.Unknown="Unknown"}(z||(z={}));class N{constructor(o){this._transformRequestFn=o}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeSpriteURL(o,d,p){const y=function(b){const E=b.match(F);if(!E)throw new Error(`Unable to parse URL "${b}"`);return{protocol:E[1],authority:E[2],path:E[3]||"/",params:E[4]?E[4].split("&"):[]}}(o);return y.path+=`${d}${p}`,function(b){const E=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${E}`}(y)}setTransformRequest(o){this._transformRequestFn=o}}const F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $(v){var o=new l.A(3);return o[0]=v[0],o[1]=v[1],o[2]=v[2],o}var Q,te=function(v,o,d){return v[0]=o[0]-d[0],v[1]=o[1]-d[1],v[2]=o[2]-d[2],v};Q=new l.A(3),l.A!=Float32Array&&(Q[0]=0,Q[1]=0,Q[2]=0);var ie=function(v){var o=v[0],d=v[1];return o*o+d*d};function xe(v){const o=[];if(typeof v=="string")o.push({id:"default",url:v});else if(v&&v.length>0){const d=[];for(const{id:p,url:y}of v){const b=`${p}${y}`;d.indexOf(b)===-1&&(d.push(b),o.push({id:p,url:y}))}}return o}function Te(v,o,d,p,y){if(p)return void v(p);if(y!==Object.values(o).length||y!==Object.values(d).length)return;const b={};for(const E in o){b[E]={};const C=l.h.getImageCanvasContext(d[E]),k=o[E];for(const R in k){const{width:j,height:V,x:X,y:ce,sdf:le,pixelRatio:fe,stretchX:oe,stretchY:Pe,content:Oe}=k[R];b[E][R]={data:null,pixelRatio:fe,sdf:le,stretchX:oe,stretchY:Pe,content:Oe,spriteData:{width:j,height:V,x:X,y:ce,context:C}}}}v(null,b)}(function(){var v=new l.A(2);l.A!=Float32Array&&(v[0]=0,v[1]=0)})();class _e{constructor(o,d,p,y){this.context=o,this.format=p,this.texture=o.gl.createTexture(),this.update(d,y)}update(o,d,p){const{width:y,height:b}=o,E=!(this.size&&this.size[0]===y&&this.size[1]===b||p),{context:C}=this,{gl:k}=C;if(this.useMipmap=!!(d&&d.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!d||d.premultiply!==!1)),E)this.size=[y,b],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.a(o)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,o):k.texImage2D(k.TEXTURE_2D,0,this.format,y,b,0,this.format,k.UNSIGNED_BYTE,o.data);else{const{x:R,y:j}=p||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||l.a(o)?k.texSubImage2D(k.TEXTURE_2D,0,R,j,k.RGBA,k.UNSIGNED_BYTE,o):k.texSubImage2D(k.TEXTURE_2D,0,R,j,y,b,k.RGBA,k.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(o,d,p){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),o!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||o),this.filter=o),d!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function Re(v){const{userImage:o}=v;return!!(o&&o.render&&o.render())&&(v.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ne extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:d,callback:p}of this.requestors)this._notify(d,p);this.requestors=[]}}getImage(o){const d=this.images[o];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new l.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(o,d){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,d)&&(this.images[o]=d)}_validate(o,d){let p=!0;const y=d.data||d.spriteData;return this._validateStretch(d.stretchX,y&&y.width)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,y&&y.height)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new l.j(new Error(`Image "${o}" has invalid "content" value`))),p=!1),p}_validateStretch(o,d){if(!o)return!0;let p=0;for(const y of o){if(y[0]<p||y[1]<y[0]||d<y[1])return!1;p=y[1]}return!0}_validateContent(o,d){if(!o)return!0;if(o.length!==4)return!1;const p=d.spriteData,y=p&&p.width||d.data.width,b=p&&p.height||d.data.height;return!(o[0]<0||y<o[0]||o[1]<0||b<o[1]||o[2]<0||y<o[2]||o[3]<0||b<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,d,p=!0){const y=this.getImage(o);if(p&&(y.data.width!==d.data.width||y.data.height!==d.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=y.version+1,this.images[o]=d,this.updatedImages[o]=!0}removeImage(o){const d=this.images[o];delete this.images[o],delete this.patterns[o],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,d){let p=!0;if(!this.isLoaded())for(const y of o)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(o,d):this.requestors.push({ids:o,callback:d})}_notify(o,d){const p={};for(const y of o){let b=this.getImage(y);b||(this.fire(new l.k("styleimagemissing",{id:y})),b=this.getImage(y)),b?p[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:l.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,p)}getPixelSize(){const{width:o,height:d}=this.atlasImage;return{width:o,height:d}}getPattern(o){const d=this.patterns[o],p=this.getImage(o);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new l.I(y,p);this.patterns[o]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const d=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _e(o,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const b in this.patterns)o.push(this.patterns[b].bin);const{w:d,h:p}=l.p(o),y=this.atlasImage;y.resize({width:d||1,height:p||1});for(const b in this.patterns){const{bin:E}=this.patterns[b],C=E.x+1,k=E.y+1,R=this.getImage(b).data,j=R.width,V=R.height;l.R.copy(R,y,{x:0,y:0},{x:C,y:k},{width:j,height:V}),l.R.copy(R,y,{x:0,y:V-1},{x:C,y:k-1},{width:j,height:1}),l.R.copy(R,y,{x:0,y:0},{x:C,y:k+V},{width:j,height:1}),l.R.copy(R,y,{x:j-1,y:0},{x:C-1,y:k},{width:1,height:V}),l.R.copy(R,y,{x:0,y:0},{x:C+j,y:k},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const d of o){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||l.w(`Image with ID: "${d}" was not found`),Re(p)&&this.updateImage(d,p)}}}const Ve=1e20;function je(v,o,d,p,y,b,E,C,k){for(let R=o;R<o+p;R++)Ge(v,d*b+R,b,y,E,C,k);for(let R=d;R<d+y;R++)Ge(v,R*b+o,1,p,E,C,k)}function Ge(v,o,d,p,y,b,E){b[0]=0,E[0]=-Ve,E[1]=Ve,y[0]=v[o];for(let C=1,k=0,R=0;C<p;C++){y[C]=v[o+C*d];const j=C*C;do{const V=b[k];R=(y[C]-y[V]+j-V*V)/(C-V)/2}while(R<=E[k]&&--k>-1);k++,b[k]=C,E[k]=R,E[k+1]=Ve}for(let C=0,k=0;C<p;C++){for(;E[k+1]<C;)k++;const R=b[k],j=C-R;v[o+C*d]=y[R]+j*j}}class Ze{constructor(o,d){this.requestManager=o,this.localIdeographFontFamily=d,this.entries={}}setURL(o){this.url=o}getGlyphs(o,d){const p=[];for(const y in o)for(const b of o[y])p.push({stack:y,id:b});l.o(p,({stack:y,id:b},E)=>{let C=this.entries[y];C||(C=this.entries[y]={glyphs:{},requests:{},ranges:{}});let k=C.glyphs[b];if(k!==void 0)return void E(null,{stack:y,id:b,glyph:k});if(k=this._tinySDF(C,y,b),k)return C.glyphs[b]=k,void E(null,{stack:y,id:b,glyph:k});const R=Math.floor(b/256);if(256*R>65535)return void E(new Error("glyphs > 65535 not supported"));if(C.ranges[R])return void E(null,{stack:y,id:b,glyph:k});if(!this.url)return void E(new Error("glyphsUrl is not set"));let j=C.requests[R];j||(j=C.requests[R]=[],Ze.loadGlyphRange(y,R,this.url,this.requestManager,(V,X)=>{if(X){for(const ce in X)this._doesCharSupportLocalGlyph(+ce)||(C.glyphs[+ce]=X[+ce]);C.ranges[R]=!0}for(const ce of j)ce(V,X);delete C.requests[R]})),j.push((V,X)=>{V?E(V):X&&E(null,{stack:y,id:b,glyph:X[b]||null})})},(y,b)=>{if(y)d(y);else if(b){const E={};for(const{stack:C,id:k,glyph:R}of b)(E[C]||(E[C]={}))[k]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};d(null,E)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(l.u["CJK Unified Ideographs"](o)||l.u["Hangul Syllables"](o)||l.u.Hiragana(o)||l.u.Katakana(o))}_tinySDF(o,d,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let b=o.tinySDF;if(!b){let C="400";/bold/i.test(d)?C="900":/medium/i.test(d)?C="500":/light/i.test(d)&&(C="200"),b=o.tinySDF=new Ze.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:C})}const E=b.draw(String.fromCharCode(p));return{id:p,bitmap:new l.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ze.loadGlyphRange=function(v,o,d,p,y){const b=256*o,E=b+255,C=p.transformRequest(d.replace("{fontstack}",v).replace("{range}",`${b}-${E}`),z.Glyphs);l.l(C,(k,R)=>{if(k)y(k);else if(R){const j={};for(const V of l.n(R))j[V.id]=V;y(null,j)}})},Ze.TinySDF=class{constructor({fontSize:v=24,buffer:o=3,radius:d=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=d;const C=this.size=v+4*o,k=this._createCanvas(C),R=this.ctx=k.getContext("2d",{willReadFrequently:!0});R.font=`${E} ${b} ${v}px ${y}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(v){const o=document.createElement("canvas");return o.width=o.height=v,o}draw(v){const{width:o,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(v),E=Math.ceil(d),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-y))),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),R=C+2*this.buffer,j=k+2*this.buffer,V=Math.max(R*j,0),X=new Uint8ClampedArray(V),ce={data:X,width:R,height:j,glyphWidth:C,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(C===0||k===0)return ce;const{ctx:le,buffer:fe,gridInner:oe,gridOuter:Pe}=this;le.clearRect(fe,fe,C,k),le.fillText(v,fe,fe+E);const Oe=le.getImageData(fe,fe,C,k);Pe.fill(Ve,0,V),oe.fill(0,0,V);for(let ge=0;ge<k;ge++)for(let Ie=0;Ie<C;Ie++){const De=Oe.data[4*(ge*C+Ie)+3]/255;if(De===0)continue;const Be=(ge+fe)*R+Ie+fe;if(De===1)Pe[Be]=0,oe[Be]=Ve;else{const Ke=.5-De;Pe[Be]=Ke>0?Ke*Ke:0,oe[Be]=Ke<0?Ke*Ke:0}}je(Pe,0,0,R,j,R,this.f,this.v,this.z),je(oe,fe,fe,C,k,R,this.f,this.v,this.z);for(let ge=0;ge<V;ge++){const Ie=Math.sqrt(Pe[ge])-Math.sqrt(oe[ge]);X[ge]=Math.round(255-255*(Ie/this.radius+this.cutoff))}return ce}};class Ye{constructor(){this.specification=l.v.light.position}possiblyEvaluate(o,d){return l.z(o.expression.evaluate(d))}interpolate(o,d,p){return{x:l.B.number(o.x,d.x,p),y:l.B.number(o.y,d.y,p),z:l.B.number(o.z,d.z,p)}}}let Ce;class qe extends l.E{constructor(o){super(),Ce=Ce||new l.r({anchor:new l.D(l.v.light.anchor),position:new Ye,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(Ce),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d={}){if(!this._validate(l.t,o,d))for(const p in o){const y=o[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,p){return(!p||p.validate!==!1)&&l.x(this,o.call(l.y,l.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}}class st{constructor(o,d){this.width=o,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,d){const p=o.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(o,d)),this.dashEntry[p]}getDashRanges(o,d,p){const y=[];let b=o.length%2==1?-o[o.length-1]*p:0,E=o[0]*p,C=!0;y.push({left:b,right:E,isDash:C,zeroLength:o[0]===0});let k=o[0];for(let R=1;R<o.length;R++){C=!C;const j=o[R];b=k*p,k+=j,E=k*p,y.push({left:b,right:E,isDash:C,zeroLength:j===0})}return y}addRoundDash(o,d,p){const y=d/2;for(let b=-p;b<=p;b++){const E=this.width*(this.nextRow+p+b);let C=0,k=o[C];for(let R=0;R<this.width;R++){R/k.right>1&&(k=o[++C]);const j=Math.abs(R-k.left),V=Math.abs(R-k.right),X=Math.min(j,V);let ce;const le=b/p*(y+1);if(k.isDash){const fe=y-Math.abs(le);ce=Math.sqrt(X*X+fe*fe)}else ce=y-Math.sqrt(X*X+le*le);this.data[E+R]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(o){for(let C=o.length-1;C>=0;--C){const k=o[C],R=o[C+1];k.zeroLength?o.splice(C,1):R&&R.isDash===k.isDash&&(R.left=k.left,o.splice(C,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const y=this.width*this.nextRow;let b=0,E=o[b];for(let C=0;C<this.width;C++){C/E.right>1&&(E=o[++b]);const k=Math.abs(C-E.left),R=Math.abs(C-E.right),j=Math.min(k,R);this.data[y+C]=Math.max(0,Math.min(255,(E.isDash?j:-j)+128))}}addDash(o,d){const p=d?7:0,y=2*p+1;if(this.nextRow+y>this.height)return l.w("LineAtlas out of space"),null;let b=0;for(let C=0;C<o.length;C++)b+=o[C];if(b!==0){const C=this.width/b,k=this.getDashRanges(o,this.width,C);d?this.addRoundDash(k,C,p):this.addRegularDash(k)}const E={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=y,this.dirty=!0,E}bind(o){const d=o.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class Vt{constructor(o,d,p){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p;const y=this.workerPool.acquire(p);for(let b=0;b<y.length;b++){const E=new l.C(y[b],d,p);E.name=`Worker ${b}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,d,p){l.o(this.actors,(y,b)=>{y.send(o,d,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}}function _t(v,o,d){const p=function(y,b){if(y)return d(y);if(b){const E=l.F(l.e(b,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(E.vectorLayers=b.vector_layers,E.vectorLayerIds=E.vectorLayers.map(C=>C.id)),d(null,E)}};return v.url?l.f(o.transformRequest(v.url,z.Source),p):l.h.frame(()=>p(null,v))}class ht{constructor(o,d){o&&(d?this.setSouthWest(o).setNorthEast(d):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof l.L?new l.L(o.lng,o.lat):l.L.convert(o),this}setSouthWest(o){return this._sw=o instanceof l.L?new l.L(o.lng,o.lat):l.L.convert(o),this}extend(o){const d=this._sw,p=this._ne;let y,b;if(o instanceof l.L)y=o,b=o;else{if(!(o instanceof ht))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(ht.convert(o)):this.extend(l.L.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(l.L.convert(o)):this;if(y=o._sw,b=o._ne,!y||!b)return this}return d||p?(d.lng=Math.min(y.lng,d.lng),d.lat=Math.min(y.lat,d.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new l.L(y.lng,y.lat),this._ne=new l.L(b.lng,b.lat)),this}getCenter(){return new l.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.L(this.getWest(),this.getNorth())}getSouthEast(){return new l.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:d,lat:p}=l.L.convert(o);let y=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(o){return o instanceof ht?o:o&&new ht(o)}static fromLngLat(o,d=0){const p=360*d/40075017,y=p/Math.cos(Math.PI/180*o.lat);return new ht(new l.L(o.lng-y,o.lat-p),new l.L(o.lng+y,o.lat+p))}}class at{constructor(o,d,p){this.bounds=ht.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),p=Math.floor(l.G(this.bounds.getWest())*d),y=Math.floor(l.H(this.bounds.getNorth())*d),b=Math.ceil(l.G(this.bounds.getEast())*d),E=Math.ceil(l.H(this.bounds.getSouth())*d);return o.x>=p&&o.x<b&&o.y>=y&&o.y<E}}class Qe extends l.E{constructor(o,d,p,y){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=_t(this._options,this.map._requestManager,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b?this.fire(new l.j(b)):E&&(l.e(this,E),E.bounds&&(this.tileBounds=new at(E.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.e({},this._options),this.id=o,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.F(d,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(p,z.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(E,C){return delete o.request,o.aborted?d(null):E&&E.status!==404?d(E):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",y,b.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",y,b.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class xt extends l.E{constructor(o,d,p,y){super(),this.id=o,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},d),l.e(this,l.F(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=_t(this._options,this.map._requestManager,(o,d)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new l.j(o)):d&&(l.e(this,d),d.bounds&&(this.tileBounds=new at(d.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}serialize(){return l.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=W.getImage(this.map._requestManager.transformRequest(p,z.Tile),(y,b,E)=>{if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(y)o.state="errored",d(y);else if(b){this.map._refreshExpiredTiles&&E&&o.setExpiryData(E);const C=this.map.painter.context,k=C.gl;o.texture=this.map.painter.getTileTexture(b.width),o.texture?o.texture.update(b,{useMipmap:!0}):(o.texture=new _e(C,b,k.RGBA,{useMipmap:!0}),o.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d()}unloadTile(o,d){o.texture&&this.map.painter.saveTileTexture(o.texture),d()}hasTransition(){return!1}}class Ht extends xt{constructor(o,d,p,y){super(o,d,p,y),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(o,d){const p=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(p,z.Tile);function b(E,C){E&&(o.state="errored",d(E)),C&&(o.dem=C,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded",d(null))}o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.request=W.getImage(y,(E,C,k)=>l._(this,void 0,void 0,function*(){if(delete o.request,o.aborted)o.state="unloaded",d(null);else if(E)o.state="errored",d(E);else if(C){this.map._refreshExpiredTiles&&o.setExpiryData(k);const R=l.a(C)&&l.J()?C:yield function(V){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.K()){const X=V.width+2,ce=V.height+2;try{return new l.R({width:X,height:ce},yield l.M(V,-1,-1,X,ce))}catch{}}return l.h.getImageData(V,1)})}(C),j={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:R,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",j,b))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(o){const d=o.canonical,p=Math.pow(2,d.z),y=(d.x-1+p)%p,b=d.x===0?o.wrap-1:o.wrap,E=(d.x+1+p)%p,C=d.x+1===p?o.wrap+1:o.wrap,k={};return k[new l.O(o.overscaledZ,b,d.z,y,d.y).key]={backfilled:!1},k[new l.O(o.overscaledZ,C,d.z,E,d.y).key]={backfilled:!1},d.y>0&&(k[new l.O(o.overscaledZ,b,d.z,y,d.y-1).key]={backfilled:!1},k[new l.O(o.overscaledZ,o.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},k[new l.O(o.overscaledZ,C,d.z,E,d.y-1).key]={backfilled:!1}),d.y+1<p&&(k[new l.O(o.overscaledZ,b,d.z,y,d.y+1).key]={backfilled:!1},k[new l.O(o.overscaledZ,o.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},k[new l.O(o.overscaledZ,C,d.z,E,d.y+1).key]={backfilled:!1}),k}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class qt extends l.E{constructor(o,d,p,y){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.e({},this._options,{type:this.type,data:this._data}),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=d.data,this._options=l.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const b=l.N/this.tileSize;this.workerOptions=l.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*b,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*b,extent:l.N,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.N,radius:(d.clusterRadius||50)*b,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=o.clusterRadius),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=o.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(o,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},d),this}getClusterChildren(o,d){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},d),this}getClusterLeaves(o,d,p,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:d,offset:p},y),this}_updateWorkerData(o){const d=l.e({},this.workerOptions);o?d.dataDiff=o:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(l.h.resolveURL(this._data),z.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(p,y)=>{if(this._pendingLoads--,this._removed||y&&y.abandoned)return void this.fire(new l.k("dataabort",{dataType:"source"}));let b=null;if(y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b=y.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.j(p));const E={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&l.e(E,{resourceTiming:b}),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new l.k("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(o,d){const p=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const y={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(p,y,(b,E)=>(delete o.request,o.unloadVectorData(),o.aborted?d(null):b?d(b):(o.loadVectorData(E,this.map.painter,p==="reloadTile"),d(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Et=l.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ln extends l.E{constructor(o,d,p,y){super(),this.load=(b,E)=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=W.getImage(this.map._requestManager.transformRequest(this.url,z.Image),(C,k)=>{this._request=null,this._loaded=!0,C?this.fire(new l.j(C)):k&&(this.image=k,b&&(this.coordinates=b),E&&E(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _e(b,this.image,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let C=!1;for(const k in this.tiles){const R=this.tiles[k];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,C=!0)}C&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=o,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=d}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(o){this.coordinates=o;const d=o.map(l.U.fromLngLat);this.tileID=function(y){let b=1/0,E=1/0,C=-1/0,k=-1/0;for(const X of y)b=Math.min(b,X.x),E=Math.min(E,X.y),C=Math.max(C,X.x),k=Math.max(k,X.y);const R=Math.max(C-b,k-E),j=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),V=Math.pow(2,j);return new l.W(j,Math.floor((b+C)/2*V),Math.floor((E+k)/2*V))}(d),this.minzoom=this.maxzoom=this.tileID.z;const p=d.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new l.V,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,l.N,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,l.N),this._boundsArray.emplaceBack(p[2].x,p[2].y,l.N,l.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(o,d){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},d(null)):(o.state="errored",d(null))}hasTransition(){return!1}}class Qt extends ln{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!1;const b=this.options;this.urls=[];for(const E of b.urls)this.urls.push(this.map._requestManager.transformRequest(E,z.Source).url);l.X(this.urls,(E,C)=>{this._loaded=!0,E?this.fire(new l.j(E)):C&&(this.video=C,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,E=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.texSubImage2D(E.TEXTURE_2D,0,0,0,E.RGBA,E.UNSIGNED_BYTE,this.video)):(this.texture=new _e(b,this.video,E.RGBA),this.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE));let C=!1;for(const k in this.tiles){const R=this.tiles[k];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,C=!0)}C&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const d=this.video.seekable;o<d.start(0)||o>d.end(0)?this.fire(new l.j(new l.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class mn extends ln{constructor(o,d,p,y){super(o,d,p,y),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const E=this.map.painter.context,C=E.gl;this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _e(E,this.canvas,C.RGBA,{premultiply:!0});let k=!1;for(const R in this.tiles){const j=this.tiles[R];j.state!=="loaded"&&(j.state="loaded",j.texture=this.texture,k=!0)}k&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(E=>typeof E!="number"))||this.fire(new l.j(new l.Y(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.j(new l.Y(`sources.${o}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.j(new l.Y(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new l.j(new l.Y(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.j(new l.Y(`sources.${o}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ut={},At=v=>{switch(v){case"geojson":return qt;case"image":return ln;case"raster":return xt;case"raster-dem":return Ht;case"vector":return Qe;case"video":return Qt;case"canvas":return mn}return Ut[v]};function Lt(v,o){const d=l.Z();return l.$(d,d,[1,1,0]),l.a0(d,d,[.5*v.width,.5*v.height,1]),l.a1(d,d,v.calculatePosMatrix(o.toUnwrapped()))}function yn(v,o,d,p,y,b){const E=function(V,X,ce){if(V)for(const le of V){const fe=X[le];if(fe&&fe.source===ce&&fe.type==="fill-extrusion")return!0}else for(const le in X){const fe=X[le];if(fe.source===ce&&fe.type==="fill-extrusion")return!0}return!1}(y&&y.layers,o,v.id),C=b.maxPitchScaleFactor(),k=v.tilesIn(p,C,E);k.sort(vn);const R=[];for(const V of k)R.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(o,d,v._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,y,b,C,Lt(v.transform,V.tileID))});const j=function(V){const X={},ce={};for(const le of V){const fe=le.queryResults,oe=le.wrappedTileID,Pe=ce[oe]=ce[oe]||{};for(const Oe in fe){const ge=fe[Oe],Ie=Pe[Oe]=Pe[Oe]||{},De=X[Oe]=X[Oe]||[];for(const Be of ge)Ie[Be.featureIndex]||(Ie[Be.featureIndex]=!0,De.push(Be))}}return X}(R);for(const V in j)j[V].forEach(X=>{const ce=X.feature,le=v.getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=le});return j}function vn(v,o){const d=v.tileID,p=o.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}class ut{constructor(o,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=l.a2(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const d=o+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(y,b){const E={};if(!b)return E;for(const C of y){const k=C.layerIds.map(R=>b.getLayer(R)).filter(Boolean);if(k.length!==0){C.layers=k,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(R=>k.filter(j=>j.id===R)[0]));for(const R of k)E[R.id]=C}}return E}(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.a4){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.a4&&b.hasRTLText){this.hasRTLText=!0,l.a5();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(y).queryRadius(b))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new l.a3}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(o)}const d=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _e(o,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _e(o,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,d,p,y,b,E,C,k,R,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:b,scale:E,tileSize:this.tileSize,pixelPosMatrix:j,transform:k,params:C,queryPadding:this.queryPadding*R},o,d,p):{}}querySourceFeatures(o,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),b=d&&d.sourceLayer?d.sourceLayer:"",E=y._geojsonTileLayer||y[b];if(!E)return;const C=l.a6(d&&d.filter),{z:k,x:R,y:j}=this.tileID.canonical,V={z:k,x:R,y:j};for(let X=0;X<E.length;X++){const ce=E.feature(X);if(C.needGeometry){const oe=l.a7(ce,!0);if(!C.filter(new l.a8(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new l.a8(this.tileID.overscaledZ),ce))continue;const le=p.getId(ce,b),fe=new l.a9(ce,k,R,j,le);fe.tile=V,o.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const p=l.aa(o.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(d)if(this.expirationTime<d)y=!0;else{const b=this.expirationTime-d;b?this.expirationTime=p+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!d.style.hasLayer(y))continue;const b=this.buckets[y],E=b.layers[0].sourceLayer||"_geojsonTileLayer",C=p[E],k=o[E];if(!C||!k||Object.keys(k).length===0)continue;b.update(k,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const R=d&&d.style&&d.style.getLayer(y);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=l.h.now()+o}setDependencies(o,d){const p={};for(const y of d)p[y]=!0;this.dependencies[o]=p}hasDependency(o,d){for(const p of o){const y=this.dependencies[p];if(y){for(const b of d)if(y[b])return!0}}return!1}}class cn{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,p){const y=o.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const b={value:d,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(o,b)},p)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const p=o.wrapped().key,y=d===void 0?0:this.data[p].indexOf(d),b=this.data[p][y];return this.data[p].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const p in this.data)for(const y of this.data[p])o(y.value)||d.push(y);for(const p of d)this.remove(p.value.tileID,p)}}class Ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,p){const y=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},l.e(this.stateChanges[o][y],p),this.deletedStates[o]===null){this.deletedStates[o]={};for(const b in this.state[o])b!==y&&(this.deletedStates[o][b]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][y]===null){this.deletedStates[o][y]={};for(const b in this.state[o][y])p[b]||(this.deletedStates[o][y][b]=null)}else for(const b in p)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][b]===null&&delete this.deletedStates[o][y][b]}removeFeatureState(o,d,p){if(this.deletedStates[o]===null)return;const y=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},p&&d!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][p]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(p in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][p]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,d){const p=String(d),y=l.e({},(this.state[o]||{})[p],(this.stateChanges[o]||{})[p]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const b=this.deletedStates[o][d];if(b===null)return{};for(const E in b)delete y[E]}return y}initializeTileState(o,d){o.setFeatureState(this.state,d)}coalesceChanges(o,d){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),l.e(this.state[y][E],this.stateChanges[y][E]),b[E]=this.state[y][E];p[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(this.deletedStates[y]===null)for(const E in this.state[y])b[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else for(const C of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][C];b[E]=this.state[y][E]}p[y]=p[y]||{},l.e(p[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in o)o[y].setFeatureState(p,d)}}class Tt extends l.E{constructor(o,d,p){super(),this.id=o,this.dispatcher=p,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,b,E,C)=>{const k=new(At(b.type))(y,b,E,C);if(k.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${k.id}`);return k})(o,d,p,this),this._tiles={},this._cache=new cn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ae,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,d){return this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new l.k("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(o),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(bn).map(o=>o.key)}getRenderableIds(o){const d=[];for(const p in this._tiles)this._isIdRenderable(p,o)&&d.push(this._tiles[p]);return o?d.sort((p,y)=>{const b=p.tileID,E=y.tileID,C=new l.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),k=new l.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||k.y-C.y||k.x-C.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(bn).map(p=>p.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,d){const p=this._tiles[o];p&&(p.state!=="loading"&&(p.state=d),this._loadTile(p,this._tileLoaded.bind(this,p,o,d)))}_tileLoaded(o,d,p,y){if(y)return o.state="errored",void(y.status!==404?this._source.fire(new l.j(y,{tile:o})):this.update(this.transform,this.terrain));o.timeAdded=l.h.now(),p==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new l.k("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const d=this.getRenderableIds();for(let y=0;y<d.length;y++){const b=d[y];if(o.neighboringTiles&&o.neighboringTiles[b]){const E=this.getTileByID(b);p(o,E),p(E,o)}}function p(y,b){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let E=b.tileID.canonical.x-y.tileID.canonical.x;const C=b.tileID.canonical.y-y.tileID.canonical.y,k=Math.pow(2,y.tileID.canonical.z),R=b.tileID.key;E===0&&C===0||Math.abs(C)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,E,C),y.neighboringTiles&&y.neighboringTiles[R]&&(y.neighboringTiles[R].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,p,y){for(const b in this._tiles){let E=this._tiles[b];if(y[b]||!E.hasData()||E.tileID.overscaledZ<=d||E.tileID.overscaledZ>p)continue;let C=E.tileID;for(;E&&E.tileID.overscaledZ>d+1;){const R=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[R.key],E&&E.hasData()&&(C=R)}let k=C;for(;k.overscaledZ>d;)if(k=k.scaledTo(k.overscaledZ-1),o[k.key]){y[C.key]=C;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const p=this._loadedParentTiles[o.key];return p&&p.tileID.overscaledZ>=d?p:null}for(let p=o.overscaledZ-1;p>=d;p--){const y=o.scaledTo(p),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const d=Math.ceil(o.width/this._source.tileSize)+1,p=Math.ceil(o.height/this._source.tileSize)+1,y=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const p={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+d),p[b.tileID.key]=b}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(o,d){if(this.transform=o,this.terrain=d,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new l.O(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(p=o.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(p=p.filter(j=>this._source.hasTile(j)))):p=[];const y=o.coveringZoomLevel(this._source),b=Math.max(y-Tt.maxOverzooming,this._source.minzoom),E=Math.max(y+Tt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const V of p)if(V.canonical.z>this._source.minzoom){const X=V.scaledTo(V.canonical.z-1);j[X.key]=X;const ce=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));j[ce.key]=ce}p=p.concat(Object.values(j))}const C=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new l.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(p,y);if(Xt(this._source.type)){const j={},V={},X=Object.keys(k),ce=l.h.now();for(const le of X){const fe=k[le],oe=this._tiles[le];if(!oe||oe.fadeEndTime!==0&&oe.fadeEndTime<=ce)continue;const Pe=this.findLoadedParent(fe,b);Pe&&(this._addTile(Pe.tileID),j[Pe.tileID.key]=Pe.tileID),V[le]=fe}this._retainLoadedChildren(V,y,E,k);for(const le in j)k[le]||(this._coveredTiles[le]=!0,k[le]=j[le]);if(d){const le={},fe={};for(const oe of p)this._tiles[oe.key].hasData()?le[oe.key]=oe:fe[oe.key]=oe;for(const oe in fe){const Pe=fe[oe].children(this._source.maxzoom);this._tiles[Pe[0].key]&&this._tiles[Pe[1].key]&&this._tiles[Pe[2].key]&&this._tiles[Pe[3].key]&&(le[Pe[0].key]=k[Pe[0].key]=Pe[0],le[Pe[1].key]=k[Pe[1].key]=Pe[1],le[Pe[2].key]=k[Pe[2].key]=Pe[2],le[Pe[3].key]=k[Pe[3].key]=Pe[3],delete fe[oe])}for(const oe in fe){const Pe=this.findLoadedParent(fe[oe],this._source.minzoom);if(Pe){le[Pe.tileID.key]=k[Pe.tileID.key]=Pe.tileID;for(const Oe in le)le[Oe].isChildOf(Pe.tileID)&&delete le[Oe]}}for(const oe in this._tiles)le[oe]||(this._coveredTiles[oe]=!0)}}for(const j in k)this._tiles[j].clearFadeHold();const R=l.ab(this._tiles,k);for(const j of R){const V=this._tiles[j];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,d){const p={},y={},b=Math.max(d-Tt.maxOverzooming,this._source.minzoom),E=Math.max(d+Tt.maxUnderzooming,this._source.minzoom),C={};for(const k of o){const R=this._addTile(k);p[k.key]=k,R.hasData()||d<this._source.maxzoom&&(C[k.key]=k)}this._retainLoadedChildren(C,d,E,p);for(const k of o){let R=this._tiles[k.key];if(R.hasData())continue;if(d+1>this._source.maxzoom){const V=k.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){p[V.key]=V;continue}}else{const V=k.children(this._source.maxzoom);if(p[V[0].key]&&p[V[1].key]&&p[V[2].key]&&p[V[3].key])continue}let j=R.wasRequested();for(let V=k.overscaledZ-1;V>=b;--V){const X=k.scaledTo(V);if(y[X.key])break;if(y[X.key]=!0,R=this.getTile(X),!R&&j&&(R=this._addTile(X)),R){const ce=R.hasData();if((j||ce)&&(p[X.key]=X),j=R.wasRequested(),ce)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let p,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}d.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;y=b}for(const b of d)this._loadedParentTiles[b]=p}}_addTile(o){let d=this._tiles[o.key];if(d)return d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const p=d;return d||(d=new ut(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))),d.uses++,this._tiles[o.key]=d,p||this._source.fire(new l.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const p=d.getExpiryTimeout();p&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},p))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,d,p){const y=[],b=this.transform;if(!b)return y;const E=p?b.getCameraQueryGeometry(o):o,C=o.map(le=>b.pointCoordinate(le,this.terrain)),k=E.map(le=>b.pointCoordinate(le,this.terrain)),R=this.getIds();let j=1/0,V=1/0,X=-1/0,ce=-1/0;for(const le of k)j=Math.min(j,le.x),V=Math.min(V,le.y),X=Math.max(X,le.x),ce=Math.max(ce,le.y);for(let le=0;le<R.length;le++){const fe=this._tiles[R[le]];if(fe.holdingForFade())continue;const oe=fe.tileID,Pe=Math.pow(2,b.zoom-fe.tileID.overscaledZ),Oe=d*fe.queryPadding*l.N/fe.tileSize/Pe,ge=[oe.getTilePoint(new l.U(j,V)),oe.getTilePoint(new l.U(X,ce))];if(ge[0].x-Oe<l.N&&ge[0].y-Oe<l.N&&ge[1].x+Oe>=0&&ge[1].y+Oe>=0){const Ie=C.map(Be=>oe.getTilePoint(Be)),De=k.map(Be=>oe.getTilePoint(Be));y.push({tile:fe,tileID:oe,queryGeometry:Ie,cameraQueryGeometry:De,scale:Pe})}}return y}getVisibleCoordinates(o){const d=this.getRenderableIds(o).map(p=>this._tiles[p].tileID);for(const p of d)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Xt(this._source.type)){const o=l.h.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=o)return!0}return!1}setFeatureState(o,d,p){this._state.updateState(o=o||"_geojsonTileLayer",d,p)}removeFeatureState(o,d,p){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,p)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,p){const y=this._tiles[o];y&&y.setDependencies(d,p)}reloadTilesForDependencies(o,d){for(const p in this._tiles)this._tiles[p].hasDependency(o,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(o,d))}}function bn(v,o){const d=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*o.wrap)-+(o.wrap<0);return v.overscaledZ-o.overscaledZ||p-d||o.canonical.y-v.canonical.y||o.canonical.x-v.canonical.x}function Xt(v){return v==="raster"||v==="image"||v==="video"}Tt.maxOverzooming=10,Tt.maxUnderzooming=3;const It="mapboxgl_preloaded_worker_pool";class Mn{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Mn.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const Bn=Math.floor(l.h.hardwareConcurrency/2);let On;function et(){return On||(On=new Mn),On}Mn.workerCount=l.ac(globalThis)?Math.max(Math.min(Bn,3),1):1;class Xe{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=l.ad(o,0,1);let d=1,p=this._distances[d];const y=o*this.paddedLength+this.padding;for(;p<y&&d<this._distances.length;)p=this._distances[++d];const b=d-1,E=this._distances[b],C=p-E,k=C>0?(y-E)/C:0;return this.points[b].mult(1-k).add(this.points[d].mult(k))}}function yt(v,o){let d=!0;return v==="always"||v!=="never"&&o!=="never"||(d=!1),d}class un{constructor(o,d,p){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/p),this.yCellCount=Math.ceil(d/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,p,y,b){this._forEachCell(d,p,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(o,d,p,y){this._forEachCell(d-y,p-y,d+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(p),this.circles.push(y)}_insertBoxCell(o,d,p,y,b,E){this.boxCells[b].push(E)}_insertCircleCell(o,d,p,y,b,E){this.circleCells[b].push(E)}_query(o,d,p,y,b,E,C){if(p<0||o>this.width||y<0||d>this.height)return[];const k=[];if(o<=0&&d<=0&&this.width<=p&&this.height<=y){if(b)return[{key:null,x1:o,y1:d,x2:p,y2:y}];for(let R=0;R<this.boxKeys.length;R++)k.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const j=this.circles[3*R],V=this.circles[3*R+1],X=this.circles[3*R+2];k.push({key:this.circleKeys[R],x1:j-X,y1:V-X,x2:j+X,y2:V+X})}}else this._forEachCell(o,d,p,y,this._queryCell,k,{hitTest:b,overlapMode:E,seenUids:{box:{},circle:{}}},C);return k}query(o,d,p,y){return this._query(o,d,p,y,!1,null)}hitTest(o,d,p,y,b,E){return this._query(o,d,p,y,!0,b,E).length>0}hitTestCircle(o,d,p,y,b){const E=o-p,C=o+p,k=d-p,R=d+p;if(C<0||E>this.width||R<0||k>this.height)return!1;const j=[];return this._forEachCell(E,k,C,R,this._queryCellCircle,j,{hitTest:!0,overlapMode:y,circle:{x:o,y:d,radius:p},seenUids:{box:{},circle:{}}},b),j.length>0}_queryCell(o,d,p,y,b,E,C,k){const{seenUids:R,hitTest:j,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const le=this.bboxes;for(const fe of X)if(!R.box[fe]){R.box[fe]=!0;const oe=4*fe,Pe=this.boxKeys[fe];if(o<=le[oe+2]&&d<=le[oe+3]&&p>=le[oe+0]&&y>=le[oe+1]&&(!k||k(Pe))&&(!j||!yt(V,Pe.overlapMode))&&(E.push({key:Pe,x1:le[oe],y1:le[oe+1],x2:le[oe+2],y2:le[oe+3]}),j))return!0}}const ce=this.circleCells[b];if(ce!==null){const le=this.circles;for(const fe of ce)if(!R.circle[fe]){R.circle[fe]=!0;const oe=3*fe,Pe=this.circleKeys[fe];if(this._circleAndRectCollide(le[oe],le[oe+1],le[oe+2],o,d,p,y)&&(!k||k(Pe))&&(!j||!yt(V,Pe.overlapMode))){const Oe=le[oe],ge=le[oe+1],Ie=le[oe+2];if(E.push({key:Pe,x1:Oe-Ie,y1:ge-Ie,x2:Oe+Ie,y2:ge+Ie}),j)return!0}}}return!1}_queryCellCircle(o,d,p,y,b,E,C,k){const{circle:R,seenUids:j,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const le=this.bboxes;for(const fe of X)if(!j.box[fe]){j.box[fe]=!0;const oe=4*fe,Pe=this.boxKeys[fe];if(this._circleAndRectCollide(R.x,R.y,R.radius,le[oe+0],le[oe+1],le[oe+2],le[oe+3])&&(!k||k(Pe))&&!yt(V,Pe.overlapMode))return E.push(!0),!0}}const ce=this.circleCells[b];if(ce!==null){const le=this.circles;for(const fe of ce)if(!j.circle[fe]){j.circle[fe]=!0;const oe=3*fe,Pe=this.circleKeys[fe];if(this._circlesCollide(le[oe],le[oe+1],le[oe+2],R.x,R.y,R.radius)&&(!k||k(Pe))&&!yt(V,Pe.overlapMode))return E.push(!0),!0}}}_forEachCell(o,d,p,y,b,E,C,k){const R=this._convertToXCellCoord(o),j=this._convertToYCellCoord(d),V=this._convertToXCellCoord(p),X=this._convertToYCellCoord(y);for(let ce=R;ce<=V;ce++)for(let le=j;le<=X;le++)if(b.call(this,o,d,p,y,this.xCellCount*le+ce,E,C,k))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,p,y,b,E){const C=y-o,k=b-d,R=p+E;return R*R>C*C+k*k}_circleAndRectCollide(o,d,p,y,b,E,C){const k=(E-y)/2,R=Math.abs(o-(y+k));if(R>k+p)return!1;const j=(C-b)/2,V=Math.abs(d-(b+j));if(V>j+p)return!1;if(R<=k||V<=j)return!0;const X=R-k,ce=V-j;return X*X+ce*ce<=p*p}}function $e(v,o,d,p,y){const b=l.Z();return o?(l.a0(b,b,[1/y,1/y,1]),d||l.ae(b,b,p.angle)):l.a1(b,p.labelPlaneMatrix,v),b}function ot(v,o,d,p,y){if(o){const b=l.af(v);return l.a0(b,b,[y,y,1]),d||l.ae(b,b,-p.angle),b}return p.glCoordMatrix}function $t(v,o,d){let p;d?(p=[v.x,v.y,d(v.x,v.y),1],l.ag(p,p,o)):(p=[v.x,v.y,0,1],de(p,p,o));const y=p[3];return{point:new l.P(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function wn(v,o){return .5+v/o*.5}function pn(v,o){const d=v[0]/v[3],p=v[1]/v[3];return d>=-o[0]&&d<=o[0]&&p>=-o[1]&&p<=o[1]}function nt(v,o,d,p,y,b,E,C,k,R){const j=p?v.textSizeData:v.iconSizeData,V=l.ah(j,d.transform.zoom),X=[256/d.width*2+1,256/d.height*2+1],ce=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ce.clear();const le=v.lineVertexArray,fe=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,oe=d.transform.width/d.transform.height;let Pe=!1;for(let Oe=0;Oe<fe.length;Oe++){const ge=fe.get(Oe);if(ge.hidden||ge.writingMode===l.ai.vertical&&!Pe){ne(ge.numGlyphs,ce);continue}let Ie;if(Pe=!1,R?(Ie=[ge.anchorX,ge.anchorY,R(ge.anchorX,ge.anchorY),1],l.ag(Ie,Ie,o)):(Ie=[ge.anchorX,ge.anchorY,0,1],de(Ie,Ie,o)),!pn(Ie,X)){ne(ge.numGlyphs,ce);continue}const De=wn(d.transform.cameraToCenterDistance,Ie[3]),Be=l.aj(j,V,ge),Ke=E?Be/De:Be*De,rt=new l.P(ge.anchorX,ge.anchorY),tt=$t(rt,y,R).point,ct={projections:{},offsets:{}},zt=Pr(ge,Ke,!1,C,o,y,b,v.glyphOffsetArray,le,ce,tt,rt,ct,oe,k,R);Pe=zt.useVertical,(zt.notEnoughRoom||Pe||zt.needsFlipping&&Pr(ge,Ke,!0,C,o,y,b,v.glyphOffsetArray,le,ce,tt,rt,ct,oe,k,R).notEnoughRoom)&&ne(ge.numGlyphs,ce)}p?v.text.dynamicLayoutVertexBuffer.updateData(ce):v.icon.dynamicLayoutVertexBuffer.updateData(ce)}function en(v,o,d,p,y,b,E,C,k,R,j,V,X){const ce=C.glyphStartIndex+C.numGlyphs,le=C.lineStartIndex,fe=C.lineStartIndex+C.lineLength,oe=o.getoffsetX(C.glyphStartIndex),Pe=o.getoffsetX(ce-1),Oe=G(v*oe,d,p,y,b,E,C.segment,le,fe,k,R,j,V,X);if(!Oe)return null;const ge=G(v*Pe,d,p,y,b,E,C.segment,le,fe,k,R,j,V,X);return ge?{first:Oe,last:ge}:null}function sn(v,o,d,p){return v===l.ai.horizontal&&Math.abs(d.y-o.y)>Math.abs(d.x-o.x)*p?{useVertical:!0}:(v===l.ai.vertical?o.y<d.y:o.x>d.x)?{needsFlipping:!0}:null}function Pr(v,o,d,p,y,b,E,C,k,R,j,V,X,ce,le,fe){const oe=o/24,Pe=v.lineOffsetX*oe,Oe=v.lineOffsetY*oe;let ge;if(v.numGlyphs>1){const Ie=v.glyphStartIndex+v.numGlyphs,De=v.lineStartIndex,Be=v.lineStartIndex+v.lineLength,Ke=en(oe,C,Pe,Oe,d,j,V,v,k,b,X,le,fe);if(!Ke)return{notEnoughRoom:!0};const rt=$t(Ke.first.point,E,fe).point,tt=$t(Ke.last.point,E,fe).point;if(p&&!d){const ct=sn(v.writingMode,rt,tt,ce);if(ct)return ct}ge=[Ke.first];for(let ct=v.glyphStartIndex+1;ct<Ie-1;ct++)ge.push(G(oe*C.getoffsetX(ct),Pe,Oe,d,j,V,v.segment,De,Be,k,b,X,le,fe));ge.push(Ke.last)}else{if(p&&!d){const De=$t(V,y,fe).point,Be=v.lineStartIndex+v.segment+1,Ke=new l.P(k.getx(Be),k.gety(Be)),rt=$t(Ke,y,fe),tt=rt.signedDistanceFromCamera>0?rt.point:ci(V,Ke,De,1,y,fe),ct=sn(v.writingMode,De,tt,ce);if(ct)return ct}const Ie=G(oe*C.getoffsetX(v.glyphStartIndex),Pe,Oe,d,j,V,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,k,b,X,le,fe);if(!Ie)return{notEnoughRoom:!0};ge=[Ie]}for(const Ie of ge)l.ak(R,Ie.point,Ie.angle);return{}}function ci(v,o,d,p,y,b){const E=$t(v.add(v.sub(o)._unit()),y,b).point,C=d.sub(E);return d.add(C._mult(p/C.mag()))}function on(v,o){const{projectionCache:d,lineVertexArray:p,labelPlaneMatrix:y,tileAnchorPoint:b,distanceFromAnchor:E,getElevation:C,previousVertex:k,direction:R,absOffsetX:j}=o;if(d.projections[v])return d.projections[v];const V=new l.P(p.getx(v),p.gety(v)),X=$t(V,y,C);if(X.signedDistanceFromCamera>0)return d.projections[v]=X.point,X.point;const ce=v-R;return ci(E===0?b:new l.P(p.getx(ce),p.gety(ce)),V,k,j-E+1,y,C)}function Vr(v,o,d){return v._unit()._perp()._mult(o*d)}function he(v,o,d,p,y,b,E,C){const{projectionCache:k,direction:R}=C;if(k.offsets[v])return k.offsets[v];const j=d.add(o);if(v+R<p||v+R>=y)return k.offsets[v]=j,j;const V=on(v+R,C),X=Vr(V.sub(d),E,R),ce=d.add(X),le=V.add(X);return k.offsets[v]=l.al(b,j,ce,le)||j,k.offsets[v]}function G(v,o,d,p,y,b,E,C,k,R,j,V,X,ce){const le=p?v-o:v+o;let fe=le>0?1:-1,oe=0;p&&(fe*=-1,oe=Math.PI),fe<0&&(oe+=Math.PI);let Pe,Oe,ge=fe>0?C+E:C+E+1,Ie=y,De=y,Be=0,Ke=0;const rt=Math.abs(le),tt=[];let ct;for(;Be+Ke<=rt;){if(ge+=fe,ge<C||ge>=k)return null;Be+=Ke,De=Ie,Oe=Pe;const mt={projectionCache:V,lineVertexArray:R,labelPlaneMatrix:j,tileAnchorPoint:b,distanceFromAnchor:Be,getElevation:ce,previousVertex:De,direction:fe,absOffsetX:rt};if(Ie=on(ge,mt),d===0)tt.push(De),ct=Ie.sub(De);else{let rn;const Nt=Ie.sub(De);rn=Nt.mag()===0?Vr(on(ge+fe,mt).sub(Ie),d,fe):Vr(Nt,d,fe),Oe||(Oe=De.add(rn)),Pe=he(ge,rn,Ie,C,k,Oe,d,mt),tt.push(Oe),ct=Pe.sub(Oe)}Ke=ct.mag()}const zt=ct._mult((rt-Be)/Ke)._add(Oe||De),Cn=oe+Math.atan2(Ie.y-De.y,Ie.x-De.x);return tt.push(zt),{point:zt,angle:X?Cn:0,path:tt}}const q=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ne(v,o){for(let d=0;d<v;d++){const p=o.length;o.resize(p+4),o.float32.set(q,3*p)}}function de(v,o,d){const p=o[0],y=o[1];return v[0]=d[0]*p+d[4]*y+d[12],v[1]=d[1]*p+d[5]*y+d[13],v[3]=d[3]*p+d[7]*y+d[15],v}const pe=100;class Me{constructor(o,d=new un(o.width+200,o.height+200,25),p=new un(o.width+200,o.height+200,25)){this.transform=o,this.grid=d,this.ignoredGrid=p,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+pe,this.screenBottomBoundary=o.height+pe,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,d,p,y,b,E){const C=this.projectAndGetPerspectiveRatio(y,o.anchorPointX,o.anchorPointY,E),k=p*C.perspectiveRatio,R=o.x1*k+C.point.x,j=o.y1*k+C.point.y,V=o.x2*k+C.point.x,X=o.y2*k+C.point.y;return!this.isInsideGrid(R,j,V,X)||d!=="always"&&this.grid.hitTest(R,j,V,X,d,b)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[R,j,V,X],offscreen:this.isOffscreen(R,j,V,X)}}placeCollisionCircles(o,d,p,y,b,E,C,k,R,j,V,X,ce,le){const fe=[],oe=new l.P(d.anchorX,d.anchorY),Pe=$t(oe,E,le),Oe=wn(this.transform.cameraToCenterDistance,Pe.signedDistanceFromCamera),ge=(j?b/Oe:b*Oe)/l.ap,Ie=$t(oe,C,le).point,De=en(ge,y,d.lineOffsetX*ge,d.lineOffsetY*ge,!1,Ie,oe,d,p,C,{projections:{},offsets:{}},!1,le);let Be=!1,Ke=!1,rt=!0;if(De){const tt=.5*X*Oe+ce,ct=new l.P(-100,-100),zt=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Cn=new Xe,mt=De.first,rn=De.last;let Nt=[];for(let xn=mt.path.length-1;xn>=1;xn--)Nt.push(mt.path[xn]);for(let xn=1;xn<rn.path.length;xn++)Nt.push(rn.path[xn]);const Wn=2.5*tt;if(k){const xn=Nt.map(An=>$t(An,k,le));Nt=xn.some(An=>An.signedDistanceFromCamera<=0)?[]:xn.map(An=>An.point)}let En=[];if(Nt.length>0){const xn=Nt[0].clone(),An=Nt[0].clone();for(let Ar=1;Ar<Nt.length;Ar++)xn.x=Math.min(xn.x,Nt[Ar].x),xn.y=Math.min(xn.y,Nt[Ar].y),An.x=Math.max(An.x,Nt[Ar].x),An.y=Math.max(An.y,Nt[Ar].y);En=xn.x>=ct.x&&An.x<=zt.x&&xn.y>=ct.y&&An.y<=zt.y?[Nt]:An.x<ct.x||xn.x>zt.x||An.y<ct.y||xn.y>zt.y?[]:l.am([Nt],ct.x,ct.y,zt.x,zt.y)}for(const xn of En){Cn.reset(xn,.25*tt);let An=0;An=Cn.length<=.5*tt?1:Math.ceil(Cn.paddedLength/Wn)+1;for(let Ar=0;Ar<An;Ar++){const er=Ar/Math.max(An-1,1),pi=Cn.lerp(er),Jr=pi.x+pe,Or=pi.y+pe;fe.push(Jr,Or,tt,0);const ms=Jr-tt,or=Or-tt,yo=Jr+tt,_o=Or+tt;if(rt=rt&&this.isOffscreen(ms,or,yo,_o),Ke=Ke||this.isInsideGrid(ms,or,yo,_o),o!=="always"&&this.grid.hitTestCircle(Jr,Or,tt,o,V)&&(Be=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Be}}}}return{circles:!R&&Be||!Ke||Oe<this.perspectiveRatioCutoff?[]:fe,offscreen:rt,collisionDetected:Be}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let p=1/0,y=1/0,b=-1/0,E=-1/0;for(const j of o){const V=new l.P(j.x+pe,j.y+pe);p=Math.min(p,V.x),y=Math.min(y,V.y),b=Math.max(b,V.x),E=Math.max(E,V.y),d.push(V)}const C=this.grid.query(p,y,b,E).concat(this.ignoredGrid.query(p,y,b,E)),k={},R={};for(const j of C){const V=j.key;if(k[V.bucketInstanceId]===void 0&&(k[V.bucketInstanceId]={}),k[V.bucketInstanceId][V.featureIndex])continue;const X=[new l.P(j.x1,j.y1),new l.P(j.x2,j.y1),new l.P(j.x2,j.y2),new l.P(j.x1,j.y2)];l.an(d,X)&&(k[V.bucketInstanceId][V.featureIndex]=!0,R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]=[]),R[V.bucketInstanceId].push(V.featureIndex))}return R}insertCollisionBox(o,d,p,y,b,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:E,overlapMode:d},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,p,y,b,E){const C=p?this.ignoredGrid:this.grid,k={bucketInstanceId:y,featureIndex:b,collisionGroupID:E,overlapMode:d};for(let R=0;R<o.length;R+=4)C.insertCircle(k,o[R],o[R+1],o[R+2])}projectAndGetPerspectiveRatio(o,d,p,y){let b;return y?(b=[d,p,y(d,p),1],l.ag(b,b,o)):(b=[d,p,0,1],de(b,b,o)),{point:new l.P((b[0]/b[3]+1)/2*this.transform.width+pe,(-b[1]/b[3]+1)/2*this.transform.height+pe),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(o,d,p,y){return p<pe||o>=this.screenRightBoundary||y<pe||d>this.screenBottomBoundary}isInsideGrid(o,d,p,y){return p>=0&&o<this.gridRightBoundary&&y>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=l.ao([]);return l.$(o,o,[-100,-100,0]),o}}function be(v,o,d){return o*(l.N/(v.tileSize*Math.pow(2,d-v.tileID.overscaledZ)))}class ye{constructor(o,d,p,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Ee{constructor(o,d,p,y,b){this.text=new ye(o?o.text:null,d,p,b),this.icon=new ye(o?o.icon:null,d,y,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ue{constructor(o,d,p){this.text=o,this.icon=d,this.skipFade=p}}class We{constructor(){this.invProjMatrix=l.Z(),this.viewportMatrix=l.Z(),this.circles=[]}}class He{constructor(o,d,p,y,b){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=b}}class Rt{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[o]}}function Kt(v,o,d,p,y){const{horizontalAlign:b,verticalAlign:E}=l.au(v);return new l.P(-(b-.5)*o+p[0]*y,-(E-.5)*d+p[1]*y)}function St(v,o,d,p,y,b){const{x1:E,x2:C,y1:k,y2:R,anchorPointX:j,anchorPointY:V}=v,X=new l.P(o,d);return p&&X._rotate(y?b:-b),{x1:E+X.x,y1:k+X.y,x2:C+X.x,y2:R+X.y,anchorPointX:j,anchorPointY:V}}class Ft{constructor(o,d,p,y,b){this.transform=o.clone(),this.terrain=d,this.collisionIndex=new Me(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Rt(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,p,y){const b=p.getBucket(d),E=p.latestFeatureIndex;if(!b||!E||d.id!==b.layerIds[0])return;const C=p.collisionBoxArray,k=b.layers[0].layout,R=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),j=p.tileSize/l.N,V=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),X=k.get("text-pitch-alignment")==="map",ce=k.get("text-rotation-alignment")==="map",le=be(p,1,this.transform.zoom),fe=$e(V,X,ce,this.transform,le);let oe=null;if(X){const Oe=ot(V,X,ce,this.transform,le);oe=l.a1([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[b.bucketInstanceId]=new He(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,p.tileID);const Pe={bucket:b,layout:k,posMatrix:V,textLabelPlaneMatrix:fe,labelToScreenMatrix:oe,scale:R,textPixelRatio:j,holdingForFade:p.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:l.ah(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Oe of b.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:De}=Oe;o.push({sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:De,parameters:Pe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(o,d,p,y,b,E,C,k,R,j,V,X,ce,le,fe,oe){const Pe=l.aq[o.textAnchor],Oe=[o.textOffset0,o.textOffset1],ge=Kt(Pe,p,y,Oe,b),Ie=this.collisionIndex.placeCollisionBox(St(d,ge.x,ge.y,E,C,this.transform.angle),V,k,R,j.predicate,oe);if((!fe||this.collisionIndex.placeCollisionBox(St(fe,ge.x,ge.y,E,C,this.transform.angle),V,k,R,j.predicate,oe).box.length!==0)&&Ie.box.length>0){let De;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(De=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Oe,width:p,height:y,anchor:Pe,textBoxScale:b,prevAnchor:De},this.markUsedJustification(ce,Pe,X,le),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,le,X),this.placedOrientations[X.crossTileID]=le),{shift:ge,placedGlyphBoxes:Ie}}}placeLayerBucketPart(o,d,p){const{bucket:y,layout:b,posMatrix:E,textLabelPlaneMatrix:C,labelToScreenMatrix:k,textPixelRatio:R,holdingForFade:j,collisionBoxArray:V,partiallyEvaluatedTextSize:X,collisionGroup:ce}=o.parameters,le=b.get("text-optional"),fe=b.get("icon-optional"),oe=l.ar(b,"text-overlap","text-allow-overlap"),Pe=oe==="always",Oe=l.ar(b,"icon-overlap","icon-allow-overlap"),ge=Oe==="always",Ie=b.get("text-rotation-alignment")==="map",De=b.get("text-pitch-alignment")==="map",Be=b.get("icon-text-fit")!=="none",Ke=b.get("symbol-z-order")==="viewport-y",rt=Pe&&(ge||!y.hasIconData()||fe),tt=ge&&(Pe||!y.hasTextData()||le);!y.collisionArrays&&V&&y.deserializeCollisionBoxes(V);const ct=this.retainedQueryData[y.bucketInstanceId].tileID,zt=this.terrain?(mt,rn)=>this.terrain.getElevation(ct,mt,rn):null,Cn=(mt,rn)=>{var Nt,Wn;if(d[mt.crossTileID])return;if(j)return void(this.placements[mt.crossTileID]=new Ue(!1,!1,!1));let En=!1,xn=!1,An=!0,Ar=null,er={box:null,offscreen:null},pi={box:null,offscreen:null},Jr=null,Or=null,ms=null,or=0,yo=0,_o=0;rn.textFeatureIndex?or=rn.textFeatureIndex:mt.useRuntimeCollisionCircles&&(or=mt.featureIndex),rn.verticalTextFeatureIndex&&(yo=rn.verticalTextFeatureIndex);const ya=rn.textBox;if(ya){const wi=Ir=>{let Qr=l.ai.horizontal;if(y.allowVerticalPlacement&&!Ir&&this.prevPlacement){const Zi=this.prevPlacement.placedOrientations[mt.crossTileID];Zi&&(this.placedOrientations[mt.crossTileID]=Zi,Qr=Zi,this.markUsedOrientation(y,Qr,mt))}return Qr},mi=(Ir,Qr)=>{if(y.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&rn.verticalTextBox){for(const Zi of y.writingModes)if(Zi===l.ai.vertical?(er=Qr(),pi=er):er=Ir(),er&&er.box&&er.box.length)break}else er=Ir()},Li=mt.textAnchorOffsetStartIndex,Za=mt.textAnchorOffsetEndIndex;if(Za===Li){const Ir=(Qr,Zi)=>{const kr=this.collisionIndex.placeCollisionBox(Qr,oe,R,E,ce.predicate,zt);return kr&&kr.box&&kr.box.length&&(this.markUsedOrientation(y,Zi,mt),this.placedOrientations[mt.crossTileID]=Zi),kr};mi(()=>Ir(ya,l.ai.horizontal),()=>{const Qr=rn.verticalTextBox;return y.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&Qr?Ir(Qr,l.ai.vertical):{box:null,offscreen:null}}),wi(er&&er.box&&er.box.length)}else{let Ir=l.aq[(Wn=(Nt=this.prevPlacement)===null||Nt===void 0?void 0:Nt.variableOffsets[mt.crossTileID])===null||Wn===void 0?void 0:Wn.anchor];const Qr=(kr,Xa,ch)=>{const Dg=kr.x2-kr.x1,Fg=kr.y2-kr.y1,Kv=mt.textBoxScale,Rf=Be&&Oe==="never"?Xa:null;let vo={box:[],offscreen:!1},Ya=oe==="never"?1:2,xo="never";Ir&&Ya++;for(let Ms=0;Ms<Ya;Ms++){for(let bo=Li;bo<Za;bo++){const Of=y.textAnchorOffsets.get(bo);if(Ir&&Of.textAnchor!==Ir)continue;const Xo=this.attemptAnchorPlacement(Of,kr,Dg,Fg,Kv,Ie,De,R,E,ce,xo,mt,y,ch,Rf,zt);if(Xo&&(vo=Xo.placedGlyphBoxes,vo&&vo.box&&vo.box.length))return En=!0,Ar=Xo.shift,vo}Ir?Ir=null:xo=oe}return vo};mi(()=>Qr(ya,rn.iconBox,l.ai.horizontal),()=>{const kr=rn.verticalTextBox;return y.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&mt.numVerticalGlyphVertices>0&&kr?Qr(kr,rn.verticalIconBox,l.ai.vertical):{box:null,offscreen:null}}),er&&(En=er.box,An=er.offscreen);const Zi=wi(er&&er.box);if(!En&&this.prevPlacement){const kr=this.prevPlacement.variableOffsets[mt.crossTileID];kr&&(this.variableOffsets[mt.crossTileID]=kr,this.markUsedJustification(y,kr.anchor,mt,Zi))}}}if(Jr=er,En=Jr&&Jr.box&&Jr.box.length>0,An=Jr&&Jr.offscreen,mt.useRuntimeCollisionCircles){const wi=y.text.placedSymbolArray.get(mt.centerJustifiedTextSymbolIndex),mi=l.aj(y.textSizeData,X,wi),Li=b.get("text-padding");Or=this.collisionIndex.placeCollisionCircles(oe,wi,y.lineVertexArray,y.glyphOffsetArray,mi,E,C,k,p,De,ce.predicate,mt.collisionCircleDiameter,Li,zt),Or.circles.length&&Or.collisionDetected&&!p&&l.w("Collisions detected, but collision boxes are not shown"),En=Pe||Or.circles.length>0&&!Or.collisionDetected,An=An&&Or.offscreen}if(rn.iconFeatureIndex&&(_o=rn.iconFeatureIndex),rn.iconBox){const wi=mi=>{const Li=Be&&Ar?St(mi,Ar.x,Ar.y,Ie,De,this.transform.angle):mi;return this.collisionIndex.placeCollisionBox(Li,Oe,R,E,ce.predicate,zt)};pi&&pi.box&&pi.box.length&&rn.verticalIconBox?(ms=wi(rn.verticalIconBox),xn=ms.box.length>0):(ms=wi(rn.iconBox),xn=ms.box.length>0),An=An&&ms.offscreen}const qa=le||mt.numHorizontalGlyphVertices===0&&mt.numVerticalGlyphVertices===0,Nl=fe||mt.numIconVertices===0;if(qa||Nl?Nl?qa||(xn=xn&&En):En=xn&&En:xn=En=xn&&En,En&&Jr&&Jr.box&&this.collisionIndex.insertCollisionBox(Jr.box,oe,b.get("text-ignore-placement"),y.bucketInstanceId,pi&&pi.box&&yo?yo:or,ce.ID),xn&&ms&&this.collisionIndex.insertCollisionBox(ms.box,Oe,b.get("icon-ignore-placement"),y.bucketInstanceId,_o,ce.ID),Or&&(En&&this.collisionIndex.insertCollisionCircles(Or.circles,oe,b.get("text-ignore-placement"),y.bucketInstanceId,or,ce.ID),p)){const wi=y.bucketInstanceId;let mi=this.collisionCircleArrays[wi];mi===void 0&&(mi=this.collisionCircleArrays[wi]=new We);for(let Li=0;Li<Or.circles.length;Li+=4)mi.circles.push(Or.circles[Li+0]),mi.circles.push(Or.circles[Li+1]),mi.circles.push(Or.circles[Li+2]),mi.circles.push(Or.collisionDetected?1:0)}if(mt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[mt.crossTileID]=new Ue(En||rt,xn||tt,An||y.justReloaded),d[mt.crossTileID]=!0};if(Ke){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const mt=y.getSortedSymbolIndexes(this.transform.angle);for(let rn=mt.length-1;rn>=0;--rn){const Nt=mt[rn];Cn(y.symbolInstances.get(Nt),y.collisionArrays[Nt])}}else for(let mt=o.symbolInstanceStart;mt<o.symbolInstanceEnd;mt++)Cn(y.symbolInstances.get(mt),y.collisionArrays[mt]);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const mt=this.collisionCircleArrays[y.bucketInstanceId];l.as(mt.invProjMatrix,E),mt.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(o,d,p,y){let b;b=y===l.ai.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.at(d)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of E)C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=b>=0&&C!==b?0:p.crossTileID)}markUsedOrientation(o,d,p){const y=d===l.ai.horizontal||d===l.ai.horizontalOnly?d:0,b=d===l.ai.vertical?d:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of E)o.text.placedSymbolArray.get(C).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const y=d?d.symbolFadeChange(o):1,b=d?d.opacities:{},E=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(const k in this.placements){const R=this.placements[k],j=b[k];j?(this.opacities[k]=new Ee(j,y,R.text,R.icon),p=p||R.text!==j.text.placed||R.icon!==j.icon.placed):(this.opacities[k]=new Ee(null,y,R.text,R.icon,R.skipFade),p=p||R.text||R.icon)}for(const k in b){const R=b[k];if(!this.opacities[k]){const j=new Ee(R,y,!1,!1);j.isHidden()||(this.opacities[k]=j,p=p||R.text.placed||R.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in C)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=C[k]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d){const p={};for(const y of d){const b=y.getBucket(o);b&&y.latestFeatureIndex&&o.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,y.collisionBoxArray)}}updateBucketOpacities(o,d,p){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const y=o.layers[0],b=y.layout,E=new Ee(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),k=b.get("icon-allow-overlap"),R=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=b.get("text-rotation-alignment")==="map",V=b.get("text-pitch-alignment")==="map",X=b.get("icon-text-fit")!=="none",ce=new Ee(null,0,C&&(k||!o.hasIconData()||b.get("icon-optional")),k&&(C||!o.hasTextData()||b.get("text-optional")),!0);!o.collisionArrays&&p&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(p);const le=(fe,oe,Pe)=>{for(let Oe=0;Oe<oe/4;Oe++)fe.opacityVertexArray.emplaceBack(Pe);fe.hasVisibleVertices=fe.hasVisibleVertices||Pe!==$i};for(let fe=0;fe<o.symbolInstances.length;fe++){const oe=o.symbolInstances.get(fe),{numHorizontalGlyphVertices:Pe,numVerticalGlyphVertices:Oe,crossTileID:ge}=oe;let Ie=this.opacities[ge];d[ge]?Ie=E:Ie||(Ie=ce,this.opacities[ge]=Ie),d[ge]=!0;const De=oe.numIconVertices>0,Be=this.placedOrientations[oe.crossTileID],Ke=Be===l.ai.vertical,rt=Be===l.ai.horizontal||Be===l.ai.horizontalOnly;if(Pe>0||Oe>0){const tt=Yr(Ie.text);le(o.text,Pe,Ke?$i:tt),le(o.text,Oe,rt?$i:tt);const ct=Ie.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(mt=>{mt>=0&&(o.text.placedSymbolArray.get(mt).hidden=ct||Ke?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=ct||rt?1:0);const zt=this.variableOffsets[oe.crossTileID];zt&&this.markUsedJustification(o,zt.anchor,oe,Be);const Cn=this.placedOrientations[oe.crossTileID];Cn&&(this.markUsedJustification(o,"left",oe,Cn),this.markUsedOrientation(o,Cn,oe))}if(De){const tt=Yr(Ie.icon),ct=!(X&&oe.verticalPlacedIconSymbolIndex&&Ke);oe.placedIconSymbolIndex>=0&&(le(o.icon,oe.numIconVertices,ct?tt:$i),o.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=Ie.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(le(o.icon,oe.numVerticalIconVertices,ct?$i:tt),o.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=Ie.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const tt=o.collisionArrays[fe];if(tt){let ct=new l.P(0,0);if(tt.textBox||tt.verticalTextBox){let Cn=!0;if(R){const mt=this.variableOffsets[ge];mt?(ct=Kt(mt.anchor,mt.width,mt.height,mt.textOffset,mt.textBoxScale),j&&ct._rotate(V?this.transform.angle:-this.transform.angle)):Cn=!1}tt.textBox&&Pt(o.textCollisionBox.collisionVertexArray,Ie.text.placed,!Cn||Ke,ct.x,ct.y),tt.verticalTextBox&&Pt(o.textCollisionBox.collisionVertexArray,Ie.text.placed,!Cn||rt,ct.x,ct.y)}const zt=!!(!rt&&tt.verticalIconBox);tt.iconBox&&Pt(o.iconCollisionBox.collisionVertexArray,Ie.icon.placed,zt,X?ct.x:0,X?ct.y:0),tt.verticalIconBox&&Pt(o.iconCollisionBox.collisionVertexArray,Ie.icon.placed,!zt,X?ct.x:0,X?ct.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);if(o.bucketInstanceId in this.collisionCircleArrays){const fe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=fe.invProjMatrix,o.placementViewportMatrix=fe.viewportMatrix,o.collisionCircleArray=fe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>o}setStale(){this.stale=!0}}function Pt(v,o,d,p,y){v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0),v.emplaceBack(o?1:0,d?1:0,p||0,y||0)}const hn=Math.pow(2,25),In=Math.pow(2,24),gn=Math.pow(2,17),dn=Math.pow(2,16),tn=Math.pow(2,9),_n=Math.pow(2,8),pr=Math.pow(2,1);function Yr(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const o=v.placed?1:0,d=Math.floor(127*v.opacity);return d*hn+o*In+d*gn+o*dn+d*tn+o*_n+d*pr+o}const $i=0;class Ba{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,d,p,y,b){const E=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(E,y,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((C,k)=>C.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(d.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Kr{constructor(o,d,p,y,b,E,C,k){this.placement=new Ft(o,d,E,C,k),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,d,p){const y=l.h.now(),b=()=>!this._forceFullPlacement&&l.h.now()-y>2;for(;this._currentPlacementIndex>=0;){const E=d[o[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=C)&&(!E.maxzoom||E.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Ba(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const cs=512/l.N/2;class po{constructor(o,d,p){this.tileID=o,this.bucketInstanceId=p,this._symbolsByKey={};const y=new Map;for(let b=0;b<d.length;b++){const E=d.get(b),C=E.key,k=y.get(C);k?k.push(E):y.set(C,[E])}for(const[b,E]of y){const C={positions:E.map(k=>({x:Math.floor(k.anchorX*cs),y:Math.floor(k.anchorY*cs)})),crossTileIDs:E.map(k=>k.crossTileID)};if(C.positions.length>128){const k=new l.av(C.positions.length,16,Uint16Array);for(const{x:R,y:j}of C.positions)k.add(R,j);k.finish(),delete C.positions,C.index=k}this._symbolsByKey[b]=C}}getScaledCoordinates(o,d){const{x:p,y,z:b}=this.tileID.canonical,{x:E,y:C,z:k}=d.canonical,R=cs/Math.pow(2,k-b),j=(C*l.N+o.anchorY)*R,V=y*l.N*cs;return{x:Math.floor((E*l.N+o.anchorX)*R-p*l.N*cs),y:Math.floor(j-V)}}findMatches(o,d,p){const y=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let b=0;b<o.length;b++){const E=o.get(b);if(E.crossTileID)continue;const C=this._symbolsByKey[E.key];if(!C)continue;const k=this.getScaledCoordinates(E,d);if(C.index){const R=C.index.range(k.x-y,k.y-y,k.x+y,k.y+y).sort();for(const j of R){const V=C.crossTileIDs[j];if(!p[V]){p[V]=!0,E.crossTileID=V;break}}}else if(C.positions)for(let R=0;R<C.positions.length;R++){const j=C.positions[R],V=C.crossTileIDs[R];if(Math.abs(j.x-k.x)<=y&&Math.abs(j.y-k.y)<=y&&!p[V]){p[V]=!0,E.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Pn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Uo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const p in this.indexes){const y=this.indexes[p],b={};for(const E in y){const C=y[E];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),b[C.tileID.key]=C}this.indexes[p]=b}this.lng=o}addBucket(o,d,p){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const y=this.usedCrossTileIDs[o.overscaledZ];for(const b in this.indexes){const E=this.indexes[b];if(Number(b)>o.overscaledZ)for(const C in E){const k=E[C];k.tileID.isChildOf(o)&&k.findMatches(d.symbolInstances,o,y)}else{const C=E[o.scaledTo(Number(b)).key];C&&C.findMatches(d.symbolInstances,o,y)}}for(let b=0;b<d.symbolInstances.length;b++){const E=d.symbolInstances.get(b);E.crossTileID||(E.crossTileID=p.generate(),y[E.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new po(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const p of d.getCrossTileIDsLists())for(const y of p)delete this.usedCrossTileIDs[o][y]}removeStaleBuckets(o){let d=!1;for(const p in this.indexes){const y=this.indexes[p];for(const b in y)o[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[b]),delete y[b],d=!0)}return d}}class ki{constructor(){this.layerIndexes={},this.crossTileIDs=new Pn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,p){let y=this.layerIndexes[o.id];y===void 0&&(y=this.layerIndexes[o.id]=new Uo);let b=!1;const E={};y.handleWrapJump(p);for(const C of d){const k=C.getBucket(o);k&&o.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,k,this.crossTileIDs)&&(b=!0),E[k.bucketInstanceId]=!0)}return y.removeStaleBuckets(E)&&(b=!0),b}pruneUnusedLayers(o){const d={};o.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}const ir=(v,o)=>l.x(v,o&&o.filter(d=>d.identifier!=="source.canvas")),bi=l.F(l.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Bu=l.F(l.ax,["setCenter","setZoom","setBearing","setPitch"]),di=l.aw();class Zn extends l.E{constructor(o,d={}){super(),this.map=o,this.dispatcher=new Vt(et(),this,o._getMapId()),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new Ze(o._requestManager,d.localIdeographFontFamily),this.lineAtlas=new st(256,512),this.crossTileSymbolIndex=new ki,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.az());const p=this;this._rtlTextPluginCallback=Zn.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,E)=>{if(l.aA(b),E&&E.every(C=>C))for(const C in p.sourceCaches){const k=p.sourceCaches[C].getSource().type;k!=="vector"&&k!=="geojson"||p.sourceCaches[C].reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.sourceCaches[y.sourceId];if(!b)return;const E=b.getSource();if(E&&E.vectorLayerIds)for(const C in this._layers){const k=this._layers[C];k.source===E.id&&this._validateLayer(k)}})}loadURL(o,d={},p){this.fire(new l.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const y=this.map._requestManager.transformRequest(o,z.Style);this._request=l.f(y,(b,E)=>{this._request=null,b?this.fire(new l.j(b)):E&&this._load(E,d,p)})}loadJSON(o,d={},p){this.fire(new l.k("dataloading",{dataType:"style"})),this._request=l.h.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(o,d,p)})}loadEmpty(){this.fire(new l.k("dataloading",{dataType:"style"})),this._load(di,{validate:!1})}_load(o,d,p){var y;const b=d.transformStyle?d.transformStyle(p,o):o;if(!d.validate||!ir(this,l.y(b))){this._loaded=!0,this.stylesheet=b;for(const E in b.sources)this.addSource(E,b.sources[E],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new qe(this.stylesheet.light),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.k("data",{dataType:"style"})),this.fire(new l.k("style.load"))}}_createLayers(){const o=l.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",o),this._order=o.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of o){const p=l.aC(d);p.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=p}}_loadSprite(o,d=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(y,b,E,C){const k=xe(y),R=k.length,j=E>1?"@2x":"",V={},X={},ce={};for(const{id:le,url:fe}of k){const oe=b.transformRequest(b.normalizeSpriteURL(fe,j,".json"),z.SpriteJSON),Pe=`${le}_${oe.url}`;V[Pe]=l.f(oe,(Ie,De)=>{delete V[Pe],X[le]=De,Te(C,X,ce,Ie,R)});const Oe=b.transformRequest(b.normalizeSpriteURL(fe,j,".png"),z.SpriteImage),ge=`${le}_${Oe.url}`;V[ge]=W.getImage(Oe,(Ie,De)=>{delete V[ge],ce[le]=De,Te(C,X,ce,Ie,R)})}return{cancel(){for(const le of Object.values(V))le.cancel()}}}(o,this.map._requestManager,this.map.getPixelRatio(),(y,b)=>{if(this._spriteRequest=null,y)this.fire(new l.j(y));else if(b)for(const E in b){this._spritesImagesIds[E]=[];const C=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(k=>!(k in b)):[];for(const k of C)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in b[E]){const R=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(R),R in this.imageManager.images?this.imageManager.updateImage(R,b[E][k],!1):this.imageManager.addImage(R,b[E][k]),d&&(this._changedImages[R]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"})),p&&p(y)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}_validateLayer(o){const d=this.sourceCaches[o.source];if(!d)return;const p=o.sourceLayer;if(!p)return;const y=d.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.j(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o){const d=this._serializedAllLayers();if(!o||o.length===0)return Object.values(d);const p=[];for(const y of o)d[y]&&p.push(d[y]);return p}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const y=this._layers[p];y.type!=="custom"&&(o[p]=y.serialize())}return o}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const d=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const E in this._updatedSources){const C=this._updatedSources[E];if(C==="reload")this._reloadSource(E);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const b=this.sourceCaches[y];p[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];b.recalculate(o,this._availableImages),!b.isHidden(o.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const y in p){const b=this.sourceCaches[y];p[y]!==b.used&&b.fire(new l.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(o),this.z=o.zoom,d&&this.fire(new l.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(o),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,d={}){this._checkLoaded();const p=this.serialize();if(o=d.transformStyle?d.transformStyle(p,o):o,ir(this,l.y(o)))return!1;(o=l.aD(o)).layers=l.aB(o.layers);const y=l.aE(p,o).filter(E=>!(E.command in Bu));if(y.length===0)return!1;const b=y.filter(E=>!(E.command in bi));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);for(const E of y)E.command!=="setTransition"&&this[E.command].apply(this,E.args);return this.stylesheet=o,this._serializedLayers=null,!0}addImage(o,d){if(this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,d),this._afterImageUpdated(o)}updateImage(o,d){this.imageManager.updateImage(o,d)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new l.j(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,d,p={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(l.y.source,`sources.${o}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const y=this.sourceCaches[o]=new Tt(o,d,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:o})),y.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===o)return this.fire(new l.j(new Error(`Source "${o}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],d.fire(new l.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,d){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const p=this.sourceCaches[o].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,d,p={}){this._checkLoaded();const y=o.id;if(this.getLayer(y))return void this.fire(new l.j(new Error(`Layer "${y}" already exists on this map.`)));let b;if(o.type==="custom"){if(ir(this,l.aF(o)))return;b=l.aC(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(y,o.source),o=l.aD(o),o=l.e(o,{source:y})),this._validate(l.y.layer,`layers.${y}`,o,{arrayIndex:-1},p))return;b=l.aC(o),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}})}const E=d?this._order.indexOf(d):this._order.length;if(d&&E===-1)this.fire(new l.j(new Error(`Cannot add layer "${y}" before non-existing layer "${d}".`)));else{if(this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=b,this._removedLayers[y]&&b.source&&b.type!=="custom"){const C=this._removedLayers[y];delete this._removedLayers[y],C.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(o,d){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new l.j(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===d)return;const p=this._order.indexOf(o);this._order.splice(p,1);const y=d?this._order.indexOf(d):this._order.length;d&&y===-1?this.fire(new l.j(new Error(`Cannot move layer "${o}" before non-existing layer "${d}".`))):(this._order.splice(y,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const d=this._layers[o];if(!d)return void this.fire(new l.j(new Error(`Cannot remove non-existing layer "${o}".`)));d.setEventedParent(null);const p=this._order.indexOf(o);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=d,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],d.onRemove&&d.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,d,p){this._checkLoaded();const y=this.getLayer(o);y?y.minzoom===d&&y.maxzoom===p||(d!=null&&(y.minzoom=d),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.j(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,d,p={}){this._checkLoaded();const y=this.getLayer(o);if(y){if(!l.aG(y.filter,d))return d==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.y.filter,`layers.${y.id}.filter`,d,null,p)||(y.filter=l.aD(d),this._updateLayer(y)))}else this.fire(new l.j(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return l.aD(this.getLayer(o).filter)}setLayoutProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.aG(b.getLayoutProperty(d),p)||(b.setLayoutProperty(d,p,y),this._updateLayer(b)):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,d){const p=this.getLayer(o);if(p)return p.getLayoutProperty(d);this.fire(new l.j(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,d,p,y={}){this._checkLoaded();const b=this.getLayer(o);b?l.aG(b.getPaintProperty(d),p)||(b.setPaintProperty(d,p,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new l.j(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,d){return this.getLayer(o).getPaintProperty(d)}setFeatureState(o,d){this._checkLoaded();const p=o.source,y=o.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new l.j(new Error(`The source '${p}' does not exist in the map's style.`)));const E=b.getSource().type;E==="geojson"&&y?this.fire(new l.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||y?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),b.setFeatureState(y,o.id,d)):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,d){this._checkLoaded();const p=o.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new l.j(new Error(`The source '${p}' does not exist in the map's style.`)));const b=y.getSource().type,E=b==="vector"?o.sourceLayer:void 0;b!=="vector"||E?d&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new l.j(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(E,o.id,d):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const d=o.source,p=o.sourceLayer,y=this.sourceCaches[d];if(y!==void 0)return y.getSource().type!=="vector"||p?(o.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,o.id)):void this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=l.aH(this.sourceCaches,b=>b.serialize()),d=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,y=this.stylesheet;return l.aI({version:y.version,name:y.name,metadata:y.metadata,light:y.light,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,sources:o,layers:d,terrain:p},b=>b!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const d=E=>this._layers[E].type==="fill-extrusion",p={},y=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(d(C)){p[C]=E;for(const k of o){const R=k[C];if(R)for(const j of R)y.push(j)}}}y.sort((E,C)=>C.intersectionZ-E.intersectionZ);const b=[];for(let E=this._order.length-1;E>=0;E--){const C=this._order[E];if(d(C))for(let k=y.length-1;k>=0;k--){const R=y[k].feature;if(p[R.layer.id]<E)break;b.push(R),y.pop()}else for(const k of o){const R=k[C];if(R)for(const j of R)b.push(j.feature)}}return b}queryRenderedFeatures(o,d,p){d&&d.filter&&this._validate(l.y.filter,"queryRenderedFeatures.filter",d.filter,null,d);const y={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new l.j(new Error("parameters.layers must be an Array."))),[];for(const C of d.layers){const k=this._layers[C];if(!k)return this.fire(new l.j(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];y[k.source]=!0}}const b=[];d.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const C in this.sourceCaches)d.layers&&!y[C]||b.push(yn(this.sourceCaches[C],this._layers,E,o,d,p));return this.placement&&b.push(function(C,k,R,j,V,X,ce){const le={},fe=X.queryRenderedSymbols(j),oe=[];for(const Pe of Object.keys(fe).map(Number))oe.push(ce[Pe]);oe.sort(vn);for(const Pe of oe){const Oe=Pe.featureIndex.lookupSymbolFeatures(fe[Pe.bucketInstanceId],k,Pe.bucketIndex,Pe.sourceLayerIndex,V.filter,V.layers,V.availableImages,C);for(const ge in Oe){const Ie=le[ge]=le[ge]||[],De=Oe[ge];De.sort((Be,Ke)=>{const rt=Pe.featureSortOrder;if(rt){const tt=rt.indexOf(Be.featureIndex);return rt.indexOf(Ke.featureIndex)-tt}return Ke.featureIndex-Be.featureIndex});for(const Be of De)Ie.push(Be)}}for(const Pe in le)le[Pe].forEach(Oe=>{const ge=Oe.feature,Ie=R[C[Pe].source].getFeatureState(ge.layer["source-layer"],ge.id);ge.source=ge.layer.source,ge.layer["source-layer"]&&(ge.sourceLayer=ge.layer["source-layer"]),ge.state=Ie});return le}(this._layers,E,this.sourceCaches,o,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,d){d&&d.filter&&this._validate(l.y.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[o];return p?function(y,b){const E=y.getRenderableIds().map(R=>y.getTileByID(R)),C=[],k={};for(let R=0;R<E.length;R++){const j=E[R],V=j.tileID.canonical.key;k[V]||(k[V]=!0,j.querySourceFeatures(C,b))}return C}(p,d):[]}addSourceType(o,d,p){return At(o)?p(new Error(`A source type called "${o}" already exists.`)):(((y,b)=>{Ut[y]=b})(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(o,d={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const E in o)if(!l.aG(o[E],p[E])){y=!0;break}if(!y)return;const b={now:l.h.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,d),this.light.updateTransitions(b)}_validate(o,d,p,y,b={}){return(!b||b.validate!==!1)&&ir(this,o.call(l.y,l.e({key:d,style:this.serialize(),value:p,styleSpec:l.v},y)))}_remove(o=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const d in this.sourceCaches)this.sourceCaches[d].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,d,p,y,b=!1){let E=!1,C=!1;const k={};for(const R of this._order){const j=this._layers[R];if(j.type!=="symbol")continue;if(!k[j.source]){const X=this.sourceCaches[j.source];k[j.source]=X.getRenderableIds(!0).map(ce=>X.getTileByID(ce)).sort((ce,le)=>le.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(le.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(j,k[j.source],o.center.lng);E=E||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.h.now(),o.zoom))&&(this.pauseablePlacement=new Kr(o,this.map.terrain,this._order,b,d,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.h.now()),C=!0),E&&this.pauseablePlacement.placement.setStale()),C||E)for(const R of this._order){const j=this._layers[R];j.type==="symbol"&&this.placement.updateLayerOpacities(j,k[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.h.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,d,p){this.imageManager.getImages(d.icons,p),this._updateTilesForChangedImages();const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(o,d,p){this.glyphManager.getGlyphs(d.stacks,p);const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,[""])}getResource(o,d,p){return l.m(d,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,d={}){this._checkLoaded(),o&&this._validate(l.y.glyphs,"glyphs",o,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,d,p={},y){this._checkLoaded();const b=[{id:o,url:d}],E=[...xe(this.stylesheet.sprite),...b];this._validate(l.y.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(b,!0,y))}removeSprite(o){this._checkLoaded();const d=xe(this.stylesheet.sprite);if(d.find(p=>p.id===o)){if(this._spritesImagesIds[o])for(const p of this._spritesImagesIds[o])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===o),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}else this.fire(new l.j(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return xe(this.stylesheet.sprite)}setSprite(o,d={},p){this._checkLoaded(),o&&this._validate(l.y.sprite,"sprite",o,null,d)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,p):(this._unloadSprite(),p&&p(null)))}}Zn.registerForPluginStateChange=l.aK;var $o=l.Q([{name:"a_pos",type:"Int16",components:2}]),mo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Jn={prelude:zn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:zn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:zn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:zn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:zn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:zn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:zn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:zn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",mo),terrainDepth:zn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",mo),terrainCoords:zn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",mo)};function zn(v,o){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=o.match(/attribute ([\w]+) ([\w]+)/g),y=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=b?b.concat(y):y,C={};return{fragmentSource:v=v.replace(d,(k,R,j,V,X)=>(C[X]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${j} ${V} ${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = u_${X};
#endif
`)),vertexSource:o=o.replace(d,(k,R,j,V,X)=>{const ce=V==="float"?"vec2":"vec4",le=X.match(/color/)?"color":ce;return C[X]?R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${j} ${ce} a_${X};
varying ${j} ${V} ${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${j} ${ce} a_${X};
#else
uniform ${j} ${V} u_${X};
#endif
`:le==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = a_${X};
#else
    ${j} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${V} ${X} = unpack_mix_${le}(a_${X}, u_${X}_t);
#else
    ${j} ${V} ${X} = u_${X};
#endif
`}),staticAttributes:p,staticUniforms:E}}class Us{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,d,p,y,b,E,C,k,R){this.context=o;let j=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!j&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(j=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||j||this.boundIndexBuffer!==b||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==R?this.freshBind(d,p,y,b,E,C,k,R):(o.bindVertexArray.set(this.vao),C&&C.bind(),b&&b.dynamicDraw&&b.bind(),k&&k.bind(),R&&R.bind())}freshBind(o,d,p,y,b,E,C,k){const R=o.numAttributes,j=this.context,V=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=k,d.enableAttributes(V,o);for(const X of p)X.enableAttributes(V,o);E&&E.enableAttributes(V,o),C&&C.enableAttributes(V,o),k&&k.enableAttributes(V,o),d.bind(),d.setVertexAttribPointers(V,o,b);for(const X of p)X.bind(),X.setVertexAttribPointers(V,o,b);E&&(E.bind(),E.setVertexAttribPointers(V,o,b)),y&&y.bind(),C&&(C.bind(),C.setVertexAttribPointers(V,o,b)),k&&(k.bind(),k.setVertexAttribPointers(V,o,b)),j.currentNumAttributes=R}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Qn(v){const o=[];for(let d=0;d<v.length;d++){if(v[d]===null)continue;const p=v[d].split(" ");o.push(p.pop())}return o}class Gi{constructor(o,d,p,y,b,E){const C=o.gl;this.program=C.createProgram();const k=Qn(d.staticAttributes),R=p?p.getBinderAttributes():[],j=k.concat(R),V=Jn.prelude.staticUniforms?Qn(Jn.prelude.staticUniforms):[],X=d.staticUniforms?Qn(d.staticUniforms):[],ce=p?p.getBinderUniforms():[],le=V.concat(X).concat(ce),fe=[];for(const Be of le)fe.indexOf(Be)<0&&fe.push(Be);const oe=p?p.defines():[];b&&oe.push("#define OVERDRAW_INSPECTOR;"),E&&oe.push("#define TERRAIN3D;");const Pe=oe.concat(Jn.prelude.fragmentSource,d.fragmentSource).join(`
`),Oe=oe.concat(Jn.prelude.vertexSource,d.vertexSource).join(`
`),ge=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ge,Pe),C.compileShader(ge),!C.getShaderParameter(ge,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(ge)}`);C.attachShader(this.program,ge);const Ie=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ie,Oe),C.compileShader(Ie),!C.getShaderParameter(Ie,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Ie)}`);C.attachShader(this.program,Ie),this.attributes={};const De={};this.numAttributes=j.length;for(let Be=0;Be<this.numAttributes;Be++)j[Be]&&(C.bindAttribLocation(this.program,Be,j[Be]),this.attributes[j[Be]]=Be);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Ie),C.deleteShader(ge);for(let Be=0;Be<fe.length;Be++){const Ke=fe[Be];if(Ke&&!De[Ke]){const rt=C.getUniformLocation(this.program,Ke);rt&&(De[Ke]=rt)}}this.fixedUniforms=y(o,De),this.terrainUniforms=((Be,Ke)=>({u_depth:new l.aL(Be,Ke.u_depth),u_terrain:new l.aL(Be,Ke.u_terrain),u_terrain_dim:new l.aM(Be,Ke.u_terrain_dim),u_terrain_matrix:new l.aN(Be,Ke.u_terrain_matrix),u_terrain_unpack:new l.aO(Be,Ke.u_terrain_unpack),u_terrain_exaggeration:new l.aM(Be,Ke.u_terrain_exaggeration)}))(o,De),this.binderUniforms=p?p.getUniforms(o,De):[]}draw(o,d,p,y,b,E,C,k,R,j,V,X,ce,le,fe,oe,Pe,Oe){const ge=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(p),o.setStencilMode(y),o.setColorMode(b),o.setCullFace(E),k){o.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,k.depthTexture),o.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,k.texture);for(const De in this.terrainUniforms)this.terrainUniforms[De].set(k[De])}for(const De in this.fixedUniforms)this.fixedUniforms[De].set(C[De]);fe&&fe.setUniforms(o,this.binderUniforms,ce,{zoom:le});let Ie=0;switch(d){case ge.LINES:Ie=2;break;case ge.TRIANGLES:Ie=3;break;case ge.LINE_STRIP:Ie=1}for(const De of X.get()){const Be=De.vaos||(De.vaos={});(Be[R]||(Be[R]=new Us)).bind(o,this,j,fe?fe.getPaintVertexBuffers():[],V,De.vertexOffset,oe,Pe,Oe),ge.drawElements(d,De.primitiveLength*Ie,ge.UNSIGNED_SHORT,De.primitiveOffset*Ie*2)}}}function Wi(v,o,d){const p=1/be(d,1,o.transform.tileZoom),y=Math.pow(2,d.tileID.overscaledZ),b=d.tileSize*Math.pow(2,o.transform.tileZoom)/y,E=b*(d.tileID.canonical.x+d.tileID.wrap*y),C=b*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[E>>16,C>>16],u_pixel_coord_lower:[65535&E,65535&C]}}const Pl=(v,o,d,p)=>{const y=o.style.light,b=y.properties.get("position"),E=[b.x,b.y,b.z],C=function(){var R=new l.A(9);return l.A!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[5]=0,R[6]=0,R[7]=0),R[0]=1,R[4]=1,R[8]=1,R}();y.properties.get("anchor")==="viewport"&&function(R,j){var V=Math.sin(j),X=Math.cos(j);R[0]=X,R[1]=V,R[2]=0,R[3]=-V,R[4]=X,R[5]=0,R[6]=0,R[7]=0,R[8]=1}(C,-o.transform.angle),function(R,j,V){var X=j[0],ce=j[1],le=j[2];R[0]=X*V[0]+ce*V[3]+le*V[6],R[1]=X*V[1]+ce*V[4]+le*V[7],R[2]=X*V[2]+ce*V[5]+le*V[8]}(E,E,C);const k=y.properties.get("color");return{u_matrix:v,u_lightpos:E,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+d,u_opacity:p}},Cs=(v,o,d,p,y,b,E)=>l.e(Pl(v,o,d,p),Wi(b,o,E),{u_height_factor:-Math.pow(2,y.overscaledZ)/E.tileSize/8}),Mc=v=>({u_matrix:v}),Lc=(v,o,d,p)=>l.e(Mc(v),Wi(d,o,p)),Cl=(v,o)=>({u_matrix:v,u_world:o}),ee=(v,o,d,p,y)=>l.e(Lc(v,o,d,p),{u_world:y}),re=(v,o,d,p)=>{const y=v.transform;let b,E;if(p.paint.get("circle-pitch-alignment")==="map"){const C=be(d,1,y.zoom);b=!0,E=[C,C]}else b=!1,E=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(o.posMatrix,d,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:E}},we=(v,o,d)=>{const p=be(d,1,o.zoom),y=Math.pow(2,o.zoom-d.tileID.overscaledZ),b=d.tileID.overscaleFactor();return{u_matrix:v,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[o.pixelsToGLUnits[0]/(p*y),o.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:b}},Fe=(v,o,d=1)=>({u_matrix:v,u_color:o,u_overlay:0,u_overlay_scale:d}),lt=v=>({u_matrix:v}),Ot=(v,o,d,p)=>({u_matrix:v,u_extrude_scale:be(o,1,d),u_intensity:p});function Tn(v,o){const d=Math.pow(2,o.canonical.z),p=o.canonical.y;return[new l.U(0,p/d).toLngLat().lat,new l.U(0,(p+1)/d).toLngLat().lat]}const Cr=(v,o,d,p)=>{const y=v.transform;return{u_matrix:ju(v,o,d,p),u_ratio:1/be(o,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Ur=(v,o,d,p,y)=>l.e(Cr(v,o,d,y),{u_image:0,u_image_height:p}),fi=(v,o,d,p,y)=>{const b=v.transform,E=rg(o,b);return{u_matrix:ju(v,o,d,y),u_texsize:o.imageAtlasTexture.size,u_ratio:1/be(o,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},us=(v,o,d,p,y,b)=>{const E=v.lineAtlas,C=rg(o,v.transform),k=d.layout.get("line-cap")==="round",R=E.getDash(p.from,k),j=E.getDash(p.to,k),V=R.width*y.fromScale,X=j.width*y.toScale;return l.e(Cr(v,o,d,b),{u_patternscale_a:[C/V,-R.height/2],u_patternscale_b:[C/X,-j.height/2],u_sdfgamma:E.width/(256*Math.min(V,X)*v.pixelRatio)/2,u_image:0,u_tex_y_a:R.y,u_tex_y_b:j.y,u_mix:y.t})};function rg(v,o){return 1/be(v,1,o.tileZoom)}function ju(v,o,d,p){return v.translatePosMatrix(p?p.posMatrix:o.tileID.posMatrix,o,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const ig=(v,o,d,p,y)=>{return{u_matrix:v,u_tl_parent:o,u_scale_parent:d,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(E=y.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(b=y.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:sg(y.paint.get("raster-hue-rotate"))};var b,E};function sg(v){v*=Math.PI/180;const o=Math.sin(v),d=Math.cos(v);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Kd=(v,o,d,p,y,b,E,C,k,R)=>{const j=y.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:j.width/j.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:E,u_coord_matrix:C,u_is_text:+k,u_pitch_with_map:+p,u_texsize:R,u_texture:0}},Jd=(v,o,d,p,y,b,E,C,k,R,j)=>{const V=y.transform;return l.e(Kd(v,o,d,p,y,b,E,C,k,R),{u_gamma_scale:p?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+j})},ja=(v,o,d,p,y,b,E,C,k,R)=>l.e(Jd(v,o,d,p,y,b,E,C,!0,k,!0),{u_texsize_icon:R,u_texture_icon:1}),Vu=(v,o,d)=>({u_matrix:v,u_opacity:o,u_color:d}),As=(v,o,d,p,y,b)=>l.e(function(E,C,k,R){const j=k.imageManager.getPattern(E.from.toString()),V=k.imageManager.getPattern(E.to.toString()),{width:X,height:ce}=k.imageManager.getPixelSize(),le=Math.pow(2,R.tileID.overscaledZ),fe=R.tileSize*Math.pow(2,k.transform.tileZoom)/le,oe=fe*(R.tileID.canonical.x+R.tileID.wrap*le),Pe=fe*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[X,ce],u_mix:C.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/be(R,1,k.transform.tileZoom),u_pixel_coord_upper:[oe>>16,Pe>>16],u_pixel_coord_lower:[65535&oe,65535&Pe]}}(p,b,d,y),{u_matrix:v,u_opacity:o}),Uu={fillExtrusion:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_lightpos:new l.aP(v,o.u_lightpos),u_lightintensity:new l.aM(v,o.u_lightintensity),u_lightcolor:new l.aP(v,o.u_lightcolor),u_vertical_gradient:new l.aM(v,o.u_vertical_gradient),u_opacity:new l.aM(v,o.u_opacity)}),fillExtrusionPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_lightpos:new l.aP(v,o.u_lightpos),u_lightintensity:new l.aM(v,o.u_lightintensity),u_lightcolor:new l.aP(v,o.u_lightcolor),u_vertical_gradient:new l.aM(v,o.u_vertical_gradient),u_height_factor:new l.aM(v,o.u_height_factor),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade),u_opacity:new l.aM(v,o.u_opacity)}),fill:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix)}),fillPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),fillOutline:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world)}),fillOutlinePattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world),u_image:new l.aL(v,o.u_image),u_texsize:new l.aQ(v,o.u_texsize),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),circle:(v,o)=>({u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_scale_with_map:new l.aL(v,o.u_scale_with_map),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_extrude_scale:new l.aQ(v,o.u_extrude_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_matrix:new l.aN(v,o.u_matrix)}),collisionBox:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.aM(v,o.u_pixels_to_tile_units),u_extrude_scale:new l.aQ(v,o.u_extrude_scale),u_overscale_factor:new l.aM(v,o.u_overscale_factor)}),collisionCircle:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_inv_matrix:new l.aN(v,o.u_inv_matrix),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_viewport_size:new l.aQ(v,o.u_viewport_size)}),debug:(v,o)=>({u_color:new l.aR(v,o.u_color),u_matrix:new l.aN(v,o.u_matrix),u_overlay:new l.aL(v,o.u_overlay),u_overlay_scale:new l.aM(v,o.u_overlay_scale)}),clippingMask:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix)}),heatmap:(v,o)=>({u_extrude_scale:new l.aM(v,o.u_extrude_scale),u_intensity:new l.aM(v,o.u_intensity),u_matrix:new l.aN(v,o.u_matrix)}),heatmapTexture:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_world:new l.aQ(v,o.u_world),u_image:new l.aL(v,o.u_image),u_color_ramp:new l.aL(v,o.u_color_ramp),u_opacity:new l.aM(v,o.u_opacity)}),hillshade:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_latrange:new l.aQ(v,o.u_latrange),u_light:new l.aQ(v,o.u_light),u_shadow:new l.aR(v,o.u_shadow),u_highlight:new l.aR(v,o.u_highlight),u_accent:new l.aR(v,o.u_accent)}),hillshadePrepare:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_image:new l.aL(v,o.u_image),u_dimension:new l.aQ(v,o.u_dimension),u_zoom:new l.aM(v,o.u_zoom),u_unpack:new l.aO(v,o.u_unpack)}),line:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels)}),lineGradient:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_image:new l.aL(v,o.u_image),u_image_height:new l.aM(v,o.u_image_height)}),linePattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texsize:new l.aQ(v,o.u_texsize),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_image:new l.aL(v,o.u_image),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_scale:new l.aP(v,o.u_scale),u_fade:new l.aM(v,o.u_fade)}),lineSDF:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ratio:new l.aM(v,o.u_ratio),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(v,o.u_units_to_pixels),u_patternscale_a:new l.aQ(v,o.u_patternscale_a),u_patternscale_b:new l.aQ(v,o.u_patternscale_b),u_sdfgamma:new l.aM(v,o.u_sdfgamma),u_image:new l.aL(v,o.u_image),u_tex_y_a:new l.aM(v,o.u_tex_y_a),u_tex_y_b:new l.aM(v,o.u_tex_y_b),u_mix:new l.aM(v,o.u_mix)}),raster:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_tl_parent:new l.aQ(v,o.u_tl_parent),u_scale_parent:new l.aM(v,o.u_scale_parent),u_buffer_scale:new l.aM(v,o.u_buffer_scale),u_fade_t:new l.aM(v,o.u_fade_t),u_opacity:new l.aM(v,o.u_opacity),u_image0:new l.aL(v,o.u_image0),u_image1:new l.aL(v,o.u_image1),u_brightness_low:new l.aM(v,o.u_brightness_low),u_brightness_high:new l.aM(v,o.u_brightness_high),u_saturation_factor:new l.aM(v,o.u_saturation_factor),u_contrast_factor:new l.aM(v,o.u_contrast_factor),u_spin_weights:new l.aP(v,o.u_spin_weights)}),symbolIcon:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texture:new l.aL(v,o.u_texture)}),symbolSDF:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texture:new l.aL(v,o.u_texture),u_gamma_scale:new l.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_is_halo:new l.aL(v,o.u_is_halo)}),symbolTextAndIcon:(v,o)=>({u_is_size_zoom_constant:new l.aL(v,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(v,o.u_is_size_feature_constant),u_size_t:new l.aM(v,o.u_size_t),u_size:new l.aM(v,o.u_size),u_camera_to_center_distance:new l.aM(v,o.u_camera_to_center_distance),u_pitch:new l.aM(v,o.u_pitch),u_rotate_symbol:new l.aL(v,o.u_rotate_symbol),u_aspect_ratio:new l.aM(v,o.u_aspect_ratio),u_fade_change:new l.aM(v,o.u_fade_change),u_matrix:new l.aN(v,o.u_matrix),u_label_plane_matrix:new l.aN(v,o.u_label_plane_matrix),u_coord_matrix:new l.aN(v,o.u_coord_matrix),u_is_text:new l.aL(v,o.u_is_text),u_pitch_with_map:new l.aL(v,o.u_pitch_with_map),u_texsize:new l.aQ(v,o.u_texsize),u_texsize_icon:new l.aQ(v,o.u_texsize_icon),u_texture:new l.aL(v,o.u_texture),u_texture_icon:new l.aL(v,o.u_texture_icon),u_gamma_scale:new l.aM(v,o.u_gamma_scale),u_device_pixel_ratio:new l.aM(v,o.u_device_pixel_ratio),u_is_halo:new l.aL(v,o.u_is_halo)}),background:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_opacity:new l.aM(v,o.u_opacity),u_color:new l.aR(v,o.u_color)}),backgroundPattern:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_opacity:new l.aM(v,o.u_opacity),u_image:new l.aL(v,o.u_image),u_pattern_tl_a:new l.aQ(v,o.u_pattern_tl_a),u_pattern_br_a:new l.aQ(v,o.u_pattern_br_a),u_pattern_tl_b:new l.aQ(v,o.u_pattern_tl_b),u_pattern_br_b:new l.aQ(v,o.u_pattern_br_b),u_texsize:new l.aQ(v,o.u_texsize),u_mix:new l.aM(v,o.u_mix),u_pattern_size_a:new l.aQ(v,o.u_pattern_size_a),u_pattern_size_b:new l.aQ(v,o.u_pattern_size_b),u_scale_a:new l.aM(v,o.u_scale_a),u_scale_b:new l.aM(v,o.u_scale_b),u_pixel_coord_upper:new l.aQ(v,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(v,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.aM(v,o.u_tile_units_to_pixels)}),terrain:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texture:new l.aL(v,o.u_texture),u_ele_delta:new l.aM(v,o.u_ele_delta)}),terrainDepth:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_ele_delta:new l.aM(v,o.u_ele_delta)}),terrainCoords:(v,o)=>({u_matrix:new l.aN(v,o.u_matrix),u_texture:new l.aL(v,o.u_texture),u_terrain_coords_id:new l.aM(v,o.u_terrain_coords_id),u_ele_delta:new l.aM(v,o.u_ele_delta)})};class $u{constructor(o,d,p){this.context=o;const y=o.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Rc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Gu{constructor(o,d,p,y){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=y,this.context=o;const b=o.gl;this.buffer=b.createBuffer(),o.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let p=0;p<this.attributes.length;p++){const y=d.attributes[this.attributes[p].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,d,p){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],E=d.attributes[b.name];E!==void 0&&o.vertexAttribPointer(E,b.components,o[Rc[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Al=new WeakMap;function fa(v){var o;if(Al.has(v))return Al.get(v);{const d=(o=v.getParameter(v.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Al.set(v,d),d}}class Ln{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wu extends Ln{getDefault(){return l.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class hs extends Ln{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ds extends Ln{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Qd extends Ln{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Hu extends Ln{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class qu extends Ln{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class ef extends Ln{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class tf extends Ln{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Zu extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class nf extends Ln{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class rf extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Xu extends Ln{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class og extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class ag extends Ln{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Il extends Ln{getDefault(){return l.aT.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Nv extends Ln{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Bv extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class jv extends Ln{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Vv extends Ln{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Uv extends Ln{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class $v extends Ln{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class sf extends Ln{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Yu extends Ln{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class of extends Ln{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class af extends Ln{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class kl extends Ln{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class lg extends Ln{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class cg extends Ln{getDefault(){return null}set(o){var d;if(o===this.current&&!this.dirty)return;const p=this.gl;fa(p)?p.bindVertexArray(o):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class lf extends Ln{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Va extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class ug extends Ln{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class pa extends Ln{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Ml extends pa{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class hg extends pa{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class cf extends pa{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class jn{constructor(o,d,p,y,b){this.context=o,this.width=d,this.height=p;const E=o.gl,C=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Ml(o,C),y)this.depthAttachment=b?new cf(o,C):new hg(o,C);else if(b)throw new Error("Stencil cannot be setted without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const o=this.context.gl,d=this.colorAttachment.get();if(d&&o.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&o.deleteRenderbuffer(p)}o.deleteFramebuffer(this.framebuffer)}}class mr{constructor(o,d,p){this.blendFunction=o,this.blendColor=d,this.mask=p}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,l.aT.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,l.aT.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],l.aT.transparent,[!0,!0,!0,!0]);class Gv{constructor(o){var d,p;if(this.gl=o,this.clearColor=new Wu(this),this.clearDepth=new hs(this),this.clearStencil=new ds(this),this.colorMask=new Qd(this),this.depthMask=new Hu(this),this.stencilMask=new qu(this),this.stencilFunc=new ef(this),this.stencilOp=new tf(this),this.stencilTest=new Zu(this),this.depthRange=new nf(this),this.depthTest=new rf(this),this.depthFunc=new Xu(this),this.blend=new og(this),this.blendFunc=new ag(this),this.blendColor=new Il(this),this.blendEquation=new Nv(this),this.cullFace=new Bv(this),this.cullFaceSide=new jv(this),this.frontFace=new Vv(this),this.program=new Uv(this),this.activeTexture=new $v(this),this.viewport=new sf(this),this.bindFramebuffer=new Yu(this),this.bindRenderbuffer=new of(this),this.bindTexture=new af(this),this.bindVertexBuffer=new kl(this),this.bindElementBuffer=new lg(this),this.bindVertexArray=new cg(this),this.pixelStoreUnpack=new lf(this),this.pixelStoreUnpackPremultiplyAlpha=new Va(this),this.pixelStoreUnpackFlipY=new ug(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),fa(o)){this.HALF_FLOAT=o.HALF_FLOAT;const y=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=o.RGBA16F)!==null&&d!==void 0?d:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(p=o.RGB16F)!==null&&p!==void 0?p:y==null?void 0:y.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const y=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d){return new $u(this,o,d)}createVertexBuffer(o,d,p){return new Gu(this,o,d,p)}createRenderbuffer(o,d,p){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,o,d,p),this.bindRenderbuffer.set(null),b}createFramebuffer(o,d,p,y){return new jn(this,o,d,p,y)}clear({color:o,depth:d,stencil:p}){const y=this.gl;let b=0;o&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(b)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){l.aG(o.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return fa(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var d;return fa(this.gl)?this.gl.deleteVertexArray(o):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}class Rn{constructor(o,d,p){this.func=o,this.mask=d,this.range=p}}Rn.ReadOnly=!1,Rn.ReadWrite=!0,Rn.disabled=new Rn(519,Rn.ReadOnly,[0,1]);const Ua=7680;class gr{constructor(o,d,p,y,b,E){this.test=o,this.ref=d,this.mask=p,this.fail=y,this.depthFail=b,this.pass=E}}gr.disabled=new gr({func:519,mask:0},0,0,Ua,Ua,Ua);class dr{constructor(o,d,p){this.enable=o,this.mode=d,this.frontFace=p}}let Oc;function dg(v,o,d,p,y,b,E){const C=v.context,k=C.gl,R=v.useProgram("collisionBox"),j=[];let V=0,X=0;for(let ge=0;ge<p.length;ge++){const Ie=p[ge],De=o.getTile(Ie),Be=De.getBucket(d);if(!Be)continue;let Ke=Ie.posMatrix;y[0]===0&&y[1]===0||(Ke=v.translatePosMatrix(Ie.posMatrix,De,y,b));const rt=E?Be.textCollisionBox:Be.iconCollisionBox,tt=Be.collisionCircleArray;if(tt.length>0){const ct=l.Z(),zt=Ke;l.aU(ct,Be.placementInvProjMatrix,v.transform.glCoordMatrix),l.aU(ct,ct,Be.placementViewportMatrix),j.push({circleArray:tt,circleOffset:X,transform:zt,invTransform:ct,coord:Ie}),V+=tt.length/4,X=V}rt&&R.draw(C,k.LINES,Rn.disabled,gr.disabled,v.colorModeForRenderPass(),dr.disabled,we(Ke,v.transform,De),v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ie),d.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,null,v.transform.zoom,null,null,rt.collisionVertexBuffer)}if(!E||!j.length)return;const ce=v.useProgram("collisionCircle"),le=new l.aV;le.resize(4*V),le._trim();let fe=0;for(const ge of j)for(let Ie=0;Ie<ge.circleArray.length/4;Ie++){const De=4*Ie,Be=ge.circleArray[De+0],Ke=ge.circleArray[De+1],rt=ge.circleArray[De+2],tt=ge.circleArray[De+3];le.emplace(fe++,Be,Ke,rt,tt,0),le.emplace(fe++,Be,Ke,rt,tt,1),le.emplace(fe++,Be,Ke,rt,tt,2),le.emplace(fe++,Be,Ke,rt,tt,3)}(!Oc||Oc.length<2*V)&&(Oc=function(ge){const Ie=2*ge,De=new l.aX;De.resize(Ie),De._trim();for(let Be=0;Be<Ie;Be++){const Ke=6*Be;De.uint16[Ke+0]=4*Be+0,De.uint16[Ke+1]=4*Be+1,De.uint16[Ke+2]=4*Be+2,De.uint16[Ke+3]=4*Be+2,De.uint16[Ke+4]=4*Be+3,De.uint16[Ke+5]=4*Be+0}return De}(V));const oe=C.createIndexBuffer(Oc,!0),Pe=C.createVertexBuffer(le,l.aW.members,!0);for(const ge of j){const Ie={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(Oe=v.transform).cameraToCenterDistance,u_viewport_size:[Oe.width,Oe.height]};ce.draw(C,k.TRIANGLES,Rn.disabled,gr.disabled,v.colorModeForRenderPass(),dr.disabled,Ie,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ge.coord),d.id,Pe,oe,l.S.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,v.transform.zoom,null,null,null)}var Oe;Pe.destroy(),oe.destroy()}dr.disabled=new dr(!1,1029,2305),dr.backCCW=new dr(!0,1029,2305);const uf=l.ao(new Float32Array(16));function Ku(v,o,d,p,y,b){const{horizontalAlign:E,verticalAlign:C}=l.au(v);return new l.P((-(E-.5)*o/y+p[0])*b,(-(C-.5)*d/y+p[1])*b)}function Ju(v,o,d,p,y,b,E,C,k,R,j){const V=v.text.placedSymbolArray,X=v.text.dynamicLayoutVertexArray,ce=v.icon.dynamicLayoutVertexArray,le={};X.clear();for(let fe=0;fe<V.length;fe++){const oe=V.get(fe),Pe=oe.hidden||!oe.crossTileID||v.allowVerticalPlacement&&!oe.placedOrientation?null:p[oe.crossTileID];if(Pe){const Oe=new l.P(oe.anchorX,oe.anchorY),ge=$t(Oe,d?E:b,j),Ie=wn(y.cameraToCenterDistance,ge.signedDistanceFromCamera);let De=l.aj(v.textSizeData,k,oe)*Ie/l.ap;d&&(De*=v.tilePixelRatio/C);const{width:Be,height:Ke,anchor:rt,textOffset:tt,textBoxScale:ct}=Pe,zt=Ku(rt,Be,Ke,tt,ct,De),Cn=d?$t(Oe.add(zt),b,j).point:ge.point.add(o?zt.rotate(-y.angle):zt),mt=v.allowVerticalPlacement&&oe.placedOrientation===l.ai.vertical?Math.PI/2:0;for(let rn=0;rn<oe.numGlyphs;rn++)l.ak(X,Cn,mt);R&&oe.associatedIconIndex>=0&&(le[oe.associatedIconIndex]={shiftedAnchor:Cn,angle:mt})}else ne(oe.numGlyphs,X)}if(R){ce.clear();const fe=v.icon.placedSymbolArray;for(let oe=0;oe<fe.length;oe++){const Pe=fe.get(oe);if(Pe.hidden)ne(Pe.numGlyphs,ce);else{const Oe=le[oe];if(Oe)for(let ge=0;ge<Pe.numGlyphs;ge++)l.ak(ce,Oe.shiftedAnchor,Oe.angle);else ne(Pe.numGlyphs,ce)}}v.icon.dynamicLayoutVertexBuffer.updateData(ce)}v.text.dynamicLayoutVertexBuffer.updateData(X)}function hf(v,o,d){return d.iconsInText&&o?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Qu(v,o,d,p,y,b,E,C,k,R,j,V){const X=v.context,ce=X.gl,le=v.transform,fe=C==="map",oe=k==="map",Pe=C!=="viewport"&&d.layout.get("symbol-placement")!=="point",Oe=fe&&!oe&&!Pe,ge=!d.layout.get("symbol-sort-key").isConstant();let Ie=!1;const De=v.depthModeForSublayer(0,Rn.ReadOnly),Be=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ke=[];for(const rt of p){const tt=o.getTile(rt),ct=tt.getBucket(d);if(!ct)continue;const zt=y?ct.text:ct.icon;if(!zt||!zt.segments.get().length||!zt.hasVisibleVertices)continue;const Cn=zt.programConfigurations.get(d.id),mt=y||ct.sdfIcons,rn=y?ct.textSizeData:ct.iconSizeData,Nt=oe||le.pitch!==0,Wn=v.useProgram(hf(mt,y,ct),Cn),En=l.ah(rn,le.zoom),xn=v.style.map.terrain&&v.style.map.terrain.getTerrainData(rt);let An,Ar,er,pi,Jr=[0,0],Or=null;if(y)Ar=tt.glyphAtlasTexture,er=ce.LINEAR,An=tt.glyphAtlasTexture.size,ct.iconsInText&&(Jr=tt.imageAtlasTexture.size,Or=tt.imageAtlasTexture,pi=Nt||v.options.rotating||v.options.zooming||rn.kind==="composite"||rn.kind==="camera"?ce.LINEAR:ce.NEAREST);else{const Ir=d.layout.get("icon-size").constantOr(0)!==1||ct.iconsNeedLinear;Ar=tt.imageAtlasTexture,er=mt||v.options.rotating||v.options.zooming||Ir||Nt?ce.LINEAR:ce.NEAREST,An=tt.imageAtlasTexture.size}const ms=be(tt,1,v.transform.zoom),or=$e(rt.posMatrix,oe,fe,v.transform,ms),yo=ot(rt.posMatrix,oe,fe,v.transform,ms),_o=Be&&ct.hasTextData(),ya=d.layout.get("icon-text-fit")!=="none"&&_o&&ct.hasIconData();if(Pe){const Ir=v.style.map.terrain?(Zi,kr)=>v.style.map.terrain.getElevation(rt,Zi,kr):null,Qr=d.layout.get("text-rotation-alignment")==="map";nt(ct,rt.posMatrix,v,y,or,yo,oe,R,Qr,Ir)}const qa=v.translatePosMatrix(rt.posMatrix,tt,b,E),Nl=Pe||y&&Be||ya?uf:or,wi=v.translatePosMatrix(yo,tt,b,E,!0),mi=mt&&d.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Li;Li=mt?ct.iconsInText?ja(rn.kind,En,Oe,oe,v,qa,Nl,wi,An,Jr):Jd(rn.kind,En,Oe,oe,v,qa,Nl,wi,y,An,!0):Kd(rn.kind,En,Oe,oe,v,qa,Nl,wi,y,An);const Za={program:Wn,buffers:zt,uniformValues:Li,atlasTexture:Ar,atlasTextureIcon:Or,atlasInterpolation:er,atlasInterpolationIcon:pi,isSDF:mt,hasHalo:mi};if(ge&&ct.canOverlap){Ie=!0;const Ir=zt.segments.get();for(const Qr of Ir)Ke.push({segments:new l.S([Qr]),sortKey:Qr.sortKey,state:Za,terrainData:xn})}else Ke.push({segments:zt.segments,sortKey:0,state:Za,terrainData:xn})}Ie&&Ke.sort((rt,tt)=>rt.sortKey-tt.sortKey);for(const rt of Ke){const tt=rt.state;if(X.activeTexture.set(ce.TEXTURE0),tt.atlasTexture.bind(tt.atlasInterpolation,ce.CLAMP_TO_EDGE),tt.atlasTextureIcon&&(X.activeTexture.set(ce.TEXTURE1),tt.atlasTextureIcon&&tt.atlasTextureIcon.bind(tt.atlasInterpolationIcon,ce.CLAMP_TO_EDGE)),tt.isSDF){const ct=tt.uniformValues;tt.hasHalo&&(ct.u_is_halo=1,df(tt.buffers,rt.segments,d,v,tt.program,De,j,V,ct,rt.terrainData)),ct.u_is_halo=0}df(tt.buffers,rt.segments,d,v,tt.program,De,j,V,tt.uniformValues,rt.terrainData)}}function df(v,o,d,p,y,b,E,C,k,R){const j=p.context;y.draw(j,j.gl.TRIANGLES,b,E,C,dr.disabled,k,R,d.id,v.layoutVertexBuffer,v.indexBuffer,o,d.paint,p.transform.zoom,v.programConfigurations.get(d.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function zc(v,o,d,p,y){if(!d||!p||!p.imageAtlas)return;const b=p.imageAtlas.patternPositions;let E=b[d.to.toString()],C=b[d.from.toString()];if(!E&&C&&(E=C),!C&&E&&(C=E),!E||!C){const k=y.getPaintProperty(o);E=b[k],C=b[k]}E&&C&&v.setConstantPatternPositions(E,C)}function Dc(v,o,d,p,y,b,E){const C=v.context.gl,k="fill-pattern",R=d.paint.get(k),j=R&&R.constantOr(1),V=d.getCrossfadeParameters();let X,ce,le,fe,oe;E?(ce=j&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=C.LINES):(ce=j?"fillPattern":"fill",X=C.TRIANGLES);const Pe=R.constantOr(null);for(const Oe of p){const ge=o.getTile(Oe);if(j&&!ge.patternsLoaded())continue;const Ie=ge.getBucket(d);if(!Ie)continue;const De=Ie.programConfigurations.get(d.id),Be=v.useProgram(ce,De),Ke=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Oe);j&&(v.context.activeTexture.set(C.TEXTURE0),ge.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),De.updatePaintBuffers(V)),zc(De,k,Pe,ge,d);const rt=Ke?Oe:null,tt=v.translatePosMatrix(rt?rt.posMatrix:Oe.posMatrix,ge,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(E){fe=Ie.indexBuffer2,oe=Ie.segments2;const ct=[C.drawingBufferWidth,C.drawingBufferHeight];le=ce==="fillOutlinePattern"&&j?ee(tt,v,V,ge,ct):Cl(tt,ct)}else fe=Ie.indexBuffer,oe=Ie.segments,le=j?Lc(tt,v,V,ge):Mc(tt);Be.draw(v.context,X,y,v.stencilModeForClipping(Oe),b,dr.disabled,le,Ke,d.id,Ie.layoutVertexBuffer,fe,oe,d.paint,v.transform.zoom,De)}}function Fc(v,o,d,p,y,b,E){const C=v.context,k=C.gl,R="fill-extrusion-pattern",j=d.paint.get(R),V=j.constantOr(1),X=d.getCrossfadeParameters(),ce=d.paint.get("fill-extrusion-opacity"),le=j.constantOr(null);for(const fe of p){const oe=o.getTile(fe),Pe=oe.getBucket(d);if(!Pe)continue;const Oe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(fe),ge=Pe.programConfigurations.get(d.id),Ie=v.useProgram(V?"fillExtrusionPattern":"fillExtrusion",ge);V&&(v.context.activeTexture.set(k.TEXTURE0),oe.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ge.updatePaintBuffers(X)),zc(ge,R,le,oe,d);const De=v.translatePosMatrix(fe.posMatrix,oe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Be=d.paint.get("fill-extrusion-vertical-gradient"),Ke=V?Cs(De,v,Be,ce,fe,X,oe):Pl(De,v,Be,ce);Ie.draw(C,C.gl.TRIANGLES,y,b,E,dr.backCCW,Ke,Oe,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,v.transform.zoom,ge,v.style.map.terrain&&Pe.centroidVertexBuffer)}}function Wv(v,o,d,p,y,b,E){const C=v.context,k=C.gl,R=d.fbo;if(!R)return;const j=v.useProgram("hillshade"),V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(o);C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,R.colorAttachment.get()),j.draw(C,k.TRIANGLES,y,b,E,dr.disabled,((X,ce,le,fe)=>{const oe=le.paint.get("hillshade-shadow-color"),Pe=le.paint.get("hillshade-highlight-color"),Oe=le.paint.get("hillshade-accent-color");let ge=le.paint.get("hillshade-illumination-direction")*(Math.PI/180);le.paint.get("hillshade-illumination-anchor")==="viewport"&&(ge-=X.transform.angle);const Ie=!X.options.moving;return{u_matrix:fe?fe.posMatrix:X.transform.calculatePosMatrix(ce.tileID.toUnwrapped(),Ie),u_image:0,u_latrange:Tn(0,ce.tileID),u_light:[le.paint.get("hillshade-exaggeration"),ge],u_shadow:oe,u_highlight:Pe,u_accent:Oe}})(v,d,p,V?o:null),V,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function ff(v,o,d,p,y,b){const E=v.context,C=E.gl,k=o.dem;if(k&&k.data){const R=k.dim,j=k.stride,V=k.getPixels();if(E.activeTexture.set(C.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||v.getTileTexture(j),o.demTexture){const ce=o.demTexture;ce.update(V,{premultiply:!1}),ce.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else o.demTexture=new _e(E,V,C.RGBA,{premultiply:!1}),o.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);E.activeTexture.set(C.TEXTURE0);let X=o.fbo;if(!X){const ce=new _e(E,{width:R,height:R,data:null},C.RGBA);ce.bind(C.LINEAR,C.CLAMP_TO_EDGE),X=o.fbo=E.createFramebuffer(R,R,!0,!1),X.colorAttachment.set(ce.texture)}E.bindFramebuffer.set(X.framebuffer),E.viewport.set([0,0,R,R]),v.useProgram("hillshadePrepare").draw(E,C.TRIANGLES,p,y,b,dr.disabled,((ce,le)=>{const fe=le.stride,oe=l.Z();return l.aS(oe,0,l.N,-l.N,0,0,1),l.$(oe,oe,[0,-l.N,0]),{u_matrix:oe,u_image:1,u_dimension:[fe,fe],u_zoom:ce.overscaledZ,u_unpack:le.getUnpackVector()}})(o.tileID,k),null,d.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function Hv(v,o,d,p,y,b){const E=p.paint.get("raster-fade-duration");if(!b&&E>0){const C=l.h.now(),k=(C-v.timeAdded)/E,R=o?(C-o.timeAdded)/E:-1,j=d.getSource(),V=y.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),X=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(v.tileID.overscaledZ-V),ce=X&&v.refreshedUponExpiration?1:l.ad(X?k:1-R,0,1);return v.refreshedUponExpiration&&k>=1&&(v.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ce}:{opacity:ce,mix:0}}return{opacity:1,mix:0}}const fg=new l.aT(1,0,0,1),eh=new l.aT(0,1,0,1),pf=new l.aT(0,0,1,1),pg=new l.aT(1,0,1,1),mg=new l.aT(0,1,1,1);function Nc(v,o,d,p){nh(v,0,o+d/2,v.transform.width,d,p)}function th(v,o,d,p){nh(v,o-d/2,0,d,v.transform.height,p)}function nh(v,o,d,p,y,b){const E=v.context,C=E.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*v.pixelRatio,d*v.pixelRatio,p*v.pixelRatio,y*v.pixelRatio),E.clear({color:b}),C.disable(C.SCISSOR_TEST)}function gg(v,o,d){const p=v.context,y=p.gl,b=d.posMatrix,E=v.useProgram("debug"),C=Rn.disabled,k=gr.disabled,R=v.colorModeForRenderPass(),j="$debug",V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(d);p.activeTexture.set(y.TEXTURE0);const X=o.getTileByID(d.key).latestRawTileData,ce=Math.floor((X&&X.byteLength||0)/1024),le=o.getTile(d).tileSize,fe=512/Math.min(le,512)*(d.overscaledZ/v.transform.zoom)*.5;let oe=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(oe+=` => ${d.overscaledZ}`),function(Pe,Oe){Pe.initDebugOverlayCanvas();const ge=Pe.debugOverlayCanvas,Ie=Pe.context.gl,De=Pe.debugOverlayCanvas.getContext("2d");De.clearRect(0,0,ge.width,ge.height),De.shadowColor="white",De.shadowBlur=2,De.lineWidth=1.5,De.strokeStyle="white",De.textBaseline="top",De.font="bold 36px Open Sans, sans-serif",De.fillText(Oe,5,5),De.strokeText(Oe,5,5),Pe.debugOverlayTexture.update(ge),Pe.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(v,`${oe} ${ce}kB`),E.draw(p,y.TRIANGLES,C,k,mr.alphaBlended,dr.disabled,Fe(b,l.aT.transparent,fe),null,j,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),E.draw(p,y.LINE_STRIP,C,k,R,dr.disabled,Fe(b,l.aT.red),V,j,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function xr(v,o,d){const p=v.context,y=p.gl,b=v.colorModeForRenderPass(),E=new Rn(y.LEQUAL,Rn.ReadWrite,v.depthRangeFor3D),C=v.useProgram("terrain"),k=o.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const R of d){const j=v.renderToTexture.getTexture(R),V=o.getTerrainData(R.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,j.texture);const X={u_matrix:v.transform.calculatePosMatrix(R.tileID.toUnwrapped()),u_texture:0,u_ele_delta:o.getMeshFrameDelta(v.transform.zoom)};C.draw(p,y.TRIANGLES,E,gr.disabled,b,dr.backCCW,X,V,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class $a{constructor(o,d){this.context=new Gv(o),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.Z(),renderTime:0},this.setup(),this.numSublayers=Tt.maxUnderzooming+Tt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ki}resize(o,d,p){if(this.width=Math.floor(o*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const o=this.context,d=new l.a_;d.emplaceBack(0,0),d.emplaceBack(l.N,0),d.emplaceBack(0,l.N),d.emplaceBack(l.N,l.N),this.tileExtentBuffer=o.createVertexBuffer(d,$o.members),this.tileExtentSegments=l.S.simpleSegment(0,0,4,2);const p=new l.a_;p.emplaceBack(0,0),p.emplaceBack(l.N,0),p.emplaceBack(0,l.N),p.emplaceBack(l.N,l.N),this.debugBuffer=o.createVertexBuffer(p,$o.members),this.debugSegments=l.S.simpleSegment(0,0,4,5);const y=new l.V;y.emplaceBack(0,0,0,0),y.emplaceBack(l.N,0,l.N,0),y.emplaceBack(0,l.N,0,l.N),y.emplaceBack(l.N,l.N,l.N,l.N),this.rasterBoundsBuffer=o.createVertexBuffer(y,Et.members),this.rasterBoundsSegments=l.S.simpleSegment(0,0,4,2);const b=new l.a_;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,$o.members),this.viewportSegments=l.S.simpleSegment(0,0,4,2);const E=new l.a$;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(E);const C=new l.b0;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const k=this.context.gl;this.stencilClearMode=new gr({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const o=this.context,d=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.Z();l.aS(p,0,this.width,this.height,0,0,1),l.a0(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,d.TRIANGLES,Rn.disabled,this.stencilClearMode,mr.disabled,dr.disabled,lt(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,d){if(this.currentStencilSource===o.source||!o.isTileClipped()||!d||!d.length)return;this.currentStencilSource=o.source;const p=this.context,y=p.gl;this.nextStencilID+d.length>256&&this.clearStencil(),p.setColorMode(mr.disabled),p.setDepthMode(Rn.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of d){const C=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);b.draw(p,y.TRIANGLES,Rn.disabled,new gr({func:y.ALWAYS,mask:0},C,255,y.KEEP,y.KEEP,y.REPLACE),mr.disabled,dr.disabled,lt(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new gr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){const d=this.context.gl;return new gr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,p=o.sort((E,C)=>C.overscaledZ-E.overscaledZ),y=p[p.length-1].overscaledZ,b=p[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const E={};for(let C=0;C<b;C++)E[C+y]=new gr({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[E,p]}return[{[y]:gr.disabled},p]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new mr([o.CONSTANT_COLOR,o.ONE],new l.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(o,d,p){if(!this.opaquePassEnabledForLayer())return Rn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Rn(p||this.context.gl.LEQUAL,d,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,d){this.style=o,this.options=d,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(l.h.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,b={},E={},C={};for(const k in y){const R=y[k];R.used&&R.prepare(this.context),b[k]=R.getVisibleCoordinates(),E[k]=b[k].slice().reverse(),C[k]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<p.length;k++)if(this.style._layers[p[k]].is3D()){this.opaquePassCutoff=k;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const k=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(l.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(R,j){const V=R.context,X=V.gl,ce=mr.unblended,le=new Rn(X.LEQUAL,Rn.ReadWrite,[0,1]),fe=j.getTerrainMesh(),oe=j.sourceCache.getRenderableTiles(),Pe=R.useProgram("terrainDepth");V.bindFramebuffer.set(j.getFramebuffer("depth").framebuffer),V.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),V.clear({color:l.aT.transparent,depth:1});for(const Oe of oe){const ge=j.getTerrainData(Oe.tileID),Ie={u_matrix:R.transform.calculatePosMatrix(Oe.tileID.toUnwrapped()),u_ele_delta:j.getMeshFrameDelta(R.transform.zoom)};Pe.draw(V,X.TRIANGLES,le,gr.disabled,ce,dr.backCCW,Ie,ge,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments)}V.bindFramebuffer.set(null),V.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain),function(R,j){const V=R.context,X=V.gl,ce=mr.unblended,le=new Rn(X.LEQUAL,Rn.ReadWrite,[0,1]),fe=j.getTerrainMesh(),oe=j.getCoordsTexture(),Pe=j.sourceCache.getRenderableTiles(),Oe=R.useProgram("terrainCoords");V.bindFramebuffer.set(j.getFramebuffer("coords").framebuffer),V.viewport.set([0,0,R.width/devicePixelRatio,R.height/devicePixelRatio]),V.clear({color:l.aT.transparent,depth:1}),j.coordsIndex=[];for(const ge of Pe){const Ie=j.getTerrainData(ge.tileID);V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,oe.texture);const De={u_matrix:R.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_terrain_coords_id:(255-j.coordsIndex.length)/255,u_texture:0,u_ele_delta:j.getMeshFrameDelta(R.transform.zoom)};Oe.draw(V,X.TRIANGLES,le,gr.disabled,ce,dr.backCCW,De,Ie,"terrain",fe.vertexBuffer,fe.indexBuffer,fe.segments),j.coordsIndex.push(ge.tileID.key)}V.bindFramebuffer.set(null),V.viewport.set([0,0,R.width,R.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const k of p){const R=this.style._layers[k];if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const j=E[R.source];(R.type==="custom"||j.length)&&this.renderLayer(this,y[R.source],R,j)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?l.aT.black:l.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[p[this.currentLayer]],R=y[k.source],j=b[k.source];this._renderTileClippingMasks(k,j),this.renderLayer(this,R,k,j)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const k=this.style._layers[p[this.currentLayer]],R=y[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const j=(k.type==="symbol"?C:E)[k.source];this._renderTileClippingMasks(k,b[k.source]),this.renderLayer(this,R,k,j)}if(this.options.showTileBoundaries){const k=function(R,j){let V=null;const X=Object.values(R._layers).flatMap(oe=>oe.source&&!oe.isHidden(j)?[R.sourceCaches[oe.source]]:[]),ce=X.filter(oe=>oe.getSource().type==="vector"),le=X.filter(oe=>oe.getSource().type!=="vector"),fe=oe=>{(!V||V.getSource().maxzoom<oe.getSource().maxzoom)&&(V=oe)};return ce.forEach(oe=>fe(oe)),V||le.forEach(oe=>fe(oe)),V}(this.style,this.transform.zoom);k&&function(R,j,V){for(let X=0;X<V.length;X++)gg(R,j,V[X])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const R=k.transform.padding;Nc(k,k.transform.height-(R.top||0),3,fg),Nc(k,R.bottom||0,3,eh),th(k,R.left||0,3,pf),th(k,k.transform.width-(R.right||0),3,pg);const j=k.transform.centerPoint;(function(V,X,ce,le){nh(V,X-1,ce-10,2,20,le),nh(V,X-10,ce-1,20,2,le)})(k,j.x,k.transform.height-j.y,mg)}(this),this.context.setDefault()}renderLayer(o,d,p,y){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(y||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,E,C,k,R){if(b.renderPass!=="translucent")return;const j=gr.disabled,V=b.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(X,ce,le,fe,oe,Pe,Oe){const ge=ce.transform,Ie=oe==="map",De=Pe==="map";for(const Be of X){const Ke=fe.getTile(Be),rt=Ke.getBucket(le);if(!rt||!rt.text||!rt.text.segments.get().length)continue;const tt=l.ah(rt.textSizeData,ge.zoom),ct=be(Ke,1,ce.transform.zoom),zt=$e(Be.posMatrix,De,Ie,ce.transform,ct),Cn=le.layout.get("icon-text-fit")!=="none"&&rt.hasIconData();if(tt){const mt=Math.pow(2,ge.zoom-Ke.tileID.overscaledZ);Ju(rt,Ie,De,Oe,ge,zt,Be.posMatrix,mt,tt,Cn,ce.style.map.terrain?(rn,Nt)=>ce.style.map.terrain.getElevation(Be,rn,Nt):null)}}}(k,b,C,E,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),R),C.paint.get("icon-opacity").constantOr(1)!==0&&Qu(b,E,C,k,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),j,V),C.paint.get("text-opacity").constantOr(1)!==0&&Qu(b,E,C,k,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),j,V),E.map.showCollisionBoxes&&(dg(b,E,C,k,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),dg(b,E,C,k,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(o,d,p,y,this.style.placement.variableOffsets);break;case"circle":(function(b,E,C,k){if(b.renderPass!=="translucent")return;const R=C.paint.get("circle-opacity"),j=C.paint.get("circle-stroke-width"),V=C.paint.get("circle-stroke-opacity"),X=!C.layout.get("circle-sort-key").isConstant();if(R.constantOr(1)===0&&(j.constantOr(1)===0||V.constantOr(1)===0))return;const ce=b.context,le=ce.gl,fe=b.depthModeForSublayer(0,Rn.ReadOnly),oe=gr.disabled,Pe=b.colorModeForRenderPass(),Oe=[];for(let ge=0;ge<k.length;ge++){const Ie=k[ge],De=E.getTile(Ie),Be=De.getBucket(C);if(!Be)continue;const Ke=Be.programConfigurations.get(C.id),rt=b.useProgram("circle",Ke),tt=Be.layoutVertexBuffer,ct=Be.indexBuffer,zt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),Cn={programConfiguration:Ke,program:rt,layoutVertexBuffer:tt,indexBuffer:ct,uniformValues:re(b,Ie,De,C),terrainData:zt};if(X){const mt=Be.segments.get();for(const rn of mt)Oe.push({segments:new l.S([rn]),sortKey:rn.sortKey,state:Cn})}else Oe.push({segments:Be.segments,sortKey:0,state:Cn})}X&&Oe.sort((ge,Ie)=>ge.sortKey-Ie.sortKey);for(const ge of Oe){const{programConfiguration:Ie,program:De,layoutVertexBuffer:Be,indexBuffer:Ke,uniformValues:rt,terrainData:tt}=ge.state;De.draw(ce,le.TRIANGLES,fe,oe,Pe,dr.disabled,rt,tt,C.id,Be,Ke,ge.segments,C.paint,b.transform.zoom,Ie)}})(o,d,p,y);break;case"heatmap":(function(b,E,C,k){if(C.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const R=b.context,j=R.gl,V=gr.disabled,X=new mr([j.ONE,j.ONE],l.aT.transparent,[!0,!0,!0,!0]);(function(ce,le,fe){const oe=ce.gl;ce.activeTexture.set(oe.TEXTURE1),ce.viewport.set([0,0,le.width/4,le.height/4]);let Pe=fe.heatmapFbo;if(Pe)oe.bindTexture(oe.TEXTURE_2D,Pe.colorAttachment.get()),ce.bindFramebuffer.set(Pe.framebuffer);else{const Oe=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,Oe),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),Pe=fe.heatmapFbo=ce.createFramebuffer(le.width/4,le.height/4,!1,!1),function(ge,Ie,De,Be){var Ke,rt;const tt=ge.gl,ct=(Ke=ge.HALF_FLOAT)!==null&&Ke!==void 0?Ke:tt.UNSIGNED_BYTE,zt=(rt=ge.RGBA16F)!==null&&rt!==void 0?rt:tt.RGBA;tt.texImage2D(tt.TEXTURE_2D,0,zt,Ie.width/4,Ie.height/4,0,tt.RGBA,ct,null),Be.colorAttachment.set(De)}(ce,le,Oe,Pe)}})(R,b,C),R.clear({color:l.aT.transparent});for(let ce=0;ce<k.length;ce++){const le=k[ce];if(E.hasRenderableParent(le))continue;const fe=E.getTile(le),oe=fe.getBucket(C);if(!oe)continue;const Pe=oe.programConfigurations.get(C.id),Oe=b.useProgram("heatmap",Pe),{zoom:ge}=b.transform;Oe.draw(R,j.TRIANGLES,Rn.disabled,V,X,dr.disabled,Ot(le.posMatrix,fe,ge,C.paint.get("heatmap-intensity")),null,C.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,C.paint,b.transform.zoom,Pe)}R.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(R,j){const V=R.context,X=V.gl,ce=j.heatmapFbo;if(!ce)return;V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,ce.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1);let le=j.colorRampTexture;le||(le=j.colorRampTexture=new _e(V,j.colorRamp,X.RGBA)),le.bind(X.LINEAR,X.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw(V,X.TRIANGLES,Rn.disabled,gr.disabled,R.colorModeForRenderPass(),dr.disabled,((fe,oe,Pe,Oe)=>{const ge=l.Z();l.aS(ge,0,fe.width,fe.height,0,0,1);const Ie=fe.context.gl;return{u_matrix:ge,u_world:[Ie.drawingBufferWidth,Ie.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:oe.paint.get("heatmap-opacity")}})(R,j),null,j.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,j.paint,R.transform.zoom)}(b,C))})(o,d,p,y);break;case"line":(function(b,E,C,k){if(b.renderPass!=="translucent")return;const R=C.paint.get("line-opacity"),j=C.paint.get("line-width");if(R.constantOr(1)===0||j.constantOr(1)===0)return;const V=b.depthModeForSublayer(0,Rn.ReadOnly),X=b.colorModeForRenderPass(),ce=C.paint.get("line-dasharray"),le=C.paint.get("line-pattern"),fe=le.constantOr(1),oe=C.paint.get("line-gradient"),Pe=C.getCrossfadeParameters(),Oe=fe?"linePattern":ce?"lineSDF":oe?"lineGradient":"line",ge=b.context,Ie=ge.gl;let De=!0;for(const Be of k){const Ke=E.getTile(Be);if(fe&&!Ke.patternsLoaded())continue;const rt=Ke.getBucket(C);if(!rt)continue;const tt=rt.programConfigurations.get(C.id),ct=b.context.program.get(),zt=b.useProgram(Oe,tt),Cn=De||zt.program!==ct,mt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Be),rn=le.constantOr(null);if(rn&&Ke.imageAtlas){const En=Ke.imageAtlas,xn=En.patternPositions[rn.to.toString()],An=En.patternPositions[rn.from.toString()];xn&&An&&tt.setConstantPatternPositions(xn,An)}const Nt=mt?Be:null,Wn=fe?fi(b,Ke,C,Pe,Nt):ce?us(b,Ke,C,ce,Pe,Nt):oe?Ur(b,Ke,C,rt.lineClipsArray.length,Nt):Cr(b,Ke,C,Nt);if(fe)ge.activeTexture.set(Ie.TEXTURE0),Ke.imageAtlasTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),tt.updatePaintBuffers(Pe);else if(ce&&(Cn||b.lineAtlas.dirty))ge.activeTexture.set(Ie.TEXTURE0),b.lineAtlas.bind(ge);else if(oe){const En=rt.gradients[C.id];let xn=En.texture;if(C.gradientVersion!==En.version){let An=256;if(C.stepInterpolant){const Ar=E.getSource().maxzoom,er=Be.canonical.z===Ar?Math.ceil(1<<b.transform.maxZoom-Be.canonical.z):1;An=l.ad(l.aY(rt.maxLineLength/l.N*1024*er),256,ge.maxTextureSize)}En.gradient=l.aZ({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:An,image:En.gradient||void 0,clips:rt.lineClipsArray}),En.texture?En.texture.update(En.gradient):En.texture=new _e(ge,En.gradient,Ie.RGBA),En.version=C.gradientVersion,xn=En.texture}ge.activeTexture.set(Ie.TEXTURE0),xn.bind(C.stepInterpolant?Ie.NEAREST:Ie.LINEAR,Ie.CLAMP_TO_EDGE)}zt.draw(ge,Ie.TRIANGLES,V,b.stencilModeForClipping(Be),X,dr.disabled,Wn,mt,C.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,C.paint,b.transform.zoom,tt,rt.layoutVertexBuffer2),De=!1}})(o,d,p,y);break;case"fill":(function(b,E,C,k){const R=C.paint.get("fill-color"),j=C.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const V=b.colorModeForRenderPass(),X=C.paint.get("fill-pattern"),ce=b.opaquePassEnabledForLayer()&&!X.constantOr(1)&&R.constantOr(l.aT.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===ce){const le=b.depthModeForSublayer(1,b.renderPass==="opaque"?Rn.ReadWrite:Rn.ReadOnly);Dc(b,E,C,k,le,V,!1)}if(b.renderPass==="translucent"&&C.paint.get("fill-antialias")){const le=b.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,Rn.ReadOnly);Dc(b,E,C,k,le,V,!0)}})(o,d,p,y);break;case"fill-extrusion":(function(b,E,C,k){const R=C.paint.get("fill-extrusion-opacity");if(R!==0&&b.renderPass==="translucent"){const j=new Rn(b.context.gl.LEQUAL,Rn.ReadWrite,b.depthRangeFor3D);if(R!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))Fc(b,E,C,k,j,gr.disabled,mr.disabled),Fc(b,E,C,k,j,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const V=b.colorModeForRenderPass();Fc(b,E,C,k,j,gr.disabled,V)}}})(o,d,p,y);break;case"hillshade":(function(b,E,C,k){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const R=b.context,j=b.depthModeForSublayer(0,Rn.ReadOnly),V=b.colorModeForRenderPass(),[X,ce]=b.renderPass==="translucent"?b.stencilConfigForOverlap(k):[{},k];for(const le of ce){const fe=E.getTile(le);fe.needsHillshadePrepare!==void 0&&fe.needsHillshadePrepare&&b.renderPass==="offscreen"?ff(b,fe,C,j,gr.disabled,V):b.renderPass==="translucent"&&Wv(b,le,fe,C,j,X[le.overscaledZ],V)}R.viewport.set([0,0,b.width,b.height])})(o,d,p,y);break;case"raster":(function(b,E,C,k){if(b.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!k.length)return;const R=b.context,j=R.gl,V=E.getSource(),X=b.useProgram("raster"),ce=b.colorModeForRenderPass(),[le,fe]=V instanceof ln?[{},k]:b.stencilConfigForOverlap(k),oe=fe[fe.length-1].overscaledZ,Pe=!b.options.moving;for(const Oe of fe){const ge=b.depthModeForSublayer(Oe.overscaledZ-oe,C.paint.get("raster-opacity")===1?Rn.ReadWrite:Rn.ReadOnly,j.LESS),Ie=E.getTile(Oe);Ie.registerFadeDuration(C.paint.get("raster-fade-duration"));const De=E.findLoadedParent(Oe,0),Be=Hv(Ie,De,E,C,b.transform,b.style.map.terrain);let Ke,rt;const tt=C.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;R.activeTexture.set(j.TEXTURE0),Ie.texture.bind(tt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),R.activeTexture.set(j.TEXTURE1),De?(De.texture.bind(tt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST),Ke=Math.pow(2,De.tileID.overscaledZ-Ie.tileID.overscaledZ),rt=[Ie.tileID.canonical.x*Ke%1,Ie.tileID.canonical.y*Ke%1]):Ie.texture.bind(tt,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe),zt=ct?Oe:null,Cn=zt?zt.posMatrix:b.transform.calculatePosMatrix(Oe.toUnwrapped(),Pe),mt=ig(Cn,rt||[0,0],Ke||1,Be,C);V instanceof ln?X.draw(R,j.TRIANGLES,ge,gr.disabled,ce,dr.disabled,mt,ct,C.id,V.boundsBuffer,b.quadTriangleIndexBuffer,V.boundsSegments):X.draw(R,j.TRIANGLES,ge,le[Oe.overscaledZ],ce,dr.disabled,mt,ct,C.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(o,d,p,y);break;case"background":(function(b,E,C,k){const R=C.paint.get("background-color"),j=C.paint.get("background-opacity");if(j===0)return;const V=b.context,X=V.gl,ce=b.transform,le=ce.tileSize,fe=C.paint.get("background-pattern");if(b.isPatternMissing(fe))return;const oe=!fe&&R.a===1&&j===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==oe)return;const Pe=gr.disabled,Oe=b.depthModeForSublayer(0,oe==="opaque"?Rn.ReadWrite:Rn.ReadOnly),ge=b.colorModeForRenderPass(),Ie=b.useProgram(fe?"backgroundPattern":"background"),De=k||ce.coveringTiles({tileSize:le,terrain:b.style.map.terrain});fe&&(V.activeTexture.set(X.TEXTURE0),b.imageManager.bind(b.context));const Be=C.getCrossfadeParameters();for(const Ke of De){const rt=k?Ke.posMatrix:b.transform.calculatePosMatrix(Ke.toUnwrapped()),tt=fe?As(rt,j,b,fe,{tileID:Ke,tileSize:le},Be):Vu(rt,j,R),ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ke);Ie.draw(V,X.TRIANGLES,Oe,Pe,ge,dr.disabled,tt,ct,C.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(o,0,p,y);break;case"custom":(function(b,E,C){const k=b.context,R=C.implementation;if(b.renderPass==="offscreen"){const j=R.prerender;j&&(b.setCustomLayerDefaults(),k.setColorMode(b.colorModeForRenderPass()),j.call(R,k.gl,b.transform.customLayerMatrix()),k.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),k.setColorMode(b.colorModeForRenderPass()),k.setStencilMode(gr.disabled);const j=R.renderingMode==="3d"?new Rn(b.context.gl.LEQUAL,Rn.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Rn.ReadOnly);k.setDepthMode(j),R.render(k.gl,b.transform.customLayerMatrix()),k.setDirty(),b.setBaseState(),k.bindFramebuffer.set(null)}})(o,0,p)}}translatePosMatrix(o,d,p,y,b){if(!p[0]&&!p[1])return o;const E=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(E){const R=Math.sin(E),j=Math.cos(E);p=[p[0]*j-p[1]*R,p[0]*R+p[1]*j]}const C=[b?p[0]:be(d,p[0],this.transform.zoom),b?p[1]:be(d,p[1],this.transform.zoom),0],k=new Float32Array(16);return l.$(k,o,C),k}saveTileTexture(o){const d=this._tileTextures[o.size[0]];d?d.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const d=this.imageManager.getPattern(o.from.toString()),p=this.imageManager.getPattern(o.to.toString());return!d||!p}useProgram(o,d){this.cache=this.cache||{};const p=o+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Gi(this.context,Jn[o],d,Uu[o],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _e(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:d}=this.context.gl;return this.width!==o||this.height!==d}}class Hi{constructor(o,d){this.points=o,this.planes=d}static fromInvProjectionMatrix(o,d,p){const y=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const k=1/(C=l.ag([],C,o))[3]/d*y;return l.b3(C,C,[k,k,1/C[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const k=function(X,ce){var le=ce[0],fe=ce[1],oe=ce[2],Pe=le*le+fe*fe+oe*oe;return Pe>0&&(Pe=1/Math.sqrt(Pe)),X[0]=ce[0]*Pe,X[1]=ce[1]*Pe,X[2]=ce[2]*Pe,X}([],function(X,ce,le){var fe=ce[0],oe=ce[1],Pe=ce[2],Oe=le[0],ge=le[1],Ie=le[2];return X[0]=oe*Ie-Pe*ge,X[1]=Pe*Oe-fe*Ie,X[2]=fe*ge-oe*Oe,X}([],te([],b[C[0]],b[C[1]]),te([],b[C[2]],b[C[1]]))),R=-((j=k)[0]*(V=b[C[1]])[0]+j[1]*V[1]+j[2]*V[2]);var j,V;return k.concat(R)});return new Hi(b,E)}}class Ll{constructor(o,d){this.min=o,this.max=d,this.center=function(p,y,b){return p[0]=.5*y[0],p[1]=.5*y[1],p[2]=.5*y[2],p}([],function(p,y,b){return p[0]=y[0]+b[0],p[1]=y[1]+b[1],p[2]=y[2]+b[2],p}([],this.min,this.max))}quadrant(o){const d=[o%2==0,o<2],p=$(this.min),y=$(this.max);for(let b=0;b<d.length;b++)p[b]=d[b]?this.min[b]:this.center[b],y[b]=d[b]?this.center[b]:this.max[b];return y[2]=this.max[2],new Ll(p,y)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<o.planes.length;y++){const b=o.planes[y];let E=0;for(let C=0;C<d.length;C++)l.b4(b,d[C])>=0&&E++;if(E===0)return 0;E!==d.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let b=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let C=0;C<o.points.length;C++){const k=o.points[C][y]-this.min[y];b=Math.min(b,k),E=Math.max(E,k)}if(E<0||b>this.max[y]-this.min[y])return 0}return 1}}class Bc{constructor(o=0,d=0,p=0,y=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=p,this.right=y}interpolate(o,d,p){return d.top!=null&&o.top!=null&&(this.top=l.B.number(o.top,d.top,p)),d.bottom!=null&&o.bottom!=null&&(this.bottom=l.B.number(o.bottom,d.bottom,p)),d.left!=null&&o.left!=null&&(this.left=l.B.number(o.left,d.left,p)),d.right!=null&&o.right!=null&&(this.right=l.B.number(o.right,d.right,p)),this}getCenter(o,d){const p=l.ad((this.left+o-this.right)/2,0,o),y=l.ad((this.top+d-this.bottom)/2,0,d);return new l.P(p,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Bc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class rh{constructor(o,d,p,y,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=b===void 0||!!b,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Bc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const o=new rh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.apply(this),o}apply(o){this.tileSize=o.tileSize,this.latRange=o.latRange,this.width=o.width,this.height=o.height,this._center=o._center,this._elevation=o._elevation,this._minEleveationForCurrentTile=o._minEleveationForCurrentTile,this.zoom=o.zoom,this.angle=o.angle,this._fov=o._fov,this._pitch=o._pitch,this._unmodified=o._unmodified,this._edgeInsets=o._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const d=-l.b5(o,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var p=new l.A(4);return l.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,y,b){var E=y[0],C=y[1],k=y[2],R=y[3],j=Math.sin(b),V=Math.cos(b);p[0]=E*V+k*j,p[1]=C*V+R*j,p[2]=E*-j+k*V,p[3]=C*-j+R*V}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=l.ad(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,p){this._unmodified=!1,this._edgeInsets.interpolate(o,d,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new l.b6(0,o)];if(this._renderWorldCopies){const p=this.pointCoordinate(new l.P(0,0)),y=this.pointCoordinate(new l.P(this.width,0)),b=this.pointCoordinate(new l.P(this.width,this.height)),E=this.pointCoordinate(new l.P(0,this.height)),C=Math.floor(Math.min(p.x,y.x,b.x,E.x)),k=Math.floor(Math.max(p.x,y.x,b.x,E.x)),R=1;for(let j=C-R;j<=k+R;j++)j!==0&&d.push(new l.b6(j,o))}return d}coveringTiles(o){var d,p;let y=this.coveringZoomLevel(o);const b=y;if(o.minzoom!==void 0&&y<o.minzoom)return[];o.maxzoom!==void 0&&y>o.maxzoom&&(y=o.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),C=l.U.fromLngLat(this.center),k=Math.pow(2,y),R=[k*E.x,k*E.y,0],j=[k*C.x,k*C.y,0],V=Hi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let X=o.minzoom||0;!o.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(X=y);const ce=o.terrain?2/Math.min(this.tileSize,o.tileSize)*this.tileSize:3,le=ge=>({aabb:new Ll([ge*k,0,0],[(ge+1)*k,k,0]),zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),fe=[],oe=[],Pe=y,Oe=o.reparseOverscaled?b:y;if(this._renderWorldCopies)for(let ge=1;ge<=3;ge++)fe.push(le(-ge)),fe.push(le(ge));for(fe.push(le(0));fe.length>0;){const ge=fe.pop(),Ie=ge.x,De=ge.y;let Be=ge.fullyVisible;if(!Be){const zt=ge.aabb.intersects(V);if(zt===0)continue;Be=zt===2}const Ke=o.terrain?R:j,rt=ge.aabb.distanceX(Ke),tt=ge.aabb.distanceY(Ke),ct=Math.max(Math.abs(rt),Math.abs(tt));if(ge.zoom===Pe||ct>ce+(1<<Pe-ge.zoom)-2&&ge.zoom>=X){const zt=Pe-ge.zoom,Cn=R[0]-.5-(Ie<<zt),mt=R[1]-.5-(De<<zt);oe.push({tileID:new l.O(ge.zoom===Pe?Oe:ge.zoom,ge.wrap,ge.zoom,Ie,De),distanceSq:ie([j[0]-.5-Ie,j[1]-.5-De]),tileDistanceToCamera:Math.sqrt(Cn*Cn+mt*mt)})}else for(let zt=0;zt<4;zt++){const Cn=(Ie<<1)+zt%2,mt=(De<<1)+(zt>>1),rn=ge.zoom+1;let Nt=ge.aabb.quadrant(zt);if(o.terrain){const Wn=new l.O(rn,ge.wrap,rn,Cn,mt),En=o.terrain.getMinMaxElevation(Wn),xn=(d=En.minElevation)!==null&&d!==void 0?d:this.elevation,An=(p=En.maxElevation)!==null&&p!==void 0?p:this.elevation;Nt=new Ll([Nt.min[0],Nt.min[1],xn],[Nt.max[0],Nt.max[1],An])}fe.push({aabb:Nt,zoom:rn,x:Cn,y:mt,wrap:ge.wrap,fullyVisible:Be})}}return oe.sort((ge,Ie)=>ge.distanceSq-Ie.distanceSq).map(ge=>ge.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=l.ad(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.P(l.G(o.lng)*this.worldSize,l.H(d)*this.worldSize)}unproject(o){return new l.U(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(o){const d=this.pointLocation(this.centerPoint,o),p=o.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-p))return;const y=this.getCameraPosition(),b=l.U.fromLngLat(y.lngLat,y.altitude),E=l.U.fromLngLat(d,p),C=b.x-E.x,k=b.y-E.y,R=b.z-E.z,j=Math.sqrt(C*C+k*k+R*R),V=this.scaleZoom(this.cameraToCenterDistance/j/this.tileSize);this._elevation=p,this._center=d,this.zoom=V}setLocationAtPoint(o,d){const p=this.pointCoordinate(d),y=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(o),E=new l.U(b.x-(p.x-y.x),b.y-(p.y-y.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o,d){return d?this.coordinatePoint(this.locationCoordinate(o),d.getElevationForLngLatZoom(o,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o,d){return this.coordinateLocation(this.pointCoordinate(o,d))}locationCoordinate(o){return l.U.fromLngLat(o)}coordinateLocation(o){return o&&o.toLngLat()}pointCoordinate(o,d){if(d){const X=d.pointCoordinate(o);if(X!=null)return X}const p=[o.x,o.y,0,1],y=[o.x,o.y,1,1];l.ag(p,p,this.pixelMatrixInverse),l.ag(y,y,this.pixelMatrixInverse);const b=p[3],E=y[3],C=p[1]/b,k=y[1]/E,R=p[2]/b,j=y[2]/E,V=R===j?0:(0-R)/(j-R);return new l.U(l.B.number(p[0]/b,y[0]/E,V)/this.worldSize,l.B.number(C,k,V)/this.worldSize)}coordinatePoint(o,d=0,p=this.pixelMatrix){const y=[o.x*this.worldSize,o.y*this.worldSize,d,1];return l.ag(y,y,p),new l.P(y[0]/y[3],y[1]/y[3])}getBounds(){const o=Math.max(0,this.height/2-this.getHorizon());return new ht().extend(this.pointLocation(new l.P(0,o))).extend(this.pointLocation(new l.P(this.width,o))).extend(this.pointLocation(new l.P(this.width,this.height))).extend(this.pointLocation(new l.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ht([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,d=!1){const p=o.key,y=d?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const b=o.canonical,E=this.worldSize/this.zoomScale(b.z),C=b.x+Math.pow(2,b.z)*o.wrap,k=l.ao(new Float64Array(16));return l.$(k,k,[C*E,b.y*E,0]),l.a0(k,k,[E/l.N,E/l.N,1]),l.a1(k,d?this.alignedProjMatrix:this.projMatrix,k),y[p]=new Float32Array(k),y[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,d,p,y,b=-90,E=90,C=-180,k=180;const R=this.size,j=this._unmodified;if(this.latRange){const ce=this.latRange;b=l.H(ce[1])*this.worldSize,E=l.H(ce[0])*this.worldSize,o=E-b<R.y?R.y/(E-b):0}if(this.lngRange){const ce=this.lngRange;C=l.b5(l.G(ce[0])*this.worldSize,0,this.worldSize),k=l.b5(l.G(ce[1])*this.worldSize,0,this.worldSize),k<C&&(k+=this.worldSize),d=k-C<R.x?R.x/(k-C):0}const V=this.point,X=Math.max(d||0,o||0);if(X)return this.center=this.unproject(new l.P(d?(k+C)/2:V.x,o?(E+b)/2:V.y)),this.zoom+=this.scaleZoom(X),this._unmodified=j,void(this._constraining=!1);if(this.latRange){const ce=V.y,le=R.y/2;ce-le<b&&(y=b+le),ce+le>E&&(y=E-le)}if(this.lngRange){const ce=(C+k)/2,le=l.b5(V.x,ce-this.worldSize/2,ce+this.worldSize/2),fe=R.x/2;le-fe<C&&(p=C+fe),le+fe>k&&(p=k-fe)}p===void 0&&y===void 0||(this.center=this.unproject(new l.P(p!==void 0?p:V.x,y!==void 0?y:V.y)).wrap()),this._unmodified=j,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.b7(1,this.center.lat)*this.worldSize;let y=l.ao(new Float64Array(16));l.a0(y,y,[this.width/2,-this.height/2,1]),l.$(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=l.ao(new Float64Array(16)),l.a0(y,y,[1,-1,1]),l.$(y,y,[-1,-1,0]),l.a0(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this._minEleveationForCurrentTile),C=b-E*this._pixelPerMeter/Math.cos(this._pitch),k=E<0?C:b,R=Math.PI/2+this._pitch,j=this._fov*(.5+o.y/this.height),V=Math.sin(j)*k/Math.sin(l.ad(Math.PI-R-j,.01,Math.PI-.01)),X=this.getHorizon(),ce=2*Math.atan(X/this.cameraToCenterDistance)*(.5+o.y/(2*X)),le=Math.sin(ce)*k/Math.sin(l.ad(Math.PI-R-ce,.01,Math.PI-.01)),fe=Math.min(V,le),oe=1.01*(Math.cos(Math.PI/2-this._pitch)*fe+k),Pe=this.height/50;y=new Float64Array(16),l.b8(y,this._fov,this.width/this.height,Pe,oe),y[8]=2*-o.x/this.width,y[9]=2*o.y/this.height,l.a0(y,y,[1,-1,1]),l.$(y,y,[0,0,-this.cameraToCenterDistance]),l.b9(y,y,this._pitch),l.ae(y,y,this.angle),l.$(y,y,[-d,-p,0]),this.mercatorMatrix=l.a0([],y,[this.worldSize,this.worldSize,this.worldSize]),l.a0(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.a1(new Float64Array(16),this.labelPlaneMatrix,y),l.$(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=l.as([],y),this.pixelMatrix3D=l.a1(new Float64Array(16),this.labelPlaneMatrix,y);const Oe=this.width%2/2,ge=this.height%2/2,Ie=Math.cos(this.angle),De=Math.sin(this.angle),Be=d-Math.round(d)+Ie*Oe+De*ge,Ke=p-Math.round(p)+Ie*ge+De*Oe,rt=new Float64Array(y);if(l.$(rt,rt,[Be>.5?Be-1:Be,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=rt,y=l.as(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new l.P(0,0)),d=[o.x*this.worldSize,o.y*this.worldSize,0,1];return l.ag(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(0,o))}getCameraQueryGeometry(o){const d=this.getCameraPoint();if(o.length===1)return[o[0],d];{let p=d.x,y=d.y,b=d.x,E=d.y;for(const C of o)p=Math.min(p,C.x),y=Math.min(y,C.y),b=Math.max(b,C.x),E=Math.max(E,C.y);return[new l.P(p,y),new l.P(b,y),new l.P(b,E),new l.P(p,E),new l.P(p,y)]}}}function Ga(v,o){let d,p=!1,y=null,b=null;const E=()=>{y=null,p&&(v.apply(b,d),y=setTimeout(E,o),p=!1)};return(...C)=>(p=!0,b=this,d=C,y||E(),y)}class jc{constructor(o){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Ga(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),E=Math.round(d.lng*b)/b,C=Math.round(d.lat*b)/b,k=this._map.getBearing(),R=this._map.getPitch();let j="";if(j+=o?`/${E}/${C}/${p}`:`${p}/${C}/${E}`,(k||R)&&(j+="/"+Math.round(10*k)/10),R&&(j+=`/${Math.round(R)}`),this._hashName){const V=this._hashName;let X=!1;const ce=window.location.hash.slice(1).split("&").map(le=>{const fe=le.split("=")[0];return fe===V?(X=!0,`${fe}=${j}`):le}).filter(le=>le);return X||ce.push(`${V}=${j}`),`#${ce.join("&")}`}return`#${j}`}}const Rl={linearity:.3,easing:l.ba(0,0,.3,1)},yg=l.e({deceleration:2500,maxSpeed:1400},Rl),_g=l.e({deceleration:20,maxSpeed:1400},Rl),vg=l.e({deceleration:1e3,maxSpeed:360},Rl),xg=l.e({deceleration:1e3,maxSpeed:90},Rl);class bg{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.h.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=l.h.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(d.pan.mag()){const b=Vc(d.pan.mag(),p,l.e({},yg,o||{}));y.offset=d.pan.mult(b.amount/d.pan.mag()),y.center=this._map.transform.center,go(y,b)}if(d.zoom){const b=Vc(d.zoom,p,_g);y.zoom=this._map.transform.zoom+b.amount,go(y,b)}if(d.bearing){const b=Vc(d.bearing,p,vg);y.bearing=this._map.transform.bearing+l.ad(b.amount,-179,179),go(y,b)}if(d.pitch){const b=Vc(d.pitch,p,xg);y.pitch=this._map.transform.pitch+b.amount,go(y,b)}if(y.zoom||y.bearing){const b=d.pinchAround===void 0?d.around:d.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),l.e(y,{noMoveStart:!0})}}function go(v,o){(!v.duration||v.duration<o.duration)&&(v.duration=o.duration,v.easing=o.easing)}function Vc(v,o,d){const{maxSpeed:p,linearity:y,deceleration:b}=d,E=l.ad(v*y/(o/1e3),-p,p),C=Math.abs(E)/(b*y);return{easing:d.easing,duration:1e3*C,amount:E*(C/2)}}class fs extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p,y={}){const b=_.mousePos(d.getCanvasContainer(),p),E=d.unproject(b);super(o,l.e({point:b,lngLat:E,originalEvent:p},y)),this._defaultPrevented=!1,this.target=d}}class Uc extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){const y=o==="touchend"?p.changedTouches:p.touches,b=_.touchPos(d.getCanvasContainer(),y),E=b.map(k=>d.unproject(k)),C=b.reduce((k,R,j,V)=>k.add(R.div(V.length)),new l.P(0,0));super(o,{points:b,point:C,lngLats:E,lngLat:d.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class wg extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,p){super(o,{originalEvent:p}),this._defaultPrevented=!1}}class Sg{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new wg(o.type,this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new fs(o.type,this._map,o))}mouseup(o){this._map.fire(new fs(o.type,this._map,o))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new fs(o.type,this._map,o))}dblclick(o){return this._firePreventable(new fs(o.type,this._map,o))}mouseover(o){this._map.fire(new fs(o.type,this._map,o))}mouseout(o){this._map.fire(new fs(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Uc(o.type,this._map,o))}touchmove(o){this._map.fire(new Uc(o.type,this._map,o))}touchend(o){this._map.fire(new Uc(o.type,this._map,o))}touchcancel(o){this._map.fire(new Uc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tg{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new fs(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new fs(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Go{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.pointLocation(l.P.convert(o),this._map.terrain)}}class Eg{constructor(o,d){this._map=o,this._tr=new Go(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(_.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=_.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const b=Math.min(y.x,p.x),E=Math.max(y.x,p.x),C=Math.min(y.y,p.y),k=Math.max(y.y,p.y);_.setTransform(this._box,`translate(${b}px,${C}px)`),this._box.style.width=E-b+"px",this._box.style.height=k-C+"px"}mouseupWindow(o,d){if(!this._active||o.button!==0)return;const p=this._startPos,y=d;if(this.reset(),_.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.k("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(p,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new l.k(o,{originalEvent:d}))}}function Is(v,o){if(v.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${o.length}`);const d={};for(let p=0;p<v.length;p++)d[v[p].identifier]=o[p];return d}class Wo{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const b=new l.P(0,0);for(const E of y)b._add(E);return b.div(y.length)}(d),this.touches=Is(p,d)))}touchmove(o,d,p){if(this.aborted||!this.centroid)return;const y=Is(p,d);for(const b in this.touches){const E=y[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(o,d,p){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class ih{constructor(o){this.singleTap=new Wo(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,d,p){this.singleTap.touchstart(o,d,p)}touchmove(o,d,p){this.singleTap.touchmove(o,d,p)}touchend(o,d,p){const y=this.singleTap.touchend(o,d,p);if(y){const b=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(b&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Ho{constructor(o){this._tr=new Go(o),this._zoomIn=new ih({numTouches:1,numTaps:2}),this._zoomOut=new ih({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,p){this._zoomIn.touchstart(o,d,p),this._zoomOut.touchstart(o,d,p)}touchmove(o,d,p){this._zoomIn.touchmove(o,d,p),this._zoomOut.touchmove(o,d,p)}touchend(o,d,p){const y=this._zoomIn.touchend(o,d,p),b=this._zoomOut.touchend(o,d,p),E=this._tr;return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(y)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qo{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const d=this._moveFunction(...o);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(o,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const y=d.length?d[0]:d;return!this._moved&&y.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(p,y))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&_.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const qv={0:1,2:2};class mf{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const d=_.mouseButton(o);this._eventButton=d}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(d,p){const y=qv[p];return d.buttons===void 0||(d.buttons&y)!==y}(o,this._eventButton)}isValidEndEvent(o){return _.mouseButton(o)===this._eventButton}}class Pg{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}const sh=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=function(o){o.preventDefault()}},Ol=({enable:v,clickTolerance:o,bearingDegreesPerPixelMoved:d=.8})=>{const p=new mf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new qo({clickTolerance:o,move:(y,b)=>({bearingDelta:(b.x-y.x)*d}),moveStateManager:p,enable:v,assignEvents:sh})},Zo=({enable:v,clickTolerance:o,pitchDegreesPerPixelMoved:d=-.5})=>{const p=new mf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new qo({clickTolerance:o,move:(y,b)=>({pitchDelta:(b.y-y.y)*d}),moveStateManager:p,enable:v,assignEvents:sh})};class kt{constructor(o,d){this._minTouches=o.cooperativeGestures?2:1,this._clickTolerance=o.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(o,d,p){return this._calculateTransform(o,d,p)}touchmove(o,d,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(o,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,d,p)}touchend(o,d,p){this._calculateTransform(o,d,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,p){p.length>0&&(this._active=!0);const y=Is(p,d),b=new l.P(0,0),E=new l.P(0,0);let C=0;for(const R in y){const j=y[R],V=this._touches[R];V&&(b._add(j),E._add(j.sub(V)),C++,y[R]=j)}if(this._touches=y,C<this._minTouches||!E.mag())return;const k=E.div(C);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oh{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,p){if(!this._firstTwoTouches)return;o.preventDefault();const[y,b]=this._firstTwoTouches,E=ma(p,d,y),C=ma(p,d,b);if(!E||!C)return;const k=this._aroundCenter?null:E.add(C).div(2);return this._move([E,C],k,o)}touchend(o,d,p){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,E=ma(p,d,y),C=ma(p,d,b);E&&C||(this._active&&_.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ma(v,o,d){for(let p=0;p<v.length;p++)if(v[p].identifier===d)return o[p]}function zl(v,o){return Math.log(v/o)/Math.LN2}class Cg extends oh{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const p=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(zl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:zl(this._distance,p),pinchAround:d}}}function bt(v,o){return 180*v.angleWith(o)/Math.PI}class gf extends oh{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const p=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bt(this._vector,p),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,p=bt(o,this._startVector);return Math.abs(p)<d}}function yf(v){return Math.abs(v.y)>Math.abs(v.x)}class Zv extends oh{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,d,p){super.touchstart(o,d,p),this._currentTouchCount=p.length}_start(o){this._lastPoints=o,yf(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=o[0].sub(this._lastPoints[0]),b=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,b,p.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(y.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(o,d,p){if(this._valid!==void 0)return this._valid;const y=o.mag()>=2,b=d.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=o.y>0==d.y>0;return yf(o)&&yf(d)&&E}}const _f={panStep:100,bearingStep:15,pitchStep:10};class Ag{constructor(o){this._tr=new Go(o);const d=_f;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,p=0,y=0,b=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?p=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?p=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:C=>{const k=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Ig,zoom:d?Math.round(k.zoom)+d*(o.shiftKey?2:1):k.zoom,bearing:k.bearing+p*this._bearingStep,pitch:k.pitch+y*this._pitchStep,offset:[-b*this._panStep,-E*this._panStep],center:k.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ig(v){return v*(2-v)}const kg=4.000244140625;class Xv{constructor(o,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=o,this._tr=new Go(o),this._el=o.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!o[this._map._metaKey])return;o.preventDefault()}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const p=l.h.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%kg==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=_.mousePos(this._el,o),p=this._tr;this._around=l.L.convert(this._aroundCenter?p.center:p.unproject(d)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>kg?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&k!==0&&(k=1/k);const R=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(R*k))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,p=this._startZoom,y=this._easing;let b,E=!1;if(this._type==="wheel"&&p&&y){const C=Math.min((l.h.now()-this._lastWheelEventTime)/200,1),k=y(C);b=l.B.number(p,d,k),C<1?this._frameId||(this._frameId=!0):E=!0}else b=d,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:b-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=l.bb;if(this._prevEase){const p=this._prevEase,y=(l.h.now()-p.start)/p.duration,b=p.easing(y+.01)-p.easing(y),E=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-E*E);d=l.ba(E,C,.25,1)}return this._prevEase={start:l.h.now(),duration:o,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class vf{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xf{constructor(o){this._tr=new Go(o),this.reset()}reset(){this._active=!1}dblclick(o,d){return o.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bf{constructor(){this._tap=new ih({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,d,p){if(!this._swipePoint)if(this._tapTime){const y=d[0],b=o.timeStamp-this._tapTime<500,E=this._tapPoint.dist(y)<30;b&&E?p.length>0&&(this._swipePoint=y,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(o,d,p)}touchmove(o,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=d[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,d,p)}touchend(o,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const y=this._tap.touchend(o,d,p);y&&(this._tapTime=o.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wf{constructor(o,d,p){this._el=o,this._mousePan=d,this._touchPan=p}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(o,d,p){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ga{constructor(o,d,p,y){this._el=o,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const $c=v=>v.zoom||v.drag||v.pitch||v.rotate;class Sf extends l.k{}function Gc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Tf{constructor(o,d){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,b)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=y.type==="renderFrame"?void 0:y,C={needsRenderFrame:!1},k={},R={},j=y.touches,V=j?this._getMapTouches(j):void 0,X=V?_.touchPos(this._el,V):_.mousePos(this._el,y);for(const{handlerName:fe,handler:oe,allowed:Pe}of this._handlers){if(!oe.isEnabled())continue;let Oe;this._blockedByActive(R,Pe,fe)?oe.reset():oe[b||y.type]&&(Oe=oe[b||y.type](y,X,V),this.mergeHandlerResult(C,k,Oe,fe,E),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||oe.isActive())&&(R[fe]=oe)}const ce={};for(const fe in this._previousActiveHandlers)R[fe]||(ce[fe]=E);this._previousActiveHandlers=R,(Object.keys(ce).length||Gc(C))&&(this._changes.push([C,k,ce]),this._triggerRenderFrame()),(Object.keys(R).length||Gc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:le}=C;le&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],le(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bg(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,b,E]of this._listeners)_.addEventListener(y,b,y===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[o,d,p]of this._listeners)_.removeEventListener(o,d,o===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(o){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new Sg(d,o));const y=d.boxZoom=new Eg(d,o);this._add("boxZoom",y),o.interactive&&o.boxZoom&&y.enable();const b=new Ho(d),E=new xf(d);d.doubleClickZoom=new vf(E,b),this._add("tapZoom",b),this._add("clickZoom",E),o.interactive&&o.doubleClickZoom&&d.doubleClickZoom.enable();const C=new bf;this._add("tapDragZoom",C);const k=d.touchPitch=new Zv(d);this._add("touchPitch",k),o.interactive&&o.touchPitch&&d.touchPitch.enable(o.touchPitch);const R=Ol(o),j=Zo(o);d.dragRotate=new qi(o,R,j),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]),o.interactive&&o.dragRotate&&d.dragRotate.enable();const V=(({enable:Pe,clickTolerance:Oe})=>{const ge=new mf({checkCorrectEvent:Ie=>_.mouseButton(Ie)===0&&!Ie.ctrlKey});return new qo({clickTolerance:Oe,move:(Ie,De)=>({around:De,panDelta:De.sub(Ie)}),activateOnStart:!0,moveStateManager:ge,enable:Pe,assignEvents:sh})})(o),X=new kt(o,d);d.dragPan=new wf(p,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&d.dragPan.enable(o.dragPan);const ce=new gf,le=new Cg;d.touchZoomRotate=new ga(p,le,ce,C),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&d.touchZoomRotate.enable(o.touchZoomRotate);const fe=d.scrollZoom=new Xv(d,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),o.interactive&&o.scrollZoom&&d.scrollZoom.enable(o.scrollZoom);const oe=d.keyboard=new Ag(d);this._add("keyboard",oe),o.interactive&&o.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new Tg(d))}_add(o,d,p){this._handlers.push({handlerName:o,handler:d,allowed:p}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!$c(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,d,p){for(const y in o)if(y!==p&&(!d||d.indexOf(y)<0))return!0;return!1}_getMapTouches(o){const d=[];for(const p of o)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(o,d,p,y,b){if(!p)return;l.e(o,p);const E={handlerName:y,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(d.zoom=E),p.panDelta!==void 0&&(d.drag=E),p.pitchDelta!==void 0&&(d.pitch=E),p.bearingDelta!==void 0&&(d.rotate=E)}_applyChanges(){const o={},d={},p={};for(const[y,b,E]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new l.P(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),l.e(d,b),l.e(p,E);this._updateMapTransform(o,d,p),this._changes=[]}_updateMapTransform(o,d,p){const y=this._map,b=y._getTransformForUpdate(),E=y.terrain;if(!(Gc(o)||E&&this._terrainMovement))return this._fireEvents(d,p,!0);let{panDelta:C,zoomDelta:k,bearingDelta:R,pitchDelta:j,around:V,pinchAround:X}=o;X!==void 0&&(V=X),y._stop(!0),V=V||y.transform.centerPoint;const ce=b.pointLocation(C?V.sub(C):V);R&&(b.bearing+=R),j&&(b.pitch+=j),k&&(b.zoom+=k),E?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(C)):b.setLocationAtPoint(ce,V):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(ce,V),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(y.terrain)})):b.setLocationAtPoint(ce,V),y._applyUpdatedTransform(b),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,p,!0)}_fireEvents(o,d,p){const y=$c(this._eventsInProgress),b=$c(o),E={};for(const j in o){const{originalEvent:V}=o[j];this._eventsInProgress[j]||(E[`${j}start`]=V),this._eventsInProgress[j]=o[j]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const j in E)this._fireEvent(j,E[j]);b&&this._fireEvent("move",b.originalEvent);for(const j in o){const{originalEvent:V}=o[j];this._fireEvent(j,V)}const C={};let k;for(const j in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[j];this._handlersById[V].isActive()||(delete this._eventsInProgress[j],k=d[V]||X,C[`${j}end`]=k)}for(const j in C)this._fireEvent(j,C[j]);const R=$c(this._eventsInProgress);if(p&&(y||b)&&!R){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!j||!j.essential&&l.h.prefersReducedMotion?(this._map.fire(new l.k("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()):(V(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new l.k(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Sf("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Mg extends l.E{constructor(o,d){super(),this._renderFrameCallback=()=>{const p=Math.min((l.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.L(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,p){return o=l.P.convert(o).mult(-1),this.panTo(this.transform.center,l.e({offset:o},d),p)}panTo(o,d,p){return this.easeTo(l.e({center:o},d),p)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,p){return this.easeTo(l.e({zoom:o},d),p)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,p){return this.easeTo(l.e({bearing:o},d),p)}resetNorth(o,d){return this.rotateTo(0,l.e({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(l.e({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=ht.convert(o);const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),p,d)}_cameraForBoxAndBearing(o,d,p,y){const b={top:0,bottom:0,right:0,left:0};if(typeof(y=l.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const De=y.padding;y.padding={top:De,bottom:De,right:De,left:De}}y.padding=l.e(b,y.padding);const E=this.transform,C=E.padding,k=E.project(l.L.convert(o)),R=E.project(l.L.convert(d)),j=k.rotate(-p*Math.PI/180),V=R.rotate(-p*Math.PI/180),X=new l.P(Math.max(j.x,V.x),Math.max(j.y,V.y)),ce=new l.P(Math.min(j.x,V.x),Math.min(j.y,V.y)),le=X.sub(ce),fe=(E.width-(C.left+C.right+y.padding.left+y.padding.right))/le.x,oe=(E.height-(C.top+C.bottom+y.padding.top+y.padding.bottom))/le.y;if(oe<0||fe<0)return void l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Pe=Math.min(E.scaleZoom(E.scale*Math.min(fe,oe)),y.maxZoom),Oe=l.P.convert(y.offset),ge=new l.P((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(p*Math.PI/180),Ie=Oe.add(ge).mult(E.scale/E.zoomScale(Pe));return{center:E.unproject(k.add(R).div(2).sub(Ie)),zoom:Pe,bearing:p}}fitBounds(o,d,p){return this._fitInternal(this.cameraForBounds(o,d),d,p)}fitScreenCoordinates(o,d,p,y,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.P.convert(o)),this.transform.pointLocation(l.P.convert(d)),p,y),y,b)}_fitInternal(o,d,p){return o?(delete(d=l.e(o,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(o,d){this.stop();const p=this._getTransformForUpdate();let y=!1,b=!1,E=!1;return"zoom"in o&&p.zoom!==+o.zoom&&(y=!0,p.zoom=+o.zoom),o.center!==void 0&&(p.center=l.L.convert(o.center)),"bearing"in o&&p.bearing!==+o.bearing&&(b=!0,p.bearing=+o.bearing),"pitch"in o&&p.pitch!==+o.pitch&&(E=!0,p.pitch=+o.pitch),o.padding==null||p.isPaddingEqual(o.padding)||(p.padding=o.padding),this._applyUpdatedTransform(p),this.fire(new l.k("movestart",d)).fire(new l.k("move",d)),y&&this.fire(new l.k("zoomstart",d)).fire(new l.k("zoom",d)).fire(new l.k("zoomend",d)),b&&this.fire(new l.k("rotatestart",d)).fire(new l.k("rotate",d)).fire(new l.k("rotateend",d)),E&&this.fire(new l.k("pitchstart",d)).fire(new l.k("pitch",d)).fire(new l.k("pitchend",d)),this.fire(new l.k("moveend",d))}calculateCameraOptionsFromTo(o,d,p,y=0){const b=l.U.fromLngLat(o,d),E=l.U.fromLngLat(p,y),C=E.x-b.x,k=E.y-b.y,R=E.z-b.z,j=Math.hypot(C,k,R);if(j===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(C,k),X=this.transform.scaleZoom(this.transform.cameraToCenterDistance/j/this.transform.tileSize),ce=180*Math.atan2(C,-k)/Math.PI;let le=180*Math.acos(V/j)/Math.PI;return le=R<0?90-le:90+le,{center:E.toLngLat(),zoom:X,pitch:le,bearing:ce}}easeTo(o,d){this._stop(!1,o.easeId),((o=l.e({offset:[0,0],duration:500,easing:l.bb},o)).animate===!1||!o.essential&&l.h.prefersReducedMotion)&&(o.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),C=this.getPadding(),k="zoom"in o?+o.zoom:y,R="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,X=l.P.convert(o.offset);let ce=p.centerPoint.add(X);const le=p.pointLocation(ce),fe=l.L.convert(o.center||le);this._normalizeCenter(fe);const oe=p.project(le),Pe=p.project(fe).sub(oe),Oe=p.zoomScale(k-y);let ge,Ie;o.around&&(ge=l.L.convert(o.around),Ie=p.locationPoint(ge));const De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==y,this._rotating=this._rotating||b!==R,this._pitching=this._pitching||j!==E,this._padding=!p.isPaddingEqual(V),this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,De),this.terrain&&this._prepareElevation(fe),this._ease(Be=>{if(this._zooming&&(p.zoom=l.B.number(y,k,Be)),this._rotating&&(p.bearing=l.B.number(b,R,Be)),this._pitching&&(p.pitch=l.B.number(E,j,Be)),this._padding&&(p.interpolatePadding(C,V,Be),ce=p.centerPoint.add(X)),this.terrain&&!o.freezeElevation&&this._updateElevation(Be),ge)p.setLocationAtPoint(ge,Ie);else{const Ke=p.zoomScale(p.zoom-y),rt=k>y?Math.min(2,Oe):Math.max(.5,Oe),tt=Math.pow(rt,1-Be),ct=p.unproject(oe.add(Pe.mult(Be*tt)).mult(Ke));p.setLocationAtPoint(p.renderWorldCopies?ct.wrap():ct,ce)}this._applyUpdatedTransform(p),this._fireMoveEvents(d)},Be=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Be)},o),this}_prepareEase(o,d,p={}){this._moving=!0,d||p.moving||this.fire(new l.k("movestart",o)),this._zooming&&!p.zooming&&this.fire(new l.k("zoomstart",o)),this._rotating&&!p.rotating&&this.fire(new l.k("rotatestart",o)),this._pitching&&!p.pitching&&this.fire(new l.k("pitchstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(p-(d-(p*o+this._elevationStart))/(1-o)),this._elevationTarget=d}this.transform.elevation=l.B.number(this._elevationStart,this._elevationTarget,o)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(o){if(!this.transformCameraUpdate)return;const d=o.clone(),{center:p,zoom:y,pitch:b,bearing:E,elevation:C}=this.transformCameraUpdate(d);p&&(d.center=p),y!==void 0&&(d.zoom=y),b!==void 0&&(d.pitch=b),E!==void 0&&(d.bearing=E),C!==void 0&&(d.elevation=C),this.transform.apply(d)}_fireMoveEvents(o){this.fire(new l.k("move",o)),this._zooming&&this.fire(new l.k("zoom",o)),this._rotating&&this.fire(new l.k("rotate",o)),this._pitching&&this.fire(new l.k("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.k("zoomend",o)),y&&this.fire(new l.k("rotateend",o)),b&&this.fire(new l.k("pitchend",o)),this.fire(new l.k("moveend",o))}flyTo(o,d){if(!o.essential&&l.h.prefersReducedMotion){const Nt=l.F(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Nt,d)}this.stop(),o=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.bb},o);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),E=this.getPitch(),C=this.getPadding(),k="zoom"in o?l.ad(+o.zoom,p.minZoom,p.maxZoom):y,R="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:E,V="padding"in o?o.padding:p.padding,X=p.zoomScale(k-y),ce=l.P.convert(o.offset);let le=p.centerPoint.add(ce);const fe=p.pointLocation(le),oe=l.L.convert(o.center||fe);this._normalizeCenter(oe);const Pe=p.project(fe),Oe=p.project(oe).sub(Pe);let ge=o.curve;const Ie=Math.max(p.width,p.height),De=Ie/X,Be=Oe.mag();if("minZoom"in o){const Nt=l.ad(Math.min(o.minZoom,y,k),p.minZoom,p.maxZoom),Wn=Ie/p.zoomScale(Nt-y);ge=Math.sqrt(Wn/Be*2)}const Ke=ge*ge;function rt(Nt){const Wn=(De*De-Ie*Ie+(Nt?-1:1)*Ke*Ke*Be*Be)/(2*(Nt?De:Ie)*Ke*Be);return Math.log(Math.sqrt(Wn*Wn+1)-Wn)}function tt(Nt){return(Math.exp(Nt)-Math.exp(-Nt))/2}function ct(Nt){return(Math.exp(Nt)+Math.exp(-Nt))/2}const zt=rt(!1);let Cn=function(Nt){return ct(zt)/ct(zt+ge*Nt)},mt=function(Nt){return Ie*((ct(zt)*(tt(Wn=zt+ge*Nt)/ct(Wn))-tt(zt))/Ke)/Be;var Wn},rn=(rt(!0)-zt)/ge;if(Math.abs(Be)<1e-6||!isFinite(rn)){if(Math.abs(Ie-De)<1e-6)return this.easeTo(o,d);const Nt=De<Ie?-1:1;rn=Math.abs(Math.log(De/Ie))/ge,mt=function(){return 0},Cn=function(Wn){return Math.exp(Nt*ge*Wn)}}return o.duration="duration"in o?+o.duration:1e3*rn/("screenSpeed"in o?+o.screenSpeed/ge:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=b!==R,this._pitching=j!==E,this._padding=!p.isPaddingEqual(V),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(oe),this._ease(Nt=>{const Wn=Nt*rn,En=1/Cn(Wn);p.zoom=Nt===1?k:y+p.scaleZoom(En),this._rotating&&(p.bearing=l.B.number(b,R,Nt)),this._pitching&&(p.pitch=l.B.number(E,j,Nt)),this._padding&&(p.interpolatePadding(C,V,Nt),le=p.centerPoint.add(ce)),this.terrain&&!o.freezeElevation&&this._updateElevation(Nt);const xn=Nt===1?oe:p.unproject(Pe.add(Oe.mult(mt(Wn))).mult(En));p.setLocationAtPoint(p.renderWorldCopies?xn.wrap():xn,le),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,d)}if(!o){const p=this.handlers;p&&p.stop(!1)}return this}_ease(o,d,p){p.animate===!1||p.duration===0?(o(1),d()):(this._easeStart=l.h.now(),this._easeOptions=p,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,d){o=l.b5(o,-180,180);const p=Math.abs(o-d);return Math.abs(o-360-d)<p&&(o-=360),Math.abs(o+360-d)<p&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const p=o.lng-d.center.lng;o.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(l.L.convert(o),this.transform.tileZoom)-this.transform.elevation:null}}class ps{constructor(o={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,d){const p=this._map._getUIString(`AttributionControl.${d}`);o.title=p,o.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const d=this._map.style.sourceCaches;for(const y in d){const b=d[y];if(b.used||b.usedForTerrain){const E=b.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o=o.filter(y=>String(y).trim()),o.sort((y,b)=>y.length-b.length),o=o.filter((y,b)=>{for(let E=b+1;E<o.length;E++)if(o[E].indexOf(y)>=0)return!1;return!0});const p=o.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,o.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(o={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=_.create("div","maplibregl-ctrl");const d=_.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ah{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const y of p)if(y.id===o)return void(y.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Ef={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Lg=l.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Rg extends l.E{constructor(o){super(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,o.usedForTerrain=!0,o.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,d){this.sourceCache.update(o,d),this._renderableTilesKeys=[];const p={};for(const y of o.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))p[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),l.aS(y.posMatrix,0,l.N,0,l.N,0,1),this._tiles[y.key]=new ut(y,this.tileSize));for(const y in this._tiles)p[y]||delete this._tiles[y]}freeRtt(o){for(const d in this._tiles){const p=this._tiles[d];(!o||p.tileID.equals(o)||p.tileID.isChildOf(o)||o.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o){const d={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16),l.aS(b.posMatrix,0,l.N,0,l.N,0,1),d[p]=b}else if(y.canonical.isChildOf(o.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=y.canonical.z-o.canonical.z,C=y.canonical.x-(y.canonical.x>>E<<E),k=y.canonical.y-(y.canonical.y>>E<<E),R=l.N>>E;l.aS(b.posMatrix,0,R,0,R,0,1),l.$(b.posMatrix,b.posMatrix,[-C*R,-k*R,0]),d[p]=b}else if(o.canonical.isChildOf(y.canonical)){const b=o.clone();b.posMatrix=new Float64Array(16);const E=o.canonical.z-y.canonical.z,C=o.canonical.x-(o.canonical.x>>E<<E),k=o.canonical.y-(o.canonical.y>>E<<E),R=l.N>>E;l.aS(b.posMatrix,0,l.N,0,l.N,0,1),l.$(b.posMatrix,b.posMatrix,[C*R,k*R,0]),l.a0(b.posMatrix,b.posMatrix,[1/2**E,1/2**E,0]),d[p]=b}}return d}getSourceTile(o,d){const p=this.sourceCache._source;let y=o.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(y).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!b||!b.dem)&&d)for(;y>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(o.scaledTo(y--).key);return b}tilesAfterTime(o=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=o)}}class Og{constructor(o,d,p){this.painter=o,this.sourceCache=new Rg(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,d,p,y=l.N){var b;if(!(d>=0&&d<y&&p>=0&&p<y))return 0;const E=this.getTerrainData(o),C=(b=E.tile)===null||b===void 0?void 0:b.dem;if(!C)return 0;const k=function(le,fe,oe){var Pe=fe[0],Oe=fe[1];return le[0]=oe[0]*Pe+oe[4]*Oe+oe[12],le[1]=oe[1]*Pe+oe[5]*Oe+oe[13],le}([],[d/y*l.N,p/y*l.N],E.u_terrain_matrix),R=[k[0]*C.dim,k[1]*C.dim],j=Math.floor(R[0]),V=Math.floor(R[1]),X=R[0]-j,ce=R[1]-V;return C.get(j,V)*(1-X)*(1-ce)+C.get(j+1,V)*X*(1-ce)+C.get(j,V+1)*(1-X)*ce+C.get(j+1,V+1)*X*ce}getElevationForLngLatZoom(o,d){const{tileID:p,mercatorX:y,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(o,d);return this.getElevation(p,y%l.N,b%l.N,l.N)}getElevation(o,d,p,y=l.N){return this.getDEMElevation(o,d,p,y)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const y=this.painter.context,b=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _e(y,b,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _e(y,new l.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ao([])}const d=this.sourceCache.getSourceTile(o,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const y=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new _e(y,d.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),d.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+o.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let b=o.canonical.z-d.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=y?b=o.canonical.z-y:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=o.canonical.x-(o.canonical.x>>b<<b),C=o.canonical.y-(o.canonical.y>>b<<b),k=l.bc(new Float64Array(16),[1/(l.N<<b),1/(l.N<<b),0]);l.$(k,k,[E*l.N,C*l.N,0]),this._demMatrixCache[o.key]={matrix:k,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(o){const d=this.painter,p=d.width/devicePixelRatio,y=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _e(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _e(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,y,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,E=0;b<this._coordsTextureSize;b++)for(let C=0;C<this._coordsTextureSize;C++,E+=4)d[E+0]=255&C,d[E+1]=255&b,d[E+2]=C>>8<<4|b>>8,d[E+3]=0;const p=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),y=new _e(o,p,o.gl.RGBA,{premultiply:!1});return y.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(o){const d=new Uint8Array(4),p=this.painter.context,y=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const b=d[0]+(d[2]>>4<<8),E=d[1]+((15&d[2])<<8),C=this.coordsIndex[255-d[3]],k=C&&this.sourceCache.getTileByID(C);if(!k)return null;const R=this._coordsTextureSize,j=(1<<k.tileID.canonical.z)*R;return new l.U(this._allowMercatorOverflow(o,(k.tileID.canonical.x*R+b)/j),(k.tileID.canonical.y*R+E)/j,this.getElevation(k.tileID,b,E,R))}getTerrainMesh(){if(this._mesh)return this._mesh;const o=this.painter.context,d=new l.bd,p=new l.b0,y=this.meshSize,b=l.N/y,E=y*y;for(let V=0;V<=y;V++)for(let X=0;X<=y;X++)d.emplaceBack(X*b,V*b,0);for(let V=0;V<E;V+=y+1)for(let X=0;X<y;X++)p.emplaceBack(X+V,y+X+V+1,y+X+V+2),p.emplaceBack(X+V,y+X+V+2,X+V+1);const C=d.length,k=C+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ce of[0,1])d.emplaceBack(X*b,V*l.N,ce);for(let V=0;V<2*y;V+=2)p.emplaceBack(k+V,k+V+1,k+V+3),p.emplaceBack(k+V,k+V+3,k+V+2),p.emplaceBack(C+V,C+V+3,C+V+1),p.emplaceBack(C+V,C+V+2,C+V+3);const R=d.length,j=R+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const ce of[0,1])d.emplaceBack(V*l.N,X*b,ce);for(let V=0;V<2*y;V+=2)p.emplaceBack(R+V,R+V+1,R+V+3),p.emplaceBack(R+V,R+V+3,R+V+2),p.emplaceBack(j+V,j+V+3,j+V+1),p.emplaceBack(j+V,j+V+2,j+V+3);return this._mesh={indexBuffer:o.createIndexBuffer(p),vertexBuffer:o.createVertexBuffer(d,Lg.members),segments:l.S.simpleSegment(0,0,d.length,p.length)},this._mesh}getMeshFrameDelta(o){return 2*Math.PI*l.be/Math.pow(2,o)/5}getMinTileElevationForLngLatZoom(o,d){var p;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(o,d);return(p=this.getMinMaxElevation(y).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(o){const d=this.getTerrainData(o).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(o,d){const p=l.U.fromLngLat(o.wrap()),y=(1<<d)*l.N,b=p.x*y,E=p.y*y,C=Math.floor(b/l.N),k=Math.floor(E/l.N);return{tileID:new l.O(d,0,d,C,k),mercatorX:b,mercatorY:E}}_allowMercatorOverflow(o,d){const p=o.x<this.painter.width/2;let y=l.bf(d);const b=this.painter.transform.center.lng;return p&&Math.sign(y)>0&&Math.sign(b)<0||!p&&Math.sign(y)<0&&Math.sign(b)>0?(y=360*Math.sign(b)+y,l.G(y)):d}}class Yv{constructor(o,d,p){this._context=o,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new _e(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:o,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>o.id!==d),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const Mi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class lh{constructor(o,d){this.painter=o,this.terrain=d,this.pool=new Yv(o.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(p=>!o._layers[p].isHidden(d)),this._coordsDescendingInv={};for(const p in o.sourceCaches){this._coordsDescendingInv[p]={};const y=o.sourceCaches[p].getVisibleCoordinates();for(const b of y){const E=this.terrain.sourceCache.getTerrainCoords(b);for(const C in E)this._coordsDescendingInv[p][C]||(this._coordsDescendingInv[p][C]=[]),this._coordsDescendingInv[p][C].push(E[C])}}this._coordsDescendingInvStr={};for(const p of o._order){const y=o._layers[p],b=y.source;if(Mi[y.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const E in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][E]=this._coordsDescendingInv[b][E].map(C=>C.key).sort().join()}}for(const p of this._renderableTiles)for(const y in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[y][p.tileID.key];b&&b!==p.rttCoords[y]&&(p.rtt=[])}}renderLayer(o){if(o.isHidden(this.painter.transform.zoom))return!1;const d=o.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Mi[d]&&(this._prevType&&Mi[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(o.id),!y))return!0;if(Mi[this._prevType]||Mi[d]&&y){this._prevType=d;const b=this._stacks.length-1,E=this._stacks[b]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(xr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[b]){const R=this.pool.getObjectForId(C.rtt[b].id);if(R.stamp===C.rtt[b].stamp){this.pool.useObject(R);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),C.rtt[b]={id:k.id,stamp:k.stamp},p.context.bindFramebuffer.set(k.fbo.framebuffer),p.context.clear({color:l.aT.transparent,stencil:0}),p.currentStencilSource=void 0;for(let R=0;R<E.length;R++){const j=p.style._layers[E[R]],V=j.source?this._coordsDescendingInv[j.source][C.tileID.key]:[C.tileID];p.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),p._renderTileClippingMasks(j,V),p.renderLayer(p,p.style.sourceCaches[j.source],j,V),j.source&&(C.rttCoords[j.source]=this._coordsDescendingInvStr[j.source][C.tileID.key])}}return xr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Mi[d]}return!1}}const Gt=m,nn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Wc=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},Pf={showCompass:!0,showZoom:!0,visualizePitch:!1};class Cf{constructor(o,d,p=!1){this.mousedown=E=>{this.startMouse(l.e({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),_.mousePos(this.element,E)),_.addEventListener(window,"mousemove",this.mousemove),_.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,_.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),_.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=_.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const y=o.dragRotate._mouseRotate.getClickTolerance(),b=o.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Ol({clickTolerance:y,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:C,bearingDegreesPerPixelMoved:k=.8})=>{const R=new Pg;return new qo({clickTolerance:C,move:(j,V)=>({bearingDelta:(V.x-j.x)*k}),moveStateManager:R,enable:E,assignEvents:Wc})})({clickTolerance:y,enable:!0}),this.map=o,p&&(this.mousePitch=Zo({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:C,pitchDegreesPerPixelMoved:k=-.5})=>{const R=new Pg;return new qo({clickTolerance:C,move:(j,V)=>({pitchDelta:(V.y-j.y)*k}),moveStateManager:R,enable:E,assignEvents:Wc})})({clickTolerance:b,enable:!0})),_.addEventListener(d,"mousedown",this.mousedown),_.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(d,"touchcancel",this.reset)}startMouse(o,d){this.mouseRotate.dragStart(o,d),this.mousePitch&&this.mousePitch.dragStart(o,d),_.disableDrag()}startTouch(o,d){this.touchRotate.dragStart(o,d),this.touchPitch&&this.touchPitch.dragStart(o,d),_.disableDrag()}moveMouse(o,d){const p=this.map,{bearingDelta:y}=this.mouseRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const{pitchDelta:b}=this.mousePitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(o,d){const p=this.map,{bearingDelta:y}=this.touchRotate.dragMove(o,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.touchPitch){const{pitchDelta:b}=this.touchPitch.dragMove(o,d)||{};b&&p.setPitch(p.getPitch()+b)}}off(){const o=this.element;_.removeEventListener(o,"mousedown",this.mousedown),_.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend),_.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){_.enableDrag(),_.removeEventListener(window,"mousemove",this.mousemove),_.removeEventListener(window,"mouseup",this.mouseup),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend)}}let Rr;function Af(v,o,d){if(v=new l.L(v.lng,v.lat),o){const p=new l.L(v.lng-360,v.lat),y=new l.L(v.lng+360,v.lat),b=d.locationPoint(v).distSqr(o);d.locationPoint(p).distSqr(o)<b?v=p:d.locationPoint(y).distSqr(o)<b&&(v=y)}for(;Math.abs(v.lng-d.center.lng)>180;){const p=d.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=d.width&&p.y<=d.height)break;v.lng>d.center.lng?v.lng-=360:v.lng+=360}return v}const ks={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zg(v,o,d){const p=v.classList;for(const y in ks)p.remove(`maplibregl-${d}-anchor-${y}`);p.add(`maplibregl-${d}-anchor-${o}`)}class Wa extends l.E{constructor(o){if(super(),this._onKeyPress=d=>{const p=d.code,y=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!p)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Af(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),_.setTransform(this._element,`${ks[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${y}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const E=this._map.unproject(this._pos),C=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=E.distanceTo(this._lngLat)>20*C?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.k("dragstart"))),this.fire(new l.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=l.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div"),this._element.setAttribute("aria-label","Map marker");const d=_.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${y}px`),d.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const b=_.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const E=_.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const C=_.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of k){const Oe=_.createNS("http://www.w3.org/2000/svg","ellipse");Oe.setAttributeNS(null,"opacity","0.04"),Oe.setAttributeNS(null,"cx","10.5"),Oe.setAttributeNS(null,"cy","5.80029008"),Oe.setAttributeNS(null,"rx",Pe.rx),Oe.setAttributeNS(null,"ry",Pe.ry),C.appendChild(Oe)}const R=_.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill",this._color);const j=_.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),R.appendChild(j);const V=_.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const X=_.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(X);const ce=_.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const le=_.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(8.0, 8.0)");const fe=_.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#000000"),fe.setAttributeNS(null,"opacity","0.25"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962");const oe=_.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#FFFFFF"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962"),le.appendChild(fe),le.appendChild(oe),E.appendChild(C),E.appendChild(R),E.appendChild(V),E.appendChild(ce),E.appendChild(le),d.appendChild(E),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(d),this._offset=l.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),zg(this._element,this._anchor,"marker"),o&&o.className)for(const d of o.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=l.L.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const y=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(o){return this._offset=l.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const br={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let yr=0,Dl=!1;const Hc={maxWidth:100,unit:"metric"};function qc(v,o,d){const p=d&&d.maxWidth||100,y=v._container.clientHeight/2,b=v.unproject([0,y]),E=v.unproject([p,y]),C=b.distanceTo(E);if(d&&d.unit==="imperial"){const k=3.2808*C;k>5280?Ha(o,p,k/5280,v._getUIString("ScaleControl.Miles")):Ha(o,p,k,v._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Ha(o,p,C/1852,v._getUIString("ScaleControl.NauticalMiles")):C>=1e3?Ha(o,p,C/1e3,v._getUIString("ScaleControl.Kilometers")):Ha(o,p,C,v._getUIString("ScaleControl.Meters"))}function Ha(v,o,d,p){const y=function(b){const E=Math.pow(10,`${Math.floor(b)}`.length-1);let C=b/E;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(k){const R=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*R)/R}(C),E*C}(d);v.style.width=o*(y/d)+"px",v.innerHTML=`${y}&nbsp;${p}`}const If={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},kf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fl(v){if(v){if(typeof v=="number"){const o=Math.round(Math.abs(v)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,v),"top-left":new l.P(o,o),"top-right":new l.P(-o,o),bottom:new l.P(0,-v),"bottom-left":new l.P(o,-o),"bottom-right":new l.P(-o,-o),left:new l.P(v,0),right:new l.P(-v,0)}}if(v instanceof l.P||Array.isArray(v)){const o=l.P.convert(v);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:l.P.convert(v.center||[0,0]),top:l.P.convert(v.top||[0,0]),"top-left":l.P.convert(v["top-left"]||[0,0]),"top-right":l.P.convert(v["top-right"]||[0,0]),bottom:l.P.convert(v.bottom||[0,0]),"bottom-left":l.P.convert(v["bottom-left"]||[0,0]),"bottom-right":l.P.convert(v["bottom-right"]||[0,0]),left:l.P.convert(v.left||[0,0]),right:l.P.convert(v.right||[0,0])}}return Fl(new l.P(0,0))}const Mf={extend:(v,...o)=>l.e(v,...o),run(v){v()},logToElement(v,o=!1,d="log"){const p=window.document.getElementById(d);p&&(o&&(p.innerHTML=""),p.innerHTML+=`<br>${v}`)}},Lf=m;class Vn{static get version(){return Lf}static get workerCount(){return Mn.workerCount}static set workerCount(o){Mn.workerCount=o}static get maxParallelImageRequests(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(o){l.c.MAX_PARALLEL_IMAGE_REQUESTS=o}static get workerUrl(){return l.c.WORKER_URL}static set workerUrl(o){l.c.WORKER_URL=o}static addProtocol(o,d){l.c.REGISTERED_PROTOCOLS[o]=d}static removeProtocol(o){delete l.c.REGISTERED_PROTOCOLS[o]}}return Vn.Map=class extends Mg{constructor(v){if(l.bg.mark(l.bh.create),(v=l.e({},nn,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new rh(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),{bearingSnap:v.bearingSnap}),this._cooperativeGesturesOnWheel=o=>{this._onCooperativeGesture(o,o[this._metaKey],1)},this._contextLost=o=>{o.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._cooperativeGestures=v.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new ah,this._controls=[],this._mapId=l.a2(),this._locale=l.e({},Ef,v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new N(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const d=Ga(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{o?d(p):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Tf(this,v),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=v.hash&&new jc(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,l.e({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new ps({customAttribution:v.customAttribution})),v.maplibreLogo&&this.addControl(new sr,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new l.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new l.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new l.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(v,o){if(o===void 0&&(o=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new l.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[o];return o.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new l.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(v);return o>-1&&this._controls.splice(o,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,o,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,o,d,p)}resize(v){var o;const d=this._containerDimensions(),p=d[0],y=d[1],b=this._getClampedPixelRatio(p,y);if(this._resizeCanvas(p,y,b),this.painter.resize(p,y,b),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const k=this._getClampedPixelRatio(p,y);this._resizeCanvas(p,y,k),this.painter.resize(p,y,k)}this.transform.resize(p,y),(o=this._requestedCameraState)===null||o===void 0||o.resize(p,y);const E=!this._moving;return E&&(this.stop(),this.fire(new l.k("movestart",v)).fire(new l.k("move",v))),this.fire(new l.k("resize",v)),E&&this.fire(new l.k("moveend",v)),this}_getClampedPixelRatio(v,o){const{0:d,1:p}=this._maxCanvasSize,y=this.getPixelRatio(),b=v*y,E=o*y;return Math.min(b>d?d/b:1,E>p?p/E:1)*y}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ht.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(v){return this._cooperativeGestures=v,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(v){return this.transform.locationPoint(l.L.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(l.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,o,d){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:b=>{const E=this.getLayer(o)?this.queryRenderedFeatures(b.point,{layers:[o]}):[];E.length?p||(p=!0,d.call(this,new fs(v,this,b.originalEvent,{features:E}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layer:o,listener:d,delegates:{mousemove:E=>{(this.getLayer(o)?this.queryRenderedFeatures(E.point,{layers:[o]}):[]).length?p=!0:p&&(p=!1,d.call(this,new fs(v,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,d.call(this,new fs(v,this,E.originalEvent)))}}}}{const p=y=>{const b=this.getLayer(o)?this.queryRenderedFeatures(y.point,{layers:[o]}):[];b.length&&(y.features=b,d.call(this,y),delete y.features)};return{layer:o,listener:d,delegates:{[v]:p}}}}on(v,o,d){if(d===void 0)return super.on(v,o);const p=this._createDelegatedListener(v,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(v,o,d){if(d===void 0)return super.once(v,o);const p=this._createDelegatedListener(v,o,d);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(v,o,d){return d===void 0?super.off(v,o):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{const y=this._delegatedListeners[v];for(let b=0;b<y.length;b++){const E=y[b];if(E.layer===o&&E.listener===d){for(const C in E.delegates)this.off(C,E.delegates[C]);return y.splice(b,1),this}}})(),this)}queryRenderedFeatures(v,o){if(!this.style)return[];let d;const p=v instanceof l.P||Array.isArray(v),y=p?v:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(p?{}:v)||{},y instanceof l.P||typeof y[0]=="number")d=[l.P.convert(y)];else{const b=l.P.convert(y[0]),E=l.P.convert(y[1]);d=[b,new l.P(E.x,b.y),E,new l.P(b.x,E.y),b]}return this.style.queryRenderedFeatures(d,o,this.transform)}querySourceFeatures(v,o){return this.style.querySourceFeatures(v,o)}setStyle(v,o){return(o=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(v,o))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const o=this._locale[v];if(o==null)throw new Error(`Missing UI string '${v}'`);return o}_updateStyle(v,o){if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,o));const d=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Zn(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,o,d):this.style.loadJSON(v,o,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,o){if(typeof v=="string"){const d=this._requestManager.transformRequest(v,z.Style);l.f(d,(p,y)=>{p?this.fire(new l.j(p)):y&&this._updateDiff(y,o)})}else typeof v=="object"&&this._updateDiff(v,o)}_updateDiff(v,o){try{this.style.setState(v,o)&&this._update(!0)}catch(d){l.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(v,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(v,o){return this._lazyInitEmptyStyle(),this.style.addSource(v,o),this._update(!0)}isSourceLoaded(v){const o=this.style&&this.style.sourceCaches[v];if(o!==void 0)return o.loaded();this.fire(new l.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const o=this.style.sourceCaches[v.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===v.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Og(this.painter,o,v),this.painter.renderToTexture=new lh(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==v.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.k("terrain",{terrain:v})),this}getTerrain(){var v,o;return(o=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const o in v){const d=v[o]._tiles;for(const p in d){const y=d[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(v,o,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,o,d)}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,o,d={}){const{pixelRatio:p=1,sdf:y=!1,stretchX:b,stretchY:E,content:C}=d;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||l.a(o))){if(o.width===void 0||o.height===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:R,data:j}=o,V=o;return this.style.addImage(v,{data:new l.R({width:k,height:R},new Uint8Array(j)),pixelRatio:p,stretchX:b,stretchY:E,content:C,sdf:y,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v),this}}{const{width:k,height:R,data:j}=l.h.getImageData(o);this.style.addImage(v,{data:new l.R({width:k,height:R},j),pixelRatio:p,stretchX:b,stretchY:E,content:C,sdf:y,version:0})}}updateImage(v,o){const d=this.style.getImage(v);if(!d)return this.fire(new l.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=o instanceof HTMLImageElement||l.a(o)?l.h.getImageData(o):o,{width:y,height:b,data:E}=p;if(y===void 0||b===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==d.data.width||b!==d.data.height)return this.fire(new l.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(o instanceof HTMLImageElement||l.a(o));return d.data.replace(E,C),this.style.updateImage(v,d),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new l.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,o){W.getImage(this._requestManager.transformRequest(v,z.Image),o)}listImages(){return this.style.listImages()}addLayer(v,o){return this._lazyInitEmptyStyle(),this.style.addLayer(v,o),this._update(!0)}moveLayer(v,o){return this.style.moveLayer(v,o),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,o,d){return this.style.setLayerZoomRange(v,o,d),this._update(!0)}setFilter(v,o,d={}){return this.style.setFilter(v,o,d),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,o,d,p={}){return this.style.setPaintProperty(v,o,d,p),this._update(!0)}getPaintProperty(v,o){return this.style.getPaintProperty(v,o)}setLayoutProperty(v,o,d,p={}){return this.style.setLayoutProperty(v,o,d,p),this._update(!0)}getLayoutProperty(v,o){return this.style.getLayoutProperty(v,o)}setGlyphs(v,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,o,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,o,d,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,o,d=>{d||this._update(!0)}),this}setLight(v,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(v,o){return this.style.setFeatureState(v,o),this._update()}removeFeatureState(v,o){return this.style.removeFeatureState(v,o),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,o=0;return this._container&&(v=this._container.clientWidth||400,o=this._container.clientHeight||300),[v,o]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const o=this._canvasContainer=_.create("div","maplibregl-canvas-container",v);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=_.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const y=this._controlContainer=_.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{b[E]=_.create("div",`maplibregl-ctrl-${E} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=_.create("div","maplibregl-cooperative-gesture-screen",this._container);let v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${v}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){_.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(v,o,d){this._canvas.width=Math.floor(d*v),this._canvas.height=Math.floor(d*o),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let o=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{o={requestedAttributes:v},p&&(o.statusMessage=p.statusMessage,o.type=p.type)},{once:!0});const d=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!d){const p="Failed to initialize WebGL";throw o?(o.message=p,new Error(JSON.stringify(o))):new Error(p)}this.painter=new $a(d,this.transform),S.testSupport(d)}_onCooperativeGesture(v,o,d){return!o&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const o=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=l.h.now();this.style.zoomHistory.update(y,b);const E=new l.a8(y,{now:b,fadeDuration:o,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=E.crossFadingFactor();C===1&&C===this._crossFadingFactor||(d=!0,this._crossFadingFactor=C),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,showPadding:this.showPadding}),this.fire(new l.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.bg.mark(l.bh.load),this.fire(new l.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,l.bg.mark(l.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_.remove(this._canvasContainer),_.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.bg.clearMetrics(),this._removed=!0,this.fire(new l.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.h.frame(v=>{l.bg.frame(v),this._frame=null,this._render(v)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Gt}getCameraTargetElevation(){return this.transform.elevation}},Vn.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const o=this._map.getZoom(),d=o===this._map.getMaxZoom(),p=o===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=o},this._setButtonTitle=(o,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);o.title=p,o.setAttribute("aria-label",p)},this.options=l.e({},Pf,v),this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),_.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=_.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,o){const d=_.create("button",v,this._container);return d.type="button",d.addEventListener("click",o),d}},Vn.GeolocateControl=class extends l.E{constructor(v){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new l.k("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.k("geolocate",o)),this._finish()}},this._updateCamera=o=>{const d=new l.L(o.coords.longitude,o.coords.latitude),p=o.coords.accuracy,y=this._map.getBearing(),b=l.e({bearing:y},this.options.fitBoundsOptions),E=ht.fromLngLat(d,p);this._map.fitBounds(E,b,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const d=new l.L(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Dl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.k("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=o=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=_.create("button","maplibregl-ctrl-geolocate",this._container),_.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",o===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wa({element:this._dotElement}),this._circleElement=_.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.k("trackuserlocationend")))})}},this.options=l.e({},br,v)}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(o,d=!1){Rr===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{Rr=p.state!=="denied",o(Rr)}).catch(()=>{Rr=!!window.navigator.geolocation,o(Rr)}):(Rr=!!window.navigator.geolocation,o(Rr)):o(Rr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,yr=0,Dl=!1}_isOutOfMapMaxBounds(v){const o=this._map.getMaxBounds(),d=v.coords;return o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),o=v.getSouthEast(),d=v.getNorthEast(),p=o.distanceTo(d),y=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":yr--,Dl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),yr++,yr>1?(v={maximumAge:6e5,timeout:0},Dl=!0):(v=this.options.positionOptions,Dl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Vn.AttributionControl=ps,Vn.LogoControl=sr,Vn.ScaleControl=class{constructor(v){this._onMove=()=>{qc(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,qc(this._map,this._container,this.options)},this.options=l.e({},Hc,v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Vn.FullscreenControl=class extends l.E{constructor(v={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=_.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Vn.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=v}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_.create("button","maplibregl-ctrl-terrain",this._container),_.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Vn.Popup=class extends l.E{constructor(v){super(),this.remove=()=>(this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.k("close")),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Af(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!o)return;const d=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);let p=this.options.anchor;const y=Fl(this.options.offset);if(!p){const E=this._container.offsetWidth,C=this._container.offsetHeight;let k;k=d.y+y.bottom.y<C?["top"]:d.y>this._map.transform.height-C?["bottom"]:[],d.x<E/2?k.push("left"):d.x>this._map.transform.width-E/2&&k.push("right"),p=k.length===0?"bottom":k.join("-")}const b=d.add(y[p]).round();_.setTransform(this._container,`${ks[p]} translate(${b.x}px,${b.y}px)`),zg(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(If),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=l.L.convert(v),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const o=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=v;p=d.firstChild,p;)o.appendChild(p);return this.setDOMContent(o)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){this._container&&this._container.classList.add(v)}removeClassName(v){this._container&&this._container.classList.remove(v)}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}_createCloseButton(){this.options.closeButton&&(this._closeButton=_.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(kf);v&&v.focus()}},Vn.Marker=Wa,Vn.Style=Zn,Vn.LngLat=l.L,Vn.LngLatBounds=ht,Vn.Point=l.P,Vn.MercatorCoordinate=l.U,Vn.Evented=l.E,Vn.AJAXError=l.bi,Vn.config=l.c,Vn.CanvasSource=mn,Vn.GeoJSONSource=qt,Vn.ImageSource=ln,Vn.RasterDEMTileSource=Ht,Vn.RasterTileSource=xt,Vn.VectorTileSource=Qe,Vn.VideoSource=Qt,Vn.setRTLTextPlugin=l.bj,Vn.getRTLTextPluginStatus=l.bk,Vn.prewarm=function(){et().acquire(It)},Vn.clearPrewarmedResources=function(){const v=On;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(It),On=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Mf.extend(Vn,{isSafari:l.ac,getPerformanceMetrics:l.bg.getPerformanceMetrics}),Vn});var h=i;return h})})(hO);var HH=hO.exports;const qH=Im(HH),ZH=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,XH=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,dI=[0,0,0,255],YH={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:dI},getLineColor:{type:"accessor",value:dI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class C2 extends Du{getShaders(){return super.getShaders({vs:ZH,fs:XH,modules:[v2,x2]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,stroked:h,filled:l,billboard:m,antialiasing:_,lineWidthUnits:S,lineWidthScale:P,lineWidthMinPixels:A,lineWidthMaxPixels:L}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:h?1:0,filled:l,billboard:m,antialiasing:_,radiusUnits:um[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,lineWidthUnits:um[S],lineWidthScale:P,lineWidthMinPixels:A,lineWidthMaxPixels:L}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new gm(e,{...this.getShaders(),id:this.props.id,geometry:new f2({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}K(C2,"defaultProps",YH);K(C2,"layerName","ScatterplotLayer");const fO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function pO(t,e,n={}){return KH(t,n)!==e?(QH(t,n),!0):!1}function KH(t,e={}){return Math.sign(JH(t,e))}function JH(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let a=0;for(let h=n,l=r-i;h<r;h+=i)a+=(t[h]-t[l])*(t[h+1]+t[l+1]),l=h;return a/2}function QH(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,a=(r-n)/i,h=Math.floor(a/2);for(let l=0;l<h;++l){const m=n+l*i,_=n+(a-1-l)*i;for(let S=0;S<i;++S){const P=t[m+S];t[m+S]=t[_+S],t[_+S]=P}}}function oa(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let a=0;a<n;a++)if(t[r-n+a]!==e[a]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Lw(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function ym(t,e,n,r,i=[]){const a=r+e*n;for(let h=0;h<n;h++)i[h]=t[a+h];return i}function Rw(t,e,n,r,i=[]){let a,h;if(n&8)a=(r[3]-t[1])/(e[1]-t[1]),h=3;else if(n&4)a=(r[1]-t[1])/(e[1]-t[1]),h=1;else if(n&2)a=(r[2]-t[0])/(e[0]-t[0]),h=2;else if(n&1)a=(r[0]-t[0])/(e[0]-t[0]),h=0;else return null;for(let l=0;l<t.length;l++)i[l]=(h&1)===l?r[h]:a*(e[l]-t[l])+t[l];return i}function v0(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function mO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:a=[0,0],startIndex:h=0,endIndex:l=t.length}=e||{},m=(l-h)/n;let _=[];const S=[_],P=ym(t,0,n,h);let A,L;const O=yO(P,i,a,[]),D=[];oa(_,P);for(let W=1;W<m;W++){for(A=ym(t,W,n,h,A),L=v0(A,O);L;){Rw(P,A,L,O,D);const z=v0(D,O);z&&(Rw(P,D,z,O,D),L=z),oa(_,D),Lw(P,D),tq(O,i,L),r&&_.length>n&&(_=[],S.push(_),oa(_,P)),L=v0(A,O)}oa(_,A),Lw(P,A)}return r?S:S[0]}const fI=0,eq=1;function Oy(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function gO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:a=[0,0],edgeTypes:h=!1}=n||{},l=[],m=[{pos:t,types:h?new Array(t.length/r).fill(eq):null,holes:e||[]}],_=[[],[]];let S=[];for(;m.length;){const{pos:P,types:A,holes:L}=m.shift();nq(P,r,L[0]||P.length,_),S=yO(_[0],i,a,S);const O=v0(_[1],S);if(O){let D=pI(P,A,r,0,L[0]||P.length,S,O);const W={pos:D[0].pos,types:D[0].types,holes:[]},z={pos:D[1].pos,types:D[1].types,holes:[]};m.push(W,z);for(let N=0;N<L.length;N++)D=pI(P,A,r,L[N],L[N+1]||P.length,S,O),D[0]&&(W.holes.push(W.pos.length),W.pos=Oy(W.pos,D[0].pos),h&&(W.types=Oy(W.types,D[0].types))),D[1]&&(z.holes.push(z.pos.length),z.pos=Oy(z.pos,D[1].pos),h&&(z.types=Oy(z.types,D[1].types)))}else{const D={positions:P};h&&(D.edgeTypes=A),L.length&&(D.holeIndices=L),l.push(D)}}return l}function pI(t,e,n,r,i,a,h){const l=(i-r)/n,m=[],_=[],S=[],P=[],A=[];let L,O,D;const W=ym(t,l-1,n,r);let z=Math.sign(h&8?W[1]-a[3]:W[0]-a[2]),N=e&&e[l-1],F=0,$=0;for(let Q=0;Q<l;Q++)L=ym(t,Q,n,r,L),O=Math.sign(h&8?L[1]-a[3]:L[0]-a[2]),D=e&&e[r/n+Q],O&&z&&z!==O&&(Rw(W,L,h,a,A),oa(m,A)&&S.push(N),oa(_,A)&&P.push(N)),O<=0?(oa(m,L)&&S.push(D),F-=O):S.length&&(S[S.length-1]=fI),O>=0?(oa(_,L)&&P.push(D),$+=O):P.length&&(P[P.length-1]=fI),Lw(W,L),z=O,N=D;return[F?{pos:m,types:e&&S}:null,$?{pos:_,types:e&&P}:null]}function yO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],a=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=a,r[2]=i+e,r[3]=a+e,r}function tq(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function nq(t,e,n,r){let i=1/0,a=-1/0,h=1/0,l=-1/0;for(let m=0;m<n;m+=e){const _=t[m],S=t[m+1];i=_<i?_:i,a=_>a?_:a,h=S<h?S:h,l=S>l?S:l}return r[0][0]=i,r[0][1]=h,r[1][0]=a,r[1][1]=l,r}const rq=85.051129;function iq(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:a=!0}=e||{},h=t.slice(r,i);_O(h,n,0,i-r);const l=mO(h,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(a)for(const m of l)vO(m,n);return l}function sq(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:a=!1}=n||{};e=e||[];const h=[],l=[];let m=0,_=0;for(let P=0;P<=e.length;P++){const A=e[P]||t.length,L=_,O=oq(t,r,m,A);for(let D=O;D<A;D++)h[_++]=t[D];for(let D=m;D<O;D++)h[_++]=t[D];_O(h,r,L,_),aq(h,r,L,_,n==null?void 0:n.maxLatitude),m=A,l[P]=_}l.pop();const S=gO(h,l,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:a});if(i)for(const P of S)vO(P.positions,r);return S}function oq(t,e,n,r){let i=-1,a=-1;for(let h=n+1;h<r;h+=e){const l=Math.abs(t[h]);l>i&&(i=l,a=h-1)}return a}function aq(t,e,n,r,i=rq){const a=t[n],h=t[r-e];if(Math.abs(a-h)>180){const l=ym(t,0,e,n);l[0]+=Math.round((h-a)/360)*360,oa(t,l),l[1]=Math.sign(l[1])*i,oa(t,l),l[0]=a,oa(t,l)}}function _O(t,e,n,r){let i=t[0],a;for(let h=n;h<r;h+=e){a=t[h];const l=a-i;(l>180||l<-180)&&(a-=Math.round(l/360)*360),t[h]=i=a}}function vO(t,e){let n;const r=t.length/e;for(let a=0;a<r&&(n=t[a*e],(n+180)%360===0);a++);const i=-Math.round(n/360)*360;if(i!==0)for(let a=0;a<r;a++)t[a*e]+=i}function lq(t,e,n,r){let i;if(Array.isArray(t[0])){const a=t.length*e;i=new Array(a);for(let h=0;h<t.length;h++)for(let l=0;l<e;l++)i[h*e+l]=t[h][l]||0}else i=t;return n?mO(i,{size:e,gridResolution:n}):r?iq(i,{size:e}):i}const cq=1,uq=2,Wb=4;class hq extends aO{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?lq(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(mI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&mI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:a,geometrySize:h}=n;r.fill(0,a,a+h),i?(r[a]=Wb,r[a+h-2]=Wb):(r[a]+=cq,r[a+h-2]+=uq),r[a+h-1]=Wb}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:a}=n,h=new Array(3);for(let l=i,m=0;m<a;l++,m++)this.getPointOnPath(e,m,h),r[l*3]=h[0],r[l*3+1]=h[1],r[l*3+2]=h[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const a=n*i;return r[0]=e[a],r[1]=e[a+1],r[2]=i===3&&e[a+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function mI(t){return Array.isArray(t[0])}const dq=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,fq=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xO=[0,0,0,255],pq={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:xO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Hb={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class H_ extends Du{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:dq,fs:fq,modules:[v2,x2]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Hb,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Hb,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Hb,defaultValue:xO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:a})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,a)}}),this.setState({pathTesselator:new hq({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,m=n.data.attributes||{};l.updateGeometry({data:n.data,geometryBuffer:m.getPath,buffers:m,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var h;const{gl:l}=this.context;(h=this.state.model)===null||h===void 0||h.delete(),this.state.model=this._getModel(l),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:a,widthUnits:h,widthScale:l,widthMinPixels:m,widthMaxPixels:_}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:um[h],widthScale:l,miterLimit:a,widthMinPixels:m,widthMaxPixels:_}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new gm(e,{...this.getShaders(),id:this.props.id,geometry:new f2({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}K(H_,"defaultProps",pq);K(H_,"layerName","PathLayer");var A2={exports:{}};A2.exports=q_;A2.exports.default=q_;function q_(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,a=bO(t,0,i,n,!0),h=[];if(!a||a.next===a.prev)return h;var l,m,_,S,P,A,L;if(r&&(a=vq(t,e,a,n)),t.length>80*n){l=_=t[0],m=S=t[1];for(var O=n;O<i;O+=n)P=t[O],A=t[O+1],P<l&&(l=P),A<m&&(m=A),P>_&&(_=P),A>S&&(S=A);L=Math.max(_-l,S-m),L=L!==0?32767/L:0}return _m(a,h,n,l,m,L,0),h}function bO(t,e,n,r,i){var a,h;if(i===Dw(t,e,n,r)>0)for(a=e;a<n;a+=r)h=gI(a,t[a],t[a+1],h);else for(a=n-r;a>=e;a-=r)h=gI(a,t[a],t[a+1],h);return h&&Z_(h,h.next)&&(xm(h),h=h.next),h}function Iu(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(Z_(n,n.next)||Fr(n.prev,n,n.next)===0)){if(xm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function _m(t,e,n,r,i,a,h){if(t){!h&&a&&Tq(t,r,i,a);for(var l=t,m,_;t.prev!==t.next;){if(m=t.prev,_=t.next,a?gq(t,r,i,a):mq(t)){e.push(m.i/n|0),e.push(t.i/n|0),e.push(_.i/n|0),xm(t),t=_.next,l=_.next;continue}if(t=_,t===l){h?h===1?(t=yq(Iu(t),e,n),_m(t,e,n,r,i,a,2)):h===2&&_q(t,e,n,r,i,a):_m(Iu(t),e,n,r,i,a,1);break}}}}function mq(t){var e=t.prev,n=t,r=t.next;if(Fr(e,n,r)>=0)return!1;for(var i=e.x,a=n.x,h=r.x,l=e.y,m=n.y,_=r.y,S=i<a?i<h?i:h:a<h?a:h,P=l<m?l<_?l:_:m<_?m:_,A=i>a?i>h?i:h:a>h?a:h,L=l>m?l>_?l:_:m>_?m:_,O=r.next;O!==e;){if(O.x>=S&&O.x<=A&&O.y>=P&&O.y<=L&&Qh(i,l,a,m,h,_,O.x,O.y)&&Fr(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function gq(t,e,n,r){var i=t.prev,a=t,h=t.next;if(Fr(i,a,h)>=0)return!1;for(var l=i.x,m=a.x,_=h.x,S=i.y,P=a.y,A=h.y,L=l<m?l<_?l:_:m<_?m:_,O=S<P?S<A?S:A:P<A?P:A,D=l>m?l>_?l:_:m>_?m:_,W=S>P?S>A?S:A:P>A?P:A,z=Ow(L,O,e,n,r),N=Ow(D,W,e,n,r),F=t.prevZ,$=t.nextZ;F&&F.z>=z&&$&&$.z<=N;){if(F.x>=L&&F.x<=D&&F.y>=O&&F.y<=W&&F!==i&&F!==h&&Qh(l,S,m,P,_,A,F.x,F.y)&&Fr(F.prev,F,F.next)>=0||(F=F.prevZ,$.x>=L&&$.x<=D&&$.y>=O&&$.y<=W&&$!==i&&$!==h&&Qh(l,S,m,P,_,A,$.x,$.y)&&Fr($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;F&&F.z>=z;){if(F.x>=L&&F.x<=D&&F.y>=O&&F.y<=W&&F!==i&&F!==h&&Qh(l,S,m,P,_,A,F.x,F.y)&&Fr(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;$&&$.z<=N;){if($.x>=L&&$.x<=D&&$.y>=O&&$.y<=W&&$!==i&&$!==h&&Qh(l,S,m,P,_,A,$.x,$.y)&&Fr($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function yq(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!Z_(i,a)&&wO(i,r,r.next,a)&&vm(i,a)&&vm(a,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),xm(r),xm(r.next),r=t=a),r=r.next}while(r!==t);return Iu(r)}function _q(t,e,n,r,i,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&Cq(h,l)){var m=SO(h,l);h=Iu(h,h.next),m=Iu(m,m.next),_m(h,e,n,r,i,a,0),_m(m,e,n,r,i,a,0);return}l=l.next}h=h.next}while(h!==t)}function vq(t,e,n,r){var i=[],a,h,l,m,_;for(a=0,h=e.length;a<h;a++)l=e[a]*r,m=a<h-1?e[a+1]*r:t.length,_=bO(t,l,m,r,!1),_===_.next&&(_.steiner=!0),i.push(Pq(_));for(i.sort(xq),a=0;a<i.length;a++)n=bq(i[a],n);return n}function xq(t,e){return t.x-e.x}function bq(t,e){var n=wq(t,e);if(!n)return e;var r=SO(n,t);return Iu(r,r.next),Iu(n,n.next)}function wq(t,e){var n=e,r=t.x,i=t.y,a=-1/0,h;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=r&&l>a&&(a=l,h=n.x<n.next.x?n:n.next,l===r))return h}n=n.next}while(n!==e);if(!h)return null;var m=h,_=h.x,S=h.y,P=1/0,A;n=h;do r>=n.x&&n.x>=_&&r!==n.x&&Qh(i<S?r:a,i,_,S,i<S?a:r,i,n.x,n.y)&&(A=Math.abs(i-n.y)/(r-n.x),vm(n,t)&&(A<P||A===P&&(n.x>h.x||n.x===h.x&&Sq(h,n)))&&(h=n,P=A)),n=n.next;while(n!==m);return h}function Sq(t,e){return Fr(t.prev,t,e.prev)<0&&Fr(e.next,t,t.next)<0}function Tq(t,e,n,r){var i=t;do i.z===0&&(i.z=Ow(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Eq(i)}function Eq(t){var e,n,r,i,a,h,l,m,_=1;do{for(n=t,t=null,a=null,h=0;n;){for(h++,r=n,l=0,e=0;e<_&&(l++,r=r.nextZ,!!r);e++);for(m=_;l>0||m>0&&r;)l!==0&&(m===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,m--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,_*=2}while(h>1);return t}function Ow(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Pq(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Qh(t,e,n,r,i,a,h,l){return(i-h)*(e-l)>=(t-h)*(a-l)&&(t-h)*(r-l)>=(n-h)*(e-l)&&(n-h)*(a-l)>=(i-h)*(r-l)}function Cq(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Aq(t,e)&&(vm(t,e)&&vm(e,t)&&Iq(t,e)&&(Fr(t.prev,t,e.prev)||Fr(t,e.prev,e))||Z_(t,e)&&Fr(t.prev,t,t.next)>0&&Fr(e.prev,e,e.next)>0)}function Fr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Z_(t,e){return t.x===e.x&&t.y===e.y}function wO(t,e,n,r){var i=Dy(Fr(t,e,n)),a=Dy(Fr(t,e,r)),h=Dy(Fr(n,r,t)),l=Dy(Fr(n,r,e));return!!(i!==a&&h!==l||i===0&&zy(t,n,e)||a===0&&zy(t,r,e)||h===0&&zy(n,t,r)||l===0&&zy(n,e,r))}function zy(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Dy(t){return t>0?1:t<0?-1:0}function Aq(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&wO(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function vm(t,e){return Fr(t.prev,t,t.next)<0?Fr(t,e,t.next)>=0&&Fr(t,t.prev,e)>=0:Fr(t,e,t.prev)<0||Fr(t,t.next,e)<0}function Iq(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function SO(t,e){var n=new zw(t.i,t.x,t.y),r=new zw(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function gI(t,e,n,r){var i=new zw(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function xm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function zw(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}q_.deviation=function(t,e,n,r){var i=e&&e.length,a=i?e[0]*n:t.length,h=Math.abs(Dw(t,0,a,n));if(i)for(var l=0,m=e.length;l<m;l++){var _=e[l]*n,S=l<m-1?e[l+1]*n:t.length;h-=Math.abs(Dw(t,_,S,n))}var P=0;for(l=0;l<r.length;l+=3){var A=r[l]*n,L=r[l+1]*n,O=r[l+2]*n;P+=Math.abs((t[A]-t[O])*(t[L+1]-t[A+1])-(t[A]-t[L])*(t[O+1]-t[A+1]))}return h===0&&P===0?0:Math.abs((P-h)/h)};function Dw(t,e,n,r){for(var i=0,a=e,h=n-r;a<n;a+=r)i+=(t[h]-t[a])*(t[a+1]+t[h+1]),h=a;return i}q_.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var h=0;h<e;h++)n.vertices.push(t[i][a][h]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var kq=A2.exports;const Mq=Im(kq),Fy=fO.CLOCKWISE,yI=fO.COUNTER_CLOCKWISE,lc={isClosed:!0};function Lq(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Cp(t){return"positions"in t?t.positions:t}function x0(t){return"holeIndices"in t?t.holeIndices:null}function Rq(t){return Array.isArray(t[0])}function Oq(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function zq(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Dq(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function _I(t,e,n,r,i){let a=e;const h=n.length;for(let l=0;l<h;l++)for(let m=0;m<r;m++)t[a++]=n[l][m]||0;if(!zq(n))for(let l=0;l<r;l++)t[a++]=n[0][l]||0;return lc.start=e,lc.end=a,lc.size=r,pO(t,i,lc),a}function vI(t,e,n,r,i=0,a,h){a=a||n.length;const l=a-i;if(l<=0)return e;let m=e;for(let _=0;_<l;_++)t[m++]=n[i+_];if(!Dq(n,r,i,a))for(let _=0;_<r;_++)t[m++]=n[i+_];return lc.start=e,lc.end=m,lc.size=r,pO(t,h,lc),m}function TO(t,e){Lq(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:a}=t;if(a){let h=0;for(let l=0;l<=a.length;l++)h=vI(n,h,i,e,a[l-1],a[l],l===0?Fy:yI),r.push(h);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Rq(t))return vI(n,0,t,e,0,n.length,Fy),n;if(!Oq(t)){let i=0;for(const[a,h]of t.entries())i=_I(n,i,h,e,a===0?Fy:yI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return _I(n,0,t,e,Fy),n}function qb(t,e,n){const r=t.length/3;let i=0;for(let a=0;a<r;a++){const h=(a+1)%r;i+=t[a*3+e]*t[h*3+n],i-=t[h*3+e]*t[a*3+n]}return Math.abs(i/2)}function xI(t,e,n,r){const i=t.length/3;for(let a=0;a<i;a++){const h=a*3,l=t[h+0],m=t[h+1],_=t[h+2];t[h+e]=l,t[h+n]=m,t[h+r]=_}}function Fq(t,e,n,r){let i=x0(t);i&&(i=i.map(l=>l/e));let a=Cp(t);const h=r&&e===3;if(n){const l=a.length;a=a.slice();const m=[];for(let _=0;_<l;_+=e){m[0]=a[_],m[1]=a[_+1],h&&(m[2]=a[_+2]);const S=n(m);a[_]=S[0],a[_+1]=S[1],h&&(a[_+2]=S[2])}}if(h){const l=qb(a,0,1),m=qb(a,0,2),_=qb(a,1,2);if(!l&&!m&&!_)return[];l>m&&l>_||(m>_?(n||(a=a.slice()),xI(a,0,2,1)):(n||(a=a.slice()),xI(a,2,0,1)))}return Mq(a,i,e)}class Nq extends aO{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=TO(e,this.positionSize);return this.opts.resolution?gO(Cp(n),x0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?sq(Cp(n),x0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(bI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Cp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&bI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:a,indexStarts:h,typedArrayManager:l}=this;let m=a.indices;if(!m||!e)return;let _=i;const S=Fq(e,this.positionSize,this.opts.preproject,this.opts.full3d);m=l.allocate(m,i+S.length,{copy:!0});for(let P=0;P<S.length;P++)m[_++]=S[P]+r;h[n+1]=i+S.length,a.indices=m}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:a}=this;if(!i||!e)return;const h=Cp(e);for(let l=n,m=0;m<r;l++,m++){const _=h[m*a],S=h[m*a+1],P=a>2?h[m*a+2]:0;i[l*3]=_,i[l*3+1]=S,i[l*3+2]=P}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,a=this.attributes.vertexValid,h=e&&x0(e);if(e&&e.edgeTypes?a.set(e.edgeTypes,n):a.fill(1,n,n+r),h)for(let l=0;l<h.length;l++)a[n+h[l]/i-1]=0;a[n+r-1]=0}}function bI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const EO=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Bq=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(EO,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),jq=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(EO,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Vq=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,u_=[0,0,0,255],Uq={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:u_},getLineColor:{type:"accessor",value:u_},material:!0},Ny={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class I2 extends Du{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?Bq:jq,fs:Vq,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[v2,W8,x2]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Hn.DEFAULT&&(r=Hn.LNGLAT);let a;r===Hn.LNGLAT&&(i?a=n.projectPosition.bind(n):a=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Nq({preproject:a,fp64:this.use64bitPositions(),IndexType:!e||a2(e,Tr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const h=this.getAttributeManager(),l=!0;h.remove(["instancePickingColors"]),h.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ny,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,transition:Ny,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ny,accessor:"getFillColor",defaultValue:u_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ny,accessor:"getLineColor",defaultValue:u_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(m,{index:_,target:S})=>this.encodePickingColor(m&&m.__source?m.__source.index:_,S),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(a=>a.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:a}=this.props,{topModel:h,sideModel:l,polygonTesselator:m}=this.state,_={...e,extruded:!!n,elevationScale:a};l&&(l.setInstanceCount(m.instanceCount-1),l.setUniforms(_),i&&(l.setDrawMode(3),l.setUniforms({isWireframe:!0}).draw()),r&&(l.setDrawMode(6),l.setUniforms({isWireframe:!1}).draw())),h&&(h.setVertexCount(m.vertexCount),h.setUniforms(_).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,a=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var l;(l=this.state.models)===null||l===void 0||l.forEach(m=>m.delete()),this.setState(this._getModels(this.context.gl)),a.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:a}=this.state,h=e.data.attributes||{};a.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:h.getPolygon,buffers:h,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let a,h;if(r){const l=this.getShaders("top");l.defines.NON_INSTANCED_MODEL=1,a=new gm(e,{...l,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(h=new gm(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new f2({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),h.userData.excludeAttributes={indices:!0}),{models:[h,a].filter(Boolean),topModel:a,sideModel:h}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}K(I2,"defaultProps",Uq);K(I2,"layerName","SolidPolygonLayer");function $q({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:a=1/0}=n,h=t.length;let l=h,m=h;for(let A=0;A<h;A++){const L=e(t[A]);if(l>A&&L>=i&&(l=A),L>=a){m=A;break}}let _=l;const P=m-l!==r.length?t.slice(m):void 0;for(let A=0;A<r.length;A++)t[_++]=r[A];if(P){for(let A=0;A<P.length;A++)t[_++]=P[A];t.length=_}return{startRow:l,endRow:l+r.length}}const PO=[0,0,0,255],Gq=[0,0,0,255],Wq={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Gq},getLineColor:{type:"accessor",value:PO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class k2 extends oO{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&hr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(a=>$q({data:r,getIndex:h=>h.__source.index,dataRange:a,replace:this._getPaths(a)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:a}=this.props,h=[],l=i==="XY"?2:3,{startRow:m,endRow:_}=e,{iterable:S,objectInfo:P}=w2(n,m,_);for(const A of S){P.index++;let L=r(A,P);a&&(L=TO(L,l));const{holeIndices:O}=L,D=L.positions||L;if(O)for(let W=0;W<=O.length;W++){const z=D.slice(O[W-1]||0,O[W]||D.length);h.push(this.getSubLayerRow({path:z},A,P.index))}else h.push(this.getSubLayerRow({path:D},A,P.index))}return h}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:a,wireframe:h,_normalize:l,_windingOrder:m,elevationScale:_,transitions:S,positionFormat:P}=this.props,{lineWidthUnits:A,lineWidthScale:L,lineWidthMinPixels:O,lineWidthMaxPixels:D,lineJointRounded:W,lineMiterLimit:z,lineDashJustified:N}=this.props,{getFillColor:F,getLineColor:$,getLineWidth:Q,getLineDashArray:te,getElevation:ie,getPolygon:xe,updateTriggers:Te,material:_e}=this.props,{paths:Re,pathsDiff:Ne}=this.state,Ve=this.getSubLayerClass("fill",I2),je=this.getSubLayerClass("stroke",H_),Ge=this.shouldRenderSubLayer("fill",Re)&&new Ve({_dataDiff:n,extruded:a,elevationScale:_,filled:i,wireframe:h,_normalize:l,_windingOrder:m,getElevation:ie,getFillColor:F,getLineColor:a&&h?$:PO,material:_e,transitions:S},this.getSubLayerProps({id:"fill",updateTriggers:Te&&{getPolygon:Te.getPolygon,getElevation:Te.getElevation,getFillColor:Te.getFillColor,lineColors:a&&h,getLineColor:Te.getLineColor}}),{data:e,positionFormat:P,getPolygon:xe}),Ze=!a&&r&&this.shouldRenderSubLayer("stroke",Re)&&new je({_dataDiff:Ne&&(()=>Ne),widthUnits:A,widthScale:L,widthMinPixels:O,widthMaxPixels:D,jointRounded:W,miterLimit:z,dashJustified:N,_pathType:"loop",transitions:S&&{getWidth:S.getLineWidth,getColor:S.getLineColor,getPath:S.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(Q),getDashArray:this.getSubLayerAccessor(te)},this.getSubLayerProps({id:"stroke",updateTriggers:Te&&{getWidth:Te.getLineWidth,getColor:Te.getLineColor,getDashArray:Te.getLineDashArray}}),{data:Re,positionFormat:P,getPath:Ye=>Ye.path});return[!a&&Ge,Ze,a&&Ge]}}K(k2,"layerName","PolygonLayer");K(k2,"defaultProps",Wq);const Hq={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class M2 extends H_{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}K(M2,"layerName","TripsLayer");K(M2,"defaultProps",Hq);function CO(t,e,n=64){const r={latitude:t[1],longitude:t[0]},i=e,a=[],h=i/(111.32*Math.cos(r.latitude*Math.PI/180)),l=i/110.574;let m,_,S;for(var P=0;P<n;P++)m=P/n*(2*Math.PI),_=h*Math.cos(m),S=l*Math.sin(m),a.push([r.longitude+_,r.latitude+S]);return a.push(a[0]),a}function Ch(t){const e=t.match(/\d+(\.\d)?/g).map(Number);return e[3]&&(e[3]*=255),e}function Ah(t){if(!t)return"rgb(0, 0, 0)";const e=[...t];return e[3]&&(e[3]/=255),`rgb${t.length>=4?"a":""}(${e.join(", ")})`}const qq=["footway","street_lamp","steps","pedestrian","track","path"];function AO(t){const n=`
    [out:json];(
        way[highway]${qq.map(r=>`[highway!="${r}"]`).join("")}[footway!="*"]
        (${t[0].latitude},${t[0].longitude},${t[1].latitude},${t[1].longitude});
        node(w);
    );
    out skel;`;return fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:n})}class Zq{constructor(e,n){this.node1=e,this.node2=n,this.visited=!1}getOtherNode(e){return e===this.node1?this.node2:this.node1}get weight(){return Math.hypot(this.node1.latitude-this.node2.latitude,this.node1.longitude-this.node2.longitude)}}class Xq{constructor(e,n,r){this.edges=[],this.reset(),this.id=e,this.latitude=n,this.longitude=r,this.visited=!1}get totalDistance(){return this.distanceFromStart+this.distanceToEnd}get neighbors(){return this.edges.map(e=>({edge:e,node:e.getOtherNode(this)}))}connectTo(e){const n=new Zq(this,e);this.edges.push(n),e.edges.push(n)}reset(){this.visited=!1,this.distanceFromStart=0,this.distanceToEnd=0,this.parent=null,this.referer=null;for(const e of this.neighbors)e.edge.visited=!1}}class Yq{constructor(){this.startNode=null,this.nodes=new Map}getNode(e){return this.nodes.get(e)}addNode(e,n,r){const i=new Xq(e,n,r);return this.nodes.set(i.id,i),i}}async function wI(t,e){const n=CO([e,t],.15),r=IO(n),a=await(await AO(r)).json();let h;for(const l of a.elements){if(l.type!=="node")continue;if(!h){h=l;continue}const m=Math.sqrt(Math.pow(l.lat-t,2)+Math.pow(l.lon-e,2)),_=Math.sqrt(Math.pow(h.lat-t,2)+Math.pow(h.lon-e,2));m<_&&(h=l)}return h}async function Kq(t,e){const i=(await(await AO(t)).json()).elements,a=new Yq;for(const h of i)if(h.type==="node"){const l=a.addNode(h.id,h.lat,h.lon);l.id===e&&(a.startNode=l)}else if(h.type==="way"){if(!h.nodes||h.nodes.length<2)continue;for(let l=0;l<h.nodes.length-1;l++){const m=a.getNode(h.nodes[l]),_=a.getNode(h.nodes[l+1]);!m||!_||m.connectTo(_)}}if(!a.startNode)throw new Error("Start node was not found.");return a}function IO(t){const e={minLat:Number.MAX_VALUE,maxLat:-Number.MAX_VALUE,minLon:Number.MAX_VALUE,maxLon:-Number.MAX_VALUE};for(const r of t)r[0]<e.minLon&&(e.minLon=r[0]),r[0]>e.maxLon&&(e.maxLon=r[0]),r[1]<e.minLat&&(e.minLat=r[1]),r[1]>e.maxLat&&(e.maxLat=r[1]);return[{latitude:e.minLat,longitude:e.minLon},{latitude:e.maxLat,longitude:e.maxLon}]}class qm{constructor(){this.finished=!1}start(e,n){this.finished=!1,this.startNode=e,this.endNode=n}nextStep(){return[]}}class SI extends qm{constructor(){super(),this.openList=[],this.closedList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.closedList=[],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,a)=>a.totalDistance<i.totalDistance?a:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge,l=n.distanceFromStart+Math.hypot(a.longitude-n.longitude,a.latitude-n.latitude);if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),this.openList.includes(a)){if(a.distanceFromStart<=l)continue}else if(this.closedList.includes(a)){if(a.distanceFromStart<=l)continue;this.closedList.splice(this.closedList.indexOf(a),1),this.openList.push(a)}else this.openList.push(a),a.distanceToEnd=Math.hypot(a.longitude-this.endNode.longitude,a.latitude-this.endNode.latitude);a.distanceFromStart=l,a.referer=n,a.parent=n}return this.closedList.push(n),[...e,n]}}class Jq extends qm{constructor(){super(),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(this.startNode),this.openSetEnd.add(this.endNode),this.closedSetStart=new Set,this.closedSetEnd=new Set}start(e,n){super.start(e,n),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(e),this.openSetEnd.add(n),this.closedSetStart=new Set,this.closedSetEnd=new Set}nextStep(){if(this.finished)return[];const e=[],n=this.getNextFromOpenSet(this.openSetStart,this.closedSetStart);if(n){n.visited=!0,this.closedSetStart.add(n);const i=n.edges.find(a=>a.getOtherNode(n)===n.referer);if(i&&(i.visited=!0),this.openSetEnd.has(n))return this.finished=!0,console.log("found from start"),[n];e.push(n),e.push(...this.updateNeighbors(n,this.openSetStart,this.closedSetStart))}const r=this.getNextFromOpenSet(this.openSetEnd,this.closedSetEnd);if(r){r.visited=!0,this.closedSetEnd.add(r);const i=r.edges.find(a=>a.getOtherNode(r)===r.referer);if(i&&(i.visited=!0),this.openSetStart.has(r))return console.log("found from end"),this.finished=!0,[r];e.push(r),e.push(...this.updateNeighbors(r,this.openSetEnd,this.closedSetEnd))}return e}updateNeighbors(e,n,r){const i=[];for(const a of e.neighbors){const h=a.node,l=a.edge;h.visited&&!l.visited&&(l.visited=!0,h.referer=e,i.push(h)),!r.has(h)&&!h.visited&&(n.add(h),h.prevParent=h.parent,h.parent=e,h.referer=e)}return i}getNextFromOpenSet(e,n){let r=null;for(const i of e)(!r||i.totalDistance<r.totalDistance)&&(n.has(i)||(r=i));return r&&e.delete(r),r}}class Qq extends qm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[e]}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.shift();n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge;if(a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),a.visited)continue;const l=n.distanceFromStart+h.weight;if(this.openList.includes(a)){if(l>=a.distanceFromStart)continue}else this.openList.push(a);a.distanceFromStart=l,a.parent=n,a.referer=n}return[...e,n]}}class eZ extends qm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,a)=>a.distanceToEnd<i.distanceToEnd?a:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const a=i.node,h=i.edge;a.visited&&!h.visited&&(h.visited=!0,a.referer=n,e.push(a)),!a.visited&&(a.distanceToEnd=Math.hypot(a.longitude-this.endNode.longitude,a.latitude-this.endNode.latitude),this.openList.includes(a)||this.openList.push(a),a.referer=n,a.parent=n)}return[...e,n]}}var fd;const td=class td{constructor(){return Vx(td,fd)||(this.endNode=null,this.graph=null,this.finished=!1,this.algorithm=new qm,tP(td,fd,this)),Vx(td,fd)}get startNode(){return this.graph.startNode}getNode(e){var n;return(n=this.graph)==null?void 0:n.getNode(e)}reset(){if(this.finished=!1,!!this.graph)for(const e of this.graph.nodes.keys())this.graph.nodes.get(e).reset()}start(e){switch(this.reset(),e){case"astar":this.algorithm=new SI;break;case"greedy":this.algorithm=new eZ;break;case"dijkstra":this.algorithm=new Qq;break;case"bidirectional":this.algorithm=new Jq;break;default:this.algorithm=new SI;break}this.algorithm.start(this.startNode,this.endNode)}nextStep(){const e=this.algorithm.nextStep();return(this.algorithm.finished||e.length===0)&&(this.finished=!0),e}};fd=new WeakMap,eP(td,fd,void 0);let Fw=td;const tZ={black:"#000",white:"#fff"},bm=tZ,nZ={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ih=nZ,rZ={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},kh=rZ,iZ={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Mh=iZ,sZ={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Lh=sZ,oZ={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Rh=oZ,aZ={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},dp=aZ,lZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},cZ=lZ;function _l(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const uZ=Object.freeze(Object.defineProperty({__proto__:null,default:_l},Symbol.toStringTag,{value:"Module"})),Rd="$$material";function se(){return se=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},se.apply(null,arguments)}function Yt(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}function kO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var hZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dZ=kO(function(t){return hZ.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),fZ=!1;function pZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function mZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var gZ=function(){function t(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!fZ:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(mZ(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=pZ(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},t}(),rs="-ms-",h_="-moz-",Yn="-webkit-",MO="comm",L2="rule",R2="decl",yZ="@import",LO="@keyframes",_Z="@layer",vZ=Math.abs,X_=String.fromCharCode,xZ=Object.assign;function bZ(t,e){return Bi(t,0)^45?(((e<<2^Bi(t,0))<<2^Bi(t,1))<<2^Bi(t,2))<<2^Bi(t,3):0}function RO(t){return t.trim()}function wZ(t,e){return(t=e.exec(t))?t[0]:t}function Kn(t,e,n){return t.replace(e,n)}function Nw(t,e){return t.indexOf(e)}function Bi(t,e){return t.charCodeAt(e)|0}function wm(t,e,n){return t.slice(e,n)}function Ea(t){return t.length}function O2(t){return t.length}function By(t,e){return e.push(t),t}function SZ(t,e){return t.map(e).join("")}var Y_=1,Od=1,OO=0,Vs=0,ui=0,Wd="";function K_(t,e,n,r,i,a,h){return{value:t,root:e,parent:n,type:r,props:i,children:a,line:Y_,column:Od,length:h,return:""}}function fp(t,e){return xZ(K_("",null,null,"",null,null,0),t,{length:-t.length},e)}function TZ(){return ui}function EZ(){return ui=Vs>0?Bi(Wd,--Vs):0,Od--,ui===10&&(Od=1,Y_--),ui}function so(){return ui=Vs<OO?Bi(Wd,Vs++):0,Od++,ui===10&&(Od=1,Y_++),ui}function Ra(){return Bi(Wd,Vs)}function b0(){return Vs}function Zm(t,e){return wm(Wd,t,e)}function Sm(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function zO(t){return Y_=Od=1,OO=Ea(Wd=t),Vs=0,[]}function DO(t){return Wd="",t}function w0(t){return RO(Zm(Vs-1,Bw(t===91?t+2:t===40?t+1:t)))}function PZ(t){for(;(ui=Ra())&&ui<33;)so();return Sm(t)>2||Sm(ui)>3?"":" "}function CZ(t,e){for(;--e&&so()&&!(ui<48||ui>102||ui>57&&ui<65||ui>70&&ui<97););return Zm(t,b0()+(e<6&&Ra()==32&&so()==32))}function Bw(t){for(;so();)switch(ui){case t:return Vs;case 34:case 39:t!==34&&t!==39&&Bw(ui);break;case 40:t===41&&Bw(t);break;case 92:so();break}return Vs}function AZ(t,e){for(;so()&&t+ui!==47+10;)if(t+ui===42+42&&Ra()===47)break;return"/*"+Zm(e,Vs-1)+"*"+X_(t===47?t:so())}function IZ(t){for(;!Sm(Ra());)so();return Zm(t,Vs)}function kZ(t){return DO(S0("",null,null,null,[""],t=zO(t),0,[0],t))}function S0(t,e,n,r,i,a,h,l,m){for(var _=0,S=0,P=h,A=0,L=0,O=0,D=1,W=1,z=1,N=0,F="",$=i,Q=a,te=r,ie=F;W;)switch(O=N,N=so()){case 40:if(O!=108&&Bi(ie,P-1)==58){Nw(ie+=Kn(w0(N),"&","&\f"),"&\f")!=-1&&(z=-1);break}case 34:case 39:case 91:ie+=w0(N);break;case 9:case 10:case 13:case 32:ie+=PZ(O);break;case 92:ie+=CZ(b0()-1,7);continue;case 47:switch(Ra()){case 42:case 47:By(MZ(AZ(so(),b0()),e,n),m);break;default:ie+="/"}break;case 123*D:l[_++]=Ea(ie)*z;case 125*D:case 59:case 0:switch(N){case 0:case 125:W=0;case 59+S:z==-1&&(ie=Kn(ie,/\f/g,"")),L>0&&Ea(ie)-P&&By(L>32?EI(ie+";",r,n,P-1):EI(Kn(ie," ","")+";",r,n,P-2),m);break;case 59:ie+=";";default:if(By(te=TI(ie,e,n,_,S,i,l,F,$=[],Q=[],P),a),N===123)if(S===0)S0(ie,e,te,te,$,a,P,l,Q);else switch(A===99&&Bi(ie,3)===110?100:A){case 100:case 108:case 109:case 115:S0(t,te,te,r&&By(TI(t,te,te,0,0,i,l,F,i,$=[],P),Q),i,Q,P,l,r?$:Q);break;default:S0(ie,te,te,te,[""],Q,0,l,Q)}}_=S=L=0,D=z=1,F=ie="",P=h;break;case 58:P=1+Ea(ie),L=O;default:if(D<1){if(N==123)--D;else if(N==125&&D++==0&&EZ()==125)continue}switch(ie+=X_(N),N*D){case 38:z=S>0?1:(ie+="\f",-1);break;case 44:l[_++]=(Ea(ie)-1)*z,z=1;break;case 64:Ra()===45&&(ie+=w0(so())),A=Ra(),S=P=Ea(F=ie+=IZ(b0())),N++;break;case 45:O===45&&Ea(ie)==2&&(D=0)}}return a}function TI(t,e,n,r,i,a,h,l,m,_,S){for(var P=i-1,A=i===0?a:[""],L=O2(A),O=0,D=0,W=0;O<r;++O)for(var z=0,N=wm(t,P+1,P=vZ(D=h[O])),F=t;z<L;++z)(F=RO(D>0?A[z]+" "+N:Kn(N,/&\f/g,A[z])))&&(m[W++]=F);return K_(t,e,n,i===0?L2:l,m,_,S)}function MZ(t,e,n){return K_(t,e,n,MO,X_(TZ()),wm(t,2,-2),0)}function EI(t,e,n,r){return K_(t,e,n,R2,wm(t,0,r),wm(t,r+1,-1),r)}function ud(t,e){for(var n="",r=O2(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function LZ(t,e,n,r){switch(t.type){case _Z:if(t.children.length)break;case yZ:case R2:return t.return=t.return||t.value;case MO:return"";case LO:return t.return=t.value+"{"+ud(t.children,r)+"}";case L2:t.value=t.props.join(",")}return Ea(n=ud(t.children,r))?t.return=t.value+"{"+n+"}":""}function RZ(t){var e=O2(t);return function(n,r,i,a){for(var h="",l=0;l<e;l++)h+=t[l](n,r,i,a)||"";return h}}function OZ(t){return function(e){e.root||(e=e.return)&&t(e)}}var zZ=function(e,n,r){for(var i=0,a=0;i=a,a=Ra(),i===38&&a===12&&(n[r]=1),!Sm(a);)so();return Zm(e,Vs)},DZ=function(e,n){var r=-1,i=44;do switch(Sm(i)){case 0:i===38&&Ra()===12&&(n[r]=1),e[r]+=zZ(Vs-1,n,r);break;case 2:e[r]+=w0(i);break;case 4:if(i===44){e[++r]=Ra()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=X_(i)}while(i=so());return e},FZ=function(e,n){return DO(DZ(zO(e),n))},PI=new WeakMap,NZ=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!PI.get(r))&&!i){PI.set(e,!0);for(var a=[],h=FZ(n,a),l=r.props,m=0,_=0;m<h.length;m++)for(var S=0;S<l.length;S++,_++)e.props[_]=a[m]?h[m].replace(/&\f/g,l[S]):l[S]+" "+h[m]}}},BZ=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function FO(t,e){switch(bZ(t,e)){case 5103:return Yn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Yn+t+h_+t+rs+t+t;case 6828:case 4268:return Yn+t+rs+t+t;case 6165:return Yn+t+rs+"flex-"+t+t;case 5187:return Yn+t+Kn(t,/(\w+).+(:[^]+)/,Yn+"box-$1$2"+rs+"flex-$1$2")+t;case 5443:return Yn+t+rs+"flex-item-"+Kn(t,/flex-|-self/,"")+t;case 4675:return Yn+t+rs+"flex-line-pack"+Kn(t,/align-content|flex-|-self/,"")+t;case 5548:return Yn+t+rs+Kn(t,"shrink","negative")+t;case 5292:return Yn+t+rs+Kn(t,"basis","preferred-size")+t;case 6060:return Yn+"box-"+Kn(t,"-grow","")+Yn+t+rs+Kn(t,"grow","positive")+t;case 4554:return Yn+Kn(t,/([^-])(transform)/g,"$1"+Yn+"$2")+t;case 6187:return Kn(Kn(Kn(t,/(zoom-|grab)/,Yn+"$1"),/(image-set)/,Yn+"$1"),t,"")+t;case 5495:case 3959:return Kn(t,/(image-set\([^]*)/,Yn+"$1$`$1");case 4968:return Kn(Kn(t,/(.+:)(flex-)?(.*)/,Yn+"box-pack:$3"+rs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yn+t+t;case 4095:case 3583:case 4068:case 2532:return Kn(t,/(.+)-inline(.+)/,Yn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ea(t)-1-e>6)switch(Bi(t,e+1)){case 109:if(Bi(t,e+4)!==45)break;case 102:return Kn(t,/(.+:)(.+)-([^]+)/,"$1"+Yn+"$2-$3$1"+h_+(Bi(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Nw(t,"stretch")?FO(Kn(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Bi(t,e+1)!==115)break;case 6444:switch(Bi(t,Ea(t)-3-(~Nw(t,"!important")&&10))){case 107:return Kn(t,":",":"+Yn)+t;case 101:return Kn(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yn+(Bi(t,14)===45?"inline-":"")+"box$3$1"+Yn+"$2$3$1"+rs+"$2box$3")+t}break;case 5936:switch(Bi(t,e+11)){case 114:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Yn+t+rs+t+t}return t}var jZ=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case R2:e.return=FO(e.value,e.length);break;case LO:return ud([fp(e,{value:Kn(e.value,"@","@"+Yn)})],i);case L2:if(e.length)return SZ(e.props,function(a){switch(wZ(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ud([fp(e,{props:[Kn(a,/:(read-\w+)/,":"+h_+"$1")]})],i);case"::placeholder":return ud([fp(e,{props:[Kn(a,/:(plac\w+)/,":"+Yn+"input-$1")]}),fp(e,{props:[Kn(a,/:(plac\w+)/,":"+h_+"$1")]}),fp(e,{props:[Kn(a,/:(plac\w+)/,rs+"input-$1")]})],i)}return""})}},VZ=[jZ],NO=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var W=D.getAttribute("data-emotion");W.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||VZ,a={},h,l=[];h=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var W=D.getAttribute("data-emotion").split(" "),z=1;z<W.length;z++)a[W[z]]=!0;l.push(D)});var m,_=[NZ,BZ];{var S,P=[LZ,OZ(function(D){S.insert(D)})],A=RZ(_.concat(i,P)),L=function(W){return ud(kZ(W),A)};m=function(W,z,N,F){S=N,L(W?W+"{"+z.styles+"}":z.styles),F&&(O.inserted[z.name]=!0)}}var O={key:n,sheet:new gZ({key:n,container:h,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:m};return O.sheet.hydrate(l),O},BO={exports:{}},nr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ii=typeof Symbol=="function"&&Symbol.for,z2=Ii?Symbol.for("react.element"):60103,D2=Ii?Symbol.for("react.portal"):60106,J_=Ii?Symbol.for("react.fragment"):60107,Q_=Ii?Symbol.for("react.strict_mode"):60108,ev=Ii?Symbol.for("react.profiler"):60114,tv=Ii?Symbol.for("react.provider"):60109,nv=Ii?Symbol.for("react.context"):60110,F2=Ii?Symbol.for("react.async_mode"):60111,rv=Ii?Symbol.for("react.concurrent_mode"):60111,iv=Ii?Symbol.for("react.forward_ref"):60112,sv=Ii?Symbol.for("react.suspense"):60113,UZ=Ii?Symbol.for("react.suspense_list"):60120,ov=Ii?Symbol.for("react.memo"):60115,av=Ii?Symbol.for("react.lazy"):60116,$Z=Ii?Symbol.for("react.block"):60121,GZ=Ii?Symbol.for("react.fundamental"):60117,WZ=Ii?Symbol.for("react.responder"):60118,HZ=Ii?Symbol.for("react.scope"):60119;function ho(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case z2:switch(t=t.type,t){case F2:case rv:case J_:case ev:case Q_:case sv:return t;default:switch(t=t&&t.$$typeof,t){case nv:case iv:case av:case ov:case tv:return t;default:return e}}case D2:return e}}}function jO(t){return ho(t)===rv}nr.AsyncMode=F2;nr.ConcurrentMode=rv;nr.ContextConsumer=nv;nr.ContextProvider=tv;nr.Element=z2;nr.ForwardRef=iv;nr.Fragment=J_;nr.Lazy=av;nr.Memo=ov;nr.Portal=D2;nr.Profiler=ev;nr.StrictMode=Q_;nr.Suspense=sv;nr.isAsyncMode=function(t){return jO(t)||ho(t)===F2};nr.isConcurrentMode=jO;nr.isContextConsumer=function(t){return ho(t)===nv};nr.isContextProvider=function(t){return ho(t)===tv};nr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===z2};nr.isForwardRef=function(t){return ho(t)===iv};nr.isFragment=function(t){return ho(t)===J_};nr.isLazy=function(t){return ho(t)===av};nr.isMemo=function(t){return ho(t)===ov};nr.isPortal=function(t){return ho(t)===D2};nr.isProfiler=function(t){return ho(t)===ev};nr.isStrictMode=function(t){return ho(t)===Q_};nr.isSuspense=function(t){return ho(t)===sv};nr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===J_||t===rv||t===ev||t===Q_||t===sv||t===UZ||typeof t=="object"&&t!==null&&(t.$$typeof===av||t.$$typeof===ov||t.$$typeof===tv||t.$$typeof===nv||t.$$typeof===iv||t.$$typeof===GZ||t.$$typeof===WZ||t.$$typeof===HZ||t.$$typeof===$Z)};nr.typeOf=ho;BO.exports=nr;var qZ=BO.exports,VO=qZ,ZZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},XZ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},UO={};UO[VO.ForwardRef]=ZZ;UO[VO.Memo]=XZ;var YZ=!0;function KZ(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(r+=i+" ")}),r}var $O=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||YZ===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},GO=function(e,n,r){$O(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var a=n;do e.insert(n===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function JZ(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var QZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},eX=!1,tX=/[A-Z]|^ms/g,nX=/_EMO_([^_]+?)_([^]*?)_EMO_/g,WO=function(e){return e.charCodeAt(1)===45},CI=function(e){return e!=null&&typeof e!="boolean"},Zb=kO(function(t){return WO(t)?t:t.replace(tX,"-$&").toLowerCase()}),AI=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(nX,function(r,i,a){return Pa={name:i,styles:a,next:Pa},i})}return QZ[e]!==1&&!WO(e)&&typeof n=="number"&&n!==0?n+"px":n},rX="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Tm(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return Pa={name:i.name,styles:i.styles,next:Pa},i.name;var a=n;if(a.styles!==void 0){var h=a.next;if(h!==void 0)for(;h!==void 0;)Pa={name:h.name,styles:h.styles,next:Pa},h=h.next;var l=a.styles+";";return l}return iX(t,e,n)}case"function":{if(t!==void 0){var m=Pa,_=n(t);return Pa=m,Tm(t,e,_)}break}}var S=n;if(e==null)return S;var P=e[S];return P!==void 0?P:S}function iX(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Tm(t,e,n[i])+";";else for(var a in n){var h=n[a];if(typeof h!="object"){var l=h;e!=null&&e[l]!==void 0?r+=a+"{"+e[l]+"}":CI(l)&&(r+=Zb(a)+":"+AI(a,l)+";")}else{if(a==="NO_COMPONENT_SELECTOR"&&eX)throw new Error(rX);if(Array.isArray(h)&&typeof h[0]=="string"&&(e==null||e[h[0]]===void 0))for(var m=0;m<h.length;m++)CI(h[m])&&(r+=Zb(a)+":"+AI(a,h[m])+";");else{var _=Tm(t,e,h);switch(a){case"animation":case"animationName":{r+=Zb(a)+":"+_+";";break}default:r+=a+"{"+_+"}"}}}}return r}var II=/label:\s*([^\s;{]+)\s*(;|$)/g,Pa;function N2(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,i="";Pa=void 0;var a=t[0];if(a==null||a.raw===void 0)r=!1,i+=Tm(n,e,a);else{var h=a;i+=h[0]}for(var l=1;l<t.length;l++)if(i+=Tm(n,e,t[l]),r){var m=a;i+=m[l]}II.lastIndex=0;for(var _="",S;(S=II.exec(i))!==null;)_+="-"+S[1];var P=JZ(i)+_;return{name:P,styles:i,next:Pa}}var sX=function(e){return e()},HO=c1["useInsertionEffect"]?c1["useInsertionEffect"]:!1,oX=HO||sX,kI=HO||Z.useLayoutEffect,qO=Z.createContext(typeof HTMLElement<"u"?NO({key:"css"}):null),aX=qO.Provider,ZO=function(e){return Z.forwardRef(function(n,r){var i=Z.useContext(qO);return e(n,i,r)})},Xm=Z.createContext({}),Xb={exports:{}},MI;function XO(){return MI||(MI=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var a in i)({}).hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Xb)),Xb.exports}XO();var lX=ZO(function(t,e){var n=t.styles,r=N2([n],void 0,Z.useContext(Xm)),i=Z.useRef();return kI(function(){var a=e.key+"-global",h=new e.sheet.constructor({key:a,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),l=!1,m=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return e.sheet.tags.length&&(h.before=e.sheet.tags[0]),m!==null&&(l=!0,m.setAttribute("data-emotion",a),h.hydrate([m])),i.current=[h,l],function(){h.flush()}},[e]),kI(function(){var a=i.current,h=a[0],l=a[1];if(l){a[1]=!1;return}if(r.next!==void 0&&GO(e,r.next,!0),h.tags.length){var m=h.tags[h.tags.length-1].nextElementSibling;h.before=m,h.flush()}e.insert("",r,h,!1)},[e,r.name]),null});function lv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N2(e)}var Hd=function(){var e=lv.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},cX=dZ,uX=function(e){return e!=="theme"},LI=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?cX:uX},RI=function(e,n,r){var i;if(n){var a=n.shouldForwardProp;i=e.__emotion_forwardProp&&a?function(h){return e.__emotion_forwardProp(h)&&a(h)}:a}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},hX=!1,dX=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return $O(n,r,i),oX(function(){return GO(n,r,i)}),null},fX=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,a,h;n!==void 0&&(a=n.label,h=n.target);var l=RI(e,n,r),m=l||LI(i),_=!m("as");return function(){var S=arguments,P=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(a!==void 0&&P.push("label:"+a+";"),S[0]==null||S[0].raw===void 0)P.push.apply(P,S);else{P.push(S[0][0]);for(var A=S.length,L=1;L<A;L++)P.push(S[L],S[0][L])}var O=ZO(function(D,W,z){var N=_&&D.as||i,F="",$=[],Q=D;if(D.theme==null){Q={};for(var te in D)Q[te]=D[te];Q.theme=Z.useContext(Xm)}typeof D.className=="string"?F=KZ(W.registered,$,D.className):D.className!=null&&(F=D.className+" ");var ie=N2(P.concat($),W.registered,Q);F+=W.key+"-"+ie.name,h!==void 0&&(F+=" "+h);var xe=_&&l===void 0?LI(N):m,Te={};for(var _e in D)_&&_e==="as"||xe(_e)&&(Te[_e]=D[_e]);return Te.className=F,z&&(Te.ref=z),Z.createElement(Z.Fragment,null,Z.createElement(dX,{cache:W,serialized:ie,isStringTag:typeof N=="string"}),Z.createElement(N,Te))});return O.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",O.defaultProps=e.defaultProps,O.__emotion_real=O,O.__emotion_base=i,O.__emotion_styles=P,O.__emotion_forwardProp=l,Object.defineProperty(O,"toString",{value:function(){return h===void 0&&hX?"NO_COMPONENT_SELECTOR":"."+h}}),O.withComponent=function(D,W){return t(D,se({},n,W,{shouldForwardProp:RI(O,W,!0)})).apply(void 0,P)},O}},pX=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],jw=fX.bind();pX.forEach(function(t){jw[t]=jw(t)});let Vw;typeof document=="object"&&(Vw=NO({key:"css",prepend:!0}));function mX(t){const{injectFirst:e,children:n}=t;return e&&Vw?ue.jsx(aX,{value:Vw,children:n}):n}function gX(t){return t==null||Object.keys(t).length===0}function YO(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?i=>e(gX(i)?n:i):e;return ue.jsx(lX,{styles:r})}/**
 * @mui/styled-engine v5.16.8
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function KO(t,e){return jw(t,e)}const yX=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},_X=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:YO,StyledEngineProvider:mX,ThemeContext:Xm,css:lv,default:KO,internal_processStyles:yX,keyframes:Hd},Symbol.toStringTag,{value:"Module"}));function rc(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function JO(t){if(Z.isValidElement(t)||!rc(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=JO(t[n])}),e}function oo(t,e,n={clone:!0}){const r=n.clone?se({},t):t;return rc(t)&&rc(e)&&Object.keys(e).forEach(i=>{Z.isValidElement(e[i])?r[i]=e[i]:rc(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&rc(t[i])?r[i]=oo(t[i],e[i],n):n.clone?r[i]=rc(e[i])?JO(e[i]):e[i]:r[i]=e[i]}),r}const vX=Object.freeze(Object.defineProperty({__proto__:null,default:oo,isPlainObject:rc},Symbol.toStringTag,{value:"Module"})),xX=["values","unit","step"],bX=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>se({},n,{[r.key]:r.val}),{})};function QO(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=Yt(t,xX),a=bX(e),h=Object.keys(a);function l(A){return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${n})`}function m(A){return`@media (max-width:${(typeof e[A]=="number"?e[A]:A)-r/100}${n})`}function _(A,L){const O=h.indexOf(L);return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${n}) and (max-width:${(O!==-1&&typeof e[h[O]]=="number"?e[h[O]]:L)-r/100}${n})`}function S(A){return h.indexOf(A)+1<h.length?_(A,h[h.indexOf(A)+1]):l(A)}function P(A){const L=h.indexOf(A);return L===0?l(h[1]):L===h.length-1?m(h[L]):_(A,h[h.indexOf(A)+1]).replace("@media","@media not all and")}return se({keys:h,values:a,up:l,down:m,between:_,only:S,not:P,unit:n},i)}const wX={borderRadius:4},SX=wX;function Vp(t,e){return e?oo(t,e,{clone:!1}):t}const B2={xs:0,sm:600,md:900,lg:1200,xl:1536},OI={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${B2[t]}px)`};function vl(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const a=r.breakpoints||OI;return e.reduce((h,l,m)=>(h[a.up(a.keys[m])]=n(e[m]),h),{})}if(typeof e=="object"){const a=r.breakpoints||OI;return Object.keys(e).reduce((h,l)=>{if(Object.keys(a.values||B2).indexOf(l)!==-1){const m=a.up(l);h[m]=n(e[l],l)}else{const m=l;h[m]=e[m]}return h},{})}return n(e)}function TX(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const a=t.up(i);return r[a]={},r},{}))||{}}function EX(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function Wt(t){if(typeof t!="string")throw new Error(_l(7));return t.charAt(0).toUpperCase()+t.slice(1)}const PX=Object.freeze(Object.defineProperty({__proto__:null,default:Wt},Symbol.toStringTag,{value:"Module"}));function cv(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function d_(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=cv(t,n)||r,e&&(i=e(i,r,t)),i}function ai(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,a=h=>{if(h[e]==null)return null;const l=h[e],m=h.theme,_=cv(m,r)||{};return vl(h,l,P=>{let A=d_(_,i,P);return P===A&&typeof P=="string"&&(A=d_(_,i,`${e}${P==="default"?"":Wt(P)}`,P)),n===!1?A:{[n]:A}})};return a.propTypes={},a.filterProps=[e],a}function CX(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const AX={m:"margin",p:"padding"},IX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},zI={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},kX=CX(t=>{if(t.length>2)if(zI[t])t=zI[t];else return[t];const[e,n]=t.split(""),r=AX[e],i=IX[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),j2=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],V2=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...j2,...V2];function Ym(t,e,n,r){var i;const a=(i=cv(t,e,!1))!=null?i:n;return typeof a=="number"?h=>typeof h=="string"?h:a*h:Array.isArray(a)?h=>typeof h=="string"?h:a[h]:typeof a=="function"?a:()=>{}}function ez(t){return Ym(t,"spacing",8)}function Km(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function MX(t,e){return n=>t.reduce((r,i)=>(r[i]=Km(e,n),r),{})}function LX(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=kX(n),a=MX(i,r),h=t[n];return vl(t,h,a)}function tz(t,e){const n=ez(t.theme);return Object.keys(t).map(r=>LX(t,e,r,n)).reduce(Vp,{})}function Hr(t){return tz(t,j2)}Hr.propTypes={};Hr.filterProps=j2;function qr(t){return tz(t,V2)}qr.propTypes={};qr.filterProps=V2;function RX(t=8){if(t.mui)return t;const e=ez({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(a=>{const h=e(a);return typeof h=="number"?`${h}px`:h}).join(" ");return n.mui=!0,n}function uv(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>e[a]?Vp(i,e[a](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Io(t){return typeof t!="number"?t:`${t}px solid`}function jo(t,e){return ai({prop:t,themeKey:"borders",transform:e})}const OX=jo("border",Io),zX=jo("borderTop",Io),DX=jo("borderRight",Io),FX=jo("borderBottom",Io),NX=jo("borderLeft",Io),BX=jo("borderColor"),jX=jo("borderTopColor"),VX=jo("borderRightColor"),UX=jo("borderBottomColor"),$X=jo("borderLeftColor"),GX=jo("outline",Io),WX=jo("outlineColor"),hv=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Ym(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Km(e,r)});return vl(t,t.borderRadius,n)}return null};hv.propTypes={};hv.filterProps=["borderRadius"];uv(OX,zX,DX,FX,NX,BX,jX,VX,UX,$X,hv,GX,WX);const dv=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Ym(t.theme,"spacing",8),n=r=>({gap:Km(e,r)});return vl(t,t.gap,n)}return null};dv.propTypes={};dv.filterProps=["gap"];const fv=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Ym(t.theme,"spacing",8),n=r=>({columnGap:Km(e,r)});return vl(t,t.columnGap,n)}return null};fv.propTypes={};fv.filterProps=["columnGap"];const pv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Ym(t.theme,"spacing",8),n=r=>({rowGap:Km(e,r)});return vl(t,t.rowGap,n)}return null};pv.propTypes={};pv.filterProps=["rowGap"];const HX=ai({prop:"gridColumn"}),qX=ai({prop:"gridRow"}),ZX=ai({prop:"gridAutoFlow"}),XX=ai({prop:"gridAutoColumns"}),YX=ai({prop:"gridAutoRows"}),KX=ai({prop:"gridTemplateColumns"}),JX=ai({prop:"gridTemplateRows"}),QX=ai({prop:"gridTemplateAreas"}),eY=ai({prop:"gridArea"});uv(dv,fv,pv,HX,qX,ZX,XX,YX,KX,JX,QX,eY);function hd(t,e){return e==="grey"?e:t}const tY=ai({prop:"color",themeKey:"palette",transform:hd}),nY=ai({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:hd}),rY=ai({prop:"backgroundColor",themeKey:"palette",transform:hd});uv(tY,nY,rY);function eo(t){return t<=1&&t!==0?`${t*100}%`:t}const iY=ai({prop:"width",transform:eo}),U2=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i;const a=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||B2[n];return a?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${a}${t.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:eo(n)}};return vl(t,t.maxWidth,e)}return null};U2.filterProps=["maxWidth"];const sY=ai({prop:"minWidth",transform:eo}),oY=ai({prop:"height",transform:eo}),aY=ai({prop:"maxHeight",transform:eo}),lY=ai({prop:"minHeight",transform:eo});ai({prop:"size",cssProperty:"width",transform:eo});ai({prop:"size",cssProperty:"height",transform:eo});const cY=ai({prop:"boxSizing"});uv(iY,U2,sY,oY,aY,lY,cY);const uY={border:{themeKey:"borders",transform:Io},borderTop:{themeKey:"borders",transform:Io},borderRight:{themeKey:"borders",transform:Io},borderBottom:{themeKey:"borders",transform:Io},borderLeft:{themeKey:"borders",transform:Io},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Io},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:hv},color:{themeKey:"palette",transform:hd},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:hd},backgroundColor:{themeKey:"palette",transform:hd},p:{style:qr},pt:{style:qr},pr:{style:qr},pb:{style:qr},pl:{style:qr},px:{style:qr},py:{style:qr},padding:{style:qr},paddingTop:{style:qr},paddingRight:{style:qr},paddingBottom:{style:qr},paddingLeft:{style:qr},paddingX:{style:qr},paddingY:{style:qr},paddingInline:{style:qr},paddingInlineStart:{style:qr},paddingInlineEnd:{style:qr},paddingBlock:{style:qr},paddingBlockStart:{style:qr},paddingBlockEnd:{style:qr},m:{style:Hr},mt:{style:Hr},mr:{style:Hr},mb:{style:Hr},ml:{style:Hr},mx:{style:Hr},my:{style:Hr},margin:{style:Hr},marginTop:{style:Hr},marginRight:{style:Hr},marginBottom:{style:Hr},marginLeft:{style:Hr},marginX:{style:Hr},marginY:{style:Hr},marginInline:{style:Hr},marginInlineStart:{style:Hr},marginInlineEnd:{style:Hr},marginBlock:{style:Hr},marginBlockStart:{style:Hr},marginBlockEnd:{style:Hr},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:dv},rowGap:{style:pv},columnGap:{style:fv},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:eo},maxWidth:{style:U2},minWidth:{transform:eo},height:{transform:eo},maxHeight:{transform:eo},minHeight:{transform:eo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},Jm=uY;function hY(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function dY(t,e){return typeof t=="function"?t(e):t}function nz(){function t(n,r,i,a){const h={[n]:r,theme:i},l=a[n];if(!l)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:S,style:P}=l;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const A=cv(i,_)||{};return P?P(h):vl(h,r,O=>{let D=d_(A,S,O);return O===D&&typeof O=="string"&&(D=d_(A,S,`${n}${O==="default"?"":Wt(O)}`,O)),m===!1?D:{[m]:D}})}function e(n){var r;const{sx:i,theme:a={}}=n||{};if(!i)return null;const h=(r=a.unstable_sxConfig)!=null?r:Jm;function l(m){let _=m;if(typeof m=="function")_=m(a);else if(typeof m!="object")return m;if(!_)return null;const S=TX(a.breakpoints),P=Object.keys(S);let A=S;return Object.keys(_).forEach(L=>{const O=dY(_[L],a);if(O!=null)if(typeof O=="object")if(h[L])A=Vp(A,t(L,O,a,h));else{const D=vl({theme:a},O,W=>({[L]:W}));hY(D,O)?A[L]=e({sx:O,theme:a}):A=Vp(A,D)}else A=Vp(A,t(L,O,a,h))}),EX(P,A)}return Array.isArray(i)?i.map(l):l(i)}return e}const rz=nz();rz.filterProps=["sx"];const mv=rz;function iz(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const fY=["breakpoints","palette","spacing","shape"];function $2(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:a={}}=t,h=Yt(t,fY),l=QO(n),m=RX(i);let _=oo({breakpoints:l,direction:"ltr",components:{},palette:se({mode:"light"},r),spacing:m,shape:se({},SX,a)},h);return _.applyStyles=iz,_=e.reduce((S,P)=>oo(S,P),_),_.unstable_sxConfig=se({},Jm,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(P){return mv({sx:P,theme:this})},_}const pY=Object.freeze(Object.defineProperty({__proto__:null,default:$2,private_createBreakpoints:QO,unstable_applyStyles:iz},Symbol.toStringTag,{value:"Module"}));function mY(t){return Object.keys(t).length===0}function sz(t=null){const e=Z.useContext(Xm);return!e||mY(e)?t:e}const gY=$2();function G2(t=gY){return sz(t)}function yY({styles:t,themeId:e,defaultTheme:n={}}){const r=G2(n),i=typeof t=="function"?t(e&&r[e]||r):t;return ue.jsx(YO,{styles:i})}const _Y=["sx"],vY=t=>{var e,n;const r={systemProps:{},otherProps:{}},i=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:Jm;return Object.keys(t).forEach(a=>{i[a]?r.systemProps[a]=t[a]:r.otherProps[a]=t[a]}),r};function W2(t){const{sx:e}=t,n=Yt(t,_Y),{systemProps:r,otherProps:i}=vY(n);let a;return Array.isArray(e)?a=[r,...e]:typeof e=="function"?a=(...h)=>{const l=e(...h);return rc(l)?se({},r,l):r}:a=se({},r,e),se({},i,{sx:a})}const xY=Object.freeze(Object.defineProperty({__proto__:null,default:mv,extendSxProp:W2,unstable_createStyleFunctionSx:nz,unstable_defaultSxConfig:Jm},Symbol.toStringTag,{value:"Module"})),DI=t=>t,bY=()=>{let t=DI;return{configure(e){t=e},generate(e){return t(e)},reset(){t=DI}}},wY=bY(),oz=wY;function az(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=az(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function fn(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=az(t))&&(r&&(r+=" "),r+=e);return r}const SY=["className","component"];function TY(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,a=KO("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(mv);return Z.forwardRef(function(m,_){const S=G2(n),P=W2(m),{className:A,component:L="div"}=P,O=Yt(P,SY);return ue.jsx(a,se({as:L,ref:_,className:fn(A,i?i(r):r),theme:e&&S[e]||S},O))})}const EY={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function $n(t,e,n="Mui"){const r=EY[e];return r?`${n}-${r}`:`${oz.generate(t)}-${e}`}function Fn(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=$n(t,i,n)}),r}var lz={exports:{}},rr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H2=Symbol.for("react.element"),q2=Symbol.for("react.portal"),gv=Symbol.for("react.fragment"),yv=Symbol.for("react.strict_mode"),_v=Symbol.for("react.profiler"),vv=Symbol.for("react.provider"),xv=Symbol.for("react.context"),PY=Symbol.for("react.server_context"),bv=Symbol.for("react.forward_ref"),wv=Symbol.for("react.suspense"),Sv=Symbol.for("react.suspense_list"),Tv=Symbol.for("react.memo"),Ev=Symbol.for("react.lazy"),CY=Symbol.for("react.offscreen"),cz;cz=Symbol.for("react.module.reference");function Vo(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case H2:switch(t=t.type,t){case gv:case _v:case yv:case wv:case Sv:return t;default:switch(t=t&&t.$$typeof,t){case PY:case xv:case bv:case Ev:case Tv:case vv:return t;default:return e}}case q2:return e}}}rr.ContextConsumer=xv;rr.ContextProvider=vv;rr.Element=H2;rr.ForwardRef=bv;rr.Fragment=gv;rr.Lazy=Ev;rr.Memo=Tv;rr.Portal=q2;rr.Profiler=_v;rr.StrictMode=yv;rr.Suspense=wv;rr.SuspenseList=Sv;rr.isAsyncMode=function(){return!1};rr.isConcurrentMode=function(){return!1};rr.isContextConsumer=function(t){return Vo(t)===xv};rr.isContextProvider=function(t){return Vo(t)===vv};rr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===H2};rr.isForwardRef=function(t){return Vo(t)===bv};rr.isFragment=function(t){return Vo(t)===gv};rr.isLazy=function(t){return Vo(t)===Ev};rr.isMemo=function(t){return Vo(t)===Tv};rr.isPortal=function(t){return Vo(t)===q2};rr.isProfiler=function(t){return Vo(t)===_v};rr.isStrictMode=function(t){return Vo(t)===yv};rr.isSuspense=function(t){return Vo(t)===wv};rr.isSuspenseList=function(t){return Vo(t)===Sv};rr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===gv||t===_v||t===yv||t===wv||t===Sv||t===CY||typeof t=="object"&&t!==null&&(t.$$typeof===Ev||t.$$typeof===Tv||t.$$typeof===vv||t.$$typeof===xv||t.$$typeof===bv||t.$$typeof===cz||t.getModuleId!==void 0)};rr.typeOf=Vo;lz.exports=rr;var FI=lz.exports;const AY=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function uz(t){const e=`${t}`.match(AY);return e&&e[1]||""}function hz(t,e=""){return t.displayName||t.name||uz(t)||e}function NI(t,e,n){const r=hz(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function IY(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return hz(t,"Component");if(typeof t=="object")switch(t.$$typeof){case FI.ForwardRef:return NI(t,t.render,"ForwardRef");case FI.Memo:return NI(t,t.type,"memo");default:return}}}const kY=Object.freeze(Object.defineProperty({__proto__:null,default:IY,getFunctionName:uz},Symbol.toStringTag,{value:"Module"}));function f_(t,e){const n=se({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=se({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},a=e[r];n[r]={},!a||!Object.keys(a)?n[r]=i:!i||!Object.keys(i)?n[r]=a:(n[r]=se({},a),Object.keys(i).forEach(h=>{n[r][h]=f_(i[h],a[h])}))}else n[r]===void 0&&(n[r]=t[r])}),n}const MY=typeof window<"u"?Z.useLayoutEffect:Z.useEffect,da=MY;function cu(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const LY=Object.freeze(Object.defineProperty({__proto__:null,default:cu},Symbol.toStringTag,{value:"Module"}));function RY(t,e=0,n=1){return cu(t,e,n)}function OY(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function dz(t){if(t.type)return t;if(t.charAt(0)==="#")return dz(OY(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(_l(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(_l(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}function zY(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,a)=>a<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function BI(t,e){return t=dz(t),e=RY(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,zY(t)}function jI(...t){return t.reduce((e,n)=>n==null?e:function(...i){e.apply(this,i),n.apply(this,i)},()=>{})}function Z2(t,e=166){let n;function r(...i){const a=()=>{t.apply(this,i)};clearTimeout(n),n=setTimeout(a,e)}return r.clear=()=>{clearTimeout(n)},r}function Yb(t,e){var n,r;return Z.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Xr(t){return t&&t.ownerDocument||document}function xl(t){return Xr(t).defaultView||window}function Uw(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let VI=0;function DY(t){const[e,n]=Z.useState(t),r=t||e;return Z.useEffect(()=>{e==null&&(VI+=1,n(`mui-${VI}`))},[e]),r}const UI=c1["useId".toString()];function X2(t){if(UI!==void 0){const e=UI();return t??e}return DY(t)}function p_({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=Z.useRef(t!==void 0),[a,h]=Z.useState(e),l=i?t:a,m=Z.useCallback(_=>{i||h(_)},[]);return[l,m]}function zs(t){const e=Z.useRef(t);return da(()=>{e.current=t}),Z.useRef((...n)=>(0,e.current)(...n)).current}function jr(...t){return Z.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Uw(n,e)})},t)}const $I={};function FY(t,e){const n=Z.useRef($I);return n.current===$I&&(n.current=t(e)),n}const NY=[];function BY(t){Z.useEffect(t,NY)}class Qm{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Qm}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function pu(){const t=FY(Qm.create).current;return BY(t.disposeEffect),t}let Pv=!0,$w=!1;const jY=new Qm,VY={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function UY(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&VY[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function $Y(t){t.metaKey||t.altKey||t.ctrlKey||(Pv=!0)}function Kb(){Pv=!1}function GY(){this.visibilityState==="hidden"&&$w&&(Pv=!0)}function WY(t){t.addEventListener("keydown",$Y,!0),t.addEventListener("mousedown",Kb,!0),t.addEventListener("pointerdown",Kb,!0),t.addEventListener("touchstart",Kb,!0),t.addEventListener("visibilitychange",GY,!0)}function HY(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return Pv||UY(e)}function Y2(){const t=Z.useCallback(i=>{i!=null&&WY(i.ownerDocument)},[]),e=Z.useRef(!1);function n(){return e.current?($w=!0,jY.start(100,()=>{$w=!1}),e.current=!1,!0):!1}function r(i){return HY(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function fz(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const qY={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},ZY=qY;function qn(t,e,n=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((a,h)=>{if(h){const l=e(h);l!==""&&a.push(l),n&&n[h]&&a.push(n[h])}return a},[]).join(" ")}),r}function bc(t){return typeof t=="string"}function ed(t,e,n){return t===void 0||bc(t)?e:se({},e,{ownerState:se({},e.ownerState,n)})}function xu(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function GI(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function pz(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:a}=t;if(!e){const L=fn(n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),O=se({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),D=se({},n,i,r);return L.length>0&&(D.className=L),Object.keys(O).length>0&&(D.style=O),{props:D,internalRef:void 0}}const h=xu(se({},i,r)),l=GI(r),m=GI(i),_=e(h),S=fn(_==null?void 0:_.className,n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),P=se({},_==null?void 0:_.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),A=se({},_,n,m,l);return S.length>0&&(A.className=S),Object.keys(P).length>0&&(A.style=P),{props:A,internalRef:_.ref}}function mz(t,e,n){return typeof t=="function"?t(e,n):t}const XY=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function is(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:a=!1}=t,h=Yt(t,XY),l=a?{}:mz(r,i),{props:m,internalRef:_}=pz(se({},h,{externalSlotProps:l})),S=jr(_,l==null?void 0:l.ref,(e=t.additionalProps)==null?void 0:e.ref);return ed(n,se({},m,{ref:S}),i)}function Ic(t){if(parseInt(Z.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return(t==null?void 0:t.ref)||null}const YY=Z.createContext(null),gz=YY;function yz(){return Z.useContext(gz)}const KY=typeof Symbol=="function"&&Symbol.for,JY=KY?Symbol.for("mui.nested"):"__THEME_NESTED__";function QY(t,e){return typeof e=="function"?e(t):se({},t,e)}function eK(t){const{children:e,theme:n}=t,r=yz(),i=Z.useMemo(()=>{const a=r===null?n:QY(r,n);return a!=null&&(a[JY]=r!==null),a},[n,r]);return ue.jsx(gz.Provider,{value:i,children:e})}const tK=["value"],_z=Z.createContext();function nK(t){let{value:e}=t,n=Yt(t,tK);return ue.jsx(_z.Provider,se({value:e??!0},n))}const Cv=()=>{const t=Z.useContext(_z);return t??!1},vz=Z.createContext(void 0);function rK({value:t,children:e}){return ue.jsx(vz.Provider,{value:t,children:e})}function iK(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const i=e.components[n];return i.defaultProps?f_(i.defaultProps,r):!i.styleOverrides&&!i.variants?f_(i,r):r}function sK({props:t,name:e}){const n=Z.useContext(vz);return iK({props:t,name:e,theme:{components:n}})}const WI={};function HI(t,e,n,r=!1){return Z.useMemo(()=>{const i=t&&e[t]||e;if(typeof n=="function"){const a=n(i),h=t?se({},e,{[t]:a}):a;return r?()=>h:h}return t?se({},e,{[t]:n}):se({},e,n)},[t,e,n,r])}function oK(t){const{children:e,theme:n,themeId:r}=t,i=sz(WI),a=yz()||WI,h=HI(r,i,n),l=HI(r,a,n,!0),m=h.direction==="rtl";return ue.jsx(eK,{theme:l,children:ue.jsx(Xm.Provider,{value:h,children:ue.jsx(nK,{value:m,children:ue.jsx(rK,{value:h==null?void 0:h.components,children:e})})})})}function aK(t,e){return se({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var li={},xz={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(xz);var bz=xz.exports;const lK=Ec(uZ),cK=Ec(LY);var wz=bz;Object.defineProperty(li,"__esModule",{value:!0});var as=li.alpha=Pz;li.blend=bK;li.colorChannel=void 0;var Em=li.darken=J2;li.decomposeColor=Fo;var uK=li.emphasize=Cz,hK=li.getContrastRatio=gK;li.getLuminance=m_;li.hexToRgb=Sz;li.hslToRgb=Ez;var Pm=li.lighten=Q2;li.private_safeAlpha=yK;li.private_safeColorChannel=void 0;li.private_safeDarken=_K;li.private_safeEmphasize=xK;li.private_safeLighten=vK;li.recomposeColor=qd;li.rgbToHex=mK;var qI=wz(lK),dK=wz(cK);function K2(t,e=0,n=1){return(0,dK.default)(t,e,n)}function Sz(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function fK(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function Fo(t){if(t.type)return t;if(t.charAt(0)==="#")return Fo(Sz(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,qI.default)(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error((0,qI.default)(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const Tz=t=>{const e=Fo(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};li.colorChannel=Tz;const pK=(t,e)=>{try{return Tz(t)}catch{return t}};li.private_safeColorChannel=pK;function qd(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,a)=>a<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function mK(t){if(t.indexOf("#")===0)return t;const{values:e}=Fo(t);return`#${e.map((n,r)=>fK(r===3?Math.round(255*n):n)).join("")}`}function Ez(t){t=Fo(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,a=r*Math.min(i,1-i),h=(_,S=(_+n/30)%12)=>i-a*Math.max(Math.min(S-3,9-S,1),-1);let l="rgb";const m=[Math.round(h(0)*255),Math.round(h(8)*255),Math.round(h(4)*255)];return t.type==="hsla"&&(l+="a",m.push(e[3])),qd({type:l,values:m})}function m_(t){t=Fo(t);let e=t.type==="hsl"||t.type==="hsla"?Fo(Ez(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function gK(t,e){const n=m_(t),r=m_(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Pz(t,e){return t=Fo(t),e=K2(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,qd(t)}function yK(t,e,n){try{return Pz(t,e)}catch{return t}}function J2(t,e){if(t=Fo(t),e=K2(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return qd(t)}function _K(t,e,n){try{return J2(t,e)}catch{return t}}function Q2(t,e){if(t=Fo(t),e=K2(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return qd(t)}function vK(t,e,n){try{return Q2(t,e)}catch{return t}}function Cz(t,e=.15){return m_(t)>.5?J2(t,e):Q2(t,e)}function xK(t,e,n){try{return Cz(t,e)}catch{return t}}function bK(t,e,n,r=1){const i=(m,_)=>Math.round((m**(1/r)*(1-n)+_**(1/r)*n)**r),a=Fo(t),h=Fo(e),l=[i(a.values[0],h.values[0]),i(a.values[1],h.values[1]),i(a.values[2],h.values[2])];return qd({type:"rgb",values:l})}const wK=["mode","contrastThreshold","tonalOffset"],ZI={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:bm.white,default:bm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Jb={text:{primary:bm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:bm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function XI(t,e,n,r){const i=r.light||r,a=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=Pm(t.main,i):e==="dark"&&(t.dark=Em(t.main,a)))}function SK(t="light"){return t==="dark"?{main:Mh[200],light:Mh[50],dark:Mh[400]}:{main:Mh[700],light:Mh[400],dark:Mh[800]}}function TK(t="light"){return t==="dark"?{main:kh[200],light:kh[50],dark:kh[400]}:{main:kh[500],light:kh[300],dark:kh[700]}}function EK(t="light"){return t==="dark"?{main:Ih[500],light:Ih[300],dark:Ih[700]}:{main:Ih[700],light:Ih[400],dark:Ih[800]}}function PK(t="light"){return t==="dark"?{main:Lh[400],light:Lh[300],dark:Lh[700]}:{main:Lh[700],light:Lh[500],dark:Lh[900]}}function CK(t="light"){return t==="dark"?{main:Rh[400],light:Rh[300],dark:Rh[700]}:{main:Rh[800],light:Rh[500],dark:Rh[900]}}function AK(t="light"){return t==="dark"?{main:dp[400],light:dp[300],dark:dp[700]}:{main:"#ed6c02",light:dp[500],dark:dp[900]}}function IK(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=Yt(t,wK),a=t.primary||SK(e),h=t.secondary||TK(e),l=t.error||EK(e),m=t.info||PK(e),_=t.success||CK(e),S=t.warning||AK(e);function P(D){return hK(D,Jb.text.primary)>=n?Jb.text.primary:ZI.text.primary}const A=({color:D,name:W,mainShade:z=500,lightShade:N=300,darkShade:F=700})=>{if(D=se({},D),!D.main&&D[z]&&(D.main=D[z]),!D.hasOwnProperty("main"))throw new Error(_l(11,W?` (${W})`:"",z));if(typeof D.main!="string")throw new Error(_l(12,W?` (${W})`:"",JSON.stringify(D.main)));return XI(D,"light",N,r),XI(D,"dark",F,r),D.contrastText||(D.contrastText=P(D.main)),D},L={dark:Jb,light:ZI};return oo(se({common:se({},bm),mode:e,primary:A({color:a,name:"primary"}),secondary:A({color:h,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:A({color:l,name:"error"}),warning:A({color:S,name:"warning"}),info:A({color:m,name:"info"}),success:A({color:_,name:"success"}),grey:cZ,contrastThreshold:n,getContrastText:P,augmentColor:A,tonalOffset:r},L[e]),i)}const kK=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function MK(t){return Math.round(t*1e5)/1e5}const YI={textTransform:"uppercase"},KI='"Roboto", "Helvetica", "Arial", sans-serif';function LK(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=KI,fontSize:i=14,fontWeightLight:a=300,fontWeightRegular:h=400,fontWeightMedium:l=500,fontWeightBold:m=700,htmlFontSize:_=16,allVariants:S,pxToRem:P}=n,A=Yt(n,kK),L=i/14,O=P||(z=>`${z/_*L}rem`),D=(z,N,F,$,Q)=>se({fontFamily:r,fontWeight:z,fontSize:O(N),lineHeight:F},r===KI?{letterSpacing:`${MK($/N)}em`}:{},Q,S),W={h1:D(a,96,1.167,-1.5),h2:D(a,60,1.2,-.5),h3:D(h,48,1.167,0),h4:D(h,34,1.235,.25),h5:D(h,24,1.334,0),h6:D(l,20,1.6,.15),subtitle1:D(h,16,1.75,.15),subtitle2:D(l,14,1.57,.1),body1:D(h,16,1.5,.15),body2:D(h,14,1.43,.15),button:D(l,14,1.75,.4,YI),caption:D(h,12,1.66,.4),overline:D(h,12,2.66,1,YI),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return oo(se({htmlFontSize:_,pxToRem:O,fontFamily:r,fontSize:i,fontWeightLight:a,fontWeightRegular:h,fontWeightMedium:l,fontWeightBold:m},W),A,{clone:!1})}const RK=.2,OK=.14,zK=.12;function Mr(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${RK})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${OK})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${zK})`].join(",")}const DK=["none",Mr(0,2,1,-1,0,1,1,0,0,1,3,0),Mr(0,3,1,-2,0,2,2,0,0,1,5,0),Mr(0,3,3,-2,0,3,4,0,0,1,8,0),Mr(0,2,4,-1,0,4,5,0,0,1,10,0),Mr(0,3,5,-1,0,5,8,0,0,1,14,0),Mr(0,3,5,-1,0,6,10,0,0,1,18,0),Mr(0,4,5,-2,0,7,10,1,0,2,16,1),Mr(0,5,5,-3,0,8,10,1,0,3,14,2),Mr(0,5,6,-3,0,9,12,1,0,3,16,2),Mr(0,6,6,-3,0,10,14,1,0,4,18,3),Mr(0,6,7,-4,0,11,15,1,0,4,20,3),Mr(0,7,8,-4,0,12,17,2,0,5,22,4),Mr(0,7,8,-4,0,13,19,2,0,5,24,4),Mr(0,7,9,-4,0,14,21,2,0,5,26,4),Mr(0,8,9,-5,0,15,22,2,0,6,28,5),Mr(0,8,10,-5,0,16,24,2,0,6,30,5),Mr(0,8,11,-5,0,17,26,2,0,6,32,5),Mr(0,9,11,-5,0,18,28,2,0,7,34,6),Mr(0,9,12,-6,0,19,29,2,0,7,36,6),Mr(0,10,13,-6,0,20,31,3,0,8,38,7),Mr(0,10,13,-6,0,21,33,3,0,8,40,7),Mr(0,10,14,-6,0,22,35,3,0,8,42,7),Mr(0,11,14,-7,0,23,36,3,0,9,44,8),Mr(0,11,15,-7,0,24,38,3,0,9,46,8)],FK=DK,NK=["duration","easing","delay"],BK={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},jK={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function JI(t){return`${Math.round(t)}ms`}function VK(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function UK(t){const e=se({},BK,t.easing),n=se({},jK,t.duration);return se({getAutoHeightDuration:VK,create:(i=["all"],a={})=>{const{duration:h=n.standard,easing:l=e.easeInOut,delay:m=0}=a;return Yt(a,NK),(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof h=="string"?h:JI(h)} ${l} ${typeof m=="string"?m:JI(m)}`).join(",")}},t,{easing:e,duration:n})}const $K={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},GK=$K,WK=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function eT(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:a={}}=t,h=Yt(t,WK);if(t.vars)throw new Error(_l(18));const l=IK(r),m=$2(t);let _=oo(m,{mixins:aK(m.breakpoints,n),palette:l,shadows:FK.slice(),typography:LK(l,a),transitions:UK(i),zIndex:se({},GK)});return _=oo(_,h),_=e.reduce((S,P)=>oo(S,P),_),_.unstable_sxConfig=se({},Jm,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(P){return mv({sx:P,theme:this})},_}const HK=eT(),tT=HK;function Zd(){const t=G2(tT);return t[Rd]||t}var eg={},Qb={exports:{}},QI;function qK(){return QI||(QI=1,function(t){function e(n,r){if(n==null)return{};var i={};for(var a in n)if({}.hasOwnProperty.call(n,a)){if(r.includes(a))continue;i[a]=n[a]}return i}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Qb)),Qb.exports}const Az=Ec(_X),ZK=Ec(vX),XK=Ec(PX),YK=Ec(kY),KK=Ec(pY),JK=Ec(xY);var Xd=bz;Object.defineProperty(eg,"__esModule",{value:!0});var QK=eg.default=dJ;eg.shouldForwardProp=T0;eg.systemDefaultTheme=void 0;var To=Xd(XO()),Gw=Xd(qK()),ek=oJ(Az),eJ=ZK;Xd(XK);Xd(YK);var tJ=Xd(KK),nJ=Xd(JK);const rJ=["ownerState"],iJ=["variants"],sJ=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Iz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Iz=function(r){return r?n:e})(t)}function oJ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Iz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var h=i?Object.getOwnPropertyDescriptor(t,a):null;h&&(h.get||h.set)?Object.defineProperty(r,a,h):r[a]=t[a]}return r.default=t,n&&n.set(t,r),r}function aJ(t){return Object.keys(t).length===0}function lJ(t){return typeof t=="string"&&t.charCodeAt(0)>96}function T0(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const cJ=eg.systemDefaultTheme=(0,tJ.default)(),uJ=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function jy({defaultTheme:t,theme:e,themeId:n}){return aJ(e)?t:e[n]||e}function hJ(t){return t?(e,n)=>n[t]:null}function E0(t,e){let{ownerState:n}=e,r=(0,Gw.default)(e,rJ);const i=typeof t=="function"?t((0,To.default)({ownerState:n},r)):t;if(Array.isArray(i))return i.flatMap(a=>E0(a,(0,To.default)({ownerState:n},r)));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let l=(0,Gw.default)(i,iJ);return a.forEach(m=>{let _=!0;typeof m.props=="function"?_=m.props((0,To.default)({ownerState:n},r,n)):Object.keys(m.props).forEach(S=>{(n==null?void 0:n[S])!==m.props[S]&&r[S]!==m.props[S]&&(_=!1)}),_&&(Array.isArray(l)||(l=[l]),l.push(typeof m.style=="function"?m.style((0,To.default)({ownerState:n},r,n)):m.style))}),l}return i}function dJ(t={}){const{themeId:e,defaultTheme:n=cJ,rootShouldForwardProp:r=T0,slotShouldForwardProp:i=T0}=t,a=h=>(0,nJ.default)((0,To.default)({},h,{theme:jy((0,To.default)({},h,{defaultTheme:n,themeId:e}))}));return a.__mui_systemSx=!0,(h,l={})=>{(0,ek.internal_processStyles)(h,Q=>Q.filter(te=>!(te!=null&&te.__mui_systemSx)));const{name:m,slot:_,skipVariantsResolver:S,skipSx:P,overridesResolver:A=hJ(uJ(_))}=l,L=(0,Gw.default)(l,sJ),O=S!==void 0?S:_&&_!=="Root"&&_!=="root"||!1,D=P||!1;let W,z=T0;_==="Root"||_==="root"?z=r:_?z=i:lJ(h)&&(z=void 0);const N=(0,ek.default)(h,(0,To.default)({shouldForwardProp:z,label:W},L)),F=Q=>typeof Q=="function"&&Q.__emotion_real!==Q||(0,eJ.isPlainObject)(Q)?te=>E0(Q,(0,To.default)({},te,{theme:jy({theme:te.theme,defaultTheme:n,themeId:e})})):Q,$=(Q,...te)=>{let ie=F(Q);const xe=te?te.map(F):[];m&&A&&xe.push(Re=>{const Ne=jy((0,To.default)({},Re,{defaultTheme:n,themeId:e}));if(!Ne.components||!Ne.components[m]||!Ne.components[m].styleOverrides)return null;const Ve=Ne.components[m].styleOverrides,je={};return Object.entries(Ve).forEach(([Ge,Ze])=>{je[Ge]=E0(Ze,(0,To.default)({},Re,{theme:Ne}))}),A(Re,je)}),m&&!O&&xe.push(Re=>{var Ne;const Ve=jy((0,To.default)({},Re,{defaultTheme:n,themeId:e})),je=Ve==null||(Ne=Ve.components)==null||(Ne=Ne[m])==null?void 0:Ne.variants;return E0({variants:je},(0,To.default)({},Re,{theme:Ve}))}),D||xe.push(a);const Te=xe.length-te.length;if(Array.isArray(Q)&&Te>0){const Re=new Array(Te).fill("");ie=[...Q,...Re],ie.raw=[...Q.raw,...Re]}const _e=N(ie,...xe);return h.muiName&&(_e.muiName=h.muiName),_e};return N.withConfig&&($.withConfig=N.withConfig),$}}function Av(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const fJ=t=>Av(t)&&t!=="classes",fo=fJ,pJ=QK({themeId:Rd,defaultTheme:tT,rootShouldForwardProp:fo}),Ct=pJ,mJ=["theme"];function gJ(t){let{theme:e}=t,n=Yt(t,mJ);const r=e[Rd];return ue.jsx(oK,se({},n,{themeId:r?Rd:void 0,theme:r||e}))}const yJ=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},tk=yJ;function Gn(t){return sK(t)}function _J(t){return $n("MuiSvgIcon",t)}Fn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const vJ=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],xJ=t=>{const{color:e,fontSize:n,classes:r}=t,i={root:["root",e!=="inherit"&&`color${Wt(e)}`,`fontSize${Wt(n)}`]};return qn(i,_J,r)},bJ=Ct("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${Wt(n.color)}`],e[`fontSize${Wt(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,i,a,h,l,m,_,S,P,A,L,O;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(i=t.transitions)==null||(i=i.duration)==null?void 0:i.shorter}),fontSize:{inherit:"inherit",small:((a=t.typography)==null||(h=a.pxToRem)==null?void 0:h.call(a,20))||"1.25rem",medium:((l=t.typography)==null||(m=l.pxToRem)==null?void 0:m.call(l,24))||"1.5rem",large:((_=t.typography)==null||(S=_.pxToRem)==null?void 0:S.call(_,35))||"2.1875rem"}[e.fontSize],color:(P=(A=(t.vars||t).palette)==null||(A=A[e.color])==null?void 0:A.main)!=null?P:{action:(L=(t.vars||t).palette)==null||(L=L.action)==null?void 0:L.active,disabled:(O=(t.vars||t).palette)==null||(O=O.action)==null?void 0:O.disabled,inherit:void 0}[e.color]}}),kz=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSvgIcon"}),{children:i,className:a,color:h="inherit",component:l="svg",fontSize:m="medium",htmlColor:_,inheritViewBox:S=!1,titleAccess:P,viewBox:A="0 0 24 24"}=r,L=Yt(r,vJ),O=Z.isValidElement(i)&&i.type==="svg",D=se({},r,{color:h,component:l,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:S,viewBox:A,hasSvgAsChild:O}),W={};S||(W.viewBox=A);const z=xJ(D);return ue.jsxs(bJ,se({as:l,className:fn(z.root,a),focusable:"false",color:_,"aria-hidden":P?void 0:!0,role:P?"img":void 0,ref:n},W,L,O&&i.props,{ownerState:D,children:[O?i.props.children:i,P?ue.jsx("title",{children:P}):null]}))});kz.muiName="SvgIcon";const nk=kz;function Na(t,e){function n(r,i){return ue.jsx(nk,se({"data-testid":`${e}Icon`,ref:i},r,{children:t}))}return n.muiName=nk.muiName,Z.memo(Z.forwardRef(n))}function Ww(t,e){return Ww=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ww(t,e)}function Mz(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Ww(t,e)}const rk={disabled:!1},g_=cr.createContext(null);var wJ=function(e){return e.scrollTop},Ap="unmounted",ou="exited",au="entering",Nh="entered",Hw="exiting",El=function(t){Mz(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=i,l=h&&!h.isMounting?r.enter:r.appear,m;return a.appearStatus=null,r.in?l?(m=ou,a.appearStatus=au):m=Nh:r.unmountOnExit||r.mountOnEnter?m=Ap:m=ou,a.state={status:m},a.nextCallback=null,a}e.getDerivedStateFromProps=function(i,a){var h=i.in;return h&&a.status===Ap?{status:ou}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var a=null;if(i!==this.props){var h=this.state.status;this.props.in?h!==au&&h!==Nh&&(a=au):(h===au||h===Nh)&&(a=Hw)}this.updateStatus(!1,a)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,a,h,l;return a=h=l=i,i!=null&&typeof i!="number"&&(a=i.exit,h=i.enter,l=i.appear!==void 0?i.appear:h),{exit:a,enter:h,appear:l}},n.updateStatus=function(i,a){if(i===void 0&&(i=!1),a!==null)if(this.cancelNextCallback(),a===au){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:wy.findDOMNode(this);h&&wJ(h)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ou&&this.setState({status:Ap})},n.performEnter=function(i){var a=this,h=this.props.enter,l=this.context?this.context.isMounting:i,m=this.props.nodeRef?[l]:[wy.findDOMNode(this),l],_=m[0],S=m[1],P=this.getTimeouts(),A=l?P.appear:P.enter;if(!i&&!h||rk.disabled){this.safeSetState({status:Nh},function(){a.props.onEntered(_)});return}this.props.onEnter(_,S),this.safeSetState({status:au},function(){a.props.onEntering(_,S),a.onTransitionEnd(A,function(){a.safeSetState({status:Nh},function(){a.props.onEntered(_,S)})})})},n.performExit=function(){var i=this,a=this.props.exit,h=this.getTimeouts(),l=this.props.nodeRef?void 0:wy.findDOMNode(this);if(!a||rk.disabled){this.safeSetState({status:ou},function(){i.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:Hw},function(){i.props.onExiting(l),i.onTransitionEnd(h.exit,function(){i.safeSetState({status:ou},function(){i.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,a){a=this.setNextCallback(a),this.setState(i,a)},n.setNextCallback=function(i){var a=this,h=!0;return this.nextCallback=function(l){h&&(h=!1,a.nextCallback=null,i(l))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},n.onTransitionEnd=function(i,a){this.setNextCallback(a);var h=this.props.nodeRef?this.props.nodeRef.current:wy.findDOMNode(this),l=i==null&&!this.props.addEndListener;if(!h||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],_=m[0],S=m[1];this.props.addEndListener(_,S)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===Ap)return null;var a=this.props,h=a.children;a.in,a.mountOnEnter,a.unmountOnExit,a.appear,a.enter,a.exit,a.timeout,a.addEndListener,a.onEnter,a.onEntering,a.onEntered,a.onExit,a.onExiting,a.onExited,a.nodeRef;var l=Yt(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return cr.createElement(g_.Provider,{value:null},typeof h=="function"?h(i,l):cr.cloneElement(cr.Children.only(h),l))},e}(cr.Component);El.contextType=g_;El.propTypes={};function Oh(){}El.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Oh,onEntering:Oh,onEntered:Oh,onExit:Oh,onExiting:Oh,onExited:Oh};El.UNMOUNTED=Ap;El.EXITED=ou;El.ENTERING=au;El.ENTERED=Nh;El.EXITING=Hw;const nT=El;function SJ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rT(t,e){var n=function(a){return e&&Z.isValidElement(a)?e(a):a},r=Object.create(null);return t&&Z.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function TJ(t,e){t=t||{},e=e||{};function n(S){return S in e?e[S]:t[S]}var r=Object.create(null),i=[];for(var a in t)a in e?i.length&&(r[a]=i,i=[]):i.push(a);var h,l={};for(var m in e){if(r[m])for(h=0;h<r[m].length;h++){var _=r[m][h];l[r[m][h]]=n(_)}l[m]=n(m)}for(h=0;h<i.length;h++)l[i[h]]=n(i[h]);return l}function mu(t,e,n){return n[e]!=null?n[e]:t.props[e]}function EJ(t,e){return rT(t.children,function(n){return Z.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:mu(n,"appear",t),enter:mu(n,"enter",t),exit:mu(n,"exit",t)})})}function PJ(t,e,n){var r=rT(t.children),i=TJ(e,r);return Object.keys(i).forEach(function(a){var h=i[a];if(Z.isValidElement(h)){var l=a in e,m=a in r,_=e[a],S=Z.isValidElement(_)&&!_.props.in;m&&(!l||S)?i[a]=Z.cloneElement(h,{onExited:n.bind(null,h),in:!0,exit:mu(h,"exit",t),enter:mu(h,"enter",t)}):!m&&l&&!S?i[a]=Z.cloneElement(h,{in:!1}):m&&l&&Z.isValidElement(_)&&(i[a]=Z.cloneElement(h,{onExited:n.bind(null,h),in:_.props.in,exit:mu(h,"exit",t),enter:mu(h,"enter",t)}))}}),i}var CJ=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},AJ={component:"div",childFactory:function(e){return e}},iT=function(t){Mz(e,t);function e(r,i){var a;a=t.call(this,r,i)||this;var h=a.handleExited.bind(SJ(a));return a.state={contextValue:{isMounting:!0},handleExited:h,firstRender:!0},a}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,a){var h=a.children,l=a.handleExited,m=a.firstRender;return{children:m?EJ(i,l):PJ(i,h,l),firstRender:!1}},n.handleExited=function(i,a){var h=rT(this.props.children);i.key in h||(i.props.onExited&&i.props.onExited(a),this.mounted&&this.setState(function(l){var m=se({},l.children);return delete m[i.key],{children:m}}))},n.render=function(){var i=this.props,a=i.component,h=i.childFactory,l=Yt(i,["component","childFactory"]),m=this.state.contextValue,_=CJ(this.state.children).map(h);return delete l.appear,delete l.enter,delete l.exit,a===null?cr.createElement(g_.Provider,{value:m},_):cr.createElement(g_.Provider,{value:m},cr.createElement(a,l,_))},e}(cr.Component);iT.propTypes={};iT.defaultProps=AJ;const IJ=iT,sT=t=>t.scrollTop;function zd(t,e){var n,r;const{timeout:i,easing:a,style:h={}}=t;return{duration:(n=h.transitionDuration)!=null?n:typeof i=="number"?i:i[e.mode]||0,easing:(r=h.transitionTimingFunction)!=null?r:typeof a=="object"?a[e.mode]:a,delay:h.transitionDelay}}function kJ(t){return $n("MuiPaper",t)}Fn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const MJ=["className","component","elevation","square","variant"],LJ=t=>{const{square:e,elevation:n,variant:r,classes:i}=t,a={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return qn(a,kJ,i)},RJ=Ct("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return se({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&se({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${as("#fff",tk(e.elevation))}, ${as("#fff",tk(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),OJ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiPaper"}),{className:i,component:a="div",elevation:h=1,square:l=!1,variant:m="elevation"}=r,_=Yt(r,MJ),S=se({},r,{component:a,elevation:h,square:l,variant:m}),P=LJ(S);return ue.jsx(RJ,se({as:a,ownerState:S,className:fn(P.root,i),ref:n},_))}),Iv=OJ,zJ=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],DJ=["component","slots","slotProps"],FJ=["component"];function ik(t,e){const{className:n,elementType:r,ownerState:i,externalForwardedProps:a,getSlotOwnerState:h,internalForwardedProps:l}=e,m=Yt(e,zJ),{component:_,slots:S={[t]:void 0},slotProps:P={[t]:void 0}}=a,A=Yt(a,DJ),L=S[t]||r,O=mz(P[t],i),D=pz(se({className:n},m,{externalForwardedProps:t==="root"?A:void 0,externalSlotProps:O})),{props:{component:W},internalRef:z}=D,N=Yt(D.props,FJ),F=jr(z,O==null?void 0:O.ref,e.ref),$=h?h(N):{},Q=se({},i,$),te=t==="root"?W||_:W,ie=ed(L,se({},t==="root"&&!_&&!S[t]&&l,t!=="root"&&!S[t]&&l,N,te&&{as:te},{ref:F}),Q);return Object.keys($).forEach(xe=>{delete ie[xe]}),[L,ie]}function NJ(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:a,rippleSize:h,in:l,onExited:m,timeout:_}=t,[S,P]=Z.useState(!1),A=fn(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),L={width:h,height:h,top:-(h/2)+a,left:-(h/2)+i},O=fn(n.child,S&&n.childLeaving,r&&n.childPulsate);return!l&&!S&&P(!0),Z.useEffect(()=>{if(!l&&m!=null){const D=setTimeout(m,_);return()=>{clearTimeout(D)}}},[m,l,_]),ue.jsx("span",{className:A,style:L,children:ue.jsx("span",{className:O})})}const BJ=Fn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Po=BJ,jJ=["center","classes","className"];let kv=t=>t,sk,ok,ak,lk;const qw=550,VJ=80,UJ=Hd(sk||(sk=kv`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),$J=Hd(ok||(ok=kv`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),GJ=Hd(ak||(ak=kv`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),WJ=Ct("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),HJ=Ct(NJ,{name:"MuiTouchRipple",slot:"Ripple"})(lk||(lk=kv`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Po.rippleVisible,UJ,qw,({theme:t})=>t.transitions.easing.easeInOut,Po.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Po.child,Po.childLeaving,$J,qw,({theme:t})=>t.transitions.easing.easeInOut,Po.childPulsate,GJ,({theme:t})=>t.transitions.easing.easeInOut),qJ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:a={},className:h}=r,l=Yt(r,jJ),[m,_]=Z.useState([]),S=Z.useRef(0),P=Z.useRef(null);Z.useEffect(()=>{P.current&&(P.current(),P.current=null)},[m]);const A=Z.useRef(!1),L=pu(),O=Z.useRef(null),D=Z.useRef(null),W=Z.useCallback($=>{const{pulsate:Q,rippleX:te,rippleY:ie,rippleSize:xe,cb:Te}=$;_(_e=>[..._e,ue.jsx(HJ,{classes:{ripple:fn(a.ripple,Po.ripple),rippleVisible:fn(a.rippleVisible,Po.rippleVisible),ripplePulsate:fn(a.ripplePulsate,Po.ripplePulsate),child:fn(a.child,Po.child),childLeaving:fn(a.childLeaving,Po.childLeaving),childPulsate:fn(a.childPulsate,Po.childPulsate)},timeout:qw,pulsate:Q,rippleX:te,rippleY:ie,rippleSize:xe},S.current)]),S.current+=1,P.current=Te},[a]),z=Z.useCallback(($={},Q={},te=()=>{})=>{const{pulsate:ie=!1,center:xe=i||Q.pulsate,fakeElement:Te=!1}=Q;if(($==null?void 0:$.type)==="mousedown"&&A.current){A.current=!1;return}($==null?void 0:$.type)==="touchstart"&&(A.current=!0);const _e=Te?null:D.current,Re=_e?_e.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ne,Ve,je;if(xe||$===void 0||$.clientX===0&&$.clientY===0||!$.clientX&&!$.touches)Ne=Math.round(Re.width/2),Ve=Math.round(Re.height/2);else{const{clientX:Ge,clientY:Ze}=$.touches&&$.touches.length>0?$.touches[0]:$;Ne=Math.round(Ge-Re.left),Ve=Math.round(Ze-Re.top)}if(xe)je=Math.sqrt((2*Re.width**2+Re.height**2)/3),je%2===0&&(je+=1);else{const Ge=Math.max(Math.abs((_e?_e.clientWidth:0)-Ne),Ne)*2+2,Ze=Math.max(Math.abs((_e?_e.clientHeight:0)-Ve),Ve)*2+2;je=Math.sqrt(Ge**2+Ze**2)}$!=null&&$.touches?O.current===null&&(O.current=()=>{W({pulsate:ie,rippleX:Ne,rippleY:Ve,rippleSize:je,cb:te})},L.start(VJ,()=>{O.current&&(O.current(),O.current=null)})):W({pulsate:ie,rippleX:Ne,rippleY:Ve,rippleSize:je,cb:te})},[i,W,L]),N=Z.useCallback(()=>{z({},{pulsate:!0})},[z]),F=Z.useCallback(($,Q)=>{if(L.clear(),($==null?void 0:$.type)==="touchend"&&O.current){O.current(),O.current=null,L.start(0,()=>{F($,Q)});return}O.current=null,_(te=>te.length>0?te.slice(1):te),P.current=Q},[L]);return Z.useImperativeHandle(n,()=>({pulsate:N,start:z,stop:F}),[N,z,F]),ue.jsx(WJ,se({className:fn(Po.root,a.root,h),ref:D},l,{children:ue.jsx(IJ,{component:null,exit:!0,children:m})}))}),ZJ=qJ;function XJ(t){return $n("MuiButtonBase",t)}const YJ=Fn("MuiButtonBase",["root","disabled","focusVisible"]),KJ=YJ,JJ=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],QJ=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,h=qn({root:["root",e&&"disabled",n&&"focusVisible"]},XJ,i);return n&&r&&(h.root+=` ${r}`),h},eQ=Ct("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${KJ.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),tQ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:a=!1,children:h,className:l,component:m="button",disabled:_=!1,disableRipple:S=!1,disableTouchRipple:P=!1,focusRipple:A=!1,LinkComponent:L="a",onBlur:O,onClick:D,onContextMenu:W,onDragLeave:z,onFocus:N,onFocusVisible:F,onKeyDown:$,onKeyUp:Q,onMouseDown:te,onMouseLeave:ie,onMouseUp:xe,onTouchEnd:Te,onTouchMove:_e,onTouchStart:Re,tabIndex:Ne=0,TouchRippleProps:Ve,touchRippleRef:je,type:Ge}=r,Ze=Yt(r,JJ),Ye=Z.useRef(null),Ce=Z.useRef(null),qe=jr(Ce,je),{isFocusVisibleRef:st,onFocus:Vt,onBlur:_t,ref:ht}=Y2(),[at,Qe]=Z.useState(!1);_&&at&&Qe(!1),Z.useImperativeHandle(i,()=>({focusVisible:()=>{Qe(!0),Ye.current.focus()}}),[]);const[xt,Ht]=Z.useState(!1);Z.useEffect(()=>{Ht(!0)},[]);const qt=xt&&!S&&!_;Z.useEffect(()=>{at&&A&&!S&&xt&&Ce.current.pulsate()},[S,A,at,xt]);function Et(Xe,yt,un=P){return zs($e=>(yt&&yt($e),!un&&Ce.current&&Ce.current[Xe]($e),!0))}const ln=Et("start",te),Qt=Et("stop",W),mn=Et("stop",z),Ut=Et("stop",xe),At=Et("stop",Xe=>{at&&Xe.preventDefault(),ie&&ie(Xe)}),Lt=Et("start",Re),yn=Et("stop",Te),vn=Et("stop",_e),ut=Et("stop",Xe=>{_t(Xe),st.current===!1&&Qe(!1),O&&O(Xe)},!1),cn=zs(Xe=>{Ye.current||(Ye.current=Xe.currentTarget),Vt(Xe),st.current===!0&&(Qe(!0),F&&F(Xe)),N&&N(Xe)}),Ae=()=>{const Xe=Ye.current;return m&&m!=="button"&&!(Xe.tagName==="A"&&Xe.href)},Tt=Z.useRef(!1),bn=zs(Xe=>{A&&!Tt.current&&at&&Ce.current&&Xe.key===" "&&(Tt.current=!0,Ce.current.stop(Xe,()=>{Ce.current.start(Xe)})),Xe.target===Xe.currentTarget&&Ae()&&Xe.key===" "&&Xe.preventDefault(),$&&$(Xe),Xe.target===Xe.currentTarget&&Ae()&&Xe.key==="Enter"&&!_&&(Xe.preventDefault(),D&&D(Xe))}),Xt=zs(Xe=>{A&&Xe.key===" "&&Ce.current&&at&&!Xe.defaultPrevented&&(Tt.current=!1,Ce.current.stop(Xe,()=>{Ce.current.pulsate(Xe)})),Q&&Q(Xe),D&&Xe.target===Xe.currentTarget&&Ae()&&Xe.key===" "&&!Xe.defaultPrevented&&D(Xe)});let It=m;It==="button"&&(Ze.href||Ze.to)&&(It=L);const Mn={};It==="button"?(Mn.type=Ge===void 0?"button":Ge,Mn.disabled=_):(!Ze.href&&!Ze.to&&(Mn.role="button"),_&&(Mn["aria-disabled"]=_));const Bn=jr(n,ht,Ye),On=se({},r,{centerRipple:a,component:m,disabled:_,disableRipple:S,disableTouchRipple:P,focusRipple:A,tabIndex:Ne,focusVisible:at}),et=QJ(On);return ue.jsxs(eQ,se({as:It,className:fn(et.root,l),ownerState:On,onBlur:ut,onClick:D,onContextMenu:Qt,onFocus:cn,onKeyDown:bn,onKeyUp:Xt,onMouseDown:ln,onMouseLeave:At,onMouseUp:Ut,onDragLeave:mn,onTouchEnd:yn,onTouchMove:vn,onTouchStart:Lt,ref:Bn,tabIndex:_?-1:Ne,type:Ge},Mn,Ze,{children:[h,qt?ue.jsx(ZJ,se({ref:qe,center:a},Ve)):null]}))}),oT=tQ;function nQ(t){return $n("MuiAlert",t)}const rQ=Fn("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),ck=rQ;function iQ(t){return $n("MuiIconButton",t)}const sQ=Fn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),oQ=sQ,aQ=["edge","children","className","color","disabled","disableFocusRipple","size"],lQ=t=>{const{classes:e,disabled:n,color:r,edge:i,size:a}=t,h={root:["root",n&&"disabled",r!=="default"&&`color${Wt(r)}`,i&&`edge${Wt(i)}`,`size${Wt(a)}`]};return qn(h,iQ,e)},cQ=Ct(oT,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${Wt(n.color)}`],n.edge&&e[`edge${Wt(n.edge)}`],e[`size${Wt(n.size)}`]]}})(({theme:t,ownerState:e})=>se({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return se({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&se({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":se({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${oQ.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),uQ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiIconButton"}),{edge:i=!1,children:a,className:h,color:l="default",disabled:m=!1,disableFocusRipple:_=!1,size:S="medium"}=r,P=Yt(r,aQ),A=se({},r,{edge:i,color:l,disabled:m,disableFocusRipple:_,size:S}),L=lQ(A);return ue.jsx(cQ,se({className:fn(L.root,h),centerRipple:!0,focusRipple:!_,disabled:m,ref:n},P,{ownerState:A,children:a}))}),rl=uQ,hQ=Na(ue.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),dQ=Na(ue.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),fQ=Na(ue.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),pQ=Na(ue.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),mQ=Na(ue.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),gQ=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],yQ=t=>{const{variant:e,color:n,severity:r,classes:i}=t,a={root:["root",`color${Wt(n||r)}`,`${e}${Wt(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return qn(a,nQ,i)},_Q=Ct(Iv,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Wt(n.color||n.severity)}`]]}})(({theme:t})=>{const e=t.palette.mode==="light"?Em:Pm,n=t.palette.mode==="light"?Pm:Em;return se({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${r}StandardBg`]:n(t.palette[r].light,.9),[`& .${ck.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),border:`1px solid ${(t.vars||t).palette[r].light}`,[`& .${ck.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:se({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${r}FilledColor`],backgroundColor:t.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[r].dark:t.palette[r].main,color:t.palette.getContrastText(t.palette[r].main)})}))]})}),vQ=Ct("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),xQ=Ct("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),uk=Ct("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),hk={success:ue.jsx(hQ,{fontSize:"inherit"}),warning:ue.jsx(dQ,{fontSize:"inherit"}),error:ue.jsx(fQ,{fontSize:"inherit"}),info:ue.jsx(pQ,{fontSize:"inherit"})},bQ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiAlert"}),{action:i,children:a,className:h,closeText:l="Close",color:m,components:_={},componentsProps:S={},icon:P,iconMapping:A=hk,onClose:L,role:O="alert",severity:D="success",slotProps:W={},slots:z={},variant:N="standard"}=r,F=Yt(r,gQ),$=se({},r,{color:m,severity:D,variant:N,colorSeverity:m||D}),Q=yQ($),te={slots:se({closeButton:_.CloseButton,closeIcon:_.CloseIcon},z),slotProps:se({},S,W)},[ie,xe]=ik("closeButton",{elementType:rl,externalForwardedProps:te,ownerState:$}),[Te,_e]=ik("closeIcon",{elementType:mQ,externalForwardedProps:te,ownerState:$});return ue.jsxs(_Q,se({role:O,elevation:0,ownerState:$,className:fn(Q.root,h),ref:n},F,{children:[P!==!1?ue.jsx(vQ,{ownerState:$,className:Q.icon,children:P||A[D]||hk[D]}):null,ue.jsx(xQ,{ownerState:$,className:Q.message,children:a}),i!=null?ue.jsx(uk,{ownerState:$,className:Q.action,children:i}):null,i==null&&L?ue.jsx(uk,{ownerState:$,className:Q.action,children:ue.jsx(ie,se({size:"small","aria-label":l,title:l,color:"inherit",onClick:L},xe,{children:ue.jsx(Te,se({fontSize:"small"},_e))}))}):null]}))}),wQ=bQ;function SQ(t){return $n("MuiTypography",t)}Fn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const TQ=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],EQ=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:i,variant:a,classes:h}=t,l={root:["root",a,t.align!=="inherit"&&`align${Wt(e)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]};return qn(l,SQ,h)},PQ=Ct("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${Wt(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>se({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),dk={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},CQ={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},AQ=t=>CQ[t]||t,IQ=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTypography"}),i=AQ(r.color),a=W2(se({},r,{color:i})),{align:h="inherit",className:l,component:m,gutterBottom:_=!1,noWrap:S=!1,paragraph:P=!1,variant:A="body1",variantMapping:L=dk}=a,O=Yt(a,TQ),D=se({},a,{align:h,color:i,className:l,component:m,gutterBottom:_,noWrap:S,paragraph:P,variant:A,variantMapping:L}),W=m||(P?"p":L[A]||dk[A])||"span",z=EQ(D);return ue.jsx(PQ,se({as:W,ref:n,ownerState:D,className:fn(z.root,l)},O))}),xs=IQ;var aT={};Object.defineProperty(aT,"__esModule",{value:!0});var Lz=aT.default=void 0,kQ=LQ(Z),MQ=Az;function Rz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Rz=function(r){return r?n:e})(t)}function LQ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Rz(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var h=i?Object.getOwnPropertyDescriptor(t,a):null;h&&(h.get||h.set)?Object.defineProperty(r,a,h):r[a]=t[a]}return r.default=t,n&&n.set(t,r),r}function RQ(t){return Object.keys(t).length===0}function OQ(t=null){const e=kQ.useContext(MQ.ThemeContext);return!e||RQ(e)?t:e}Lz=aT.default=OQ;var Bs="top",No="bottom",Bo="right",js="left",lT="auto",tg=[Bs,No,Bo,js],Dd="start",Cm="end",zQ="clippingParents",Oz="viewport",pp="popper",DQ="reference",fk=tg.reduce(function(t,e){return t.concat([e+"-"+Dd,e+"-"+Cm])},[]),zz=[].concat(tg,[lT]).reduce(function(t,e){return t.concat([e,e+"-"+Dd,e+"-"+Cm])},[]),FQ="beforeRead",NQ="read",BQ="afterRead",jQ="beforeMain",VQ="main",UQ="afterMain",$Q="beforeWrite",GQ="write",WQ="afterWrite",HQ=[FQ,NQ,BQ,jQ,VQ,UQ,$Q,GQ,WQ];function Fa(t){return t?(t.nodeName||"").toLowerCase():null}function lo(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ku(t){var e=lo(t).Element;return t instanceof e||t instanceof Element}function Oo(t){var e=lo(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function cT(t){if(typeof ShadowRoot>"u")return!1;var e=lo(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function qQ(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},a=e.elements[n];!Oo(a)||!Fa(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(h){var l=i[h];l===!1?a.removeAttribute(h):a.setAttribute(h,l===!0?"":l)}))})}function ZQ(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},h=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=h.reduce(function(m,_){return m[_]="",m},{});!Oo(i)||!Fa(i)||(Object.assign(i.style,l),Object.keys(a).forEach(function(m){i.removeAttribute(m)}))})}}const XQ={name:"applyStyles",enabled:!0,phase:"write",fn:qQ,effect:ZQ,requires:["computeStyles"]};function Oa(t){return t.split("-")[0]}var bu=Math.max,y_=Math.min,Fd=Math.round;function Zw(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Dz(){return!/^((?!chrome|android).)*safari/i.test(Zw())}function Nd(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,a=1;e&&Oo(t)&&(i=t.offsetWidth>0&&Fd(r.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Fd(r.height)/t.offsetHeight||1);var h=ku(t)?lo(t):window,l=h.visualViewport,m=!Dz()&&n,_=(r.left+(m&&l?l.offsetLeft:0))/i,S=(r.top+(m&&l?l.offsetTop:0))/a,P=r.width/i,A=r.height/a;return{width:P,height:A,top:S,right:_+P,bottom:S+A,left:_,x:_,y:S}}function uT(t){var e=Nd(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Fz(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&cT(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function bl(t){return lo(t).getComputedStyle(t)}function YQ(t){return["table","td","th"].indexOf(Fa(t))>=0}function kc(t){return((ku(t)?t.ownerDocument:t.document)||window.document).documentElement}function Mv(t){return Fa(t)==="html"?t:t.assignedSlot||t.parentNode||(cT(t)?t.host:null)||kc(t)}function pk(t){return!Oo(t)||bl(t).position==="fixed"?null:t.offsetParent}function KQ(t){var e=/firefox/i.test(Zw()),n=/Trident/i.test(Zw());if(n&&Oo(t)){var r=bl(t);if(r.position==="fixed")return null}var i=Mv(t);for(cT(i)&&(i=i.host);Oo(i)&&["html","body"].indexOf(Fa(i))<0;){var a=bl(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function ng(t){for(var e=lo(t),n=pk(t);n&&YQ(n)&&bl(n).position==="static";)n=pk(n);return n&&(Fa(n)==="html"||Fa(n)==="body"&&bl(n).position==="static")?e:n||KQ(t)||e}function hT(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Up(t,e,n){return bu(t,y_(e,n))}function JQ(t,e,n){var r=Up(t,e,n);return r>n?n:r}function Nz(){return{top:0,right:0,bottom:0,left:0}}function Bz(t){return Object.assign({},Nz(),t)}function jz(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var QQ=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,Bz(typeof e!="number"?e:jz(e,tg))};function eee(t){var e,n=t.state,r=t.name,i=t.options,a=n.elements.arrow,h=n.modifiersData.popperOffsets,l=Oa(n.placement),m=hT(l),_=[js,Bo].indexOf(l)>=0,S=_?"height":"width";if(!(!a||!h)){var P=QQ(i.padding,n),A=uT(a),L=m==="y"?Bs:js,O=m==="y"?No:Bo,D=n.rects.reference[S]+n.rects.reference[m]-h[m]-n.rects.popper[S],W=h[m]-n.rects.reference[m],z=ng(a),N=z?m==="y"?z.clientHeight||0:z.clientWidth||0:0,F=D/2-W/2,$=P[L],Q=N-A[S]-P[O],te=N/2-A[S]/2+F,ie=Up($,te,Q),xe=m;n.modifiersData[r]=(e={},e[xe]=ie,e.centerOffset=ie-te,e)}}function tee(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Fz(e.elements.popper,i)&&(e.elements.arrow=i))}const nee={name:"arrow",enabled:!0,phase:"main",fn:eee,effect:tee,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bd(t){return t.split("-")[1]}var ree={top:"auto",right:"auto",bottom:"auto",left:"auto"};function iee(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Fd(n*i)/i||0,y:Fd(r*i)/i||0}}function mk(t){var e,n=t.popper,r=t.popperRect,i=t.placement,a=t.variation,h=t.offsets,l=t.position,m=t.gpuAcceleration,_=t.adaptive,S=t.roundOffsets,P=t.isFixed,A=h.x,L=A===void 0?0:A,O=h.y,D=O===void 0?0:O,W=typeof S=="function"?S({x:L,y:D}):{x:L,y:D};L=W.x,D=W.y;var z=h.hasOwnProperty("x"),N=h.hasOwnProperty("y"),F=js,$=Bs,Q=window;if(_){var te=ng(n),ie="clientHeight",xe="clientWidth";if(te===lo(n)&&(te=kc(n),bl(te).position!=="static"&&l==="absolute"&&(ie="scrollHeight",xe="scrollWidth")),te=te,i===Bs||(i===js||i===Bo)&&a===Cm){$=No;var Te=P&&te===Q&&Q.visualViewport?Q.visualViewport.height:te[ie];D-=Te-r.height,D*=m?1:-1}if(i===js||(i===Bs||i===No)&&a===Cm){F=Bo;var _e=P&&te===Q&&Q.visualViewport?Q.visualViewport.width:te[xe];L-=_e-r.width,L*=m?1:-1}}var Re=Object.assign({position:l},_&&ree),Ne=S===!0?iee({x:L,y:D},lo(n)):{x:L,y:D};if(L=Ne.x,D=Ne.y,m){var Ve;return Object.assign({},Re,(Ve={},Ve[$]=N?"0":"",Ve[F]=z?"0":"",Ve.transform=(Q.devicePixelRatio||1)<=1?"translate("+L+"px, "+D+"px)":"translate3d("+L+"px, "+D+"px, 0)",Ve))}return Object.assign({},Re,(e={},e[$]=N?D+"px":"",e[F]=z?L+"px":"",e.transform="",e))}function see(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,h=a===void 0?!0:a,l=n.roundOffsets,m=l===void 0?!0:l,_={placement:Oa(e.placement),variation:Bd(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,mk(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,mk(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const oee={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:see,data:{}};var Vy={passive:!0};function aee(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,a=i===void 0?!0:i,h=r.resize,l=h===void 0?!0:h,m=lo(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&_.forEach(function(S){S.addEventListener("scroll",n.update,Vy)}),l&&m.addEventListener("resize",n.update,Vy),function(){a&&_.forEach(function(S){S.removeEventListener("scroll",n.update,Vy)}),l&&m.removeEventListener("resize",n.update,Vy)}}const lee={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:aee,data:{}};var cee={left:"right",right:"left",bottom:"top",top:"bottom"};function P0(t){return t.replace(/left|right|bottom|top/g,function(e){return cee[e]})}var uee={start:"end",end:"start"};function gk(t){return t.replace(/start|end/g,function(e){return uee[e]})}function dT(t){var e=lo(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function fT(t){return Nd(kc(t)).left+dT(t).scrollLeft}function hee(t,e){var n=lo(t),r=kc(t),i=n.visualViewport,a=r.clientWidth,h=r.clientHeight,l=0,m=0;if(i){a=i.width,h=i.height;var _=Dz();(_||!_&&e==="fixed")&&(l=i.offsetLeft,m=i.offsetTop)}return{width:a,height:h,x:l+fT(t),y:m}}function dee(t){var e,n=kc(t),r=dT(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=bu(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),h=bu(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+fT(t),m=-r.scrollTop;return bl(i||n).direction==="rtl"&&(l+=bu(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:h,x:l,y:m}}function pT(t){var e=bl(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Vz(t){return["html","body","#document"].indexOf(Fa(t))>=0?t.ownerDocument.body:Oo(t)&&pT(t)?t:Vz(Mv(t))}function $p(t,e){var n;e===void 0&&(e=[]);var r=Vz(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),a=lo(r),h=i?[a].concat(a.visualViewport||[],pT(r)?r:[]):r,l=e.concat(h);return i?l:l.concat($p(Mv(h)))}function Xw(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function fee(t,e){var n=Nd(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function yk(t,e,n){return e===Oz?Xw(hee(t,n)):ku(e)?fee(e,n):Xw(dee(kc(t)))}function pee(t){var e=$p(Mv(t)),n=["absolute","fixed"].indexOf(bl(t).position)>=0,r=n&&Oo(t)?ng(t):t;return ku(r)?e.filter(function(i){return ku(i)&&Fz(i,r)&&Fa(i)!=="body"}):[]}function mee(t,e,n,r){var i=e==="clippingParents"?pee(t):[].concat(e),a=[].concat(i,[n]),h=a[0],l=a.reduce(function(m,_){var S=yk(t,_,r);return m.top=bu(S.top,m.top),m.right=y_(S.right,m.right),m.bottom=y_(S.bottom,m.bottom),m.left=bu(S.left,m.left),m},yk(t,h,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Uz(t){var e=t.reference,n=t.element,r=t.placement,i=r?Oa(r):null,a=r?Bd(r):null,h=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,m;switch(i){case Bs:m={x:h,y:e.y-n.height};break;case No:m={x:h,y:e.y+e.height};break;case Bo:m={x:e.x+e.width,y:l};break;case js:m={x:e.x-n.width,y:l};break;default:m={x:e.x,y:e.y}}var _=i?hT(i):null;if(_!=null){var S=_==="y"?"height":"width";switch(a){case Dd:m[_]=m[_]-(e[S]/2-n[S]/2);break;case Cm:m[_]=m[_]+(e[S]/2-n[S]/2);break}}return m}function Am(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,a=n.strategy,h=a===void 0?t.strategy:a,l=n.boundary,m=l===void 0?zQ:l,_=n.rootBoundary,S=_===void 0?Oz:_,P=n.elementContext,A=P===void 0?pp:P,L=n.altBoundary,O=L===void 0?!1:L,D=n.padding,W=D===void 0?0:D,z=Bz(typeof W!="number"?W:jz(W,tg)),N=A===pp?DQ:pp,F=t.rects.popper,$=t.elements[O?N:A],Q=mee(ku($)?$:$.contextElement||kc(t.elements.popper),m,S,h),te=Nd(t.elements.reference),ie=Uz({reference:te,element:F,strategy:"absolute",placement:i}),xe=Xw(Object.assign({},F,ie)),Te=A===pp?xe:te,_e={top:Q.top-Te.top+z.top,bottom:Te.bottom-Q.bottom+z.bottom,left:Q.left-Te.left+z.left,right:Te.right-Q.right+z.right},Re=t.modifiersData.offset;if(A===pp&&Re){var Ne=Re[i];Object.keys(_e).forEach(function(Ve){var je=[Bo,No].indexOf(Ve)>=0?1:-1,Ge=[Bs,No].indexOf(Ve)>=0?"y":"x";_e[Ve]+=Ne[Ge]*je})}return _e}function gee(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,a=n.rootBoundary,h=n.padding,l=n.flipVariations,m=n.allowedAutoPlacements,_=m===void 0?zz:m,S=Bd(r),P=S?l?fk:fk.filter(function(O){return Bd(O)===S}):tg,A=P.filter(function(O){return _.indexOf(O)>=0});A.length===0&&(A=P);var L=A.reduce(function(O,D){return O[D]=Am(t,{placement:D,boundary:i,rootBoundary:a,padding:h})[Oa(D)],O},{});return Object.keys(L).sort(function(O,D){return L[O]-L[D]})}function yee(t){if(Oa(t)===lT)return[];var e=P0(t);return[gk(t),e,gk(e)]}function _ee(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!0:h,m=n.fallbackPlacements,_=n.padding,S=n.boundary,P=n.rootBoundary,A=n.altBoundary,L=n.flipVariations,O=L===void 0?!0:L,D=n.allowedAutoPlacements,W=e.options.placement,z=Oa(W),N=z===W,F=m||(N||!O?[P0(W)]:yee(W)),$=[W].concat(F).reduce(function(at,Qe){return at.concat(Oa(Qe)===lT?gee(e,{placement:Qe,boundary:S,rootBoundary:P,padding:_,flipVariations:O,allowedAutoPlacements:D}):Qe)},[]),Q=e.rects.reference,te=e.rects.popper,ie=new Map,xe=!0,Te=$[0],_e=0;_e<$.length;_e++){var Re=$[_e],Ne=Oa(Re),Ve=Bd(Re)===Dd,je=[Bs,No].indexOf(Ne)>=0,Ge=je?"width":"height",Ze=Am(e,{placement:Re,boundary:S,rootBoundary:P,altBoundary:A,padding:_}),Ye=je?Ve?Bo:js:Ve?No:Bs;Q[Ge]>te[Ge]&&(Ye=P0(Ye));var Ce=P0(Ye),qe=[];if(a&&qe.push(Ze[Ne]<=0),l&&qe.push(Ze[Ye]<=0,Ze[Ce]<=0),qe.every(function(at){return at})){Te=Re,xe=!1;break}ie.set(Re,qe)}if(xe)for(var st=O?3:1,Vt=function(Qe){var xt=$.find(function(Ht){var qt=ie.get(Ht);if(qt)return qt.slice(0,Qe).every(function(Et){return Et})});if(xt)return Te=xt,"break"},_t=st;_t>0;_t--){var ht=Vt(_t);if(ht==="break")break}e.placement!==Te&&(e.modifiersData[r]._skip=!0,e.placement=Te,e.reset=!0)}}const vee={name:"flip",enabled:!0,phase:"main",fn:_ee,requiresIfExists:["offset"],data:{_skip:!1}};function _k(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function vk(t){return[Bs,Bo,No,js].some(function(e){return t[e]>=0})}function xee(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,h=Am(e,{elementContext:"reference"}),l=Am(e,{altBoundary:!0}),m=_k(h,r),_=_k(l,i,a),S=vk(m),P=vk(_);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:S,hasPopperEscaped:P},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":S,"data-popper-escaped":P})}const bee={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xee};function wee(t,e,n){var r=Oa(t),i=[js,Bs].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,h=a[0],l=a[1];return h=h||0,l=(l||0)*i,[js,Bo].indexOf(r)>=0?{x:l,y:h}:{x:h,y:l}}function See(t){var e=t.state,n=t.options,r=t.name,i=n.offset,a=i===void 0?[0,0]:i,h=zz.reduce(function(S,P){return S[P]=wee(P,e.rects,a),S},{}),l=h[e.placement],m=l.x,_=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=_),e.modifiersData[r]=h}const Tee={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:See};function Eee(t){var e=t.state,n=t.name;e.modifiersData[n]=Uz({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Pee={name:"popperOffsets",enabled:!0,phase:"read",fn:Eee,data:{}};function Cee(t){return t==="x"?"y":"x"}function Aee(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,a=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!1:h,m=n.boundary,_=n.rootBoundary,S=n.altBoundary,P=n.padding,A=n.tether,L=A===void 0?!0:A,O=n.tetherOffset,D=O===void 0?0:O,W=Am(e,{boundary:m,rootBoundary:_,padding:P,altBoundary:S}),z=Oa(e.placement),N=Bd(e.placement),F=!N,$=hT(z),Q=Cee($),te=e.modifiersData.popperOffsets,ie=e.rects.reference,xe=e.rects.popper,Te=typeof D=="function"?D(Object.assign({},e.rects,{placement:e.placement})):D,_e=typeof Te=="number"?{mainAxis:Te,altAxis:Te}:Object.assign({mainAxis:0,altAxis:0},Te),Re=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ne={x:0,y:0};if(te){if(a){var Ve,je=$==="y"?Bs:js,Ge=$==="y"?No:Bo,Ze=$==="y"?"height":"width",Ye=te[$],Ce=Ye+W[je],qe=Ye-W[Ge],st=L?-xe[Ze]/2:0,Vt=N===Dd?ie[Ze]:xe[Ze],_t=N===Dd?-xe[Ze]:-ie[Ze],ht=e.elements.arrow,at=L&&ht?uT(ht):{width:0,height:0},Qe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Nz(),xt=Qe[je],Ht=Qe[Ge],qt=Up(0,ie[Ze],at[Ze]),Et=F?ie[Ze]/2-st-qt-xt-_e.mainAxis:Vt-qt-xt-_e.mainAxis,ln=F?-ie[Ze]/2+st+qt+Ht+_e.mainAxis:_t+qt+Ht+_e.mainAxis,Qt=e.elements.arrow&&ng(e.elements.arrow),mn=Qt?$==="y"?Qt.clientTop||0:Qt.clientLeft||0:0,Ut=(Ve=Re==null?void 0:Re[$])!=null?Ve:0,At=Ye+Et-Ut-mn,Lt=Ye+ln-Ut,yn=Up(L?y_(Ce,At):Ce,Ye,L?bu(qe,Lt):qe);te[$]=yn,Ne[$]=yn-Ye}if(l){var vn,ut=$==="x"?Bs:js,cn=$==="x"?No:Bo,Ae=te[Q],Tt=Q==="y"?"height":"width",bn=Ae+W[ut],Xt=Ae-W[cn],It=[Bs,js].indexOf(z)!==-1,Mn=(vn=Re==null?void 0:Re[Q])!=null?vn:0,Bn=It?bn:Ae-ie[Tt]-xe[Tt]-Mn+_e.altAxis,On=It?Ae+ie[Tt]+xe[Tt]-Mn-_e.altAxis:Xt,et=L&&It?JQ(Bn,Ae,On):Up(L?Bn:bn,Ae,L?On:Xt);te[Q]=et,Ne[Q]=et-Ae}e.modifiersData[r]=Ne}}const Iee={name:"preventOverflow",enabled:!0,phase:"main",fn:Aee,requiresIfExists:["offset"]};function kee(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Mee(t){return t===lo(t)||!Oo(t)?dT(t):kee(t)}function Lee(t){var e=t.getBoundingClientRect(),n=Fd(e.width)/t.offsetWidth||1,r=Fd(e.height)/t.offsetHeight||1;return n!==1||r!==1}function Ree(t,e,n){n===void 0&&(n=!1);var r=Oo(e),i=Oo(e)&&Lee(e),a=kc(e),h=Nd(t,i,n),l={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((Fa(e)!=="body"||pT(a))&&(l=Mee(e)),Oo(e)?(m=Nd(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):a&&(m.x=fT(a))),{x:h.left+l.scrollLeft-m.x,y:h.top+l.scrollTop-m.y,width:h.width,height:h.height}}function Oee(t){var e=new Map,n=new Set,r=[];t.forEach(function(a){e.set(a.name,a)});function i(a){n.add(a.name);var h=[].concat(a.requires||[],a.requiresIfExists||[]);h.forEach(function(l){if(!n.has(l)){var m=e.get(l);m&&i(m)}}),r.push(a)}return t.forEach(function(a){n.has(a.name)||i(a)}),r}function zee(t){var e=Oee(t);return HQ.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function Dee(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function Fee(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var xk={placement:"bottom",modifiers:[],strategy:"absolute"};function bk(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Nee(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,a=i===void 0?xk:i;return function(l,m,_){_===void 0&&(_=a);var S={placement:"bottom",orderedModifiers:[],options:Object.assign({},xk,a),modifiersData:{},elements:{reference:l,popper:m},attributes:{},styles:{}},P=[],A=!1,L={state:S,setOptions:function(z){var N=typeof z=="function"?z(S.options):z;D(),S.options=Object.assign({},a,S.options,N),S.scrollParents={reference:ku(l)?$p(l):l.contextElement?$p(l.contextElement):[],popper:$p(m)};var F=zee(Fee([].concat(r,S.options.modifiers)));return S.orderedModifiers=F.filter(function($){return $.enabled}),O(),L.update()},forceUpdate:function(){if(!A){var z=S.elements,N=z.reference,F=z.popper;if(bk(N,F)){S.rects={reference:Ree(N,ng(F),S.options.strategy==="fixed"),popper:uT(F)},S.reset=!1,S.placement=S.options.placement,S.orderedModifiers.forEach(function(_e){return S.modifiersData[_e.name]=Object.assign({},_e.data)});for(var $=0;$<S.orderedModifiers.length;$++){if(S.reset===!0){S.reset=!1,$=-1;continue}var Q=S.orderedModifiers[$],te=Q.fn,ie=Q.options,xe=ie===void 0?{}:ie,Te=Q.name;typeof te=="function"&&(S=te({state:S,options:xe,name:Te,instance:L})||S)}}}},update:Dee(function(){return new Promise(function(W){L.forceUpdate(),W(S)})}),destroy:function(){D(),A=!0}};if(!bk(l,m))return L;L.setOptions(_).then(function(W){!A&&_.onFirstUpdate&&_.onFirstUpdate(W)});function O(){S.orderedModifiers.forEach(function(W){var z=W.name,N=W.options,F=N===void 0?{}:N,$=W.effect;if(typeof $=="function"){var Q=$({state:S,name:z,instance:L,options:F}),te=function(){};P.push(Q||te)}})}function D(){P.forEach(function(W){return W()}),P=[]}return L}}var Bee=[lee,Pee,oee,XQ,Tee,vee,Iee,nee,bee],jee=Nee({defaultModifiers:Bee});function Vee(t){return typeof t=="function"?t():t}const Uee=Z.forwardRef(function(e,n){const{children:r,container:i,disablePortal:a=!1}=e,[h,l]=Z.useState(null),m=jr(Z.isValidElement(r)?Ic(r):null,n);if(da(()=>{a||l(Vee(i)||document.body)},[i,a]),da(()=>{if(h&&!a)return Uw(n,h),()=>{Uw(n,null)}},[n,h,a]),a){if(Z.isValidElement(r)){const _={ref:m};return Z.cloneElement(r,_)}return ue.jsx(Z.Fragment,{children:r})}return ue.jsx(Z.Fragment,{children:h&&zm.createPortal(r,h)})}),$z=Uee;function $ee(t){return $n("MuiPopper",t)}Fn("MuiPopper",["root"]);const Gee=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Wee=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Hee(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function Yw(t){return typeof t=="function"?t():t}function qee(t){return t.nodeType!==void 0}const Zee=t=>{const{classes:e}=t;return qn({root:["root"]},$ee,e)},Xee={},Yee=Z.forwardRef(function(e,n){var r;const{anchorEl:i,children:a,direction:h,disablePortal:l,modifiers:m,open:_,placement:S,popperOptions:P,popperRef:A,slotProps:L={},slots:O={},TransitionProps:D}=e,W=Yt(e,Gee),z=Z.useRef(null),N=jr(z,n),F=Z.useRef(null),$=jr(F,A),Q=Z.useRef($);da(()=>{Q.current=$},[$]),Z.useImperativeHandle(A,()=>F.current,[]);const te=Hee(S,h),[ie,xe]=Z.useState(te),[Te,_e]=Z.useState(Yw(i));Z.useEffect(()=>{F.current&&F.current.forceUpdate()}),Z.useEffect(()=>{i&&_e(Yw(i))},[i]),da(()=>{if(!Te||!_)return;const Ge=Ce=>{xe(Ce.placement)};let Ze=[{name:"preventOverflow",options:{altBoundary:l}},{name:"flip",options:{altBoundary:l}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ce})=>{Ge(Ce)}}];m!=null&&(Ze=Ze.concat(m)),P&&P.modifiers!=null&&(Ze=Ze.concat(P.modifiers));const Ye=jee(Te,z.current,se({placement:te},P,{modifiers:Ze}));return Q.current(Ye),()=>{Ye.destroy(),Q.current(null)}},[Te,l,m,_,P,te]);const Re={placement:ie};D!==null&&(Re.TransitionProps=D);const Ne=Zee(e),Ve=(r=O.root)!=null?r:"div",je=is({elementType:Ve,externalSlotProps:L.root,externalForwardedProps:W,additionalProps:{role:"tooltip",ref:N},ownerState:e,className:Ne.root});return ue.jsx(Ve,se({},je,{children:typeof a=="function"?a(Re):a}))}),Kee=Z.forwardRef(function(e,n){const{anchorEl:r,children:i,container:a,direction:h="ltr",disablePortal:l=!1,keepMounted:m=!1,modifiers:_,open:S,placement:P="bottom",popperOptions:A=Xee,popperRef:L,style:O,transition:D=!1,slotProps:W={},slots:z={}}=e,N=Yt(e,Wee),[F,$]=Z.useState(!0),Q=()=>{$(!1)},te=()=>{$(!0)};if(!m&&!S&&(!D||F))return null;let ie;if(a)ie=a;else if(r){const _e=Yw(r);ie=_e&&qee(_e)?Xr(_e).body:Xr(null).body}const xe=!S&&m&&(!D||F)?"none":void 0,Te=D?{in:S,onEnter:Q,onExited:te}:void 0;return ue.jsx($z,{disablePortal:l,container:ie,children:ue.jsx(Yee,se({anchorEl:r,direction:h,disablePortal:l,modifiers:_,ref:n,open:D?!F:S,placement:P,popperOptions:A,popperRef:L,slotProps:W,slots:z},N,{style:se({position:"fixed",top:0,left:0,display:xe},O),TransitionProps:Te,children:i}))})}),Jee=Kee,Qee=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],ete=Ct(Jee,{name:"MuiPopper",slot:"Root",overridesResolver:(t,e)=>e.root})({}),tte=Z.forwardRef(function(e,n){var r;const i=Lz(),a=Gn({props:e,name:"MuiPopper"}),{anchorEl:h,component:l,components:m,componentsProps:_,container:S,disablePortal:P,keepMounted:A,modifiers:L,open:O,placement:D,popperOptions:W,popperRef:z,transition:N,slots:F,slotProps:$}=a,Q=Yt(a,Qee),te=(r=F==null?void 0:F.root)!=null?r:m==null?void 0:m.Root,ie=se({anchorEl:h,container:S,disablePortal:P,keepMounted:A,modifiers:L,open:O,placement:D,popperOptions:W,popperRef:z,transition:N},Q);return ue.jsx(ete,se({as:l,direction:i==null?void 0:i.direction,slots:{root:te},slotProps:$??_},ie,{ref:n}))}),Gz=tte,nte=["onChange","maxRows","minRows","style","value"];function Uy(t){return parseInt(t,10)||0}const rte={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function ite(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflowing}const ste=Z.forwardRef(function(e,n){const{onChange:r,maxRows:i,minRows:a=1,style:h,value:l}=e,m=Yt(e,nte),{current:_}=Z.useRef(l!=null),S=Z.useRef(null),P=jr(n,S),A=Z.useRef(null),L=Z.useRef(null),O=Z.useCallback(()=>{const z=S.current,F=xl(z).getComputedStyle(z);if(F.width==="0px")return{outerHeightStyle:0,overflowing:!1};const $=L.current;$.style.width=F.width,$.value=z.value||e.placeholder||"x",$.value.slice(-1)===`
`&&($.value+=" ");const Q=F.boxSizing,te=Uy(F.paddingBottom)+Uy(F.paddingTop),ie=Uy(F.borderBottomWidth)+Uy(F.borderTopWidth),xe=$.scrollHeight;$.value="x";const Te=$.scrollHeight;let _e=xe;a&&(_e=Math.max(Number(a)*Te,_e)),i&&(_e=Math.min(Number(i)*Te,_e)),_e=Math.max(_e,Te);const Re=_e+(Q==="border-box"?te+ie:0),Ne=Math.abs(_e-xe)<=1;return{outerHeightStyle:Re,overflowing:Ne}},[i,a,e.placeholder]),D=Z.useCallback(()=>{const z=O();if(ite(z))return;const N=z.outerHeightStyle,F=S.current;A.current!==N&&(A.current=N,F.style.height=`${N}px`),F.style.overflow=z.overflowing?"hidden":""},[O]);da(()=>{const z=()=>{D()};let N;const F=Z2(z),$=S.current,Q=xl($);Q.addEventListener("resize",F);let te;return typeof ResizeObserver<"u"&&(te=new ResizeObserver(z),te.observe($)),()=>{F.clear(),cancelAnimationFrame(N),Q.removeEventListener("resize",F),te&&te.disconnect()}},[O,D]),da(()=>{D()});const W=z=>{_||D(),r&&r(z)};return ue.jsxs(Z.Fragment,{children:[ue.jsx("textarea",se({value:l,onChange:W,ref:P,rows:a,style:h},m)),ue.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:L,tabIndex:-1,style:se({},rte.shadow,h,{paddingTop:0,paddingBottom:0})})]})}),ote=ste;function Yd({props:t,states:e,muiFormControl:n}){return e.reduce((r,i)=>(r[i]=t[i],n&&typeof t[i]>"u"&&(r[i]=n[i]),r),{})}const ate=Z.createContext(void 0),Lv=ate;function Nu(){return Z.useContext(Lv)}function Wz(t){return ue.jsx(yY,se({},t,{defaultTheme:tT,themeId:Rd}))}function wk(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function __(t,e=!1){return t&&(wk(t.value)&&t.value!==""||e&&wk(t.defaultValue)&&t.defaultValue!=="")}function lte(t){return t.startAdornment}function cte(t){return $n("MuiInputBase",t)}const ute=Fn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),jd=ute,hte=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],Rv=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${Wt(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},Ov=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},dte=t=>{const{classes:e,color:n,disabled:r,error:i,endAdornment:a,focused:h,formControl:l,fullWidth:m,hiddenLabel:_,multiline:S,readOnly:P,size:A,startAdornment:L,type:O}=t,D={root:["root",`color${Wt(n)}`,r&&"disabled",i&&"error",m&&"fullWidth",h&&"focused",l&&"formControl",A&&A!=="medium"&&`size${Wt(A)}`,S&&"multiline",L&&"adornedStart",a&&"adornedEnd",_&&"hiddenLabel",P&&"readOnly"],input:["input",r&&"disabled",O==="search"&&"inputTypeSearch",S&&"inputMultiline",A==="small"&&"inputSizeSmall",_&&"inputHiddenLabel",L&&"inputAdornedStart",a&&"inputAdornedEnd",P&&"readOnly"]};return qn(D,cte,e)},zv=Ct("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Rv})(({theme:t,ownerState:e})=>se({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${jd.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&se({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),Dv=Ct("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Ov})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=se({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),i={opacity:"0 !important"},a=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return se({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${jd.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":a,"&:focus::-moz-placeholder":a,"&:focus:-ms-input-placeholder":a,"&:focus::-ms-input-placeholder":a},[`&.${jd.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),fte=ue.jsx(Wz,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),pte=Z.forwardRef(function(e,n){var r;const i=Gn({props:e,name:"MuiInputBase"}),{"aria-describedby":a,autoComplete:h,autoFocus:l,className:m,components:_={},componentsProps:S={},defaultValue:P,disabled:A,disableInjectingGlobalStyles:L,endAdornment:O,fullWidth:D=!1,id:W,inputComponent:z="input",inputProps:N={},inputRef:F,maxRows:$,minRows:Q,multiline:te=!1,name:ie,onBlur:xe,onChange:Te,onClick:_e,onFocus:Re,onKeyDown:Ne,onKeyUp:Ve,placeholder:je,readOnly:Ge,renderSuffix:Ze,rows:Ye,slotProps:Ce={},slots:qe={},startAdornment:st,type:Vt="text",value:_t}=i,ht=Yt(i,hte),at=N.value!=null?N.value:_t,{current:Qe}=Z.useRef(at!=null),xt=Z.useRef(),Ht=Z.useCallback(et=>{},[]),qt=jr(xt,F,N.ref,Ht),[Et,ln]=Z.useState(!1),Qt=Nu(),mn=Yd({props:i,muiFormControl:Qt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});mn.focused=Qt?Qt.focused:Et,Z.useEffect(()=>{!Qt&&A&&Et&&(ln(!1),xe&&xe())},[Qt,A,Et,xe]);const Ut=Qt&&Qt.onFilled,At=Qt&&Qt.onEmpty,Lt=Z.useCallback(et=>{__(et)?Ut&&Ut():At&&At()},[Ut,At]);da(()=>{Qe&&Lt({value:at})},[at,Lt,Qe]);const yn=et=>{if(mn.disabled){et.stopPropagation();return}Re&&Re(et),N.onFocus&&N.onFocus(et),Qt&&Qt.onFocus?Qt.onFocus(et):ln(!0)},vn=et=>{xe&&xe(et),N.onBlur&&N.onBlur(et),Qt&&Qt.onBlur?Qt.onBlur(et):ln(!1)},ut=(et,...Xe)=>{if(!Qe){const yt=et.target||xt.current;if(yt==null)throw new Error(_l(1));Lt({value:yt.value})}N.onChange&&N.onChange(et,...Xe),Te&&Te(et,...Xe)};Z.useEffect(()=>{Lt(xt.current)},[]);const cn=et=>{xt.current&&et.currentTarget===et.target&&xt.current.focus(),_e&&_e(et)};let Ae=z,Tt=N;te&&Ae==="input"&&(Ye?Tt=se({type:void 0,minRows:Ye,maxRows:Ye},Tt):Tt=se({type:void 0,maxRows:$,minRows:Q},Tt),Ae=ote);const bn=et=>{Lt(et.animationName==="mui-auto-fill-cancel"?xt.current:{value:"x"})};Z.useEffect(()=>{Qt&&Qt.setAdornedStart(!!st)},[Qt,st]);const Xt=se({},i,{color:mn.color||"primary",disabled:mn.disabled,endAdornment:O,error:mn.error,focused:mn.focused,formControl:Qt,fullWidth:D,hiddenLabel:mn.hiddenLabel,multiline:te,size:mn.size,startAdornment:st,type:Vt}),It=dte(Xt),Mn=qe.root||_.Root||zv,Bn=Ce.root||S.root||{},On=qe.input||_.Input||Dv;return Tt=se({},Tt,(r=Ce.input)!=null?r:S.input),ue.jsxs(Z.Fragment,{children:[!L&&fte,ue.jsxs(Mn,se({},Bn,!bc(Mn)&&{ownerState:se({},Xt,Bn.ownerState)},{ref:n,onClick:cn},ht,{className:fn(It.root,Bn.className,m,Ge&&"MuiInputBase-readOnly"),children:[st,ue.jsx(Lv.Provider,{value:null,children:ue.jsx(On,se({ownerState:Xt,"aria-invalid":mn.error,"aria-describedby":a,autoComplete:h,autoFocus:l,defaultValue:P,disabled:mn.disabled,id:W,onAnimationStart:bn,name:ie,placeholder:je,readOnly:Ge,required:mn.required,rows:Ye,value:at,onKeyDown:Ne,onKeyUp:Ve,type:Vt},Tt,!bc(On)&&{as:Ae,ownerState:se({},Xt,Tt.ownerState)},{ref:qt,className:fn(It.input,Tt.className,Ge&&"MuiInputBase-readOnly"),onBlur:vn,onChange:ut,onFocus:yn}))}),O,Ze?Ze(se({},mn,{startAdornment:st})):null]}))]})}),mT=pte;function mte(t){return $n("MuiInput",t)}const gte=se({},jd,Fn("MuiInput",["root","underline","input"])),mp=gte;function yte(t){return $n("MuiOutlinedInput",t)}const _te=se({},jd,Fn("MuiOutlinedInput",["root","notchedOutline","input"])),Kl=_te;function vte(t){return $n("MuiFilledInput",t)}const xte=se({},jd,Fn("MuiFilledInput",["root","underline","input"])),nu=xte,bte=Na(ue.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),wte=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Ste={entering:{opacity:1},entered:{opacity:1}},Tte=Z.forwardRef(function(e,n){const r=Zd(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:a,appear:h=!0,children:l,easing:m,in:_,onEnter:S,onEntered:P,onEntering:A,onExit:L,onExited:O,onExiting:D,style:W,timeout:z=i,TransitionComponent:N=nT}=e,F=Yt(e,wte),$=Z.useRef(null),Q=jr($,Ic(l),n),te=je=>Ge=>{if(je){const Ze=$.current;Ge===void 0?je(Ze):je(Ze,Ge)}},ie=te(A),xe=te((je,Ge)=>{sT(je);const Ze=zd({style:W,timeout:z,easing:m},{mode:"enter"});je.style.webkitTransition=r.transitions.create("opacity",Ze),je.style.transition=r.transitions.create("opacity",Ze),S&&S(je,Ge)}),Te=te(P),_e=te(D),Re=te(je=>{const Ge=zd({style:W,timeout:z,easing:m},{mode:"exit"});je.style.webkitTransition=r.transitions.create("opacity",Ge),je.style.transition=r.transitions.create("opacity",Ge),L&&L(je)}),Ne=te(O),Ve=je=>{a&&a($.current,je)};return ue.jsx(N,se({appear:h,in:_,nodeRef:$,onEnter:xe,onEntered:Te,onEntering:ie,onExit:Re,onExited:Ne,onExiting:_e,addEndListener:Ve,timeout:z},F,{children:(je,Ge)=>Z.cloneElement(l,se({style:se({opacity:0,visibility:je==="exited"&&!_?"hidden":void 0},Ste[je],W,l.props.style),ref:Q},Ge))}))}),Hz=Tte;function Ete(t){return $n("MuiBackdrop",t)}Fn("MuiBackdrop",["root","invisible"]);const Pte=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Cte=t=>{const{classes:e,invisible:n}=t;return qn({root:["root",n&&"invisible"]},Ete,e)},Ate=Ct("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>se({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Ite=Z.forwardRef(function(e,n){var r,i,a;const h=Gn({props:e,name:"MuiBackdrop"}),{children:l,className:m,component:_="div",components:S={},componentsProps:P={},invisible:A=!1,open:L,slotProps:O={},slots:D={},TransitionComponent:W=Hz,transitionDuration:z}=h,N=Yt(h,Pte),F=se({},h,{component:_,invisible:A}),$=Cte(F),Q=(r=O.root)!=null?r:P.root;return ue.jsx(W,se({in:L,timeout:z},N,{children:ue.jsx(Ate,se({"aria-hidden":!0},Q,{as:(i=(a=D.root)!=null?a:S.Root)!=null?i:_,className:fn($.root,m,Q==null?void 0:Q.className),ownerState:se({},F,Q==null?void 0:Q.ownerState),classes:$,ref:n,children:l}))}))}),kte=Ite,Mte=Fn("MuiBox",["root"]),Lte=Mte,Rte=eT(),Ote=TY({themeId:Rd,defaultTheme:Rte,defaultClassName:Lte.root,generateClassName:oz.generate}),e1=Ote;function zte(t){return $n("MuiButton",t)}const Dte=Fn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),$y=Dte,Fte=Z.createContext({}),Nte=Fte,Bte=Z.createContext(void 0),jte=Bte,Vte=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Ute=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:a,classes:h}=t,l={root:["root",a,`${a}${Wt(e)}`,`size${Wt(i)}`,`${a}Size${Wt(i)}`,`color${Wt(e)}`,n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Wt(i)}`],endIcon:["icon","endIcon",`iconSize${Wt(i)}`]},m=qn(l,zte,h);return se({},h,m)},qz=t=>se({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),$te=Ct(oT,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Wt(n.color)}`],e[`size${Wt(n.size)}`],e[`${n.variant}Size${Wt(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const i=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],a=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return se({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":se({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:as(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:a,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":se({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${$y.focusVisible}`]:se({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${$y.disabled}`]:se({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${as(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:i,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${$y.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${$y.disabled}`]:{boxShadow:"none"}}),Gte=Ct("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${Wt(n.size)}`]]}})(({ownerState:t})=>se({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},qz(t))),Wte=Ct("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${Wt(n.size)}`]]}})(({ownerState:t})=>se({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},qz(t))),Hte=Z.forwardRef(function(e,n){const r=Z.useContext(Nte),i=Z.useContext(jte),a=f_(r,e),h=Gn({props:a,name:"MuiButton"}),{children:l,color:m="primary",component:_="button",className:S,disabled:P=!1,disableElevation:A=!1,disableFocusRipple:L=!1,endIcon:O,focusVisibleClassName:D,fullWidth:W=!1,size:z="medium",startIcon:N,type:F,variant:$="text"}=h,Q=Yt(h,Vte),te=se({},h,{color:m,component:_,disabled:P,disableElevation:A,disableFocusRipple:L,fullWidth:W,size:z,type:F,variant:$}),ie=Ute(te),xe=N&&ue.jsx(Gte,{className:ie.startIcon,ownerState:te,children:N}),Te=O&&ue.jsx(Wte,{className:ie.endIcon,ownerState:te,children:O}),_e=i||"";return ue.jsxs($te,se({ownerState:te,className:fn(r.className,ie.root,S,_e),component:_,disabled:P,focusRipple:!L,focusVisibleClassName:fn(ie.focusVisible,D),ref:n,type:F},Q,{classes:ie,children:[xe,l,Te]}))}),C0=Hte;function qte(t){return $n("MuiCircularProgress",t)}Fn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Zte=["className","color","disableShrink","size","style","thickness","value","variant"];let Fv=t=>t,Sk,Tk,Ek,Pk;const Jl=44,Xte=Hd(Sk||(Sk=Fv`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),Yte=Hd(Tk||(Tk=Fv`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),Kte=t=>{const{classes:e,variant:n,color:r,disableShrink:i}=t,a={root:["root",n,`color${Wt(r)}`],svg:["svg"],circle:["circle",`circle${Wt(n)}`,i&&"circleDisableShrink"]};return qn(a,qte,e)},Jte=Ct("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${Wt(n.color)}`]]}})(({ownerState:t,theme:e})=>se({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&lv(Ek||(Ek=Fv`
      animation: ${0} 1.4s linear infinite;
    `),Xte)),Qte=Ct("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),ene=Ct("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${Wt(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>se({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&lv(Pk||(Pk=Fv`
      animation: ${0} 1.4s ease-in-out infinite;
    `),Yte)),tne=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiCircularProgress"}),{className:i,color:a="primary",disableShrink:h=!1,size:l=40,style:m,thickness:_=3.6,value:S=0,variant:P="indeterminate"}=r,A=Yt(r,Zte),L=se({},r,{color:a,disableShrink:h,size:l,thickness:_,value:S,variant:P}),O=Kte(L),D={},W={},z={};if(P==="determinate"){const N=2*Math.PI*((Jl-_)/2);D.strokeDasharray=N.toFixed(3),z["aria-valuenow"]=Math.round(S),D.strokeDashoffset=`${((100-S)/100*N).toFixed(3)}px`,W.transform="rotate(-90deg)"}return ue.jsx(Jte,se({className:fn(O.root,i),style:se({width:l,height:l},W,m),ownerState:L,ref:n,role:"progressbar"},z,A,{children:ue.jsx(Qte,{className:O.svg,ownerState:L,viewBox:`${Jl/2} ${Jl/2} ${Jl} ${Jl}`,children:ue.jsx(ene,{className:O.circle,style:D,ownerState:L,cx:Jl,cy:Jl,r:(Jl-_)/2,fill:"none",strokeWidth:_})})}))}),nne=tne;function Ck(t){return t.substring(2).toLowerCase()}function rne(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function ine(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=t,h=Z.useRef(!1),l=Z.useRef(null),m=Z.useRef(!1),_=Z.useRef(!1);Z.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const S=jr(Ic(e),l),P=zs(O=>{const D=_.current;_.current=!1;const W=Xr(l.current);if(!m.current||!l.current||"clientX"in O&&rne(O,W))return;if(h.current){h.current=!1;return}let z;O.composedPath?z=O.composedPath().indexOf(l.current)>-1:z=!W.documentElement.contains(O.target)||l.current.contains(O.target),!z&&(n||!D)&&i(O)}),A=O=>D=>{_.current=!0;const W=e.props[O];W&&W(D)},L={ref:S};return a!==!1&&(L[a]=A(a)),Z.useEffect(()=>{if(a!==!1){const O=Ck(a),D=Xr(l.current),W=()=>{h.current=!0};return D.addEventListener(O,P),D.addEventListener("touchmove",W),()=>{D.removeEventListener(O,P),D.removeEventListener("touchmove",W)}}},[P,a]),r!==!1&&(L[r]=A(r)),Z.useEffect(()=>{if(r!==!1){const O=Ck(r),D=Xr(l.current);return D.addEventListener(O,P),()=>{D.removeEventListener(O,P)}}},[P,r]),ue.jsx(Z.Fragment,{children:Z.cloneElement(e,L)})}const sne=(t,e)=>se({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),one=t=>se({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),ane=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([h,l])=>{var m;r[t.getColorSchemeSelector(h).replace(/\s*&/,"")]={colorScheme:(m=l.palette)==null?void 0:m.mode}});let i=se({html:sne(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:se({margin:0},one(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const a=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return a&&(i=[i,a]),i};function lne(t){const e=Gn({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return ue.jsxs(Z.Fragment,{children:[ue.jsx(Wz,{styles:i=>ane(i,r)}),n]})}function cne(t){const e=Xr(t);return e.body===t?xl(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Gp(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function Ak(t){return parseInt(xl(t).getComputedStyle(t).paddingRight,10)||0}function une(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function Ik(t,e,n,r,i){const a=[e,n,...r];[].forEach.call(t.children,h=>{const l=a.indexOf(h)===-1,m=!une(h);l&&m&&Gp(h,i)})}function t1(t,e){let n=-1;return t.some((r,i)=>e(r)?(n=i,!0):!1),n}function hne(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(cne(r)){const h=fz(Xr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${Ak(r)+h}px`;const l=Xr(r).querySelectorAll(".mui-fixed");[].forEach.call(l,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${Ak(m)+h}px`})}let a;if(r.parentNode instanceof DocumentFragment)a=Xr(r).body;else{const h=r.parentElement,l=xl(r);a=(h==null?void 0:h.nodeName)==="HTML"&&l.getComputedStyle(h).overflowY==="scroll"?h:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{n.forEach(({value:a,el:h,property:l})=>{a?h.style.setProperty(l,a):h.style.removeProperty(l)})}}function dne(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class fne{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&Gp(e.modalRef,!1);const i=dne(n);Ik(n,e.mount,e.modalRef,i,!0);const a=t1(this.containers,h=>h.container===n);return a!==-1?(this.containers[a].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:i}),r)}mount(e,n){const r=t1(this.containers,a=>a.modals.indexOf(e)!==-1),i=this.containers[r];i.restore||(i.restore=hne(i,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const i=t1(this.containers,h=>h.modals.indexOf(e)!==-1),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(e),1),this.modals.splice(r,1),a.modals.length===0)a.restore&&a.restore(),e.modalRef&&Gp(e.modalRef,n),Ik(a.container,e.mount,e.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const h=a.modals[a.modals.length-1];h.modalRef&&Gp(h.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const pne=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function mne(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function gne(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function yne(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||gne(t))}function _ne(t){const e=[],n=[];return Array.from(t.querySelectorAll(pne)).forEach((r,i)=>{const a=mne(r);a===-1||!yne(r)||(a===0?e.push(r):n.push({documentOrder:i,tabIndex:a,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(e)}function vne(){return!0}function xne(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:a=_ne,isEnabled:h=vne,open:l}=t,m=Z.useRef(!1),_=Z.useRef(null),S=Z.useRef(null),P=Z.useRef(null),A=Z.useRef(null),L=Z.useRef(!1),O=Z.useRef(null),D=jr(Ic(e),O),W=Z.useRef(null);Z.useEffect(()=>{!l||!O.current||(L.current=!n)},[n,l]),Z.useEffect(()=>{if(!l||!O.current)return;const F=Xr(O.current);return O.current.contains(F.activeElement)||(O.current.hasAttribute("tabIndex")||O.current.setAttribute("tabIndex","-1"),L.current&&O.current.focus()),()=>{i||(P.current&&P.current.focus&&(m.current=!0,P.current.focus()),P.current=null)}},[l]),Z.useEffect(()=>{if(!l||!O.current)return;const F=Xr(O.current),$=ie=>{W.current=ie,!(r||!h()||ie.key!=="Tab")&&F.activeElement===O.current&&ie.shiftKey&&(m.current=!0,S.current&&S.current.focus())},Q=()=>{const ie=O.current;if(ie===null)return;if(!F.hasFocus()||!h()||m.current){m.current=!1;return}if(ie.contains(F.activeElement)||r&&F.activeElement!==_.current&&F.activeElement!==S.current)return;if(F.activeElement!==A.current)A.current=null;else if(A.current!==null)return;if(!L.current)return;let xe=[];if((F.activeElement===_.current||F.activeElement===S.current)&&(xe=a(O.current)),xe.length>0){var Te,_e;const Re=!!((Te=W.current)!=null&&Te.shiftKey&&((_e=W.current)==null?void 0:_e.key)==="Tab"),Ne=xe[0],Ve=xe[xe.length-1];typeof Ne!="string"&&typeof Ve!="string"&&(Re?Ve.focus():Ne.focus())}else ie.focus()};F.addEventListener("focusin",Q),F.addEventListener("keydown",$,!0);const te=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&Q()},50);return()=>{clearInterval(te),F.removeEventListener("focusin",Q),F.removeEventListener("keydown",$,!0)}},[n,r,i,h,l,a]);const z=F=>{P.current===null&&(P.current=F.relatedTarget),L.current=!0,A.current=F.target;const $=e.props.onFocus;$&&$(F)},N=F=>{P.current===null&&(P.current=F.relatedTarget),L.current=!0};return ue.jsxs(Z.Fragment,{children:[ue.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:_,"data-testid":"sentinelStart"}),Z.cloneElement(e,{ref:D,onFocus:z}),ue.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:S,"data-testid":"sentinelEnd"})]})}function bne(t){return typeof t=="function"?t():t}function wne(t){return t?t.props.hasOwnProperty("in"):!1}const Sne=new fne;function Tne(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=Sne,closeAfterTransition:a=!1,onTransitionEnter:h,onTransitionExited:l,children:m,onClose:_,open:S,rootRef:P}=t,A=Z.useRef({}),L=Z.useRef(null),O=Z.useRef(null),D=jr(O,P),[W,z]=Z.useState(!S),N=wne(m);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const $=()=>Xr(L.current),Q=()=>(A.current.modalRef=O.current,A.current.mount=L.current,A.current),te=()=>{i.mount(Q(),{disableScrollLock:r}),O.current&&(O.current.scrollTop=0)},ie=zs(()=>{const Ze=bne(e)||$().body;i.add(Q(),Ze),O.current&&te()}),xe=Z.useCallback(()=>i.isTopModal(Q()),[i]),Te=zs(Ze=>{L.current=Ze,Ze&&(S&&xe()?te():O.current&&Gp(O.current,F))}),_e=Z.useCallback(()=>{i.remove(Q(),F)},[F,i]);Z.useEffect(()=>()=>{_e()},[_e]),Z.useEffect(()=>{S?ie():(!N||!a)&&_e()},[S,_e,N,a,ie]);const Re=Ze=>Ye=>{var Ce;(Ce=Ze.onKeyDown)==null||Ce.call(Ze,Ye),!(Ye.key!=="Escape"||Ye.which===229||!xe())&&(n||(Ye.stopPropagation(),_&&_(Ye,"escapeKeyDown")))},Ne=Ze=>Ye=>{var Ce;(Ce=Ze.onClick)==null||Ce.call(Ze,Ye),Ye.target===Ye.currentTarget&&_&&_(Ye,"backdropClick")};return{getRootProps:(Ze={})=>{const Ye=xu(t);delete Ye.onTransitionEnter,delete Ye.onTransitionExited;const Ce=se({},Ye,Ze);return se({role:"presentation"},Ce,{onKeyDown:Re(Ce),ref:D})},getBackdropProps:(Ze={})=>{const Ye=Ze;return se({"aria-hidden":!0},Ye,{onClick:Ne(Ye),open:S})},getTransitionProps:()=>{const Ze=()=>{z(!1),h&&h()},Ye=()=>{z(!0),l&&l(),a&&_e()};return{onEnter:jI(Ze,m==null?void 0:m.props.onEnter),onExited:jI(Ye,m==null?void 0:m.props.onExited)}},rootRef:D,portalRef:Te,isTopModal:xe,exited:W,hasTransition:N}}function Ene(t){return $n("MuiModal",t)}Fn("MuiModal",["root","hidden","backdrop"]);const Pne=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Cne=t=>{const{open:e,exited:n,classes:r}=t;return qn({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},Ene,r)},Ane=Ct("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>se({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Ine=Ct(kte,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),kne=Z.forwardRef(function(e,n){var r,i,a,h,l,m;const _=Gn({name:"MuiModal",props:e}),{BackdropComponent:S=Ine,BackdropProps:P,className:A,closeAfterTransition:L=!1,children:O,container:D,component:W,components:z={},componentsProps:N={},disableAutoFocus:F=!1,disableEnforceFocus:$=!1,disableEscapeKeyDown:Q=!1,disablePortal:te=!1,disableRestoreFocus:ie=!1,disableScrollLock:xe=!1,hideBackdrop:Te=!1,keepMounted:_e=!1,onBackdropClick:Re,open:Ne,slotProps:Ve,slots:je}=_,Ge=Yt(_,Pne),Ze=se({},_,{closeAfterTransition:L,disableAutoFocus:F,disableEnforceFocus:$,disableEscapeKeyDown:Q,disablePortal:te,disableRestoreFocus:ie,disableScrollLock:xe,hideBackdrop:Te,keepMounted:_e}),{getRootProps:Ye,getBackdropProps:Ce,getTransitionProps:qe,portalRef:st,isTopModal:Vt,exited:_t,hasTransition:ht}=Tne(se({},Ze,{rootRef:n})),at=se({},Ze,{exited:_t}),Qe=Cne(at),xt={};if(O.props.tabIndex===void 0&&(xt.tabIndex="-1"),ht){const{onEnter:Ut,onExited:At}=qe();xt.onEnter=Ut,xt.onExited=At}const Ht=(r=(i=je==null?void 0:je.root)!=null?i:z.Root)!=null?r:Ane,qt=(a=(h=je==null?void 0:je.backdrop)!=null?h:z.Backdrop)!=null?a:S,Et=(l=Ve==null?void 0:Ve.root)!=null?l:N.root,ln=(m=Ve==null?void 0:Ve.backdrop)!=null?m:N.backdrop,Qt=is({elementType:Ht,externalSlotProps:Et,externalForwardedProps:Ge,getSlotProps:Ye,additionalProps:{ref:n,as:W},ownerState:at,className:fn(A,Et==null?void 0:Et.className,Qe==null?void 0:Qe.root,!at.open&&at.exited&&(Qe==null?void 0:Qe.hidden))}),mn=is({elementType:qt,externalSlotProps:ln,additionalProps:P,getSlotProps:Ut=>Ce(se({},Ut,{onClick:At=>{Re&&Re(At),Ut!=null&&Ut.onClick&&Ut.onClick(At)}})),className:fn(ln==null?void 0:ln.className,P==null?void 0:P.className,Qe==null?void 0:Qe.backdrop),ownerState:at});return!_e&&!Ne&&(!ht||_t)?null:ue.jsx($z,{ref:st,container:D,disablePortal:te,children:ue.jsxs(Ht,se({},Qt,{children:[!Te&&S?ue.jsx(qt,se({},mn)):null,ue.jsx(xne,{disableEnforceFocus:$,disableAutoFocus:F,disableRestoreFocus:ie,isEnabled:Vt,open:Ne,children:Z.cloneElement(O,xt)})]}))})}),Zz=kne,Mne=Fn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),kk=Mne,Lne=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Rne(t,e,n){const r=e.getBoundingClientRect(),i=n&&n.getBoundingClientRect(),a=xl(e);let h;if(e.fakeTransform)h=e.fakeTransform;else{const _=a.getComputedStyle(e);h=_.getPropertyValue("-webkit-transform")||_.getPropertyValue("transform")}let l=0,m=0;if(h&&h!=="none"&&typeof h=="string"){const _=h.split("(")[1].split(")")[0].split(",");l=parseInt(_[4],10),m=parseInt(_[5],10)}return t==="left"?i?`translateX(${i.right+l-r.left}px)`:`translateX(${a.innerWidth+l-r.left}px)`:t==="right"?i?`translateX(-${r.right-i.left-l}px)`:`translateX(-${r.left+r.width-l}px)`:t==="up"?i?`translateY(${i.bottom+m-r.top}px)`:`translateY(${a.innerHeight+m-r.top}px)`:i?`translateY(-${r.top-i.top+r.height-m}px)`:`translateY(-${r.top+r.height-m}px)`}function One(t){return typeof t=="function"?t():t}function Gy(t,e,n){const r=One(n),i=Rne(t,e,r);i&&(e.style.webkitTransform=i,e.style.transform=i)}const zne=Z.forwardRef(function(e,n){const r=Zd(),i={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},a={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:h,appear:l=!0,children:m,container:_,direction:S="down",easing:P=i,in:A,onEnter:L,onEntered:O,onEntering:D,onExit:W,onExited:z,onExiting:N,style:F,timeout:$=a,TransitionComponent:Q=nT}=e,te=Yt(e,Lne),ie=Z.useRef(null),xe=jr(Ic(m),ie,n),Te=Ce=>qe=>{Ce&&(qe===void 0?Ce(ie.current):Ce(ie.current,qe))},_e=Te((Ce,qe)=>{Gy(S,Ce,_),sT(Ce),L&&L(Ce,qe)}),Re=Te((Ce,qe)=>{const st=zd({timeout:$,style:F,easing:P},{mode:"enter"});Ce.style.webkitTransition=r.transitions.create("-webkit-transform",se({},st)),Ce.style.transition=r.transitions.create("transform",se({},st)),Ce.style.webkitTransform="none",Ce.style.transform="none",D&&D(Ce,qe)}),Ne=Te(O),Ve=Te(N),je=Te(Ce=>{const qe=zd({timeout:$,style:F,easing:P},{mode:"exit"});Ce.style.webkitTransition=r.transitions.create("-webkit-transform",qe),Ce.style.transition=r.transitions.create("transform",qe),Gy(S,Ce,_),W&&W(Ce)}),Ge=Te(Ce=>{Ce.style.webkitTransition="",Ce.style.transition="",z&&z(Ce)}),Ze=Ce=>{h&&h(ie.current,Ce)},Ye=Z.useCallback(()=>{ie.current&&Gy(S,ie.current,_)},[S,_]);return Z.useEffect(()=>{if(A||S==="down"||S==="right")return;const Ce=Z2(()=>{ie.current&&Gy(S,ie.current,_)}),qe=xl(ie.current);return qe.addEventListener("resize",Ce),()=>{Ce.clear(),qe.removeEventListener("resize",Ce)}},[S,A,_]),Z.useEffect(()=>{A||Ye()},[A,Ye]),ue.jsx(Q,se({nodeRef:ie,onEnter:_e,onEntered:Ne,onEntering:Re,onExit:je,onExited:Ge,onExiting:Ve,addEndListener:Ze,appear:l,in:A,timeout:$},te,{children:(Ce,qe)=>Z.cloneElement(m,se({ref:xe,style:se({visibility:Ce==="exited"&&!A?"hidden":void 0},F,m.props.style)},qe))}))}),Dne=zne;function Fne(t){return $n("MuiDrawer",t)}Fn("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Nne=["BackdropProps"],Bne=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],Xz=(t,e)=>{const{ownerState:n}=t;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},jne=t=>{const{classes:e,anchor:n,variant:r}=t,i={root:["root"],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Wt(n)}`,r!=="temporary"&&`paperAnchorDocked${Wt(n)}`]};return qn(i,Fne,e)},Vne=Ct(Zz,{name:"MuiDrawer",slot:"Root",overridesResolver:Xz})(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer})),Mk=Ct("div",{shouldForwardProp:fo,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Xz})({flex:"0 0 auto"}),Une=Ct(Iv,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`paperAnchor${Wt(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${Wt(n.anchor)}`]]}})(({theme:t,ownerState:e})=>se({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},e.anchor==="left"&&{left:0},e.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="right"&&{right:0},e.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="left"&&e.variant!=="temporary"&&{borderRight:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="top"&&e.variant!=="temporary"&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="right"&&e.variant!=="temporary"&&{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="bottom"&&e.variant!=="temporary"&&{borderTop:`1px solid ${(t.vars||t).palette.divider}`})),Yz={left:"right",right:"left",top:"down",bottom:"up"};function $ne(t){return["left","right"].indexOf(t)!==-1}function Gne({direction:t},e){return t==="rtl"&&$ne(e)?Yz[e]:e}const Wne=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiDrawer"}),i=Zd(),a=Cv(),h={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:l="left",BackdropProps:m,children:_,className:S,elevation:P=16,hideBackdrop:A=!1,ModalProps:{BackdropProps:L}={},onClose:O,open:D=!1,PaperProps:W={},SlideProps:z,TransitionComponent:N=Dne,transitionDuration:F=h,variant:$="temporary"}=r,Q=Yt(r.ModalProps,Nne),te=Yt(r,Bne),ie=Z.useRef(!1);Z.useEffect(()=>{ie.current=!0},[]);const xe=Gne({direction:a?"rtl":"ltr"},l),_e=se({},r,{anchor:l,elevation:P,open:D,variant:$},te),Re=jne(_e),Ne=ue.jsx(Une,se({elevation:$==="temporary"?P:0,square:!0},W,{className:fn(Re.paper,W.className),ownerState:_e,children:_}));if($==="permanent")return ue.jsx(Mk,se({className:fn(Re.root,Re.docked,S),ownerState:_e,ref:n},te,{children:Ne}));const Ve=ue.jsx(N,se({in:D,direction:Yz[xe],timeout:F,appear:ie.current},z,{children:Ne}));return $==="persistent"?ue.jsx(Mk,se({className:fn(Re.root,Re.docked,S),ownerState:_e,ref:n},te,{children:Ve})):ue.jsx(Vne,se({BackdropProps:se({},m,L,{transitionDuration:F}),className:fn(Re.root,Re.modal,S),open:D,ownerState:_e,onClose:O,hideBackdrop:A,ref:n},te,Q,{children:Ve}))}),Hne=Wne,qne=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Zne=t=>{const{classes:e,disableUnderline:n}=t,i=qn({root:["root",!n&&"underline"],input:["input"]},vte,e);return se({},e,i)},Xne=Ct(zv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Rv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",i=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",a=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",h=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return se({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:h,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a}},[`&.${nu.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:a},[`&.${nu.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${nu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${nu.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${nu.disabled}, .${nu.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${nu.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&se({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),Yne=Ct(Dv,{name:"MuiFilledInput",slot:"Input",overridesResolver:Ov})(({theme:t,ownerState:e})=>se({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),Kz=Z.forwardRef(function(e,n){var r,i,a,h;const l=Gn({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:_,fullWidth:S=!1,inputComponent:P="input",multiline:A=!1,slotProps:L,slots:O={},type:D="text"}=l,W=Yt(l,qne),z=se({},l,{fullWidth:S,inputComponent:P,multiline:A,type:D}),N=Zne(l),F={root:{ownerState:z},input:{ownerState:z}},$=L??_?oo(F,L??_):F,Q=(r=(i=O.root)!=null?i:m.Root)!=null?r:Xne,te=(a=(h=O.input)!=null?h:m.Input)!=null?a:Yne;return ue.jsx(mT,se({slots:{root:Q,input:te},componentsProps:$,fullWidth:S,inputComponent:P,multiline:A,ref:n,type:D},W,{classes:N}))});Kz.muiName="Input";const Jz=Kz;function Kne(t){return $n("MuiFormControl",t)}Fn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Jne=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Qne=t=>{const{classes:e,margin:n,fullWidth:r}=t,i={root:["root",n!=="none"&&`margin${Wt(n)}`,r&&"fullWidth"]};return qn(i,Kne,e)},ere=Ct("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>se({},e.root,e[`margin${Wt(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>se({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),tre=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormControl"}),{children:i,className:a,color:h="primary",component:l="div",disabled:m=!1,error:_=!1,focused:S,fullWidth:P=!1,hiddenLabel:A=!1,margin:L="none",required:O=!1,size:D="medium",variant:W="outlined"}=r,z=Yt(r,Jne),N=se({},r,{color:h,component:l,disabled:m,error:_,fullWidth:P,hiddenLabel:A,margin:L,required:O,size:D,variant:W}),F=Qne(N),[$,Q]=Z.useState(()=>{let Ve=!1;return i&&Z.Children.forEach(i,je=>{if(!Yb(je,["Input","Select"]))return;const Ge=Yb(je,["Select"])?je.props.input:je;Ge&&lte(Ge.props)&&(Ve=!0)}),Ve}),[te,ie]=Z.useState(()=>{let Ve=!1;return i&&Z.Children.forEach(i,je=>{Yb(je,["Input","Select"])&&(__(je.props,!0)||__(je.props.inputProps,!0))&&(Ve=!0)}),Ve}),[xe,Te]=Z.useState(!1);m&&xe&&Te(!1);const _e=S!==void 0&&!m?S:xe;let Re;const Ne=Z.useMemo(()=>({adornedStart:$,setAdornedStart:Q,color:h,disabled:m,error:_,filled:te,focused:_e,fullWidth:P,hiddenLabel:A,size:D,onBlur:()=>{Te(!1)},onEmpty:()=>{ie(!1)},onFilled:()=>{ie(!0)},onFocus:()=>{Te(!0)},registerEffect:Re,required:O,variant:W}),[$,h,m,_,te,_e,P,A,Re,O,D,W]);return ue.jsx(Lv.Provider,{value:Ne,children:ue.jsx(ere,se({as:l,ownerState:N,className:fn(F.root,a),ref:n},z,{children:i}))})}),Qz=tre;function nre(t){return $n("MuiFormHelperText",t)}const rre=Fn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),Lk=rre;var Rk;const ire=["children","className","component","disabled","error","filled","focused","margin","required","variant"],sre=t=>{const{classes:e,contained:n,size:r,disabled:i,error:a,filled:h,focused:l,required:m}=t,_={root:["root",i&&"disabled",a&&"error",r&&`size${Wt(r)}`,n&&"contained",l&&"focused",h&&"filled",m&&"required"]};return qn(_,nre,e)},ore=Ct("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${Wt(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>se({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${Lk.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Lk.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),are=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormHelperText"}),{children:i,className:a,component:h="p"}=r,l=Yt(r,ire),m=Nu(),_=Yd({props:r,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),S=se({},r,{component:h,contained:_.variant==="filled"||_.variant==="outlined",variant:_.variant,size:_.size,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),P=sre(S);return ue.jsx(ore,se({as:h,ownerState:S,className:fn(P.root,a),ref:n},l,{children:i===" "?Rk||(Rk=ue.jsx("span",{className:"notranslate",children:""})):i}))}),lre=are;function cre(t){return $n("MuiFormLabel",t)}const ure=Fn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Wp=ure,hre=["children","className","color","component","disabled","error","filled","focused","required"],dre=t=>{const{classes:e,color:n,focused:r,disabled:i,error:a,filled:h,required:l}=t,m={root:["root",`color${Wt(n)}`,i&&"disabled",a&&"error",h&&"filled",r&&"focused",l&&"required"],asterisk:["asterisk",a&&"error"]};return qn(m,cre,e)},fre=Ct("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>se({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>se({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Wp.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${Wp.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Wp.error}`]:{color:(t.vars||t).palette.error.main}})),pre=Ct("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${Wp.error}`]:{color:(t.vars||t).palette.error.main}})),mre=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiFormLabel"}),{children:i,className:a,component:h="label"}=r,l=Yt(r,hre),m=Nu(),_=Yd({props:r,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),S=se({},r,{color:_.color||"primary",component:h,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),P=dre(S);return ue.jsxs(fre,se({as:h,ownerState:S,className:fn(P.root,a),ref:n},l,{children:[i,_.required&&ue.jsxs(pre,{ownerState:S,"aria-hidden":!0,className:P.asterisk,children:["","*"]})]}))}),gre=mre,yre=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Kw(t){return`scale(${t}, ${t**2})`}const _re={entering:{opacity:1,transform:Kw(1)},entered:{opacity:1,transform:"none"}},n1=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),eD=Z.forwardRef(function(e,n){const{addEndListener:r,appear:i=!0,children:a,easing:h,in:l,onEnter:m,onEntered:_,onEntering:S,onExit:P,onExited:A,onExiting:L,style:O,timeout:D="auto",TransitionComponent:W=nT}=e,z=Yt(e,yre),N=pu(),F=Z.useRef(),$=Zd(),Q=Z.useRef(null),te=jr(Q,Ic(a),n),ie=Ge=>Ze=>{if(Ge){const Ye=Q.current;Ze===void 0?Ge(Ye):Ge(Ye,Ze)}},xe=ie(S),Te=ie((Ge,Ze)=>{sT(Ge);const{duration:Ye,delay:Ce,easing:qe}=zd({style:O,timeout:D,easing:h},{mode:"enter"});let st;D==="auto"?(st=$.transitions.getAutoHeightDuration(Ge.clientHeight),F.current=st):st=Ye,Ge.style.transition=[$.transitions.create("opacity",{duration:st,delay:Ce}),$.transitions.create("transform",{duration:n1?st:st*.666,delay:Ce,easing:qe})].join(","),m&&m(Ge,Ze)}),_e=ie(_),Re=ie(L),Ne=ie(Ge=>{const{duration:Ze,delay:Ye,easing:Ce}=zd({style:O,timeout:D,easing:h},{mode:"exit"});let qe;D==="auto"?(qe=$.transitions.getAutoHeightDuration(Ge.clientHeight),F.current=qe):qe=Ze,Ge.style.transition=[$.transitions.create("opacity",{duration:qe,delay:Ye}),$.transitions.create("transform",{duration:n1?qe:qe*.666,delay:n1?Ye:Ye||qe*.333,easing:Ce})].join(","),Ge.style.opacity=0,Ge.style.transform=Kw(.75),P&&P(Ge)}),Ve=ie(A),je=Ge=>{D==="auto"&&N.start(F.current||0,Ge),r&&r(Q.current,Ge)};return ue.jsx(W,se({appear:i,in:l,nodeRef:Q,onEnter:Te,onEntered:_e,onEntering:xe,onExit:Ne,onExited:Ve,onExiting:Re,addEndListener:je,timeout:D==="auto"?null:D},z,{children:(Ge,Ze)=>Z.cloneElement(a,se({style:se({opacity:0,transform:Kw(.75),visibility:Ge==="exited"&&!l?"hidden":void 0},_re[Ge],O,a.props.style),ref:te},Ze))}))});eD.muiSupportAuto=!0;const v_=eD,vre=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],xre=t=>{const{classes:e,disableUnderline:n}=t,i=qn({root:["root",!n&&"underline"],input:["input"]},mte,e);return se({},e,i)},bre=Ct(zv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...Rv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),se({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${mp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${mp.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${mp.disabled}, .${mp.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${mp.disabled}:before`]:{borderBottomStyle:"dotted"}})}),wre=Ct(Dv,{name:"MuiInput",slot:"Input",overridesResolver:Ov})({}),tD=Z.forwardRef(function(e,n){var r,i,a,h;const l=Gn({props:e,name:"MuiInput"}),{disableUnderline:m,components:_={},componentsProps:S,fullWidth:P=!1,inputComponent:A="input",multiline:L=!1,slotProps:O,slots:D={},type:W="text"}=l,z=Yt(l,vre),N=xre(l),$={root:{ownerState:{disableUnderline:m}}},Q=O??S?oo(O??S,$):$,te=(r=(i=D.root)!=null?i:_.Root)!=null?r:bre,ie=(a=(h=D.input)!=null?h:_.Input)!=null?a:wre;return ue.jsx(mT,se({slots:{root:te,input:ie},slotProps:Q,fullWidth:P,inputComponent:A,multiline:L,ref:n,type:W},z,{classes:N}))});tD.muiName="Input";const nD=tD;function Sre(t){return $n("MuiInputAdornment",t)}const Tre=Fn("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),Ok=Tre;var zk;const Ere=["children","className","component","disablePointerEvents","disableTypography","position","variant"],Pre=(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${Wt(n.position)}`],n.disablePointerEvents===!0&&e.disablePointerEvents,e[n.variant]]},Cre=t=>{const{classes:e,disablePointerEvents:n,hiddenLabel:r,position:i,size:a,variant:h}=t,l={root:["root",n&&"disablePointerEvents",i&&`position${Wt(i)}`,h,r&&"hiddenLabel",a&&`size${Wt(a)}`]};return qn(l,Sre,e)},Are=Ct("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:Pre})(({theme:t,ownerState:e})=>se({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},e.variant==="filled"&&{[`&.${Ok.positionStart}&:not(.${Ok.hiddenLabel})`]:{marginTop:16}},e.position==="start"&&{marginRight:8},e.position==="end"&&{marginLeft:8},e.disablePointerEvents===!0&&{pointerEvents:"none"})),Ire=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiInputAdornment"}),{children:i,className:a,component:h="div",disablePointerEvents:l=!1,disableTypography:m=!1,position:_,variant:S}=r,P=Yt(r,Ere),A=Nu()||{};let L=S;S&&A.variant,A&&!L&&(L=A.variant);const O=se({},r,{hiddenLabel:A.hiddenLabel,size:A.size,disablePointerEvents:l,position:_,variant:L}),D=Cre(O);return ue.jsx(Lv.Provider,{value:null,children:ue.jsx(Are,se({as:h,ownerState:O,className:fn(D.root,a),ref:n},P,{children:typeof i=="string"&&!m?ue.jsx(xs,{color:"text.secondary",children:i}):ue.jsxs(Z.Fragment,{children:[_==="start"?zk||(zk=ue.jsx("span",{className:"notranslate",children:""})):null,i]})}))})}),kre=Ire;function Mre(t){return $n("MuiInputLabel",t)}Fn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Lre=["disableAnimation","margin","shrink","variant","className"],Rre=t=>{const{classes:e,formControl:n,size:r,shrink:i,disableAnimation:a,variant:h,required:l}=t,m={root:["root",n&&"formControl",!a&&"animated",i&&"shrink",r&&r!=="normal"&&`size${Wt(r)}`,h],asterisk:[l&&"asterisk"]},_=qn(m,Mre,e);return se({},e,_)},Ore=Ct(gre,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${Wp.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>se({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&se({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&se({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&se({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),zre=Z.forwardRef(function(e,n){const r=Gn({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:a,className:h}=r,l=Yt(r,Lre),m=Nu();let _=a;typeof _>"u"&&m&&(_=m.filled||m.focused||m.adornedStart);const S=Yd({props:r,muiFormControl:m,states:["size","variant","required","focused"]}),P=se({},r,{disableAnimation:i,formControl:m,shrink:_,size:S.size,variant:S.variant,required:S.required,focused:S.focused}),A=Rre(P);return ue.jsx(Ore,se({"data-shrink":_,ownerState:P,ref:n,className:fn(A.root,h)},l,{classes:A}))}),rD=zre,Dre=Z.createContext({}),Jw=Dre;function Fre(t){return $n("MuiList",t)}Fn("MuiList",["root","padding","dense","subheader"]);const Nre=["children","className","component","dense","disablePadding","subheader"],Bre=t=>{const{classes:e,disablePadding:n,dense:r,subheader:i}=t;return qn({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},Fre,e)},jre=Ct("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>se({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),Vre=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiList"}),{children:i,className:a,component:h="ul",dense:l=!1,disablePadding:m=!1,subheader:_}=r,S=Yt(r,Nre),P=Z.useMemo(()=>({dense:l}),[l]),A=se({},r,{component:h,dense:l,disablePadding:m}),L=Bre(A);return ue.jsx(Jw.Provider,{value:P,children:ue.jsxs(jre,se({as:h,className:fn(L.root,a),ref:n,ownerState:A},S,{children:[_,i]}))})}),Ure=Vre,$re=Fn("MuiListItemIcon",["root","alignItemsFlexStart"]),Dk=$re,Gre=Fn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Fk=Gre,Wre=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function r1(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function Nk(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function iD(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function gp(t,e,n,r,i,a){let h=!1,l=i(t,e,e?n:!1);for(;l;){if(l===t.firstChild){if(h)return!1;h=!0}const m=r?!1:l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||!iD(l,a)||m)l=i(t,l,n);else return l.focus(),!0}return!1}const Hre=Z.forwardRef(function(e,n){const{actions:r,autoFocus:i=!1,autoFocusItem:a=!1,children:h,className:l,disabledItemsFocusable:m=!1,disableListWrap:_=!1,onKeyDown:S,variant:P="selectedMenu"}=e,A=Yt(e,Wre),L=Z.useRef(null),O=Z.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});da(()=>{i&&L.current.focus()},[i]),Z.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(F,{direction:$})=>{const Q=!L.current.style.width;if(F.clientHeight<L.current.clientHeight&&Q){const te=`${fz(Xr(F))}px`;L.current.style[$==="rtl"?"paddingLeft":"paddingRight"]=te,L.current.style.width=`calc(100% + ${te})`}return L.current}}),[]);const D=F=>{const $=L.current,Q=F.key,te=Xr($).activeElement;if(Q==="ArrowDown")F.preventDefault(),gp($,te,_,m,r1);else if(Q==="ArrowUp")F.preventDefault(),gp($,te,_,m,Nk);else if(Q==="Home")F.preventDefault(),gp($,null,_,m,r1);else if(Q==="End")F.preventDefault(),gp($,null,_,m,Nk);else if(Q.length===1){const ie=O.current,xe=Q.toLowerCase(),Te=performance.now();ie.keys.length>0&&(Te-ie.lastTime>500?(ie.keys=[],ie.repeating=!0,ie.previousKeyMatched=!0):ie.repeating&&xe!==ie.keys[0]&&(ie.repeating=!1)),ie.lastTime=Te,ie.keys.push(xe);const _e=te&&!ie.repeating&&iD(te,ie);ie.previousKeyMatched&&(_e||gp($,te,!1,m,r1,ie))?F.preventDefault():ie.previousKeyMatched=!1}S&&S(F)},W=jr(L,n);let z=-1;Z.Children.forEach(h,(F,$)=>{if(!Z.isValidElement(F)){z===$&&(z+=1,z>=h.length&&(z=-1));return}F.props.disabled||(P==="selectedMenu"&&F.props.selected||z===-1)&&(z=$),z===$&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(z+=1,z>=h.length&&(z=-1))});const N=Z.Children.map(h,(F,$)=>{if($===z){const Q={};return a&&(Q.autoFocus=!0),F.props.tabIndex===void 0&&P==="selectedMenu"&&(Q.tabIndex=0),Z.cloneElement(F,Q)}return F});return ue.jsx(Ure,se({role:"menu",ref:W,className:l,onKeyDown:D,tabIndex:i?0:-1},A,{children:N}))}),qre=Hre;function Zre(t){return $n("MuiPopover",t)}Fn("MuiPopover",["root","paper"]);const Xre=["onEntering"],Yre=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Kre=["slotProps"];function Bk(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function jk(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function Vk(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function i1(t){return typeof t=="function"?t():t}const Jre=t=>{const{classes:e}=t;return qn({root:["root"],paper:["paper"]},Zre,e)},Qre=Ct(Zz,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),sD=Ct(Iv,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),eie=Z.forwardRef(function(e,n){var r,i,a;const h=Gn({props:e,name:"MuiPopover"}),{action:l,anchorEl:m,anchorOrigin:_={vertical:"top",horizontal:"left"},anchorPosition:S,anchorReference:P="anchorEl",children:A,className:L,container:O,elevation:D=8,marginThreshold:W=16,open:z,PaperProps:N={},slots:F,slotProps:$,transformOrigin:Q={vertical:"top",horizontal:"left"},TransitionComponent:te=v_,transitionDuration:ie="auto",TransitionProps:{onEntering:xe}={},disableScrollLock:Te=!1}=h,_e=Yt(h.TransitionProps,Xre),Re=Yt(h,Yre),Ne=(r=$==null?void 0:$.paper)!=null?r:N,Ve=Z.useRef(),je=jr(Ve,Ne.ref),Ge=se({},h,{anchorOrigin:_,anchorReference:P,elevation:D,marginThreshold:W,externalPaperSlotProps:Ne,transformOrigin:Q,TransitionComponent:te,transitionDuration:ie,TransitionProps:_e}),Ze=Jre(Ge),Ye=Z.useCallback(()=>{if(P==="anchorPosition")return S;const Ut=i1(m),Lt=(Ut&&Ut.nodeType===1?Ut:Xr(Ve.current).body).getBoundingClientRect();return{top:Lt.top+Bk(Lt,_.vertical),left:Lt.left+jk(Lt,_.horizontal)}},[m,_.horizontal,_.vertical,S,P]),Ce=Z.useCallback(Ut=>({vertical:Bk(Ut,Q.vertical),horizontal:jk(Ut,Q.horizontal)}),[Q.horizontal,Q.vertical]),qe=Z.useCallback(Ut=>{const At={width:Ut.offsetWidth,height:Ut.offsetHeight},Lt=Ce(At);if(P==="none")return{top:null,left:null,transformOrigin:Vk(Lt)};const yn=Ye();let vn=yn.top-Lt.vertical,ut=yn.left-Lt.horizontal;const cn=vn+At.height,Ae=ut+At.width,Tt=xl(i1(m)),bn=Tt.innerHeight-W,Xt=Tt.innerWidth-W;if(W!==null&&vn<W){const It=vn-W;vn-=It,Lt.vertical+=It}else if(W!==null&&cn>bn){const It=cn-bn;vn-=It,Lt.vertical+=It}if(W!==null&&ut<W){const It=ut-W;ut-=It,Lt.horizontal+=It}else if(Ae>Xt){const It=Ae-Xt;ut-=It,Lt.horizontal+=It}return{top:`${Math.round(vn)}px`,left:`${Math.round(ut)}px`,transformOrigin:Vk(Lt)}},[m,P,Ye,Ce,W]),[st,Vt]=Z.useState(z),_t=Z.useCallback(()=>{const Ut=Ve.current;if(!Ut)return;const At=qe(Ut);At.top!==null&&(Ut.style.top=At.top),At.left!==null&&(Ut.style.left=At.left),Ut.style.transformOrigin=At.transformOrigin,Vt(!0)},[qe]);Z.useEffect(()=>(Te&&window.addEventListener("scroll",_t),()=>window.removeEventListener("scroll",_t)),[m,Te,_t]);const ht=(Ut,At)=>{xe&&xe(Ut,At),_t()},at=()=>{Vt(!1)};Z.useEffect(()=>{z&&_t()}),Z.useImperativeHandle(l,()=>z?{updatePosition:()=>{_t()}}:null,[z,_t]),Z.useEffect(()=>{if(!z)return;const Ut=Z2(()=>{_t()}),At=xl(m);return At.addEventListener("resize",Ut),()=>{Ut.clear(),At.removeEventListener("resize",Ut)}},[m,z,_t]);let Qe=ie;ie==="auto"&&!te.muiSupportAuto&&(Qe=void 0);const xt=O||(m?Xr(i1(m)).body:void 0),Ht=(i=F==null?void 0:F.root)!=null?i:Qre,qt=(a=F==null?void 0:F.paper)!=null?a:sD,Et=is({elementType:qt,externalSlotProps:se({},Ne,{style:st?Ne.style:se({},Ne.style,{opacity:0})}),additionalProps:{elevation:D,ref:je},ownerState:Ge,className:fn(Ze.paper,Ne==null?void 0:Ne.className)}),ln=is({elementType:Ht,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:Re,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:xt,open:z},ownerState:Ge,className:fn(Ze.root,L)}),{slotProps:Qt}=ln,mn=Yt(ln,Kre);return ue.jsx(Ht,se({},mn,!bc(Ht)&&{slotProps:Qt,disableScrollLock:Te},{children:ue.jsx(te,se({appear:!0,in:z,onEntering:ht,onExited:at,timeout:Qe},_e,{children:ue.jsx(qt,se({},Et,{children:A}))}))}))}),oD=eie;function tie(t){return $n("MuiMenu",t)}Fn("MuiMenu",["root","paper","list"]);const nie=["onEntering"],rie=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],iie={vertical:"top",horizontal:"right"},sie={vertical:"top",horizontal:"left"},oie=t=>{const{classes:e}=t;return qn({root:["root"],paper:["paper"],list:["list"]},tie,e)},aie=Ct(oD,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),lie=Ct(sD,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),cie=Ct(qre,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),uie=Z.forwardRef(function(e,n){var r,i;const a=Gn({props:e,name:"MuiMenu"}),{autoFocus:h=!0,children:l,className:m,disableAutoFocusItem:_=!1,MenuListProps:S={},onClose:P,open:A,PaperProps:L={},PopoverClasses:O,transitionDuration:D="auto",TransitionProps:{onEntering:W}={},variant:z="selectedMenu",slots:N={},slotProps:F={}}=a,$=Yt(a.TransitionProps,nie),Q=Yt(a,rie),te=Cv(),ie=se({},a,{autoFocus:h,disableAutoFocusItem:_,MenuListProps:S,onEntering:W,PaperProps:L,transitionDuration:D,TransitionProps:$,variant:z}),xe=oie(ie),Te=h&&!_&&A,_e=Z.useRef(null),Re=(Ce,qe)=>{_e.current&&_e.current.adjustStyleForScrollbar(Ce,{direction:te?"rtl":"ltr"}),W&&W(Ce,qe)},Ne=Ce=>{Ce.key==="Tab"&&(Ce.preventDefault(),P&&P(Ce,"tabKeyDown"))};let Ve=-1;Z.Children.map(l,(Ce,qe)=>{Z.isValidElement(Ce)&&(Ce.props.disabled||(z==="selectedMenu"&&Ce.props.selected||Ve===-1)&&(Ve=qe))});const je=(r=N.paper)!=null?r:lie,Ge=(i=F.paper)!=null?i:L,Ze=is({elementType:N.root,externalSlotProps:F.root,ownerState:ie,className:[xe.root,m]}),Ye=is({elementType:je,externalSlotProps:Ge,ownerState:ie,className:xe.paper});return ue.jsx(aie,se({onClose:P,anchorOrigin:{vertical:"bottom",horizontal:te?"right":"left"},transformOrigin:te?iie:sie,slots:{paper:je,root:N.root},slotProps:{root:Ze,paper:Ye},open:A,ref:n,transitionDuration:D,TransitionProps:se({onEntering:Re},$),ownerState:ie},Q,{classes:O,children:ue.jsx(cie,se({onKeyDown:Ne,actions:_e,autoFocus:h&&(Ve===-1||_),autoFocusItem:Te,variant:z},S,{className:fn(xe.list,S.className),children:l}))}))}),aD=uie;function hie(t){return $n("MuiMenuItem",t)}const die=Fn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),yp=die,fie=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],pie=(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]},mie=t=>{const{disabled:e,dense:n,divider:r,disableGutters:i,selected:a,classes:h}=t,m=qn({root:["root",n&&"dense",e&&"disabled",!i&&"gutters",r&&"divider",a&&"selected"]},hie,h);return se({},h,m)},gie=Ct(oT,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:pie})(({theme:t,ownerState:e})=>se({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${yp.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:as(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${yp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:as(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${yp.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:as(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:as(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${yp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${yp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${kk.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${kk.inset}`]:{marginLeft:52},[`& .${Fk.root}`]:{marginTop:0,marginBottom:0},[`& .${Fk.inset}`]:{paddingLeft:36},[`& .${Dk.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&se({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${Dk.root} svg`]:{fontSize:"1.25rem"}}))),yie=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:a="li",dense:h=!1,divider:l=!1,disableGutters:m=!1,focusVisibleClassName:_,role:S="menuitem",tabIndex:P,className:A}=r,L=Yt(r,fie),O=Z.useContext(Jw),D=Z.useMemo(()=>({dense:h||O.dense||!1,disableGutters:m}),[O.dense,h,m]),W=Z.useRef(null);da(()=>{i&&W.current&&W.current.focus()},[i]);const z=se({},r,{dense:D.dense,divider:l,disableGutters:m}),N=mie(r),F=jr(W,n);let $;return r.disabled||($=P!==void 0?P:-1),ue.jsx(Jw.Provider,{value:D,children:ue.jsx(gie,se({ref:F,role:S,tabIndex:$,component:a,focusVisibleClassName:fn(N.focusVisible,_),className:fn(N.root,A)},L,{ownerState:z,classes:N}))})}),_p=yie;function _ie(t){return $n("MuiNativeSelect",t)}const vie=Fn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),gT=vie,xie=["className","disabled","error","IconComponent","inputRef","variant"],bie=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${Wt(n)}`,a&&"iconOpen",r&&"disabled"]};return qn(l,_ie,e)},lD=({ownerState:t,theme:e})=>se({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":se({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${gT.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),wie=Ct("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:fo,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${gT.multiple}`]:e.multiple}]}})(lD),cD=({ownerState:t,theme:e})=>se({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${gT.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),Sie=Ct("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Wt(n.variant)}`],n.open&&e.iconOpen]}})(cD),Tie=Z.forwardRef(function(e,n){const{className:r,disabled:i,error:a,IconComponent:h,inputRef:l,variant:m="standard"}=e,_=Yt(e,xie),S=se({},e,{disabled:i,variant:m,error:a}),P=bie(S);return ue.jsxs(Z.Fragment,{children:[ue.jsx(wie,se({ownerState:S,className:fn(P.select,r),disabled:i,ref:l||n},_)),e.multiple?null:ue.jsx(Sie,{as:h,ownerState:S,className:P.icon})]})}),Eie=Tie;var Uk;const Pie=["children","classes","className","label","notched"],Cie=Ct("fieldset",{shouldForwardProp:fo})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Aie=Ct("legend",{shouldForwardProp:fo})(({ownerState:t,theme:e})=>se({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&se({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function Iie(t){const{className:e,label:n,notched:r}=t,i=Yt(t,Pie),a=n!=null&&n!=="",h=se({},t,{notched:r,withLabel:a});return ue.jsx(Cie,se({"aria-hidden":!0,className:e,ownerState:h},i,{children:ue.jsx(Aie,{ownerState:h,children:a?ue.jsx("span",{children:n}):Uk||(Uk=ue.jsx("span",{className:"notranslate",children:""}))})}))}const kie=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Mie=t=>{const{classes:e}=t,r=qn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},yte,e);return se({},e,r)},Lie=Ct(zv,{shouldForwardProp:t=>fo(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Rv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return se({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Kl.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Kl.focused} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Kl.error} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Kl.disabled} .${Kl.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&se({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Rie=Ct(Iie,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),Oie=Ct(Dv,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Ov})(({theme:t,ownerState:e})=>se({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),uD=Z.forwardRef(function(e,n){var r,i,a,h,l;const m=Gn({props:e,name:"MuiOutlinedInput"}),{components:_={},fullWidth:S=!1,inputComponent:P="input",label:A,multiline:L=!1,notched:O,slots:D={},type:W="text"}=m,z=Yt(m,kie),N=Mie(m),F=Nu(),$=Yd({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),Q=se({},m,{color:$.color||"primary",disabled:$.disabled,error:$.error,focused:$.focused,formControl:F,fullWidth:S,hiddenLabel:$.hiddenLabel,multiline:L,size:$.size,type:W}),te=(r=(i=D.root)!=null?i:_.Root)!=null?r:Lie,ie=(a=(h=D.input)!=null?h:_.Input)!=null?a:Oie;return ue.jsx(mT,se({slots:{root:te,input:ie},renderSuffix:xe=>ue.jsx(Rie,{ownerState:Q,className:N.notchedOutline,label:A!=null&&A!==""&&$.required?l||(l=ue.jsxs(Z.Fragment,{children:[A,"","*"]})):A,notched:typeof O<"u"?O:!!(xe.startAdornment||xe.filled||xe.focused)}),fullWidth:S,inputComponent:P,multiline:L,ref:n,type:W},z,{classes:se({},N,{notchedOutline:null})}))});uD.muiName="Input";const hD=uD;function zie(t){return $n("MuiSelect",t)}const Die=Fn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),vp=Die;var $k;const Fie=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],Nie=Ct("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${vp.select}`]:e.select},{[`&.${vp.select}`]:e[n.variant]},{[`&.${vp.error}`]:e.error},{[`&.${vp.multiple}`]:e.multiple}]}})(lD,{[`&.${vp.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Bie=Ct("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Wt(n.variant)}`],n.open&&e.iconOpen]}})(cD),jie=Ct("input",{shouldForwardProp:t=>Av(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function Gk(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Vie(t){return t==null||typeof t=="string"&&!t.trim()}const Uie=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:a,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${Wt(n)}`,a&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return qn(l,zie,e)},$ie=Z.forwardRef(function(e,n){var r;const{"aria-describedby":i,"aria-label":a,autoFocus:h,autoWidth:l,children:m,className:_,defaultOpen:S,defaultValue:P,disabled:A,displayEmpty:L,error:O=!1,IconComponent:D,inputRef:W,labelId:z,MenuProps:N={},multiple:F,name:$,onBlur:Q,onChange:te,onClose:ie,onFocus:xe,onOpen:Te,open:_e,readOnly:Re,renderValue:Ne,SelectDisplayProps:Ve={},tabIndex:je,value:Ge,variant:Ze="standard"}=e,Ye=Yt(e,Fie),[Ce,qe]=p_({controlled:Ge,default:P,name:"Select"}),[st,Vt]=p_({controlled:_e,default:S,name:"Select"}),_t=Z.useRef(null),ht=Z.useRef(null),[at,Qe]=Z.useState(null),{current:xt}=Z.useRef(_e!=null),[Ht,qt]=Z.useState(),Et=jr(n,W),ln=Z.useCallback(ot=>{ht.current=ot,ot&&Qe(ot)},[]),Qt=at==null?void 0:at.parentNode;Z.useImperativeHandle(Et,()=>({focus:()=>{ht.current.focus()},node:_t.current,value:Ce}),[Ce]),Z.useEffect(()=>{S&&st&&at&&!xt&&(qt(l?null:Qt.clientWidth),ht.current.focus())},[at,l]),Z.useEffect(()=>{h&&ht.current.focus()},[h]),Z.useEffect(()=>{if(!z)return;const ot=Xr(ht.current).getElementById(z);if(ot){const $t=()=>{getSelection().isCollapsed&&ht.current.focus()};return ot.addEventListener("click",$t),()=>{ot.removeEventListener("click",$t)}}},[z]);const mn=(ot,$t)=>{ot?Te&&Te($t):ie&&ie($t),xt||(qt(l?null:Qt.clientWidth),Vt(ot))},Ut=ot=>{ot.button===0&&(ot.preventDefault(),ht.current.focus(),mn(!0,ot))},At=ot=>{mn(!1,ot)},Lt=Z.Children.toArray(m),yn=ot=>{const $t=Lt.find(wn=>wn.props.value===ot.target.value);$t!==void 0&&(qe($t.props.value),te&&te(ot,$t))},vn=ot=>$t=>{let wn;if($t.currentTarget.hasAttribute("tabindex")){if(F){wn=Array.isArray(Ce)?Ce.slice():[];const pn=Ce.indexOf(ot.props.value);pn===-1?wn.push(ot.props.value):wn.splice(pn,1)}else wn=ot.props.value;if(ot.props.onClick&&ot.props.onClick($t),Ce!==wn&&(qe(wn),te)){const pn=$t.nativeEvent||$t,nt=new pn.constructor(pn.type,pn);Object.defineProperty(nt,"target",{writable:!0,value:{value:wn,name:$}}),te(nt,ot)}F||mn(!1,$t)}},ut=ot=>{Re||[" ","ArrowUp","ArrowDown","Enter"].indexOf(ot.key)!==-1&&(ot.preventDefault(),mn(!0,ot))},cn=at!==null&&st,Ae=ot=>{!cn&&Q&&(Object.defineProperty(ot,"target",{writable:!0,value:{value:Ce,name:$}}),Q(ot))};delete Ye["aria-invalid"];let Tt,bn;const Xt=[];let It=!1;(__({value:Ce})||L)&&(Ne?Tt=Ne(Ce):It=!0);const Mn=Lt.map(ot=>{if(!Z.isValidElement(ot))return null;let $t;if(F){if(!Array.isArray(Ce))throw new Error(_l(2));$t=Ce.some(wn=>Gk(wn,ot.props.value)),$t&&It&&Xt.push(ot.props.children)}else $t=Gk(Ce,ot.props.value),$t&&It&&(bn=ot.props.children);return Z.cloneElement(ot,{"aria-selected":$t?"true":"false",onClick:vn(ot),onKeyUp:wn=>{wn.key===" "&&wn.preventDefault(),ot.props.onKeyUp&&ot.props.onKeyUp(wn)},role:"option",selected:$t,value:void 0,"data-value":ot.props.value})});It&&(F?Xt.length===0?Tt=null:Tt=Xt.reduce((ot,$t,wn)=>(ot.push($t),wn<Xt.length-1&&ot.push(", "),ot),[]):Tt=bn);let Bn=Ht;!l&&xt&&at&&(Bn=Qt.clientWidth);let On;typeof je<"u"?On=je:On=A?null:0;const et=Ve.id||($?`mui-component-select-${$}`:void 0),Xe=se({},e,{variant:Ze,value:Ce,open:cn,error:O}),yt=Uie(Xe),un=se({},N.PaperProps,(r=N.slotProps)==null?void 0:r.paper),$e=X2();return ue.jsxs(Z.Fragment,{children:[ue.jsx(Nie,se({ref:ln,tabIndex:On,role:"combobox","aria-controls":$e,"aria-disabled":A?"true":void 0,"aria-expanded":cn?"true":"false","aria-haspopup":"listbox","aria-label":a,"aria-labelledby":[z,et].filter(Boolean).join(" ")||void 0,"aria-describedby":i,onKeyDown:ut,onMouseDown:A||Re?null:Ut,onBlur:Ae,onFocus:xe},Ve,{ownerState:Xe,className:fn(Ve.className,yt.select,_),id:et,children:Vie(Tt)?$k||($k=ue.jsx("span",{className:"notranslate",children:""})):Tt})),ue.jsx(jie,se({"aria-invalid":O,value:Array.isArray(Ce)?Ce.join(","):Ce,name:$,ref:_t,"aria-hidden":!0,onChange:yn,tabIndex:-1,disabled:A,className:yt.nativeInput,autoFocus:h,ownerState:Xe},Ye)),ue.jsx(Bie,{as:D,className:yt.icon,ownerState:Xe}),ue.jsx(aD,se({id:`menu-${$||""}`,anchorEl:Qt,open:cn,onClose:At,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},N,{MenuListProps:se({"aria-labelledby":z,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:$e},N.MenuListProps),slotProps:se({},N.slotProps,{paper:se({},un,{style:se({minWidth:Bn},un!=null?un.style:null)})}),children:Mn}))]})}),Gie=$ie,Wie=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Hie=["root"],qie=t=>{const{classes:e}=t;return e},yT={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>fo(t)&&t!=="variant",slot:"Root"},Zie=Ct(nD,yT)(""),Xie=Ct(hD,yT)(""),Yie=Ct(Jz,yT)(""),dD=Z.forwardRef(function(e,n){const r=Gn({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:a,classes:h={},className:l,defaultOpen:m=!1,displayEmpty:_=!1,IconComponent:S=bte,id:P,input:A,inputProps:L,label:O,labelId:D,MenuProps:W,multiple:z=!1,native:N=!1,onClose:F,onOpen:$,open:Q,renderValue:te,SelectDisplayProps:ie,variant:xe="outlined"}=r,Te=Yt(r,Wie),_e=N?Eie:Gie,Re=Nu(),Ne=Yd({props:r,muiFormControl:Re,states:["variant","error"]}),Ve=Ne.variant||xe,je=se({},r,{variant:Ve,classes:h}),Ge=qie(je),Ze=Yt(Ge,Hie),Ye=A||{standard:ue.jsx(Zie,{ownerState:je}),outlined:ue.jsx(Xie,{label:O,ownerState:je}),filled:ue.jsx(Yie,{ownerState:je})}[Ve],Ce=jr(n,Ic(Ye));return ue.jsx(Z.Fragment,{children:Z.cloneElement(Ye,se({inputComponent:_e,inputProps:se({children:a,error:Ne.error,IconComponent:S,variant:Ve,type:void 0,multiple:z},N?{id:P}:{autoWidth:i,defaultOpen:m,displayEmpty:_,labelId:D,MenuProps:W,onClose:F,onOpen:$,open:Q,renderValue:te,SelectDisplayProps:se({id:P},ie)},L,{classes:L?oo(Ze,L.classes):Ze},A?A.props.inputProps:{})},(z&&N||_)&&Ve==="outlined"?{notched:!0}:{},{ref:Ce,className:fn(Ye.props.className,l,Ge.root)},!A&&{variant:Ve},Te))})});dD.muiName="Select";const fD=dD;function Kie(t,e,n=(r,i)=>r===i){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}const Jie=2;function pD(t,e){return t-e}function Wk(t,e){var n;const{index:r}=(n=t.reduce((i,a,h)=>{const l=Math.abs(e-a);return i===null||l<i.distance||l===i.distance?{distance:l,index:h}:i},null))!=null?n:{};return r}function Wy(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function x_(t,e,n){return(t-e)*100/(n-e)}function Qie(t,e,n){return(n-e)*t+e}function ese(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function tse(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(ese(e)))}function Hk({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(pD)}function Hy({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const a=Xr(t.current);if(!((r=t.current)!=null&&r.contains(a.activeElement))||Number(a==null||(i=a.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var h;(h=t.current)==null||h.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}function qy(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?Kie(t,e):!1}const nse={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},rse=t=>t;let Zy;function qk(){return Zy===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Zy=CSS.supports("touch-action","none"):Zy=!0),Zy}function ise(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:a=!1,marks:h=!1,max:l=100,min:m=0,name:_,onChange:S,onChangeCommitted:P,orientation:A="horizontal",rootRef:L,scale:O=rse,step:D=1,shiftStep:W=10,tabIndex:z,value:N}=t,F=Z.useRef(void 0),[$,Q]=Z.useState(-1),[te,ie]=Z.useState(-1),[xe,Te]=Z.useState(!1),_e=Z.useRef(0),[Re,Ne]=p_({controlled:N,default:n??m,name:"Slider"}),Ve=S&&((et,Xe,yt)=>{const un=et.nativeEvent||et,$e=new un.constructor(un.type,un);Object.defineProperty($e,"target",{writable:!0,value:{value:Xe,name:_}}),S($e,Xe,yt)}),je=Array.isArray(Re);let Ge=je?Re.slice().sort(pD):[Re];Ge=Ge.map(et=>et==null?m:cu(et,m,l));const Ze=h===!0&&D!==null?[...Array(Math.floor((l-m)/D)+1)].map((et,Xe)=>({value:m+D*Xe})):h||[],Ye=Ze.map(et=>et.value),{isFocusVisibleRef:Ce,onBlur:qe,onFocus:st,ref:Vt}=Y2(),[_t,ht]=Z.useState(-1),at=Z.useRef(null),Qe=jr(Vt,at),xt=jr(L,Qe),Ht=et=>Xe=>{var yt;const un=Number(Xe.currentTarget.getAttribute("data-index"));st(Xe),Ce.current===!0&&ht(un),ie(un),et==null||(yt=et.onFocus)==null||yt.call(et,Xe)},qt=et=>Xe=>{var yt;qe(Xe),Ce.current===!1&&ht(-1),ie(-1),et==null||(yt=et.onBlur)==null||yt.call(et,Xe)},Et=(et,Xe)=>{const yt=Number(et.currentTarget.getAttribute("data-index")),un=Ge[yt],$e=Ye.indexOf(un);let ot=Xe;if(Ze&&D==null){const $t=Ye[Ye.length-1];ot>$t?ot=$t:ot<Ye[0]?ot=Ye[0]:ot=ot<un?Ye[$e-1]:Ye[$e+1]}if(ot=cu(ot,m,l),je){i&&(ot=cu(ot,Ge[yt-1]||-1/0,Ge[yt+1]||1/0));const $t=ot;ot=Hk({values:Ge,newValue:ot,index:yt});let wn=yt;i||(wn=ot.indexOf($t)),Hy({sliderRef:at,activeIndex:wn})}Ne(ot),ht(yt),Ve&&!qy(ot,Re)&&Ve(et,ot,yt),P&&P(et,ot)},ln=et=>Xe=>{var yt;if(D!==null){const un=Number(Xe.currentTarget.getAttribute("data-index")),$e=Ge[un];let ot=null;(Xe.key==="ArrowLeft"||Xe.key==="ArrowDown")&&Xe.shiftKey||Xe.key==="PageDown"?ot=Math.max($e-W,m):((Xe.key==="ArrowRight"||Xe.key==="ArrowUp")&&Xe.shiftKey||Xe.key==="PageUp")&&(ot=Math.min($e+W,l)),ot!==null&&(Et(Xe,ot),Xe.preventDefault())}et==null||(yt=et.onKeyDown)==null||yt.call(et,Xe)};da(()=>{if(r&&at.current.contains(document.activeElement)){var et;(et=document.activeElement)==null||et.blur()}},[r]),r&&$!==-1&&Q(-1),r&&_t!==-1&&ht(-1);const Qt=et=>Xe=>{var yt;(yt=et.onChange)==null||yt.call(et,Xe),Et(Xe,Xe.target.valueAsNumber)},mn=Z.useRef(void 0);let Ut=A;a&&A==="horizontal"&&(Ut+="-reverse");const At=({finger:et,move:Xe=!1})=>{const{current:yt}=at,{width:un,height:$e,bottom:ot,left:$t}=yt.getBoundingClientRect();let wn;Ut.indexOf("vertical")===0?wn=(ot-et.y)/$e:wn=(et.x-$t)/un,Ut.indexOf("-reverse")!==-1&&(wn=1-wn);let pn;if(pn=Qie(wn,m,l),D)pn=tse(pn,D,m);else{const en=Wk(Ye,pn);pn=Ye[en]}pn=cu(pn,m,l);let nt=0;if(je){Xe?nt=mn.current:nt=Wk(Ge,pn),i&&(pn=cu(pn,Ge[nt-1]||-1/0,Ge[nt+1]||1/0));const en=pn;pn=Hk({values:Ge,newValue:pn,index:nt}),i&&Xe||(nt=pn.indexOf(en),mn.current=nt)}return{newValue:pn,activeIndex:nt}},Lt=zs(et=>{const Xe=Wy(et,F);if(!Xe)return;if(_e.current+=1,et.type==="mousemove"&&et.buttons===0){yn(et);return}const{newValue:yt,activeIndex:un}=At({finger:Xe,move:!0});Hy({sliderRef:at,activeIndex:un,setActive:Q}),Ne(yt),!xe&&_e.current>Jie&&Te(!0),Ve&&!qy(yt,Re)&&Ve(et,yt,un)}),yn=zs(et=>{const Xe=Wy(et,F);if(Te(!1),!Xe)return;const{newValue:yt}=At({finger:Xe,move:!0});Q(-1),et.type==="touchend"&&ie(-1),P&&P(et,yt),F.current=void 0,ut()}),vn=zs(et=>{if(r)return;qk()||et.preventDefault();const Xe=et.changedTouches[0];Xe!=null&&(F.current=Xe.identifier);const yt=Wy(et,F);if(yt!==!1){const{newValue:$e,activeIndex:ot}=At({finger:yt});Hy({sliderRef:at,activeIndex:ot,setActive:Q}),Ne($e),Ve&&!qy($e,Re)&&Ve(et,$e,ot)}_e.current=0;const un=Xr(at.current);un.addEventListener("touchmove",Lt,{passive:!0}),un.addEventListener("touchend",yn,{passive:!0})}),ut=Z.useCallback(()=>{const et=Xr(at.current);et.removeEventListener("mousemove",Lt),et.removeEventListener("mouseup",yn),et.removeEventListener("touchmove",Lt),et.removeEventListener("touchend",yn)},[yn,Lt]);Z.useEffect(()=>{const{current:et}=at;return et.addEventListener("touchstart",vn,{passive:qk()}),()=>{et.removeEventListener("touchstart",vn),ut()}},[ut,vn]),Z.useEffect(()=>{r&&ut()},[r,ut]);const cn=et=>Xe=>{var yt;if((yt=et.onMouseDown)==null||yt.call(et,Xe),r||Xe.defaultPrevented||Xe.button!==0)return;Xe.preventDefault();const un=Wy(Xe,F);if(un!==!1){const{newValue:ot,activeIndex:$t}=At({finger:un});Hy({sliderRef:at,activeIndex:$t,setActive:Q}),Ne(ot),Ve&&!qy(ot,Re)&&Ve(Xe,ot,$t)}_e.current=0;const $e=Xr(at.current);$e.addEventListener("mousemove",Lt,{passive:!0}),$e.addEventListener("mouseup",yn)},Ae=x_(je?Ge[0]:m,m,l),Tt=x_(Ge[Ge.length-1],m,l)-Ae,bn=(et={})=>{const Xe=xu(et),yt={onMouseDown:cn(Xe||{})},un=se({},Xe,yt);return se({},et,{ref:xt},un)},Xt=et=>Xe=>{var yt;(yt=et.onMouseOver)==null||yt.call(et,Xe);const un=Number(Xe.currentTarget.getAttribute("data-index"));ie(un)},It=et=>Xe=>{var yt;(yt=et.onMouseLeave)==null||yt.call(et,Xe),ie(-1)};return{active:$,axis:Ut,axisProps:nse,dragging:xe,focusedThumbIndex:_t,getHiddenInputProps:(et={})=>{var Xe;const yt=xu(et),un={onChange:Qt(yt||{}),onFocus:Ht(yt||{}),onBlur:qt(yt||{}),onKeyDown:ln(yt||{})},$e=se({},yt,un);return se({tabIndex:z,"aria-labelledby":e,"aria-orientation":A,"aria-valuemax":O(l),"aria-valuemin":O(m),name:_,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":(Xe=t.step)!=null?Xe:void 0,disabled:r},et,$e,{style:se({},ZY,{direction:a?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:bn,getThumbProps:(et={})=>{const Xe=xu(et),yt={onMouseOver:Xt(Xe||{}),onMouseLeave:It(Xe||{})};return se({},et,Xe,yt)},marks:Ze,open:te,range:je,rootRef:xt,trackLeap:Tt,trackOffset:Ae,values:Ge,getThumbStyle:et=>({pointerEvents:$!==-1&&$!==et?"none":void 0})}}const sse=t=>!t||!bc(t),ose=sse;function ase(t){return $n("MuiSlider",t)}const lse=Fn("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Mo=lse,cse=t=>{const{open:e}=t;return{offset:fn(e&&Mo.valueLabelOpen),circle:Mo.valueLabelCircle,label:Mo.valueLabelLabel}};function use(t){const{children:e,className:n,value:r}=t,i=cse(t);return e?Z.cloneElement(e,{className:fn(e.props.className)},ue.jsxs(Z.Fragment,{children:[e.props.children,ue.jsx("span",{className:fn(i.offset,n),"aria-hidden":!0,children:ue.jsx("span",{className:i.circle,children:ue.jsx("span",{className:i.label,children:r})})})]})):null}const hse=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function Zk(t){return t}const dse=Ct("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${Wt(n.color)}`],n.size!=="medium"&&e[`size${Wt(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t})=>{var e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Mo.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Mo.dragging}`]:{[`& .${Mo.thumb}, & .${Mo.track}`]:{transition:"none"}},variants:[...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}),fse=Ct("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),pse=Ct("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t})=>{var e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n,track:"inverted"},style:se({},t.vars?{backgroundColor:t.vars.palette.Slider[`${n}Track`],borderColor:t.vars.palette.Slider[`${n}Track`]}:se({backgroundColor:Pm(t.palette[n].main,.62),borderColor:Pm(t.palette[n].main,.62)},t.applyStyles("dark",{backgroundColor:Em(t.palette[n].main,.5)}),t.applyStyles("dark",{borderColor:Em(t.palette[n].main,.5)})))}))]}}),mse=Ct("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${Wt(n.color)}`],n.size!=="medium"&&e[`thumbSize${Wt(n.size)}`]]}})(({theme:t})=>{var e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Mo.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var r;return((r=t.vars)!=null?r:t).palette[n].main}).map(n=>({props:{color:n},style:{[`&:hover, &.${Mo.focusVisible}`]:se({},t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${as(t.palette[n].main,.16)}`},{"@media (hover: none)":{boxShadow:"none"}}),[`&.${Mo.active}`]:se({},t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${as(t.palette[n].main,.16)}`})}}))]}}),gse=Ct(use,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t})=>se({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Mo.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Mo.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})),yse=Ct("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>Av(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]})),_se=Ct("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>Av(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t})=>se({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})),vse=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:a,classes:h,color:l,size:m}=t,_={root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",a==="inverted"&&"trackInverted",a===!1&&"trackFalse",l&&`color${Wt(l)}`,m&&`size${Wt(m)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",m&&`thumbSize${Wt(m)}`,l&&`thumbColor${Wt(l)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return qn(_,ase,h)},xse=({children:t})=>t,bse=Z.forwardRef(function(e,n){var r,i,a,h,l,m,_,S,P,A,L,O,D,W,z,N,F,$,Q,te,ie,xe,Te,_e;const Re=Gn({props:e,name:"MuiSlider"}),Ne=Cv(),{"aria-label":Ve,"aria-valuetext":je,"aria-labelledby":Ge,component:Ze="span",components:Ye={},componentsProps:Ce={},color:qe="primary",classes:st,className:Vt,disableSwap:_t=!1,disabled:ht=!1,getAriaLabel:at,getAriaValueText:Qe,marks:xt=!1,max:Ht=100,min:qt=0,orientation:Et="horizontal",shiftStep:ln=10,size:Qt="medium",step:mn=1,scale:Ut=Zk,slotProps:At,slots:Lt,track:yn="normal",valueLabelDisplay:vn="off",valueLabelFormat:ut=Zk}=Re,cn=Yt(Re,hse),Ae=se({},Re,{isRtl:Ne,max:Ht,min:qt,classes:st,disabled:ht,disableSwap:_t,orientation:Et,marks:xt,color:qe,size:Qt,step:mn,shiftStep:ln,scale:Ut,track:yn,valueLabelDisplay:vn,valueLabelFormat:ut}),{axisProps:Tt,getRootProps:bn,getHiddenInputProps:Xt,getThumbProps:It,open:Mn,active:Bn,axis:On,focusedThumbIndex:et,range:Xe,dragging:yt,marks:un,values:$e,trackOffset:ot,trackLeap:$t,getThumbStyle:wn}=ise(se({},Ae,{rootRef:n}));Ae.marked=un.length>0&&un.some(Pt=>Pt.label),Ae.dragging=yt,Ae.focusedThumbIndex=et;const pn=vse(Ae),nt=(r=(i=Lt==null?void 0:Lt.root)!=null?i:Ye.Root)!=null?r:dse,en=(a=(h=Lt==null?void 0:Lt.rail)!=null?h:Ye.Rail)!=null?a:fse,sn=(l=(m=Lt==null?void 0:Lt.track)!=null?m:Ye.Track)!=null?l:pse,Pr=(_=(S=Lt==null?void 0:Lt.thumb)!=null?S:Ye.Thumb)!=null?_:mse,ci=(P=(A=Lt==null?void 0:Lt.valueLabel)!=null?A:Ye.ValueLabel)!=null?P:gse,on=(L=(O=Lt==null?void 0:Lt.mark)!=null?O:Ye.Mark)!=null?L:yse,Vr=(D=(W=Lt==null?void 0:Lt.markLabel)!=null?W:Ye.MarkLabel)!=null?D:_se,he=(z=(N=Lt==null?void 0:Lt.input)!=null?N:Ye.Input)!=null?z:"input",G=(F=At==null?void 0:At.root)!=null?F:Ce.root,q=($=At==null?void 0:At.rail)!=null?$:Ce.rail,ne=(Q=At==null?void 0:At.track)!=null?Q:Ce.track,de=(te=At==null?void 0:At.thumb)!=null?te:Ce.thumb,pe=(ie=At==null?void 0:At.valueLabel)!=null?ie:Ce.valueLabel,Me=(xe=At==null?void 0:At.mark)!=null?xe:Ce.mark,be=(Te=At==null?void 0:At.markLabel)!=null?Te:Ce.markLabel,ye=(_e=At==null?void 0:At.input)!=null?_e:Ce.input,Ee=is({elementType:nt,getSlotProps:bn,externalSlotProps:G,externalForwardedProps:cn,additionalProps:se({},ose(nt)&&{as:Ze}),ownerState:se({},Ae,G==null?void 0:G.ownerState),className:[pn.root,Vt]}),Ue=is({elementType:en,externalSlotProps:q,ownerState:Ae,className:pn.rail}),We=is({elementType:sn,externalSlotProps:ne,additionalProps:{style:se({},Tt[On].offset(ot),Tt[On].leap($t))},ownerState:se({},Ae,ne==null?void 0:ne.ownerState),className:pn.track}),He=is({elementType:Pr,getSlotProps:It,externalSlotProps:de,ownerState:se({},Ae,de==null?void 0:de.ownerState),className:pn.thumb}),Rt=is({elementType:ci,externalSlotProps:pe,ownerState:se({},Ae,pe==null?void 0:pe.ownerState),className:pn.valueLabel}),Kt=is({elementType:on,externalSlotProps:Me,ownerState:Ae,className:pn.mark}),St=is({elementType:Vr,externalSlotProps:be,ownerState:Ae,className:pn.markLabel}),Ft=is({elementType:he,getSlotProps:Xt,externalSlotProps:ye,ownerState:Ae});return ue.jsxs(nt,se({},Ee,{children:[ue.jsx(en,se({},Ue)),ue.jsx(sn,se({},We)),un.filter(Pt=>Pt.value>=qt&&Pt.value<=Ht).map((Pt,hn)=>{const In=x_(Pt.value,qt,Ht),gn=Tt[On].offset(In);let dn;return yn===!1?dn=$e.indexOf(Pt.value)!==-1:dn=yn==="normal"&&(Xe?Pt.value>=$e[0]&&Pt.value<=$e[$e.length-1]:Pt.value<=$e[0])||yn==="inverted"&&(Xe?Pt.value<=$e[0]||Pt.value>=$e[$e.length-1]:Pt.value>=$e[0]),ue.jsxs(Z.Fragment,{children:[ue.jsx(on,se({"data-index":hn},Kt,!bc(on)&&{markActive:dn},{style:se({},gn,Kt.style),className:fn(Kt.className,dn&&pn.markActive)})),Pt.label!=null?ue.jsx(Vr,se({"aria-hidden":!0,"data-index":hn},St,!bc(Vr)&&{markLabelActive:dn},{style:se({},gn,St.style),className:fn(pn.markLabel,St.className,dn&&pn.markLabelActive),children:Pt.label})):null]},hn)}),$e.map((Pt,hn)=>{const In=x_(Pt,qt,Ht),gn=Tt[On].offset(In),dn=vn==="off"?xse:ci;return ue.jsx(dn,se({},!bc(dn)&&{valueLabelFormat:ut,valueLabelDisplay:vn,value:typeof ut=="function"?ut(Ut(Pt),hn):ut,index:hn,open:Mn===hn||Bn===hn||vn==="on",disabled:ht},Rt,{children:ue.jsx(Pr,se({"data-index":hn},He,{className:fn(pn.thumb,He.className,Bn===hn&&pn.active,et===hn&&pn.focusVisible),style:se({},gn,wn(hn),He.style),children:ue.jsx(he,se({"data-index":hn,"aria-label":at?at(hn):Ve,"aria-valuenow":Ut(Pt),"aria-labelledby":Ge,"aria-valuetext":Qe?Qe(Ut(Pt),hn):je,value:$e[hn]},Ft))}))}),hn)})]}))}),_T=bse;function wse(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:a}=t,h=pu();Z.useEffect(()=>{if(!i)return;function z(N){N.defaultPrevented||(N.key==="Escape"||N.key==="Esc")&&(r==null||r(N,"escapeKeyDown"))}return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[i,r]);const l=zs((z,N)=>{r==null||r(z,N)}),m=zs(z=>{!r||z==null||h.start(z,()=>{l(null,"timeout")})});Z.useEffect(()=>(i&&m(e),h.clear),[i,e,m,h]);const _=z=>{r==null||r(z,"clickaway")},S=h.clear,P=Z.useCallback(()=>{e!=null&&m(a??e*.5)},[e,a,m]),A=z=>N=>{const F=z.onBlur;F==null||F(N),P()},L=z=>N=>{const F=z.onFocus;F==null||F(N),S()},O=z=>N=>{const F=z.onMouseEnter;F==null||F(N),S()},D=z=>N=>{const F=z.onMouseLeave;F==null||F(N),P()};return Z.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",P),window.addEventListener("blur",S),()=>{window.removeEventListener("focus",P),window.removeEventListener("blur",S)}},[n,i,P,S]),{getRootProps:(z={})=>{const N=se({},xu(t),xu(z));return se({role:"presentation"},z,N,{onBlur:A(N),onFocus:L(N),onMouseEnter:O(N),onMouseLeave:D(N)})},onClickAway:_}}function Sse(t){return $n("MuiSnackbarContent",t)}Fn("MuiSnackbarContent",["root","message","action"]);const Tse=["action","className","message","role"],Ese=t=>{const{classes:e}=t;return qn({root:["root"],action:["action"],message:["message"]},Sse,e)},Pse=Ct(Iv,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,n=uK(t.palette.background.default,e);return se({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(n),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),Cse=Ct("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),Ase=Ct("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Ise=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSnackbarContent"}),{action:i,className:a,message:h,role:l="alert"}=r,m=Yt(r,Tse),_=r,S=Ese(_);return ue.jsxs(Pse,se({role:l,square:!0,elevation:6,className:fn(S.root,a),ownerState:_,ref:n},m,{children:[ue.jsx(Cse,{className:S.message,ownerState:_,children:h}),i?ue.jsx(Ase,{className:S.action,ownerState:_,children:i}):null]}))}),kse=Ise;function Mse(t){return $n("MuiSnackbar",t)}Fn("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Lse=["onEnter","onExited"],Rse=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],Ose=t=>{const{classes:e,anchorOrigin:n}=t,r={root:["root",`anchorOrigin${Wt(n.vertical)}${Wt(n.horizontal)}`]};return qn(r,Mse,e)},Xk=Ct("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`anchorOrigin${Wt(n.anchorOrigin.vertical)}${Wt(n.anchorOrigin.horizontal)}`]]}})(({theme:t,ownerState:e})=>{const n={left:"50%",right:"auto",transform:"translateX(-50%)"};return se({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:se({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&n,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),zse=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiSnackbar"}),i=Zd(),a={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:h,anchorOrigin:{vertical:l,horizontal:m}={vertical:"bottom",horizontal:"left"},autoHideDuration:_=null,children:S,className:P,ClickAwayListenerProps:A,ContentProps:L,disableWindowBlurListener:O=!1,message:D,open:W,TransitionComponent:z=v_,transitionDuration:N=a,TransitionProps:{onEnter:F,onExited:$}={}}=r,Q=Yt(r.TransitionProps,Lse),te=Yt(r,Rse),ie=se({},r,{anchorOrigin:{vertical:l,horizontal:m},autoHideDuration:_,disableWindowBlurListener:O,TransitionComponent:z,transitionDuration:N}),xe=Ose(ie),{getRootProps:Te,onClickAway:_e}=wse(se({},ie)),[Re,Ne]=Z.useState(!0),Ve=is({elementType:Xk,getSlotProps:Te,externalForwardedProps:te,ownerState:ie,additionalProps:{ref:n},className:[xe.root,P]}),je=Ze=>{Ne(!0),$&&$(Ze)},Ge=(Ze,Ye)=>{Ne(!1),F&&F(Ze,Ye)};return!W&&Re?null:ue.jsx(ine,se({onClickAway:_e},A,{children:ue.jsx(Xk,se({},Ve,{children:ue.jsx(z,se({appear:!0,in:W,timeout:N,direction:l==="top"?"down":"up",onEnter:Ge,onExited:je},Q,{children:S||ue.jsx(kse,se({message:D,action:h},L))}))}))}))}),Yk=zse;function Dse(t){return $n("MuiTooltip",t)}const Fse=Fn("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),cc=Fse,Nse=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function Bse(t){return Math.round(t*1e5)/1e5}const jse=t=>{const{classes:e,disableInteractive:n,arrow:r,touch:i,placement:a}=t,h={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${Wt(a.split("-")[0])}`],arrow:["arrow"]};return qn(h,Dse,e)},Vse=Ct(Gz,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(({theme:t,ownerState:e,open:n})=>se({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!n&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${cc.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${cc.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${cc.arrow}`]:se({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${cc.arrow}`]:se({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),Use=Ct("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${Wt(n.placement.split("-")[0])}`]]}})(({theme:t,ownerState:e})=>se({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:as(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${Bse(16/14)}em`,fontWeight:t.typography.fontWeightRegular},{[`.${cc.popper}[data-popper-placement*="left"] &`]:se({transformOrigin:"right center"},e.isRtl?se({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):se({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${cc.popper}[data-popper-placement*="right"] &`]:se({transformOrigin:"left center"},e.isRtl?se({marginRight:"14px"},e.touch&&{marginRight:"24px"}):se({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${cc.popper}[data-popper-placement*="top"] &`]:se({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${cc.popper}[data-popper-placement*="bottom"] &`]:se({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),$se=Ct("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:as(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let Xy=!1;const Kk=new Qm;let xp={x:0,y:0};function Yy(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const Gse=Z.forwardRef(function(e,n){var r,i,a,h,l,m,_,S,P,A,L,O,D,W,z,N,F,$,Q;const te=Gn({props:e,name:"MuiTooltip"}),{arrow:ie=!1,children:xe,components:Te={},componentsProps:_e={},describeChild:Re=!1,disableFocusListener:Ne=!1,disableHoverListener:Ve=!1,disableInteractive:je=!1,disableTouchListener:Ge=!1,enterDelay:Ze=100,enterNextDelay:Ye=0,enterTouchDelay:Ce=700,followCursor:qe=!1,id:st,leaveDelay:Vt=0,leaveTouchDelay:_t=1500,onClose:ht,onOpen:at,open:Qe,placement:xt="bottom",PopperComponent:Ht,PopperProps:qt={},slotProps:Et={},slots:ln={},title:Qt,TransitionComponent:mn=v_,TransitionProps:Ut}=te,At=Yt(te,Nse),Lt=Z.isValidElement(xe)?xe:ue.jsx("span",{children:xe}),yn=Zd(),vn=Cv(),[ut,cn]=Z.useState(),[Ae,Tt]=Z.useState(null),bn=Z.useRef(!1),Xt=je||qe,It=pu(),Mn=pu(),Bn=pu(),On=pu(),[et,Xe]=p_({controlled:Qe,default:!1,name:"Tooltip",state:"open"});let yt=et;const un=X2(st),$e=Z.useRef(),ot=zs(()=>{$e.current!==void 0&&(document.body.style.WebkitUserSelect=$e.current,$e.current=void 0),On.clear()});Z.useEffect(()=>ot,[ot]);const $t=tn=>{Kk.clear(),Xy=!0,Xe(!0),at&&!yt&&at(tn)},wn=zs(tn=>{Kk.start(800+Vt,()=>{Xy=!1}),Xe(!1),ht&&yt&&ht(tn),It.start(yn.transitions.duration.shortest,()=>{bn.current=!1})}),pn=tn=>{bn.current&&tn.type!=="touchstart"||(ut&&ut.removeAttribute("title"),Mn.clear(),Bn.clear(),Ze||Xy&&Ye?Mn.start(Xy?Ye:Ze,()=>{$t(tn)}):$t(tn))},nt=tn=>{Mn.clear(),Bn.start(Vt,()=>{wn(tn)})},{isFocusVisibleRef:en,onBlur:sn,onFocus:Pr,ref:ci}=Y2(),[,on]=Z.useState(!1),Vr=tn=>{sn(tn),en.current===!1&&(on(!1),nt(tn))},he=tn=>{ut||cn(tn.currentTarget),Pr(tn),en.current===!0&&(on(!0),pn(tn))},G=tn=>{bn.current=!0;const _n=Lt.props;_n.onTouchStart&&_n.onTouchStart(tn)},q=tn=>{G(tn),Bn.clear(),It.clear(),ot(),$e.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",On.start(Ce,()=>{document.body.style.WebkitUserSelect=$e.current,pn(tn)})},ne=tn=>{Lt.props.onTouchEnd&&Lt.props.onTouchEnd(tn),ot(),Bn.start(_t,()=>{wn(tn)})};Z.useEffect(()=>{if(!yt)return;function tn(_n){(_n.key==="Escape"||_n.key==="Esc")&&wn(_n)}return document.addEventListener("keydown",tn),()=>{document.removeEventListener("keydown",tn)}},[wn,yt]);const de=jr(Ic(Lt),ci,cn,n);!Qt&&Qt!==0&&(yt=!1);const pe=Z.useRef(),Me=tn=>{const _n=Lt.props;_n.onMouseMove&&_n.onMouseMove(tn),xp={x:tn.clientX,y:tn.clientY},pe.current&&pe.current.update()},be={},ye=typeof Qt=="string";Re?(be.title=!yt&&ye&&!Ve?Qt:null,be["aria-describedby"]=yt?un:null):(be["aria-label"]=ye?Qt:null,be["aria-labelledby"]=yt&&!ye?un:null);const Ee=se({},be,At,Lt.props,{className:fn(At.className,Lt.props.className),onTouchStart:G,ref:de},qe?{onMouseMove:Me}:{}),Ue={};Ge||(Ee.onTouchStart=q,Ee.onTouchEnd=ne),Ve||(Ee.onMouseOver=Yy(pn,Ee.onMouseOver),Ee.onMouseLeave=Yy(nt,Ee.onMouseLeave),Xt||(Ue.onMouseOver=pn,Ue.onMouseLeave=nt)),Ne||(Ee.onFocus=Yy(he,Ee.onFocus),Ee.onBlur=Yy(Vr,Ee.onBlur),Xt||(Ue.onFocus=he,Ue.onBlur=Vr));const We=Z.useMemo(()=>{var tn;let _n=[{name:"arrow",enabled:!!Ae,options:{element:Ae,padding:4}}];return(tn=qt.popperOptions)!=null&&tn.modifiers&&(_n=_n.concat(qt.popperOptions.modifiers)),se({},qt.popperOptions,{modifiers:_n})},[Ae,qt]),He=se({},te,{isRtl:vn,arrow:ie,disableInteractive:Xt,placement:xt,PopperComponentProp:Ht,touch:bn.current}),Rt=jse(He),Kt=(r=(i=ln.popper)!=null?i:Te.Popper)!=null?r:Vse,St=(a=(h=(l=ln.transition)!=null?l:Te.Transition)!=null?h:mn)!=null?a:v_,Ft=(m=(_=ln.tooltip)!=null?_:Te.Tooltip)!=null?m:Use,Pt=(S=(P=ln.arrow)!=null?P:Te.Arrow)!=null?S:$se,hn=ed(Kt,se({},qt,(A=Et.popper)!=null?A:_e.popper,{className:fn(Rt.popper,qt==null?void 0:qt.className,(L=(O=Et.popper)!=null?O:_e.popper)==null?void 0:L.className)}),He),In=ed(St,se({},Ut,(D=Et.transition)!=null?D:_e.transition),He),gn=ed(Ft,se({},(W=Et.tooltip)!=null?W:_e.tooltip,{className:fn(Rt.tooltip,(z=(N=Et.tooltip)!=null?N:_e.tooltip)==null?void 0:z.className)}),He),dn=ed(Pt,se({},(F=Et.arrow)!=null?F:_e.arrow,{className:fn(Rt.arrow,($=(Q=Et.arrow)!=null?Q:_e.arrow)==null?void 0:$.className)}),He);return ue.jsxs(Z.Fragment,{children:[Z.cloneElement(Lt,Ee),ue.jsx(Kt,se({as:Ht??Gz,placement:xt,anchorEl:qe?{getBoundingClientRect:()=>({top:xp.y,left:xp.x,right:xp.x,bottom:xp.y,width:0,height:0})}:ut,popperRef:pe,open:ut?yt:!1,id:un,transition:!0},Ue,hn,{popperOptions:We,children:({TransitionProps:tn})=>ue.jsx(St,se({timeout:yn.transitions.duration.shorter},tn,In,{children:ue.jsxs(Ft,se({},gn,{children:[Qt,ie?ue.jsx(Pt,se({},dn,{ref:Tt})):null]}))}))}))]})}),Wse=Gse;function Hse(t){return $n("MuiTextField",t)}Fn("MuiTextField",["root"]);const qse=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Zse={standard:nD,filled:Jz,outlined:hD},Xse=t=>{const{classes:e}=t;return qn({root:["root"]},Hse,e)},Yse=Ct(Qz,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Kse=Z.forwardRef(function(e,n){const r=Gn({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:a=!1,children:h,className:l,color:m="primary",defaultValue:_,disabled:S=!1,error:P=!1,FormHelperTextProps:A,fullWidth:L=!1,helperText:O,id:D,InputLabelProps:W,inputProps:z,InputProps:N,inputRef:F,label:$,maxRows:Q,minRows:te,multiline:ie=!1,name:xe,onBlur:Te,onChange:_e,onFocus:Re,placeholder:Ne,required:Ve=!1,rows:je,select:Ge=!1,SelectProps:Ze,type:Ye,value:Ce,variant:qe="outlined"}=r,st=Yt(r,qse),Vt=se({},r,{autoFocus:a,color:m,disabled:S,error:P,fullWidth:L,multiline:ie,required:Ve,select:Ge,variant:qe}),_t=Xse(Vt),ht={};qe==="outlined"&&(W&&typeof W.shrink<"u"&&(ht.notched=W.shrink),ht.label=$),Ge&&((!Ze||!Ze.native)&&(ht.id=void 0),ht["aria-describedby"]=void 0);const at=X2(D),Qe=O&&at?`${at}-helper-text`:void 0,xt=$&&at?`${at}-label`:void 0,Ht=Zse[qe],qt=ue.jsx(Ht,se({"aria-describedby":Qe,autoComplete:i,autoFocus:a,defaultValue:_,fullWidth:L,multiline:ie,name:xe,rows:je,maxRows:Q,minRows:te,type:Ye,value:Ce,id:at,inputRef:F,onBlur:Te,onChange:_e,onFocus:Re,placeholder:Ne,inputProps:z},ht,N));return ue.jsxs(Yse,se({className:fn(_t.root,l),disabled:S,error:P,fullWidth:L,ref:n,required:Ve,color:m,variant:qe,ownerState:Vt},st,{children:[$!=null&&$!==""&&ue.jsx(rD,se({htmlFor:at,id:xt},W,{children:$})),Ge?ue.jsx(fD,se({"aria-describedby":Qe,id:at,labelId:xt,value:Ce,input:qt},Ze,{children:h})):qt,O&&ue.jsx(lre,se({id:Qe},A,{children:O}))]}))}),Jse=Kse,Qse="linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(135deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(135deg, transparent 75%, #ccc 75%) /*! @noflip */",eoe="linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, transparent) /*! @noflip */",toe={Button:Ct(C0)(()=>({backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 0, 4px -4px, 0px 4px",transition:"none",boxShadow:"0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08)",border:0,borderRadius:4,width:"24px",aspectRatio:"1 / 1",height:"24px",minWidth:0}))},noe=t=>{const{bgColor:e,className:n,disablePopover:r,isBgColorValid:i,...a}=t;return ue.jsx(toe.Button,{disableTouchRipple:!0,style:{backgroundColor:i?e:void 0,backgroundImage:i?void 0:Qse,cursor:r?"default":void 0},className:`MuiColorInput-Button ${n||""}`,...a})},roe={Container:Ct("div")(()=>({width:300,padding:8}))},ioe=({children:t,className:e,position:n="start",...r})=>ue.jsx(oD,{className:`MuiColorInput-Popover ${e||""}`,anchorOrigin:{vertical:"bottom",horizontal:n==="start"?"left":"right"},transformOrigin:{vertical:"top",horizontal:n==="start"?"left":"right"},...r,children:ue.jsx(roe.Container,{children:t})}),soe={Slider:Ct(_T,{shouldForwardProp:t=>t!=="$rgbaFrom"&&t!=="$rgbaTo"})(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 0) 0%, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 1) 100%)"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},ooe=t=>{const{rgbColor:e,style:n,className:r,...i}=t,a={"--rgb-r":e.r,"--rgb-g":e.g,"--rgb-b":e.b,...n};return ue.jsx(soe.Slider,{className:`MuiColorInput-AlphaSlider ${r||""}`,style:a,...i})},Ky={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},aoe={ArrowUp:{type:"hsvV",value:1},ArrowDown:{type:"hsvV",value:-1},ArrowLeft:{type:"hsvS",value:-1},ArrowRight:{type:"hsvS",value:1}};function loe(t){return t===Ky.up||t===Ky.down||t===Ky.left||t===Ky.right}function b_(t,e,n){return Math.max(e,Math.min(t,n))}function Jk(t){return typeof t=="number"}function Qk(t,e,n){const r=t.toLocaleString("en",{useGrouping:!1,minimumFractionDigits:e,maximumFractionDigits:n});return Number(r)}function coe(t,e,n){const r=t.getBoundingClientRect(),i=e-r.left,a=n-r.top;return{x:b_(i/r.width,0,1),y:b_(1-a/r.height,0,1)}}function uoe(t){const e=cr.useRef();return e.current=t,cr.useCallback((...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}const eM={Space:Ct("div")(()=>({width:"100%",height:"180px",boxSizing:"border-box",outline:0,position:"relative",backgroundImage:eoe})),Thumb:Ct("div")(()=>({position:"absolute",border:"3px solid #ffffff",borderRadius:"50%",width:"20px",height:"20px",marginLeft:"-10px /*! @noflip */",marginBottom:"-10px /*! @noflip */",outline:0,boxSizing:"border-box",willChange:"left, bottom",transition:"box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:hover":{boxShadow:"0px 0px 0px 4px rgba(255 255 255 / 0.16)"},"&.MuiColorInput-Thumb-active":{boxShadow:"0px 0px 0px 8px rgba(255 255 255 / 0.16)"},"@media (hover: none)":{boxShadow:"none"}}))},hoe=t=>{const{hsv:e,onChange:n,currentHue:r}=t,i=cr.useRef(!1),a=cr.useRef(null),[h,l]=cr.useState(!1),m=uoe((D,W)=>{if(!a.current)return;const{x:z,y:N}=coe(a.current,D,W);n({s:z,v:N}),a.current&&document.activeElement!==a.current&&a.current.focus()}),_=cr.useCallback(()=>{i.current&&(i.current=!1,l(!1))},[]),S=cr.useCallback(D=>{i.current&&m(D.clientX,D.clientY)},[]);cr.useEffect(()=>(document.addEventListener("pointermove",S,!1),document.addEventListener("pointerup",_,!1),()=>{document.removeEventListener("pointermove",S,!1),document.removeEventListener("pointerup",_,!1)}),[_,S]);const P=D=>{D.preventDefault(),i.current=!0,m(D.clientX,D.clientY),l(!0)},A=D=>{if(loe(D.key)){D.preventDefault();const{type:W,value:z}=aoe[D.key],N=D.shiftKey?10:1,F=W==="hsvS"?e.s:e.v,$=b_(F+z*N*.01,0,1);l(!0),n({s:W==="hsvS"?$:e.s,v:W==="hsvV"?$:e.v})}},L=e.s*100,O=e.v*100;return ue.jsx(eM.Space,{onPointerDown:P,ref:a,className:"MuiColorInput-ColorSpace",style:{backgroundColor:`hsl(${r} 100% 50%)`,touchAction:"none"},role:"slider","aria-valuetext":`Saturation ${Qk(L,0,0)}%, Brightness ${Qk(O,0,0)}%`,onKeyDown:A,tabIndex:0,children:ue.jsx(eM.Thumb,{"aria-label":"Color space thumb",className:h?"MuiColorInput-Thumb-active":"",style:{left:`${L}%`,bottom:`${O}%`}})})},doe={Slider:Ct(_T)(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%) /*! @noflip */"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},foe=t=>{const{className:e,...n}=t;return ue.jsx(doe.Slider,{className:`MuiColorInput-HueSlider ${e||""}`,...n})};function poe(t){return typeof t=="string"}function Vi(t,e){moe(t)&&(t="100%");const n=goe(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function Jy(t){return Math.min(1,Math.max(0,t))}function moe(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function goe(t){return typeof t=="string"&&t.indexOf("%")!==-1}function mD(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Qy(t){return Number(t)<=1?`${Number(t)*100}%`:t}function gu(t){return t.length===1?"0"+t:String(t)}function yoe(t,e,n){return{r:Vi(t,255)*255,g:Vi(e,255)*255,b:Vi(n,255)*255}}function tM(t,e,n){t=Vi(t,255),e=Vi(e,255),n=Vi(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0,h=0;const l=(r+i)/2;if(r===i)h=0,a=0;else{const m=r-i;switch(h=l>.5?m/(2-r-i):m/(r+i),r){case t:a=(e-n)/m+(e<n?6:0);break;case e:a=(n-t)/m+2;break;case n:a=(t-e)/m+4;break}a/=6}return{h:a,s:h,l}}function s1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function _oe(t,e,n){let r,i,a;if(t=Vi(t,360),e=Vi(e,100),n=Vi(n,100),e===0)i=n,a=n,r=n;else{const h=n<.5?n*(1+e):n+e-n*e,l=2*n-h;r=s1(l,h,t+1/3),i=s1(l,h,t),a=s1(l,h,t-1/3)}return{r:r*255,g:i*255,b:a*255}}function nM(t,e,n){t=Vi(t,255),e=Vi(e,255),n=Vi(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let a=0;const h=r,l=r-i,m=r===0?0:l/r;if(r===i)a=0;else{switch(r){case t:a=(e-n)/l+(e<n?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4;break}a/=6}return{h:a,s:m,v:h}}function voe(t,e,n){t=Vi(t,360)*6,e=Vi(e,100),n=Vi(n,100);const r=Math.floor(t),i=t-r,a=n*(1-e),h=n*(1-i*e),l=n*(1-(1-i)*e),m=r%6,_=[n,h,a,a,l,n][m],S=[l,n,n,h,a,a][m],P=[a,a,l,n,n,h][m];return{r:_*255,g:S*255,b:P*255}}function rM(t,e,n,r){const i=[gu(Math.round(t).toString(16)),gu(Math.round(e).toString(16)),gu(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function xoe(t,e,n,r,i){const a=[gu(Math.round(t).toString(16)),gu(Math.round(e).toString(16)),gu(Math.round(n).toString(16)),gu(boe(r))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function boe(t){return Math.round(parseFloat(t)*255).toString(16)}function iM(t){return Xs(t)/255}function Xs(t){return parseInt(t,16)}function woe(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}const Qw={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Soe(t){let e={r:0,g:0,b:0},n=1,r=null,i=null,a=null,h=!1,l=!1;return typeof t=="string"&&(t=Poe(t)),typeof t=="object"&&(nl(t.r)&&nl(t.g)&&nl(t.b)?(e=yoe(t.r,t.g,t.b),h=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):nl(t.h)&&nl(t.s)&&nl(t.v)?(r=Qy(t.s),i=Qy(t.v),e=voe(t.h,r,i),h=!0,l="hsv"):nl(t.h)&&nl(t.s)&&nl(t.l)&&(r=Qy(t.s),a=Qy(t.l),e=_oe(t.h,r,a),h=!0,l="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=mD(n),{ok:h,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}const Toe="[-\\+]?\\d+%?",Eoe="[-\\+]?\\d*\\.\\d+%?",uc="(?:"+Eoe+")|(?:"+Toe+")",o1="[\\s|\\(]+("+uc+")[,|\\s]+("+uc+")[,|\\s]+("+uc+")\\s*\\)?",a1="[\\s|\\(]+("+uc+")[,|\\s]+("+uc+")[,|\\s]+("+uc+")[,|\\s]+("+uc+")\\s*\\)?",ta={CSS_UNIT:new RegExp(uc),rgb:new RegExp("rgb"+o1),rgba:new RegExp("rgba"+a1),hsl:new RegExp("hsl"+o1),hsla:new RegExp("hsla"+a1),hsv:new RegExp("hsv"+o1),hsva:new RegExp("hsva"+a1),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Poe(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;let e=!1;if(Qw[t])t=Qw[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let n=ta.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=ta.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=ta.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=ta.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=ta.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=ta.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=ta.hex8.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),a:iM(n[4]),format:e?"name":"hex8"}:(n=ta.hex6.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),format:e?"name":"hex"}:(n=ta.hex4.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),a:iM(n[4]+n[4]),format:e?"name":"hex8"}:(n=ta.hex3.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function nl(t){return!!ta.CSS_UNIT.exec(String(t))}class lr{constructor(e="",n={}){if(e instanceof lr)return e;typeof e=="number"&&(e=woe(e)),this.originalInput=e;const r=Soe(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=n.format??r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){const e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3}getLuminance(){const e=this.toRgb();let n,r,i;const a=e.r/255,h=e.g/255,l=e.b/255;return a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),h<=.03928?r=h/12.92:r=Math.pow((h+.055)/1.055,2.4),l<=.03928?i=l/12.92:i=Math.pow((l+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i}getAlpha(){return this.a}setAlpha(e){return this.a=mD(e),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){const{s:e}=this.toHsl();return e===0}toHsv(){const e=nM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){const e=nM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?`hsv(${n}, ${r}%, ${i}%)`:`hsva(${n}, ${r}%, ${i}%, ${this.roundA})`}toHsl(){const e=tM(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){const e=tM(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?`hsl(${n}, ${r}%, ${i}%)`:`hsla(${n}, ${r}%, ${i}%, ${this.roundA})`}toHex(e=!1){return rM(this.r,this.g,this.b,e)}toHexString(e=!1){return"#"+this.toHex(e)}toHex8(e=!1){return xoe(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return"#"+this.toHex8(e)}toHexShortString(e=!1){return this.a===1?this.toHexString(e):this.toHex8String(e)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?`rgb(${e}, ${n}, ${r})`:`rgba(${e}, ${n}, ${r}, ${this.roundA})`}toPercentageRgb(){const e=n=>`${Math.round(Vi(n,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){const e=n=>Math.round(Vi(n,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const e="#"+rM(this.r,this.g,this.b,!1);for(const[n,r]of Object.entries(Qw))if(e===r)return n;return!1}toString(e){const n=!!e;e=e??this.format;let r=!1;const i=this.a<1&&this.a>=0;return!n&&i&&(e.startsWith("hex")||e==="name")?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new lr(this.toString())}lighten(e=10){const n=this.toHsl();return n.l+=e/100,n.l=Jy(n.l),new lr(n)}brighten(e=10){const n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new lr(n)}darken(e=10){const n=this.toHsl();return n.l-=e/100,n.l=Jy(n.l),new lr(n)}tint(e=10){return this.mix("white",e)}shade(e=10){return this.mix("black",e)}desaturate(e=10){const n=this.toHsl();return n.s-=e/100,n.s=Jy(n.s),new lr(n)}saturate(e=10){const n=this.toHsl();return n.s+=e/100,n.s=Jy(n.s),new lr(n)}greyscale(){return this.desaturate(100)}spin(e){const n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new lr(n)}mix(e,n=50){const r=this.toRgb(),i=new lr(e).toRgb(),a=n/100,h={r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a};return new lr(h)}analogous(e=6,n=30){const r=this.toHsl(),i=360/n,a=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(new lr(r));return a}complement(){const e=this.toHsl();return e.h=(e.h+180)%360,new lr(e)}monochromatic(e=6){const n=this.toHsv(),{h:r}=n,{s:i}=n;let{v:a}=n;const h=[],l=1/e;for(;e--;)h.push(new lr({h:r,s:i,v:a})),a=(a+l)%1;return h}splitcomplement(){const e=this.toHsl(),{h:n}=e;return[this,new lr({h:(n+72)%360,s:e.s,l:e.l}),new lr({h:(n+216)%360,s:e.s,l:e.l})]}onBackground(e){const n=this.toRgb(),r=new lr(e).toRgb(),i=n.a+r.a*(1-n.a);return new lr({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(e){const n=this.toHsl(),{h:r}=n,i=[this],a=360/e;for(let h=1;h<e;h++)i.push(new lr({h:(r+h*a)%360,s:n.s,l:n.l}));return i}equals(e){return this.toRgbString()===new lr(e).toRgbString()}}function dd(t,e){return t.toString(e)}function sM(t,e,n){return new lr(t,n)}function Coe(t){return poe(t)?t:new lr(t).toString()}const Aoe=t=>{const{currentColor:e,format:n,onChange:r,isAlphaHidden:i}=t,[a,h]=cr.useState(e.toHsv()),l=(S,P)=>{if(!Jk(P))return;const A=b_(360*P/100,0,359);h(O=>({...O,h:A}));const L=new lr({...a,a:e.toHsv().a,h:A});r==null||r(dd(L,n))},m=(S,P)=>{if(!Jk(P))return;const A=e.clone().setAlpha(P);r==null||r(dd(A,n))},_=({s:S,v:P})=>{const A=new lr({h:a.h,a:e.toHsv().a,s:S,v:P});h(L=>({...L,s:S,v:P})),r==null||r(dd(A,n))};return ue.jsxs(e1,{className:"MuiColorInput-PopoverBody",children:[ue.jsx(hoe,{currentHue:a.h,hsv:a,onChange:_}),ue.jsx(e1,{mt:"10px",px:"3px",children:ue.jsx(foe,{min:0,max:100,step:1,onChange:l,"aria-label":"hue",value:a.h*100/360})}),i?null:ue.jsx(e1,{mt:"10px",px:"3px",children:ue.jsx(ooe,{min:0,max:1,step:.01,"aria-label":"alpha",rgbColor:e.toRgb(),onChange:m,value:e.getAlpha()})})]})},Ioe=cr.forwardRef((t,e)=>{const{className:n,...r}=t;return ue.jsx(Jse,{className:`MuiColorInput-TextField ${n||""}`,ref:e,...r})}),koe="black",Moe="rgb";function Loe(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function oM(t,e){typeof e=="function"?e(t):e&&Loe(e)&&"current"in e&&(e.current=t)}const zh=cr.forwardRef((t,e)=>{const{value:n,format:r,onChange:i,adornmentPosition:a="start",PopoverProps:h,Adornment:l=noe,fallbackValue:m,isAlphaHidden:_,disablePopover:S,...P}=t,{onBlur:A,InputProps:L,...O}=P,{onClose:D,...W}=h||{},z=m||koe,N=O.disabled||(L==null?void 0:L.disabled)||!1,F=cr.useRef(null),$=cr.useRef(null),[Q,te]=cr.useState(null),ie=r||Moe,xe=sM(n,z,{format:ie}),[Te,_e]=cr.useState(n),[Re,Ne]=cr.useState(n),Ve=Qe=>{Qe.preventDefault(),Qe.stopPropagation(),!N&&!S&&te(F.current)},je=Qe=>{const xt=new lr(Qe);i==null||i(Qe,{hex:xt.isValid?xt.toHexString():"",hsv:xt.isValid?xt.toHsvString():"",hsl:xt.isValid?xt.toHslString():"",rgb:xt.isValid?xt.toRgbString():"",hex8:xt.isValid?xt.toHex8String():""})},Ge=Qe=>{const xt=Qe.target.value;if(_e(xt),xt==="")Ne(""),je("");else{const Ht=new lr(xt),qt=dd(Ht,ie);Ne(qt),je(qt)}},Ze=(...Qe)=>{D==null||D(...Qe),te(null),queueMicrotask(()=>{var xt;(xt=$.current)==null||xt.focus()})},Ye=Qe=>{A==null||A(Qe);const xt=new lr(Te);if(xt.isValid)xt.format!==ie&&_e(dd(xt,ie));else{if(Te==="")return;const Ht=new lr(z),qt=dd(Ht,ie);_e(qt),Ne(qt),je(qt)}};cr.useEffect(()=>{if(n!==Re){const Qe=sM(n).originalInput;Ne(Qe),_e(Qe)}},[n,Re,z]);const Ce=Qe=>{_e(Qe),Ne(Qe),je(Qe)},qe=Qe=>{F.current=Qe,e&&oM(Qe,e)},st=Qe=>{$.current=Qe,$&&oM(Qe,$)},Vt=!!Q,_t=Vt?"color-popover":void 0,ht=ue.jsx(kre,{position:a,children:ue.jsx(l,{disabled:N,"aria-describedby":_t,disablePopover:S||!1,component:S?"span":void 0,bgColor:xe.toString(),isBgColorValid:!!(Te!==""&&xe.isValid),onClick:S?void 0:Ve})}),at=a==="start"?{startAdornment:ht}:{endAdornment:ht};return ue.jsxs(ue.Fragment,{children:[ue.jsx(Ioe,{ref:qe,spellCheck:"false",type:"text",autoComplete:"off",onChange:Ge,value:Coe(Te),onBlur:Ye,inputRef:st,disabled:N,InputProps:{...at,...L},...O}),S?null:ue.jsx(ioe,{id:_t,open:Vt,position:a,anchorEl:Q,onClose:Ze,...W,children:ue.jsx(Aoe,{onChange:Ce,currentColor:xe,format:ie,isAlphaHidden:_})})]})}),Roe=Na(ue.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),Ooe=Na(ue.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),Dh=Na(ue.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8"}),"Replay"),zoe=Na(ue.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings"),Doe=Ct(_T)(()=>({color:"#46B780","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:`0px 0px 0px 8px ${BI("#46B780",.16)}`},"&.Mui-active":{boxShadow:`0px 0px 0px 14px ${BI("#46B780",.16)}`}},"& .MuiSlider-rail":{color:"#A8AFB3",opacity:1}}));function l1({disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChange:h,onChangeCommited:l,defaultValue:m,marks:_,style:S}){return ue.jsx(Doe,{disabled:t,value:e,min:n,max:r,step:i,onInput:a,onChangeCommitted:l,onChange:h,defaultValue:m,marks:_,style:S})}const Foe="./map_style.json",Noe={longitude:-16.504,latitude:-68.131,zoom:13,pitch:0,bearing:0},lu={startNodeFill:[70,183,128],startNodeBorder:[255,255,255],endNodeFill:[152,4,12],endNodeBorder:[0,0,0],path:[70,183,128],route:[165,13,32]},Boe=[{name:"La Paz",latitude:-16.504,longitude:-68.131},{name:"Viacha",latitude:-16.65,longitude:-68.297},{name:"Sta. Cruz",latitude:-17.783,longitude:-63.182}],gD=Z.forwardRef(({canStart:t,started:e,animationEnded:n,playbackOn:r,time:i,maxTime:a,settings:h,colors:l,loading:m,timeChanged:_,cinematic:S,placeEnd:P,changeRadius:A,changeAlgorithm:L,setPlaceEnd:O,setCinematic:D,setSettings:W,setColors:z,startPathfinding:N,toggleAnimation:F,clearPath:$,changeLocation:Q},te)=>{const[ie,xe]=Z.useState(!1),[Te,_e]=Z.useState({open:!1,message:"",type:"error"}),[Re,Ne]=Z.useState(!1);Z.useState(0);const[Ve,je]=Z.useState(!1),[Ge,Ze]=Z.useState(null),Ye=!!Ge,Ce=Z.useRef(4800),qe=Z.useRef(!1),st=Z.useRef(!1);Z.useImperativeHandle(te,()=>({showSnack(Qe,xt="error"){_e({open:!0,message:Qe,type:xt})}}));function Vt(){_e({...Te,open:!1})}function _t(){je(!1)}function ht(){if(t){if(!e&&i===0){N();return}F()}}function at(){Ze(null)}return window.onkeydown=Qe=>{Qe.code==="ArrowRight"&&!qe.current&&!st.current&&(!e||n)?(qe.current=!0,F(!1,1)):Qe.code==="ArrowLeft"&&!st.current&&!qe.current&&n&&(st.current=!0,F(!1,-1))},window.onkeyup=Qe=>{Qe.code==="Escape"?D(!1):Qe.code==="Space"?(Qe.preventDefault(),ht()):Qe.code==="ArrowRight"&&qe.current?(qe.current=!1,F(!1,1)):Qe.code==="ArrowLeft"&&n&&st.current?(st.current=!1,F(!1,1)):Qe.code==="KeyR"&&(n||!e)&&$()},Z.useEffect(()=>{S&&(je(!0),setTimeout(()=>{Ce.current=2500},200))},[S]),Z.useEffect(()=>{localStorage.getItem("path_sawtutorial")||(Ne(!0),localStorage.setItem("path_sawtutorial",!0))},[]),ue.jsxs(ue.Fragment,{children:[ue.jsxs("div",{className:`nav-top ${S?"cinematic":""}`,children:[ue.jsxs("div",{className:"side slider-container",children:[ue.jsx(xs,{id:"playback-slider",gutterBottom:!0,children:"Animacion"}),ue.jsx(l1,{disabled:!n,value:n?i:a,min:n?0:-1,max:a,onChange:Qe=>{_(Number(Qe.target.value))},className:"slider","aria-labelledby":"playback-slider"})]}),ue.jsx(rl,{disabled:!t,onClick:ht,style:{backgroundColor:"#46B780",width:60,height:60},size:"large",children:!e||n&&!r?ue.jsx(Ooe,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"}):ue.jsx(Roe,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"})}),ue.jsx("div",{className:"side",children:ue.jsx(C0,{disabled:!n&&e,onClick:$,style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:"Limpiar"})})]}),ue.jsx("div",{className:`nav-right ${S?"cinematic":""}`,children:ue.jsx(Wse,{title:"Open settings",children:ue.jsx(rl,{onClick:()=>{xe(!0)},style:{backgroundColor:"#2A2B37",width:36,height:36},size:"large",children:ue.jsx(zoe,{style:{color:"#fff",width:24,height:24},fontSize:"inherit"})})})}),ue.jsx("div",{className:"loader-container",children:ue.jsx(Hz,{in:m,style:{transitionDelay:m?"50ms":"0ms"},unmountOnExit:!0,children:ue.jsx(nne,{color:"inherit"})})}),ue.jsx(Yk,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:Te.open,autoHideDuration:4e3,onClose:Vt,children:ue.jsx(wQ,{onClose:Vt,severity:Te.type,style:{width:"100%",color:"#fff"},children:Te.message})}),ue.jsx(Yk,{anchorOrigin:{vertical:"top",horizontal:"center"},open:Ve,autoHideDuration:Ce.current,onClose:_t,children:ue.jsxs("div",{className:"cinematic-alert",children:[ue.jsx(xs,{fontSize:"18px",children:ue.jsx("b",{children:"Cinematic mode"})}),ue.jsx(xs,{children:"Use keyboard shortcuts to control animation"}),ue.jsxs(xs,{children:["Press ",ue.jsx("b",{children:"Escape"})," to exit"]})]})}),ue.jsx("div",{className:"mobile-controls",children:ue.jsx(C0,{onClick:()=>{O(!P)},style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:P?"Nodo final":"Nodo inicial"})}),ue.jsx(Hne,{className:`side-drawer ${S?"cinematic":""}`,anchor:"left",open:ie,onClose:()=>{xe(!1)},children:ue.jsxs("div",{className:"sidebar-container",children:[ue.jsxs(Qz,{variant:"filled",children:[ue.jsx(rD,{style:{fontSize:14},id:"algo-select",children:"Algoritmo"}),ue.jsxs(fD,{labelId:"algo-select",value:h.algorithm,onChange:Qe=>{L(Qe.target.value)},required:!0,style:{backgroundColor:"#404156",color:"#fff",width:"100%",paddingLeft:1},inputProps:{MenuProps:{MenuListProps:{sx:{backgroundColor:"#404156"}}}},size:"small",disabled:!n&&e,children:[ue.jsx(_p,{value:"astar",children:"A *"}),ue.jsx(_p,{value:"greedy",children:"Greedy"}),ue.jsx(_p,{value:"dijkstra",children:"Dijkstra"}),ue.jsx(_p,{value:"bidirectional",children:"Busqueda bidireccional"})]})]}),ue.jsxs("div",{children:[ue.jsx(C0,{id:"locations-button","aria-controls":Ye?"locations-menu":void 0,"aria-haspopup":"true","aria-expanded":Ye?"true":void 0,onClick:Qe=>{Ze(Qe.currentTarget)},variant:"contained",disableElevation:!0,style:{backgroundColor:"#404156",color:"#fff",textTransform:"none",fontSize:16,paddingBlock:8,justifyContent:"start"},children:"Localizaciones"}),ue.jsx(aD,{id:"locations-menu",anchorEl:Ge,open:Ye,onClose:()=>{Ze(null)},MenuListProps:{"aria-labelledby":"locations-button",sx:{backgroundColor:"#404156"}},anchorOrigin:{vertical:"top",horizontal:"right"},children:Boe.map(Qe=>ue.jsx(_p,{onClick:()=>{at(),Q(Qe)},children:Qe.name},Qe.name))})]}),ue.jsxs("div",{className:"side slider-container",children:[ue.jsxs(xs,{id:"area-slider",children:["Radio del Area: ",h.radius,"km (",(h.radius/1.609).toFixed(1),"mi)"]}),ue.jsx(l1,{disabled:e&&!n,min:2,max:20,step:1,value:h.radius,onChangeCommited:()=>{A(h.radius)},onChange:Qe=>{W({...h,radius:Number(Qe.target.value)})},className:"slider","aria-labelledby":"area-slider",style:{marginBottom:1},marks:[{value:2,label:"2km"},{value:20,label:"20km"}]})]}),ue.jsxs("div",{className:"side slider-container",children:[ue.jsx(xs,{id:"speed-slider",children:"Velocidad de animacion"}),ue.jsx(l1,{min:1,max:30,value:h.speed,onChange:Qe=>{W({...h,speed:Number(Qe.target.value)})},className:"slider","aria-labelledby":"speed-slider",style:{marginBottom:1}})]}),ue.jsxs("div",{className:"styles-container",children:[ue.jsx(xs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Styles"}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"start-fill-label",children:"Nodo inicial"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.startNodeFill),onChange:Qe=>{z({...l,startNodeFill:Ch(Qe)})},"aria-labelledby":"start-fill-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,startNodeFill:lu.startNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"start-border-label",children:"Borde del nodo inicial"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.startNodeBorder),onChange:Qe=>{z({...l,startNodeBorder:Ch(Qe)})},"aria-labelledby":"start-border-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,startNodeBorder:lu.startNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"end-fill-label",children:"Nodo final"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.endNodeFill),onChange:Qe=>{z({...l,endNodeFill:Ch(Qe)})},"aria-labelledby":"end-fill-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,endNodeFill:lu.endNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"end-border-label",children:"Borde del nodo final"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.endNodeBorder),onChange:Qe=>{z({...l,endNodeBorder:Ch(Qe)})},"aria-labelledby":"end-border-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,endNodeBorder:lu.endNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"path-label",children:"Rutas"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.path),onChange:Qe=>{z({...l,path:Ch(Qe)})},"aria-labelledby":"path-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,path:lu.path})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),ue.jsxs("div",{children:[ue.jsx(xs,{id:"route-label",children:"Ruta mas corta"}),ue.jsxs("div",{className:"color-container",children:[ue.jsx(zh,{value:Ah(l.route),onChange:Qe=>{z({...l,route:Ch(Qe)})},"aria-labelledby":"route-label",style:{backgroundColor:"#404156"}}),ue.jsx(rl,{onClick:()=>{z({...l,route:lu.route})},style:{backgroundColor:"transparent"},size:"small",children:ue.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]})]}),ue.jsxs("div",{className:"shortcuts-container",children:[ue.jsx(xs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Atajos"}),ue.jsxs("div",{className:"shortcut",children:[ue.jsx("p",{children:"Espacio"}),ue.jsx("p",{children:"Iniciar/Parar animacion"})]}),ue.jsxs("div",{className:"shortcut",children:[ue.jsx("p",{children:"R"}),ue.jsx("p",{children:"Limpiar"})]}),ue.jsxs("div",{className:"shortcut",children:[ue.jsx("p",{children:"Flechas"}),ue.jsx("p",{children:"Animacion"})]})]})]})})]})});gD.displayName="Interface";function joe(t,e,n,r,i,a){const[h,l]=Z.useState(t),m=Date.now(),_=Z.useRef();return Z.useEffect(()=>{function S(){const A=Date.now()-m;if(A<r){const L=A/r,O=a?n+L*(e-n):e+L*(n-e);l(O),_.current=requestAnimationFrame(S)}else l(a?e:n)}if(i)return _.current=requestAnimationFrame(S),()=>{cancelAnimationFrame(_.current)}},[e,n,r,i,a]),h}function Voe(){const[t,e]=Z.useState(null),[n,r]=Z.useState(null),[i,a]=Z.useState([]),[h,l]=Z.useState([]),[m,_]=Z.useState(),[S,P]=Z.useState(0),[A,L]=Z.useState(!1),[O,D]=Z.useState(!1),[W,z]=Z.useState(1),[N,F]=Z.useState(!1),[$,Q]=Z.useState(!1),[te,ie]=Z.useState(!1),[xe,Te]=Z.useState(!1),[_e,Re]=Z.useState({algorithm:"astar",radius:4,speed:5}),[Ne,Ve]=Z.useState(lu),[je,Ge]=Z.useState(Noe),Ze=Z.useRef(),Ye=Z.useRef(),Ce=Z.useRef(),qe=Z.useRef(),st=Z.useRef(0),Vt=Z.useRef([]),_t=Z.useRef(new Fw),ht=Z.useRef(null),at=Z.useRef(null),Qe=joe(0,0,1,400,Ye.current,N);async function xt(ut,cn,Ae=null){var It;if(m&&!A)return;if(F(!1),Ye.current=!0,Et(),cn.rightButton||te){if(((It=ut.layer)==null?void 0:It.id)!=="selection-radius"){Ze.current.showSnack("Seleccione un punto dentro del radio","info");return}if(xe){Ze.current.showSnack("Espere un momento","info");return}const Mn=setTimeout(()=>{Te(!0)},300),Bn=await wI(ut.coordinate[1],ut.coordinate[0]);if(!Bn){Ze.current.showSnack("Error. No se encontraron rutas"),clearTimeout(Mn),Te(!1);return}const On=_t.current.getNode(Bn.id);if(r(Bn),clearTimeout(Mn),Te(!1),!On){Ze.current.showSnack("Intente de nuevo porfavor.");return}_t.current.endNode=On;return}const Tt=setTimeout(()=>{Te(!0)},300),bn=await wI(ut.coordinate[1],ut.coordinate[0]);if(!bn){Ze.current.showSnack("Error. No se encontraron rutas"),clearTimeout(Tt),Te(!1);return}e(bn),r(null);const Xt=CO([bn.lon,bn.lat],Ae??_e.radius);a([{contour:Xt}]),Kq(IO(Xt),bn.id).then(Mn=>{_t.current.graph=Mn,Et(),clearTimeout(Tt),Te(!1)})}function Ht(){F(!0),setTimeout(()=>{Et(),_t.current.start(_e.algorithm),_(!0)},400)}function qt(ut=!0,cn=1){if(!(S===0&&!A)){if(z(cn),A){ut&&S>=st.current&&P(0),_(!0),D(!O);return}_(!m),m&&(qe.current=null)}}function Et(){_(!1),l([]),P(0),_t.current.reset(),Vt.current=[],st.current=0,qe.current=null,ht.current=null,at.current=null,L(!1)}function ln(ut){const cn=_t.current.nextStep();for(const Ae of cn)mn(Ae,Ae.referer);if(_t.current.finished&&!A)if(_e.algorithm==="bidirectional"){ht.current||(ht.current=cn[0]);const Ae=ht.current.parent;mn(Ae,ht.current,"route",Math.max(Math.log2(_e.speed),1)),ht.current=Ae??ht.current,at.current||(at.current=cn[0],at.current.parent=at.current.prevParent);const Tt=at.current.parent;mn(Tt,at.current,"route",Math.max(Math.log2(_e.speed),1)),at.current=Tt??at.current,L(S>=st.current&&Ae==null&&Tt==null)}else{ht.current||(ht.current=_t.current.endNode);const Ae=ht.current.parent;mn(Ae,ht.current,"route",Math.max(Math.log2(_e.speed),1)),ht.current=Ae??ht.current,L(S>=st.current&&Ae==null)}if(qe.current!=null&&!A){const Ae=ut-qe.current;P(Tt=>Tt+Ae*W)}if(qe.current!=null&&A&&O){const Ae=ut-qe.current;S>=st.current&&W!==-1&&D(!1),P(Tt=>Math.max(Math.min(Tt+Ae*2*W,st.current),0))}}function Qt(ut){for(let cn=0;cn<_e.speed;cn++)ln(ut);qe.current=ut,Ce.current=requestAnimationFrame(Qt)}function mn(ut,cn,Ae="path",Tt=1){if(!ut||!cn)return;const Xt=Math.hypot(ut.longitude-cn.longitude,ut.latitude-cn.latitude)*5e4*Tt;Vt.current=[...Vt.current,{path:[[cn.longitude,cn.latitude],[ut.longitude,ut.latitude]],timestamps:[st.current,st.current+Xt],color:Ae}],st.current+=Xt,l(()=>Vt.current)}function Ut(ut){Ge({...je,longitude:ut.longitude,latitude:ut.latitude,zoom:13,transitionDuration:1,transitionInterpolator:new sH})}function At(ut){Re(ut);const cn={settings:ut,colors:Ne};localStorage.setItem("path_settings",JSON.stringify(cn))}function Lt(ut){Ve(ut);const cn={settings:_e,colors:ut};localStorage.setItem("path_settings",JSON.stringify(cn))}function yn(ut){Et(),At({..._e,algorithm:ut})}function vn(ut){At({..._e,radius:ut}),t&&xt({coordinate:[t.lon,t.lat]},{},ut)}return Z.useEffect(()=>{if(m)return Ce.current=requestAnimationFrame(Qt),()=>cancelAnimationFrame(Ce.current)},[m,S,A,O]),Z.useEffect(()=>{navigator.geolocation.getCurrentPosition(Ae=>{Ut(Ae.coords)});const ut=localStorage.getItem("path_settings");if(!ut)return;const cn=JSON.parse(ut);Re(cn.settings),Ve(cn.colors)},[]),ue.jsxs(ue.Fragment,{children:[ue.jsx("div",{onContextMenu:ut=>{ut.preventDefault()},children:ue.jsxs(_H,{initialViewState:je,controller:{doubleClickZoom:!1,keyboard:!1},onClick:xt,children:[ue.jsx(k2,{id:"selection-radius",data:i,pickable:!0,stroked:!0,getPolygon:ut=>ut.contour,getFillColor:[80,210,0,10],getLineColor:[9,142,46,175],getLineWidth:3,opacity:Qe}),ue.jsx(M2,{id:"pathfinding-layer",data:h,opacity:1,widthMinPixels:3,widthMaxPixels:5,fadeTrail:!1,currentTime:S,getColor:ut=>Ne[ut.color],updateTriggers:{getColor:[Ne.path,Ne.route]}}),ue.jsx(C2,{id:"start-end-points",data:[...t?[{coordinates:[t.lon,t.lat],color:Ne.startNodeFill,lineColor:Ne.startNodeBorder}]:[],...n?[{coordinates:[n.lon,n.lat],color:Ne.endNodeFill,lineColor:Ne.endNodeBorder}]:[]],pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1,radiusMinPixels:7,radiusMaxPixels:20,lineWidthMinPixels:1,lineWidthMaxPixels:3,getPosition:ut=>ut.coordinates,getFillColor:ut=>ut.color,getLineColor:ut=>ut.lineColor}),ue.jsx(WH,{reuseMaps:!0,mapLib:qH,mapStyle:Foe,doubleClickZoom:!1})]})}),ue.jsx(gD,{ref:Ze,canStart:t&&n,started:m,animationEnded:A,playbackOn:O,time:S,startPathfinding:Ht,toggleAnimation:qt,clearPath:Et,timeChanged:P,changeLocation:Ut,maxTime:st.current,settings:_e,setSettings:At,changeAlgorithm:yn,colors:Ne,setColors:Lt,loading:xe,cinematic:$,setCinematic:Q,placeEnd:te,setPlaceEnd:ie,changeRadius:vn})]})}const Uoe=eT({palette:{mode:"dark"}});function $oe(){return ue.jsxs(gJ,{theme:Uoe,children:[ue.jsx(lne,{}),ue.jsx(Voe,{})]})}u1.createRoot(document.getElementById("root")).render(ue.jsx(cr.StrictMode,{children:ue.jsx($oe,{})}));
